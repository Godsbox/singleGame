{"version":3,"sources":["app/js/AppConstants.js","app/js/ApplicationFacade.js","app/js/common/Dialog.js","app/js/common/FontUtils.js","app/js/common/OtherWap.js","app/js/common/PhoneUtils.js","app/js/common/RePhaser.js","app/js/common/ShanyiMenu.js","app/js/common/Utils.js","app/js/common/Version.js","app/js/common/XmlHttpRequest.js","app/js/controller/command/PrepareControllerCommand.js","app/js/controller/command/PrepareModelCommand.js","app/js/controller/command/PrepareViewCommand.js","app/js/controller/command/StartupCommand.js","app/js/main.js","app/js/model/proxy/SceneProxy.js","app/js/view/component/Scene.js","app/js/view/mediator/CoverMediator.js","app/js/view/mediator/EndMediator.js","app/js/view/mediator/HtmlTextBox.js","app/js/view/mediator/MainMenuMediator.js","app/js/view/mediator/PlaybackMediator.js","app/js/view/mediator/RecordMediator.js","app/js/view/mediator/SceneMediator.js","app/js/view/mediator/SettingsMediator.js"],"names":["window","diygamePlayer","AppConstants","CMD_STARTUP","CMD_FRAME_ENTER","CMD_SVG_MENU","CMD_LOAD_GAME","CMD_UPDATE_MUSIC_STATE","APP_DEBUG_MODE","APP_LOG","APP_SHOW_INSPECTOR","APP_SHOW_MENUBAR","APP_FPS_UPDATE","STAGE_TRAP_MOUSE","SCENE_SHOW_ERROR","SCENE_SHOW_SAVE_ALERT","SCENE_SHOW_AD","SCENE_TOOGLE_SCREEN_STATE","SCENE_SKIPPING","SCENE_PRELOADING_BEGIN","SCENE_PRELOADING_PROGRESS","SCENE_PRELOADING_COMPLETE","SCENE_LOADING_BEGIN","SCENE_LOADING_PROGRESS","SCENE_LOADING_COMPLETE","SCENE_TEMPLATE_LOADED","SCENE_SHOW_LOGO","SCENE_GOTO_COVERMENU","SCENE_GOTO_MAINMENU","SCENE_GOTO_SETTINGS","SCENE_GOTO_PLAYBACK","SCENE_GOTO_RECORD","SCENE_GOTO_END","SCENE_CLOSE_MENU","SCENE_PLOT_ANIM_BEGIN","SCENE_PLOT_SKIP","SCENE_PLOT_CLOSED","SCENE_PLOT_LOAD_BEGIN","SCENE_PLOT_LOAD_ASSETS_READY","SCENE_PLOT_LOAD_ASSETS_LOADED","SCENE_PLOT_LOAD_END","SCENE_BACKGROUND_COLOR_UPDATE","SCENE_BACKGROUND_UPDATE","SCENE_BACKGROUND_ENTERED","SCENE_BACKGROUND_SWITCH","SCENE_MUSIC_UPDATE","SCENE_SOUND_UPDATE","SCENE_CHARACTER_UPDATE","SCENE_PROP_UPDATE","SCENE_VIEW_UPDATE","SCENE_DIALOG_UPDATE","SCENE_DIALOG_COMPLETE","SCENE_CHECK_IF_SKIP","SCENE_CLICK_ON_SCENE","SCENE_OPTION_UPDATE","SCENE_MENUBUTTON_UPDATE","SCENE_WEATHER_UPDATE","SCENE_EFFECT_SHAKE","SCENE_EFFECT_TWINKLE","SCENE_CLEAR","SCENE_SHOW_GUIDE","ADD_PLAYBACK_CONTENT","SCENE_DESTROY_VIEW","SCENE_SHOW_INPUT_VIEW","_puremvc","require","_puremvc2","define","name","parent","Facade","startup","this","initialized","registerCommand","controller","command","StartupCommand","sendNotification","getInstance","multitonKey","instanceMap","instance","ApplicationFacade","NAME","Dialog","title","data","type","okText","cancelText","iscancle","arguments","length","undefined","cd","cdtype","isShow","that","Promise","resolve","reject","ok","document","body","removeChild","modalContainer","cancel","closefun","createElement","classList","add","modalPortal","clientWidth","clientHeight","style","transform","onresize","flashvars","vertical","appendChild","titleDiv","titleData","innerText","space","close","onclick","content","contentData","buttons","buttonOk","buttonCancel","countdown","btn","wait","txt","removeAttribute","background","backgroundColor","border","color","setAttribute","setTimeout","showDialog","tileText","_Utils","FontUtils","baseFonts","testString","testSize","s","fontSize","innerHTML","defaultWidth","defaultHeight","index","fontFamily","offsetWidth","offsetHeight","detected","matched","font","default_font_size","_this","images","size","target","width","charWidth","charHeight","height","widthImg","countPerRow","heightImg","rowPerImg","isFontExist","i","url","fontChars","chars","c","ctx","getContext","len","nRow","Math","ceil","drawing","n","base64","toDataURL","blob","_Utils2","dataURLtoBlob","blobUrl","URL","createObjectURL","fontImage","img","Image","srcHeight","src","onload","drawImage","char","test","charCodeAt","_sparkMd","_XmlHttpRequest","Xhr","_Dialog","OtherWap","loadSdkJS","oHead","getElementsByTagName","item","oScript","then","msg","initdata","username","qh_username","gid","qh_qhgid","qhchannel","qh_qhchannel","qhchannelid","qh_qhchannelid","qhsdk","init","price","goodsId","indentId","chapteruuid","context","payindex","callback","sign","_sparkMd2","hash","toString","qh_key","paydata","userId","goodsName","money","roleName","ext","serverId","qh_serverid","payValues","encodeURI","sydata","game_id","uuid","chapter_uuid","amount","set_value","encodeBase64","JSON","stringify","event_id","send","d","xhrSend","rs","rj","pay","console","log","timeout","_Dialog2","custom","location","reload","responseText","retData","parse","status","success","uid","token","u","qhdata","qh_time","qh_isadult","qh_flag","qh_uid","qh_nname","refresh_token","PhoneUtils","key","local","loadingAudioMap","audioErrorResourceRef","client","Arg","audioCountLoadByPhone","total","offline","loadAudioUrl","webkit","messageHandlers","postMessage","volume","loop","precent","musicKey","v","l","musicInfo","prevolume","inheritvolume","tweenId","parseInt","random","playAudioUrl","isclear","stopAudioUrl","setAudioUrlVolume","duration","delay","nTimers","nStep","nCur","doEase","_this2","_this3","soundsInfo","soundKey","channel","some","k","audioResourceRef","removeAudioUrl","loaded","load","onSoundExtendLoad","dispatch","onSoundExtendLoadError","Rephaser","texture","baseTexture","resolution","_res","a","text","wordWrap","runWordWrap","realText","b","split","tabs","e","f","determineFontProperties","g","maxLines","_charCount","h","strokeThickness","padding","x","colors","strokeColors","fontWeights","fontStyles","measureLine","measureText","j","Array","isArray","m","game","math","snapToCeil","max","canvas","o","y","p","q","_lineSpacing","abs","scale","navigator","isCocoonJS","clearRect","fillStyle","fillRect","fill","strokeStyle","stroke","textBaseline","lineWidth","lineCap","lineJoin","r","ascent","align","autoRound","round","updateLine","updateShadow","shadowStroke","strokeText","renderTabLine","shadowFill","fillText","updateTexture","wordWrapWidth","isConnect","reg","combinators","RegExp","terminator","slice","substr","trimLeft","substring","replace","file","onLoad","xhr","arraybuffer","requestObject","response","ArrayBuffer","Uint8Array","isGif","crossOrigin","onComplete","onerror","fileComplete","revokeObjectURL","fileError","spliceGif","frames","loopCount","createBlob","transformUrl","complete","xhrLoad","isPlaying","_sound","usingWebAudio","externalNode","endfun","onended","disconnect","gainNode","stop","noteOff","alert","usingAudioTag","pause","currentTime","pendingPlayback","paused","prevMarker","currentMarker","onMarkerComplete","fadeTween","onStop","sound","_this4","soundData","cache","getSoundData","isSoundDecoded","updateSound","handleError","onSoundDecodeError","warn","decodeAudioData","buffer","decodedSound","onSoundDecode","_this5","indexOf","extension","lastIndexOf","Infinity","isDatAudio","toLowerCase","setFileData","touchLocked","AudioTagPool","get","audio","exist","playThroughEvent","removeEventListener","addEventListener","convertDat","device","android","Blob","isDatFile","crop","w","rotated","source","globalCompositeOperation","PIXI","CanvasTinter","tintWithMultiply","Phaser","Game","prototype","destroyComponent","Signal","spriteDestroy","Sprite","destroy","apply","renderCanvas","_renderCanvas","imageDestroy","buttonDestroy","Button","_this6","Object","keys","forEach","hasOwnProperty","Sound","forceRemoveFileSet","Set","Loader","forceRemoveFile","_this7","asset","getAsset","loading","forceRemoveFileKeys","removeFromCache","has","checkSoundKey","removeSound","checkImageKey","removeImage","fileCompleteListener","progress","cacheKey","totalLoaded","totalFiles","onFileComplete","remove","_fileList","splice","cancelForceRemoveFile","loadAudioTag","soundDestroy","scratchBuffer","createBuffer","Cache","reloadSound","getSound","reloadSoundComplete","Device","canPlayAudio","mp3","ogg","opus","m4a","wav","webm","dolby","SoundManager","setMute","_muted","_muteVolume","masterGain","gain","value","_sounds","iOS","mute","onMute","unsetMute","_codeMuted","resume","onUnMute","ShanyiMenu","back","exit","urlToGo","gameCallback","syMenuBack","syMenuExit","wap","scrolling","frameBorder","_Version","_jsBase","_cryptoJs","_PhoneUtils","Utils","wname","resultUrl","parts","shift","join","currentData","currentPos","hdr","tmpCanvas","spliceCanvas","frame","lastDisposalMethod","transparency","disposalMethod","disposalRestoreFromIdx","lastImg","bitsToNum","ba","reduce","byteToBitArr","bite","push","Stream","readByte","Error","readBytes","bytes","read","String","fromCharCode","readUnsigned","lzwDecode","minCodeSize","pos","readCode","code","clearCode","eoiCode","codeSize","outputBlockSize","bufferBlockSize","output","dict","bufferOffset","outputOffset","clear","keep","enlargeOutput","outputSize","newoutput","set","enlargeBuffer","bufferSize","newbuffer","pushCode","last","newlength","byteLength","newdict","subarray","newsize","setSizes","setTransform","doHdr","_hdr","doGCE","gce","pushFrame","transparencyGiven","transparencyIndex","delayTime","dataUrl","doImg","currIdx","ct","lctFlag","lct","gct","putImageData","leftPos","topPos","imgData","getImageData","pixels","pixel","pix","idx","doNothing","doNetscape","block","iterations","handler","com","app","NETSCAPE","eof","parseGIF","st","parseCT","entries","readSubBlocks","offset","bufsize","resizeBuffer","newdata","parseHeader","sig","ver","bits","gctFlag","colorRes","sorted","gctSize","bgColor","pixelAspectRatio","parseExt","parseGCExt","reserved","userInput","parseComExt","comment","parsePTExt","ptHeader","ptData","pte","parseAppExt","parseNetscapeExt","unknown","parseUnknownAppExt","appData","identifier","authCode","parseUnknownExt","label","extType","parseImg","deinterlace","newPixels","rows","cpRow","toRow","fromRow","_ref","fromPixels","concat","_toConsumableArray","offsets","steps","pass","interlaced","lctSize","lzwMinCodeSize","lzwData","parseBlock","sentinel","stream","err","error","tempColor","match","toHex","hex","isNaN","time","handle","promise","clearTimeout","xhrGetServerTime","timeStamp","timestamp","timeOffset","curLocalTime","localTime","setInterval","floor","Date","getTime","systemValues","date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getDay","seperator1","seperator2","toStr","min","currentdate","BlobBuilder","bb","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","append","getBlob","arr","mime","bStr","atob","u8arr","blobObj","message","Base64","encode","decode","rawKey","rawVec","_cryptoJs2","enc","Utf8","ivv","encrypted","AES","encrypt","iv","mode","CBC","pad","ZeroPadding","enstr","decrypted","decrypt","ECB","deStr","cookie","decodeURI","getCookie","app_version","localStorage","getItem","retValue","localStorage_getItem","returnValue","setItem","localStorage_setItem","arg","removeItem","removeLocalStorage","call","result","sensitiveWords","aesDecrypt","userAgent","deviceId","getDeviceId","stime","sSign","aesEncrypt","encodeURIComponent","doSend","selOptions","timerHandler","searchChapter","chapter","subchapters","chapters","soundVolume","musicVolume","DelayRemoveManager","_classCallCheck","gifList","imgList","findIndex","ResourcesManager","getCount","now","addRefCount","popGif","popImg","isPlot","sKey","convertToAllowAccessControlOriginUrl","noLoading","image","bAutoDecode","forceDecode","music","sounds","noCache","_PhoneUtils2","isAudioInCache","isLoadingAudio","fun","refCount","filterKeys","obj","oldData","_oldData$global","global","_oldData$cache","newData","prefix","startsWith","fKey","fRefType","tKey","tRefType","refType","count","_this8","_this9","acc","cur","force","_usingKeyMap","usingKeyMap","preBackground","audioTag","free","PreloadState","delayRemoveManager","startPreloadResources","getImage","_this10","createhMark","_ref2","pIndex","cmdInfo","cIndex","preloadType","preloadedCount","lock","_objectWithoutProperties","stack","cmdStack","getOptinsMarks","plot","mark","marks","options","option","plots","temp","t","checkCondOptionResources","commands","getCmdOptinsMarks","cmd","_mark$cIndex2","args","parentInfo","parentCmdIndex","updateMarkCmdInfo","updateMark","_mark","_mark$pIndex3","_mark$cIndex3","pChapter","pnPlot","cmdIndex","_preMark","searchChapterByUUID","gameData","updateLoadedMarks","specialTypes","LoadedMark","_mark2","_mark2$pIndex","_mark2$cIndex","weight","isNoUrgentlyMark","optionCount","_plot$options","_plot$condition_optio","condition_options","pushLoadMarks","_ref3","_ref4","_plot$options2","_plot$condition_optio2","oMarks","cMarks","jump","insert","revertMark","_mark$context$_preMar","loadChapter","md5","chapterUuid","downloadUuid","loadChapterPromise","_ref5","_ref5$plots","_chapter$plots","loadingChapterMap","sceneProxy","checkIfChapterFree","_mark$preloadType","types","map","optionIndexs","condOptionIndexs","gotoIndexs","preloadResources","promises","loadedCount","_loop","markPromises","_loop2","all","pushInLoader","assign","pushed","pushedList","filter","start","preloaded","finish","transferByRefCount","updateRefTypePrefix","updateLoadMarkByPrefix","_this11","cmdPlotSnap","_cmdPlotSnap$cmdIndex","resetReCount","usingResourceCountMap","forEachReCount","getResourcesByContext","_this12","opIndex","_this13","optionMarks","nextJump","every","isSame","clearLoadMarkByPrefix","_this14","_this15","optionType","_plot$options3","_plot$condition_optio3","sameIndex","_this16","_plot$condition_optio4","loadedMark","_this17","_loadedMark$pIndex","_loadedMark$cIndex","resources","addResource","getResourceSize","getInCmdInfo","getCommandResources","getInChapter","getPlotResources","needPop","pop","getWeatherOfflinePathName","getWeatherFilePathName","formatNum","isBackground","avatar","isMusic","isSound","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","normal","active","disable","getWeatherResources","_command$args$","plot_sound","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","characters","character","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","props","prop","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","weather","_this18","OptionResourcesCountMap","resourcesMap","getCountInOption","getCountInCmdOptions","getCountInOptions","getCountInCmdOption","_this19","canAddRefCount","isMaxSize","MaxSize","createMark","_ref6","createJumpMark","_content","newChapter","createInsertMark","_content2","getInCommand","musics","MaxForceDecodeMusic","preloadCmdOptions","optionPromises","_loop3","newCmdInfo","newpreloadType","pushMark","_loop4","opPlotIndex","_extends","_ret5","getInNextCommand","nextPlot","_ref7","Number","isInteger","getPlotOptionCount","getInPlot","preloadPlotOptions","opMarks","copMarks","condOptionPromises","loadPlotIntoPromise","_loop5","newPreloadType","optChapter","_loop6","optionPromise","condoptionPromise","getInNextPlot","checkResources","sizes","_ref8","oldKey","subRefCount","_usingKeyMap2","Map","freeAudio","pool","find","addAudio","play","freeCount","commit","version","serializeQuery","params","val","XMLHttpRequest","open","readyState","onProgress","ontimeout","onreadystatechange","withCredentials","setRequestHeader","istimeout","responseType","getJson","getMaterialRedirect","urls","materialRedirect","json","getGame","getTestGame","getOtherGame","SimpleCommand","execute","note","facade","registerProxy","model","proxy","SceneProxy","registerMediator","view","mediator","SceneMediator","MacroCommand","initializeMacroCommand","addSubCommand","PrepareControllerCommand","PrepareModelCommand","PrepareViewCommand","innerWidth","documentElement","innerHeight","_ShanyiMenu","_FontUtils","_OtherWap","_copyToClipboard","_jsonp","Proxy","chargeMsgReceive","ev","originalEvent","newValue","resumeAudio","bk_music","plotSounds","pauseAudio","preloadingBegin","stringMap","loadMenu","overMenu","settingsMenu","startMenu","menu","mainMenu","save","playback","autoplay","manualPlay","settings","displayHeader","displayCaption","volumeHeader","musicCaption","soundCaption","textHeader","textCaption","autoOn","autoOff","windowMode","fullMode","progressTips","recordTipCount","isShowGuide","playbackData","plotViews","prgsViews","plotViewKeys","bViewLoaded","bSignedIn","bCloudSel","visibleLayout","resourceManager","plotIndex","resourceList","baseList","lstDialogInfo","menuInfo","quickPlay","isScreenHold","bCmdAutoText","isGameStarted","usedStarCount","gameStarLimit","lstPlotTweens","twinkleTimer","uiOnLoadQueue","timerCounts","menuTimer","recUidBelongTo","gameUidBelongTo","bSwitchAccInPlot","payValueUid","unlockChapterCallBack","mallPayCallback","isPaying","isGettingNext","isPreferentialFinished","preferentialVector","isSetValues","isPaySuccess","isGoToCommand","shakeLoopObj","level","prePlotBkKey","isQuickPlay","hasCountDown","playAdCallBack","saveBubbleVector","saveBubbleDataVector","bubbleArchivalCount","dialogNext","isWapOther","_OtherWap2","sendQHData","initQHSdk","audioMgr","bind","audioCanPlayCallBack","audioErrorCallBack","updateAccInfo","unlockChapterFinished","mallPay","preferentialFinished","showSave","showSaveInterface","playadBack","playadBackInterface","adtype","recordLayer","visible","fullScreen","onSettingsWindowModeBtnClicked","menuLayer","getSnap","downloaduuid","curChapter","stayIfFail","dislodgePreferentVector","checkIfMallPaySuccess","getData","serial_num","c_status","getUserInfoFromWap","addAssets","addImage","viewComponent","addImageUrl","onabort","parseJsonFile","json_data","template","parseTemplateCoverAssets","parseTemplateDialogAssets","parseTemplateMenuAssets","parseTemplateSyMenuAssets","parseTemplateMainMenuAssets","parseTemplateSettingsAssets","parseTemplateOptionAssets","parseTemplatePlaybackAssets","parseTemplateRecordAssets","parseTemplateSoundAssets","_FontUtils2","logo","cover","addEventAssets","events","subEvent","viewMap","children","child","_json_data$template$j","titleContainer","_json_data$template$j2","dialog","avatarContainer","_json_data$template$j3","shanyiMenu","_json_data$template$j4","_json_data$template$j5","header","_json_data$template$j6","unchecked","checked","_json_data$template$j7","_json_data$template$j8","scrollBox","_json_data$template$j9","record","_jsonp2","showLogo","showCover","showMainMenu","onPause","showSettings","callbackInfo","mainMenuLayer","showPlayback","bLocalCloudSwitch","bToSaveFile","loadData","showRecord","showLoad","getUidByCookie","getPayInfo","showEnd","isPlotResourceExist","plotInfo","useIOSAudio","app_versionl","usingCountMap","hasCheckCount","isNotExist","isGlobal","isUsingKey","checkCmd","isExistWeatherResources","cmdState","autotext","hasOption","isSafeState","checkCmds","_arr","_i","getLoadingPlotResource","countCmd","getInCommands","res","_resources","keyMap","imgCount","world","soundCount","resetResources","usingCount","getResources","cmdScreenSnap","_ResourcesManager$usi","addResources","getMusic","charsAndProps","bubble","cp","getbubbleurl","ary","cmds","_cmds$args$","bubbleMode","_cmdPlotSnap$cmdScree","dialogInfo","bk","weatherType","preloadCommandsAssets","needLoad","preloadChapterAssets","restart","curPlotIndex","needLoadList","enableLayerInput","layer","bEnabled","enableChild","inputEnabled","apToFinalState","charsAndPropsLayer","exists","imgGroup","finalState","alpha","angle","removePlotTweens","tween","playPause","tweens","_tweens","onResume","resumeAll","onCoverStartBtnClicked","findFirstChapter","otherback","_copyToClipboard2","debug","unlockChapterByWapOther","charge","_chapter$plots2","info","href","coverLayer","unlockFinish","bSuccess","playLogin","unlockChapter","onCoverLoadBtnClicked","onCoverSettingBtnClicked","onCoverOverBtnClicked","opener","top","onMenuBtnClicked","onSyMenuBtnClicked","closGame","_ShanyiMenu2","showSyMenu","moreWorks","onMainMenuSaveBtnClicked","disableSaveOrLoad","showToast","onMainMenuLoadBtnClicked","onMainMenuPlaybackBtnClicked","onMainMenuAutoplayBtnClicked","auto","onMainMenuBackBtnClicked","onMainMenuSettingsBtnClicked","curPlotLayer","onChildInputDown","onSettingsFullModeBtnClicked","startFullScreen","stopFullScreen","onSettingsAutoOnBtnClicked","onSettingsAutoOffBtnClicked","onSettingsBackBtnClicked","settingsLayer","onRecordBackBtnClicked","showMenu","cmdPlotNextPromise","onRecordLocalBtnClicked","onRecordCloudBtnClicked","curPlotInfo","hidden","showGuideTip","id","isSignedIn","loadCloudRecord","convertCloudData","cdata","rdata","plotUuid","strTS","time_stamp","plotSnap","plot_snap","cloudPlotsData","getAccountInfo","checkChapter","isFirst","notifyGameStarted","gameStart","isWap3000","bLogout","bEntering","localRecFileToUidRecFile","recId","userData","localStorageGetItem","savedData","localStorageSetItem","localStorageRemoveItem","getFansInfo","fans_total","saveAccountInfo","sendData","systemvalue","saveGameValue","systemvaluestr","systemvalueBase64","systemData","readGameValue","values","decryptBase64","payInfoData","savePayInfo","payvalue","payvaluestr","payvaluesBase64","getPayGoodsInfo","goodsid","formatdata","dd","getDiscounts","gameId","productId","platform","payOperation","disCounts","invokeApp","payArg","eid","special_price","balance","starsNeed","stars","starsUsed","starsLimited","worksmall","consume_falg","get_account_info","chapterInfoProgress","prgsInfo","group","getByName","graphics","beginFill","drawRect","endFill","boundsAlignH","boundsAlignV","setTextBounds","chapterMd5","showProgress","evt","callBack","getcount","game_uuid","payback","discounts","generateuuid","generateUUID","msg1","getchapterinfo","chapter_md5","chaptercharge","unlockArg","unlock","wapunlockArg","author_id","getPhoneData","app_name","device_name","deviceOsVer","saveCloudRecord","aesKeyType","str","savedPlotsData","strBase64","getViewData","items","subView","visitChild","xInfo","yInfo","instanceUuid","eventsInfo","viewType","currentCount","generateType","getViewParentEvents","ref","copyFlashViewData","commandObj","bVisible","historyCommand","hideGlobalViews","dest","getWeatherType","weatherLayer","getScreenAnime","getBubbleData","clearBubbleData","savebubble","curbubble","ishide","iscurrent","bubbleUpper","buuid","cleardata","_this20","clearcount","getcountindex","gindex","removeborder","bubbleLayer","getindex","bc","ii","saveRecord","_this21","default_settings","autoSaveOrLoad","globalViews","chAndProps","saveData","bkKey","lstPlotBkKey","bkOpacity","lstPlotBkOpacity","bkFlex","lstPlotBkFlex","cmdUuid","curCmdUuid","animateScene","shake","bubbleCount","opacity","pivotX","pivot","pivotY","scaleX","scaleY","rotate","zIndex","parentScale","mirrorH","mirrorV","loadRecord","_this22","_savedPlotsData$index","goRecord","nChapter","nPlot","destroyAll","charsAndPropsInfo","endLayer","addPlayBackContent","getCommandByCommandUuid","autoText","initContext","commandInserts","inserts","goRecordHandle","_getChapterByPlotUuid","getChapterByPlotUuid","_getChapterByPlotUuid2","unlockLoadRecord","_chapter$plots3","_chapter$plots4","_chapter$plots6","_chapter$plots5","onRecordItemClicked","iCol","iRow","_this23","itemContent","itemTime","setPreviewImage","loadTexture","snapMd5","strText","getCurrentDateTime","fh","toRealImageFontHeight","fw","toRealImageFontWidth","addImageFontText","backgroundObject","savedValues","stringValues","indexValues","saved","vi","globalViewsData","Expression","safeEval","viewsData","speakings","parsebubble","bdata","bubblemode","modecommands","bubbleary","curbubbleary","show","_cdata$commandObj$his","commandUuid","onPlaybackBackBtnClicked","playBackLayer","removeAll","showLoadingToast","loadingToastLayer","bringToTop","ss","toastLayer","ee","from","addRetroText","txtData","retroFont","txtImg","fontImg","stamp","setText","addImageFontTextColors","txtObj","iPos","realData","lineBreak","placeholder","parseWaitTime","parseValue","clr","addColor","font_width","font_height","bSpeaking","bSpeakHidden","_this24","charGroup","mask","getChildAt","removeChildren","xPos","yPos","cr","bkWidth","firstMargin","fontHeight","parseFloat","fontWidth","t_h","font_size","sizeRow","seperation","itemChar","charCount","posInfo","getLeftMargin","getCharSpace","bottomInText","charsBk","sprite","imgTxt","tint","addChild","extWidth","extMargin","imgFBottom","maskWidth","maskHeight","rect","_this25","_this26","updateRender","translate","PI","restore","searchPlot","searchPlotByOption","nIndex","searchPlotByChapter","subchapter","searchCommandInOption","ops","pCmdInfo","searchCommand","getCmdScreenSnap","bkInfo","getNextPlot","eArg","preStackFrame","preCmdStackFrame","loopCondition","condOptIndex","expression","condOpt","loopCountExpr","jumpUuid","jumpChapter","isCommand","curCmdInfo","curCmdIndex","pPlotUuid","isMenu","isMainMenu","cmdResult","snap","_context$commandInser","_context$inserts$pop","serchchapter","_getChapterByPlotUuid3","getNextCommand","action","rCmdInfo","rIndex","optionLayer","removeInputView","inputElement","removeViewTimer","_this27","timerType","clearInterval","filterInexistentPlotViews","views","isUuidExist","_this28","plotViewsLayer","stopMusic","stopSound","lstPlotLayer","reStart","_this29","isextend","workFinished","dialogLayer","_chapter$plots7","valueOperation","bCancelUpload","_this30","uploadPayValue","indexValueOperator","reference","isupload","isnext","setvalues","updateValues","oldContext","tempValues","isLoad","copy","strSavedValues","lstSavedValues","getTimeOffset","updateContextTimeValues","doInCT","func","txtLineSpace","desktop","updateMusicVolume","animateMusic","updateSoundVolume","nextToPlay","isViewEvent","decodeCacheAudio","updateUsingKey","playMusic","playInheritMusic","playSound","playInheritSound","_this31","decoded","isDecoding","countDecoded","audioKeys","getKeys","SOUND","Boolean","isExtend","extend","isShowLocalBtn","isShowCloudBtn","_createClass","radix","expr","_this32","evaluate","arg1","arg2","isString","sub","mul","div","mod","toN","toInt","range","end","safeInitValue","toWeek","NaN","initValue","onlyRead","_this33","oldValue","newExpr","fixArg1","fix","fixArgs","sort","string","isGetName","parseValueFormat","exec","nameStr","toFixed","parsePauseFormat","timer","_timer$time","countDown","num1","num2","len1","len2","pow","str1","str2","includes","fixed","guideLayer","progressLayer","quickPlayLayer","btn_sound","audioDecodedCount","lstGameBk","Template","space_key","globalViewKeys","cmdPlayHandlerFun","preWaitCmdUuid","_RePhaser","constructor","scene","ww","hh","state","scaleMode","ScaleManager","SHOW_ALL","fullScreenScaleMode","pageAlignVertically","pageAlignHorizontally","stage","disableVisibilityChange","isIphone","orientation","setResizeCallback","scaleManager","rectangle","getElementById","setGameSize","setBounds","refresh","loadImageTag","_RePhaser2","renderer","renderSession","roundPixels","soundDecode","iOSVersion","input","touch","addTouchLockCallback","preload","create","oncontextmenu","preventDefault","startBk","onRendered","update","phaserRender","CANVAS","agentV","AUTO","preserveDrawingBuffer","_Version2","logo_preloader","anchor","setTo","showOfflineBg","offlinebg","setChildIndex","showLoading","loading_gif","addGifAnimation","destroyLogo","logInfo","preLoadCertainAssets","spritesheet","preLoad","onLoadStart","addOnce","addLog","onLoadComplete","getGameJson","iswapother","lengthComputable","percentComplete","textGroup","addButton","key_normal","key_active","onClick","isCheckBox","changeImageText","textInfo","textObj","txtImgOld","strContent","rgb","changeBackground","buttonGroup","btnObj","bk_key","fontWeight","btnGroup","bk_key_normal","bk_key_active","isdown","btnobj","btnpointer","butclick","pointer","button","setOverSound","setDownSound","onInputOut","onInputUp","fontStyle","ff","mouseOut","_pointerData","isOver","isOut","timeOut","useHandCursor","isDragged","cursor","_setHandCursor","onInputOut$dispatch","GROUP","onChildInputOut","onInputOver","onOverSound","onInputDown","onDownSound","_image$data","nCount","setFrame","base","BaseTexture","Texture","setTexture","addFitImageSprint","getAt","removeChildAt","childGroup","TEXT_CHANGED","Mediator","listNotificationInterests","handleNotification","getName","showCoverLayer","onRegister","retrieveProxy","sceneMediator","retrieveMediator","addCover","_sceneProxy$json_data","_template$json$cover","worldWidth","worlHeight","addTextContent","objText","isTitle","onBtnClicked","pointerMode","PointerMode","CURSOR","backgroundKey","flex","rate","_cover$title","bold","titleText","_sceneProxy$json_data2","showEndLayer","btnStatesChanged","keyBk","buttonKey","addEnd","text_normal","itemBlackBk","bitmapData","item_bk","text_active","btn_load","txt_load","btn_back","txt_back","btn_save","txt_save","HtmlTextBox","family","Group","parentElement","parentNode","textBoxElement","position","margin","left","borderColor","outline","insertBefore","_x","_y","_width","_height","_fontSize","isValue","existing","onDestroy","canvasX","offsetLeft","canvasY","offsetTop","canvasWidth","canvasHeight","oldCanvasWidth","oldCanvasHeight","oldCanvasX","oldCanvasY","gameWidth","gameHeight","widthScale","heightScale","xScale","yScale","newX","newY","newWidth","newHeight","setLeft","setTop","setWidth","setHeight","setFontSize","bShow","visibility","setInputCallback","inputUpdate","_text","word","rw","repeat","onblur","setClickCallback","setEnable","readOnly","defineProperty","_style","getBody","showMainMenuLayer","isAllHide","addMainMenu","addImgFontText","head","addDiyMainMenuenu","mainMenuView","registerViewKey","menuView","addView","getTimerInMenu","visitInChild","uiOnLoadInvoker","autoButton","showPlaybackLayer","addPlaybackContent","addPlayback","boxX","boxY","boxWidth","boxHeight","backgroundRect","scrollBk","scrollPane","scrollX","scrollY","itemHeight","hSpace","dragStartPointX","dragStartY","wheelEvent","onMove","point","getPoint","mousewheelevt","onMouseWheel","onScroll","onDragUpdate","pt","bFromStart","px","py","worldY","worldX","enableDrag","disableDrag","delta","wheelDelta","detail","allowHorizontalDrag","addMoveCallback","callbackFun","callbackArgs","addPlaybackItem","keyItemBk","keySubItemBk","contentX","contentY","itemGroup","itemBackground","itemText","useAdvancedWrap","updateText","advancedWordWrap","lineSpacing","showRecordLayer","localMode","isChangeClick","clicktime","clickchangetime","onLocalBtnClicked","clickInterval","btnLocal","btnCloud","onCloudBtnClicked","addRecord","boxRect","boxItem","itemsOffsetX","itemsOffsetY","itemSpaceX","vSpace","itemSpaceY","itemRect","hint","hintRect","hintText","contentRect","itemX","itemY","itemWidth","hintX","hintY","hintWidth","hintHeight","contentWidth","contentHeight","nCol","nLeft","nTop","ptDown","dragBk","isSaveOrGet","scrollHeight","onDragStart","onDragStop","onItemUp","subItem","txtTime","itemMask","autoRecord_Bk","autoRecord","autoRecord_txt","updateItems","bKey","showGuide","times","_HtmlTextBox","TextBox","keyboard","addKey","Keyboard","SPACEBAR","z_key","Z","onDown","onUp","onHold","screenCaptured","screenReleased","generateLayers","addToastLayer","addLoadingToastLayer","imgContinue","cimg","assetsLoaderStart","addMenuLayer","showPlot","destroyView","showInputView","animateTweens","icon","f1","t1","f2","t2","quickPlayHandler","hasView","hasBubble","Pointer","cmdPlotLoadResources","usePhoneUtils","needLoadNum","loadingAssets","newResources","clearPreCmdResources","assetsLoader","showtype","CloudImg","inputEnableChildren","tweenToPromise","guidedata","tl","toastText","typeSuccess","typeError","bk1","bk2","nextNotifier","_ref3$needLoadList","assets","isChapter","decodingAudios","loadedFileCount","canUsePhoneAudioLoad","covermusickey","isAudioError","_totalFileCount","totalFileCount","isLoadComplete","covermusiccomplete","updateLoadedCount","checkFinished","hasAudioLoadFinish","handleSoundExtendLoad","handleSoundDecodeError","checkKey","autoDecode","_sceneProxy","_logo$background","game_logo","backgroundFlex","type0","type1","progressText","fontSytle","addDialogLayer","dialog_bk","dialog_bk_title","bSetFixed","menuBtnClick","doEffectsAnimation","doAnimation","addRainEffect","rain","rain1","addSnowEffect","snow","snow1","addWindEffect","wind","wind1","tileSprite","autoScroll","addFallingLeavesEffect","fLeaves","fLeaves1","addBeachBlossomEffect","beachBlossom","beachBlossom1","addBlossomEffect","blossom","blossom1","addLightningEffect","lightning","lightning1","refUuid","parentEvents","arrKeys","removeKey","keyCode","doReg","removeViewKey","removeViewKeyByInstance","unReg","doUnReg","addGlobalView","refUuidToHide","scaleInputView","parentLayer","isRefresh","isload","diymenu","viewInfo","containerLayer","viewInfoName","_sceneProxy2","pointX","pointY","clearDiyMenu","eventHandler","nextAction","ispay","isplayad","showNextPlot","refreshView","refreshViews","_ret","uuidToClose","objParent","bCloseMainMenu","getCloseUuid","bSingleToClose","diyMainMenu","isParent","self","realUuid","_typeof","_sceneProxy$getNextCo","_sceneProxy$getNextCo2","adback","backtype","playAdVideo","keyUpCallback","event","eventCallback","callfun","invokeEventInfo","unshift","es","invokeHandler","pausedCallback","_ret3","onViewClicked","isHanding","addItemClickedCallback","onLoadCallback","onKeyUpCallback","onLoadBack","object","eventsInfoCopy","clickEvent","bkImg","bkPrgs","hType","vType","basePoint","updateProgressView","inputCallback","updateValue","realV","vv","ri","mgrParent","isStepCanSkip","onStepTimeOut","step","onStepInterval","scalechild","_ret4","prgs","nWidth","nHeight","pWidth","pHeight","isMask","mover","viewLayerName","destroyInChild","bReload","getRefreshViews","newViews","oldView","newView","bExist","oldIndex","sx","sy","refxy","cws","getScaleValue","vx","vy","bkSprite","properties","ease","autoStart","yoyo","to","tweenFromPromise","addBubbleBorder","remark","origialH","itemlength","bubbley","bg","scrollgraphics","startx","starty","updatex","updatey","gonext","scorllfun","isbottom","createBubble","role","bubbleborder","onlycontent","cbgcolor","bubbleavatar","rolestyle","roledata","roletxt","contentimg","contenttextstyle","contentext","contextdata","contentbg","ch","drawRoundedRect","addChildAt","offsetx","offsety","trianglex","triangley","triangle","moveTo","lineTo","titleTxt","contentTxt","isShowAll","appCanBack","sceneShake","offSet","curOffSet","isShaking","speaking","coverage","snakename","cnpx","cnpy","clearShake","sceneTwinkle","twinkle","fixColorValue","fadeIn","curtain","screen1","screen2","interlacing","createScreen","screen","spase","createmask","__x","__y","coverblack","bk_x","bk_y","spread","visibleweather","plotindex","getChildIndex","cnpindex","dialogindex","spreadgroup","isSpreading","spreadmask","plotx","ploty","plotw","ploth","centerX","centerY","playEffect","animations","animation","_sceneProxy$json_data3","dialog_bk_avatar","dialog_avatar","dialogtitle","_avatarContainer$avat","clip","poly","Polygon","Point","drawPolygon","points","bezierCurveTo","drawCircle","_dialogInfo$dialogtit","titleStyle","titleX","titleY","setStyle","playPlotSound","addBackground","plotLayer","isInherit","bk_alpha","bk_flex","addCharsProps","_i3","cApAnimationIn","trigger","addOptions","txtOptions","timerHandles","countDownPromises","_sceneProxy$json_data4","normal_bk_key","active_bk_key","disable_bk_key","_txtOptions$i","disabledTextInfo","op_sound","btng","getGameValueByTimer","hideTimer","timerHandle","Timer","SECOND","alive","results","addWeather","_sceneProxy$weatherLa","addPlotViews","found","loadSubViews","sView","showGlobalViews","bLoadRec","savedSubView","fixTimerCount","fixViewEventsInfo","_i5","deleteSubView","itemInfo","parentView","foundinItem","tempRefer","createSubView","foundTemp","musicIn","tweenFromMusic","musicOut","tweenToMusic","dialogIn","In","From","moveFrom","dialogOut","Out","To","fadeOut","animateIn","animateOut","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","xStep","yStep","pauseSpeaking","remain","contextScrollToBottom","bottom","maxHeight","animationSpeak","current","speed","textShow","nLine","doSpeak","speakInfo","showImmediate","immediate","clickProxy","keyProxy","race","playWait","waitTime","savePlayBackContent","speakData","playNormal","nromalnext","playCommands","isRecover","curborder","recoverCmdSnap","snapInfo","screencommands","doShake","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_step6","_iterator6","recbubble","addborder","bordercommands","hasborder","saveary","curary","hide","addbubble","bubblecommands","recover","recViews","recMenu","resetBorder","nextCmdCallback","_ret8","old","index1","index2","_loop7","lstAlpha","lstAngle","lstX","xRaw","xMoveTo","lstY","yRaw","yMoveTo","lstScaleX","lstScaleY","_ret9","normalPropsTo","scalePropTo","tweenToSound","opt","resetCmdPOptionPreload","bi","getcur","getborder","gborder","addClick","ac","playHandler","_sceneProxy$getNextCo3","doCmdInfo","_sceneProxy$getNextCo4","bcommands","endPlot","bhide","_sceneProxy$getNextPl","newContext","goNext","getPlotIndex","puuid","gameOver","_sceneProxy$getNextPl2","cps","nc","np","npc","optionIndex","nextPlotType","resetPlotOptionPreload","clearPrePlotResources","resetJumpPreload","resetInsertPreload","loadingResourceList","stayCurrentPlot","_sceneProxy$getNextPl3","_nChapter$plots3","_nChapter$plots","_nChapter$plots2","ispreferent","duuid","unlockPreferentialFinish","setViewComponent","component","Scene","CoverMediator","SettingsMediator","MainMenuMediator","RecordMediator","PlaybackMediator","EndMediator","onRemove","showSettingsLayer","full","on","off","updateVolumeProgress","progGroup","pk","progbk","totalwidth","addSettings","_sceneProxy$json_data5","addProgress","norkey","progkey","rc","normalkey","progresskey","progpk","isProgDown","addTextBk","colorS","modeBtnClicked","argv","rectScreenMode","isFullScreen","rectTextMode","fullScreenHandler","onFullScreenChange"],"mappings":"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","file":"build/app.js.map","sourcesContent":["// create the diygamePlayer namespace\r\nwindow.diygamePlayer =\r\n{\r\n    AppConstants: {\r\n        /** Commands */\r\n        CMD_STARTUP: \"CMD_STARTUP\",\r\n        CMD_FRAME_ENTER: \"CMD_FRAME_ENTER\",\r\n        CMD_SVG_MENU: \"CMD_SVG_MENU\",\r\n        CMD_LOAD_GAME: \"CMD_LOAD_GAME\",\r\n        CMD_UPDATE_MUSIC_STATE: \"CMD_UPDATE_MUSIC_STATE\",\r\n\r\n        /** Notification name constants */\r\n        APP_DEBUG_MODE: \"APP_DEBUG_MODE\",\r\n        APP_LOG: \"APP_LOG\",\r\n        APP_SHOW_INSPECTOR: \"APP_SHOW_INSPECTOR\",\r\n        APP_SHOW_MENUBAR: \"APP_SHOW_MENUBAR\",\r\n        APP_FPS_UPDATE: \"APP_FPS_UPDATE\",\r\n\r\n        STAGE_TRAP_MOUSE: \"STAGE_TRAP_MOUSE\",\r\n\r\n        SCENE_SHOW_ERROR: \"SCENE_SHOW_ERROR\",\r\n        SCENE_SHOW_SAVE_ALERT: \"SCENE_SHOW_SAVE_ALERT\",\r\n        SCENE_SHOW_AD: \"SCENE_SHOW_AD\",\r\n        SCENE_TOOGLE_SCREEN_STATE: \"SCENE_TOOGLE_SCREEN_STATE\",\r\n        SCENE_SKIPPING: \"SCENE_SKIPPING\",\r\n        SCENE_PRELOADING_BEGIN: \"SCENE_PRELOADING_BEGIN\",\r\n        SCENE_PRELOADING_PROGRESS: \"SCENE_PRELOADING_PROGRESS\",\r\n        SCENE_PRELOADING_COMPLETE: \"SCENE_PRELOADING_COMPLETE\",\r\n        SCENE_LOADING_BEGIN: \"SCENE_LOADING_BEGIN\",\r\n        SCENE_LOADING_PROGRESS: \"SCENE_LOADING_PROGRESS\",\r\n        SCENE_LOADING_COMPLETE: \"SCENE_LOADING_COMPLETE\",\r\n        SCENE_TEMPLATE_LOADED: \"SCENE_TEMPLATE_LOADED\",\r\n        SCENE_SHOW_LOGO: \"SCENE_SHOW_LOGO\",\r\n        SCENE_GOTO_COVERMENU: \"SCENE_GOTO_COVERMENU\",\r\n        SCENE_GOTO_MAINMENU: \"SCENE_GOTO_MAINMENU\",\r\n        SCENE_GOTO_SETTINGS: \"SCENE_GOTO_SETTINGS\",\r\n        SCENE_GOTO_PLAYBACK: \"SCENE_GOTO_PLAYBACK\",\r\n        SCENE_GOTO_RECORD: \"SCENE_GOTO_RECORD\",\r\n        SCENE_GOTO_END: \"SCENE_GOTO_END\",\r\n        SCENE_CLOSE_MENU: \"SCENE_CLOSE_MENU\",\r\n        SCENE_PLOT_ANIM_BEGIN: \"SCENE_PLOT_ANIM_BEGIN\",\r\n        SCENE_PLOT_SKIP: \"SCENE_PLOT_SKIP\",\r\n        SCENE_PLOT_CLOSED: \"SCENE_PLOT_CLOSED\",\r\n        SCENE_PLOT_LOAD_BEGIN: \"SCENE_PLOT_LOAD_BEGIN\",\r\n        SCENE_PLOT_LOAD_ASSETS_READY: \"SCENE_PLOT_LOAD_ASSETS_READY\",\r\n        SCENE_PLOT_LOAD_ASSETS_LOADED: \"SCENE_PLOT_LOAD_ASSETS_LOADED\",\r\n        SCENE_PLOT_LOAD_END: \"SCENE_PLOT_LOAD_END\",\r\n        SCENE_BACKGROUND_COLOR_UPDATE: \"SCENE_BACKGROUND_COLOR_UPDATE\",\r\n        SCENE_BACKGROUND_UPDATE: \"SCENE_BACKGROUND_UPDATE\",\r\n        SCENE_BACKGROUND_ENTERED: \"SCENE_BACKGROUND_ENTERED\",\r\n        SCENE_BACKGROUND_SWITCH: \"SCENE_BACKGROUND_SWITCH\",\r\n        SCENE_MUSIC_UPDATE: \"SCENE_MUSIC_UPDATE\",\r\n        SCENE_SOUND_UPDATE: \"SCENE_SOUND_UPDATE\",\r\n        SCENE_CHARACTER_UPDATE: \"SCENE_CHARACTER_UPDATE\",\r\n        SCENE_PROP_UPDATE: \"SCENE_PROP_UPDATE\",\r\n        SCENE_VIEW_UPDATE: \"SCENE_VIEW_UPDATE\",\r\n        SCENE_DIALOG_UPDATE: \"SCENE_DIALOG_UPDATE\",\r\n        SCENE_DIALOG_COMPLETE: \"SCENE_DIALOG_COMPLETE\",\r\n        SCENE_CHECK_IF_SKIP: \"SCENE_CHECK_IF_SKIP\",\r\n        SCENE_CLICK_ON_SCENE: \"SCENE_CLICK_ON_SCENE\",\r\n        SCENE_OPTION_UPDATE: \"SCENE_OPTION_UPDATE\",\r\n        SCENE_MENUBUTTON_UPDATE: \"SCENE_MENUBUTTON_UPDATE\",\r\n        SCENE_WEATHER_UPDATE: \"SCENE_WEATHER_UPDATE\",\r\n        SCENE_EFFECT_SHAKE: \"SCENE_EFFECT_SHAKE\",\r\n        SCENE_EFFECT_TWINKLE: \"SCENE_EFFECT_TWINKLE\",\r\n        SCENE_CLEAR: \"SCENE_CLEAR\",\r\n        SCENE_SHOW_GUIDE:\"SCENE_SHOW_GUIDE\",//显示引导层\r\n        ADD_PLAYBACK_CONTENT: \"ADD_PLAYBACK_CONTENT\",\r\n        SCENE_DESTROY_VIEW: \"SCENE_DESTROY_VIEW\",\r\n        SCENE_SHOW_INPUT_VIEW: \"SCENE_SHOW_INPUT_VIEW\"\r\n    }\r\n};\r\n","/**\r\n * @class diygamePlayer.ApplicationFacade\r\n * @extends puremvc.Facade\r\n */\r\nimport puremvc from 'puremvc';\r\npuremvc.define\r\n(\r\n\t// CLASS INFO\r\n\t{\r\n\t\tname: 'diygamePlayer.ApplicationFacade',\r\n\t\tparent: puremvc.Facade\r\n\t}, \r\n\t\r\n\t// INSTANCE MEMBERS\r\n\t{\r\n\t\t/**\r\n\t\t * A convenience method to start the PureMVC apparatus\r\n\t\t * \r\n\t\t * @return {void}\r\n\t\t */\r\n\t\tstartup: function ()\r\n\t\t{\r\n\t\t\tif (!this.initialized)\r\n\t\t\t{\r\n\t\t\t\tthis.initialized= true;\r\n\t\t\t\t// associate the SetupCommand with the STARTUP notification\r\n\t\t\t\tthis.registerCommand( diygamePlayer.AppConstants.CMD_STARTUP, diygamePlayer.controller.command.StartupCommand );\r\n\t\t\t\t// issue the SETUP notification to execute StartupCommand\r\n\t\t\t\tthis.sendNotification( diygamePlayer.AppConstants.CMD_STARTUP );\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t// STATIC MEMBERS\r\n\t{\r\n\t\t/**\r\n\t\t * Retrieve an instance of ApplicationFacade. If one has not yet been\r\n\t\t * instantiated, one will be created for you. \r\n\t\t * \r\n\t\t * @static\r\n\t\t * @param {string} multitonKey\r\n\t\t * @return demo.ApplicationFacade\r\n\t\t */\r\n\t\tgetInstance: function (multitonKey)\r\n\t\t{\r\n\t\t\t// all Facade instances, including Facade subclass instances, are stored\r\n\t\t\t// on Facade.instanceMap. When implementing you own #getInstance factory\r\n\t\t\t// method, ensure that follow the general pattern implemented here or else\r\n\t\t\t// puremvc.Facade#hasCore and puremvc.Facade#removeCore will not work if\r\n\t\t\t// you ever need to use them.\r\n\t\t\tvar instanceMap = puremvc.Facade.instanceMap;\r\n\t\t\tconst instance = instanceMap[multitonKey]; // read from the instance map\r\n\t\t\t\r\n\t\t\tif (instance) // if there is an instance...\r\n\t\t\t\treturn instance; // return it\r\n\t\t\t\r\n\t\t\t// otherwise create a new instance and cache it on Facade.instanceMap;\t\r\n\t\t\treturn instanceMap[multitonKey]= new diygamePlayer.ApplicationFacade(multitonKey);\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * @static\r\n\t\t * @type {string}\r\n\t\t */\r\n\t\tNAME: 'diygamePlayer'\r\n\t}\r\n)\r\n","/**\r\n * Created by liuE on 2016/10/10.\r\n */\r\nexport default class Dialog {\r\n\r\n    static showDialog(title, data, type, okText, cancelText,iscancle = false,cd = 0,cdtype = 0) {\r\n        !this.isShow && (this.isShow = true);\r\n        const that = this;\r\n        return new Promise((resolve, reject) => {\r\n            const ok = () => {\r\n                document.body.removeChild(modalContainer);\r\n                that.isShow = false;\r\n                resolve('ok');\r\n            };\r\n\r\n            const cancel = () => {\r\n                document.body.removeChild(modalContainer);\r\n                that.isShow = false;\r\n                reject('cancel');\r\n            };\r\n\r\n            const closefun = () => {\r\n                document.body.removeChild(modalContainer);\r\n                that.isShow = false;\r\n                reject('close');\r\n            };\r\n\r\n            const modalContainer = document.createElement('div');\r\n            modalContainer.classList.add('ModalContainer');\r\n            const modalPortal = document.createElement('div');\r\n            modalPortal.classList.add('ModalPortal');\r\n            if (document.body.clientWidth <= document.body.clientHeight) {\r\n                modalPortal.style.transform = 'rotate(90deg)';\r\n            }\r\n            window.onresize = function(){\r\n                //横，竖屏时切换方向\r\n                if (document.body.clientWidth <= document.body.clientHeight) {\r\n                    flashvars.vertical ? modalPortal.style.transform = 'rotate(0)' : modalPortal.style.transform = 'rotate(90deg)'\r\n                    //modalPortal.style.transform = 'rotate(90deg)';\r\n                }\r\n                else {\r\n                    flashvars.vertical ? modalPortal.style.transform = 'rotate(90deg)' : modalPortal.style.transform = 'rotate(0)'\r\n                    //modalPortal.style.transform = 'rotate(0)';\r\n                }\r\n            }\r\n\r\n            modalContainer.appendChild(modalPortal);\r\n\r\n            const titleDiv = document.createElement('div');\r\n            titleDiv.classList.add('Title');\r\n            const titleData = document.createElement('span');\r\n            titleData.innerText = title;\r\n            const space = document.createElement('span');\r\n            //space.style.flex = 1;\r\n            space.classList.add('spaceSpan');\r\n            const close = document.createElement('span');\r\n            close.classList.add('Close');\r\n            close.innerText = '×';\r\n            close.onclick = iscancle ? closefun : cancel;\r\n            titleDiv.appendChild(titleData);\r\n            titleDiv.appendChild(space);\r\n            titleDiv.appendChild(close);\r\n            modalPortal.appendChild(titleDiv);\r\n\r\n            const content = document.createElement('div');\r\n            content.classList.add('Content');\r\n            modalPortal.appendChild(content);\r\n\r\n            const contentData = document.createElement('div');\r\n            contentData.classList.add('ContentData');\r\n            type && contentData.classList.add(type);\r\n            contentData.innerText = data;\r\n            content.appendChild(contentData);\r\n\r\n            const buttons = document.createElement('div');\r\n            buttons.classList.add('Buttons');\r\n            content.appendChild(buttons);\r\n\r\n            const buttonOk = document.createElement('button');\r\n            const buttonCancel = document.createElement('button');\r\n            buttonOk.classList.add('ButtonOk');\r\n            buttonCancel.classList.add('ButtonsCancel');\r\n            buttonOk.innerText = okText || '确定';\r\n            buttonCancel.innerText = cancelText || '取消';\r\n            buttons.appendChild(buttonOk);\r\n            buttons.appendChild(buttonCancel);\r\n            buttonOk.onclick = ok;\r\n            buttonCancel.onclick = cancel;\r\n            document.body.appendChild(modalContainer);\r\n            //cd 时间   cdtype 按钮类型  0确认  1取消  2 全部\r\n            if(cd > 0){\r\n                const countdown = (btn,wait,txt) =>{\r\n                    if(wait <= 0){\r\n                        btn.removeAttribute(\"disabled\");\r\n                        btn.style.background = \"#3DC826\";\r\n                        btn.style.backgroundColor = \"#3DC826\";\r\n                        btn.style.border = \"#3DC826\";\r\n                        btn.style.color = \"#FFFFFF\";\r\n                        btn.innerText = txt;\r\n                    }else{\r\n                        btn.setAttribute(\"disabled\",true);\r\n                        btn.style.background = \"#8c8c8c\";\r\n                        btn.style.backgroundColor = \"#8c8c8c\";\r\n                        btn.style.color = \"#FFFFFF\";\r\n                        btn.style.border = \"#8c8c8c\";\r\n                        btn.innerText = wait;\r\n                        wait --;\r\n                        setTimeout(function() {\r\n                            countdown(btn,wait,txt)\r\n                        },1000)\r\n                    }\r\n                };\r\n                if(cdtype === 0){\r\n                    countdown(buttonOk,cd,buttonOk.innerText);\r\n                }else if(cdtype === 1){\r\n                    countdown(buttonCancel,cd,buttonCancel.innerText);\r\n                }else if(cdtype === 2){\r\n                    countdown(buttonOk,cd,buttonOk.innerText);\r\n                    countdown(buttonCancel,cd,buttonCancel.innerText);\r\n                }\r\n            }\r\n            window.onresize();\r\n        })\r\n    }\r\n\r\n    static info(data) {\r\n        if (this.isShow)    return;\r\n        return this.showDialog('提示', data, 'Info')\r\n    }\r\n\r\n    static warn(data) {\r\n        if (this.isShow)    return;\r\n        return this.showDialog('警告', data, 'Warn')\r\n    }\r\n\r\n    static error(data) {\r\n        if (this.isShow)    return;\r\n        return this.showDialog('错误', data, 'Error')\r\n    }\r\n    /**\r\n     * 自定义\r\n     * @param data          内容\r\n     * @param tileText      标题\r\n     * @param okText        确定按钮文字\r\n     * @param cancelText    取消按钮文字\r\n     * @param iscancle      X按钮是否发送时间\r\n     */\r\n    static custom(type,data,tileText,okText, cancelText,iscancle,cd,cdtype){\r\n        if (this.isShow)    return Promise.reject();\r\n        return this.showDialog(tileText, data, type, okText, cancelText, iscancle,cd,cdtype)\r\n    }\r\n}","import Utils from './Utils.js';\r\n\r\nexport default class FontUtils {\r\n    static isFontExist(name){\r\n        const baseFonts = ['Microsoft YaHei', 'Helvetica', 'sans-serif', 'serif'];\r\n        const testString = \"qwertyuiopasdfghjklzxcvbnm\";\r\n        const testSize = '72px';\r\n        const s = document.createElement(\"span\");\r\n        s.style.fontSize = testSize;\r\n        s.innerHTML = testString;\r\n        if (!this.defaultWidth || !this.defaultHeight) {\r\n            this.defaultWidth = {};\r\n            this.defaultHeight = {};\r\n            for (let index in baseFonts) {\r\n                s.style.fontFamily = baseFonts[index];\r\n                document.body.appendChild(s);\r\n                this.defaultWidth[baseFonts[index]] = s.offsetWidth;\r\n                this.defaultHeight[baseFonts[index]] = s.offsetHeight;\r\n                document.body.removeChild(s);\r\n            }\r\n        }\r\n\r\n        let detected = false;\r\n        for (let index in baseFonts) {\r\n            s.style.fontFamily = name + ',' + baseFonts[index];\r\n            document.body.appendChild(s);\r\n            var matched = (s.offsetWidth != this.defaultWidth[baseFonts[index]] || s.offsetHeight != this.defaultHeight[baseFonts[index]]);\r\n            document.body.removeChild(s);\r\n            detected = detected || matched;\r\n        }\r\n\r\n        return detected;\r\n    }\r\n\r\n    static mergeFontImage(font, default_font_size) {\r\n        let images = [];\r\n        if (font.size) {\r\n            if (font.size.target.width) {\r\n                this.charWidth = font.size.target.width;\r\n                this.charHeight = font.size.target.height;\r\n            }\r\n            else {\r\n                this.charWidth = font.size.target;\r\n                this.charHeight = font.size.target;\r\n            }\r\n        }\r\n        else {\r\n            this.charWidth = default_font_size;\r\n            this.charHeight = default_font_size;\r\n        }\r\n        this.widthImg = this.countPerRow * this.charWidth;\r\n        this.heightImg = this.rowPerImg * this.charHeight;\r\n\r\n        return new Promise((resolve, reject) => {\r\n            if (!font) {\r\n                return resolve();\r\n            }\r\n            //font.fontFamily = 'YouYuanY';\r\n            if (this.isFontExist(font.fontFamily)) {\r\n                return resolve();\r\n            }\r\n\r\n            FontUtils.fontFamily = font.fontFamily;\r\n            for (let i=0; i<font.images.length; i++) {\r\n                images[i] = 'https://apppic.3000test.com' + font.images[i].url;\r\n                this.fontChars += font.images[i].chars;\r\n            }\r\n\r\n            // doMerge\r\n            let c = document.createElement('canvas');\r\n            let ctx = c.getContext('2d');\r\n            let len = images.length;                    // 图片数\r\n            let nRow = Math.ceil(this.fontChars.length / this.countPerRow);    // 文字行数\r\n\r\n            c.width = this.widthImg;\r\n            c.height = nRow * this.charHeight;\r\n            //ctx.rect(0, 0, c.width, c.height);\r\n            //ctx.fillStyle='#fff';\r\n            //ctx.fill();\r\n\r\n            const drawing = (n) => {\r\n                if(n < len){\r\n                    let img = new Image;\r\n                    let srcHeight = n === len - 1 ? (nRow % this.rowPerImg) * this.charHeight : this.heightImg;\r\n                    img.src = images[n];\r\n                    img.onload = function(){\r\n                        ctx.drawImage(img, 0, 0, FontUtils.widthImg, srcHeight, 0, n*FontUtils.heightImg, FontUtils.widthImg, srcHeight);\r\n                        return drawing(n+1);\r\n                    }\r\n                }else{\r\n                    //保存生成作品图片\r\n                    let base64 = c.toDataURL(\"image/png\", 1);\r\n                    let blob = Utils.dataURLtoBlob(base64);\r\n                    let blobUrl = blob ? URL.createObjectURL(blob) : base64;\r\n                    this.fontImage = blobUrl;\r\n                    return resolve();\r\n                }\r\n            };\r\n            return drawing(0);\r\n        });\r\n    }\r\n\r\n    // 每个字符宽度\r\n    static getCharSpace(char, fontSize) {\r\n        if (/[a-zA-Z0-9]/.test(char)) {\r\n            return 14 * fontSize / 25;\r\n        }\r\n        else if ('(' === char || ')' === char) {\r\n            return 8 * fontSize / 25;\r\n        }\r\n        else if ('-' === char) {\r\n            return 11 * fontSize / 25;\r\n        }\r\n        else if ('.' === char || ':' === char) {\r\n            return 7;\r\n        }\r\n        else if (32 === char.charCodeAt(0) || 160 === char.charCodeAt(0) || '\\u2002' === char) { // 半角空格 == 半个汉字\r\n            return fontSize >> 1;\r\n        }\r\n        else {\r\n            return fontSize;\r\n        }\r\n    }\r\n\r\n    static getLeftMargin(char, fontSize) {\r\n        if (/[a-zA-Z0-9\\.\\)]/.test(char)) {\r\n            return 0;\r\n        }\r\n        else if ('(' === char || ':' === char) {\r\n            return -(4 * fontSize / 25);\r\n        }\r\n        else if ('-' === char) {\r\n            return -(fontSize / 25);\r\n        }\r\n        return 6 * fontSize / 25;\r\n    }\r\n}\r\n\r\nFontUtils.defaultWidth = undefined;\r\nFontUtils.defaultHeight = undefined;\r\nFontUtils.fontImage = undefined;\r\nFontUtils.fontChars = '';\r\nFontUtils.fontFamily = '';\r\nFontUtils.charWidth = 25;   // 字宽\r\nFontUtils.charHeight = 25;  // 字高\r\nFontUtils.countPerRow = 40; // 一行字数\r\nFontUtils.rowPerImg = 20;   // 每张图片行数\r\nFontUtils.widthImg = 1000;  // 字体图片宽\r\nFontUtils.heightImg = 500;  // 字体图片高","\r\nimport MD5 from 'spark-md5';\r\nimport Utils from \"./Utils.js\";\r\nimport * as Xhr from \"./XmlHttpRequest.js\";\r\nimport Dialog from './Dialog.js';\r\n\r\nexport default class OtherWap{\r\n    /**初始化全黑平台SDK*/\r\n    static initQHSdk(){\r\n        const loadSdkJS = (src) =>{\r\n            return new Promise((resolve,reject) =>{\r\n                let oHead = document.getElementsByTagName('head').item(0);\r\n                let oScript= document.createElement(\"script\");\r\n                oScript.type = \"text/javascript\";\r\n                oScript.src = src;\r\n                oHead.appendChild(oScript);\r\n                oScript.onload = function(){\r\n                    return resolve(\"QHSKD INIT SUCCESS\");\r\n                };\r\n            })\r\n        }\r\n        return loadSdkJS(\"//port.2r3r.com/game/qhjssdk\").then((msg)=>{\r\n            const initdata = {\r\n                \"username\":flashvars.qh_username,\t//用户id，群黑登录接口里面username参数\r\n                \"gid\":flashvars.qh_qhgid,\t//群黑游戏id，可以在后台游戏列表查询\r\n                \"qhchannel\":flashvars.qh_qhchannel,\t//用户标识，群黑登录接口里面qhchannel参数\r\n                \"qhchannelid\":flashvars.qh_qhchannelid\t//用户标识id，群黑登录接口里面qhchannelid参数\r\n            }\r\n            window.qhsdk.init(initdata);\r\n            return Promise.resolve(msg)\r\n        });\r\n    };\r\n\r\n    /**\r\n     * 发起支付\r\n     * @param price         价格\r\n     * @param goodsId       商品id\r\n     * @param indentId      随机生成唯一ID\r\n     * @param chapteruuid   章节uuid\r\n     * @param context       context\r\n     */\r\n    static pay(price, goodsId, indentId,chapteruuid,context,payindex,callback){\r\n        const sign = MD5.hash(price.toString() + flashvars.qh_username + indentId + flashvars.qh_key);\r\n        const paydata = {\r\n            \"userId\":flashvars.qh_username,\r\n            \"gid\":flashvars.qh_qhgid,\r\n            'goodsId':goodsId,\r\n            \"goodsName\":price + \"闪币\",\r\n            \"money\":price,\r\n            \"roleName\":\"3000闪艺\",\r\n            \"ext\":indentId,\r\n            \"serverId\":flashvars.qh_serverid,\r\n            \"sign\":sign\r\n        };\r\n        if(payindex ===1){context.payValues[0].name = encodeURI(context.payValues[0].name)};\r\n        const sydata = {\r\n            \"game_id\":flashvars.gid\r\n            ,\"uuid\":flashvars.uuid\r\n            ,\"chapter_uuid\":chapteruuid\r\n            ,\"amount\":price\r\n            ,\"set_value\":payindex === 0 ? \"\":Utils.encodeBase64(JSON.stringify(context.payValues))\r\n            ,\"payindex\":payindex\r\n            ,\"ext\":indentId\r\n            ,\"event_id\":goodsId\r\n            ,\"qh_username\":flashvars.qh_username\r\n            ,\"qh_qhgid\":flashvars.qh_qhgid\r\n        }\r\n        const send = (url,d)=>{\r\n            Xhr.xhrSend(url, d, null, 4000).then(rs => {\r\n                //send success\r\n            }, rj => {\r\n                //send fail\r\n            });\r\n        };\r\n        send(\"https://pay.3000.com/qunhei/paydata.php\",JSON.stringify(sydata));\r\n        //群和充值\r\n        window.qhsdk.pay(paydata,()=>{\r\n            console.log(\"群黑充值返回\")\r\n        });\r\n        Utils.timeout(200).then(()=>{\r\n            //重置返回提示\r\n            if(payindex === 0){\r\n                Dialog.custom(\"Info\",\"如果购买成功则点击继续观看作品，如果暂不购买则不能继续。\",\"是否支付成功？\",\"已支付成功\",\"暂不购买\",false).then(()=>{\r\n                    if(callback) callback(\"success\");\r\n                },()=>{\r\n                    if(callback) callback(\"cancel\");\r\n                })\r\n            }else{\r\n                Dialog.custom(\"Info\",\"若已支付成功，作品将会刷新，可读取存档继续观看。若暂不购买，将返回商城。\",\"是否支付成功？\",\"已支付成功\",\"暂不购买\",false).then(()=>{\r\n                    window.location.reload()\r\n                },()=>{\r\n                    if(callback) callback();\r\n                })\r\n            }\r\n\r\n        })\r\n    };\r\n    /**开始时候传送的群黑数据*/\r\n    static sendQHData(){\r\n        const send = (url,d)=>{\r\n            return Xhr.xhrSend(url, d, null, 4000).then(rs => {\r\n                //send success\r\n                if (rs.responseText.length === 0) {\r\n                    //Get failed, no response data\r\n                    return Promise.reject('Get failed, no response data');\r\n                }\r\n                let retData = JSON.parse(rs.responseText);\r\n                if(retData.status === 0 && retData.success === true && retData.data){\r\n                    flashvars.uid = retData.data.uid;\r\n                    flashvars.token = retData.data.token;\r\n                    flashvars.u = retData.data.u;\r\n                    return Promise.resolve();\r\n                }\r\n            }, rj => {\r\n                //send fail\r\n            });\r\n        };\r\n        const qhdata = {\r\n            \"qh_username\":flashvars.qh_username\r\n            ,\"qh_serverid\":flashvars.qh_serverid\r\n            ,\"qh_time\":flashvars.qh_time\r\n            ,\"qh_isadult\":flashvars.qh_isadult\r\n            ,\"qh_flag\":flashvars.qh_flag\r\n            ,\"qh_uid\":flashvars.qh_uid\r\n            ,\"qh_nname\":Utils.encodeBase64(flashvars.qh_nname)\r\n            ,\"qh_qhchannel\":flashvars.qh_qhchannel\r\n            ,\"qh_qhchannelid\":flashvars.qh_qhchannelid\r\n            ,\"refresh_token\":1\r\n        }\r\n        return send(\"https://ptlogin.3000.com/?m=ptlogin&ac=qhlogin\",JSON.stringify(qhdata));\r\n    }\r\n}","export default class PhoneUtils {\r\n    static loadAudioUrl(key, url, local) {\r\n        this.loadingAudioMap[key] = true;\r\n        this.audioErrorResourceRef[key] = 0;\r\n        if (flashvars.client === 'ios') {\r\n            let Arg = {key:key, url: url, local:local};\r\n            this.audioCountLoadByPhone.total++;\r\n            if(flashvars.offline ==='1'){\r\n                javascript:loadAudioUrl(JSON.stringify(Arg));\r\n            }else{\r\n                window.webkit && window.webkit.messageHandlers.loadAudioUrl.postMessage(JSON.stringify(Arg));\r\n            }\r\n        }\r\n    }\r\n\r\n    static playMusic(key, volume, loop,precent = 1) {\r\n        const musicKey = key ? key : this.musicKey;\r\n        const v = (!volume && volume !== 0) ? 1 : volume;\r\n        const l = loop === undefined || loop === null ? true : loop;\r\n        this.musicInfo.key = musicKey;\r\n        this.musicInfo.volume = v * precent;\r\n        this.musicInfo.prevolume = v;\r\n        this.musicInfo.inheritvolume = -1;\r\n        this.musicInfo.tweenId = parseInt(Math.random()*100);\r\n        this.playAudioUrl(musicKey, v, l, 'music',precent);\r\n    }\r\n\r\n    static stopMusic(isclear = true) {\r\n        this.stopAudioUrl('music');\r\n        isclear && (this.musicInfo.key = '');\r\n    }\r\n\r\n    static playInheritMusic(volume,precent=1) {\r\n        this.musicInfo.inheritvolume = volume; //插播的音量\r\n        this.setAudioUrlVolume('music', volume * precent);\r\n    }\r\n\r\n    static tweenFromMusic(volume, duration, delay) {\r\n        return new Promise((resolve, reject) => {\r\n            if (duration <= 10) {\r\n                this.musicInfo.volume = volume;\r\n                this.setAudioUrlVolume('music', volume);\r\n                return resolve();\r\n            }\r\n\r\n            let nTimers = duration / 20;\r\n            let nStep = (this.musicInfo.volume - volume) / nTimers;\r\n            let nCur = volume;\r\n\r\n            this.musicInfo.tweenId = parseInt(Math.random()*100);\r\n            let tweenId = this.musicInfo.tweenId;\r\n\r\n            const doEase = () => {\r\n                const  that = this;\r\n                return function () {\r\n                    if ((that.musicInfo.volume > nCur && nStep > 0 || that.musicInfo.volume < nCur && nStep < 0)\r\n                        && tweenId === that.musicInfo.tweenId) {\r\n                        nCur += nStep;\r\n                        if (nCur > 1) nCur = 1;\r\n                        else if (nCur < 0) nCur = 0;\r\n                        that.setAudioUrlVolume('music', nCur);\r\n                        that.musicInfo.volume = nCur;\r\n                        setTimeout(doEase(), 20);\r\n                    }\r\n                    else {\r\n                        that.musicInfo.volume = volume;\r\n                        that.musicInfo.prevolume = volume;\r\n                        return resolve();\r\n                    }\r\n                }\r\n            };\r\n            setTimeout(doEase(), delay);\r\n        })\r\n    }\r\n\r\n    static tweenToMusic(volume, duration, delay) {\r\n        return new Promise((resolve, reject) => {\r\n            if (duration <= 10) {\r\n                this.musicInfo.volume = volume;\r\n                this.setAudioUrlVolume('music', volume);\r\n                return resolve();\r\n            }\r\n\r\n            let nTimers = duration / 20;\r\n            let nStep = (volume - this.musicInfo.volume) / nTimers;\r\n            let nCur = this.musicInfo.volume;\r\n\r\n            this.musicInfo.tweenId = parseInt(Math.random()*100);\r\n            let tweenId = this.musicInfo.tweenId;\r\n\r\n            const doEase = () => {\r\n                const that = this;\r\n                return function () {\r\n                    if ((nCur > volume && nStep < 0 || nCur < volume && nStep > 0) && tweenId === that.musicInfo.tweenId) {\r\n                        nCur += nStep;\r\n                        if (nCur < 0) nCur = 0;\r\n                        else if (nCur > 1) nCur = 1;\r\n                        that.setAudioUrlVolume('music', nCur);\r\n                        that.musicInfo.volume = nCur;\r\n                        setTimeout(doEase(), 20);\r\n                    }\r\n                    else {\r\n                        that.musicInfo.volume = volume;\r\n                        that.musicInfo.prevolume = volume;\r\n                        return resolve();\r\n                    }\r\n                }\r\n            };\r\n            setTimeout(doEase(), delay);\r\n        })\r\n    }\r\n\r\n    static tweenToSound(index, volume, duration, delay) {\r\n        return new Promise((resolve, reject) => {\r\n            if (!this.soundsInfo[index].key) {\r\n                return resolve();\r\n            }\r\n            if (duration <= 10) {\r\n                this.soundsInfo[index].volume = volume;\r\n                this.setAudioUrlVolume('sound'+index, volume);\r\n                return resolve();\r\n            }\r\n\r\n            let nTimers = duration / 20;\r\n            let nStep = (volume - this.soundsInfo[index].volume) / nTimers;\r\n            let nCur = this.soundsInfo[index].volume;\r\n\r\n            this.soundsInfo[index].tweenId = parseInt(Math.random()*100);\r\n            let tweenId = this.soundsInfo[index].tweenId;\r\n\r\n            const doEase = () => {\r\n                const that = this;\r\n                return function () {\r\n                    if ((nCur > volume && nStep < 0 || nCur < volume && nStep > 0) && tweenId === that.soundsInfo[index].tweenId) {\r\n                        nCur += nStep;\r\n                        if (nCur < 0) nCur = 0;\r\n                        else if (nCur > 1) nCur = 1;\r\n                        that.setAudioUrlVolume('sound'+index, nCur);\r\n                        that.soundsInfo[index].volume = nCur;\r\n                        setTimeout(doEase(), 20);\r\n                    }\r\n                    else {\r\n                        that.soundsInfo[index].volume = volume;\r\n                        that.soundsInfo[index].prevolume = volume;\r\n                        return resolve();\r\n                    }\r\n                }\r\n            };\r\n            setTimeout(doEase(), delay);\r\n        })\r\n    }\r\n\r\n    static stopSound(index) {\r\n        if(index === -1){\r\n            for(let i =0;i <  this.soundsInfo.length;i++){\r\n                let s = this.soundsInfo[i];\r\n                if(s){\r\n                    s.key && this.stopAudioUrl('sound'+i);\r\n                }\r\n            }\r\n        }else{\r\n            const key = this.soundsInfo[index].key;\r\n            key && this.stopAudioUrl('sound'+index);\r\n            this.soundsInfo[index].key = '';\r\n        }\r\n    }\r\n\r\n    static playSound(index, key, volume, loop,precent = 1) {\r\n        const soundKey = key ? key : this.soundsInfo[index].key;\r\n        const v = (!volume && volume !== 0) ? 1 : volume;\r\n        const l = loop === undefined || loop === null ? true : loop;\r\n        this.soundsInfo[index].key = soundKey;\r\n        this.soundsInfo[index].volume = v * precent;\r\n        this.soundsInfo[index].loop = l;\r\n        this.soundsInfo[index].prevolume = v;\r\n        this.soundsInfo[index].inheritvolume = -1;\r\n        this.soundsInfo[index].tweenId = parseInt(Math.random()*100);\r\n        this.playAudioUrl(soundKey, v, l, 'sound'+index,precent);\r\n    }\r\n\r\n    static playInheritSound(index, volume,precent=1) {\r\n        this.soundsInfo[index].inheritvolume = volume;//插播音量\r\n        this.setAudioUrlVolume('sound'+index, volume * precent);\r\n    }\r\n\r\n    static playAudioUrl(key, volume, loop, channel,precent = 1) {\r\n        if (flashvars.client === 'ios') {\r\n            let Arg = {key: key, volume:volume * precent, loop:loop?1:0, channel:channel};\r\n            if(flashvars.offline == 1){\r\n                javascript:playAudioUrl(JSON.stringify(Arg));\r\n            }else{\r\n                window.webkit && window.webkit.messageHandlers.playAudioUrl.postMessage(JSON.stringify(Arg));\r\n            }\r\n        }\r\n    }\r\n\r\n    static stopAudioUrl(channel) {\r\n        if (flashvars.client === 'ios') {\r\n            let Arg = {channel: channel};\r\n            if(flashvars.offline == 1){\r\n                javascript:stopAudioUrl(JSON.stringify(Arg));\r\n            }else{\r\n                window.webkit && window.webkit.messageHandlers.stopAudioUrl.postMessage(JSON.stringify(Arg));\r\n            }\r\n        }\r\n    }\r\n    static updateMusicVolume(channel,precent = 1){\r\n        if(this.musicInfo){\r\n            let volume = (this.musicInfo.inheritvolume !== undefined && this.musicInfo.inheritvolume !== -1)? this.musicInfo.inheritvolume * precent : this.musicInfo.prevolume * precent;\r\n            this.setAudioUrlVolume(channel,volume);\r\n        }\r\n    }\r\n    static updateSoundVolume(channel,precent=1){\r\n        if(this.soundsInfo && this.soundsInfo.length > 0){\r\n            for(let i =0;i <  this.soundsInfo.length;i++){\r\n                let s = this.soundsInfo[i];\r\n                if(s){\r\n                    let volume = (s.inheritvolume !== undefined && s.inheritvolume !== -1) ? s.inheritvolume * precent : s.prevolume * precent;\r\n                    this.setAudioUrlVolume(channel + i,volume)\r\n                }\r\n            }\r\n        }\r\n    }\r\n    static setAudioUrlVolume(channel, volume) {\r\n\r\n        if (flashvars.client === 'ios') {\r\n            let Arg = {channel: channel, volume:volume};\r\n            if(!Arg.volume && Arg.volume !== 0){ //防止穿过去的volume为null\r\n                Arg.volume = 1;\r\n            }\r\n            if(channel === 'music'){\r\n                this.musicInfo.volume = Arg.volume\r\n            };\r\n            if(flashvars.offline === '1'){\r\n                javascript:setAudioUrlVolume(JSON.stringify(Arg));\r\n            }else{\r\n                window.webkit && window.webkit.messageHandlers.setAudioUrlVolume.postMessage(JSON.stringify(Arg));\r\n            }\r\n        }\r\n    }\r\n\r\n    static removeAudioUrl(key) {\r\n        if (key === this.musicInfo.key || this.soundsInfo.some(k => {return key === k})) {\r\n            return;\r\n        }\r\n\r\n        let Arg = {key: key};\r\n        this.audioResourceRef[key] = 0;\r\n        if(flashvars.offline == 1){\r\n            javascript:removeAudioUrl(JSON.stringify(Arg));\r\n        }else{\r\n            window.webkit && window.webkit.messageHandlers.removeAudioUrl.postMessage(JSON.stringify(Arg));\r\n        }\r\n    }\r\n\r\n    static isAudioInCache(key) {\r\n        return !!this.audioResourceRef[key];\r\n    }\r\n\r\n    static isAudioError(key){\r\n        return !!this.audioErrorResourceRef[key];\r\n    }\r\n\r\n    static isLoadingAudio(key) {\r\n        return !!this.loadingAudioMap[key];\r\n    }\r\n\r\n    static audioCanPlayCallBack(key) {\r\n        delete this.loadingAudioMap[key];\r\n        this.audioCountLoadByPhone.loaded++;\r\n        this.load.onSoundExtendLoad.dispatch(key);\r\n        this.audioResourceRef[key] = 1;\r\n    }\r\n\r\n    static audioErrorCallBack(key) {\r\n        delete this.loadingAudioMap[key];\r\n        this.audioCountLoadByPhone.loaded++;\r\n        this.load.onSoundExtendLoadError.dispatch(key);\r\n        this.audioResourceRef[key] = 0;\r\n        this.audioErrorResourceRef[key] = 1;\r\n    }\r\n}\r\nPhoneUtils.loadingAudioMap = {};\r\nPhoneUtils.audioCountLoadByPhone = {loaded:0, total:0};\r\nPhoneUtils.load = null;\r\nPhoneUtils.musicInfo = {key:'', volume:1, tweenId:0};\r\nPhoneUtils.soundsInfo = [{key:'', volume:1, loop:false, tweenId:0}, {key:'', volume:1, loop:false, tweenId:0}, {key:'', volume:1, loop:false, tweenId:0}\r\n                        , {key:'', volume:1, loop:false, tweenId:0}, {key:'', volume:1, loop:false, tweenId:0}, {key:'',volume:1, loop:false, tweenId:0}\r\n                        , {key:'', volume:1, loop:false, tweenId:0}, {key:'', volume:1, loop:false, tweenId:0}, {key:'', volume:1, loop:false, tweenId:0}\r\n                        , {key:'', volume:1, loop:false, tweenId:0}];\r\nPhoneUtils.audioResourceRef = [];\r\nPhoneUtils.audioErrorResourceRef = []; //声音加载出错","/**\r\n * Created by liuE on 2016/10/24.\r\n */\r\nimport Utils, { AudioTagPool } from './Utils.js';\r\n\r\nexport default class Rephaser {\r\n    static updateText() {\r\n        this.texture.baseTexture.resolution = this._res,\r\n            this.context.font = this.style.font;\r\n        var a = this.text;\r\n        //this.style.wordWrap && (a = this.runWordWrap(this.text));\r\n        this.style.wordWrap && (a = this.runWordWrap(this.text), this.realText = a);\r\n        var b = a.split(/(?:\\r\\n|\\r|\\n)/)\r\n            , c = this.style.tabs\r\n            , d = []\r\n            , e = 0\r\n            , f = this.determineFontProperties(this.style.font)\r\n            , g = b.length;\r\n        this.style.maxLines > 0 && this.style.maxLines < b.length && (g = this.style.maxLines),\r\n            this._charCount = 0;\r\n        for (var h = 0; h < g; h++) {\r\n            if (0 === c) {\r\n                var i = this.style.strokeThickness + this.padding.x;\r\n                i += this.colors.length > 0 || this.strokeColors.length > 0 || this.fontWeights.length > 0 || this.fontStyles.length > 0 ? this.measureLine(b[h]) : this.context.measureText(b[h]).width\r\n                //,this.style.wordWrap && (i -= this.context.measureText(\" \").width)\r\n            } else {\r\n                var j = b[h].split(/(?:\\t)/)\r\n                    , i = this.padding.x + this.style.strokeThickness;\r\n                if (Array.isArray(c))\r\n                    for (var k = 0, l = 0; l < j.length; l++) {\r\n                        var m = 0;\r\n                        m = this.colors.length > 0 || this.strokeColors.length > 0 || this.fontWeights.length > 0 || this.fontStyles.length > 0 ? this.measureLine(j[l]) : Math.ceil(this.context.measureText(j[l]).width),\r\n                        l > 0 && (k += c[l - 1]),\r\n                            i = k + m\r\n                    }\r\n                else\r\n                    for (var l = 0; l < j.length; l++) {\r\n                        i += this.colors.length > 0 || this.strokeColors.length > 0 || this.fontWeights.length > 0 || this.fontStyles.length > 0 ? this.measureLine(j[l]) : Math.ceil(this.context.measureText(j[l]).width);\r\n                        var n = this.game.math.snapToCeil(i, c) - i;\r\n                        i += n\r\n                    }\r\n            }\r\n            d[h] = Math.ceil(i),\r\n                e = Math.max(e, d[h])\r\n        }\r\n        this.canvas.width =  e * this._res;\r\n        var o = f.fontSize + this.style.strokeThickness + this.padding.y\r\n            , p = o * g\r\n            , q = this._lineSpacing;\r\n        0 > q && Math.abs(q) > o && (q = -o),\r\n        0 !== q && (p += q > 0 ? q * b.length : q * (b.length - 1)),\r\n            this.canvas.height = (p-4) * this._res, // raw: p * this._res,\r\n            this.context.scale(this._res, this._res),\r\n        navigator.isCocoonJS && this.context.clearRect(0, 0, this.canvas.width, this.canvas.height),\r\n        this.style.backgroundColor && (this.context.fillStyle = this.style.backgroundColor,\r\n            this.context.fillRect(0, 0, this.canvas.width, this.canvas.height)),\r\n            this.context.fillStyle = this.style.fill,\r\n            this.context.font = this.style.font,\r\n            this.context.strokeStyle = this.style.stroke,\r\n            this.context.textBaseline = \"alphabetic\",\r\n            this.context.lineWidth = this.style.strokeThickness,\r\n            this.context.lineCap = \"round\",\r\n            this.context.lineJoin = \"round\";\r\n        var r, s, h;\r\n        for (this._charCount = 0,\r\n                 h = 0; g > h; h++)\r\n            r = this.style.strokeThickness / 2,\r\n                s = this.style.strokeThickness / 2 + h * o + f.ascent,\r\n            h > 0 && (s += q * h),\r\n                \"right\" === this.style.align ? r += e - d[h] : \"center\" === this.style.align && (r += (e - d[h]) / 2),\r\n            this.autoRound && (r = Math.round(r),\r\n                s = Math.round(s)),\r\n                this.colors.length > 0 || this.strokeColors.length > 0 || this.fontWeights.length > 0 || this.fontStyles.length > 0 ? this.updateLine(b[h], r, s) : (this.style.stroke && this.style.strokeThickness && (this.updateShadow(this.style.shadowStroke),\r\n                    0 === c ? this.context.strokeText(b[h], r, s) : this.renderTabLine(b[h], r, s, !1)),\r\n                this.style.fill && (this.updateShadow(this.style.shadowFill),\r\n                    0 === c ? this.context.fillText(b[h], r, s) : this.renderTabLine(b[h], r, s, !0)));\r\n        this.updateTexture()\r\n    }\r\n\r\n    static advancedWordWrap(a) {\r\n        for (var b = this.context, c = this.style.wordWrapWidth, d = \"\", e = a.split(/\\r?\\n/gi), f = e.length, g = 0; g < f; g++) {\r\n            let h = e[g];\r\n            var j = b.measureText(h).width;\r\n            if (j < c)\r\n                d += h + \"\\n\";\r\n            else {\r\n                const isConnect = (a, b) => {\r\n                    if (!a || !b || /\\s/.test(a) || /\\s/.test(b)) {\r\n                        return false;\r\n                    }\r\n                    const reg = /[\\u4E00-\\u9FA5\\uF900-\\uFA2D]|\\s/;     //汉字空格\r\n                    const combinators = new RegExp(\"[!！)）|}':;',\\\\].>》/?……）\\\\-|}】‘；：”“’。，、？]\");\r\n                    const terminator = new RegExp(\"[!！?？:：;；.。》』\\\\-\\\\]】）]\");\r\n                    return reg.test(a) && combinators.test(b) || !reg.test(a) && !reg.test(b) && !terminator.test(a)\r\n                };\r\n                let o = h;\r\n                let index = 0;\r\n                while (1) {\r\n                    let m = -1;\r\n                    let q = '';\r\n                    let p = b.measureText(o).width;\r\n                    if (p > c) {\r\n                        for (let i = 0; o[i] && (q += o[i],\r\n                            p = b.measureText(q).width, m = isConnect(o[i - 1], o[i]) ? m : i - 1, i++,\r\n                            (p < c));)\r\n                            ;\r\n                        if (m !== -1 && m !== (q.length - 1)) {\r\n                            q && (q = q.slice(0, m + 1));\r\n                            o = o.substr(q.length).trimLeft();\r\n                        } else {\r\n                            q && (q = q.slice(0, -1));\r\n                            o = o.substr(q.length).trimLeft()\r\n                        }\r\n                        index ++;\r\n                        d += q + '\\n';\r\n                        if(index > 3){ // 防止特殊字符 卡死\r\n                            while (d.length && d[d.length-1] === '\\n') {\r\n                                //最后换行结尾 空字符\r\n                                d = d.substring(0, d.length-1);\r\n                            }\r\n                            o && (d += '\\n' + o + '\\n');\r\n                            index = 0;\r\n                            break;\r\n                        }\r\n                    } else {\r\n                        o && (d += o + '\\n');\r\n                        index = 0;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return d = d.replace(/\\n$/gi, \"\")\r\n    }\r\n\r\n    static loadImageTag (file) {\r\n\r\n        const onLoad = xhr => {\r\n            const arraybuffer = xhr.requestObject.response;\r\n            let data;\r\n            if (arraybuffer instanceof ArrayBuffer) {\r\n                data = new Uint8Array(arraybuffer);\r\n            }\r\n            let isGif = false;\r\n            if (data[0] === 'G'.charCodeAt()\r\n                && data[1] === 'I'.charCodeAt()\r\n                && data[2] === 'F'.charCodeAt()\r\n                && data[3] === '8'.charCodeAt()\r\n                && (data[4] === '9'.charCodeAt() || '7'.charCodeAt())\r\n                && data[5] === 'a'.charCodeAt()) {\r\n                isGif = true;\r\n            }\r\n\r\n            file.data = new Image();\r\n            file.data.name = file.key;\r\n\r\n            if (this.crossOrigin)\r\n            {\r\n                file.data.crossOrigin = this.crossOrigin;\r\n            }\r\n\r\n            const onComplete = () => {\r\n                if (file.data.onload)\r\n                {\r\n                    file.data.onload = null;\r\n                    file.data.onerror = null;\r\n                    this.fileComplete(file);\r\n                }\r\n            };\r\n\r\n            file.data.onload = () => {\r\n                URL.revokeObjectURL(file.url);\r\n                onComplete()\r\n            };\r\n\r\n            file.data.onerror = () => {\r\n                URL.revokeObjectURL(file.url);\r\n                if (file.data.onload)\r\n                {\r\n                    file.data.onload = null;\r\n                    file.data.onerror = null;\r\n                    this.fileError(file);\r\n                }\r\n            };\r\n\r\n            if (isGif) {\r\n                Utils.spliceGif(arraybuffer).then(r => {\r\n                    file.data.frames = r.frames;\r\n                    file.data.loopCount = r.loopCount;\r\n                    file.url = URL.createObjectURL(Utils.createBlob(arraybuffer, ''));\r\n                    file.data.src = this.transformUrl(file.url, file);\r\n                }, () => {\r\n                    file.url = URL.createObjectURL(Utils.createBlob(arraybuffer, ''));\r\n                    file.data.src = this.transformUrl(file.url, file);\r\n                });\r\n            } else {\r\n                file.url = URL.createObjectURL(Utils.createBlob(arraybuffer, ''));\r\n                file.data.src = this.transformUrl(file.url, file);\r\n            }\r\n\r\n            // Image is immediately-available/cached\r\n            if (file.data.complete && file.data.width && file.data.height)\r\n            {\r\n                file.data.onload = null;\r\n                file.data.onerror = null;\r\n                this.fileComplete(file);\r\n            }\r\n        };\r\n\r\n        this.xhrLoad(file, this.transformUrl(file.url, file), 'arraybuffer', onLoad);\r\n    }\r\n\r\n    static soundStop() {\r\n\r\n        if (this.isPlaying && this._sound)\r\n        {\r\n            if (this.usingWebAudio)\r\n            {\r\n                if (this.externalNode)\r\n                {\r\n                    const endfun = this._sound.onended;\r\n                    this._sound.onended = () => {\r\n                        this._sound.disconnect(this.externalNode);\r\n                        endfun && endfun();\r\n                    };\r\n                }\r\n                else if (this.gainNode)\r\n                {\r\n                    const endfun = this._sound.onended;\r\n                    this._sound.onended = () => {\r\n                        this._sound.disconnect(this.gainNode);\r\n                        endfun && endfun();\r\n                    };\r\n                }\r\n                if (this._sound.stop === undefined)\r\n                {\r\n                    this._sound.noteOff(0);\r\n                }\r\n                else\r\n                {\r\n                    try {\r\n                        this._sound.stop(0);\r\n                    }\r\n                    catch (e)\r\n                    {\r\n                        alert(e);\r\n                        //  Thanks Android 4.4\r\n                    }\r\n                }\r\n\r\n            }\r\n            else if (this.usingAudioTag)\r\n            {\r\n                this._sound.pause();\r\n                this._sound.currentTime = 0;\r\n            }\r\n        }\r\n\r\n        this.pendingPlayback = false;\r\n        this.isPlaying = false;\r\n\r\n        if (!this.paused)\r\n        {\r\n            const prevMarker = this.currentMarker;\r\n\r\n            if (this.currentMarker !== '')\r\n            {\r\n                this.onMarkerComplete.dispatch(this.currentMarker, this);\r\n            }\r\n\r\n            this.currentMarker = '';\r\n\r\n            if (this.fadeTween !== null)\r\n            {\r\n                this.fadeTween.stop();\r\n            }\r\n\r\n            this.onStop.dispatch(this, prevMarker);\r\n        }\r\n    }\r\n    \r\n    static soundDecode(key, sound) {\r\n        sound = sound || null;\r\n        const soundData = this.game.cache.getSoundData(key);\r\n        if (soundData) {\r\n            if (this.game.cache.isSoundDecoded(key) === false) {\r\n                this.game.cache.updateSound(key, 'isDecoding', true);\r\n                const that = this;\r\n                const handleError = () => {\r\n                    this.onSoundDecodeError.dispatch(key);\r\n                    console.warn('Unable to encode audio ' + key);\r\n                };\r\n                try {\r\n                    this.context.decodeAudioData(soundData, function (buffer) {\r\n                        if (buffer) {\r\n                            that.game.cache.decodedSound(key, buffer);\r\n                            that.onSoundDecode.dispatch(key, sound);\r\n                        }\r\n                    }).catch(handleError);\r\n                }\r\n                catch (e) {\r\n                    handleError();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    static loadAudioTag(file) {\r\n\r\n        let url = file.url;\r\n        if (url.indexOf(\"?\") >= 0){\r\n            url = url.substr(0, url.indexOf(\"?\"));\r\n        }\r\n        let extension = url.substr((Math.max(0, url.lastIndexOf(\".\")) || Infinity) + 1);\r\n        const isDatAudio = extension.toLowerCase() === 'dat';\r\n\r\n        const setFileData = file => {\r\n            if (this.game.sound.touchLocked) {\r\n                //  If audio is locked we can't do this yet, so need to queue this load request. Bum.\r\n                file.data = AudioTagPool.get();\r\n                file.data.name = file.key;\r\n                file.data.src = this.transformUrl(file.url, file);\r\n\r\n                this.fileComplete(file);\r\n            } else {\r\n                var audio = AudioTagPool.get();\r\n                file.data = audio;\r\n                file.data.name = file.key;\r\n\r\n                if (!AudioTagPool.exist(audio)) {\r\n                    this.game.sound.touchLocked = true;\r\n                    file.data.src = this.transformUrl(file.url, file);\r\n                    this.fileComplete(file);\r\n                    return;\r\n                }\r\n\r\n                const playThroughEvent = () => {\r\n                    file.data.removeEventListener('canplaythrough', playThroughEvent, false);\r\n                    file.data.onerror = null;\r\n                    this.fileComplete(file);\r\n                };\r\n\r\n                file.data.onerror = () => {\r\n                    file.data.removeEventListener('canplaythrough', playThroughEvent, false);\r\n                    file.data.onerror = null;\r\n                    this.fileComplete(file);\r\n                };\r\n\r\n                file.data.src = this.transformUrl(file.url, file);\r\n                file.data.addEventListener('canplaythrough', playThroughEvent, false);\r\n                file.data.load();\r\n            }\r\n        };\r\n\r\n        const convertDat = (file) => {\r\n            if(this.game.device.android){\r\n                setFileData(file);\r\n                return;\r\n            }\r\n            this.xhrLoad(file, this.transformUrl(file.url, file), 'arraybuffer', (file, xhr) => {\r\n                file.url = URL.createObjectURL(new Blob([xhr.response], { type: 'audio/mp3' }));\r\n                file.isDatFile = true;\r\n                setFileData(file);\r\n            });\r\n        };\r\n\r\n        if(isDatAudio){\r\n            convertDat(file);\r\n        }else{\r\n            setFileData(file);\r\n        }\r\n    }\r\n\r\n    static tintWithMultiply(texture, color, canvas) {\r\n        let context = canvas.getContext(\"2d\");\r\n\r\n        let crop = texture.crop;\r\n        let w = crop.width;\r\n        let h = crop.height;\r\n\r\n        if (texture.rotated)\r\n        {\r\n            w = h;\r\n            h = crop.width;\r\n        }\r\n\r\n        if (canvas.width !== w || canvas.height !== h)\r\n        {\r\n            canvas.width = w;\r\n            canvas.height = h;\r\n        }\r\n\r\n        context.clearRect(0, 0, w, h);\r\n\r\n        context.drawImage(texture.baseTexture.source, crop.x, crop.y, w, h, 0, 0, w, h);\r\n        context.globalCompositeOperation = \"source-atop\";\r\n\r\n        context.fillStyle = \"#\" + (\"00000\" + (color | 0).toString(16)).substr(-6);\r\n        context.fillRect(0, 0, w, h);\r\n    }\r\n}\r\n\r\n(() => {\r\n    PIXI.CanvasTinter.tintWithMultiply = Rephaser.tintWithMultiply;\r\n    Phaser.Game.prototype.destroyComponent = new Phaser.Signal();\r\n\r\n    const spriteDestroy = Phaser.Sprite.prototype.destroy;\r\n    Phaser.Sprite.prototype.destroy = function () {\r\n        const game = this.game;\r\n        spriteDestroy.apply(this, arguments);\r\n        game && game.destroyComponent && game.destroyComponent.dispatch(this.key || null);\r\n    };\r\n\r\n    const renderCanvas = Phaser.Sprite.prototype._renderCanvas;\r\n    Phaser.Sprite.prototype._renderCanvas = function () {\r\n        try {\r\n            renderCanvas.apply(this, arguments);\r\n        } catch (e) {\r\n            //console.log(this.key);\r\n        }\r\n    };\r\n\r\n    const imageDestroy = Phaser.Image.prototype.destroy;\r\n    Phaser.Image.prototype.destroy = function () {\r\n        const game = this.game;\r\n        imageDestroy.apply(this, arguments);\r\n        game && game.destroyComponent && game.destroyComponent.dispatch(this.key || null);\r\n    };\r\n\r\n    const buttonDestroy = Phaser.Button.prototype.destroy;\r\n    Phaser.Button.prototype.destroy = function () {\r\n        Object.keys(this).forEach(key => {\r\n            if(!this.hasOwnProperty(key)){\r\n                return;\r\n            }\r\n            if (this[key] instanceof Phaser.Sound){\r\n                this[key].destroy();\r\n            }\r\n        });\r\n\r\n        buttonDestroy.apply(this, arguments);\r\n    };\r\n\r\n    const forceRemoveFileSet = new Set();\r\n    Phaser.Loader.prototype.forceRemoveFile = function (type, key) {\r\n        var asset = this.getAsset(type, key);\r\n        if (asset) {\r\n            if (!asset.loaded && !asset.loading) {\r\n                this._fileList.splice(asset.index, 1);\r\n            } else {\r\n                forceRemoveFileKeys.add(key);\r\n                const removeFromCache = () => {\r\n                    if(!forceRemoveFileSet.has(key)){\r\n                        return;\r\n                    }\r\n                    type === 'audio' && this.cache.checkSoundKey(key) && this.cache.removeSound(key);\r\n                    type === 'image' && this.cache.checkImageKey(key) && this.cache.removeImage(key);\r\n                    forceRemoveFileSet.delete(key);\r\n                };\r\n                var fileCompleteListener = (progress, cacheKey, success, totalLoaded, totalFiles) => {\r\n                    if (cacheKey == key) {\r\n                        removeFromCache();\r\n                        this.onFileComplete.remove(fileCompleteListener);\r\n                    }\r\n                };\r\n                asset.loaded && removeFromCache();\r\n                asset.loading && this.onFileComplete.add(fileCompleteListener);\r\n            }\r\n        }\r\n    };\r\n\r\n    Phaser.Loader.prototype.cancelForceRemoveFile = function (type, key) {\r\n       forceRemoveFileSet.delete(key);\r\n    };\r\n\r\n    Phaser.Loader.prototype.loadAudioTag = Rephaser.loadAudioTag;\r\n    \r\n    const soundDestroy = Phaser.Sound.prototype.destroy;\r\n    Phaser.Sound.prototype.destroy =  function () {\r\n        soundDestroy.apply(this, arguments);\r\n        if (this.usingWebAudio) {\r\n            if (this.game.sound.context && !this.game.sound.scratchBuffer) {\r\n                this.game.sound.scratchBuffer = this.game.sound.context.createBuffer(1, 1, 22050);\r\n            }\r\n            try {this._sound.buffer = this.game.sound.scratchBuffer;} catch (e) {}\r\n        }\r\n        this._sound = null;\r\n    };\r\n\r\n    Phaser.Cache.prototype.reloadSound = function (key) {\r\n        var _this = this;\r\n        var sound = this.getSound(key);\r\n\r\n        if (sound && !AudioTagPool.exist(sound.data)) {\r\n            var audio = AudioTagPool.get();\r\n            if (!AudioTagPool.exist(audio)) {\r\n                return;\r\n            }\r\n            sound.data = audio;\r\n            sound.data.src = sound.url;\r\n            sound.data.addEventListener('canplaythrough', function () {\r\n                return _this.reloadSoundComplete(key);\r\n            }, false);\r\n            sound.data.load();\r\n        }\r\n    };\r\n    \r\n    Phaser.Device.canPlayAudio = function (type) {\r\n        if (type === 'mp3' && this.mp3) {\r\n            return true;\r\n        } else if (type === 'ogg' && (this.ogg || this.opus)) {\r\n            return true;\r\n        } else if (type === 'm4a' && this.m4a) {\r\n            return true;\r\n        } else if (type === 'opus' && this.opus) {\r\n            return true;\r\n        } else if (type === 'wav' && this.wav) {\r\n            return true;\r\n        } else if (type === 'webm' && this.webm) {\r\n            return true;\r\n        } else if (type === 'mp4' && this.dolby) {\r\n            return true;\r\n        }else if (type === 'dat') {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n\r\n    Phaser.SoundManager.prototype.setMute = function () {\r\n        if (this._muted) {\r\n            return;\r\n        }\r\n        this._muted = true;\r\n\r\n        if (this.usingWebAudio) {\r\n            this._muteVolume = this.masterGain.gain.value;\r\n            this.masterGain.gain.value = 0;\r\n        }\r\n\r\n        for (var i = 0; i < this._sounds.length; i++) {\r\n            if (this._sounds[i].usingAudioTag) {\r\n                //fix iOS audio tag volume always stays set at 1\r\n                this.game.device.iOS && this._sounds[i].pause();\r\n                this._sounds[i].mute = true;\r\n            }\r\n        }\r\n        this.onMute.dispatch();\r\n    };\r\n\r\n    Phaser.SoundManager.prototype.unsetMute = function () {\r\n        if (!this._muted || this._codeMuted) {\r\n            return;\r\n        }\r\n\r\n        this._muted = false;\r\n\r\n        if (this.usingWebAudio) {\r\n            this.masterGain.gain.value = this._muteVolume;\r\n        }\r\n\r\n        for (var i = 0; i < this._sounds.length; i++) {\r\n            if (this._sounds[i].usingAudioTag) {\r\n                //fix iOS audio tag volume always stays set at 1\r\n                this.game.device.iOS && this._sounds[i].resume();\r\n                this._sounds[i].mute = false;\r\n            }\r\n        }\r\n        this.onUnMute.dispatch();\r\n    };\r\n})();\r\n","/**\r\n * Created by 4399-1126 on 2017/7/25.\r\n */\r\nexport default class ShanyiMenu {\r\n    static showSyMenu() {\r\n        !this.isShow && (this.isShow = true);\r\n        const that = this;\r\n        return new Promise((resolve, reject) => {\r\n            const back = () => {\r\n                document.body.removeChild(modalContainer);\r\n                that.isShow = false;\r\n                resolve(1);\r\n            };\r\n            const exit = (urlToGo) => {\r\n                document.body.removeChild(modalContainer);\r\n                that.isShow = false;\r\n                resolve(urlToGo);\r\n            };\r\n\r\n            gameCallback.syMenuBack = back;\r\n            gameCallback.syMenuExit = exit;\r\n\r\n            const modalContainer = document.createElement('div');\r\n            modalContainer.classList.add('syModalContainer');\r\n            const modalPortal = document.createElement('div');\r\n            modalPortal.classList.add('syModalPortal');\r\n            if (document.body.clientWidth <= document.body.clientHeight) {\r\n                modalPortal.style.transform = flashvars.vertical ? 'rotate(0)' : 'rotate(90deg)';\r\n            }\r\n            window.onresize = function(){\r\n                if (document.body.clientWidth <= document.body.clientHeight) {\r\n                    modalPortal.style.transform = flashvars.vertical ? 'rotate(0)' : 'rotate(90deg)';\r\n                }\r\n                else {\r\n                    modalPortal.style.transform = flashvars.vertical ? 'rotate(90deg)' : 'rotate(0)';\r\n                }\r\n            }\r\n\r\n            modalContainer.appendChild(modalPortal);\r\n\r\n            const content = document.createElement('div');\r\n            content.classList.add('syContent');\r\n            modalPortal.appendChild(content);\r\n            if(flashvars.vertical){\r\n                //竖屏\r\n                content.style.width = \"320px\";\r\n                content.style.height = \"510px\";\r\n            }\r\n\r\n            const contentData = document.createElement('iframe');\r\n            contentData.src = 'https://www.3000.com/popup.html?uuid=' + flashvars.uuid + \"&wap=\" + flashvars.wap + \"&vertical=\" + (flashvars.vertical ? 1 : 0);\r\n            contentData.scrolling = 'no';\r\n            contentData.width = '100%';\r\n            contentData.height = '100%';\r\n            contentData.frameBorder = '0';\r\n            content.appendChild(contentData);\r\n\r\n\r\n            document.body.appendChild(modalContainer);\r\n        })\r\n    }\r\n}","/**\r\n * Created by liuE on 2016/10/17.\r\n */\r\nimport * as xhr from './XmlHttpRequest.js';\r\nimport commit from './Version.js';\r\nimport {Base64} from 'js-base64';\r\nimport CryptoJS from 'crypto-js';\r\nimport MD5 from 'spark-md5';\r\nimport PhoneUtils from './PhoneUtils.js';\r\n\r\nexport default class Utils {\r\n    /**获取天气素材路径名称*/\r\n    static getWeatherFilePathName(wname){\r\n        return flashvars.vertical ? wname + \"_1\" : wname;\r\n    }\r\n    /**获取天气素材是否离线路径名称*/\r\n    static getWeatherOfflinePathName(){\r\n        //return flashvars.offline === '1' ? 'img' : 'weather'\r\n        return flashvars.offline === '1' ? 'weather' : 'weather'\r\n    }\r\n\r\n    static convertToAllowAccessControlOriginUrl(url) {\r\n        if (!url) {\r\n            return Promise.resolve('');\r\n        }\r\n        if (url === \"http://f1.img4399.com/ma~217_20160518155234_573c1f42bb260.jpeg\") {\r\n            //3000logo\r\n            return Promise.resolve(\"https://apppic.3000test.com/m~web/41/2017/02/08/09_j1sGyq.960x540.jpg\");\r\n        }\r\n        if (url[0] === '/') {\r\n            url = url.substring(1);\r\n        }\r\n        if (!/blob:/i.test(url)) {\r\n            let resultUrl;\r\n            let index = url.indexOf(\"://\");\r\n            if (index > -1) {\r\n                const parts = url.split('/');\r\n                parts.shift();\r\n                parts.shift(); // skip\r\n                parts.shift();\r\n                resultUrl = 'https://apppic.3000test.com/' + parts.join('/');\r\n            }\r\n            else {\r\n                resultUrl = 'https://apppic.3000test.com/' + url;\r\n            }\r\n            if (flashvars.offline === '1') {\r\n                resultUrl = 'game' + flashvars.gid + '/' + resultUrl.substring(28);\r\n            }\r\n            return Promise.resolve(resultUrl);\r\n        }\r\n        else {\r\n            return Promise.reject(url);\r\n        }\r\n    }\r\n\r\n    static spliceGif(arraybuffer) {\r\n        return new Promise((resolve, reject) => {\r\n\r\n            let currentData;\r\n            let currentPos = 0;\r\n            let hdr;\r\n            const tmpCanvas = document.createElement('canvas');\r\n            const spliceCanvas = document.createElement('canvas');\r\n            let frame;\r\n            let lastDisposalMethod;\r\n            let transparency = null;\r\n            let delay = null;\r\n            let disposalMethod = null;\r\n            let disposalRestoreFromIdx = null;\r\n            let lastImg = null;\r\n            let loopCount = 1;\r\n            const frames = [];\r\n\r\n            const bitsToNum = ba => {\r\n                return ba.reduce((s, n) => {\r\n                    return s * 2 + n;\r\n                }, 0);\r\n            };\r\n\r\n            const byteToBitArr = bite => {\r\n                const a = [];\r\n                for (let i = 7; i >= 0; i--) {\r\n                    a.push(!!(bite & (1 << i)));\r\n                }\r\n                return a;\r\n            };\r\n\r\n            const Stream = function (data) {\r\n                currentData = data;\r\n                currentPos = 0;\r\n\r\n                this.readByte = function () {\r\n                    if (currentPos >= data.length) {\r\n                        throw new Error('Attempted to read past end of stream.');\r\n                    }\r\n                    if (data instanceof Uint8Array)\r\n                        return data[currentPos++];\r\n                    else\r\n                        return data.charCodeAt(currentPos++) & 0xFF;\r\n                };\r\n\r\n                this.readBytes = function (n) {\r\n                    var bytes = [];\r\n                    for (var i = 0; i < n; i++) {\r\n                        bytes.push(this.readByte());\r\n                    }\r\n                    return bytes;\r\n                };\r\n\r\n                this.read = function (n) {\r\n                    var s = '';\r\n                    for (var i = 0; i < n; i++) {\r\n                        s += String.fromCharCode(this.readByte());\r\n                    }\r\n                    return s;\r\n                };\r\n\r\n                this.readUnsigned = function () { // Little-endian.\r\n                    var a = this.readBytes(2);\r\n                    return (a[1] << 8) + a[0];\r\n                };\r\n            };\r\n\r\n            const lzwDecode = (minCodeSize, data) => {\r\n                let pos = 0; // Maybe this streaming thing should be merged with the Stream?\r\n                let readCode = size => {\r\n                    let code = 0;\r\n                    for (let i = 0; i < size; i++) {\r\n                        if (data[pos >> 3] & (1 << (pos & 7))) {\r\n                            code |= 1 << i;\r\n                        }\r\n                        pos++;\r\n                    }\r\n                    return code;\r\n                };\r\n\r\n\r\n                let clearCode = 1 << minCodeSize;\r\n                let eoiCode = clearCode + 1;\r\n\r\n                let codeSize = minCodeSize + 1;\r\n\r\n                let outputBlockSize = 4096,\r\n                    bufferBlockSize = 4096;\r\n\r\n                let output = new Uint8Array(outputBlockSize),\r\n                    buffer = new Uint8Array(bufferBlockSize),\r\n                    dict = [];\r\n\r\n                let bufferOffset = 0,\r\n                    outputOffset = 0;\r\n\r\n\r\n                const fill = function () {\r\n                    for (let i = 0; i < clearCode; i++) {\r\n                        dict[i] = new Uint8Array(1);\r\n                        dict[i][0] = i;\r\n                    }\r\n                    dict[clearCode] = new Uint8Array(0);\r\n                    dict[eoiCode] = null;\r\n                };\r\n                const clear = function () {\r\n                    const keep = clearCode + 2;\r\n                    dict.splice(keep, dict.length - keep);\r\n                    codeSize = minCodeSize + 1;\r\n                    bufferOffset = 0;\r\n                };\r\n\r\n                // Block allocators, double block size each time\r\n                const enlargeOutput = function () {\r\n                    const outputSize = output.length + outputBlockSize;\r\n                    const newoutput = new Uint8Array(outputSize);\r\n                    newoutput.set(output);\r\n                    output = newoutput;\r\n                    outputBlockSize = outputBlockSize << 1;\r\n                };\r\n                const enlargeBuffer = function () {\r\n                    const bufferSize = buffer.length + bufferBlockSize;\r\n                    let newbuffer = new Uint8Array(bufferSize);\r\n                    newbuffer.set(buffer);\r\n                    buffer = newbuffer;\r\n                    bufferBlockSize = bufferBlockSize << 1;\r\n                };\r\n\r\n                const pushCode = function (code, last) {\r\n                    var newlength = dict[last].byteLength + 1;\r\n                    while (bufferOffset + newlength > buffer.length) enlargeBuffer();\r\n                    var newdict = buffer.subarray(bufferOffset, bufferOffset + newlength);\r\n                    newdict.set(dict[last]);\r\n                    newdict[newlength - 1] = dict[code][0];\r\n                    bufferOffset += newlength;\r\n                    dict.push(newdict);\r\n                };\r\n\r\n                let code;\r\n                let last;\r\n\r\n                fill();\r\n\r\n                while (true) {\r\n                    last = code;\r\n                    code = readCode(codeSize);\r\n\r\n                    if (code === clearCode) {\r\n                        clear();\r\n                        continue;\r\n                    }\r\n                    if (code === eoiCode) break;\r\n\r\n                    if (code < dict.length) {\r\n                        if (last !== clearCode) {\r\n                            pushCode(code, last);\r\n                        }\r\n                    }\r\n                    else {\r\n                        if (code !== dict.length) throw new Error('Invalid LZW code.');\r\n                        pushCode(last, last);\r\n                    }\r\n\r\n                    const newsize = dict[code].length;\r\n                    while (outputOffset + newsize > output.length) enlargeOutput();\r\n                    output.set(dict[code], outputOffset);\r\n                    outputOffset += newsize;\r\n\r\n                    if (dict.length === (1 << codeSize) && codeSize < 12) {\r\n                        // If we're at the last code and codeSize is 12, the next code will be a clearCode, and it'll be 12 bits long.\r\n                        codeSize++;\r\n                    }\r\n                }\r\n\r\n                // I don't know if this is technically an error, but some GIFs do it.\r\n                //if (Math.ceil(pos / 8) !== data.length) throw new Error('Extraneous LZW bytes.');\r\n                return output.subarray(0, outputOffset);\r\n            };\r\n\r\n            const setSizes = (w, h) => {\r\n                tmpCanvas.width = w;\r\n                tmpCanvas.height = h;\r\n                tmpCanvas.style.width = w + 'px';\r\n                tmpCanvas.style.height = h + 'px';\r\n                tmpCanvas.getContext('2d').setTransform(1, 0, 0, 1, 0, 0);\r\n                spliceCanvas.width = w;\r\n                spliceCanvas.height = w;\r\n            };\r\n\r\n            const clear = () => {\r\n                transparency = null;\r\n                delay = null;\r\n                lastDisposalMethod = disposalMethod;\r\n                disposalMethod = null;\r\n                frame = null;\r\n            };\r\n\r\n            const doHdr = _hdr => {\r\n                hdr = _hdr;\r\n                setSizes(hdr.width, hdr.height)\r\n            };\r\n\r\n            const doGCE = gce => {\r\n                pushFrame();\r\n                clear();\r\n                transparency = gce.transparencyGiven ? gce.transparencyIndex : null;\r\n                delay = gce.delayTime;\r\n                disposalMethod = gce.disposalMethod;\r\n                // We don't have much to do with the rest of GCE.\r\n            };\r\n\r\n            const pushFrame = () => {\r\n                if (!frame) return;\r\n                let dataUrl = tmpCanvas.toDataURL('image/png');\r\n                let blob = this.dataURLtoBlob(dataUrl);\r\n                frames.push({\r\n                    //base64: dataUrl,\r\n                    blobUrl: blob ? URL.createObjectURL(blob) : dataUrl,\r\n                    delay: Math.max(delay, 10)\r\n                });\r\n            };\r\n\r\n            const doImg = img => {\r\n                if (!frame) frame = tmpCanvas.getContext('2d');\r\n\r\n                const currIdx = frames.length;\r\n\r\n                //ct = color table, gct = global color table\r\n                const ct = img.lctFlag ? img.lct : hdr.gct; // TODO: What if neither exists?\r\n\r\n                if (currIdx > 0) {\r\n                    if (lastDisposalMethod === 3) {\r\n                        // Restore to previous\r\n                        // If we disposed every frame including first frame up to this point, then we have\r\n                        // no composited frame to restore to. In this case, restore to background instead.\r\n                        if (disposalRestoreFromIdx !== null) {\r\n                            if(frames[disposalRestoreFromIdx].data) frame.putImageData(frames[disposalRestoreFromIdx].data, 0, 0);\r\n                        } else {\r\n                            frame.clearRect(lastImg.leftPos, lastImg.topPos, lastImg.width, lastImg.height);\r\n                        }\r\n                    } else {\r\n                        disposalRestoreFromIdx = currIdx - 1;\r\n                    }\r\n\r\n                    if (lastDisposalMethod === 2) {\r\n                        // Restore to background color\r\n                        // Browser implementations historically restore to transparent; we do the same.\r\n                        // http://www.wizards-toolkit.org/discourse-server/viewtopic.php?f=1&t=21172#p86079\r\n                        frame.clearRect(lastImg.leftPos, lastImg.topPos, lastImg.width, lastImg.height);\r\n                    }\r\n                }\r\n                // else, Undefined/Do not dispose.\r\n                // frame contains final pixel data from the last frame; do nothing\r\n\r\n                //Get existing pixels for img region after applying disposal method\r\n                const imgData = frame.getImageData(img.leftPos, img.topPos, img.width, img.height);\r\n\r\n                //apply color table colors\r\n                for (let i = 0; i < img.pixels.length; i++) {\r\n                    const pixel = img.pixels[i];\r\n                    // imgData.data === [R,G,B,A,R,G,B,A,...]\r\n                    if (pixel !== transparency) {\r\n                        const pix = ct[pixel];\r\n                        const idx = i * 4;\r\n                        imgData.data[idx] = pix[0];\r\n                        imgData.data[idx + 1] = pix[1];\r\n                        imgData.data[idx + 2] = pix[2];\r\n                        imgData.data[idx + 3] = 255; // Opaque.\r\n                    }\r\n                }\r\n\r\n                frame.putImageData(imgData, img.leftPos, img.topPos);\r\n\r\n                lastImg = img;\r\n            };\r\n\r\n            const doNothing = function () {\r\n            };\r\n\r\n            const doNetscape = block => {\r\n                loopCount = block.iterations;\r\n            };\r\n\r\n            const handler = {\r\n                hdr: doHdr,\r\n                gce: doGCE,\r\n                com: doNothing,\r\n                // I guess that's all for now.\r\n                app: {\r\n                    // TODO: Is there much point in actually supporting iterations?\r\n                    NETSCAPE: doNetscape\r\n                },\r\n                img: doImg,\r\n                eof: () => {\r\n                    //toolbar.style.display = '';\r\n                    pushFrame();\r\n                }\r\n            };\r\n\r\n            const parseGIF = (st, handler) => {\r\n                handler || (handler = {});\r\n\r\n                // LZW (GIF-specific)\r\n                const parseCT = function (entries) { // Each entry is 3 bytes, for RGB.\r\n                    const ct = [];\r\n                    for (let i = 0; i < entries; i++) {\r\n                        ct.push(st.readBytes(3));\r\n                    }\r\n                    return ct;\r\n                };\r\n\r\n                const readSubBlocks = function () {\r\n                    let size, data, offset = 0;\r\n                    const bufsize = 8192;\r\n                    data = new Uint8Array(bufsize);\r\n\r\n                    const resizeBuffer = function () {\r\n                        const newdata = new Uint8Array(data.length + bufsize);\r\n                        newdata.set(data);\r\n                        data = newdata;\r\n                    };\r\n\r\n                    do {\r\n                        size = st.readByte();\r\n\r\n                        // Increase buffer size if this would exceed our current size\r\n                        while (offset + size > data.length) resizeBuffer();\r\n                        data.set(st.readBytes(size), offset);\r\n                        offset += size;\r\n                    } while (size !== 0);\r\n                    return data.subarray(0, offset); // truncate any excess buffer space\r\n                };\r\n\r\n                const parseHeader = function () {\r\n                    const hdr = {};\r\n                    hdr.sig = st.read(3);\r\n                    hdr.ver = st.read(3);\r\n                    if (hdr.sig !== 'GIF') throw new Error('Not a GIF file.'); // XXX: This should probably be handled more nicely.\r\n                    hdr.width = st.readUnsigned();\r\n                    hdr.height = st.readUnsigned();\r\n\r\n                    const bits = byteToBitArr(st.readByte());\r\n                    hdr.gctFlag = bits.shift();\r\n                    hdr.colorRes = bitsToNum(bits.splice(0, 3));\r\n                    hdr.sorted = bits.shift();\r\n                    hdr.gctSize = bitsToNum(bits.splice(0, 3));\r\n\r\n                    hdr.bgColor = st.readByte();\r\n                    hdr.pixelAspectRatio = st.readByte(); // if not 0, aspectRatio = (pixelAspectRatio + 15) / 64\r\n                    if (hdr.gctFlag) {\r\n                        hdr.gct = parseCT(1 << (hdr.gctSize + 1));\r\n                    }\r\n                    handler.hdr && handler.hdr(hdr);\r\n                };\r\n\r\n                const parseExt = function (block) {\r\n                    const parseGCExt = function (block) {\r\n                        const blockSize = st.readByte(); // Always 4\r\n                        const bits = byteToBitArr(st.readByte());\r\n                        block.reserved = bits.splice(0, 3); // Reserved; should be 000.\r\n                        block.disposalMethod = bitsToNum(bits.splice(0, 3));\r\n                        block.userInput = bits.shift();\r\n                        block.transparencyGiven = bits.shift();\r\n\r\n                        block.delayTime = st.readUnsigned();\r\n\r\n                        block.transparencyIndex = st.readByte();\r\n\r\n                        block.terminator = st.readByte();\r\n\r\n                        handler.gce && handler.gce(block);\r\n                    };\r\n\r\n                    const parseComExt = function (block) {\r\n                        block.comment = readSubBlocks();\r\n                        handler.com && handler.com(block);\r\n                    };\r\n\r\n                    const parsePTExt = function (block) {\r\n                        // No one *ever* uses this. If you use it, deal with parsing it yourself.\r\n                        const blockSize = st.readByte(); // Always 12\r\n                        block.ptHeader = st.readBytes(12);\r\n                        block.ptData = readSubBlocks();\r\n                        handler.pte && handler.pte(block);\r\n                    };\r\n\r\n                    const parseAppExt = function (block) {\r\n                        const parseNetscapeExt = function (block) {\r\n                            const blockSize = st.readByte(); // Always 3\r\n                            block.unknown = st.readByte(); // ??? Always 1? What is this?\r\n                            block.iterations = st.readUnsigned();\r\n                            block.terminator = st.readByte();\r\n                            handler.app && handler.app.NETSCAPE && handler.app.NETSCAPE(block);\r\n                        };\r\n\r\n                        const parseUnknownAppExt = function (block) {\r\n                            block.appData = readSubBlocks();\r\n                            // FIXME: This won't work if a handler wants to match on any identifier.\r\n                            handler.app && handler.app[block.identifier] && handler.app[block.identifier](block);\r\n                        };\r\n\r\n                        const blockSize = st.readByte(); // Always 11\r\n                        block.identifier = st.read(8);\r\n                        block.authCode = st.read(3);\r\n                        switch (block.identifier) {\r\n                            case 'NETSCAPE':\r\n                                parseNetscapeExt(block);\r\n                                break;\r\n                            default:\r\n                                parseUnknownAppExt(block);\r\n                                break;\r\n                        }\r\n                    };\r\n\r\n                    const parseUnknownExt = function (block) {\r\n                        block.data = readSubBlocks();\r\n                        handler.unknown && handler.unknown(block);\r\n                    };\r\n\r\n                    block.label = st.readByte();\r\n                    switch (block.label) {\r\n                        case 0xF9:\r\n                            block.extType = 'gce';\r\n                            parseGCExt(block);\r\n                            break;\r\n                        case 0xFE:\r\n                            block.extType = 'com';\r\n                            parseComExt(block);\r\n                            break;\r\n                        case 0x01:\r\n                            block.extType = 'pte';\r\n                            parsePTExt(block);\r\n                            break;\r\n                        case 0xFF:\r\n                            block.extType = 'app';\r\n                            parseAppExt(block);\r\n                            break;\r\n                        default:\r\n                            block.extType = 'unknown';\r\n                            parseUnknownExt(block);\r\n                            break;\r\n                    }\r\n                };\r\n\r\n                const parseImg = function (img) {\r\n                    const deinterlace = function (pixels, width) {\r\n                        // Of course this defeats the purpose of interlacing. And it's *probably*\r\n                        // the least efficient way it's ever been implemented. But nevertheless...\r\n                        var newPixels = new Array(pixels.length);\r\n                        var rows = pixels.length / width;\r\n                        var cpRow = function (toRow, fromRow) {\r\n                            var fromPixels = pixels.slice(fromRow * width, (fromRow + 1) * width);\r\n                            newPixels.splice.apply(newPixels, [toRow * width, width].concat(...fromPixels));\r\n                        };\r\n\r\n                        // See appendix E.\r\n                        var offsets = [0, 4, 2, 1];\r\n                        var steps = [8, 8, 4, 2];\r\n\r\n                        var fromRow = 0;\r\n                        for (var pass = 0; pass < 4; pass++) {\r\n                            for (var toRow = offsets[pass]; toRow < rows; toRow += steps[pass]) {\r\n                                cpRow(toRow, fromRow)\r\n                                fromRow++;\r\n                            }\r\n                        }\r\n\r\n                        return newPixels;\r\n                    };\r\n\r\n                    img.leftPos = st.readUnsigned();\r\n                    img.topPos = st.readUnsigned();\r\n                    img.width = st.readUnsigned();\r\n                    img.height = st.readUnsigned();\r\n\r\n                    var bits = byteToBitArr(st.readByte());\r\n                    img.lctFlag = bits.shift();\r\n                    img.interlaced = bits.shift();\r\n                    img.sorted = bits.shift();\r\n                    img.reserved = bits.splice(0, 2);\r\n                    img.lctSize = bitsToNum(bits.splice(0, 3));\r\n\r\n                    if (img.lctFlag) {\r\n                        img.lct = parseCT(1 << (img.lctSize + 1));\r\n                    }\r\n\r\n                    img.lzwMinCodeSize = st.readByte();\r\n\r\n                    var lzwData = readSubBlocks();\r\n\r\n                    img.pixels = lzwDecode(img.lzwMinCodeSize, lzwData);\r\n\r\n                    if (img.interlaced) { // Move\r\n                        img.pixels = deinterlace(img.pixels, img.width);\r\n                    }\r\n\r\n                    handler.img && handler.img(img);\r\n                };\r\n\r\n                const parseBlock = function () {\r\n                    var block = {};\r\n                    block.sentinel = st.readByte();\r\n\r\n                    switch (String.fromCharCode(block.sentinel)) { // For ease of matching\r\n                        case '!':\r\n                            block.type = 'ext';\r\n                            parseExt(block);\r\n                            break;\r\n                        case ',':\r\n                            block.type = 'img';\r\n                            parseImg(block);\r\n                            break;\r\n                        case ';':\r\n                            block.type = 'eof';\r\n                            handler.eof && handler.eof(block);\r\n                            break;\r\n                        default:\r\n                            throw new Error('Unknown block: 0x' + block.sentinel.toString(16)); // TODO: Pad this with a 0.\r\n                    }\r\n\r\n                    if (block.type !== 'eof') {\r\n                        setTimeout(parseBlock, 0);\r\n                    } else {\r\n                        resolve({\r\n                            loopCount: loopCount,\r\n                            frames: frames\r\n                        })\r\n                    }\r\n                };\r\n\r\n                const parse = () => {\r\n                    parseHeader();\r\n                    setTimeout(parseBlock, 0);\r\n                };\r\n\r\n                parse();\r\n            };\r\n\r\n            try {\r\n                const data = new Uint8Array(arraybuffer);\r\n                const stream = new Stream(data);\r\n                setTimeout(parseGIF(stream, handler), 0);\r\n            }\r\n            catch (err) {\r\n                reject(err);\r\n                console.error('parseGIF ERROR!!' + err);\r\n            }\r\n        })\r\n    }\r\n\r\n    static isObject(data) {\r\n        return Object.prototype.toString.apply(data) === '[object Object]';\r\n    }\r\n\r\n    static fixColorValue(color) {\r\n        const tempColor = color.match(/rgb\\([\\s]*(\\d+)[\\s]*,[\\s]*(\\d+)[\\s]*,[\\s]*(\\d+)[\\s]*\\)/i);\r\n        const toHex = value => {\r\n            const hex = parseInt(value, 10).toString(16);\r\n            if (hex.length !== 2) {\r\n                return '0' + hex;\r\n            } else {\r\n                return hex;\r\n            }\r\n        };\r\n\r\n        if (tempColor) {\r\n            color = '#' + toHex(tempColor[1]) + toHex(tempColor[2]) + toHex(tempColor[3]);\r\n            return color;\r\n        }\r\n\r\n        if (color && color[0] !== '#') {\r\n            color = '#' + color;\r\n        }\r\n\r\n        if (isNaN(parseInt(color.slice(1), 16))) {\r\n            color = '#ffffff';\r\n        }\r\n\r\n        return color ? color : '#ffffff';\r\n    }\r\n\r\n    static timeout(time = 0) {\r\n        let handle = null;\r\n        const promise = new Promise((resolve, reject) => handle = setTimeout(resolve, time));\r\n        promise.cancel = () => clearTimeout(handle);\r\n        return promise;\r\n    }\r\n\r\n    static getTimeOffset() {\r\n        let url = 'https://my.3000.com/?m=timestamp&op=index&ac=get&api_v=1.0.0&api_from=webpc';\r\n        return xhr.xhrGetServerTime(url).then(rs => {\r\n            if (rs.responseText.length === 0) {\r\n                return Promise.reject('Get file failed, no response data');\r\n            }\r\n            let retData = JSON.parse(rs.responseText);\r\n            if (retData.status === 0) {\r\n                this.timeStamp = retData.data.timestamp;\r\n                this.timeOffset = this.timeStamp - this.curLocalTime();\r\n                return Promise.resolve(this.timeOffset);\r\n            }\r\n            else {\r\n                return Promise.reject(retData.msg + ': ' + retData.status);\r\n            }\r\n        }, rj => {\r\n            return Promise.reject(rj);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 本地时间定时器\r\n     * */\r\n    static localUpdateTime(){\r\n        if(Utils.localTime === -1) Utils.localTime = this.curLocalTime();\r\n        setInterval(()=>{\r\n            Utils.localTime ++;\r\n        },1000);\r\n    }\r\n    /**\r\n     * 本地当前的系统时间\r\n     * */\r\n    static curLocalTime(){\r\n        return Math.floor((new Date()).getTime() / 1000);\r\n    }\r\n\r\n    static updateContextTimeValues(context) {\r\n        if (-1 === this.timeStamp) return;\r\n        //context.systemValues[2].value = Math.floor(Date.now() / 1000) + this.timeOffset;\r\n        context.systemValues[2].value = Utils.localTime + this.timeOffset;\r\n        let date = new Date(context.systemValues[2].value * 1000);\r\n        context.systemValues[3].value = date.getFullYear();\r\n        context.systemValues[4].value = date.getMonth() + 1;\r\n        context.systemValues[5].value = date.getDate();\r\n        context.systemValues[6].value = date.getHours();\r\n        context.systemValues[7].value = date.getMinutes();\r\n        context.systemValues[8].value = date.getSeconds();\r\n        context.systemValues[10].value = date.getDay();\r\n    }\r\n\r\n    static getCurrentDateTime(timestamp) {\r\n        let date = new Date(timestamp);\r\n        let seperator1 = \"-\";\r\n        let seperator2 = \":\";\r\n        let toStr = function(value, max, min) {\r\n            if (value >= min && value <= max) {\r\n                return ('0' + value);\r\n            }\r\n            else{\r\n                return ('' + value);\r\n            }\r\n        };\r\n        let currentdate = date.getFullYear()\r\n            + seperator1 + toStr(date.getMonth() + 1, 9, 1)\r\n            + seperator1 + toStr(date.getDate(), 9, 0)\r\n            + \" \" + toStr(date.getHours(), 9, 0)\r\n            + seperator2 + toStr(date.getMinutes(), 9, 0)\r\n            + seperator2 + toStr(date.getSeconds(), 9, 0);\r\n        return currentdate;\r\n    }\r\n\r\n    static createBlob(parts, type) {\r\n        let BlobBuilder, bb;\r\n        try {\r\n            return new Blob([parts]);\r\n        } catch (e) {\r\n            BlobBuilder = window.BlobBuilder ||\r\n                window.WebKitBlobBuilder ||\r\n                window.MozBlobBuilder ||\r\n                window.MSBlobBuilder;\r\n            if (BlobBuilder) {\r\n                bb = new BlobBuilder();\r\n                bb.append(parts);\r\n                return bb.getBlob(type);\r\n            } else {\r\n                throw new Error(\"Unable to create blob\");\r\n            }\r\n        }\r\n    }\r\n\r\n    static dataURLtoBlob(dataUrl) {\r\n        let arr = dataUrl.split(','), mime = arr[0].match(/:(.*?);/)[1],\r\n            bStr = atob(arr[1]), n = bStr.length, u8arr = new Uint8Array(n);\r\n        while(n--){\r\n            u8arr[n] = bStr.charCodeAt(n);\r\n        }\r\n        let blobObj = null;\r\n        try {\r\n            blobObj = new Blob([u8arr], {type:mime});\r\n        } catch (err) {\r\n            console.error(err.name + '  ' + err.message);\r\n        }\r\n        return blobObj;\r\n    }\r\n\r\n    static encodeBase64(msg) {\r\n        if (msg === '') return '';\r\n        return Base64.encode(msg)\r\n    }\r\n\r\n    static decryptBase64(msg) {\r\n        if (msg === '') return '';\r\n        return Base64.decode(msg)\r\n    }\r\n\r\n    static aesEncrypt(msg, type) {\r\n        //msg = JSON.stringify({\"ss\": 1});\r\n        if (msg === '') return '';\r\n        let rawKey = 'de3kt|jq|fdcgj_|';\r\n        let rawVec = 'ff_|pf|#%@fw_j+q';\r\n        if (type === 1) {\r\n            rawKey = 'WDF#$H*#SJN*&G$&';\r\n            rawVec = 'JH&$GF$DR%*K@SC%';\r\n        }\r\n        else if (type === 2) {\r\n            // 获取已收费章节\r\n            rawKey = 'aDF#$HGF$DN*&G$e';\r\n            rawVec = 'bH&$GF$DcF#$HSCf';\r\n        }\r\n        else if (type === 3) {\r\n            // 获取商品购买信息\r\n            rawKey = 'aDF#$HGF$DN*&G$e';\r\n            rawVec = 'bH&$GF$DcF#$HSCf';\r\n        }\r\n        // 密钥\r\n        let key = CryptoJS.enc.Utf8.parse(rawKey);\r\n        // 初始向量\r\n        let ivv = CryptoJS.enc.Utf8.parse(rawVec);\r\n        // 加密\r\n        let encrypted = CryptoJS.AES.encrypt(msg+'', key, {iv: ivv, mode: CryptoJS.mode.CBC, padding: CryptoJS.pad.ZeroPadding});\r\n        // 转换为字符串\r\n        let enstr = encrypted.toString();\r\n        return enstr;\r\n    }\r\n\r\n    static aesDecrypt(msg, type) {\r\n        //msg = 'b25zHxn+S5dnVOrJPDn6DQ==';\r\n        if (msg === '') return '';\r\n        let rawKey = 'de3kt|jq|fdcgj_|';\r\n        let rawVec = 'ff_|pf|#%@fw_j+q';\r\n        if (type === 1) {\r\n            rawKey = 'WDF#$H*#SJN*&G$&';\r\n            rawVec = 'JH&$GF$DR%*K@SC%';\r\n        }\r\n        else if (type === 2) {\r\n            // 获取已收费章节\r\n            rawKey = 'aDF#$HGF$DN*&G$e';\r\n            rawVec = 'bH&$GF$DcF#$HSCf';\r\n        }else if(type === 4){\r\n            // 敏感词\r\n            rawKey = 'xiamenshanyi4399';\r\n            rawVec = '';\r\n        }\r\n        // 密钥\r\n        let key = CryptoJS.enc.Utf8.parse(rawKey);\r\n        // 初始向量\r\n        let ivv = CryptoJS.enc.Utf8.parse(rawVec);\r\n        //解密\r\n        let decrypted = CryptoJS.AES.decrypt(msg, key, {iv: ivv, mode: type !== 4 ? CryptoJS.mode.CBC : CryptoJS.mode.ECB, padding: CryptoJS.pad.ZeroPadding});\r\n        let deStr = decrypted.toString(CryptoJS.enc.Utf8);\r\n        return deStr;\r\n    }\r\n\r\n    static getCookie(name) {\r\n        let arr,reg = new RegExp(\"(^| )\"+name+\"=([^;]*)(;|$)\");\r\n        if(arr = document.cookie.match(reg))\r\n            return decodeURI(arr[2]);\r\n        else\r\n            return null;\r\n    }\r\n\r\n    static getUidByCookie() {\r\n        let uid = this.getCookie('SYPauth');\r\n        if (uid) {\r\n            let index = uid.indexOf('|');\r\n            uid = uid.substring(0, index);\r\n        }\r\n        return uid ? uid : '';\r\n    }\r\n\r\n    static generateUUID() {\r\n        let d = new Date().getTime();\r\n        let uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\r\n            let r = (d + Math.random()*16)%16 | 0;\r\n            d = Math.floor(d/16);\r\n            return (c=='x' ? r : (r&0x3|0x8)).toString(16);\r\n        });\r\n        return uuid;\r\n    }\r\n\r\n    static localStorageGetItem(key) {\r\n        if (flashvars.app_version < '1.2.0') {\r\n            return window.localStorage.getItem(key);\r\n        }\r\n        if (flashvars.client === 'android' && window.app) {\r\n            const retValue = window.app.localStorage_getItem(key);\r\n            return (retValue === '' ? null : retValue);\r\n        }\r\n        else if (flashvars.client === 'ios') {\r\n            let returnValue = null;\r\n\r\n            if(flashvars.offline === '1'){\r\n                returnValue = localStorage_getItem(key);\r\n            } else {\r\n                returnValue = window.localStorage.getItem(key);\r\n            }\r\n\r\n            if (returnValue === '') returnValue = null;\r\n\r\n            return returnValue;\r\n        }\r\n        else if (flashvars.client === '') {\r\n            return window.localStorage.getItem(key);\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    static localStorageSetItem(key, value) {\r\n        if (flashvars.app_version < '1.2.0') {\r\n            window.localStorage.setItem(key, value);\r\n            /*if (flashvars.client === 'android' || flashvars.client === 'ios') {\r\n                this.uploadLocalStorage(key);\r\n            }*/\r\n            return\r\n        }\r\n        if (flashvars.client === 'android') {\r\n            window.app && window.app.localStorage_setItem(key, value);\r\n        }\r\n        else if (flashvars.client === 'ios') {\r\n            const arg = {key: key, value: value};\r\n            if(flashvars.offline === '1'){\r\n                localStorage_setItem(JSON.stringify(arg));\r\n            }else{\r\n                window.webkit && window.webkit.messageHandlers.localStorage_setItem.postMessage(JSON.stringify(arg));\r\n                window.localStorage.setItem(key, value);\r\n            }\r\n        }\r\n        else {\r\n            window.localStorage.setItem(key, value);\r\n        }\r\n    }\r\n\r\n    static localStorageRemoveItem(key) {\r\n        if (flashvars.app_version < '1.2.0') {\r\n            window.localStorage.removeItem(key);\r\n            return;\r\n        }\r\n        if (flashvars.client === 'android') {\r\n            window.app && window.app.removeLocalStorage(key);\r\n        }\r\n        else if (flashvars.client === 'ios') {\r\n            if(flashvars.offline === '1'){\r\n                removeLocalStorage(key);\r\n            }else{\r\n                window.webkit && window.webkit.messageHandlers.removeLocalStorage.postMessage(key);\r\n                window.localStorage.removeItem(key);\r\n            }\r\n        }\r\n        else {\r\n            window.localStorage.removeItem(key);\r\n        }\r\n    }\r\n\r\n    static localStorageClear() {\r\n        window.localStorage.clear();\r\n    }\r\n\r\n    static getSensitiveWords() {\r\n        let url = 'https://mapi.3000api.com/apis/soft/v1.0/game-GetSensitiveStr.html';\r\n        let data = 'action=all';\r\n        return xhr.xhrSend(url, data).then(rs => {\r\n            if (rs.responseText.length === 0) {\r\n                return Promise.reject('getSensitiveWords failed, no response data');\r\n            }\r\n            let retData = JSON.parse(rs.responseText);\r\n            if (retData.code == 100) {\r\n                if(Object.prototype.toString.call(retData.result) == '[object Array]'){\r\n                    this.sensitiveWords = retData.result.concat();\r\n                }else{\r\n                    const data = JSON.parse(Utils.aesDecrypt(retData.result,4));\r\n                    this.sensitiveWords = data.concat();\r\n                }\r\n                return Promise.resolve();\r\n            }\r\n            else {\r\n                return Promise.reject();\r\n            }\r\n        }, rj => {\r\n            return Promise.reject(rj);\r\n        });\r\n    }\r\n\r\n    static getDeviceId() {\r\n        if (flashvars.client === 'android') {\r\n            let uuid = navigator.userAgent.match(/[0-9A-Za-z]{8}-[0-9A-Za-z]{4}-[0-9A-Za-z]{4}-[0-9A-Za-z]{4}-[0-9A-Za-z]{12}/g);\r\n            return uuid ? uuid[0] : '';\r\n        }\r\n        else if (flashvars.client === 'ios') {\r\n            let uuid = navigator.userAgent.match(/[0-9A-Za-z]{40}/g);\r\n            return uuid ? uuid[0] : '';\r\n        }\r\n        return '';\r\n    }\r\n\r\n    static formatNum(n) {\r\n        if (0 === n) return '00000';\r\n        else if (n < 10) return ('0000' + n);\r\n        else if (n < 100) return ('000' + n);\r\n        else return ('00' + n);\r\n    };\r\n\r\n    static sendStatistics() {\r\n        if (flashvars.client !== 'android' && flashvars.client !== 'ios') {\r\n            return Promise.resolve();\r\n        }\r\n\r\n        let deviceId = this.getDeviceId();\r\n        let stime = Math.floor((new Date()).getTime() / 1000) + this.timeOffset;\r\n        let sSign = 'mac_name=' + deviceId + '&time=' + stime + '&uid=' + flashvars.uid + '&v_key=shanyi_WDF#$H*#SJN*&G$&**';\r\n        sSign = this.aesEncrypt(MD5.hash(MD5.hash(sSign)), 1);\r\n        stime = this.aesEncrypt(stime, 1);\r\n\r\n        let url = 'https://app.3000.com/?m=statistics&op=start&ac=h5&v=' + flashvars.v + '&client=' + flashvars.client;\r\n        let data = 'mac_name=' + encodeURIComponent(this.aesEncrypt(deviceId, 1)) + '&uid=' + encodeURIComponent(this.aesEncrypt(flashvars.uid, 1))\r\n            + '&sign=' + encodeURIComponent(sSign) + '&time=' + encodeURIComponent(stime);\r\n        return xhr.xhrSend(url, data);\r\n    }\r\n\r\n    static sendSelOptions() {\r\n        const doSend = () => {\r\n            if (this.selOptions.length === 0) {\r\n                setTimeout(timerHandler(), 30000);\r\n                return Promise.resolve();\r\n            }\r\n\r\n            let url = 'https://www.3000.com/apis/client/v1.0/trace-optionClick.html?';\r\n            let data = 'from=h5&uuid=' + flashvars.uuid + '&optionid=' + JSON.stringify(this.selOptions);\r\n            return xhr.xhrLoad(url + data, '').then(() => {\r\n                this.selOptions.splice(0, this.selOptions.length);\r\n                setTimeout(timerHandler(), 30000);\r\n                return Promise.resolve();\r\n            }, () => {\r\n                setTimeout(timerHandler(), 30000);\r\n                return Promise.reject();\r\n            });\r\n        };\r\n        const timerHandler = () => {\r\n            return function () {\r\n                doSend();\r\n            }\r\n        };\r\n        setTimeout(timerHandler(), 30000);\r\n    }\r\n\r\n    static searchChapterByUUID(game, uuid) {\r\n        const searchChapter = (chapter) => {\r\n            if (chapter.uuid === uuid) {\r\n                return chapter;\r\n            }\r\n\r\n            for (var i = 0; i < chapter.subchapters.length; ++i) {\r\n                const result = searchChapter(chapter.subchapters[i]);\r\n                if (result) {\r\n                    return result;\r\n                }\r\n            }\r\n        };\r\n\r\n        let result = null;\r\n        for (var i = 0; i < game.chapters.length; ++i) {\r\n            result = searchChapter(game.chapters[i]);\r\n            if (result) {\r\n                return result;\r\n            }\r\n        }\r\n        return result; \r\n    }\r\n\r\n    /*static uploadLocalStorage(spKey) {\r\n        if (flashvars.app_version >= '1.2.0') {\r\n            return Promise.resolve();\r\n        }\r\n\r\n        const deviceId = this.getDeviceId();\r\n        const tag = window.localStorage.getItem('syUploaded');\r\n\r\n        const uploadOneItem = (key, value) => {\r\n            const sendData = (url, data) => {\r\n                return xhr.xhrSend(url, data).then(rs => {\r\n                    if (rs.responseText.length === 0) {\r\n                        window.localStorage.removeItem('syUploaded');\r\n                        return Promise.reject('uploadOneItem failed, no response data');\r\n                    }\r\n                    let retData = JSON.parse(rs.responseText);\r\n                    if (retData.status === 0) {\r\n                        return Promise.resolve();\r\n                    }\r\n                    else {\r\n                        window.localStorage.removeItem('syUploaded');\r\n                        return Promise.reject();\r\n                    }\r\n                }, rj => {\r\n                    window.localStorage.removeItem('syUploaded');\r\n                    return Promise.reject(rj);\r\n                });\r\n            };\r\n\r\n            let valueBase64 = this.encodeBase64(value);\r\n            let stime = Math.floor((new Date()).getTime() / 1000) + this.timeOffset;\r\n            let sSign = 'content=' + valueBase64 + '&game_key=' + key + '&h5_version=' + commit + '&mac_name=' + deviceId + '&time=' + stime+ '&v_key=shanyi_WDF#$H*#SJN*&G$&**';\r\n            sSign = this.aesEncrypt(MD5.hash(MD5.hash(sSign)), 1);\r\n            stime = this.aesEncrypt(stime, 1);\r\n\r\n            let url = 'https://app.3000.com/?m=cloud_save&op=back_up&ac=save&v=' + flashvars.v + '&client=' + flashvars.client;\r\n            let data = 'game_key=' + encodeURIComponent(this.aesEncrypt(key, 1)) + '&mac_name=' + encodeURIComponent(this.aesEncrypt(deviceId, 1)) + '&h5_version='\r\n                + encodeURIComponent(this.aesEncrypt(commit, 1)) + '&content=' + encodeURIComponent(this.aesEncrypt(valueBase64, 1))\r\n                + '&sign=' + encodeURIComponent(sSign) + '&time=' + encodeURIComponent(stime);\r\n\r\n            return sendData(url, data);\r\n        };\r\n        const uploadItemOneByOne = (index, times) => {\r\n            if (index >= window.localStorage.length) {\r\n                // 全部上传成功 设置标志\r\n                window.localStorage.setItem('syUploaded', '1');\r\n                return Promise.resolve();\r\n            }\r\n            if (times > 3) {\r\n                // 上传失败只尝试4次\r\n                return Promise.resolve();\r\n            }\r\n            let key = window.localStorage.key(index);\r\n            let data = window.localStorage.getItem(key);\r\n            let check = key.match(/[0-9A-Za-z]{8}-[0-9A-Za-z]{4}-[0-9A-Za-z]{4}-[0-9A-Za-z]{4}-[0-9A-Za-z]{12}/g);\r\n\r\n            if (!check) {\r\n                return uploadItemOneByOne(index+1, 0)\r\n            }\r\n            return uploadOneItem(key, data).then(() => {\r\n                return uploadItemOneByOne(index+1, 0)\r\n            }, () => {\r\n                return uploadItemOneByOne(index, times+1)\r\n            });\r\n        };\r\n\r\n        if (!deviceId) {\r\n            return Promise.resolve();\r\n        }\r\n        if (!spKey && tag !== '1') {\r\n            return uploadItemOneByOne(0, 0);\r\n        }\r\n        else if (spKey) {\r\n            // 上传特定数据\r\n            let data = window.localStorage.getItem(spKey);\r\n            return uploadOneItem(spKey, data);\r\n        }\r\n        return Promise.resolve();\r\n    }\r\n\r\n    static downloadLocalStorage() {\r\n        if (flashvars.app_version < '1.2.0') {\r\n            return Promise.resolve();\r\n        }\r\n        const tag = this.localStorageGetItem('syDownloaded');\r\n        if (tag === '1') {\r\n            return Promise.resolve();\r\n        }\r\n        const deviceId = this.getDeviceId();\r\n        if (!deviceId) {\r\n            return Promise.resolve();\r\n        }\r\n\r\n        let keys = [];\r\n        const getKeys = () => {\r\n            let stime = Math.floor((new Date()).getTime() / 1000) + this.timeOffset;\r\n            let sSign = 'mac_name=' + deviceId + '&time=' + stime + '&v_key=shanyi_WDF#$H*#SJN*&G$&**';\r\n            sSign = this.aesEncrypt(MD5.hash(MD5.hash(sSign)), 1);\r\n            stime = this.aesEncrypt(stime, 1);\r\n\r\n            let url = 'https://app.3000.com/?m=cloud_save&op=back_up&ac=all_key&v=' + flashvars.v + '&client=' + flashvars.client;\r\n            let data = 'mac_name=' + encodeURIComponent(this.aesEncrypt(deviceId, 1)) + '&sign=' + encodeURIComponent(sSign) + '&time=' + encodeURIComponent(stime);\r\n            return xhr.xhrSend(url, data).then(rs => {\r\n                if (rs.responseText.length === 0) {\r\n                    return Promise.reject('getKeys failed, no response data');\r\n                }\r\n                let retData = JSON.parse(rs.responseText);\r\n                if (retData.status === 0) {\r\n                    keys = retData.data.result.concat();\r\n                    return Promise.resolve();\r\n                }\r\n                else {\r\n                    return Promise.reject();\r\n                }\r\n            }, rj => {\r\n                return Promise.reject();\r\n            })\r\n        };\r\n        const getValue = (index) => {\r\n            let stime = Math.floor((new Date()).getTime() / 1000) + this.timeOffset;\r\n            let sSign = 'game_key=' + keys[index] + '&mac_name=' + deviceId + '&time=' + stime + '&v_key=shanyi_WDF#$H*#SJN*&G$&**';\r\n            sSign = this.aesEncrypt(MD5.hash(MD5.hash(sSign)), 1);\r\n            stime = this.aesEncrypt(stime, 1);\r\n\r\n            let url = 'https://app.3000.com/?m=cloud_save&op=back_up&ac=info&v=' + flashvars.v + '&client=' + flashvars.client;\r\n            let data = 'game_key=' + encodeURIComponent(this.aesEncrypt(keys[index], 1)) + '&mac_name=' + encodeURIComponent(this.aesEncrypt(deviceId, 1))\r\n                + '&sign=' + encodeURIComponent(sSign) + '&time=' + encodeURIComponent(stime);\r\n\r\n            return xhr.xhrSend(url, data).then(rs => {\r\n                if (rs.responseText.length === 0) {\r\n                    return Promise.reject('getLocalStorageData failed, no response data');\r\n                }\r\n                let retData = JSON.parse(rs.responseText);\r\n                if (retData.status === 0) {\r\n                    let d = this.decryptBase64(retData.data.content);\r\n                    this.localStorageSetItem(keys[index], d);\r\n                    return Promise.resolve();\r\n                }\r\n                else {\r\n                    return Promise.reject();\r\n                }\r\n            }, rj => {\r\n                return Promise.reject();\r\n            })\r\n        };\r\n        const getItemOneByOne = (index) => {\r\n            if (index >= keys.length) {\r\n                // 数据已全部下载\r\n                this.localStorageSetItem('syDownloaded', '1');\r\n                return Promise.resolve();\r\n            }\r\n            return getValue(index).then(rs => {\r\n                return getItemOneByOne(index+1)\r\n            }, rj => {\r\n                return Promise.reject()\r\n            })\r\n        };\r\n\r\n        return getKeys().then(rs => {\r\n            return getItemOneByOne(0)\r\n        }, rj => {\r\n            return Promise.reject()\r\n        });\r\n    }*/\r\n}\r\n\r\nUtils.timeStamp = -1;        // 服务器时间戳\r\nUtils.timeOffset = 0;       // 与服务器间时间偏移量\r\nUtils.sensitiveWords = [];  // 敏感词\r\nUtils.selOptions = [];      // 游戏经过的选项uuid\r\nUtils.soundVolume = 1;      //音效大小百分比\r\nUtils.musicVolume = 1;      //音乐大小百分比\r\nUtils.localTime = -1;       //游戏开始时本地获取到的本地时间\r\n\r\nclass DelayRemoveManager {\r\n    constructor(){\r\n        this.gifList = [];\r\n        this.imgList = [];\r\n    }\r\n\r\n    popGif() {\r\n        const index = this.gifList.findIndex(c => ResourcesManager.getCount('img', c.key) === 1);\r\n        if (~index) {\r\n            const { key } = this.gifList[index];\r\n            this.gifList.splice(index, 1);\r\n            ResourcesManager.removeFromCache('img', key, true);\r\n        }\r\n    }\r\n\r\n    popImg() {\r\n        const index = this.imgList.findIndex(c => ResourcesManager.getCount('img', c.key) === 1);\r\n        if (~index) {\r\n            const { key } = this.imgList[index];\r\n            this.imgList.splice(index, 1);\r\n            ResourcesManager.removeFromCache('img', key, true);\r\n        }\r\n    }\r\n\r\n    push(key, isGif) {\r\n        if (isGif) {\r\n            this.gifList.push({ key, timestamp: Date.now() });\r\n            ResourcesManager.addRefCount('img', key, 'cache');\r\n            if (this.gifList.length > 20) {\r\n                this.popGif();\r\n            }\r\n        } else {\r\n            this.imgList.push({ key, timestamp: Date.now() });\r\n            ResourcesManager.addRefCount('img', key, 'cache');\r\n            if (this.imgList.length > 100) {\r\n                this.popImg();\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport class ResourcesManager {\r\n    static pushInLoader(url, type, key, isPlot) {\r\n        const sKey = key || url;\r\n        if (('img' === type && this.cache.checkImageKey(sKey) ||\r\n                'audio' === type && this.cache.checkSoundKey(sKey)) &&\r\n            !('ios' === flashvars.client && 'audio' === type && flashvars.app_version >= '1.5.0')) {\r\n            return Promise.resolve(false);\r\n        }\r\n        return Utils.convertToAllowAccessControlOriginUrl(url).then(url => {\r\n            if (!url) {\r\n                return false;\r\n            }\r\n            const noLoading = !this.load.getAsset('img' === type ? 'image' : 'audio', sKey);\r\n            if ('img' === type) {\r\n                noLoading && this.load.image(sKey, url);\r\n                !isPlot && this.addRefCount(\"img\", sKey, 'global');\r\n            } else if ('audio' === type) {\r\n                let bAutoDecode = this.forceDecode.music === sKey || this.forceDecode.sounds.some(k => k === sKey);\r\n                if ('ios' === flashvars.client && flashvars.app_version >= '1.5.0') {\r\n                    const noCache = !PhoneUtils.isAudioInCache(sKey) && !PhoneUtils.isLoadingAudio(sKey);\r\n                    if (noCache) {\r\n                        PhoneUtils.loadAudioUrl(sKey, url, flashvars.offline);\r\n                    }\r\n                    return noCache;\r\n                } else {\r\n                    noLoading && this.load.audio(sKey, url, bAutoDecode);\r\n                }\r\n                !isPlot && this.addRefCount(\"audio\", sKey, 'global');\r\n            }\r\n            return noLoading;            \r\n        }, e => console.error(\"Invalid URL: \" + e))\r\n    }\r\n\r\n    static forEachReCount(fun) {\r\n        Object.keys(this.refCount.audio).forEach(key => fun && fun('audio', key, this.getCount('audio', key)));\r\n        Object.keys(this.refCount.img).forEach(key => fun && fun('img', key, this.getCount('img', key)));\r\n    }\r\n\r\n    static resetReCount(filterKeys=[]) {\r\n        [this.refCount.img, this.refCount.audio].forEach((obj, i) => {\r\n            Object.keys(obj).forEach(key => {\r\n                const oldData = obj[key];\r\n                const { global=0, cache=0 } = oldData;\r\n                const newData = { global, cache };\r\n                const keys = Object.keys(obj[key]);\r\n                filterKeys.forEach(key => keys.forEach(k => ~k.indexOf(key) ? newData[k] = oldData[k] : void 0));\r\n                obj[key] = newData;\r\n            });\r\n        });\r\n    }\r\n\r\n    static updateRefTypePrefix(prefix, keep = true, remove = true) {\r\n        [this.refCount.img, this.refCount.audio].forEach((obj, i) => {\r\n            Object.keys(obj).forEach(key => {\r\n                if(!obj.hasOwnProperty(key)){\r\n                    return;\r\n                }\r\n                Object.keys(obj[key]).forEach(k => {\r\n                    if (k.startsWith(prefix)) {\r\n                        const refCount = k.replace(prefix, '');\r\n                        keep && refCount && (obj[key][refCount] = (obj[key][refCount] || 0)+(obj[key][k] || 0));\r\n                        delete obj[key][k];\r\n                        remove && this.removeFromCache(i ? 'audio' : 'img', key);\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    }\r\n\r\n    static transferRefCount(type, fKey, fRefType, tKey, tRefType) {\r\n        this.refCount[type][tKey] = this.refCount[type][tKey] || {};\r\n        this.refCount[type][tKey][tRefType] = this.refCount[type][tKey][tRefType] || 0;\r\n        if (!this.refCount[type][fKey]) {\r\n            return;\r\n        }\r\n        this.refCount[type][tKey][tRefType] += this.refCount[type][fKey][fRefType];\r\n        this.refCount[type][fKey][fRefType] = 0;\r\n        this.removeFromCache(type, fKey);\r\n    }\r\n\r\n    static transferByRefCount(fRefType, tRefType) {\r\n        [this.refCount.img, this.refCount.audio].forEach(obj => {\r\n            Object.keys(obj).forEach(key => {\r\n                const refCount = obj[key];\r\n                refCount[tRefType] = (refCount[tRefType] || 0)+(refCount[fRefType] || 0);\r\n                delete refCount[fRefType];\r\n            });\r\n        });\r\n    }\r\n\r\n    static transferByRefCountByPrefix(prefix, refType) {\r\n        [this.refCount.img, this.refCount.audio].forEach(obj => {\r\n            Object.keys(obj).forEach(key => {\r\n                const refCount = obj[key];\r\n                let count = 0;\r\n                Object.keys(refCount).forEach(k => {\r\n                    if (k.startsWith(prefix)) {\r\n                        count += refCount[k]\r\n                        delete refCount[k];\r\n                    }\r\n                });\r\n                refCount[refType] = (refCount[refType] || 0) + count;\r\n            });\r\n        });\r\n    }\r\n    \r\n    static addRefCount(type, key, refType='play', count=1) {\r\n        if (!type || !key) {\r\n            return;\r\n        }\r\n        this.load.cancelForceRemoveFile(type, key);\r\n        this.refCount[type][key] = this.refCount[type][key] || {};\r\n        this.refCount[type][key][refType] = (this.refCount[type][key][refType] || 0) + count;\r\n    }\r\n\r\n    static subRefCount(type, key, refType='play') {\r\n        if (this.refCount[type][key]) {\r\n            const keys = Object.keys(this.refCount[type][key]);\r\n            for (let i = 0; i < keys.length; i++) {\r\n                if (/^\\$([A-Za-z0-9]*-){4}([A-Za-z0-9]*)l\\d/.test(keys[i])) {\r\n                    return;\r\n                }\r\n            }\r\n            const refCount = this.refCount[type][key];\r\n            refCount[refType] = (refCount[refType] || 0) - 1;\r\n            refCount[refType] = refCount[refType] < 0 ? 0 : refCount[refType];\r\n            this.removeFromCache(type, key);\r\n        }\r\n        else if ('audio' === type && 'ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n            !!key && PhoneUtils.removeAudioUrl(key);\r\n        }\r\n    }\r\n\r\n    static delRefTypeCount(type, key, refType) {\r\n        if (this.refCount[type][key]) {\r\n            const refCount = this.refCount[type][key];\r\n            refCount[refType] = 0;\r\n            this.removeFromCache(type, key);\r\n        }\r\n    }\r\n\r\n    static delByRefType(refType){\r\n        [this.refCount.img, this.refCount.audio].forEach((obj, i) => {\r\n            Object.keys(obj).forEach(key => {\r\n                delete obj[key];\r\n                this.removeFromCache(i ? 'audio' : 'img', key);\r\n            });\r\n        });\r\n    }\r\n\r\n    static getCount(type, key, refType = '') {\r\n        return this.refCount[type][key]\r\n            ? (refType ? (this.refCount[type][key][refType] || 0) : Object.keys(this.refCount[type][key]).reduce((acc, cur) => acc + this.refCount[type][key][cur], 0))\r\n            : 0;\r\n    }\r\n\r\n    static isGlobal(type, key) {\r\n        return this.refCount[type][key]['global'] > 0;\r\n    }\r\n\r\n    static removeFromCache(type, key, force = false) {\r\n        if (!this.refCount[type][key]) {\r\n            return;\r\n        }\r\n       \r\n        if (this.getCount(type, key) && !force) {\r\n            return;\r\n        }\r\n\r\n        const { background, music, sounds, preBackground } = this.usingKeyMap;\r\n        if (background === key || preBackground === key || music === key) {\r\n            this.addRefCount(type, key);\r\n            return;\r\n        }\r\n        for (let i = 0; i < sounds.length; i++) {\r\n            if (sounds[i] === key) {\r\n                this.addRefCount(type, key);\r\n                return;\r\n            }\r\n        }\r\n\r\n        if (type === 'audio' && this.cache) {\r\n            if ('ios' === flashvars.client && flashvars.app_version >= '1.5.0') {\r\n                PhoneUtils.removeAudioUrl(key);\r\n            }\r\n            else {\r\n                const sound = this.cache.getSound(key);\r\n                if (sound && sound.audioTag && sound.data) {\r\n                    sound.data.free = true;\r\n                }\r\n                if (sound && /blob:/i.test(sound.url)) {\r\n                    URL.revokeObjectURL(sound.url);\r\n                }\r\n                this.cache.checkSoundKey(key) && this.cache.removeSound(key);\r\n                this.load.forceRemoveFile(type, key);\r\n            }\r\n            this.PreloadState.size += 2000000;\r\n        }\r\n\r\n        if (type === 'img' && this.cache) {\r\n            if (key.indexOf(\"?\") >= 0){\r\n                key = key.substr(0, key.indexOf(\"?\"));\r\n            }\r\n            const extension = key.substr((Math.max(0, key.lastIndexOf(\".\")) || Infinity) + 1).toLowerCase();\r\n            if (!force) {\r\n                this.delayRemoveManager.push(key, extension === 'gif');\r\n                this.PreloadState.size += 200000;\r\n                this.startPreloadResources();\r\n                return;\r\n            }\r\n            const image = this.cache.getImage(key, true);\r\n            if(image){\r\n                const { frames } = image.data;\r\n                frames && frames.forEach((frame) => {\r\n                    URL.revokeObjectURL(frame.blobUrl);\r\n                    frame.blobUrl = null;\r\n                });\r\n                /blob:/i.test(image.url) && URL.revokeObjectURL(image.url);\r\n                this.cache.checkImageKey(key) && this.cache.removeImage(key);\r\n                this.load.forceRemoveFile('image', key);\r\n            }\r\n            this.PreloadState.size += 200000;\r\n        }\r\n        delete this.refCount[type][key];\r\n        this.startPreloadResources();\r\n    }\r\n\r\n    static startPreloadResources() {\r\n        if (this.PreloadState.loading || this.PreloadState.size <= 0) {\r\n            return;\r\n        }\r\n        this.PreloadState.loading = true;\r\n\r\n        const createhMark = ({ context, chapter, pIndex, cmdInfo, cIndex, preloadType, preloadedCount, lock }) => {\r\n            const { ...c } = context;\r\n            c.stack = [...(c.stack || [])];\r\n            c.cmdStack = [...(c.cmdStack || [])];\r\n            return { context: c, chapter, pIndex, cmdInfo, cIndex, preloadType, preloadedCount, lock };\r\n        };\r\n\r\n        const getOptinsMarks = (plot, type, mark) => {\r\n            const { context, chapter, pIndex = 0, cmdInfo, cIndex = 0, preloadType } = mark;\r\n            let marks = [];\r\n            const options = plot[type] || [];\r\n            for(let i=0; i< options.length; i++){\r\n                const option = options[i];\r\n                if(!option.plots.length){\r\n                    continue;\r\n                }\r\n                let temp = createhMark(mark);\r\n                temp.chapter = {plots: option.plots, uuid: chapter.uuid};;\r\n                temp.pIndex = 0;\r\n                const t = type === 'options' ? 'o' : (option.type !== 'branch' && this.checkCondOptionResources(option) <= 50 ? 'l' : 'c');\r\n                temp.preloadType = `${preloadType==='play'?'':preloadType}$${plot.uuid}${t}${i}-`;\r\n                if(option.plots[0].commands){\r\n                    temp.cmdInfo = { commands: option.plots[0].commands };\r\n                    temp.cIndex = 0;\r\n                }\r\n                marks.push(temp);\r\n            }\r\n            return marks;\r\n        };\r\n\r\n        const getCmdOptinsMarks = (cmd, mark) => {\r\n            const { context, chapter, pIndex = 0, cmdInfo, cIndex = 0, preloadType } = mark;\r\n            let marks = [];\r\n            const options = cmd.args;\r\n            for(let i=0; i< options.length; i++){\r\n                const option = options[i];\r\n                if(!option.commands.length){\r\n                    continue;\r\n                }\r\n                let temp = createhMark(mark);\r\n                temp.cmdInfo = { commands: option.commands, parentInfo: cmdInfo, parentCmdIndex: cIndex };\r\n                temp.cIndex = 0;\r\n                let t = cmd.type === 'options' ? 'o' : (option.type !== 'branch' && this.checkCondOptionResources(option, 'command') <= 50 ? 'l' : 'c');\r\n                temp.preloadType = `${preloadType==='play'?'':preloadType}$${cmd.uuid}${t}${i}-`;\r\n                marks.push(temp);\r\n            }\r\n            return marks;\r\n        };\r\n\r\n        const updateMarkCmdInfo = (mark) => {\r\n            if (!mark.cmdInfo && mark.chapter.plots.length > mark.pIndex && mark.chapter.plots[mark.pIndex].commands) {\r\n                mark.cmdInfo = { commands: mark.chapter.plots[mark.pIndex].commands };\r\n                mark.cIndex = 0;\r\n            }\r\n        };\r\n\r\n        const updateMark = (mark, type, data) => {\r\n            mark = createhMark(mark);\r\n            let { context, chapter, cmdInfo, preloadType, pIndex=0, cIndex=0 } = mark;\r\n            let newChapter = null;\r\n            let temp = null;\r\n            switch(type){\r\n                case 'pop':\r\n                    temp = context.stack[0];\r\n                    context.stack = context.stack.slice(1);\r\n                    mark.chapter = chapter.parent.pChapter;\r\n                    mark.pIndex = chapter.parent.pnPlot + 1;\r\n                    mark.preloadType = 'play';\r\n                    mark.cmdInfo = null;\r\n                    if(temp && temp.type === 'insert'){\r\n                        context.cmdStack = context.cmdStack.slice(1);\r\n                        mark.cmdInfo = temp.cmdInfo;\r\n                        mark.cIndex = temp.cmdIndex + 1; \r\n                        mark.preloadType = temp.preloadType || 'play';\r\n                        mark.pIndex--;\r\n                    }\r\n                    updateMarkCmdInfo(mark);\r\n                    break;\r\n                case 'jump':\r\n                case 'command-jump':\r\n                    context._preMark = { stack:[], cmdStack:[], chapter, cmdInfo, pIndex, cIndex, preloadType };\r\n                    context.stack = [];\r\n                    context.cmdStack = [];\r\n                    mark.cmdInfo = null;\r\n                    mark.chapter = Utils.searchChapterByUUID(this.gameData, data);\r\n                    mark.pIndex = 0;\r\n                    mark.preloadType = `${preloadType==='play'?'':preloadType}$${mark.chapter.uuid}j`;\r\n                    updateMarkCmdInfo(mark);\r\n                    break;\r\n                case 'insert':\r\n                case 'command-insert':\r\n                    context._preMark = { stack:context.stack, cmdStack:context.cmdStack, chapter, cmdInfo, pIndex, cIndex, preloadType };\r\n                    context.stack = [];\r\n                    context.cmdStack = [];\r\n                    mark.cmdInfo = null;\r\n                    mark.chapter = Utils.searchChapterByUUID(this.gameData, data);\r\n                    mark.pIndex = 0;\r\n                    mark.preloadType = `${preloadType==='play'?'':preloadType}$${mark.chapter.uuid}i`;\r\n                    updateMarkCmdInfo(mark);\r\n                    break;\r\n                case 'command-pop':\r\n                    mark.cmdInfo = cmdInfo && cmdInfo.parentInfo || null;\r\n                    mark.cIndex = (cmdInfo && cmdInfo.parentCmdIndex || 0) + 1;\r\n                    if (cmdInfo.parentInfo) {\r\n                        mark.preloadType = 'play';\r\n                        context.cmdStack = context.cmdStack.slice(1);\r\n                    } else {\r\n                        mark.cmdInfo = null;\r\n                        mark.pIndex++;\r\n                        updateMarkCmdInfo(mark);\r\n                    }\r\n                    break;\r\n                case 'command-break':\r\n                    mark.cmdInfo = null;\r\n                    mark.pIndex++;\r\n                    updateMarkCmdInfo(mark);\r\n                    break;\r\n            }\r\n            return mark;\r\n        }\r\n\r\n        const updateLoadedMarks = () => {\r\n            const specialTypes = ['jump', 'insert', 'back', 'options', 'conditionOptions', 'addImage', 'showDialog', 'playMusic', 'playSound', 'weather'];\r\n            for (let j = 0, len = this.LoadedMark.length; this.LoadedMark && j < len; j++) {\r\n                for (let i = 0; this.LoadedMark[j] && i < this.LoadedMark[j].length; i++) {\r\n                    let mark = this.LoadedMark[j][i];\r\n                    let { context, chapter, pIndex = 0, cmdInfo, cIndex = 0, preloadType } = mark;\r\n\r\n                    const weight = isNoUrgentlyMark(mark);\r\n                    if(weight){\r\n                        let optionCount = 0;\r\n                        if (cmdInfo) {\r\n                            const cmd = cmdInfo.commands[cIndex] || {};\r\n                            const { type, args } = cmd;\r\n                            optionCount = type === 'options' || type === 'conditionOptions' ? args.length : 0;\r\n                        } else {\r\n                            const plot = chapter.plots[pIndex] || {};\r\n                            const { options=[], condition_options=[] } = plot;\r\n                            optionCount = Math.max(options.length, condition_options.length);\r\n                        }\r\n                      \r\n                        if(optionCount>5){\r\n                           // console.log(1);\r\n                        }\r\n                        mark.preloadedCount = mark.preloadedCount || 0;\r\n                        if (mark.preloadedCount > 10 || (weight === 2 && mark.preloadedCount > 1) || optionCount > 8) {\r\n                            mark.lock = true;\r\n                            continue;\r\n                        } else {\r\n                            mark.preloadedCount++;\r\n                        }\r\n                    }\r\n\r\n                    if (mark.lock) {\r\n                        mark.lock = false;\r\n                        mark.preloadedCount = 0;\r\n                        continue;\r\n                    }\r\n\r\n                    if (cmdInfo) {\r\n                        if (cmdInfo.commands.length <= cIndex) {\r\n                            this.LoadedMark[j].splice(i--, 1);\r\n                            if ((context.stack.length || context.cmdStack.length) && cmdInfo.parentInfo) {\r\n                                this.pushLoadMarks([updateMark(mark, 'command-pop')]);\r\n                            } else if (!cmdInfo.parentInfo) {\r\n                                this.pushLoadMarks([updateMark(mark, 'command-break')]);\r\n                            }\r\n                        } else {\r\n                            const command = cmdInfo.commands[cIndex] || {};\r\n                            const { type, args } = command;\r\n                            if (type === 'options' || type === 'conditionOptions') {\r\n                                const marks = getCmdOptinsMarks(command, mark);\r\n                                mark.cIndex++;\r\n                                marks.length && this.pushLoadMarks(marks);\r\n                            } else if (type === 'back' || type === 'jump' || type === 'insert') {\r\n                                if (type !== 'insert') {\r\n                                    this.LoadedMark[j].splice(i--, 1);\r\n                                }\r\n                                type === 'jump' && this.pushLoadMarks([updateMark(mark, `command-jump`, args[0])]);\r\n                                type === 'insert' && this.pushLoadMarks([updateMark(mark, `command-insert`, args[0])]);\r\n                                mark.cIndex++;\r\n                            } else {\r\n                                let { type } = cmdInfo.commands[++mark.cIndex] || {};\r\n                                while (type && !specialTypes.some(t => t === type)) {\r\n                                    ({ type } = cmdInfo.commands[++mark.cIndex] || {});\r\n                                }\r\n                            }\r\n                        }\r\n                    } else if (chapter.plots.length <= pIndex) {\r\n                        this.LoadedMark[j].splice(i--, 1);\r\n                        if (context.stack.length) {\r\n                            mark = updateMark(mark, 'pop');\r\n                            this.pushLoadMarks([mark]);\r\n                        }\r\n                    } else {\r\n                        const plot = chapter.plots[pIndex] || {};\r\n                        const { options=[], condition_options=[] } = plot;\r\n                        if (options.length || condition_options.length) {\r\n                            const oMarks = getOptinsMarks(plot, 'options', mark);\r\n                            const cMarks = getOptinsMarks(plot, 'condition_options', mark);\r\n\r\n                            mark.pIndex++;\r\n                            updateMarkCmdInfo(mark);\r\n\r\n                            oMarks.length && this.pushLoadMarks(oMarks);\r\n                            cMarks.length && this.pushLoadMarks(cMarks);\r\n                        } else if(plot.back || plot.jump || plot.insert){\r\n                            if (!plot.insert) {\r\n                                this.LoadedMark[j].splice(i--, 1);\r\n                            }\r\n                            plot.jump && this.pushLoadMarks([updateMark(mark, 'jump', plot.jump)]);\r\n                            plot.insert && this.pushLoadMarks([updateMark(mark, 'insert', plot.insert)]);\r\n                            mark.pIndex++;\r\n                            updateMarkCmdInfo(mark);\r\n                        } else {   \r\n                            mark.pIndex++;\r\n                            updateMarkCmdInfo(mark);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            for (let i = 0; this.LoadedMark && i < this.LoadedMark.length; i++) {\r\n                if(this.LoadedMark[i] && !this.LoadedMark[i].length){\r\n                    this.LoadedMark.splice(i--, 1);\r\n                }\r\n            }\r\n        };\r\n\r\n        const revertMark = mark => {\r\n            if(mark.context._preMark){\r\n                let { stack, cmdStack, chapter } = mark.context._preMark;\r\n                mark.context.stack = stack;\r\n                mark.context.cmdStack = cmdStack;\r\n                mark.chapter = chapter;\r\n                mark.pIndex = 0;\r\n                updateMarkCmdInfo(mark);\r\n                delete mark.context._preMark;\r\n            }\r\n        };\r\n\r\n        const loadChapter = mark => {\r\n            const { chapter } = mark;\r\n            if (chapter.md5 && chapter.plots.length === 0 && flashvars.offline !== '1' && !chapter.chapter) {//非离线，非付费章节\r\n                const chapterUuid = chapter.downloadUuid ? chapter.downloadUuid : chapter.uuid;\r\n                let loadChapterPromise = null;\r\n                const handle = ({ type, plots=[] }) => {\r\n                    if (type === 'revert') {\r\n                        revertMark(mark);\r\n                    } else if (type === 'succes') {\r\n                        chapter.plots.length === 0 && chapter.plots.push(...plots);\r\n                        this.PreloadState.loadingChapterMap[chapterUuid] = null;\r\n                    }\r\n                    return mark;\r\n                };\r\n                if(this.PreloadState.loadingChapterMap[chapterUuid]){\r\n                    return this.PreloadState.loadingChapterMap[chapterUuid].then(handle);\r\n                }\r\n                loadChapterPromise = this.sceneProxy.checkIfChapterFree(chapterUuid, chapter.md5, false).then(\r\n                    (plots=[]) => {\r\n                        return {type:'succes', plots};\r\n                    }, (msg) => {\r\n                        console.warn(msg);\r\n                    });\r\n                this.PreloadState.loadingChapterMap[chapterUuid] = loadChapterPromise;\r\n                return loadChapterPromise.then(handle);\r\n            }\r\n            return Promise.resolve(mark);\r\n        };\r\n        \r\n        const isNoUrgentlyMark = mark => {\r\n            let { preloadType='play' } = mark;\r\n            const types = preloadType.split('$').slice(1).map(s => {\r\n                const t = s.slice(36);\r\n                if (/j$/.test(t)) {\r\n                    return 'jump';\r\n                } else if (/i$/.test(t)) {\r\n                    return 'insert';\r\n                } else if (/o\\d-$/.test(t)) {\r\n                    return 'option';\r\n                } else if (/(c|l)\\d-$/.test(t)) {\r\n                    return 'condOption';\r\n                }\r\n            });\r\n            let optionIndexs = [];\r\n            let condOptionIndexs = [];\r\n            let gotoIndexs = [];\r\n            let result = 0;\r\n            for (let i = 0; i < types.length; i++) {\r\n                switch (types[i]) {\r\n                    case 'option':\r\n                        optionIndexs.push(i);\r\n                        if (gotoIndexs.length) {\r\n                            return 2;\r\n                        }\r\n                        if (optionIndexs.length > 2) {\r\n                            return 2;\r\n                        } else if (optionIndexs.length === 2) {\r\n                            result = 1;\r\n                        }\r\n                        break;\r\n                    case 'condOption':\r\n                        condOptionIndexs.push(i);\r\n                        if (condOptionIndexs.length > 2 && gotoIndexs.length >= 1) {\r\n                            return 2;\r\n                        }\r\n                        if(condOptionIndexs.length > 2){\r\n                            result = 1;\r\n                        }\r\n                        break;\r\n                    case 'jump':\r\n                    case 'insert':\r\n                        gotoIndexs.push(i);\r\n                        result = 1;\r\n                        if (optionIndexs.length > 1) {\r\n                            return 2;\r\n                        }\r\n                        if (gotoIndexs.length > 1) {\r\n                            return 2;\r\n                        }\r\n                        break;\r\n                }\r\n                if (gotoIndexs.length && condOptionIndexs.length + optionIndexs.length > 2) {\r\n                    return 2;\r\n                }\r\n                if (i === 4) {\r\n                    return 1;\r\n                } else if (i > 4) {\r\n                    return 2;\r\n                }\r\n            }\r\n            return result;\r\n        }\r\n\r\n        const preloadResources = () => {\r\n            updateLoadedMarks();\r\n            const promises = [];\r\n            let loadedCount = 0;\r\n            for (let i = 0; this.LoadedMark && i < this.LoadedMark.length && this.PreloadState.preloaded < 200; i++) {\r\n                const markPromises = [];\r\n                for (let j = 0; this.LoadedMark[i] && j < this.LoadedMark[i].length; j++) {\r\n                    const mark = this.LoadedMark[i][j];\r\n                    if(mark.lock){\r\n                        continue;\r\n                    }\r\n                    const promise = Utils.timeout(0)\r\n                        .then(() => this.LoadedMark[i] && this.LoadedMark[i][j] && mark === this.LoadedMark[i][j] ? loadChapter(this.LoadedMark[i][j]) : Promise.reject())\r\n                        .then(mark => this.preloadResources(mark))\r\n                        .then(rs => Promise.all(rs.data.map(d => this.pushInLoader(d.key, d.type, d.key, true).then(r => Object.assign(d, {pushed: r})))))\r\n                        .then(rs => {\r\n                            const pushedList = rs.filter(r => r.pushed);\r\n                            const size = pushedList.reduce((acc, cur) => acc + (cur.type === 'img' ? 200000 : 2000000), 0);\r\n                            this.PreloadState.size -= size;\r\n                            if (pushedList.length && size) {\r\n                                loadedCount++;\r\n                            }\r\n                            pushedList.length && this.load.start();\r\n                        }).then(() => Utils.timeout(15));\r\n                    markPromises.push(promise);      \r\n                }\r\n\r\n                markPromises.length && promises.push(Promise.all(markPromises).then(null, r => console.warn(r)));\r\n            }\r\n            const finish = () => {\r\n                loadedCount && this.PreloadState.preloaded++;\r\n                if (this.PreloadState.size <= 0 || !this.LoadedMark.length || this.PreloadState.preloaded >= 200) {\r\n                    this.PreloadState.loading = false;\r\n                } else {\r\n                    setTimeout(preloadResources, 0);\r\n                }\r\n            };\r\n            promises.length ? Promise.all(promises).then(finish, finish) : (this.PreloadState.loading = false);\r\n        };\r\n\r\n       setTimeout(preloadResources, 0);\r\n    }\r\n\r\n    static resetInsertPreload(chapter) {\r\n        const preloadType = `$${chapter.uuid}i`;\r\n        this.transferByRefCount(preloadType, 'play');\r\n        this.updateRefTypePrefix(preloadType);\r\n        this.updateLoadMarkByPrefix(preloadType);\r\n        this.startPreloadResources();\r\n    }\r\n\r\n    static resetInsertBack(context, chapter, pIndex=0, cmdPlotSnap = {}) {\r\n        const { cmdInfo, cmdIndex=0 } = cmdPlotSnap\r\n        ResourcesManager.LoadedMark = [];\r\n        this.resetReCount();\r\n        const usingKeyMap = this.sceneProxy.usingResourceCountMap();\r\n        this.forEachReCount((type, key, count) => {\r\n            if(usingKeyMap[key]){\r\n                this.addRefCount(type, key, usingKeyMap[key]);\r\n            }\r\n        });\r\n        this.getResourcesByContext(context, chapter, pIndex, cmdInfo, cmdIndex).then(() => this.startPreloadResources()); \r\n    }\r\n\r\n    static resetJumpPreload(chapter) {\r\n        const preloadType = `$${chapter.uuid}j`;\r\n        this.resetReCount([preloadType]);\r\n        this.transferByRefCount(preloadType, 'play');\r\n        this.updateRefTypePrefix(preloadType, true, false);\r\n        const usingKeyMap = this.sceneProxy.usingResourceCountMap();\r\n        this.forEachReCount((type, key, count) => {\r\n            if(usingKeyMap[key]){\r\n                this.addRefCount(type, key, usingKeyMap[key]);\r\n            }else if(count === 0){\r\n                this.removeFromCache(type, key);\r\n            }\r\n        });\r\n        this.updateLoadMarkByPrefix(preloadType, false);\r\n        this.startPreloadResources();\r\n    }\r\n\r\n    static resetCmdPOptionPreload(commands, index, opIndex) {\r\n        const cmd = commands[index];\r\n        if(!cmd){\r\n            return;\r\n        }\r\n        const t = cmd.type === 'options' ? 'o' : 'c';\r\n        const preloadType = `$${cmd.uuid}${t}${opIndex}-`;\r\n\r\n        const optionMarks = [];\r\n        for (let i = 0; i < this.LoadedMark.length; i++) {\r\n            for (let j = 0; j < this.LoadedMark[i].length; j++) {\r\n                const mark = this.LoadedMark[i][j];\r\n                if (mark.preloadType.startsWith(preloadType)) {\r\n                    optionMarks.push(mark);\r\n                }\r\n            }\r\n        }\r\n        const nextJump = optionMarks.length && optionMarks.every(mark => /^\\$.{36}j/.test(mark.preloadType.substring(preloadType.length)));\r\n        this.transferByRefCount(preloadType, 'play');\r\n        cmd.args.forEach((options, i) => {\r\n            const prefix = `$${cmd.uuid}${t}${i}-`;\r\n            const isSame = i === opIndex;\r\n            !isSame && this.updateRefTypePrefix(prefix);\r\n            !isSame && this.clearLoadMarkByPrefix(prefix);\r\n        });\r\n        this.updateLoadMarkByPrefix(preloadType, !nextJump, false);\r\n        this.updateRefTypePrefix(preloadType, true);\r\n        this.startPreloadResources();\r\n    }\r\n\r\n    static clearPreCmdResources(commands, index) {\r\n        this.startPreloadResources();\r\n        const cmd = commands[index-1];\r\n        const specialTypes = ['jump', 'insert', 'back', 'options', 'conditionOptions', 'addImage', 'showDialog', 'playMusic', 'playSound', 'weather'];\r\n        if(cmd && specialTypes.some(t => t === cmd.type)){\r\n            this.PreloadState.preloaded--;\r\n        }\r\n        if(!cmd || cmd.type!== 'conditionOptions'){\r\n            return;\r\n        }\r\n        cmd.args.forEach((options, i) => this.updateRefTypePrefix(`$${cmd.uuid}l${i}-`, false));\r\n    }\r\n\r\n    static resetPlotOptionPreload(plot, optionType='', index = -1) {\r\n        const type = optionType === 'options' ? 'o' : (optionType === 'condition_options' ? 'c' : '');\r\n        const { options=[], condition_options=[] } = plot;\r\n        if (!options.length && !condition_options.length) {\r\n            return;\r\n        }\r\n        const preloadType = `$${plot.uuid}${type}${index}-`;\r\n        const optionMarks = [];\r\n        for (let i = 0; i < this.LoadedMark.length; i++) {\r\n            for (let j = 0; j < this.LoadedMark[i].length; j++) {\r\n                const mark = this.LoadedMark[i][j];\r\n                if (mark.preloadType.startsWith(preloadType)) {\r\n                    optionMarks.push(mark);\r\n                }\r\n            }\r\n        }\r\n        this.transferByRefCount(preloadType, 'play');\r\n        const nextJump = optionMarks.length && optionMarks.every(mark => /^\\$.{36}j/.test(mark.preloadType.substring(preloadType.length)));\r\n        options.forEach((options, i) => {\r\n            const prefix = `$${plot.uuid}o${i}-`;\r\n            const sameIndex = i === index && optionType === 'options';\r\n            !sameIndex && this.updateRefTypePrefix(prefix, sameIndex);\r\n            !sameIndex && this.clearLoadMarkByPrefix(prefix);\r\n        });\r\n        condition_options.forEach((options, i) => {\r\n            const prefix = `$${plot.uuid}c${i}-`;\r\n            const sameIndex = i === index && optionType === 'condition_options';\r\n            !sameIndex && this.updateRefTypePrefix(prefix, sameIndex);\r\n            !sameIndex && this.clearLoadMarkByPrefix(prefix);\r\n        });\r\n        this.updateLoadMarkByPrefix(preloadType, !nextJump, false);\r\n        this.updateRefTypePrefix(preloadType, true);\r\n\r\n        this.startPreloadResources();\r\n    }\r\n\r\n    static clearPrePlotResources(plots, index) {\r\n        this.startPreloadResources();\r\n        this.PreloadState.preloaded--;\r\n        const plot = plots[index - 1];\r\n        if (!plot || plot.commands ||  !plot.condition_options && !plot.condition_options.length) {\r\n            return;\r\n        }\r\n        const { condition_options=[] } = plot;\r\n        condition_options.forEach((options, i) => this.updateRefTypePrefix(`$${plot.uuid}l${i}-`, false));\r\n     }\r\n\r\n    static preloadResources(loadedMark){\r\n        let {context, chapter, pIndex = 0, cmdInfo, cIndex =0, preloadType} = loadedMark;\r\n        const resources = { data: [], size: 0 };\r\n        if (!chapter || !chapter.plots || !chapter.plots[pIndex] || cmdInfo && !cmdInfo.commands[cIndex]) {\r\n            return Promise.resolve(resources);\r\n        }\r\n\r\n        const addRefCount = (type, url, preloadType) => this.addRefCount(type, url, preloadType);\r\n\r\n        const addResource = (url, type, preloadType) => {\r\n            addRefCount(type, url, preloadType);\r\n            if (!resources.data.some(d => d.key === url)) {\r\n                return xhr.getResourceSize(url, type).then(size => {\r\n                    resources.data.push({ key: url, type, size });\r\n                    resources.size += size;\r\n                    return true;\r\n                });\r\n            }\r\n            return Promise.resolve(false);\r\n        };\r\n        const getInCmdInfo = (cmdInfo, cIndex, preloadType) => {\r\n            if (cIndex >= cmdInfo.commands.length) {\r\n                return Promise.resolve();\r\n            }\r\n            return Promise.all(this.getCommandResources(cmdInfo.commands[cIndex]).map(r => addResource(r.url, r.type, preloadType)));\r\n        };\r\n\r\n        const getInChapter = (chapter, pIndex ,preloadType) => {\r\n            const promises = [];\r\n            const plot = chapter.plots[pIndex];\r\n\r\n            if (!plot || plot.commands && !plot.commands.length) {\r\n                return Promise.resolve();\r\n            }\r\n\r\n            if(plot.commands){\r\n                loadedMark.cmdInfo = { commands: plot.commands };\r\n                loadedMark.cIndex = 0;\r\n                return getInCmdInfo(plot, 0, preloadType);\r\n            }\r\n\r\n            return Promise.all(this.getPlotResources(plot).map(r => addResource(r.url, r.type, preloadType)));\r\n        };\r\n\r\n        return cmdInfo\r\n            ? getInCmdInfo(cmdInfo, cIndex, preloadType).then(() => resources)\r\n            : getInChapter(chapter, pIndex, preloadType).then(() => resources);\r\n    }\r\n\r\n    static pushLoadMarks(marks) {\r\n        if (!marks.length) {\r\n            return;\r\n        }\r\n        const revertMark = (mark, count) => {\r\n            let { context, cmdInfo, cIndex, chapter, pIndex } = mark;\r\n            context = { ...context, stack:[...(context.stack || [])], cmdStack: [...(context.cmdStack || [])] };\r\n            while(count--){\r\n                if (cmdInfo && cmdInfo.parentInfo) {\r\n                    context.cmdStack.splice(0, 1);\r\n                    cmdInfo = cmdInfo.parentInfo;\r\n                    cIndex = cmdInfo.parentCmdIndex;\r\n                    continue;\r\n                } else {\r\n                    cmdInfo = null;\r\n                }\r\n                if (context.stack.length) {\r\n                    const frame = context.stack.splice(0, 1)[0];\r\n                    if (frame && frame.type === 'insert') {\r\n                        context.cmdStack.splice(0, 1);\r\n                        cmdInfo = frame.cmdInfo;\r\n                        cIndex = frame.cmdIndex + 1;\r\n                    }\r\n                    pIndex = chapter.parent.pnPlot;\r\n                    chapter = chapter.parent.pChapter;\r\n                } else {\r\n                    break;\r\n                }\r\n            }\r\n            return {context, cmdInfo, cIndex, chapter, pIndex, preloadType:'' };\r\n        }\r\n\r\n        const compareMark = (m1, m2) => {\r\n            let { chapter, cmdInfo, preloadType, pIndex, cIndex, context } = m1;\r\n            if (cmdInfo && m2.cmdInfo && cmdInfo.commands === m2.cmdInfo.commands && preloadType === m2.preloadType) {\r\n                return cIndex - m2.cIndex;\r\n            }\r\n            if (chapter.plots === m2.chapter.plots && preloadType === m2.preloadType) {\r\n                return pIndex - m2.pIndex;\r\n            }\r\n\r\n            if (chapter.uuid === m2.chapter.uuid && preloadType === m2.preloadType) {\r\n                return pIndex - m2.pIndex;\r\n            }\r\n\r\n            if (m2.preloadType.startsWith(m1.preloadType)) {\r\n                let m1Types = m1.preloadType.split('$').slice(1);\r\n                let m2Types = m2.preloadType.split('$').slice(1);\r\n                const sameCount = m2Types.length - m1Types.length;\r\n                if (sameCount&&(m2.chapter.parent||m2.cmdInfo&&m2.cmdInfo.parentInfo)) {\r\n                    return -compareMark(revertMark(m2, sameCount), revertMark(m1, 0));\r\n                }\r\n            }\r\n            return NaN;\r\n        }\r\n        /* for (let i = 0; i < this.LoadedMark.length; i++) {\r\n            for (let j = 0; j < this.LoadedMark[i].length; j++) {\r\n                const result = compareMark(this.LoadedMark[i][j], marks[0]);\r\n                if (result === 0 || result > 0) {\r\n                   // return;\r\n                }\r\n            }\r\n        } */\r\n\r\n        this.LoadedMark.push(marks);\r\n        //console.log(marks)\r\n    }\r\n\r\n    static updateLoadMarkByPrefix(prefix, keep=true, needPop=true) {\r\n        for (let i = 0; i < this.LoadedMark.length; i++) {\r\n            for (let j = 0; j < this.LoadedMark[i].length; j++) {\r\n                const mark = this.LoadedMark[i][j];\r\n                let { preloadType, context } = mark;\r\n                if (preloadType.startsWith(prefix)) {\r\n                    preloadType = preloadType.substring(prefix.length);\r\n                    mark.preloadType = preloadType ? preloadType : 'play';\r\n                    if (needPop) {\r\n                        const frame = context.stack.pop();\r\n                        if (frame && frame.type === 'insert') {\r\n                            context.cmdStack.pop();\r\n                        }\r\n                    }\r\n                } else if(!keep){\r\n                    this.updateRefTypePrefix(preloadType, false);\r\n                    this.LoadedMark[i].splice(j--, 1);\r\n                }\r\n            }\r\n            if (!this.LoadedMark[i].length) {\r\n                this.LoadedMark.splice(i--, 1)\r\n            }\r\n        }\r\n    }\r\n\r\n    static clearLoadMarkByPrefix(prefix) {\r\n        for (let i = 0; i < this.LoadedMark.length; i++) {\r\n            for (let j = 0; j < this.LoadedMark[i].length; j++) {\r\n                const mark = this.LoadedMark[i][j];\r\n                let { preloadType } = mark;\r\n                if (preloadType.startsWith(prefix)) {\r\n                    this.LoadedMark[i].splice(j--, 1);\r\n                }\r\n            }\r\n            if (!this.LoadedMark[i].length) {\r\n                this.LoadedMark.splice(i--, 1)\r\n            }\r\n        }\r\n    }\r\n\r\n    static getWeatherResources(type){\r\n        const resources = [];\r\n        if (type === 'snowy') {\r\n            for (let i=0; i<120; i++) {\r\n                resources.push({url: `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('snow')}/xuehua_${Utils.formatNum(i)}.png`, type:'img'});\r\n            }\r\n        }\r\n        else if(type === 'windy'){\r\n            if(flashvars.vertical){\r\n                for(let i =0;i < 20;i++){\r\n                    resources.push({url: `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"wind\")}/feng_${Utils.formatNum(i)}.png`, type:'img'});\r\n                }\r\n            }\r\n        }\r\n        else if (type === 'rainy') {\r\n            for (let i=0; i<50; i++) {\r\n                resources.push({url: `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('rain')}/xiayu_${Utils.formatNum(i)}.png`, type:'img'});\r\n            }\r\n        }\r\n        else if (type === 'defoliation') {\r\n            for (let i=0; i<90; i++) {\r\n                resources.push({url: `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('mapleLeaves')}/fengye_${Utils.formatNum(i)}.png`, type:'img'});\r\n            }\r\n        }\r\n        else if (type === 'fallingPeach') {\r\n            for (let i=0; i<90; i++) {\r\n                resources.push({url: `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('beachBlossom')}/taohua_${Utils.formatNum(i)}.png`, type:'img'});\r\n            }\r\n        }\r\n        else if (type === 'fallingFlower') {\r\n            for (let i=0; i<90; i++) {\r\n                resources.push({url: `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('blossom')}/yinghua_${Utils.formatNum(i)}.png`, type:'img'});\r\n            }\r\n        }\r\n        else if (type === 'lightning') {\r\n            for (let i=0; i<50; i++) {\r\n                resources.push({url: `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('lightning')}/shandian_${Utils.formatNum(i)}.png`, type:'img'});\r\n            }\r\n        }\r\n        return resources;\r\n    }\r\n\r\n    static getCommandResources(command){\r\n        const resources = [];\r\n        switch (command.type) {\r\n            case 'addImage':\r\n                if(command.args[0].url && 'inherit' !== command.args[0].url){\r\n                    resources.push({type:'img', url:command.args[0].url, isBackground: command.args[0].index === 1});\r\n                }\r\n                break;\r\n            case 'showDialog':\r\n                resources.push({type:'img', url:command.args[0].avatar.url});\r\n                break;\r\n            case 'playMusic':\r\n                if(command.args[0].url && 'inherit'!== command.args[0].url){\r\n                    resources.push({type:'audio', url:command.args[0].url, isMusic:true });\r\n                }\r\n                break;\r\n            case 'playSound':\r\n                if(command.args[0].url && 'inherit'!== command.args[0].url){\r\n                    resources.push({type:'audio', url:command.args[0].url, isSound:true, index:command.args[0].index });\r\n                }\r\n                break;\r\n            case 'options':\r\n                for (let option of command.args) {\r\n                    const { background, sound } = option;\r\n                    if (background) {\r\n                        const { normal, active, disable } = background;\r\n                        normal && normal.url && resources.push({ type: 'img', url: normal.url });\r\n                        active && active.url && resources.push({ type: 'img', url: active.url });\r\n                        disable && disable.url && resources.push({ type: 'img', url: disable.url });\r\n                    }\r\n                    if (sound && sound.url) {\r\n                        resources.push({ type: 'audio', url: sound.url });\r\n                    }\r\n                }\r\n                break;\r\n            case 'weather':\r\n                if(flashvars.offline !== '1') resources.push(...this.getWeatherResources(command.args[0]));\r\n                break;\r\n            case 'showBubble':\r\n                if(command.args[0].url){\r\n                    resources.push({type:'img', url:command.args[0].url});\r\n                }\r\n                break;\r\n            case 'emitBubble':\r\n                const {avatar,content} = command.args[0];\r\n                if(avatar.url){\r\n                    resources.push({type:'img', url:avatar.url});\r\n                }\r\n                if(content.url){\r\n                    resources.push({type:'img', url:content.url});\r\n                }\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        return resources;\r\n    }\r\n\r\n    static getPlotResources(plot){\r\n        const resources = [];\r\n        // sound\r\n        if (Object.prototype.toString.call(plot.plot_sound) == '[object Array]') {\r\n            for (let i in plot.plot_sound) {\r\n                let item = plot.plot_sound[i];\r\n                if (item && 'inherit' !== item.url) {\r\n                    resources.push({ url: item.url, type: 'audio', isSound:true, index: i });\r\n                }\r\n            }\r\n        } else if (plot.plot_sound.url && 'inherit' !== plot.plot_sound.url) {\r\n            resources.push({ url: item.url, type: 'audio', isSound:true, index: 0 });\r\n        }\r\n        // background\r\n        if (plot.background.url && plot.background.url !== 'inherit') {\r\n            resources.push({ url: plot.background.url, type: 'img', isBackground:true });\r\n        }\r\n\r\n        // avatar\r\n        if (plot.avatar.url) {\r\n            resources.push({ url: plot.avatar.url, type: 'img'});\r\n        }\r\n        // music\r\n        if (plot.music.url && plot.music.url !== 'inherit') {\r\n            resources.push({ url: plot.music.url, type:'audio', isMusic:true });\r\n        } \r\n\r\n        // characters\r\n        for (let character of plot.characters) {\r\n            character.url && resources.push({ url: character.url, type: 'img' });\r\n        }\r\n\r\n        // props\r\n        for (let prop of plot.props) {\r\n            prop.url && resources.push({ url: prop.url, type: 'img' });\r\n        }\r\n        // options\r\n        for (let option of plot.options) {\r\n            const { background, sound } = option;\r\n            if (background) {\r\n                const { normal, active, disable } = background;\r\n                normal && normal.url && resources.push({ type: 'img', url: normal.url });\r\n                active && active.url && resources.push({ type: 'img', url: active.url });\r\n                disable && disable.url && resources.push({ type: 'img', url: disable.url });\r\n            }\r\n            if (sound && sound.url) {\r\n                resources.push({ type: 'audio', url: sound.url });\r\n            }\r\n        }\r\n        // weather\r\n        if (plot.weather.value) {\r\n            if(flashvars.offline !== '1') resources.push(...this.getWeatherResources(plot.weather.value));\r\n        }\r\n\r\n        return resources;\r\n    }\r\n\r\n    static checkCondOptionResources(option, type = 'general'){\r\n        let count = this.OptionResourcesCountMap.get(option) || 0;\r\n        if (count) {\r\n            return count;\r\n        }\r\n        const resourcesMap = {};\r\n\r\n        const addResource = r => {\r\n            if (!resourcesMap[r.url]) {\r\n                count++;\r\n                resourcesMap[r.url] = true;\r\n            }\r\n        };\r\n\r\n        const getCountInOption = (option) => {\r\n            for (let i = 0; i < option.plots.length && count <= 50; i++) {\r\n                const plot = option.plots[i];\r\n                let rs = [];\r\n                if (plot.commands) {\r\n                    rs = plot.commands.map(c => {\r\n                        if (c.type === 'options' || c.type === 'conditionOptions') {\r\n                            getCountInCmdOptions(c.args);\r\n                        }\r\n                        return this.getCommandResources(c);\r\n                    }).reduce((acc, cur) => [...cur, acc], [])\r\n                } else {\r\n                    if (plot.options.length) {\r\n                        getCountInOptions(plot.options);\r\n                    }\r\n                    if (plot.condition_options.length) {\r\n                        getCountInOptions(plot.condition_options);\r\n                    }\r\n                    rs = this.getPlotResources(plot);\r\n                }\r\n                rs.forEach(r => addResource(r));\r\n            }\r\n        };\r\n        const getCountInOptions = (options) => options.forEach(o => getCountInOption(o));\r\n\r\n        const getCountInCmdOption = (option) => {\r\n            for (let i = 0; i < option.commands.length && count <= 50; i++) {\r\n                const cmd = option.commands[i];\r\n                this.getCommandResources(cmd).forEach(r => addResource(r))\r\n                if (cmd.type === 'options' || cmd.type === 'conditionOptions') {\r\n                    getCountInCmdOptions(cmd.args);\r\n                }\r\n            }\r\n        };\r\n        const getCountInCmdOptions = (options) => options.forEach(o => getCountInCmdOption(o));\r\n\r\n        if (type === 'general') {\r\n            getCountInOption(option);\r\n        } else {\r\n            getCountInCmdOption(option);\r\n        }\r\n\r\n        return count;\r\n    }\r\n\r\n    static getResourcesByContext(context, chapter, pIndex = 0, cmdInfo, cIndex =0, canAddRefCount = true) {\r\n        const resources = { data: [], size: 0 };\r\n        context = { ...context };\r\n        context.stack = [...(context.stack || [])];\r\n        context.cmdStack = [...(context.cmdStack || [])];\r\n\r\n        if (!chapter || !chapter.plots || !chapter.plots[pIndex] || cmdInfo && !cmdInfo.commands[cIndex]) {\r\n            return Promise.resolve(resources);\r\n        }\r\n\r\n        const isMaxSize = () => resources.size > this.MaxSize/5 || resources.data.length > 30;\r\n\r\n        const addRefCount = (type, url, preloadType) => canAddRefCount && this.addRefCount(type, url, preloadType);\r\n\r\n        const addResource = (url, type, preloadType) => {\r\n            addRefCount(type, url, preloadType);\r\n            if (!resources.data.some(d => d.key === url)) {\r\n                return xhr.getResourceSize(url, type).then(size => {\r\n                    resources.data.push({ key: url, type, size });\r\n                    resources.size += size;\r\n                });\r\n            }\r\n            return Promise.resolve();\r\n        };\r\n\r\n        const createMark = ({context, chapter, pIndex, cmdInfo, cIndex, preloadType}) => {\r\n            const c = { ...context, stack:[], cmdStack: [] };\r\n            const plots = chapter.plots || [];\r\n            if (!cmdInfo && plots.length > pIndex && plots[pIndex] && plots[pIndex].commands) {\r\n                cmdInfo = { commands: plots[pIndex].commands };\r\n                cIndex = -1;\r\n            } \r\n            return { context: c, chapter, pIndex, cmdInfo, cIndex, preloadType  };\r\n        }\r\n\r\n        const createJumpMark = (content, chapterUuid) => {\r\n            let { context, preloadType } = content;\r\n            const newChapter = Utils.searchChapterByUUID(this.gameData, chapterUuid);\r\n            if(!newChapter){\r\n                return;\r\n            }\r\n            preloadType = `${preloadType==='play'?'':preloadType}$${newChapter.uuid}j`;\r\n            content = { context, cmdInfo:null, chapter: newChapter, pIndex: -1 , preloadType};\r\n            return createMark(content);\r\n        }\r\n\r\n        const createInsertMark = (content, chapterUuid) => {\r\n            let { context, preloadType } = content;\r\n            const newChapter = Utils.searchChapterByUUID(this.gameData, chapterUuid);\r\n            if(!newChapter){\r\n                return;\r\n            }\r\n            preloadType = `${preloadType==='play'?'':preloadType}$${newChapter.uuid}i`;\r\n            content = { context, cmdInfo:null, chapter:newChapter, pIndex: -1 , preloadType };\r\n            return createMark(content);\r\n        }\r\n\r\n        const getInCommand = (command, preloadType) => {\r\n            const resources = this.getCommandResources(command);\r\n            resources.forEach(r => {\r\n                const {type, url, isMusic, isSound, index} = r;\r\n                if (isMusic && this.forceDecode.musics.length < this.MaxForceDecodeMusic) {\r\n                    this.forceDecode.musics.push(url);\r\n                }\r\n                if (isSound && !this.forceDecode.sounds[index]) {\r\n                    this.forceDecode.sounds[index] = url;\r\n                }\r\n            });\r\n\r\n            return Promise.all(resources.map(r => addResource(r.url, r.type, preloadType)));\r\n        };\r\n\r\n        const preloadCmdOptions = (content) => {\r\n            const { context, preloadType, chapter, pIndex, cmdInfo, cIndex } = content;\r\n            const cmd = cmdInfo.commands[cIndex];\r\n            const options = cmd.args;\r\n            const optionPromises = [];\r\n            const marks = [];\r\n            for (let opIndex = 0; options && opIndex < options.length; opIndex++) {\r\n                const option = options[opIndex];\r\n                let optionType = cmd.type === 'options' ? 'o' : (option.type !== 'branch' && this.checkCondOptionResources(option, 'command') <= 50 ? 'l' : 'c');\r\n                const newCmdInfo = { commands: option.commands };\r\n                const newpreloadType = `${preloadType==='play'?'':preloadType}$${cmd.uuid}${optionType}${opIndex}-`;\r\n                const pushMark = (cIndex) => {\r\n                    const mark = createMark({...content, cmdInfo:newCmdInfo, cIndex, preloadType:newpreloadType});\r\n                    marks.push(mark);\r\n                };\r\n                const temp = { ...content, cmdInfo:newCmdInfo, cIndex:0, preloadType:newpreloadType }\r\n                let promise = Promise.resolve();\r\n                for (let opPlotIndex = 0; opPlotIndex < option.commands.length && opPlotIndex < 10; opPlotIndex++) {\r\n                    const cmd = option.commands[opPlotIndex];\r\n                    const {type, args} = cmd;\r\n                    promise = promise.then(() => {\r\n                        return getInCommand(cmd, newpreloadType).then(() => {\r\n                            if (isMaxSize(true)) {\r\n                                return Promise.reject(opPlotIndex);\r\n                            } else if (type === 'options' || type === 'conditionOptions') {\r\n                                const content = { ...temp, cIndex:opPlotIndex };\r\n                                content.context = { ...context, cmdStack:[] };\r\n                                return preloadCmdOptions(content);\r\n                            }else if(type === 'jump'){\r\n                                this.pushLoadMarks([createJumpMark({ ...temp, cIndex:opPlotIndex }, args[0])]);\r\n                                return Promise.reject(-1);\r\n                            } else if(type === 'insert'){\r\n                                this.pushLoadMarks([createInsertMark({ ...temp, cIndex:opPlotIndex }, args[0])]);\r\n                                return Promise.reject(-1);\r\n                            } else if (type === 'back') {\r\n                                return Promise.reject(-1);\r\n                            } \r\n                            return Promise.resolve();\r\n                        });\r\n                    });\r\n                    if (type === 'options' || type === 'conditionOptions') {\r\n                        if(opPlotIndex + 1 < option.commands.length){\r\n                            promise = promise.then(() => Promise.reject(opPlotIndex));\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n                promise = promise.then(() => {\r\n                    if (option.commands.length > 10) {\r\n                        pushMark(9);\r\n                    }\r\n                }, index => {\r\n                    if (index >= 0 && option.commands.length > index) {\r\n                        pushMark(index);\r\n                    }\r\n                });\r\n                optionPromises.push(promise);\r\n            }\r\n            return Promise.all(optionPromises).then(() => {\r\n                marks.length && this.pushLoadMarks(marks);\r\n                return Promise.resolve();\r\n            });\r\n        };\r\n\r\n        const getInNextCommand = (content, nextPlot = true) => {\r\n            let { context, chapter, pIndex, cmdInfo, cIndex, preloadType } = content;\r\n            if (isMaxSize(true)) {\r\n                this.pushLoadMarks([createMark(content)]);\r\n                return Promise.resolve();\r\n            }\r\n            const { type, args }= cmdInfo.commands[cIndex] || {};\r\n            if(type === 'jump'){\r\n                this.pushLoadMarks([createJumpMark(content, args[0])]);\r\n                return Promise.resolve();\r\n            } else if(type === 'insert'){\r\n                this.pushLoadMarks([createInsertMark(content, args[0])]);\r\n                return getInCmdInfo({...content, cIndex: cIndex+1 });\r\n            } else if (type === 'back') {\r\n                return Promise.resolve();\r\n            } else if (type === 'options' || type === 'conditionOptions') {\r\n                return preloadCmdOptions(content, nextPlot).then(() => getInCmdInfo({...content, cIndex: cIndex+1 }, nextPlot));\r\n            } else if (cmdInfo.commands.length > cIndex + 1) {\r\n                return getInCmdInfo({...content, cIndex: cIndex+1 }, nextPlot);\r\n            } else if (nextPlot && context.cmdStack.length) {\r\n                context.cmdStack = context.cmdStack.splice(1);\r\n                cIndex = cmdInfo.parentCmdIndex + 1;\r\n                cmdInfo = cmdInfo.parentInfo;\r\n                if (cmdInfo && Number.isInteger(cIndex)) {\r\n                    return getInCmdInfo({ ...content, cmdInfo, cIndex }, nextPlot);\r\n                }\r\n            } else if (nextPlot && context.stack.length) {\r\n                //context.stack = context.stack.splice(1);\r\n                context.stack = context.stack.slice(1);\r\n                if(chapter.parent){\r\n                    pIndex = chapter.parent.pnPlot + 1;\r\n                    chapter = chapter.parent.pChapter;\r\n                }\r\n                if (chapter && Number.isInteger(pIndex)) {\r\n                    return getInChapter({ ...content, chapter, pIndex});\r\n                }\r\n            }\r\n            return nextPlot ? getInChapter({...content, pIndex: pIndex + 1}) : Promise.resolve() ;\r\n        };\r\n\r\n        const getInCmdInfo = (content, nextPlot=true) => {\r\n            const {chapter, pIndex, cmdInfo, cIndex, preloadType } = content;\r\n            if (cIndex >= cmdInfo.commands.length) {\r\n                return getInNextCommand(content, nextPlot);\r\n            }\r\n\r\n            return getInCommand(cmdInfo.commands[cIndex], preloadType).then(() => getInNextCommand(content, nextPlot));\r\n        };\r\n\r\n        const getPlotOptionCount = plot => {\r\n            let count = 0;\r\n            for (let opIndex = 0; plot.options && opIndex < plot.options.length; opIndex++) {\r\n                count += plot.options[opIndex].plots.length;\r\n            }\r\n\r\n            for (let opIndex = 0; plot.condition_options && opIndex < plot.condition_options.length; opIndex++) {\r\n                count += plot.condition_options[opIndex].plots.length;\r\n            }\r\n            return count;\r\n        };\r\n\r\n        const getInChapter = (content) => {\r\n            const { chapter, pIndex, preloadType } = content;\r\n            const plot = chapter.plots[pIndex];\r\n\r\n            if (!plot || plot.commands && !plot.commands.length) {\r\n                return Promise.resolve();\r\n            }\r\n\r\n            if(plot.commands){\r\n                return getInCmdInfo({...content, cmdInfo:plot, cIndex:0});\r\n            }\r\n\r\n            const getInPlot = (plot, preloadType) => {\r\n                const resources = this.getPlotResources(plot);\r\n                resources.forEach(r => {\r\n                    const {type, url, isMusic, isSound, index} = r;\r\n                    if (isMusic && this.forceDecode.musics.length < this.MaxForceDecodeMusic) {\r\n                        this.forceDecode.musics.push(url);\r\n                    }\r\n                    if (isSound && !this.forceDecode.sounds[index]) {\r\n                        this.forceDecode.sounds[index] = url;\r\n                    }\r\n                });\r\n                return Promise.all(resources.map(r => addResource(r.url, r.type, preloadType)));\r\n            };\r\n\r\n            const preloadPlotOptions = (content) => {\r\n                const { chapter, pIndex, preloadType, context } = content;\r\n                const plot = chapter.plots[pIndex];\r\n                const opMarks = [];\r\n                const copMarks = [];\r\n                const optionPromises = [];\r\n                const condOptionPromises = [];\r\n\r\n                const pushMark = (content, marks) => marks.push(createMark(content));\r\n                const loadPlotIntoPromise = (promise, plot, content) => {\r\n                    promise = promise.then(() => {\r\n                        if (plot.commands) {\r\n                            content.cmdInfo = { commands: plot.commands };\r\n                            content.cIndex = 0;\r\n                            return getInCmdInfo(content, false);\r\n                        } else {\r\n                            return getInPlot(plot, content.preloadType);\r\n                        }\r\n                    }).then(() => {\r\n                        if (isMaxSize(true)) {\r\n                            return Promise.reject(content.pIndex);\r\n                        } else if (getPlotOptionCount(plot)) {\r\n                            return preloadPlotOptions(content);\r\n                        }else if(plot.jump){\r\n                            this.pushLoadMarks([createJumpMark(content, plot.jump)]);\r\n                            return Promise.reject(-1);\r\n                        } else if(plot.insert){\r\n                            this.pushLoadMarks([createInsertMark(content, plot.insert)]);\r\n                            return Promise.reject(-1);\r\n                        } else if (plot.back) {\r\n                            return Promise.reject(-1);\r\n                        } \r\n                        return Promise.resolve();\r\n                    });\r\n                    return promise;\r\n                };\r\n\r\n                for (let opIndex = 0; plot.options && opIndex < plot.options.length; opIndex++) {\r\n                    const option = plot.options[opIndex];\r\n                    const newPreloadType = `${preloadType==='play'?'':preloadType}$${plot.uuid}o${opIndex}-`;\r\n                    const optChapter = {plots: option.plots, uuid: chapter.uuid};\r\n                    const temp = { ...content, chapter:optChapter, pIndex: 0, preloadType:newPreloadType };\r\n                    let promise = Promise.resolve();\r\n                    for (let opPlotIndex = 0; opPlotIndex < option.plots.length && opPlotIndex < 5; opPlotIndex++) {\r\n                        const content = { ...temp, pIndex:opPlotIndex };\r\n                        content.context = { ...context };\r\n                        promise = loadPlotIntoPromise(promise, option.plots[opPlotIndex], content);\r\n                    }\r\n                    promise = promise.then(() => {\r\n                        if (option.plots.length > 5) {\r\n                            pushMark({ ...temp, pIndex:4 }, opMarks);\r\n                        }\r\n                    }, index => {\r\n                        if (index >= 0 && option.plots.length > index && !option.plots[index].commands) {\r\n                            pushMark({ ...temp, pIndex: index }, opMarks);\r\n                        }\r\n                        return Promise.resolve();\r\n                    });\r\n                    optionPromises.push(promise);\r\n                }\r\n\r\n                for (let opIndex = 0; plot.condition_options && opIndex < plot.condition_options.length; opIndex++) {\r\n                    let option = plot.condition_options[opIndex];\r\n                    const optChapter = {plots: option.plots, parent: {pChapter: chapter, pnPlot: pIndex}, uuid: chapter.uuid};\r\n                    const type = option.type !== 'branch' && this.checkCondOptionResources(option) <= 50 ? 'l' : 'c';\r\n                    const newPreloadType = `${preloadType==='play'?'':preloadType}$${plot.uuid}${type}${opIndex}-`;\r\n                    const temp = { ...content, chapter:optChapter, pIndex: 0, preloadType:newPreloadType };\r\n                    let promise = Promise.resolve();\r\n                    for (let opPlotIndex = 0; opPlotIndex < option.plots.length && opPlotIndex < 5; opPlotIndex++) {\r\n                        const content = { ...temp, pIndex:opPlotIndex };\r\n                        content.context = { ...context };\r\n                        promise = loadPlotIntoPromise(promise, option.plots[opPlotIndex], content);\r\n                    }\r\n                    promise = promise.then(() => {\r\n                        if (option.plots.length > 5) {\r\n                            pushMark({ ...temp, pIndex:4 }, copMarks);\r\n                        }\r\n                    }, index => {\r\n                        if (index >= 0 && option.plots.length > index && !option.plots[index].commands) {\r\n                            pushMark({ ...temp, pIndex: index }, copMarks);\r\n                        }\r\n                        return Promise.resolve();\r\n                    });\r\n                    condOptionPromises.push(promise);\r\n                }\r\n\r\n                const optionPromise = Promise.all(optionPromises).then(() => opMarks.length && this.pushLoadMarks(opMarks));\r\n                const condoptionPromise = Promise.all(condOptionPromises).then(() => copMarks.length && this.pushLoadMarks(copMarks));\r\n                return Promise.all([optionPromise, condoptionPromise]);\r\n            };\r\n\r\n            const getInNextPlot = (content) => {\r\n                let { context, chapter, pIndex } = content;\r\n                const plot = chapter.plots[pIndex];\r\n                if(isMaxSize()){\r\n                    const mark = createMark(content);\r\n                    this.pushLoadMarks([mark]);\r\n                    return Promise.resolve();\r\n                }else if(plot.back){\r\n                    return Promise.resolve();\r\n                }else if(plot.jump){\r\n                    this.pushLoadMarks([createJumpMark(content, plot.jump)]);\r\n                    return Promise.resolve();\r\n                } else if(plot.insert){\r\n                    this.pushLoadMarks([createInsertMark(content, plot.insert)]);\r\n                    return getInChapter({ ...content, pIndex: pIndex + 1 });\r\n                } else if (getPlotOptionCount(plot)) {\r\n                    return preloadPlotOptions(content).then(() => getInChapter({ ...content, pIndex: pIndex + 1 }));\r\n                } else if (chapter.plots.length > pIndex + 1 ) {\r\n                    return getInChapter({ ...content, pIndex: pIndex + 1 });\r\n                } else if (context.stack.length) {\r\n                    context.stack = context.stack.slice(1);\r\n                    if(chapter.parent){\r\n                        pIndex = chapter.parent.pnPlot + 1;\r\n                        chapter = chapter.parent.pChapter;\r\n                    }\r\n                    if (chapter && Number.isInteger(pIndex)) {\r\n                        return getInChapter({ ...content, chapter, pIndex});\r\n                    }\r\n                }\r\n                return Promise.resolve();\r\n            };\r\n\r\n            return getInPlot(plot, preloadType).then(() => getInNextPlot(content));\r\n        };\r\n\r\n        const checkResources = (resources) => {\r\n            if(resources.size < this.MaxSize){\r\n                this.PreloadState.size = this.MaxSize - resources.size;\r\n            }\r\n\r\n            if(this.PreloadState.size > 0){\r\n                this.startPreloadResources();\r\n            }\r\n            return resources;\r\n        }\r\n\r\n        const content = { context, chapter, pIndex, cmdInfo, cIndex, preloadType:'play' };\r\n        return cmdInfo\r\n            ? getInCmdInfo(content).then(() => checkResources(resources))\r\n            : getInChapter(content).then(() => checkResources(resources));\r\n    }\r\n\r\n    static getResourcesSize(resources) {\r\n        const promises = [];\r\n        resources.forEach(r => {\r\n            promises.push(xhr.getResourceSize(r.key, r.type))\r\n        });\r\n        return Promise.all(promises).then(sizes => sizes.reduce((a,b) => a + b, 0));\r\n    }\r\n\r\n    static updateUsingKey({type, key, index}){\r\n        let oldKey = '';\r\n        switch(type){\r\n            case 'background':\r\n                this.usingKeyMap.background = key;\r\n                break;\r\n            case 'preBackground':\r\n                this.usingKeyMap.preBackground = key;\r\n                break;\r\n            case 'music':\r\n                oldKey = this.usingKeyMap.music;\r\n                this.usingKeyMap.music = key;\r\n                oldKey && this.subRefCount('audio', oldKey);\r\n                break;\r\n            case 'sound':\r\n                oldKey = this.usingKeyMap.sounds[index];\r\n                this.usingKeyMap.sounds[index] = key;\r\n                oldKey && this.subRefCount('audio', oldKey);\r\n                break;\r\n        }\r\n    }\r\n\r\n    static isUsingKey(key){\r\n        const { background, music, sounds, preBackground } = this.usingKeyMap;\r\n        return background === key || preBackground === key || music === key || sounds.some(s => s === key);\r\n    }\r\n}\r\n\r\nResourcesManager.delayRemoveManager = new DelayRemoveManager();\r\nResourcesManager.OptionResourcesCountMap = new Map();\r\nResourcesManager.PreloadState = { size:0, loading: false, preloaded:0, loadingChapterMap:{} };\r\nResourcesManager.LoadedMark = [];\r\nResourcesManager.MaxSize = 100000000;\r\nResourcesManager.MaxForceDecodeMusic = 3;\r\nResourcesManager.refCount = { audio: {}, img: {} };\r\nResourcesManager.usingKeyMap = { background: '', sounds: new Array(10).fill(''), music: '', preBackground: '' };\r\nResourcesManager.forceDecode = { musics: [], sounds: new Array(10).fill('') };\r\n\r\nexport class AudioTagPool {\r\n    static get() {\r\n        let freeAudio = AudioTagPool.pool.find(a => a.free);\r\n        if (freeAudio) {\r\n            freeAudio.pause();\r\n            freeAudio.free = false;\r\n        } else {\r\n            freeAudio = document.createElement('audio');\r\n        }\r\n        return freeAudio;\r\n    }\r\n\r\n    static exist(audio){\r\n        return AudioTagPool.pool.some(a => a === audio);\r\n    }\r\n\r\n    static fill() {\r\n        const addAudio = len => {\r\n            for (let i = 0; i < len; i++) {\r\n                let audio = document.createElement('audio');\r\n                audio.free = true;\r\n                audio.loop = false;\r\n                audio.play();\r\n                AudioTagPool.pool.push(audio);\r\n            }\r\n        };\r\n        if (AudioTagPool.pool.length) {\r\n            const freeCount = AudioTagPool.pool.reduce((acc, cur) => acc + (cur && cur.free ? 1 : 0), 0);\r\n            if (freeCount < 10) {\r\n                addAudio(50);\r\n            }\r\n        } else {\r\n            addAudio(100);\r\n        }\r\n    }\r\n}\r\nAudioTagPool.pool = [];","/**\r\n * Created by chenwl on 3/25/16.\r\n */\r\nconst commit = \"6d38f5ab758781944daa607d7f5e0b4062f7b529\";\r\nexport default commit;\r\n\r\nconst version = \"1.0.0\";\r\nexport {version};\r\n","const urls = {\r\n    getGame : \"https://mapi.3000api.com/apis/soft/v1.0/game-info.html\",\r\n    getTestGame: \"https://mapi.3000api.com/apis/soft/v1.0/game-test.html\",\r\n    getOtherGame: \"https://mapi.3000api.com/apis/soft/v1.0/game-external.html\",\r\n    materialRedirect:\"https://mapi.3000api.com/client/material-redirect.html\"\r\n};\r\n\r\nfunction serializeQuery(params) {\r\n    params['_'] = Date.now();\r\n    return '?' + Object.keys(params).map(key => {\r\n            const val = params[key];\r\n            if (val) {\r\n                return encodeURIComponent(key) + '=' + encodeURIComponent(val)\r\n            }\r\n            else {\r\n                return '';\r\n            }\r\n        }).join('&');\r\n}\r\n\r\nexport function xhrGetServerTime(url) {\r\n    return new Promise((resolve, reject) => {\r\n        const xhr = new XMLHttpRequest();\r\n        xhr.open(\"GET\", url, true);\r\n\r\n        xhr.onload = function () {\r\n            try {\r\n                if (xhr.readyState === 4 && xhr.status >= 400 && xhr.status <= 599) { // Handle HTTP status codes of 4xx and 5xx as errors, even if xhr.onerror was not called.\r\n                    return reject(`error readyState: ${xhr.readyState}, status: ${xhr.status}`);\r\n                }\r\n                else {\r\n                    return resolve(xhr);\r\n                }\r\n            } catch (e) {\r\n                reject(e)\r\n            }\r\n        };\r\n\r\n        xhr.onerror = reject;\r\n        xhr.send();\r\n    })\r\n}\r\n\r\nexport function xhrSend(url, data, onProgress, timeout) {\r\n    return new Promise((resolve, reject) => {\r\n        const xhr = new XMLHttpRequest();\r\n        xhr.ontimeout = function () {\r\n            console.log(url + ' time out');\r\n        };\r\n        xhr.onreadystatechange = function() {\r\n            switch(xhr.readyState) {\r\n                case 4 :\r\n                    if((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {\r\n                        return resolve(xhr);\r\n                    }\r\n                    else {\r\n                        return reject(`error readyState: ${xhr.readyState}, status: ${xhr.status}`);\r\n                    }\r\n                    break;\r\n            }\r\n        };\r\n        xhr.open(\"post\", url, true);\r\n        xhr.withCredentials = true;\r\n        timeout && (xhr.timeout = timeout);\r\n        onProgress && xhr.addEventListener(\"progress\", onProgress, false);\r\n        xhr.setRequestHeader(\"CONTENT-TYPE\", \"application/x-www-form-urlencoded\");\r\n        xhr.send(data);\r\n        xhr.onerror = reject;\r\n    });\r\n}\r\n\r\nexport function xhrLoad(url, type, onProgress,istimeout = true) {\r\n    return new Promise((resolve, reject) => {\r\n\r\n        const xhr = new XMLHttpRequest();\r\n        xhr.ontimeout = function () {\r\n            console.log(url + ' time out');\r\n            if(istimeout) return reject(\"get time out\")\r\n        };\r\n        xhr.onload = function () {\r\n            try {\r\n                if (xhr.readyState === 4 && xhr.status >= 400 && xhr.status <= 599) { // Handle HTTP status codes of 4xx and 5xx as errors, even if xhr.onerror was not called.\r\n                    return reject(`error readyState: ${xhr.readyState}, status: ${xhr.status}`);\r\n                }\r\n                else {\r\n                    return resolve(xhr);\r\n                }\r\n            } catch (e) {\r\n                return reject(e)\r\n            }\r\n        };\r\n        xhr.open(\"GET\", url, true);\r\n        xhr.responseType = type;\r\n        onProgress && xhr.addEventListener(\"progress\", onProgress, false);\r\n        istimeout && (xhr.timeout = 5000);//get增加5秒的请求超时\r\n        xhr.onerror = reject;\r\n        xhr.send();\r\n    });\r\n}\r\n\r\nexport function getJson(url, onProgress) {\r\n    return xhrLoad(url, '', onProgress,false).then(xhr => {\r\n        return JSON.parse(xhr.response);\r\n    });\r\n}\r\n\r\nexport function getMaterialRedirect(url) {\r\n    return getJson(urls.materialRedirect + serializeQuery({url}))\r\n        .then(json => {\r\n            if (json.code == '100') {\r\n                return json.result;\r\n            }\r\n            else {\r\n                return Promise.reject(json.message);\r\n            }\r\n        });\r\n}\r\n\r\nexport function getGame(uuid, onProgress) {\r\n    const url = urls.getGame + '?uuid=' + uuid;\r\n    return getJson(url, onProgress)\r\n        .then(json => {\r\n            if (json.code == '100') {\r\n                return json.result;\r\n            }\r\n            else if (flashvars.offline === '1') {\r\n                return json;\r\n            }\r\n            else {\r\n                return Promise.reject(json.message);\r\n            }\r\n        });\r\n}\r\n\r\nexport function getTestGame(uuid, onProgress) {\r\n    const url = /*'https://www.3000.com/proxy/liuhualin/json.txt';/**/urls.getTestGame + '?uuid=' + uuid;\r\n    return getJson(url, onProgress)\r\n        .then(json => {\r\n            if (json.code == '100') {\r\n                return json.result;\r\n            }\r\n            else if (flashvars.offline === '1') {\r\n                return json;\r\n            }\r\n            else {\r\n                return Promise.reject(json.message);\r\n            }\r\n        });\r\n}\r\n\r\nexport function getOtherGame(uuid, onProgress) {\r\n    const url = /*'https://www.3000.com/proxy/liuhualin/json.txt';/**/urls.getOtherGame + '?uuid=' + uuid;\r\n    return getJson(url, onProgress)\r\n        .then(json => {\r\n            if (json.code == '100') {\r\n                return json.result;\r\n            }\r\n            else if (flashvars.offline === '1') {\r\n                return json;\r\n            }\r\n            else {\r\n                return Promise.reject(json.message);\r\n            }\r\n        });\r\n}\r\n\r\nexport function getResourceSize(url, type) {\r\n    if (type === 'img') {\r\n        return Promise.resolve(200000)\r\n    } else if (type === 'audio') {\r\n        return Promise.resolve(2000000)\r\n    }\r\n}","/**\r\n * @class demo.controller.PrepareControllerCommand.js\r\n */\r\nimport puremvc from 'puremvc';\r\npuremvc.define\r\n(\r\n\t// CLASS INFO\r\n\t{\r\n\t\tname: 'diygamePlayer.controller.command.PrepareControllerCommand',\r\n\t\tparent: puremvc.SimpleCommand\r\n\t},\r\n\t\r\n\t// INSTANCE MEMBERS\t\r\n\t{\r\n\t\t/** @override */\r\n\t\texecute: function (note)\r\n\t\t{\r\n\t\t\t// register teh ProcessTextCommand to handle the PROCESS_TEXT notification \r\n\t\t\t//this.facade.registerCommand( demo.AppConstants.PROCESS_TEXT, diygamePlayer.controller.command.ProcessTextCommand );\r\n\t\t}\r\n\t}\t\r\n);\r\n","/**\r\n * @class demo.controller.PrepareModelCommand.js\r\n */\r\nimport puremvc from 'puremvc';\r\npuremvc.define\r\n(\r\n\t// CLASS INFO\r\n\t{\r\n\t\tname: 'diygamePlayer.controller.command.PrepareModelCommand',\r\n\t\tparent: puremvc.SimpleCommand\r\n\t},\r\n\t\r\n\t// INSTANCE MEMBERS\r\n\t{\r\n\t\t/** @override */\r\n\t\texecute: function (note)\r\n\t\t{\r\n\t\t\t// register the TextProxy \r\n\t\t\tthis.facade.registerProxy( new diygamePlayer.model.proxy.SceneProxy );\r\n\t\t}\r\n\t}\r\n)","/**\r\n * @class demo.controller.PrepareW3CViewCommand\r\n * @extends puremvc.SimpleCommand\r\n */\r\nimport puremvc from 'puremvc';\r\npuremvc.define\r\n(\r\n\t// CLASS INFO\r\n\t{\r\n\t\tname: 'diygamePlayer.controller.command.PrepareViewCommand',\r\n\t\tparent: puremvc.SimpleCommand\r\n\t},\r\n\t\r\n\t// INSTANCE TRAITS\r\n\t{\r\n\t\t/** @override */\r\n\t\texecute: function (note)\r\n\t\t{\r\n\t\t\t// register the TextComponentMediator\r\n\t\t\tthis.facade.registerMediator( new diygamePlayer.view.mediator.SceneMediator );\r\n\t\t}\r\n\t}\r\n);\t\t\t\t","/**\r\n * @class demo.controller.StartupCommand\r\n * @extends puremvc.MacroCommand\r\n */\r\nimport puremvc from 'puremvc';\r\npuremvc.define\r\n(\r\n\t// CLASS INFO\r\n\t{\r\n\t\tname: 'diygamePlayer.controller.command.StartupCommand',\r\n\t\tparent: puremvc.MacroCommand\r\n\t},\r\n\r\n\t// INSTANCE MEMBERS\t\r\n\t{\r\n\t\t/** @override */\r\n\t\tinitializeMacroCommand: function ()\r\n\t\t{\r\n\t\t\t// add the PrepareControllerCommand- it will register Commands with the Facade\r\n\t\t\tthis.addSubCommand( diygamePlayer.controller.command.PrepareControllerCommand );\r\n\r\n\t\t\t// add the PrepareModelCommand- it will register Proxys with the Facade\r\n\t\t\tthis.addSubCommand( diygamePlayer.controller.command.PrepareModelCommand );\r\n\r\n\t\t\t// add the SetupViewsCommand- it will register Mediators with the Facade\r\n\t\t\tthis.addSubCommand( diygamePlayer.controller.command.PrepareViewCommand );\r\n\t\t}\r\n\t}\r\n)","/**\r\n *\r\n * This is a simple state template to use for getting a Phaser game up\r\n * and running quickly. Simply add your own game logic to the default\r\n * state object or delete it and make your own.\r\n *\r\n */\r\n\r\n// initialize the app when all DOM content has loaded.\r\nimport 'babel-polyfill';\r\nimport './AppConstants.js';\r\nimport './ApplicationFacade.js';\r\nimport './controller/command/PrepareControllerCommand.js';\r\nimport './controller/command/PrepareModelCommand.js';\r\nimport './controller/command/PrepareViewCommand.js';\r\nimport './controller/command/StartupCommand.js';\r\nimport './model/proxy/SceneProxy.js';\r\nimport './view/component/Scene.js';\r\nimport './view/mediator/SceneMediator.js';\r\ndocument.addEventListener('DOMContentLoaded', function () {\r\n    //先获取浏览器显示宽高\r\n    global.width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\r\n    global.height = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\r\n    // initialize the facade by retrieving an instance and calling startup\r\n    diygamePlayer.ApplicationFacade.getInstance(diygamePlayer.ApplicationFacade.NAME).startup();\r\n    console.log(\"Initialized\");\r\n});","/**\r\n * @class demo.model.TextProxy\r\n * @extends puremvc.Proxy\r\n */\r\nimport puremvc from 'puremvc';\r\nimport Utils, {ResourcesManager} from '../../common/Utils.js';\r\nimport MD5 from 'spark-md5';\r\nimport Dialog from './../../common/Dialog.js';\r\nimport ShanyiMenu from './../../common/ShanyiMenu.js'\r\nimport * as Xhr from './../../common/XmlHttpRequest.js';\r\nimport PhoneUtils from '../../common/PhoneUtils.js';\r\nimport FontUtils from '../../common/FontUtils.js';\r\nimport OtherWap from \"../../common/OtherWap\";\r\nimport Copy from 'copy-to-clipboard';\r\nimport jsonp from 'jsonp';\r\n\r\npuremvc.define\r\n(\r\n\t// CLASS INFO\r\n\t{\r\n\t\tname: 'diygamePlayer.model.proxy.SceneProxy',\r\n\t\tparent: puremvc.Proxy\r\n\t},\r\n\r\n\t// INSTANCE MEMBERS\r\n\t{\r\n        chargeMsgReceive: function(ev) {\r\n        \tif (ev.originalEvent.key !== 'msgCharged') return; // ignore other keys\r\n            let message = JSON.parse(ev.originalEvent.newValue);\r\n            if (!message) return; // ignore empty msg or msg reset\r\n\r\n            // here you act on messages.\r\n            // you can send objects like { 'command': 'doit', 'data': 'abcd' }\r\n            if (message.command == 'doit') alert(message.data);\r\n        },\r\n        resumeAudio: function () {\r\n\t\t\tthis.bk_music && this.bk_music.play();\r\n            this.plotSounds && this.plotSounds.forEach(s => s && s.resume());\r\n        },\r\n\t\tpauseAudio: function () {\r\n            this.bk_music && this.bk_music.pause();\r\n            this.plotSounds && this.plotSounds.forEach(s => s && s.pause());\r\n        },\r\n\r\n        /**\r\n\t\t * Set the TextProxy's text.\r\n\t\t *\r\n\t\t * Sends a TextProxy.TEXT_CHANGED notification.\r\n\t\t *\r\n\t\t * @param {string} text\r\n\t\t * @return {void}\r\n\t\t */\r\n\t\tpreloadingBegin: function () {\r\n\t\t\tthis.stringMap = {};\r\n\t\t\tthis.stringMap.loadMenu = \"读档\";\r\n\t\t\tthis.stringMap.overMenu = \"结束\";\r\n\t\t\tthis.stringMap.settingsMenu = \"设置\";\r\n\t\t\tthis.stringMap.startMenu = \"开始\";\r\n\t\t\tthis.stringMap.menu = \"菜单\";\r\n\t\t\tthis.stringMap.mainMenu = \"菜单\";\r\n\t\t\tthis.stringMap.save = \"保存进度\";\r\n\t\t\tthis.stringMap.load = \"读取进度\";\r\n\t\t\tthis.stringMap.playback = \"剧情回放\";\r\n\t\t\tthis.stringMap.autoplay = \"自动播放\";\r\n\t\t\tthis.stringMap.manualPlay = \"手动播放\";\r\n\t\t\tthis.stringMap.settings = \"设置\";\r\n\t\t\tthis.stringMap.displayHeader = \"显示设定\";\r\n\t\t\tthis.stringMap.displayCaption = \"画面模式\";\r\n\t\t\tthis.stringMap.volumeHeader = \"音量\";\r\n\t\t\tthis.stringMap.musicCaption = \"音乐音量\";\r\n\t\t\tthis.stringMap.soundCaption = \"音效音量\";\r\n\t\t\tthis.stringMap.textHeader = \"文字设定\";\r\n\t\t\tthis.stringMap.textCaption = \"自动进行\";\r\n\t\t\tthis.stringMap.autoOn = \"开\";\r\n\t\t\tthis.stringMap.autoOff = \"关\";\r\n\t\t\tthis.stringMap.windowMode = \"窗口模式\";\r\n\t\t\tthis.stringMap.fullMode = \"全屏模式\";\r\n\t\t\tthis.stringMap.back = \"返回\";\r\n\t\t\tthis.progressTips = ['手指右滑就可召唤退出按钮，退出作品时，记得存档哦'\r\n\t\t\t\t, '收藏作品，更新会第一时间通知你'\r\n            \t, '把作品下载到本地，随时随地任性玩'\r\n            \t, '感觉作品很棒，和你的好友分享吧~'\r\n                , '引战、刷屏、作品无关的评论会被删除哦'\r\n\t\t\t\t, '素材库为全站通用，可能发生人物走错片场的情况，请不要慌张'\r\n            \t, '在当前作品的评论中对比其他作品容易给作者大大招黑哦~'\r\n                , '制作辛苦，写下精彩长评支持喜欢的作者吧'\r\n\t\t\t\t, '长按屏幕可以快进剧情'];\r\n\t\t\tthis.recordTipCount = 0;\r\n\t\t\tthis.isShowGuide = false;\r\n\t\t\tthis.plotSounds = [];\r\n\t\t\tthis.playbackData = [];\r\n\t\t\tthis.plotViews = [];\r\n\t\t\tthis.prgsViews = [];\r\n            this.plotViewKeys = [];\r\n\t\t\tthis.bViewLoaded = false;\r\n            this.bSignedIn = false;\r\n            this.bCloudSel = false;\r\n\t\t\tthis.visibleLayout = [];\r\n\t\t\tthis.resourceManager = {plotIndex: 0, resourceList: [], baseList: []};\r\n\t\t\tthis.lstDialogInfo = [];\r\n\t\t\tthis.menuInfo = [];\r\n\t\t\tthis.quickPlay = false;\r\n\t\t\tthis.isScreenHold = false;\r\n\t\t\tthis.bCmdAutoText = false;\r\n\t\t\tthis.isGameStarted = false;\r\n\t\t\tthis.usedStarCount = 0;\r\n\t\t\tthis.gameStarLimit = 0;\r\n\t\t\tthis.lstPlotTweens = [];\r\n\t\t\tthis.twinkleTimer = null;\r\n\t\t\tthis.uiOnLoadQueue = [];\r\n\t\t\tthis.timerCounts = [];\r\n\t\t\tthis.menuTimer = [];\r\n\t\t\tthis.recUidBelongTo = flashvars.uid;\r\n\t\t\tthis.gameUidBelongTo = flashvars.uid;\r\n\t\t\tthis.bSwitchAccInPlot = true;\r\n\t\t\tthis.payValueUid = flashvars.uid;\r\n\t\t\tthis.unlockChapterCallBack = null;\r\n\t\t\tthis.mallPayCallback = null;\r\n\t\t\tthis.isPaying = false;\r\n\t\t\tthis.isGettingNext = true;\r\n\t\t\tthis.isPreferentialFinished = false;\r\n\t\t\tthis.preferentialVector = [];\r\n\t\t\tthis.isSetValues = false;\r\n\t\t\tthis.isPaySuccess = false;\r\n\t\t\tthis.isGoToCommand = true;\r\n\t\t\tthis.shakeLoopObj = {level:0,duration:0,delay:0,loop:false,commands:null};\r\n\t\t\tthis.prePlotBkKey = null;\r\n\t\t\tthis.isQuickPlay = true;\r\n\t\t\tthis.hasCountDown = false;\r\n\t\t\tthis.playAdCallBack = null;\r\n            this.saveBubbleVector = [];\r\n            this.saveBubbleDataVector = [];\r\n            this.bubbleArchivalCount = [];\r\n            this.dialogNext = null;\r\n\t\t\tif(this.isWapOther()){\r\n                OtherWap.sendQHData();\r\n                OtherWap.initQHSdk().then((msg)=>{console.log(\"--->>>>> \" + msg)})\r\n\t\t\t}\r\n\t\t\taudioMgr.pause = this.pauseAudio.bind(this);\r\n\t\t\taudioMgr.resume = this.resumeAudio.bind(this);\r\n\t\t\taudioMgr.audioCanPlayCallBack = PhoneUtils.audioCanPlayCallBack.bind(PhoneUtils);\r\n\t\t\taudioMgr.audioErrorCallBack = PhoneUtils.audioErrorCallBack.bind(PhoneUtils);\r\n            gameCallback.updateAccInfo = this.updateAccInfo.bind(this);\r\n            gameCallback.unlockChapterFinished = this.unlockChapterFinished.bind(this);\r\n            gameCallback.mallPay = this.mallPay.bind(this);\r\n            gameCallback.preferentialFinished = this.preferentialFinished.bind(this);\r\n            gameCallback.showSave = this.showSaveInterface.bind(this);\r\n            gameCallback.playadBack = this.playadBackInterface.bind(this);\r\n\t\t\t//成功或者失败 都添加本地计时器\r\n\t\t\t//Utils.getTimeOffset().then(()=>{Utils.localUpdateTime();},()=>{Utils.localUpdateTime();});\r\n\t\t\t//Utils.sendSelOptions();\r\n\t\t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_PRELOADING_BEGIN);\r\n\t\t},\r\n        /**\r\n\t\t * 播放广告返回\r\n         */\r\n        playadBackInterface:function (adtype) {\r\n        \tif(this.playAdCallBack !== null){\r\n                this.playAdCallBack(adtype);\r\n\t\t\t}\r\n        },\r\n\t\t/**调用存档*/\r\n        showSaveInterface:function () {\r\n            if(this.recordLayer.visible){ //存档界面关闭\r\n                this.recordLayer.visible = false;\r\n\t\t\t}\r\n            this.context.fullScreen && this.onSettingsWindowModeBtnClicked();//全屏 退出全屏\r\n            this.menuLayer.visible = true;//主菜单显示\r\n\t\t\tthis.getSnap();\r\n            this.menuLayer.visible = false;//主菜单按钮关闭\r\n\t\t\tthis.showSave();\r\n        },\r\n\r\n\t\t/*优惠券结束回调*/\r\n\t\tpreferentialFinished:function (result/*uuid*/) {\r\n\t\t\tconst downloaduuid = this.curChapter && (this.curChapter.downloadUuid ? this.curChapter.downloadUuid : this.curChapter.uuid);\r\n\t\t\tthis.preferentialVector.push((result.uuid ? result.uuid : result));//记录下限免结束的downloaduuid\r\n            if(downloaduuid === (result.uuid ? result.uuid : result)){\r\n                //当前章节的uuid和限免uuid相同\r\n                this.isPreferentialFinished = true;//通知限免结束\r\n            }\r\n        },\r\n\r\n\t\tunlockChapterFinished: function (result, stayIfFail) {\r\n            this.unlockChapterCallBack && this.unlockChapterCallBack(result, stayIfFail);\r\n        },\r\n\t\t/**移除限免记的数组*/\r\n        dislodgePreferentVector:function (uuid) {\r\n            for(let i =0;i < this.preferentialVector.length;i++){\r\n                if(uuid === this.preferentialVector[i]){\r\n                \tthis.preferentialVector.splice(i,1)\r\n\t\t\t\t};\r\n            }\r\n        },\r\n\r\n        mallPay: function (result) {\r\n\t\t\tthis.mallPayCallback && this.mallPayCallback(result);\r\n\t\t\tthis.mallPayCallback = null;\r\n        },\r\n\r\n\t\tcheckIfMallPaySuccess: function (indentId,type=0) {\r\n            const getData = (url, d) => {\r\n                return Xhr.xhrSend(url, d).then(rs => {\r\n                    if (rs.responseText.length === 0) {\r\n                        return Promise.resolve(false);\r\n                    }\r\n\r\n                    let retData = JSON.parse(rs.responseText);\r\n                    if(flashvars.client === 'wap'){\r\n                        if (retData.status === 100) {\r\n                            return Promise.resolve(retData.data.serial_num === indentId && retData.data.c_status == '1');\r\n                        }else if(retData.status === 200){// 不存在此订单的流水号\r\n                            return Promise.resolve(false);\r\n\t\t\t\t\t\t}else if(retData.status === 102){// 流水当好为空\r\n                            return Promise.resolve(false);\r\n\t\t\t\t\t\t}else if(retData.status === 101){ //不允许的类型\r\n                            return Promise.resolve(false);\r\n\t\t\t\t\t\t}else{\r\n                            return Promise.resolve(false);\r\n\t\t\t\t\t\t}\r\n                    }else{\r\n                        if (retData.status === 0) {\r\n                            return Promise.resolve(retData.data.serial_num === indentId && retData.data.c_status == '1');\r\n                        }\r\n                        else if (retData.status === 100) {// 不存在此订单的流水号\r\n                            return Promise.resolve(false);\r\n                        }\r\n                        else { // status>0 && status<9 账号被踢出\r\n                            return Promise.resolve(false);\r\n                        }\r\n\t\t\t\t\t}\r\n\r\n                }, rj => {\r\n                    return Promise.resolve(false); // 请求遭拒  如跨域问题\r\n                });\r\n            };\r\n            let url = 'https://app.3000.com/?m=consume&op=index&ac=market_order_status&client=' + flashvars.client + '&v=' + flashvars.v +'&app_version=' + flashvars.app_version;\r\n            let data = 'u=' + encodeURIComponent(Utils.aesEncrypt(flashvars.u, 1))\r\n\t\t\t\t+ '&token=' + encodeURIComponent(Utils.aesEncrypt(flashvars.token, 1))\r\n\t\t\t\t+ '&serial_num=' + encodeURIComponent(Utils.aesEncrypt(indentId, 1));\r\n            if(flashvars.client === 'wap'){\r\n            \tif(flashvars.uid === ''){\r\n                    return this.getUserInfoFromWap().then(()=>{\r\n\t\t\t\t\t\tif(flashvars.uid === ''){\r\n                            //未登入\r\n                            return Promise.resolve(false);\r\n\t\t\t\t\t\t}else{\r\n                            url = 'https://pay.3000.com/?m=consume&op=h5_flash_request';\r\n                            data = 'type=' + encodeURIComponent(Utils.aesEncrypt(type, 3))\r\n                                + '&serial_num=' + encodeURIComponent(Utils.aesEncrypt(indentId, 3));\r\n                            return getData(url, data);\r\n\t\t\t\t\t\t}\r\n                    })\r\n\t\t\t\t}else{\r\n                    url = 'https://pay.3000.com/?m=consume&op=h5_flash_request';\r\n                    data = 'type=' + encodeURIComponent(Utils.aesEncrypt(type, 3))\r\n                        + '&serial_num=' + encodeURIComponent(Utils.aesEncrypt(indentId, 3));\r\n                    return getData(url, data);\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n                return getData(url, data);\r\n\t\t\t}\r\n        },\r\n\r\n\t\taddAssets: function (url, type, key, isPlot) {\r\n\t\t\treturn ResourcesManager.pushInLoader(url, type, key, isPlot);\r\n\t\t},\r\n\r\n\t\taddImage: function (key, url, image) {\r\n\t\t\tthis.viewComponent.game.cache.addImage(key, url || null, image);\r\n\t\t},\r\n\r\n\t\taddImageUrl: function (url, md5) {\r\n\t\t\treturn new Promise((resolve,  reject) => {\r\n\t\t\t\tconst data = new Image();\r\n\t\t\t\tdata.src = url;\r\n\t\t\t\tdata.onload = e => {\r\n\t\t\t\t\tif (!this.viewComponent.game.load.cache.checkImageKey(md5)) {\r\n\t\t\t\t\t\tthis.viewComponent.game.cache.addImage(md5, url, e.target);\r\n\t\t\t\t\t\tresolve()\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tdata.onerror = data.onabort = e => reject(e);\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\t// 解析Json Template\r\n\t\tparseJsonFile: function (game) {\r\n\t\t\tthis.json_data = game;//JSON.parse(JSON.stringify(game));\r\n\t\t\t// load template\r\n\t\t\tconst promises = [];\r\n\t\t\tif (this.json_data.template && this.json_data.template.json) {\r\n\t\t\t\tpromises.push(this.parseTemplateCoverAssets());\r\n\t\t\t\tpromises.push(this.parseTemplateDialogAssets());\r\n\t\t\t\tpromises.push(this.parseTemplateMenuAssets());\r\n\t\t\t\tpromises.push(this.parseTemplateSyMenuAssets());\r\n\t\t\t\tpromises.push(this.parseTemplateMainMenuAssets());\r\n\t\t\t\tpromises.push(this.parseTemplateSettingsAssets());\r\n\t\t\t\tpromises.push(this.parseTemplateOptionAssets());\r\n\t\t\t\tpromises.push(this.parseTemplatePlaybackAssets());\r\n\t\t\t\tpromises.push(this.parseTemplateRecordAssets());\r\n\t\t\t\tpromises.push(this.parseTemplateSoundAssets());\r\n\t\t\t}\r\n\t\t\treturn Promise.all(promises).then(() => {\r\n\t\t\t\tif (false && this.json_data.font) {\r\n                    return FontUtils.mergeFontImage(this.json_data.font, this.json_data.default_settings.font_size);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn Promise.resolve();\r\n\t\t\t\t}\r\n\t\t\t}).then(() => {\r\n\t\t\t\t//this.json_data = Utils.fixGame(this.json_data);\r\n\t\t\t\tpromises.length = 0;\r\n\r\n\t\t\t\t// font image\r\n                FontUtils.fontImage && this.viewComponent.game.load.image(FontUtils.fontFamily, FontUtils.fontImage);\r\n\r\n                // load logo\r\n\t\t\t\tif (this.json_data.logo && this.json_data.logo.background && this.json_data.logo.background.url) {\r\n\t\t\t\t\tpromises.push(this.addAssets(this.json_data.logo.background.url, 'img'));\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// load cover\r\n\t\t\t\tif (this.json_data.cover.background && this.json_data.cover.background.url) {\r\n\t\t\t\t\tpromises.push(this.addAssets(this.json_data.cover.background.url, 'img'));\r\n\t\t\t\t}\r\n\t\t\t\tif (this.json_data.cover.music && this.json_data.cover.music.url) {\r\n                    let url = this.json_data.cover.music.url;\r\n\t\t\t\t\tpromises.push(this.addAssets(url, 'audio'));\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// load views\r\n\t\t\t\tconst addEventAssets = (events) => {\r\n\t\t\t\t\tif (Object.prototype.toString.call(events) == '[object Array]') {\r\n\t\t\t\t\t\tevents.forEach(e => {\r\n\t\t\t\t\t\t\te.events.forEach(subEvent => {\r\n\t\t\t\t\t\t\t\tif (subEvent.type === 'playMusic' && subEvent.handle.music.url) {\r\n\t\t\t\t\t\t\t\t\tpromises.push(this.addAssets(subEvent.handle.music.url, 'audio'));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if (subEvent.type === 'playSound') {\r\n\t\t\t\t\t\t\t\t\tsubEvent.handle.sounds.forEach(sound => {sound && sound.url != 'inherit' && promises.push(this.addAssets(sound.url, 'audio'));});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tfor (let p in this.json_data.viewMap) {\r\n                    if (this.json_data.viewMap[p].type === 'timer') {\r\n                        addEventAssets(this.json_data.viewMap[p].events);\r\n                        continue;\r\n                    }\r\n                    const background = this.json_data.viewMap[p].content.background;\r\n\t\t\t\t\tconst sound = this.json_data.viewMap[p].content.sound;\r\n\t\t\t\t\tif (!background) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (background.url) {\r\n\t\t\t\t\t\tpromises.push(this.addAssets(background.url, 'img'));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (background.normal && background.normal.url) {\r\n\t\t\t\t\t\tpromises.push(this.addAssets(background.normal.url, 'img'));\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (background.active && background.active.url) {\r\n\t\t\t\t\t\tpromises.push(this.addAssets(background.active.url, 'img'));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (background.progress && background.progress.url) {\r\n\t\t\t\t\t\tpromises.push(this.addAssets(background.progress.url, 'img'));\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (sound && sound.url) {\r\n\t\t\t\t\t\tpromises.push(this.addAssets(sound.url, 'audio'));\r\n\t\t\t\t\t}\r\n\t\t\t\t\taddEventAssets(this.json_data.viewMap[p].events);\r\n\t\t\t\t\tthis.json_data.viewMap[p].children.forEach(child => {addEventAssets(child.events)});\r\n\t\t\t\t}\r\n\t\t\t\treturn Promise.all(promises).then(() => {\r\n                    return Promise.resolve();\r\n                    //this.sendNotification( diygamePlayer.AppConstants.SCENE_PRELOADING_PROGRESS); // 移至获取闪币数方法中\r\n\t\t\t\t}, e => Promise.reject(e))\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tparseTemplateCoverAssets:function () {\r\n\t\t\tconst promises = [];\r\n\t\t\tconst {titleContainer, startMenu, loadMenu, settingsMenu, overMenu} = this.json_data.template.json.cover;\r\n\r\n\t\t\tif (titleContainer.background.url && titleContainer.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(titleContainer.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (startMenu.normal.background.url && startMenu.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(startMenu.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (startMenu.active.background.url && startMenu.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(startMenu.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (loadMenu.normal.background.url && loadMenu.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(loadMenu.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (loadMenu.active.background.url && loadMenu.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(loadMenu.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (settingsMenu.normal.background.url && settingsMenu.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(settingsMenu.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (settingsMenu.active.background.url && settingsMenu.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(settingsMenu.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (overMenu.normal.background.url && overMenu.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(overMenu.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (overMenu.active.background.url && overMenu.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(overMenu.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\treturn Promise.all(promises)\r\n\t\t},\r\n\r\n\t\tparseTemplateDialogAssets:function () {\r\n\t\t\tconst promises = [];\r\n\t\t\tconst {background, avatarContainer, titleContainer} = this.json_data.template.json.dialog;\r\n\r\n\t\t\tif (background && background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (avatarContainer.background.url && avatarContainer.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(avatarContainer.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (titleContainer.background.url && titleContainer.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(titleContainer.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\treturn Promise.all(promises)\r\n\t\t},\r\n\r\n\t\tparseTemplateMenuAssets:function () {\r\n\t\t\tconst promises = [];\r\n\t\t\tconst {normal, active} = this.json_data.template.json.menu;\r\n\t\t\tif (normal.background && normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (active.background && active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\treturn Promise.all(promises);\r\n\t\t},\r\n\r\n\t\tparseTemplateSyMenuAssets: function () {\r\n\t\t\tif (!this.json_data.template.json.shanyiMenu) return;\r\n\r\n            const promises = [];\r\n            const {normal, active} = this.json_data.template.json.shanyiMenu;\r\n            if (normal.background && normal.background.url) {\r\n                promises.push(this.addAssets(normal.background.url, 'img'));\r\n            }\r\n            if (active.background && active.background.url) {\r\n                promises.push(this.addAssets(active.background.url, 'img'));\r\n            }\r\n            return Promise.all(promises);\r\n        },\r\n\r\n\t\tparseTemplateMainMenuAssets:function () {\r\n\t\t\tconst promises = [];\r\n\t\t\tconst {background, header, save, load, playback, autoplay, settings, back} = this.json_data.template.json.mainMenu;\r\n\r\n\t\t\tif (background.url && background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (header.background && header.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(header.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (save.normal.background && save.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(save.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (save.active.background && save.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(save.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (load.normal.background && load.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(load.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (load.active.background && load.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(load.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (playback.normal.background && playback.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(playback.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (playback.active.background && playback.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(playback.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (autoplay.normal.background && autoplay.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(autoplay.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (autoplay.active.background && autoplay.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(autoplay.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (settings.normal.background && settings.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(settings.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (settings.active.background && settings.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(settings.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (back.normal.background && back.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(back.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (back.active.background && back.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(back.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\treturn Promise.all(promises);\r\n\t\t},\r\n\r\n\t\tparseTemplateSettingsAssets:function () {\r\n\t\t\tconst promises = [];\r\n\t\t\tconst {background, header, displayHeader, textHeader, displayCaption, textCaption, fullMode, windowMode, autoOn, autoOff, back} = this.json_data.template.json.settings;\r\n\t\t\tif(this.json_data.template.json.settings.musicCaption){\r\n\t\t\t\tconst musicCaption = this.json_data.template.json.settings.musicCaption;\r\n                if (musicCaption.background && musicCaption.background.url) {\r\n                    promises.push(this.addAssets(musicCaption.background.url, 'img'));\r\n                }\r\n\t\t\t}\r\n\t\t\tif(this.json_data.template.json.settings.musicVolume){\r\n                const musicVolume = this.json_data.template.json.settings.musicVolume;\r\n                if(musicVolume.normal && musicVolume.normal.background && musicVolume.normal.background.url){\r\n                    promises.push(this.addAssets(musicVolume.normal.background.url, 'img'));\r\n                }\r\n                if(musicVolume.progress && musicVolume.progress.background && musicVolume.progress.background.url){\r\n                    promises.push(this.addAssets(musicVolume.progress.background.url, 'img'));\r\n                }\r\n\t\t\t}\r\n\t\t\tif(this.json_data.template.json.settings.soundCaption){\r\n                const soundCaption = this.json_data.template.json.settings.soundCaption;\r\n                if (soundCaption.background && soundCaption.background.url) {\r\n                    promises.push(this.addAssets(soundCaption.background.url, 'img'));\r\n                }\r\n\t\t\t}\r\n\t\t\tif(this.json_data.template.json.settings.soundVolume){\r\n                const soundVolume = this.json_data.template.json.settings.soundVolume;\r\n                if(soundVolume.normal && soundVolume.normal.background && soundVolume.normal.background.url){\r\n                    promises.push(this.addAssets(soundVolume.normal.background.url, 'img'));\r\n                }\r\n                if(soundVolume.progress && soundVolume.progress.background && soundVolume.progress.background.url){\r\n                    promises.push(this.addAssets(soundVolume.progress.background.url, 'img'));\r\n                }\r\n\t\t\t}\r\n            if(this.json_data.template.json.settings.volumeHeader){\r\n                const volumeHeader = this.json_data.template.json.settings.volumeHeader;\r\n                if (volumeHeader.background && volumeHeader.background.url) {\r\n                    promises.push(this.addAssets(volumeHeader.background.url, 'img'));\r\n                }\r\n            }\r\n\t\t\tif (background && background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (header.background && header.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(header.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (displayHeader.background && displayHeader.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(displayHeader.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (textHeader.background && textHeader.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(textHeader.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (displayCaption.background && displayCaption.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(displayCaption.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (textCaption.background.url && textCaption.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(textCaption.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (fullMode.unchecked.background && fullMode.unchecked.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(fullMode.unchecked.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (fullMode.checked.background && fullMode.checked.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(fullMode.checked.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (windowMode.unchecked.background && windowMode.unchecked.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(windowMode.unchecked.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (windowMode.checked.background && windowMode.checked.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(windowMode.checked.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (autoOn.unchecked.background && autoOn.unchecked.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(autoOn.unchecked.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (autoOn.checked.background && autoOn.checked.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(autoOn.checked.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (autoOff.unchecked.background && autoOff.unchecked.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(autoOff.unchecked.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (autoOff.checked.background && autoOff.checked.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(autoOff.checked.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (back.normal.background && back.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(back.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (back.active.background && back.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(back.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\treturn Promise.all(promises);\r\n\t\t},\r\n\r\n\t\tparseTemplateOptionAssets:function () {\r\n\t\t\tconst promises = [];\r\n\t\t\tconst {normal, active} = this.json_data.template.json.option;\r\n\t\t\tif (normal.background && normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (active.background && active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\treturn Promise.all(promises);\r\n\t\t},\r\n\r\n\t\tparseTemplatePlaybackAssets:function () {\r\n\t\t\tconst promises = [];\r\n\t\t\tconst {background, scrollBox, back} = this.json_data.template.json.playback;\r\n\t\t\tif (background && background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (scrollBox.background && scrollBox.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(scrollBox.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (scrollBox.item.background && scrollBox.item.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(scrollBox.item.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (scrollBox.item.content.background && scrollBox.item.content.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(scrollBox.item.content.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (back.normal.background && back.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(back.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (back.active.background.url && back.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(back.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\treturn Promise.all(promises);\r\n\t\t},\r\n\r\n\t\tparseTemplateRecordAssets:function () {\r\n\t\t\tconst promises = [];\r\n\t\t\tconst {background, scrollBox, back} = this.json_data.template.json.record;\r\n\r\n\t\t\tif (background && background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (scrollBox.background && scrollBox.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(scrollBox.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (scrollBox.item.background && scrollBox.item.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(scrollBox.item.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (scrollBox.item.content.background && scrollBox.item.content.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(scrollBox.item.content.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (back.normal.background && back.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(back.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (back.active.background.url && back.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(back.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\treturn Promise.all(promises);\r\n\t\t},\r\n\r\n\t\tparseTemplateSoundAssets:function () {\r\n\t\t\tconst promises = [];\r\n\t\t\tif (this.json_data.template.json.sound && this.json_data.template.json.sound.url) {\r\n\t\t\t\tpromises.push(this.addAssets(this.json_data.template.json.sound.url, 'audio'));\r\n\t\t\t}\r\n\t\t\treturn Promise.all(promises);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * wap端 获取用户info\r\n\t\t * */\r\n\t\tgetUserInfoFromWap:function () {\r\n\t\t\t//const url = 'https://ptlogin.3000.com/?m=ptlogin&ac=cookieuid';\r\n            /*return Xhr.xhrLoad(url, '').then(rs => {\r\n                if (rs.responseText.length === 0) {\r\n                    //获取用户信息失败\r\n\t\t\t\t\tflashvars.uid = ''\r\n\t\t\t\t\treturn Promise.resolve()\r\n                }\r\n                const retData = JSON.parse(rs.responseText);\r\n                if(retData.success === true && retData.data ){\r\n                    flashvars.uid = retData.data.uid\r\n\t\t\t\t}\r\n                return Promise.resolve();\r\n            }, rj => {\r\n                flashvars.uid = '';\r\n                return Promise.resolve()\r\n            })*/\r\n            return new Promise((resolve,reject) =>{\r\n                jsonp('https://ptlogin.3000.com/?m=ptlogin&ac=cookieuid',{},(err,data)=>{\r\n                \tif(err){\r\n                        flashvars.uid = '';\r\n                        return resolve();\r\n                \t}\r\n\r\n                \tif(data){\r\n                        flashvars.uid = data.data.uid ? data.data.uid : '';\r\n\t\t\t\t\t}\r\n                    return resolve();\r\n\t\t\t\t})\r\n                /*jQuery.ajax({\r\n                    async : true,\r\n                    url : \"https://ptlogin.3000.com/?m=ptlogin&ac=cookieuid\",\r\n                    type : \"GET\",\r\n                    dataType : \"jsonp\", // 返回的数据类型，设置为JSONP方式\r\n                    jsonp : 'callback', //指定一个查询参数名称来覆盖默认的 jsonp 回调参数名 callback\r\n                    jsonpCallback: 'handleResponse', //设置回调函数名\r\n                    data : {},\r\n                    success: function(data){\r\n                        flashvars.uid = data.data.uid ? data.data.uid : '';\r\n                        return resolve();\r\n                    },\r\n                    error:function () {\r\n                        flashvars.uid = ''\r\n\t\t\t\t\t\treturn resolve();\r\n                    }\r\n                });*/\r\n\t\t\t})\r\n\r\n        },\r\n\r\n\t\tshowLogo: function ()\t{\r\n\t\t\tthis.sendNotification( diygamePlayer.AppConstants.SCENE_SHOW_LOGO);\r\n\t\t},\r\n\t\tshowCover: function () {\r\n\t\t\tconst { music } = this.json_data.cover;\r\n\t\t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_GOTO_COVERMENU);\r\n\t\t},\r\n\t\tshowMainMenu: function (context) {\r\n\t\t\tthis.onPause();\r\n\t\t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_GOTO_MAINMENU, context);\r\n\t\t},\r\n\t\tshowSettings: function (context, callbackInfo) {\r\n            this.onPause();\r\n\t\t\tif (this.mainMenuLayer.visible) {\r\n\t\t\t\tthis.mainMenuLayer.visible = false;\r\n\t\t\t\tthis.visibleLayout = [this.mainMenuLayer, ...this.visibleLayout];\r\n\t\t\t}\r\n\t\t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_GOTO_SETTINGS, {context:context, callbackInfo: callbackInfo});\r\n\t\t},\r\n\t\tshowPlayback: function (callbackInfo) {\r\n            this.onPause();\r\n\t\t\tif (this.mainMenuLayer.visible) {\r\n\t\t\t\tthis.mainMenuLayer.visible = false;\r\n\t\t\t\tthis.visibleLayout = [this.mainMenuLayer, ...this.visibleLayout];\r\n\t\t\t}\r\n\t\t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_GOTO_PLAYBACK, callbackInfo);\r\n\t\t},\r\n\r\n\t\tshowSave: function (bLocalCloudSwitch, callbackInfo) {\r\n\t\t\t// 隐藏菜单层\r\n\t\t\tthis.menuLayer.visible = false;\r\n            this.bToSaveFile = true;\r\n            this.loadData(bLocalCloudSwitch);\r\n            this.showRecord(callbackInfo);\r\n\r\n\t\t},\r\n\r\n\t\tshowLoad: function (bLocalCloudSwitch, callbackInfo) {\r\n            // 隐藏菜单层\r\n            this.menuLayer.visible = false;\r\n            if (flashvars.u==='' && flashvars.token==='' && flashvars.client==='') {\r\n                flashvars.uid = Utils.getUidByCookie();\r\n            }\r\n            if(flashvars.client === 'wap' && flashvars.uid === ''){\r\n            \tthis.getUserInfoFromWap().then(()=>{\r\n                    this.getPayInfo().then(() => {\r\n                        this.bToSaveFile = false;\r\n                        this.loadData(bLocalCloudSwitch);\r\n                        this.showRecord(callbackInfo);\r\n                    })\r\n\t\t\t\t})\r\n\t\t\t}else{\r\n                this.getPayInfo().then(() => {\r\n                    this.bToSaveFile = false;\r\n                    this.loadData(bLocalCloudSwitch);\r\n                    this.showRecord(callbackInfo);\r\n                })\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tshowRecord: function (callbackInfo) {\r\n            this.onPause();\r\n\t\t\tif (this.mainMenuLayer.visible) {\r\n\t\t\t\tthis.mainMenuLayer.visible = false;\r\n\t\t\t\tthis.visibleLayout = [this.mainMenuLayer, ...this.visibleLayout];\r\n\t\t\t}\r\n\t\t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_GOTO_RECORD, callbackInfo);\r\n\t\t},\r\n\r\n\t\tshowEnd: function () {\r\n            this.sendNotification(diygamePlayer.AppConstants.SCENE_SHOW_INPUT_VIEW, false);\t// 隐藏剧情输入框\r\n\t\t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_GOTO_END);\r\n\t\t},\r\n\r\n\t\tisPlotResourceExist: function (plotInfo) {\r\n            const useIOSAudio = ('ios' === flashvars.client && '1.5.0' >= flashvars.app_versionl);\r\n\r\n            const usingCountMap = this.usingResourceCountMap();\r\n            let hasCheckCount = 0;\r\n            const isNotExist = (type, key) => {\r\n                const count = ResourcesManager.getCount(type, key);\r\n                if (!count || (count == usingCountMap[key] && !ResourcesManager.isGlobal(type, key) && !ResourcesManager.isUsingKey(key))) {\r\n                    return true;\r\n                }\r\n                hasCheckCount ++;\r\n                return false;\r\n            };\r\n\r\n            const checkCmd = command => {\r\n                if ('addImage' === command.type) {\r\n                    const { index,  url } = command.args[0];\r\n                    if ('inherit' === url) {\r\n                        return true;\r\n                    }\r\n                    return !isNotExist('img', url);\r\n                } else if (('playMusic' === command.type || 'playSound' === command.type)) {\r\n                    if('inherit' === command.args[0].url){\r\n                        return true;\r\n                    }\r\n                    return !isNotExist('audio', command.args[0].url);\r\n                } if ('showDialog' === command.type) {\r\n                    return !isNotExist('img', command.args[0].avatar.url);\r\n                } else if ('options' === command.type || 'conditionOptions' === command.type) {\r\n                    for (let item of command.args) {\r\n                        if (item.background && item.background.normal && item.background.normal.url && isNotExist('img', item.background.normal.url)) {\r\n                            return false;\r\n                        }\r\n                        if (item.background && item.background.active && item.background.active.url && isNotExist('img', item.background.active.url)) {\r\n                            return false;\r\n                        }\r\n                        if (item.background && item.background.disable && item.background.disable.url && isNotExist('img', item.background.disable.url)) {\r\n                            return false;\r\n                        }\r\n                        if (item.sound && item.sound.url && isNotExist('audio', item.sound.url)) {\r\n                            return false;\r\n                        }\r\n                    }\r\n                } else if ('weather' === command.type && '1' !== flashvars.offline && !isExistWeatherResources(command.args[0].value)) {\r\n                    return false;\r\n                }\r\n                return true;\r\n            }\r\n\r\n            const cmdState = { autotext: false, showDialog: false, hasOption: false };\r\n            const isSafeState =  () => {\r\n                if (cmdState.hasOption && hasCheckCount > 10) {\r\n                    return true;\r\n                }\r\n                if (cmdState.showDialog && !cmdState.autotext && hasCheckCount > 10) {\r\n                    return true;\r\n                }\r\n                return hasCheckCount > 20;\r\n            }\r\n\r\n            const checkCmds = commands => {\r\n                for (let i = 0; i < commands.length && !isSafeState(); i++) {\r\n                    const cmd = commands[i];\r\n                    if (!checkCmd(cmd)) {\r\n                        return false;\r\n                    }\r\n                    if(cmd.type === 'options'){\r\n                        cmdState.hasOption = true;\r\n                    }\r\n                    if(cmd.type === 'showDialog'){\r\n                        cmdState.showDialog = true;\r\n                    }\r\n                    if(cmd.type === 'autotext'){\r\n                        cmdState.autotext = true;\r\n                    }\r\n\r\n                    if ((cmd.type === 'options' || cmd.type === 'conditionOptions')) {\r\n                        for (let j = 0; j < cmd.args.length && !isSafeState(); j++) {\r\n                            if (!checkCmds(cmd.args[j].commands)) {\r\n                                return false;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                return true;\r\n            }\r\n\r\n            const isExistWeatherResources = weather => {\r\n                if (weather === 'snowy' && isNotExist('img', `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('snow')}/xuehua_00119.png`)) {\r\n                    return false;\r\n                }\r\n                else if (weather === 'rainy' && isNotExist('img', `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('rain')}/xiayu_00049.png`)) {\r\n                    return false;\r\n                }\r\n                else if (weather === 'defoliation' && isNotExist('img', `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('mapleLeaves')}/fengye_00089.png`)) {\r\n                    return false;\r\n                }\r\n                else if (weather === 'fallingPeach' && isNotExist('img', `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('beachBlossom')}/taohua_00089.png`)) {\r\n                    return false;\r\n                }\r\n                else if (weather === 'fallingFlower' && isNotExist('img', `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('blossom')}/yinghua_00089.png`)) {\r\n                    return false;\r\n                }\r\n                else if (weather === 'lightning' && isNotExist('img', `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('lightning')}/shandian_00049.png`)) {\r\n                    return false;\r\n                }\r\n                else if(flashvars.vertical && weather === 'windy' && isNotExist('img',`/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('wind')}/feng_00019.png`)){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n                return true;\r\n            }\r\n\r\n            if (plotInfo.commands){\r\n                return checkCmds(plotInfo.commands);\r\n            }\r\n\r\n            if (plotInfo.background.url && plotInfo.background.url !== 'inherit' && isNotExist('img', plotInfo.background.url)) {\r\n                return false;\r\n            } \r\n            if (plotInfo.avatar.url && isNotExist('img', plotInfo.avatar.url)) {\r\n                return false;\r\n            }\r\n            if (plotInfo.music.url  && plotInfo.music.url !== 'inherit' && (isNotExist('audio', plotInfo.music.url) && !useIOSAudio)) {\r\n                return false;\r\n            }\r\n            if (plotInfo.options.length) {\r\n                for (let item of plotInfo.options) {\r\n                    if (item.background && item.background.normal && item.background.normal.url && isNotExist('img', item.background.normal.url)) {\r\n                        return false;\r\n                    }\r\n                    if (item.background && item.background.active && item.background.active.url && isNotExist('img', item.background.active.url)) {\r\n                        return false;\r\n                    }\r\n                    if (item.background && item.background.disable && item.background.disable.url && isNotExist('img', item.background.disable.url)) {\r\n                        return false;\r\n                    }\r\n                    if (item.sound && item.sound.url && isNotExist('audio', item.sound.url)) {\r\n                        return false;\r\n                    }\r\n                }\r\n            }\r\n            if (plotInfo.characters.length || plotInfo.props.length) {\r\n                for (let item of [...plotInfo.characters, ...plotInfo.props]) {\r\n                    if (isNotExist('img', item.url)) {\r\n                        return false;\r\n                    }\r\n                }\r\n            }\r\n            if (plotInfo.weather && flashvars.offline !==  '1' && !isExistWeatherResources(plotInfo.weather.value)) {\r\n                return false;\r\n            }\r\n            for (let item in plotInfo.plot_sound) {\r\n                if (plotInfo.plot_sound[item]) {\r\n                    const url = plotInfo.plot_sound[item].url;\r\n                    if (url && url!=='inherit' && !useIOSAudio && isNotExist('audio', plotInfo.plot_sound[item].url)) {\r\n                        return false;\r\n                    }\r\n                }\r\n            }\r\n            return true;\r\n        },\r\n\r\n\t\tgetLoadingPlotResource: function (plotInfo) {\r\n            const resources = [];\r\n            if (!plotInfo.commands) {\r\n                resources.push(...ResourcesManager.getPlotResources(plotInfo));\r\n            } else {\r\n                let countCmd = 0;\r\n                const resources = [];\r\n                const getInCommands = commands => {\r\n                    for (let i = 0; i < commands.length && countCmd < 20; i++) {\r\n                        const cmd = commands[i];\r\n                        const res = ResourcesManager.getCommandResources(cmd);\r\n                        if (res.length) {\r\n                            resources.push(...res);\r\n                            countCmd++;\r\n                        }\r\n\r\n                        if ((cmd.type === 'options' || cmd.type === 'conditionOptions')) {\r\n                            for (let j = 0; j < cmd.args.length && countCmd < 20; j++) {\r\n                                getInCommands(cmd.args[j].commands);\r\n                            }\r\n                        }\r\n                    }\r\n                };\r\n\r\n                getInCommands(plotInfo.commands);\r\n            }\r\n\r\n            const { load } = this.viewComponent.game;            \r\n            return resources.filter(({ type, url }) => load.getAsset('img' === type ? 'image' : 'audio', url)).map(a => Object.assign(a, { key: a.url }));\r\n        },\r\n\r\n\t\tusingResourceCountMap: function (key) {\r\n\t\t\tconst keyMap = { };\r\n\t\t\tconst imgCount = (g = this.viewComponent.game.world) => g.children.forEach(r => {\r\n\t\t\t\tkeyMap[r.key] = (keyMap[r.key] || 0) + 1;\r\n\t\t\t\timgCount(r);\r\n\t\t\t});\r\n\t\t\tconst soundCount = () => this.viewComponent.game.sound._sounds.forEach(s => keyMap[s.key] = (keyMap[s.key] || 0) + 1);\r\n\t\t\timgCount();\r\n\t\t\tsoundCount();\r\n\t\t\treturn keyMap;\r\n\t\t},\r\n\r\n        resetResources: function (resources = []) {\r\n            const usingCountMap = this.usingResourceCountMap();\r\n\t\t\tResourcesManager.forEachReCount((type, key, count) => {\r\n\t\t\t\tconst usingCount = usingCountMap[key];\r\n\t\t\t\tif (usingCount > 0) {\r\n\t\t\t\t\tResourcesManager.addRefCount(type, key, 'play',usingCount);\r\n\t\t\t\t}\r\n\t\t\t\tif (!resources.some(d => d.key === key)) {\r\n\t\t\t\t\t!count && ResourcesManager.removeFromCache(type, key);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (key === ResourcesManager.usingKeyMap.music) {\r\n\t\t\t\t\t\tResourcesManager.addRefCount(type, key);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === ResourcesManager.usingKeyMap.background) {\r\n\t\t\t\t\t\tResourcesManager.addRefCount(type, key);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (ResourcesManager.usingKeyMap.sounds.some(k => k === key)) {\r\n\t\t\t\t\t\tResourcesManager.addRefCount(type, key);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n        },\r\n\t\tgetResources: function (context, chapter, plotIndex, cmdPlotSnap={}, loadData) {\r\n\t\t\tconst { cmdInfo, cmdIndex, cmdScreenSnap } = cmdPlotSnap\r\n\t\t\tconst plots = chapter.plots;\r\n\t\t\tlet { music, sounds, background } = ResourcesManager.usingKeyMap;\r\n\t\t\tif(loadData){\r\n\t\t\t\tmusic = loadData.music.url\r\n\t\t\t\tsounds = loadData.sounds.map(s => s && s.url);\r\n\t\t\t\tbackground = loadData.background;\r\n\t\t\t}\r\n            ResourcesManager.forceDecode = { musics: [], sounds: new Array(10).fill('') };\r\n            if (!chapter.parent && !plotIndex) {\r\n                ResourcesManager.resetReCount();\r\n            }\r\n            ResourcesManager.LoadedMark = [];\r\n            ResourcesManager.gameData = this.json_data;\r\n            ResourcesManager.sceneProxy = this;\r\n\t\t\treturn ResourcesManager.getResourcesByContext(context, chapter, plotIndex, cmdInfo, cmdIndex).then(resources => {\r\n\t\t\t\tconst addResources = (data) => {\r\n\t\t\t\t\tif (!resources.data.some(d => d.key === data.key)) {\r\n\t\t\t\t\t\tresources.data.push(data);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tResourcesManager.addRefCount(data.type, data.key);\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif (plotIndex !== undefined && plots[plotIndex] && !plots[plotIndex].commands && plots[plotIndex].music.url === 'inherit') {\r\n\t\t\t\t\tconst music = this.getMusic(chapter, plotIndex);\r\n\t\t\t\t\tif (music) {\r\n\t\t\t\t\t\taddResources({ key: music, type: 'audio' });\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (loadData) {\r\n\t\t\t\t\tconst { music, sounds, charsAndProps, background, images,bubble } = loadData;\r\n\t\t\t\t\tif (background && !resources.data.some(d => d.key === background)) {\r\n\t\t\t\t\t\taddResources({ key: background, type: 'img' });\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (music && !resources.data.some(d => d.key === music.url)) {\r\n\t\t\t\t\t\tResourcesManager.forceDecode.musics.push(music.url);\r\n\t\t\t\t\t\taddResources({ key: music.url, type: 'audio' });\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsounds && sounds.forEach((s, i) => {\r\n\t\t\t\t\t\tif (s && !resources.data.some(d => d.key === s.url)) {\r\n\t\t\t\t\t\t\tResourcesManager.forceDecode.sounds[i] = s.url;\r\n\t\t\t\t\t\t\taddResources({ key: s.url, type: 'audio' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tcharsAndProps && charsAndProps.forEach(cp => {\r\n\t\t\t\t\t\tif (!resources.data.some(d => d.key === cp.url)) {\r\n\t\t\t\t\t\t\taddResources({ key: cp.url, type: 'img' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\timages && images.forEach(img => {\r\n\t\t\t\t\t\tif (!resources.data.some(d => d.key === img.url)) {\r\n\t\t\t\t\t\t\taddResources({ key: img.url, type: 'img' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n                    if(bubble){\r\n                        const getbubbleurl = (ary)=>{\r\n                            ary.forEach((cmds,index) =>{\r\n                                const {avatar,content} = cmds.args[0];\r\n                                if(avatar.url){\r\n                                    addResources({type:'img', key:avatar.url});\r\n                                }\r\n                                if(content.url){\r\n                                    addResources({type:'img', key:content.url});\r\n                                }\r\n                            })\r\n                        }\r\n                        bubble.forEach((b,i)=>{\r\n                            if(b.bubbleMode.args[0].url){\r\n                                resources.push({type:'img', key:b.bubbleMode.args[0].url});\r\n                            }\r\n                            getbubbleurl(b.bubble)\r\n                        })\r\n\r\n                    }\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (cmdScreenSnap) {\r\n\t\t\t\t\tconst { music, sounds, charsAndProps, dialogInfo, bk } = cmdPlotSnap.cmdScreenSnap;\r\n\t\t\t\t\tif (dialogInfo && dialogInfo[0] && dialogInfo[0].avatar.url) {\r\n\t\t\t\t\t\taddResources({ key: dialogInfo[0].avatar.url, type: 'img' });\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (bk && bk.url) {\r\n\t\t\t\t\t\taddResources({ key: bk.url, type: 'img' });\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (music && music.url) {\r\n\t\t\t\t\t\taddResources({ key: music.url, type: 'audio' });\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsounds && sounds.forEach((s, i) => s && s.url && addResources({ key: s.url, type: 'audio' }));\r\n\t\t\t\t\tcharsAndProps && charsAndProps.forEach(cp => cp && cp.url && addResources({ key: cp.url, type: 'img' }));\r\n\t\t\t\t\tif(cmdScreenSnap.weatherType !== ''){\r\n                        ResourcesManager.getWeatherResources(cmdScreenSnap.weatherType).forEach((w)=>{\r\n\t\t\t\t\t\t\tw && addResources({ key: w.url, type: w.type })\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn resources;\r\n\t\t\t});\r\n\t\t},\r\n\t\tpreloadCommandsAssets: function (context, chapter, plotIndex, cmdInfo, cmdIndex, loadData){\r\n\t\t\treturn this.getResources(context, chapter, plotIndex, { cmdInfo, cmdIndex }, loadData).then(resources => {\r\n                ResourcesManager.PreloadState.preloaded = 0;\r\n\t\t\t\tconst promises = [];\r\n\t\t\t\tloadData && this.resetResources(resources.data);\r\n\t\t\t\tresources.data.forEach(d => {\r\n\t\t\t\t\tpromises.push(this.addAssets(d.key, d.type, d.key, true).then(needLoad => Object.assign({needLoad},d)));\r\n\t\t\t\t});\r\n\t\t\t\treturn Promise.all(promises).then(resources => resources.filter(r => r.needLoad));\r\n\t\t\t});\r\n\t\t},\r\n\t\tpreloadChapterAssets: function (context, chapter, plotIndex, cmdPlotSnap, loadData,restart) {\r\n\t\t\tthis.curChapter = chapter;\r\n\t\t\tthis.curPlotIndex = plotIndex || 0;\r\n            this.cmdPlotSnap = cmdPlotSnap;\r\n\t\t\treturn this.getResources(context, chapter, plotIndex, cmdPlotSnap, loadData).then(resources => {\r\n                ResourcesManager.PreloadState.preloaded = 0;\r\n\t\t\t\tconst promises = [];\r\n\t\t\t\t(loadData || restart) && this.resetResources(resources.data); //重播和读档\r\n\t\t\t\tresources.data.forEach(d => {\r\n\t\t\t\t\tpromises.push(this.addAssets(d.key, d.type, d.key, true).then(needLoad => Object.assign({needLoad},d)));\r\n\t\t\t\t});\r\n\t\t\t\treturn Promise.all(promises).then(resources => {\r\n                    const needLoadList = resources.filter(r => r.needLoad);\r\n\t\t\t\t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_PLOT_LOAD_ASSETS_READY, {context, loadData, needLoadList});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tenableLayerInput: function (layer, bEnabled) {\r\n\t\t\tconst enableChild = function (child, b) {\r\n\t\t\t\tif (child.inputEnabled == !b && !child.text) {\r\n\t\t\t\t\tchild.inputEnabled = b;\r\n\t\t\t\t}\r\n\t\t\t\tif (child.children.length > 0) {\r\n\t\t\t\t\tfor (let i in child.children) {\r\n\t\t\t\t\t\tenableChild(child.children[i], b);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tif ('recordLayer' === layer.name) {\r\n\t\t\t\tlayer.visible = bEnabled;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\telse if ('menuLayer' === layer.name) {\r\n\t\t\t\tlayer.children[0].inputEnabled = bEnabled;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tfor (let i in layer.children) {\r\n\t\t\t\t\tenableChild(layer.children[i], bEnabled);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tapToFinalState: function () {\r\n            if (this.charsAndPropsLayer && this.charsAndPropsLayer.exists) {\r\n                for (let i=0; i<this.charsAndPropsLayer.children.length; i++) {\r\n                    let imgGroup = this.charsAndPropsLayer.children[i];\r\n                    let img = imgGroup.children[0];\r\n                    if (img && img.finalState) {\r\n                        img.alpha = img.finalState.alpha;\r\n                        img.angle = img.finalState.angle;\r\n                        img.x = img.finalState.x;\r\n                        img.y = img.finalState.y;\r\n                        imgGroup.x = 0;\r\n                        imgGroup.y = 0;\r\n                        imgGroup.scale.x = imgGroup.finalState.scale.x;\r\n                        imgGroup.scale.y = imgGroup.finalState.scale.y;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n\t\tremovePlotTweens: function () {\r\n            // 清理上一剧情动画\r\n            this.twinkleTimer && this.twinkleTimer.cancel() && (this.twinkleTimer=null);\r\n            while (this.lstPlotTweens.length) {\r\n                let tween = this.lstPlotTweens.splice(0, 1);\r\n                tween[0].stop(true);\r\n                if (tween[0].target && tween[0].target.name === 'twinkle') {\r\n                    tween[0].target.destroy();\r\n                }\r\n            }\r\n            this.apToFinalState();\r\n        },\r\n\r\n\t\tonPause: function () {\r\n\t\t\t// 暂停剧情播放\r\n            this.playPause = true;\r\n\r\n\t\t\t// 暂停所有元素的缓动动画\r\n            //this.viewComponent.game.tweens.pauseAll();\r\n            for (let i = this.viewComponent.game.tweens._tweens.length - 1; i >= 0; i--)\r\n            {\r\n            \tlet t = this.viewComponent.game.tweens._tweens[i];\r\n                if (t.name && t.name==='toast') continue;\r\n                t.pause();\r\n            }\r\n            this.sendNotification(diygamePlayer.AppConstants.SCENE_SHOW_INPUT_VIEW, false);\t// 隐藏剧情输入框\r\n        },\r\n\r\n\t\tonResume: function () {\r\n            this.isQuickPlay = true;\r\n            this.playPause = false;\t\t\t\t\t\t// 唤醒剧情播放\r\n            this.viewComponent.game.tweens.resumeAll();\t\t// 唤醒所有元素的缓动动画\r\n            this.hasCountDown && this.viewComponent.game.time.events.start(); // 恢复倒计时\r\n\t\t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_SHOW_INPUT_VIEW, true);\t// 显示剧情输入框UI\r\n        },\r\n\r\n\t\tonCoverStartBtnClicked: function () {\r\n            const chapter = this.findFirstChapter();\r\n            const chapterUuid = chapter.downloadUuid ? chapter.downloadUuid : chapter.uuid;\r\n            if (chapter.md5 && chapter.plots.length === 0) {\r\n                //第三方\r\n                if(this.isWapOther()){\r\n                    const otherback = (plots)=>{\r\n                        if(plots === null){\r\n                            Dialog.error('获取付费章节信息失败');\r\n                        }else if(plots === \"fail\"){\r\n                            //查询失败\r\n                            Dialog.custom(\"Error\",\"仍未查询到您的支付信息哦，请确认已经支付~ 如有疑问请添加闪艺客服QQ：819786897 ~\",\"提示\",\"复制QQ\",\"取消\",false).then(()=>{\r\n                                Copy(\"819786897\",{\r\n                                    debug: false,\r\n                                    message: '复制成功',\r\n                                })\r\n                            },()=>{\r\n                            })\r\n                        }else{\r\n                            chapter.plots = plots ? plots : [];\r\n                            this.preloadChapterAssets(this.context, chapter);\r\n                        }\r\n                    }\r\n                    this.unlockChapterByWapOther(chapterUuid,chapter.charge,chapter.md5,otherback);\r\n                    return;\r\n                }\r\n\r\n                if (chapter.charge && ('android' === flashvars.client || 'ios' === flashvars.client || flashvars.client === 'wap')) {\r\n                    const unlockFinish = (bSuccess, stayIfFail) => {\r\n                        if (bSuccess) {\r\n                            this.checkIfChapterFree(chapterUuid, chapter.md5).then((plots)=>{\r\n                                this.unlockChapterCallBack = null;\r\n                                chapter.plots.push(...plots);\r\n                                this.preloadChapterAssets(this.context, chapter);\r\n                            }, () => {\r\n                                if(flashvars.client === 'wap'){\r\n                                    window.parent && window.parent.playLogin();\r\n                                }else{\r\n                                    Dialog.error('获取付费章节信息失败');\r\n\t\t\t\t\t\t\t\t}\r\n                                this.coverLayer.visible = true;\r\n                            })\r\n                        }\r\n                        else if (stayIfFail) {\r\n                            this.coverLayer.visible = true;\r\n                        }\r\n                    };\r\n\r\n                    this.unlockChapter(chapterUuid, chapter.charge, chapter.md5, unlockFinish);\r\n                } else {\r\n                    this.checkIfChapterFree(chapterUuid, chapter.md5).then((plots)=>{\r\n                        chapter.plots.push(...plots);\r\n                        this.preloadChapterAssets(this.context, chapter);\r\n                    }, (msg)=>{\r\n                        if (-1 === msg.indexOf('code=87')) { // 账号未登录\r\n                            Dialog.error(msg);\r\n                        } else { // 未购买此章节\r\n                            if(flashvars.wap === 'zxwwap'){\r\n                                Dialog.info('当前为收费章节，是否前往闪艺抢先体验？').then(()=>{\r\n                                    window.location.href = 'https://wap.3000.com/?m=detail&op=index&ac=index&id='+ flashvars.gid;\r\n                                })\r\n                            }else{\r\n                                Dialog.info('当前为收费章节，请前往闪艺app或电脑端进行购买');\r\n\t\t\t\t\t\t\t}\r\n                        }\r\n                        this.coverLayer.visible = true;\r\n                    })\r\n\t\t\t\t}\r\n            } else {\r\n                this.preloadChapterAssets(this.context, chapter);// 播放剧情\r\n\t\t\t}\r\n            this.coverLayer.visible = false;\r\n        },\r\n\t\tonCoverLoadBtnClicked: function () {\r\n\t\t\tthis.showLoad();\r\n\t\t},\r\n\t\tonCoverSettingBtnClicked: function () {\r\n\t\t\tthis.showSettings(this.context)\r\n\t\t},\r\n\t\tonCoverOverBtnClicked: function () {\r\n\t\t\tif(flashvars.app_version && (flashvars.client === \"ios\" || flashvars.client === \"android\")){\r\n\t\t\t\t//点击结束按钮，app端，点击无效\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n            if (navigator.userAgent.indexOf(\"MSIE\") > 0) {\r\n                if (navigator.userAgent.indexOf(\"MSIE 6.0\") > 0) {\r\n                    window.opener = null;\r\n                    window.close();\r\n                } else {\r\n                    window.open('', '_top');\r\n                    window.top.close();\r\n                }\r\n            }\r\n            else if (navigator.userAgent.indexOf(\"Firefox\") > 0) {\r\n                window.location.href = 'about:blank ';\r\n            } else {\r\n                //open(location, '_self').close();\r\n                window.opener = null;\r\n                window.open(\"\", \"_self\");\r\n                window.close();\r\n            }\r\n\t\t},\r\n\r\n\t\tonMenuBtnClicked: function () {\r\n\t\t\tthis.getSnap();\r\n\t\t\t//this.onPause();\r\n\t\t\tthis.showMainMenu(this.context)\r\n\t\t},\r\n\t\tonSyMenuBtnClicked: function () {\r\n\t\t\tif(flashvars.client === 'wap'){\r\n                this.context.fullScreen && this.onSettingsWindowModeBtnClicked();\r\n                window.parent && window.parent.closGame();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (flashvars.client === 'ios' || flashvars.client === 'android') {\r\n\t\t\t\tif(this.isWapOther()){\r\n                    this.context.fullScreen && this.onSettingsWindowModeBtnClicked();\r\n                    ShanyiMenu.showSyMenu().then(v => {\r\n                        if (1 !== v) {\r\n                            if (typeof v === 'string' && -1 !== v.indexOf('http')) {\r\n                                window.location.href = v;\r\n                            }\r\n                        }\r\n                    });\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (flashvars.app_version < '1.2.0') {\r\n\t\t\t\t\tDialog.info('版本过低，不支持该功能');\r\n\t\t\t\t} else {\r\n                    window.app && window.app.moreWorks();\r\n                }\r\n\t\t\t} else {\r\n                this.context.fullScreen && this.onSettingsWindowModeBtnClicked();\r\n                ShanyiMenu.showSyMenu().then(v => {\r\n                \tif (1 !== v) {\r\n                          if (typeof v === 'string' && -1 !== v.indexOf('http')) {\r\n                            window.location.href = v;\r\n                        }\r\n                \t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n        },\r\n\r\n\t\tonMainMenuSaveBtnClicked: function () {\r\n            if (!this.context.disableSaveOrLoad || !this.context.disableSaveOrLoad.save) {\r\n                this.showSave();\r\n            } else {\r\n                this.showToast(1, '抱歉，作者在此设置了禁用存档');\r\n            }\r\n\t\t},\r\n\t\tonMainMenuLoadBtnClicked: function () {\r\n\t\t\tif (!this.context.disableSaveOrLoad || !this.context.disableSaveOrLoad.load) {\r\n                this.showLoad();\r\n\t\t\t} else {\r\n\t\t\t\tthis.showToast(1, '抱歉，作者在此设置了禁用读档');\r\n\t\t\t}\r\n\t\t},\r\n\t\tonMainMenuPlaybackBtnClicked: function () {\r\n\t\t\tthis.showPlayback();\r\n\t\t},\r\n\t\tonMainMenuAutoplayBtnClicked: function () {\r\n\t\t\tthis.context.auto = !this.context.auto;\r\n\t\t\tthis.onMainMenuBackBtnClicked();\r\n\t\t},\r\n\t\tonMainMenuSettingsBtnClicked: function () {\r\n\t\t\tthis.showSettings(this.context);\r\n\t\t},\r\n\t\tonMainMenuBackBtnClicked: function () {\r\n\t\t\tthis.mainMenuLayer.visible = false;\t\t\t// 隐藏主菜单层\r\n\t\t\tthis.onResume();\r\n\t\t\tif (this.context.auto) {\r\n\t\t\t\tthis.curPlotLayer.onChildInputDown.dispatch('auto');\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tonSettingsFullModeBtnClicked: function () {\r\n\t\t\tthis.viewComponent.game.scale.startFullScreen(false);\r\n\t\t\tthis.context.fullScreen = true;\r\n\t\t},\r\n\t\tonSettingsWindowModeBtnClicked: function () {\r\n\t\t\tthis.viewComponent.game.scale.stopFullScreen();\r\n\t\t\tthis.context.fullScreen = false;\r\n\t\t},\r\n\t\tonSettingsAutoOnBtnClicked: function () {\r\n\t\t\tthis.context.auto = true;\r\n\t\t},\r\n\t\tonSettingsAutoOffBtnClicked: function () {\r\n\t\t\tthis.context.auto = false;\r\n\t\t},\r\n\t\tonSettingsBackBtnClicked: function () {\r\n\t\t\tthis.visibleLayout[0] && (this.visibleLayout[0].visible = true);\r\n            if (this.visibleLayout[0] !== this.mainMenuLayer) {\r\n                this.onResume();\r\n            }\r\n\t\t\tthis.visibleLayout = this.visibleLayout.slice(1);\r\n\t\t\tthis.settingsLayer.visible = false;\r\n\t\t},\r\n\r\n\t\tonRecordBackBtnClicked: function () {\r\n\t\t\tthis.visibleLayout[0] && (this.visibleLayout[0].visible = true);\r\n            if (this.visibleLayout[0] !== this.mainMenuLayer) {\r\n                this.onResume();\r\n            }\r\n\t\t\tthis.visibleLayout = this.visibleLayout.slice(1);\r\n\t\t\tthis.recordLayer.visible = false;\r\n\r\n\t\t\tthis.showMenu();\r\n            this.cmdPlotNextPromise && this.cmdPlotNextPromise();\r\n\t\t},\r\n\t\tonRecordLocalBtnClicked: function () {\r\n\t\t\tthis.bCloudSel = false;\r\n\t\t\tthis.bToSaveFile ? this.showSave(true) : this.showLoad(true);\r\n        },\r\n\t\tonRecordCloudBtnClicked: function () {\r\n\t\t\tthis.bCloudSel = true;\r\n            this.bToSaveFile ? this.showSave(true) : this.showLoad(true);\r\n        },\r\n\r\n\t\tshowMenu: function () {\r\n            // 显示菜单层\r\n            this.menuLayer.visible = true;\r\n            if (this.curPlotInfo && this.curPlotInfo.menu) {\r\n                this.menuLayer.visible = !this.curPlotInfo.menu.hidden;\r\n            }\r\n        },\r\n\r\n\t\tshowGuideTip:function (index) {\r\n\t\t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_SHOW_GUIDE,{id:index})\r\n        },\r\n\r\n\t\tisSignedIn: function () {\r\n\t\t\treturn this.loadCloudRecord(99).then(rs => {\r\n\t\t\t\tconst convertCloudData = (data) => {\r\n\t\t\t\t\tlet cdata = JSON.parse(data);\r\n\t\t\t\t\tlet rdata = Array(12);\r\n\r\n\t\t\t\t\tfor (let i=0; i<cdata.length; i++) {\r\n                        if (!cdata[i].plotUuid) {\r\n                        \trdata[i] = {};\r\n                        \tcontinue\r\n                        }\r\n                        else {\r\n                        \tlet strTS = '' + cdata[i].time_stamp;\r\n                        \trdata[i] = {};\r\n                        \trdata[i].plotUuid = cdata[i].plotUuid;\r\n                        \trdata[i].timestamp = strTS.length > 10 ? cdata[i].time_stamp : cdata[i].time_stamp * 1000;\r\n                        \trdata[i].plotSnap = 'data:image/jpeg;base64,' + cdata[i].plot_snap;\r\n                        }\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn rdata;\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthis.bSignedIn = true;\r\n\t\t\t\tthis.cloudPlotsData = rs === ''? Array(12).fill({}) : convertCloudData(rs);\r\n\t\t\t\treturn this.getPayInfo().then(() => this.getAccountInfo()).then(() => {return Promise.resolve()});\r\n\t\t\t\t}\r\n\t\t\t, rj => {\r\n\t\t\t\tthis.bSignedIn = false;\r\n\t\t\t\treturn Promise.reject(rj);\r\n\t\t\t\t});\r\n        },\r\n\r\n\t\tfindFirstChapter: function () {\r\n\t\t\tconst checkChapter = chapter => {\r\n\t\t\t\tif (chapter.plots.length > 0 || chapter.md5) {\r\n\t\t\t\t\tchapter.isFirst = true;\r\n\t\t\t\t\treturn chapter;\r\n                }\r\n\t\t\t\tfor (let i=0; i<chapter.subchapters.length; i++) {\r\n\t\t\t\t\tconst result = checkChapter(chapter.subchapters[i]);\r\n\t\t\t\t\tif (result) {\r\n\t\t\t\t\t\treturn result;\r\n                    }\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t};\r\n\r\n\t\t\tfor (let i=0; i<this.json_data.chapters.length; i++) {\r\n\t\t\t\tconst result = checkChapter(this.json_data.chapters[i]);\r\n\t\t\t\tif (result) return result;\r\n\t\t\t}\r\n\r\n\t\t\treturn this.json_data.chapters[0];\r\n        },\r\n\r\n\t\tnotifyGameStarted: function () {\r\n\t\t\tif (flashvars.app_version && flashvars.app_version < '1.3.0') {\r\n                this.isGameStarted = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.isGameStarted = true;\r\n            if (flashvars.client === 'ios') {\r\n                if(flashvars.offline == 1){\r\n                    javascript:gameStart('1');\r\n                }else{\r\n                    window.webkit && window.webkit.messageHandlers.gameStart.postMessage('1');\r\n                }\r\n            }\r\n            else if (flashvars.client === 'android') {\r\n                window.app && window.app.gameStart('1');\r\n            }\r\n            else if (this.isWap3000()) {\r\n                Xhr.xhrLoad('https://www.3000.com/apis/client/v1.0/trace-play.html?id=' + flashvars.gid + '&from=wap', '', null);\r\n\t\t\t}\r\n        },\r\n\r\n        updateAccInfo: function (bLogout, bEntering) {\r\n            if (!this.context) {\r\n                this.context = {};\r\n            }\r\n            this.getPayInfo().then((rs)=>{\r\n                /*if(Object.prototype.toString.apply(rs) !== '[object String]'){\r\n                \t//失败\r\n\t\t\t\t\tthis.savePayInfo();//保存一份数据\r\n\t\t\t\t}*/\r\n\t\t\t\tthis.getAccountInfo().then((rs)=>{\r\n                    if (bEntering) {\r\n                        this.sendNotification( diygamePlayer.AppConstants.SCENE_PRELOADING_PROGRESS);\r\n                    }\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\tlocalRecFileToUidRecFile: function (bLocalCloudSwitch) {\r\n            const recId = flashvars.uuid + flashvars.uid;\r\n            const userData = Utils.localStorageGetItem(recId);\r\n            const savedData = Utils.localStorageGetItem(flashvars.uuid);\r\n            if (!userData && savedData) {\r\n                Utils.localStorageSetItem(recId, savedData);\r\n                Utils.localStorageRemoveItem(flashvars.uuid);\r\n            }\r\n            if (!bLocalCloudSwitch) {\r\n                if (this.recordLayer && this.recordLayer.visible) {\r\n                    this.bSwitchAccInPlot = false;\r\n                } else {\r\n                    this.bSwitchAccInPlot = true;\r\n                }\r\n            }\r\n            if (this.gameUidBelongTo === '' && flashvars.uid !== '') {\r\n                this.gameUidBelongTo = flashvars.uid;\r\n            }\r\n        },\r\n\r\n\t\tgetFansInfo: function () {\r\n\t\t\tif ('ios' !== flashvars.client && 'android' !== flashvars.client && flashvars.client !== 'wap') {\r\n\t\t\t\tflashvars.uid = Utils.getUidByCookie();\r\n\t\t\t}\r\n            const getData = (url)=>{\r\n                return Xhr.xhrLoad(url, '',null,false).then(rs => {\r\n                    if (rs.responseText.length === 0) {\r\n                        return Promise.resolve('Get Fans Count failed, no response data');\r\n                    }\r\n                    const data = JSON.parse(rs.responseText);\r\n                    this.context.systemValues[9].value = data.data.fans_total;\r\n                    return Promise.resolve(this.context.systemValues);\r\n                }, rj => {\r\n                    return Promise.resolve('跨域了('+rj+')');\r\n                })\r\n            }\r\n            let url = 'https://pay.3000.com/?m=payinterface&op=player_one_opus_fans&opus_id=' + flashvars.gid + '&uid=' + flashvars.uid;\r\n            if(flashvars.client === 'wap'){\r\n                return this.getUserInfoFromWap().then(()=>{\r\n                    url = 'https://pay.3000.com/?m=payinterface&op=player_one_opus_fans&opus_id=' + flashvars.gid + '&uid=' + flashvars.uid;\r\n\t\t\t\t\treturn getData(url);\r\n                })\r\n            }else{\r\n                return getData(url);\r\n\t\t\t}\r\n\t\t},\r\n        /**\r\n\t\t * 保存账户信息 systemvalue\r\n         */\r\n\t\tsaveAccountInfo:function () {\r\n            const sendData = (systemvalue) => {\r\n                //保存消费数据和 系统数值到本地  和apk中\r\n                return new Promise((resolve,reject)=>{\r\n                    window.app && window.app.saveGameValue(flashvars.uuid + 'systemInfo',systemvalue);\r\n                    Utils.localStorageSetItem(flashvars.uuid + 'systemInfo', systemvalue);\r\n                    return resolve();\r\n                })\r\n            };\r\n            const systemvaluestr = JSON.stringify(this.context.systemValues);\r\n            const systemvalueBase64 = Utils.encodeBase64(systemvaluestr);\r\n            return sendData(systemvalueBase64);\r\n        },\r\n        /**\r\n\t\t * 获取账户信息 systemvalue\r\n         */\r\n        getAccountInfo: function () {\r\n            const getData = () => {\r\n            \treturn new Promise((resolve,reject)=>{\r\n            \t\tlet systemData;\r\n                    if(window.app){\r\n                        systemData = window.app.readGameValue(flashvars.uuid + 'systemInfo')\r\n                    }\r\n                    if(systemData === null){\r\n                        systemData = Utils.localStorageGetItem(flashvars.uuid + 'systemInfo');\r\n                    }\r\n                    if(systemData){\r\n                        let values = JSON.parse(Utils.decryptBase64(systemData));\r\n                        for(let i = 0;i < values.length;i++){\r\n                            for(let j = 0;j < this.context.systemValues.length;j++){\r\n                                if (this.context.systemValues[j].uuid === values[i].uuid) {\r\n                                    this.context.systemValues[j].value = (values[i].value === undefined ? this.context.systemValues[j].init.value : values[i].value);\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                        return resolve(this.context.systemValues);\r\n\t\t\t\t\t}else{\r\n                        for(let i = 0;i < this.context.systemValues.length;i++){\r\n                            this.context.systemValues[i].value = this.context.systemValues[i].init.value;\r\n                        }\r\n                        return resolve('失败')\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t})\r\n            };\r\n            if (!this.context.systemValues) {\r\n                this.context.systemValues = [{name: '闪币余额', uuid: '', key:'coinTotal', init: { type: 'system', value: 0 }}\r\n                , {name: '星星余额', uuid: '', key:'starTotal', init: { type: 'system', value: 0}}\r\n                , { name: '时间戳', uuid: '', key:'timestamp', init: { type: 'system', value: -1 }}\r\n                , { name: '当前年', uuid: '', key:'year', init: { type: 'system', value: -1 } }\r\n                , { name: '当前月', uuid: '', key:'month', init: { type: 'system', value: -1 } }\r\n                , { name: '当前日', uuid: '', key:'day', init: { type: 'system', value: -1 } }\r\n                , { name: '当前小时', uuid: '', key:'hour', init: { type: 'system', value: -1 } }\r\n                , { name: '当前分钟', uuid: '', key:'minute', init: { type: 'system', value: -1 } }\r\n                , { name: '当前秒', uuid: '', key:'second', init: { type: 'system', value: -1 } }\r\n                , { name: '贡献值', uuid: '', key:'contribution', init: { type: 'system', value: 0 } }\r\n                , { name: '星期', uuid: '', key:'weekday', init: {type: 'system', value: 0 } } ];\r\n        \t}\r\n            return getData();\r\n        },\r\n        /**\r\n\t\t * 获取消费数值\r\n         */\r\n        getPayInfo: function () {\r\n            const getData = () => {\r\n            \treturn new Promise((resolve,reject)=>{\r\n                    let payInfoData = null;\r\n                    if(window.app){\r\n                        payInfoData = window.app.readGameValue(flashvars.uuid + 'payInfo')\r\n                    }\r\n                    if(payInfoData === null){\r\n                        payInfoData = Utils.localStorageGetItem(flashvars.uuid + 'payInfo');\r\n                    }\r\n                    if(payInfoData){\r\n                        let values = JSON.parse(Utils.decryptBase64(payInfoData));\r\n                        for (let i=0; i<values.length; i++) {\r\n                            for (let j=0; j<this.json_data.payValues.length; j++) {\r\n                                if (this.json_data.payValues[j].uuid === values[i].uuid) {\r\n                                    if(values[i].value === undefined){\r\n                                        values[i].value = values[i].init.value || 0;\r\n                                    }\r\n                                    this.context.payValues[j] = values[i];\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                        return resolve(this.context.payValues)\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\treturn resolve('失败')\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n            };\r\n            if (!this.context.payValues) {\r\n                this.context.payValues = [{name: '消费数值1',\r\n                    uuid: '',\r\n                    init: { type: 'const', value: 0 },\r\n\t\t\t\t\tvalue: 0\r\n                }];\r\n            }\r\n            return getData();\r\n        },\r\n        /**\r\n\t\t * 保存消费数值\r\n         */\r\n        savePayInfo: function () {\r\n            const sendData = (payvalue) => {\r\n            \t//保存消费数据和 系统数值到本地  和apk中\r\n            \treturn new Promise((resolve,reject)=>{\r\n                    window.app && window.app.saveGameValue(flashvars.uuid + 'payInfo',payvalue);\r\n                    Utils.localStorageSetItem(flashvars.uuid + 'payInfo', payvalue);\r\n                    return resolve();\r\n\t\t\t\t})\r\n            };\r\n            const payvaluestr = JSON.stringify(this.context.payValues);\r\n            const payvaluesBase64 = Utils.encodeBase64(payvaluestr);\r\n            return sendData(payvaluesBase64);\r\n        },\r\n        //获取商品支付信息\r\n        getPayGoodsInfo:function (goodsid) {\r\n            return this.loadCloudRecord(99).then(rs=>{\r\n                //已登入\r\n                const getData = (url,d)=>{\r\n                    return Xhr.xhrSend(url,d,null,4000).then((rs)=>{\r\n                        if(rs.responseText.length === 0){\r\n                            return Promise.resolve({status:\"error\",msg:\"获取商品支付信息失败\",count:0});\r\n                        }\r\n                        let retData = JSON.parse(rs.responseText);\r\n                        if(retData.status === 0){\r\n                            if(retData.success && retData.data){\r\n                                //成功\r\n                                return Promise.resolve({status:\"success\",msg:retData.msg,count:retData.data.count})\r\n                            }else{\r\n                                //失败\r\n                                return Promise.resolve({status:\"fail\",msg:retData.msg,count:0})\r\n                            }\r\n                        }\r\n                        //无status非0状态或无status\r\n                        return Promise.resolve({status:\"fail\",msg:retData.msg,count:0})\r\n                    },(rj)=>{\r\n                        return Promise.resolve({status:\"error\",msg:\"获取商品支付信息失败\",count:0})\r\n                    })\r\n                };\r\n                //post表单数据处理\r\n                const formatdata = (d) =>{\r\n                    let ary = [];\r\n                    let i = 0;\r\n                    for(let dd in d){\r\n                        ary[i] = encodeURIComponent(dd) + \"=\" + encodeURIComponent(d[dd]);\r\n                        i++;\r\n                    }\r\n                    return ary.join(\"&\");\r\n                }\r\n                let url = \"https://pay.3000.com/?m=player&op=h5_purchase_market_count\";\r\n                let data = {\r\n                    event_id:Utils.aesEncrypt(goodsid,3)\r\n                    ,game_id:Utils.aesEncrypt(flashvars.gid,3)\r\n                }\r\n                if (flashvars.client === 'ios' || flashvars.client === 'android') {\r\n                    url = 'https://app.3000.com/?m=consume&op=index&ac=h5_purchase_market_count&client=' + flashvars.client +'&v=' + flashvars.v + '&app_version=' + flashvars.app_version;\r\n                    data = {\r\n                        u:Utils.aesEncrypt(flashvars.u, 1)\r\n\t\t\t\t\t\t,token:Utils.aesEncrypt(flashvars.token, 1)\r\n                        ,event_id:Utils.aesEncrypt(goodsid,1)\r\n                        ,game_id:Utils.aesEncrypt(flashvars.gid,1)\r\n                    }\r\n                }\r\n\r\n                return getData(url,formatdata(data));\r\n            },rj=>{\r\n                //未登入 提示登入;\r\n                let n = rj.indexOf('- status:-1');\r\n                n = n >= 0 ? n : rj.indexOf('- status:2');\r\n                if (n >= 0) {\r\n                    if (flashvars.client !== 'ios' && flashvars.client !== 'android' && flashvars.client !== 'wap') {\r\n                    \t//pc端未登入，直接提示去购买\r\n                        return Promise.resolve({status:\"success\",msg:\"pc端未登入，直接提示去购买！\",count:-1})\r\n                    }\r\n                    if(rj.indexOf('- status:-110') > 0){ //访问频繁\r\n                        Dialog.error(rj.substr(0, n)).then(()=>{\r\n                        \tthis.isPaying = false;\r\n                            return Promise.reject();\r\n\t\t\t\t\t\t},()=>{\r\n                        \tthis.isPaying = false;\r\n                            return Promise.reject();\r\n                        })\r\n                    }else{\r\n                        //调用登入界面\r\n                        if (flashvars.app_version >= '1.2.0') {\r\n                            window.location.href = 'lzj3000://logout';\r\n                        }\r\n                        if(flashvars.client === 'wap'){\r\n                            this.isPaying = false;\r\n                            window.parent && window.parent.playLogin();\r\n                        }else{\r\n                            Dialog.error(rj.substr(0, n)).then(()=>{\r\n                                this.isPaying = false;\r\n                                window.location.href = 'lzj3000://login';\r\n                            },()=>{\r\n                                this.isPaying = false;\r\n                            })\r\n                        }\r\n\t\t\t\t\t}\r\n                    return Promise.reject();\r\n                } else if (0 <= rj.indexOf('error')) {\r\n                    Dialog.error('网络异常，请检查您的网络！').then(()=>{\r\n                    \tthis.isPaying = false;\r\n                        return Promise.reject();\r\n\t\t\t\t\t},()=>{\r\n                    \tthis.isPaying = false;\r\n                        return Promise.reject();\r\n                    });\r\n                }\r\n            })\r\n        },\r\n\r\n\t\tgetDiscounts: function (gameId, chapterUuid, productId, platform) {\r\n\t\t\tconst getData = (url) => {\r\n                return Xhr.xhrLoad(url, '').then(rs => {\r\n                    if (rs.responseText.length === 0) {\r\n                        return Promise.resolve('Get Discounts failed, no response data');\r\n                    }\r\n                    const data = JSON.parse(rs.responseText);\r\n                    return Promise.resolve(data.result);\r\n                }, rj => {\r\n                    return Promise.resolve('获取商品价格失败！');\r\n\t\t\t\t})\r\n\t\t\t};\r\n\t\t\tlet data = 'uuid=' + gameId + (chapterUuid ? '&chapter_uuid=' + chapterUuid : '&product_id=' + productId) + '&platform=' + platform;\r\n            if(this.isWapOther()){\r\n                data += \"&key=external\";\r\n            }\r\n\t\t\tlet url = 'https://mapi.3000api.com/apis/soft/v1.0/game-getCharge.html?' + data;\r\n\r\n\t\t\treturn getData(url);\r\n        },\r\n\r\n        payOperation: function (price, goodsId, indentId, callback) {\r\n\t\t\tthis.isPaySuccess = false;\r\n\t\t\tlet disCounts = -1;\r\n\t\t\tconst invokeApp = () => {\r\n                let payArg = {gid: flashvars.gid, eid: goodsId, charge: price\r\n\t\t\t\t\t, special_price: disCounts\r\n                    , balance: this.context.systemValues[0].value\r\n                    , starsNeed: price * 100\r\n                    , stars: this.context.systemValues[1].value\r\n                    , starsUsed: this.usedStarCount\r\n                    , starsLimited: this.gameStarLimit\r\n                    , payValues: Utils.encodeBase64(JSON.stringify(this.context.payValues))\r\n                    , indentId: indentId};\r\n\r\n                if (flashvars.client === 'ios') {\r\n                    this.mallPayCallback = callback;\r\n                    if(flashvars.offline == 1){\r\n                        javascript:worksmall(JSON.stringify(payArg));\r\n                    }else{\r\n                        window.webkit && window.webkit.messageHandlers.worksmall.postMessage(JSON.stringify(payArg));\r\n                    }\r\n                }\r\n                else if (flashvars.client === 'android') {\r\n                    this.mallPayCallback = callback;\r\n                    window.app && window.app.worksmall(JSON.stringify(payArg));\r\n                }\r\n                else if(flashvars.client === 'wap'){\r\n                    this.mallPayCallback = callback;\r\n                    payArg.consume_falg = 'mall'\r\n\t\t\t\t\tpayArg.uuid = flashvars.uuid;\r\n                    window.parent && window.parent.get_account_info(JSON.stringify(payArg));\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n            if (flashvars.client === 'android' || flashvars.client === 'ios' || flashvars.client === 'wap') {\r\n                if (flashvars.app_version < '1.2.0' && flashvars.client !== 'wap') {\r\n                \tDialog.info('版本过低不支持改功能，请先更新版本~').then(()=>{this.isPaying = false},()=>{this.isPaying = false});\r\n                \treturn Promise.resolve(disCounts);\r\n                }\r\n            \treturn this.getAccountInfo().then(info => {\r\n            \t\tif (typeof info === 'string') {\r\n            \t\t\tDialog.error('网络异常，请检查您的网络！');\r\n            \t\t\tcallback(false);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (info.status && info.status>0 && info.status<9) {\r\n            \t\t\tif (flashvars.app_version >= '1.2.0') {\r\n                            window.location.href = 'lzj3000://logout';\r\n\t\t\t\t\t\t}\r\n                        if(flashvars.client === 'wap'){\r\n                            window.parent && window.parent.playLogin();\r\n                        }else{\r\n                            Dialog.info(info.msg).then(() => {\r\n                                window.location.href = 'lzj3000://login';\r\n                            });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcallback(false);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (100 === info.status && !info.success) {\r\n                        callback(false);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n                        return this.getDiscounts(flashvars.uuid, null, goodsId, 'app').then(info => {\r\n                            if (typeof info === 'string') {\r\n                                Dialog.error(info);\r\n                                callback(false);\r\n                            }\r\n                            else {\r\n                            \tprice = info.charge;\r\n                            \tdisCounts = info.special_price;\r\n                                invokeApp();\r\n                            }\r\n                            return Promise.resolve(disCounts);\r\n                        });\r\n\t\t\t\t\t}\r\n                    return Promise.resolve(disCounts);\r\n\t\t\t\t})\r\n            }\r\n            else {\r\n                Dialog.info('请前往APP或电脑端购买~').then(null,null);\r\n                return Promise.resolve(disCounts);\r\n            }\r\n        },\r\n\r\n\t\tchapterInfoProgress: function (prgsInfo) {\r\n            let group = this.viewComponent.game.world.getByName('chapterInfoProgress');\r\n            if (!group) {\r\n                group = this.viewComponent.game.add.group();\r\n                group.name = 'chapterInfoProgress';\r\n\r\n                let background = this.viewComponent.game.add.graphics(0, 0, group);\r\n                background.beginFill(0x0, 0.5);\r\n                background.drawRect(0, 0, this.viewComponent.game.world.width, this.viewComponent.game.world.height);\r\n                background.endFill();\r\n                background.name = 'background';\r\n                background.inputEnabled = true;\r\n\r\n                let style = { font: \"16px 宋体\", fill: \"#fff\", boundsAlignH: \"center\", boundsAlignV: \"middle\" };\r\n\t\t\t\tlet text = this.viewComponent.game.add.text(0, 0, \"\", style, group);\r\n\t\t\t\ttext.setTextBounds(0, 0, this.viewComponent.game.world.width, this.viewComponent.game.world.height);\r\n\t\t\t\ttext.name = 'chapterInfoProgressText';\r\n            }\r\n            let txt = group.getByName('chapterInfoProgressText');\r\n            if (txt) {\r\n            \ttxt.text = '章节信息获取中...' + prgsInfo;\r\n\t\t\t}\r\n        },\r\n\r\n\t\tcheckIfChapterFree: function (chapterUuid, chapterMd5, showProgress = true) {\r\n            const getData = (url, d) => {\r\n            \tconst progress = evt => {\r\n            \t\tshowProgress && this.chapterInfoProgress(evt.loaded);\r\n\t\t\t\t}\r\n                return Xhr.xhrSend(url, d, progress).then(rs => {\r\n                    let group = this.viewComponent.game.world.getByName('chapterInfoProgress');\r\n                    if (group) {\r\n                    \tgroup.destroy();\r\n\t\t\t\t\t}\r\n                    if (rs.responseText.length === 0) {\r\n                        return Promise.reject('Get chapterInfo failed, no response data');\r\n                    }\r\n                    let retData = JSON.parse(rs.responseText);\r\n                    if (retData.code === '100') {\r\n                        return Promise.resolve(retData.result.plots);\r\n                    }\r\n                    else if (flashvars.offline == 1) {\r\n                        return Promise.resolve(retData.plots);\r\n                    }\r\n                    else {\r\n                        return Promise.reject(retData.message + ' code=' + retData.code);\r\n                    }\r\n                }, rj => {\r\n                    let group = this.viewComponent.game.world.getByName('chapterInfoProgress');\r\n                    if (group) {\r\n                        group.destroy();\r\n                    }\r\n                    return Promise.reject(rj);\r\n                });\r\n            };\r\n            const get =()=>{\r\n                if (!flashvars.u && !flashvars.token && flashvars.client !== 'wap') {\r\n                    flashvars.uid = Utils.getUidByCookie();\r\n                }\r\n                let data = 'uuid=' + flashvars.uuid + '&uid=' + flashvars.uid + '&chapter_uuid=' + chapterUuid + '&md5=' + chapterMd5 + '&platform=' + (flashvars.client ? 'app' : 'pc');\r\n                if(this.isWapOther()){\r\n                    data += \"&key=external\";\r\n                };\r\n                let url = 'https://mapi.3000api.com/apis/soft/v1.0/chapter-chapterInfo.html?' + data;\r\n                return getData(url, data);\r\n\t\t\t}\r\n\r\n            if(flashvars.client === 'wap'){\r\n                if(flashvars.uid === ''){ //uid不存在\r\n                    return this.getUserInfoFromWap().then(()=>{\r\n\t\t\t\t\t\treturn get();\r\n\t\t\t\t\t})\r\n                }else{\r\n                    return get();\r\n\t\t\t\t}\r\n            }else{\r\n\t\t\t\treturn get();\r\n\t\t\t}\r\n\r\n        },\r\n\t\t/**第三方解锁章节*/\r\n\t\tunlockChapterByWapOther:function (uuid, charge, md5, callBack) {\r\n            if(this.isWapOther()){\r\n            \tlet getcount = 0;//请求次数\r\n                //支付\r\n                const pay = (game_uuid,chapter_uuid,charge,payback)=>{\r\n                    let discounts = -1;\r\n                    this.getDiscounts(game_uuid, chapter_uuid, null, 'app').then(info =>{\r\n                        if (typeof info !== 'string') {\r\n                            charge = info.charge;\r\n                            discounts = info.special_price;\r\n                        }\r\n                        const generateuuid = Utils.generateUUID();//生成一个订单搬好\r\n                        Utils.timeout(100).then(()=>{\r\n                            Dialog.custom(\"Info\",\"当前为收费章节，需支付\"+ charge +\"元解锁观看\",\"章节收费提示\",\"支付\",\"取消\",false).then((msg)=>{\r\n                                OtherWap.pay(charge,chapter_uuid,generateuuid,chapter_uuid,null,0,(msg)=>{\r\n                                    if(payback) payback(msg);\r\n                                });\r\n                            },(msg1)=>{\r\n                                if(payback) payback(\"cancel\")\r\n                            })\r\n                        })\r\n                    })\r\n                };\r\n                //购买返回\r\n                const payback = (msg)=>{\r\n\t\t\t\t\tif(msg === \"success\"){\r\n\t\t\t\t\t\t//成功\r\n                        getchapterinfo(uuid,md5,charge)\r\n\t\t\t\t\t}else if(msg === \"cancel\"){\r\n                        if(callBack)callBack(null);\r\n\t\t\t\t\t}else if(msg === \"fail\"){\r\n\t\t\t\t\t\t//失败\r\n\t\t\t\t\t\tDialog.custom(\"Info\",\"未查询到你的付费信息哦，请确认已支付再点击刷新。如未购买请退出或重新购买~\",\"提示\",\"重试\",\"退出\",false,3,0).then(()=>{\r\n                                getchapterinfo(uuid,md5,charge);\r\n                            },()=>{\r\n                                if(callBack)callBack(null);\r\n                            })\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n            \t//获取章节数据\r\n\t\t\t\tconst getchapterinfo = (chapter_uuid, chapter_md5,chaptercharge)=>{\r\n                    getcount ++;\r\n\t\t\t\t\tthis.checkIfChapterFree(chapter_uuid,chapter_md5).then((info)=>{\r\n\t\t\t\t\t\t//成功有数据\r\n                        if(callBack)callBack(info);\r\n\t\t\t\t\t},(msg)=>{\r\n                        //章节需要付费\r\n                        if (-1 === msg.indexOf('code=87')) {\r\n                            Dialog.error(msg).then(()=>{ if(callBack)callBack(null)},()=>{ if(callBack)callBack(null)});\r\n                        } else { // 未购买此章节\r\n\t\t\t\t\t\t\tif(getcount <=1){\r\n                                pay(flashvars.uuid,chapter_uuid,chaptercharge,payback)\r\n\t\t\t\t\t\t\t}else{\r\n                                if(getcount <4){\r\n                                \tpayback(\"fail\")\r\n                                }else{\r\n                                    if(callBack)callBack(\"fail\");\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n                        }\r\n                    })\r\n\t\t\t\t}\r\n                getchapterinfo(uuid,md5,charge,callBack);\r\n\r\n                /*let discounts = -1;\r\n                this.getDiscounts(flashvars.uuid, uuid, null, 'app').then(info => {\r\n                    if (typeof info !== 'string') {\r\n                        charge = info.charge;\r\n                        discounts = info.special_price;\r\n                    }\r\n                    const generateuuid = Utils.generateUUID();//生成一个订单搬好\r\n                    Utils.timeout(100).then(()=>{\r\n                        Dialog.custom(\"Info\",\"当前为收费章节，需支付\"+ charge +\"元解锁观看\",\"章节收费提示\",\"支付\",\"取消\",false).then((msg)=>{\r\n                            OtherWap.pay(charge,uuid,generateuuid,uuid,null,0,()=>{\r\n                                if(callBack) callBack();\r\n                            });\r\n                        },(msg1)=>{\r\n                            if(callBack) callBack()\r\n                        })\r\n                    })\r\n                })*/\r\n            }\r\n        },\r\n\t\t/**解锁章节*/\r\n        unlockChapter: function (uuid, charge, md5, callBack, showDialog = true) {\r\n            if (flashvars.app_version < '1.2.0' && flashvars.client !== 'wap') {\r\n                showDialog && Dialog.info('该章节为付费章节，当前版本过低，不支持该功能');\r\n                callBack(false, true);\r\n                return;\r\n            }\r\n            let discounts = -1;\r\n            this.getDiscounts(flashvars.uuid, uuid, null, 'app').then(info => {\r\n            \tif (typeof info !== 'string') {\r\n            \t\tcharge = info.charge;\r\n                    discounts = info.special_price;\r\n\t\t\t\t}\r\n                if (flashvars.client === 'ios') {\r\n                    let unlockArg = {gid: flashvars.gid, uuid: uuid, charge: charge, md5: md5, special_price: discounts};\r\n                    this.unlockChapterCallBack = callBack;\r\n                    if(flashvars.offline == 1){\r\n                        javascript:unlock(JSON.stringify(unlockArg));\r\n                    }else{\r\n                        window.webkit && window.webkit.messageHandlers.unlock.postMessage(JSON.stringify(unlockArg));\r\n                    }\r\n                }\r\n                else if (flashvars.client === 'android') {\r\n                    window.app && window.app.unlock(flashvars.gid, uuid, charge, md5); // 解锁\r\n                    this.unlockChapterCallBack = callBack;\r\n                }else if(flashvars.client === 'wap'){\r\n                    this.unlockChapterCallBack = callBack;\r\n                    const pay=()=>{\r\n                        let wapunlockArg = {uuid:flashvars.uuid,\r\n                            gid: flashvars.gid,\r\n                            chapter_uuid: uuid,\r\n                            charge: charge,\r\n                            md5: md5,\r\n                            special_price: discounts,\r\n                            author_id:flashvars.uid,\r\n                            consume_falg:'chapter'};\r\n                        window.parent && window.parent.get_account_info(JSON.stringify(wapunlockArg));\r\n\t\t\t\t\t}\r\n            \t\tif(flashvars.uid === ''){ //uid不存在 从cookie获取uid\r\n\t\t\t\t\t\tthis.getUserInfoFromWap().then(()=>{\r\n\t\t\t\t\t\t\tif(flashvars.uid === ''){\r\n\t\t\t\t\t\t\t\t//未登入，弹窗提示 该章节为付费章节，需登入后查看~\r\n\t\t\t\t\t\t\t\tDialog.info('该章节为付费章节，需登录后查看~').then(()=>{\r\n                                    callBack(false, true,true);\r\n                                    window.parent && window.parent.playLogin();\r\n\t\t\t\t\t\t\t\t},()=>{\r\n                                    callBack(false, true,true);\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}else{\r\n                                pay();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}else{\r\n            \t\t\tpay();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n            });\r\n        },\r\n\r\n\t\tgetPhoneData: function () {\r\n            let u = encodeURIComponent(Utils.aesEncrypt(flashvars.u, 1));\r\n            let token = encodeURIComponent(Utils.aesEncrypt(flashvars.token, 1));\r\n            let app_name = encodeURIComponent(Utils.aesEncrypt(flashvars.app_name === '' ? 'shanyi' : flashvars.app_name, 1));\r\n            let device_name = encodeURIComponent(Utils.aesEncrypt(flashvars.device_name === '' ? 'Google Nexus S' : flashvars.device_name, 1));\r\n            let deviceOsVer = encodeURIComponent(Utils.aesEncrypt(flashvars.deviceOsVer === '' ? '4.1.1' : flashvars.deviceOsVer, 1));\r\n\r\n            return '&u=' + u + '&token=' + token + '&app_name=' + app_name\r\n                + '&device_name=' + device_name + '&device_system_version=' + deviceOsVer;\r\n        },\r\n\r\n\t\tloadCloudRecord: function (index) {\r\n            return Promise.reject('Get file failed, no response data');\r\n\t\t\t/*const getData = (url, d) => {\r\n\t\t\t\treturn Xhr.xhrSend(url, d).then(rs => {\r\n\t\t\t\t\tif (rs.responseText.length === 0) {\r\n\t\t\t\t\t\treturn Promise.reject('Get file failed, no response data');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet retData = JSON.parse(rs.responseText);\r\n\t\t\t\t\tif (retData.status === 0) {\r\n                        let encrypted = retData.data.content || '';\r\n                        let decrypted = Utils.decryptBase64(encrypted);\r\n                        return Promise.resolve(decrypted);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\treturn Promise.reject(retData.msg + ' - status:' + retData.status);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, rj => {\r\n\t\t\t\t\treturn Promise.reject(rj);\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n            let aesKeyType = flashvars.u && flashvars.token ? 1 : 0;\r\n\t\t\t//let stime = Math.floor((new Date()).getTime() / 1000) + Utils.timeOffset;\r\n\t\t\tlet stime = Utils.localTime + Utils.timeOffset;\r\n\t\t\tlet gid = flashvars.gid === '' ? 1 : parseInt(flashvars.gid);\r\n            let sSign = '';\r\n            let type = index + '';\r\n\r\n            if (aesKeyType) {\r\n                sSign = 'app_name=' + (flashvars.app_name === '' ? 'shanyi' : flashvars.app_name)\r\n\t\t\t\t\t\t+ '&device_name=' + (flashvars.device_name === '' ? 'Google Nexus S' : flashvars.device_name)\r\n\t\t\t\t\t\t+ '&device_system_version=' + (flashvars.deviceOsVer === '' ? '4.1.1' : flashvars.deviceOsVer)\r\n\t\t\t\t\t\t+ '&gid=' + gid + '&time=' + stime + '&token=' + flashvars.token + '&type=' + type + '&u=' + flashvars.u\r\n\t\t\t\t\t\t+ '&v_key=shanyi_WDF#$H*#SJN*&G$&**';\r\n            }\r\n            else {\r\n                sSign = 'gid=' + gid + '&time=' + stime + '&type=' + type + '&v_key=0GjRAtUUoK4BwJGUz73jBa2M';\r\n            }\r\n\r\n\t\t\tgid = Utils.aesEncrypt(gid, aesKeyType);\r\n\t\t\tsSign = Utils.aesEncrypt(MD5.hash(MD5.hash(sSign)), aesKeyType);\r\n\t\t\tstime = Utils.aesEncrypt(stime, aesKeyType);\r\n\t\t\ttype = Utils.aesEncrypt(type, aesKeyType);\r\n\r\n            let url = 'https://my.3000.com/?m=cloud_save&op=index&ac=info&client_type=1&api_v=1.0.0&api_from=webpc';\r\n            let data = 'gid=' + encodeURIComponent(gid) + '&sign=' + encodeURIComponent(sSign) + '&time=' + encodeURIComponent(stime) + '&type=' + encodeURIComponent(type);\r\n\r\n\t\t\tif (flashvars.u !== '' && flashvars.token !== '') {\r\n                url = 'https://app.3000.com/?m=cloud_save&op=index&ac=info&client=' + flashvars.client +'&v=' + flashvars.v + '&app_version=' + flashvars.app_version;\r\n                data += this.getPhoneData();\r\n\t\t\t}\r\n\r\n\t\t\treturn getData(url, data);*/\r\n        },\r\n\r\n\t\tsaveCloudRecord: function (index) {\r\n            const sendData = (url, d) => {\r\n                return Xhr.xhrSend(url, d).then(rs => {\r\n                    if (rs.responseText.length === 0) {\r\n                        return Promise.reject('Save file failed, no response data');\r\n                    }\r\n                    let retData = JSON.parse(rs.responseText);\r\n                    if (retData.status === 0) {\r\n                        return Promise.resolve();\r\n                    }\r\n                    else {\r\n                        return Promise.reject(retData.msg + ': ' + retData.status);\r\n                    }\r\n                }, rj => {\r\n                    return Promise.reject(rj);\r\n                });\r\n            };\r\n\r\n            let aesKeyType = flashvars.u && flashvars.token ? 1 : 0;\r\n            const str = JSON.stringify(this.savedPlotsData[index]);\r\n            const strBase64 = Utils.encodeBase64(str);\r\n            //const stime = Math.floor((new Date()).getTime() / 1000) + Utils.timeOffset;\r\n            const stime = Utils.localTime + Utils.timeOffset;\r\n            const gid = flashvars.gid === '' ? 1 : parseInt(flashvars.gid);\r\n            let\tsSign = '';\r\n\r\n            if (aesKeyType) {\r\n                sSign = 'app_name=' + (flashvars.app_name === '' ? 'shanyi' : flashvars.app_name)\r\n\t\t\t\t\t+ '&content=' + strBase64\r\n                    + '&device_name=' + (flashvars.device_name === '' ? 'Google Nexus S' : flashvars.device_name)\r\n                    + '&device_system_version=' + (flashvars.deviceOsVer === '' ? '4.1.1' : flashvars.deviceOsVer)\r\n\t\t\t\t\t+ '&gid=' + gid + '&progress=1&time=' + stime + '&token=' + flashvars.token + '&type=' + index + '&u=' + flashvars.u\r\n\t\t\t\t\t+ '&v_key=shanyi_WDF#$H*#SJN*&G$&**';\r\n            }\r\n            else {\r\n                sSign = 'content=' + strBase64 + '&gid=' + gid + '&progress=1&time=' + stime + '&type=' + index + '&v_key=0GjRAtUUoK4BwJGUz73jBa2M';\r\n            }\r\n\r\n            let url = 'https://my.3000.com/?m=cloud_save&op=index&ac=save&client_type=1&api_v=1.0.0&api_from=webpc';\r\n            let data = 'content=' + encodeURIComponent(Utils.aesEncrypt(strBase64, aesKeyType))\r\n                + '&gid=' + encodeURIComponent(Utils.aesEncrypt(gid, aesKeyType))\r\n                + '&progress=' + encodeURIComponent(Utils.aesEncrypt(1, aesKeyType))\r\n                + '&sign=' + encodeURIComponent(Utils.aesEncrypt(MD5.hash(MD5.hash(sSign)), aesKeyType))\r\n                + '&time=' + encodeURIComponent(Utils.aesEncrypt(stime, aesKeyType))\r\n                + '&type=' + encodeURIComponent(Utils.aesEncrypt(index+'', aesKeyType));\r\n\r\n            if (flashvars.u !== '' && flashvars.token !== '') {\r\n                url = 'https://app.3000.com/?m=cloud_save&op=index&ac=save&client=' + flashvars.client +'&v=' + flashvars.v + '&app_version=' + flashvars.app_version;\r\n                data += this.getPhoneData();\r\n            }\r\n\r\n            return sendData(url, data);\r\n        },\r\n\r\n        getViewData: function(items, subView) {\r\n            let view = {};\r\n            const visitChild = (children, parent) => {\r\n                for (let i=0; i<children.length; i++) {\r\n                    if (!children[i].xInfo || !children[i].yInfo) {\r\n                        continue;\r\n                    }\r\n                    let child = {name:children[i].name, instanceUuid:children[i].instanceUuid, xInfo:children[i].xInfo, yInfo:children[i].yInfo\r\n\t\t\t\t\t\t, eventsInfo: children[i].eventsInfo, scale:children[i].scale, visible:children[i].visible};\r\n                    child.children = [];\r\n                    if (children[i].viewType === 'TIMER') {\r\n                        view.currentCount = children[i].currentCount;\r\n                    }\r\n                    visitChild(children[i].children, child);\r\n                    parent.children.push(child);\r\n                }\r\n            };\r\n            for (let i=0; items && i<items.length; i++) {\r\n                if (!items[i].parent) {\r\n                    continue;\r\n                }\r\n                view = {name:items[i].name, instanceUuid:items[i].instanceUuid, xInfo:items[i].xInfo, yInfo:items[i].yInfo, eventsInfo:items[i].eventsInfo\r\n\t\t\t\t\t, scale:items[i].scale, parent:items[i].parent.name, x: items[i].x, y: items[i].y, visible:items[i].visible};\r\n                view.children = [];\r\n                if (items[i].viewType === 'TIMER') {\r\n                \tview.currentCount = items[i].currentCount;\r\n\t\t\t\t}\r\n\t\t\t\tif (items[i].generateType) {\r\n                \tview.generateType = items[i].generateType;\r\n\t\t\t\t}\r\n                visitChild(items[i].children, view);\r\n                subView.push(view);\r\n            }\r\n        },\r\n\r\n        getViewParentEvents: function(ref) {\r\n            const viewMap = this.json_data.viewMap;\r\n            for (let i in viewMap) {\r\n                if (i === ref) {\r\n                    return viewMap[i].events.concat();\r\n                }\r\n                else {\r\n                    for (let j in viewMap.children) {\r\n                        if (viewMap.children[j].ref === ref) {\r\n                            return viewMap.children[j].events.concat();\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        copyFlashViewData: function(src, commandObj) {\r\n            let bVisible = true;\r\n            if (commandObj && commandObj.historyCommand && commandObj.historyCommand.hideGlobalViews) {\r\n                for (let v=0; v<commandObj.historyCommand.hideGlobalViews.length; v++) {\r\n                    if (src.instanceUuid === commandObj.historyCommand.hideGlobalViews[v]) {\r\n                        bVisible = false;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            let dest = {name: src.ref\r\n                , instanceUuid: src.instanceUuid\r\n                , xInfo: Object.prototype.toString.apply(src.x) === '[object Object]' ? src.x : {type: 'literal', value: src.x}\r\n                , yInfo: Object.prototype.toString.apply(src.y) === '[object Object]' ? src.y : {type: 'literal', value: src.y}\r\n                , scale: {x: src.scale, y: src.scale, type: 25}\r\n                , visible: bVisible};\r\n            src.currentCount && (dest.currentCount = src.currentCount);\r\n            dest.children = [];\r\n            for (let n=0; n<src.children.length; n++) {\r\n                dest.children[n] = this.copyFlashViewData(src.children[n], commandObj);\r\n                dest.children[n].eventsInfo = this.getViewParentEvents(src.ref);\r\n            }\r\n            return dest;\r\n        },\r\n\r\n\t\tgetWeatherType: function() {\r\n        \t//windy snowy rainy defoliation fallingPeach fallingFlower lightning\r\n            if (!this.weatherLayer.visible) {\r\n                return '';\r\n            }\r\n            let w = this.weatherLayer.getByName('wind');\r\n            if (w && w.visible) {\r\n                return 'windy';\r\n            }\r\n            w = this.weatherLayer.getByName('snow');\r\n            if (w && w.visible) {\r\n                return 'snowy';\r\n            }\r\n            w = this.weatherLayer.getByName('rain');\r\n            if (w && w.visible) {\r\n                return 'rainy';\r\n            }\r\n            //桃花\r\n            w = this.weatherLayer.getByName('beachBlossom');\r\n            if (w && w.visible) {\r\n                return 'fallingPeach';\r\n            }\r\n            //樱花\r\n            w = this.weatherLayer.getByName('blossom');\r\n            if (w && w.visible) {\r\n                return 'fallingFlower';\r\n            }\r\n            //闪电\r\n            w = this.weatherLayer.getByName('lightning');\r\n            if (w && w.visible) {\r\n                return 'lightning';\r\n            }\r\n            //枫叶\r\n            w = this.weatherLayer.getByName('fallingLeaves');\r\n            if (w && w.visible) {\r\n                return 'defoliation';\r\n            }\r\n            return '';\r\n        },\r\n\r\n\t\t/**获取屏幕效果*/\r\n\t\tgetScreenAnime:function () {\r\n\t\t\tif(this.shakeLoopObj.loop === true){\r\n\t\t\t\t//正处于循环振动中\r\n\t\t\t\treturn JSON.parse(JSON.stringify(this.shakeLoopObj));\r\n\t\t\t}\r\n\t\t\treturn {level:0,duration:0,delay:0,loop:false,commands:null}\r\n        },\r\n\r\n        /**\r\n\t\t * 获取当前的气泡数据\r\n         */\r\n\t\tgetBubbleData:function (isclear) {\r\n\t\t\tlet ary = [];\r\n            if(this.saveBubbleVector.length > 0){\r\n                for(let i = 0; i < this.saveBubbleVector.length;i++){\r\n                    let border = this.saveBubbleVector[i];\r\n                    if(isclear){\r\n\t\t\t\t\t\tthis.clearBubbleData(i);\r\n                    }\r\n                    let bubble = [];\r\n                    for(let j = 0;j < border.savebubble.length;j++){\r\n                        //bubble\r\n                        bubble.push(border.savebubble[j]);\r\n                    }\r\n                    let curbubble = [];\r\n                    for(let k = 0;k < border.curbubble.length;k++){\r\n                        //curbubble\r\n                        curbubble.push(border.curbubble[k]);\r\n                    }\r\n                    ary.push({bubbleMode:border.commands,bubble:bubble,curbubble:curbubble,ishide:border.ishide,iscurrent:border.iscurrent})\r\n                }\r\n            }\r\n            return ary;\r\n        },\r\n        /**\r\n\t\t * 计算气泡数量上线\r\n         */\r\n\t\tbubbleUpper:function () {\r\n\t\t\twhile (this.bubbleArchivalCount.length > 1000){\r\n                let buuid = this.bubbleArchivalCount.shift();\r\n                const cleardata = (ary,uuid) =>{\r\n                    for(let i = 0;i < ary.length;i++){\r\n                    \tif(ary[i].uuid === uuid){\r\n                            ary.splice(i,1);\r\n                    \t\tbreak;\r\n\t\t\t\t\t\t}\r\n                    }\r\n\t\t\t\t}\r\n                this.saveBubbleVector.forEach((b,index) =>{\r\n                \tcleardata(b.savebubble,buuid);\r\n                \tcleardata(b.curbubble,buuid);\r\n\t\t\t\t})\r\n\t\t\t}\r\n        },\r\n\r\n        /**\r\n\t\t * 清除气泡数据\r\n         */\r\n\t\tclearBubbleData:function (id) {\r\n\t\t\t//删除计数数据\r\n\t\t\tconst clearcount = (uuid) =>{\r\n\t\t\t\tconst getcountindex = (uuid)=>{\r\n\t\t\t\t\tfor(let i = 0;i<this.bubbleArchivalCount.length;i++){\r\n                        if(this.bubbleArchivalCount[i] === uuid) return i;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t}\r\n\t\t\t\tlet gindex = getcountindex(uuid);\r\n\t\t\t\tgindex !== -1 && this.bubbleArchivalCount.splice(gindex,1);\r\n\t\t\t}\r\n            if(id !== -1){\r\n                //找到对应编号 气泡模式\r\n                if(this.saveBubbleVector[id].remove === 2){\r\n                    //无需保留，清除所有数据\r\n                    const removeborder = this.saveBubbleVector[id];\r\n                    for(let i = 0;i < removeborder.savebubble.length;i++){\r\n                        clearcount(removeborder.savebubble[i].uuid);\r\n\t\t\t\t\t}\r\n                    this.bubbleLayer.removeChild(removeborder);\r\n                    this.saveBubbleVector.splice(id,1);\r\n                    removeborder.destroy();\r\n                }else if(this.saveBubbleVector[id].remove === 1){\r\n                \t//清除当前气泡模式下后面的数据\r\n                    const getindex = (bc)=>{\r\n                        for(let i =0;i < this.saveBubbleVector[id].savebubble.length;i++){\r\n                            if(this.saveBubbleVector[id].savebubble[i].uuid === bc.uuid){\r\n                            \treturn i;\r\n\t\t\t\t\t\t\t}\r\n                        }\r\n                        return -1;\r\n                    }\r\n                    this.saveBubbleVector[id].curbubble.forEach((bc,ii) =>{\r\n\t\t\t\t\t\tlet index = getindex(bc);\r\n\t\t\t\t\t\tclearcount(bc.uuid);\r\n                        index !== -1 && this.saveBubbleVector[id].savebubble.splice(index,1);\r\n\t\t\t\t\t})\r\n                    this.saveBubbleVector[id].curbubble = [];\r\n                }\r\n            }\r\n        },\r\n\r\n\t\tsaveRecord: function (index, auto) {\r\n\t\t\t// 保存进度\r\n\t\t\tif (index === 0 && this.json_data.default_settings.autoSaveOrLoad && !auto) {\r\n\t\t\t\treturn Promise.resolve(null);\r\n\t\t\t}\r\n            const save = ()=>{\r\n                !this.savedPlotsData && this.loadData();\r\n                const timestamp = Date.now();\r\n\r\n                let globalViews = [];\r\n                let plotViews = [];\r\n                let chAndProps = [];\r\n                this.getViewData(this.globalViews, globalViews);\r\n                this.getViewData(this.plotViews, plotViews);\r\n                this.bubbleUpper();//存档时候气泡数量上限计算\r\n\r\n                const saveData = {};\r\n                saveData.plotUuid = this.curChapter.plots[this.curPlotIndex].uuid;\r\n                saveData.chapterUuid = this.curChapter.uuid;\r\n                saveData.bkKey = this.lstPlotBkKey;\r\n                saveData.bkOpacity = this.lstPlotBkOpacity;\r\n                saveData.bkFlex = this.lstPlotBkFlex;\r\n                saveData.cmdUuid = this.curCmdUuid;\r\n                saveData.bCmdAutoText = this.bCmdAutoText;\r\n                saveData.timestamp = timestamp;\r\n                saveData.context = JSON.parse(JSON.stringify(this.context));\r\n                saveData.plotSnap = this.plotSnap;\r\n                saveData.weatherType = this.getWeatherType();\r\n                saveData.globalViews = globalViews.concat();\r\n                saveData.plotViews = plotViews.concat();\r\n                saveData.playbackData = this.playbackData.concat();\r\n                saveData.animateScene = {shake:null}\r\n                saveData.animateScene.shake = this.getScreenAnime().commands;//存档转场动画振动\r\n                saveData.bubble = [];\r\n                saveData.bubble = this.getBubbleData().concat();\r\n                saveData.bubbleCount = [];\r\n                saveData.bubbleCount = this.bubbleArchivalCount && this.bubbleArchivalCount.concat();\r\n                if ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n                    saveData.music = {url: PhoneUtils.musicInfo.key, volume: PhoneUtils.musicInfo.prevolume || PhoneUtils.musicInfo.volume,inheritvolume:PhoneUtils.musicInfo.inheritvolume};\r\n                    saveData.sounds = PhoneUtils.soundsInfo.map(s => {\r\n                        if (s.key) {\r\n                            return {url: s.key, volume: s.prevolume || s.volume, time: s.loop ? 0 : 1,inheritvolume:s.inheritvolume}\r\n                        }\r\n                        return null;\r\n                    })\r\n                } else {\r\n                    saveData.music = {url: this.bk_music && this.bk_music.key, volume: this.bk_music && (this.bk_music.prevolume || this.bk_music.volume),inheritvolume: this.bk_music && this.bk_music.inheritvolume};\r\n                    saveData.sounds = this.plotSounds.map(s => {\r\n                        if (s) {\r\n                            return {\r\n                                url: s.key,\r\n                                volume: s.prevolume || s.volume,\r\n                                time: s.loop ? 0 : 1,\r\n\t\t\t\t\t\t\t\tinheritvolume:s.inheritvolume\r\n                            }\r\n                        }\r\n                        return null;\r\n                    });\r\n                }\r\n\r\n                if (this.curCmdUuid !== '') {\r\n                    this.charsAndPropsLayer && this.charsAndPropsLayer.children.forEach(g => {\r\n                        let c = g.children[0];\r\n                        let item = {url:c.key, x:c.x, y:c.y, width:c.width, height:c.height, opacity: c.alpha, pivotX: c.pivot.x, pivotY: c.pivot.y\r\n                            , scaleX:c.scale.x, scaleY:c.scale.y, rotate:c.angle, cmdUuid:c.cmdUuid, index:g.zIndex, parentScale: g.scale.x,mirrorH:(c.mirrorH ? c.mirrorH : false),mirrorV:(c.mirrorV ? c.mirrorV : false)};\r\n\r\n                        if (c.finalState) {\r\n                            item.x = c.finalState.x;\r\n                            item.y = c.finalState.y;\r\n                            item.opacity = c.finalState.alpha;\r\n                            item.rotate = c.finalState.angle\r\n                        }\r\n                        if (g.finalState) {\r\n                            item.parentScale = g.finalState.scale.x;\r\n                        }\r\n                        chAndProps.push(item);\r\n                    });\r\n\r\n                    let bk = this.curPlotLayer.children[1];\r\n                    saveData.bk = {};\r\n                    if (bk) {\r\n                        saveData.bk = {url: bk.key, opacity: bk.alpha};\r\n                        bk.finalState && (saveData.bk.opacity = bk.finalState.alpha);\r\n                    }\r\n                }\r\n\r\n                saveData.charsAndProps = chAndProps.concat();\r\n                saveData.dialogInfo = this.lstDialogInfo.concat();\r\n                saveData.menuInfo = this.menuInfo.concat();\r\n                this.savedPlotsData[index] = JSON.parse(JSON.stringify(saveData));\r\n                this.bSignedIn && this.bCloudSel && (this.cloudPlotsData[index] = JSON.parse(JSON.stringify(saveData)));\r\n                return this.saveData(index, auto).then(rs => {return Promise.resolve(saveData)}, rj => {return Promise.resolve(null)});\r\n            };\r\n\r\n\t\t\tif(auto === true && this.bSignedIn !== true){\r\n\t\t\t\t//自动存档时，已登入\r\n                this.isSignedIn().then(() => {\r\n                \t//登入\r\n                    this.bCloudSel = true;\r\n\t\t\t\t\treturn save();\r\n                },()=>{\r\n                \t//未登入\r\n                    return save();\r\n\t\t\t\t})\r\n\t\t\t}else{\r\n                return save();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tloadRecord: function (index) {\r\n\t\t\t!this.savedPlotsData && this.loadData();\r\n            const {plotUuid, chapterUuid, context, playbackData} = this.savedPlotsData[index];\r\n            const goRecord = (nChapter, nPlot) => {\r\n                this.destroyAll();\r\n                this.saveBubbleDataVector = [];\r\n                this.lstPlotBkKey = this.savedPlotsData[index].bkKey;\r\n                this.lstPlotBkOpacity = this.savedPlotsData[index].bkOpacity;\r\n                this.lstPlotBkFlex = this.savedPlotsData[index].bkFlex;\r\n                this.globalViews = this.savedPlotsData[index].globalViews.concat();\r\n                this.plotViews = this.savedPlotsData[index].plotViews.concat();\r\n                this.charsAndPropsInfo = this.savedPlotsData[index].charsAndProps.concat();\r\n                this.lstDialogInfo = this.savedPlotsData[index].dialogInfo ? this.savedPlotsData[index].dialogInfo.concat() : [];\r\n                this.menuInfo = this.savedPlotsData[index].menuInfo ? this.savedPlotsData[index].menuInfo.concat() : [];\r\n                this.curCmdUuid = this.savedPlotsData[index].cmdUuid;\r\n                this.bCmdAutoText = this.savedPlotsData[index].bCmdAutoText;\r\n                this.saveBubbleDataVector = this.savedPlotsData[index].bubble ? this.savedPlotsData[index].bubble.concat() : [];\r\n                this.bubbleArchivalCount = this.savedPlotsData[index].bubbleCount ? this.savedPlotsData[index].bubbleCount.concat() : [];\r\n                //this.saveBubbleVector = JSON.parse(JSON.stringify(this.savedPlotsData[index].bubble));//气泡\r\n                //this.shakeLoopObj = this.savedPlotsData[index].screenAnime && Object.assign(this.savedPlotsData[index].screenAnime,{})\r\n                this.visibleLayout[0] && (this.visibleLayout[0].visible = true);\r\n                this.visibleLayout = this.visibleLayout.slice(1);\r\n                this.recordLayer.visible = false;\r\n                this.mainMenuLayer.visible = false;\r\n                this.endLayer.visible = false;\r\n                this.onResume();\r\n                this.removePlotTweens();\r\n                playbackData.forEach(d => this.addPlayBackContent(d));\r\n                let cmdPlotSnap = {};\r\n                if (this.curCmdUuid) {\r\n                    if(this.savedPlotsData[index].weatherType !== ''){\r\n                        if(this.savedPlotsData[index].weatherType === 'snow' || this.savedPlotsData[index].weatherType === 'wind' || this.savedPlotsData[index].weatherType === 'rain'){\r\n                            this.savedPlotsData[index].weatherType += 'y';\r\n                        }\r\n                    }\r\n                    cmdPlotSnap = this.getCommandByCommandUuid(chapter.plots[nPlot], this.curCmdUuid);\r\n                    cmdPlotSnap.cmdScreenSnap = {charsAndProps: this.charsAndPropsInfo\r\n                        , sounds: this.savedPlotsData[index].sounds\r\n                        , music: this.savedPlotsData[index].music\r\n                        , plotViews: this.plotViews\r\n                        , dialogInfo: this.lstDialogInfo\r\n                        , menuInfo: this.menuInfo\r\n                        , bk: this.savedPlotsData[index].bk\r\n                        , weatherType: this.savedPlotsData[index].weatherType\r\n\t\t\t\t\t\t, autoText:this.bCmdAutoText\r\n                    };\r\n\r\n                    cmdPlotSnap.animateScene = {shake:null}\r\n                    if(this.savedPlotsData[index].animateScene && this.savedPlotsData[index].animateScene.shake){\r\n                        cmdPlotSnap.animateScene.shake = Object.assign(this.savedPlotsData[index].animateScene.shake,{});\r\n\t\t\t\t\t}\r\n                }\r\n\r\n                this.initContext(context, true);\r\n                context.commandInserts && (this.context.commandInserts = context.commandInserts.concat());\r\n                context.inserts && (this.context.inserts = context.inserts.concat());\r\n\t\t\t\tconst loadData = {\r\n\t\t\t\t\tmusic: this.savedPlotsData[index].music,\r\n\t\t\t\t\tsounds: this.savedPlotsData[index].sounds,\r\n\t\t\t\t\tcharsAndProps: this.charsAndPropsInfo,\r\n\t\t\t\t\tbackground: this.lstPlotBkKey,\r\n\t\t\t\t\timages: [this.lstDialogInfo && this.lstDialogInfo[0] ? { url: this.lstDialogInfo[0].avatar.url } : {}]\r\n\t\t\t\t\t,bubble:this.saveBubbleDataVector\r\n\t\t\t\t};\r\n                this.preloadChapterAssets(this.context, nChapter, nPlot, cmdPlotSnap, loadData);\r\n                this.coverLayer.visible = false;\r\n                !this.isGameStarted && this.notifyGameStarted();\r\n            };\r\n            const goRecordHandle = (chapter, index) => {\r\n            \tif (index < 0) {\r\n            \t\tconst {chapter:c, index:i} = this.getChapterByPlotUuid(this.json_data, plotUuid, chapterUuid);\r\n            \t\tgoRecord(c, i);\r\n\t\t\t\t} else {\r\n                    goRecord(chapter, index);\r\n                }\r\n\t\t\t};\r\n            if (!plotUuid) {\r\n                return false;\r\n            }\r\n\r\n\t\t\tconst {chapter, index: n} = this.getChapterByPlotUuid(this.json_data, plotUuid, chapterUuid);\r\n            const downloaduuid = chapter.downloadUuid ? chapter.downloadUuid : chapter.uuid;\r\n            const unlockLoadRecord = ()=>{\r\n                const unlockFinish = (bSuccess) => {\r\n                    if (bSuccess) {\r\n                        this.checkIfChapterFree(downloaduuid, chapter.md5).then((plots)=>{\r\n                            this.isPreferentialFinished = false;//成功有数据\r\n                            this.unlockChapterCallBack = null;\r\n                            chapter.plots.push(...plots);\r\n                            goRecordHandle(chapter, n);\r\n                        }, () => {\r\n                            if(flashvars.client === 'wap'){\r\n                                window.parent && window.parent.playLogin();\r\n                            }else{\r\n                                Dialog.error('获取付费章节信息失败')\r\n\t\t\t\t\t\t\t}\r\n                        })\r\n                    }\r\n                };\r\n                this.unlockChapter(downloaduuid, chapter.charge, chapter.md5, unlockFinish);\r\n            }\r\n            if(this.isPreferentialFinished !== false && ('android' === flashvars.client || 'ios' === flashvars.client)){\r\n                this.checkIfChapterFree(downloaduuid, chapter.md5).then((plots)=>{\r\n                    if(plots.length <=0 ){\r\n                        //数据为空\r\n                        unlockLoadRecord();\r\n                    }else{\r\n                        this.isPreferentialFinished = false;//成功有数据\r\n                    }\r\n                }, (msg)=>{\r\n                    //读档没数据\r\n                    unlockLoadRecord();\r\n                })\r\n\t\t\t}\r\n\r\n            if (chapter && chapter.md5 && (chapter.plots.length === 0)) {//如果读取的存档是在限免结束后读取  重新加载一次章节数据\r\n            \t//const chapterUuid = chapter.downloadUuid ? chapter.downloadUuid : chapter.uuid;\r\n                //第三方\r\n                if(this.isWapOther()){\r\n                    const otherback = (plots)=>{\r\n                        if(plots === null){\r\n                            Dialog.error('获取付费章节信息失败');\r\n                        }else if(plots === \"fail\"){\r\n                            //查询失败\r\n                            Dialog.custom(\"Error\",\"仍未查询到您的支付信息哦，请确认已经支付~ 如有疑问请添加闪艺客服QQ：819786897 ~\",\"提示\",\"复制QQ\",\"取消\",false).then(()=>{\r\n                                Copy(\"819786897\",{\r\n                                    debug: false,\r\n                                    message: '复制成功',\r\n                                })\r\n                            },()=>{\r\n                            })\r\n                        }else{\r\n                            chapter.plots.push(...plots ? plots : []);\r\n                            goRecordHandle(chapter, n);\r\n                        }\r\n                    }\r\n                    this.unlockChapterByWapOther(downloaduuid,chapter.charge,chapter.md5,otherback);\r\n                    return;\r\n                }\r\n                if (chapter.charge && ('android' === flashvars.client || 'ios' === flashvars.client || flashvars.client === 'wap')) {\r\n                \tif(flashvars.uid !== '' && flashvars.client === 'wap'){\r\n                        //wap端 已登 解锁之前再请求一次接口数据\r\n                        this.checkIfChapterFree(downloaduuid, chapter.md5).then((plots)=>{\r\n                            chapter.plots.push(...plots);\r\n                            goRecordHandle(chapter, n);\r\n                        },()=>{\r\n                            unlockLoadRecord();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}else{\r\n                        unlockLoadRecord();\r\n\t\t\t\t\t}\r\n                } else {\r\n                    this.checkIfChapterFree(downloaduuid, chapter.md5).then((plots)=>{\r\n                        chapter.plots.push(...plots);\r\n                        goRecordHandle(chapter, n);\r\n                    }, (msg)=>{\r\n                        if (-1 === msg.indexOf('code=87')) {\r\n                            Dialog.error(msg);\r\n                        } else { // 未购买此章节\r\n                            if(flashvars.wap === 'zxwwap'){\r\n                                Dialog.info('当前为收费章节，是否前往闪艺抢先体验？').then(()=>{\r\n                                    window.location.href = 'https://wap.3000.com/?m=detail&op=index&ac=index&id='+ flashvars.gid;\r\n                                })\r\n                            }else{\r\n                                Dialog.info('当前为收费章节，请前往闪艺app或电脑端进行购买');\r\n\t\t\t\t\t\t\t}\r\n                        }\r\n                    })\r\n\t\t\t\t}\r\n            } else if (chapter && -4 !== n) {\r\n                goRecord(chapter, n);\r\n            }\r\n            return true;\r\n\t\t},\r\n\r\n\t\tonRecordItemClicked: function (iCol, iRow) {\r\n\t\t\tconst index = iRow * 4 + iCol;\r\n\t\t\tconst get = ()=>{\r\n                if (this.bToSaveFile) {\r\n                    if ((this.gameUidBelongTo === this.recUidBelongTo || this.gameUidBelongTo === '') && this.recUidBelongTo === flashvars.uid) {\r\n                        this.saveRecord(index).then(saveData => {\r\n                            if (!saveData) {\r\n                                return false;\r\n                            }\r\n                            const item = this.recordLayer.getByName('scrollPane').children.find(c => c.name === `recordItem_${index}`);\r\n                            const itemContent = item.getByName('content');\r\n                            const itemTime = item.getByName('textTime');\r\n\r\n                            const setPreviewImage = key => {\r\n                                const {width, height} = itemContent;\r\n                                itemContent.loadTexture(key);\r\n                                itemContent.width = width;\r\n                                itemContent.height = height;\r\n                            };\r\n                            const snapMd5 = MD5.hash(saveData.plotSnap);\r\n                            if (!this.viewComponent.game.load.cache.checkImageKey(snapMd5)) {\r\n                                this.addImageUrl(saveData.plotSnap, snapMd5).then(() => setPreviewImage(snapMd5));\r\n                            } else {\r\n                                setPreviewImage(snapMd5);\r\n                            }\r\n                            const strText = Utils.getCurrentDateTime(saveData.timestamp);\r\n                            if (FontUtils.fontFamily) {\r\n                                const fh = this.json_data.font.size ? this.toRealImageFontHeight(itemTime.fontSize) : itemTime.fontSize;\r\n                                const fw = this.json_data.font.size ? this.toRealImageFontWidth(itemTime.fontSize) : itemTime.fontSize;\r\n                                this.addImageFontText([{data:strText}], fw, fh, itemTime, this.context);\r\n                                itemTime.text = ' ';\r\n                            }\r\n                            else {\r\n                                itemTime.text = strText;\r\n                            }\r\n                        });\r\n                    } else {\r\n                        Dialog.info('存档失败，请登录正确的账号后重新尝试');\r\n                    }\r\n                }\r\n                else {\r\n                    if (this.recUidBelongTo === flashvars.uid) {\r\n                        this.gameUidBelongTo = this.recUidBelongTo;\r\n                        if (this.savedPlotsData && this.savedPlotsData[index].plotUuid && !this.savedPlotsData[index].context) {\r\n                            // 说明是云存档数据 且还未获取存档内容\r\n                            this.loadCloudRecord(index).then(rs => {\r\n                                const convertCloudData = (data) => {\r\n                                    let cdata = JSON.parse(data);\r\n\r\n                                    if (cdata.context) {\r\n                                        this.savedPlotsData[index] = cdata;\r\n                                    }\r\n                                    else {\r\n                                    \t//flash存档\r\n                                        this.savedPlotsData[index].plotUuid = cdata.plotUuid;\r\n                                        this.savedPlotsData[index].chapterUuid = cdata.chapterUuid ? cdata.chapterUuid : undefined;\r\n                                        this.savedPlotsData[index].bkKey = cdata.backgroundObject ? cdata.backgroundObject.url : null;\r\n                                        //let ttt = cdata.date + ' ' + cdata.time;\r\n                                        //let arr = ttt.split(/[- : \\/]/);\r\n                                        //let ss = new Date(arr[0], arr[1]-1, arr[2], arr[3], arr[4], arr[5]);\r\n                                        //this.savedPlotsData[index].timestamp = Date.parse(ss);\r\n                                        //this.savedPlotsData[index].plotSnap = 'data:image/jpeg;base64,' + cdata.thumb;\r\n                                        this.savedPlotsData[index].context = {};\r\n                                        this.savedPlotsData[index].context.auto = false;\r\n                                        this.savedPlotsData[index].context.fullScreen = false;\r\n                                        this.savedPlotsData[index].context.values = [];\r\n                                        this.savedPlotsData[index].context.savedValues = [];\r\n                                        this.savedPlotsData[index].context.stringValues = [];\r\n                                        this.savedPlotsData[index].context.indexValues = [];\r\n                                        for (let j=0; j<cdata.values.length; j++) {\r\n                                            if (cdata.values[j].saved) {\r\n                                                let vi = this.savedPlotsData[index].context.savedValues.length;\r\n                                                for (let n=0; n<this.json_data.savedValues.length; n++) {\r\n                                                    if (this.json_data.savedValues[n].uuid === cdata.values[j].key) {\r\n                                                        vi = n;\r\n                                                        break;\r\n                                                    }\r\n                                                }\r\n                                                this.savedPlotsData[index].context.savedValues[vi] = {uuid: cdata.values[j].key\r\n                                                    , name: cdata.values[j].name\r\n                                                    , init: cdata.values[j].init\r\n                                                    , value: cdata.values[j].value };\r\n                                            }\r\n                                            else if (cdata.values[j].index) {\r\n                                                let vi = this.savedPlotsData[index].context.indexValues.length;\r\n                                                for (let n=0; n<this.json_data.indexValues.length; n++) {\r\n                                                    if (this.json_data.indexValues[n].uuid === cdata.values[j].key) {\r\n                                                        vi = n;\r\n                                                        break;\r\n                                                    }\r\n                                                }\r\n                                                this.savedPlotsData[index].context.indexValues[vi] = {uuid: cdata.values[j].key\r\n                                                    , name: cdata.values[j].name\r\n                                                    , init: cdata.values[j].init\r\n                                                    , value: cdata.values[j].value };\r\n                                            }\r\n                                            else if (cdata.values[j].init && cdata.values[j].init.type === 'string') {\r\n                                                let vi = this.savedPlotsData[index].context.stringValues.length;\r\n                                                for (let n=0; n<this.json_data.stringValues.length; n++) {\r\n                                                    if (this.json_data.stringValues[n].uuid === cdata.values[j].key) {\r\n                                                        vi = n;\r\n                                                        break;\r\n                                                    }\r\n                                                }\r\n                                                this.savedPlotsData[index].context.stringValues[vi] = {uuid: cdata.values[j].key\r\n                                                    , name: cdata.values[j].name\r\n                                                    , init: cdata.values[j].init\r\n                                                    , value: cdata.values[j].value };\r\n                                            }\r\n                                            else if (cdata.values[j].key && cdata.values[j].key[2] !== '_' && !cdata.values[j].pay){\r\n                                                let vi = this.savedPlotsData[index].context.values.length;\r\n                                                for (let n=0; n<this.json_data.values.length; n++) {\r\n                                                    if (this.json_data.values[n].uuid === cdata.values[j].key) {\r\n                                                        vi = n;\r\n                                                        break;\r\n                                                    }\r\n                                                }\r\n                                                this.savedPlotsData[index].context.values[vi] = {uuid: cdata.values[j].key\r\n                                                    , name: cdata.values[j].name\r\n                                                    , init: cdata.values[j].init\r\n                                                    , value: cdata.values[j].value };\r\n                                            }\r\n                                        }\r\n                                        this.savedPlotsData[index].context.stack = (cdata.stack || []).concat();\r\n                                        this.savedPlotsData[index].context.cmdStack = (cdata.cmdStack || []).concat();\r\n                                        this.savedPlotsData[index].globalViews = [];\r\n                                        this.savedPlotsData[index].plotViews = [];\r\n                                        for (let j=0; j<cdata.globalViewsData.length; j++) {\r\n                                            this.savedPlotsData[index].globalViews[j] = this.copyFlashViewData(cdata.globalViewsData[j], cdata.commandObj);\r\n                                            this.savedPlotsData[index].globalViews[j].x = this.Expression.safeEval(cdata.globalViewsData[j].x, this.savedPlotsData[index].context) * (1 - cdata.globalViewsData[j].scale);\r\n                                            this.savedPlotsData[index].globalViews[j].y = this.Expression.safeEval(cdata.globalViewsData[j].y, this.savedPlotsData[index].context) * (1 - cdata.globalViewsData[j].scale);\r\n                                            this.savedPlotsData[index].globalViews[j].parent = '__world';\r\n                                        }\r\n                                        for (let j=0; j<cdata.viewsData.length; j++) {\r\n                                            this.savedPlotsData[index].plotViews[j] = this.copyFlashViewData(cdata.viewsData[j], cdata.commandObj);\r\n                                            this.savedPlotsData[index].plotViews[j].x = this.Expression.safeEval(cdata.viewsData[j].x, this.savedPlotsData[index].context) * (1 - cdata.viewsData[j].scale);\r\n                                            this.savedPlotsData[index].plotViews[j].y = this.Expression.safeEval(cdata.viewsData[j].y, this.savedPlotsData[index].context) * (1 - cdata.viewsData[j].scale);\r\n                                            this.savedPlotsData[index].plotViews[j].parent = 'plotViewsLayer';\r\n                                        }\r\n                                        this.savedPlotsData[index].music = cdata.musics[0] ? {url: cdata.musics[0].url, volume: cdata.musics[0].volume} : {};\r\n                                        this.savedPlotsData[index].sounds = cdata.sounds.concat();\r\n                                        this.savedPlotsData[index].playbackData = cdata.speakings.concat();\r\n                                        this.savedPlotsData[index].bk = {};\r\n                                        this.savedPlotsData[index].charsAndProps = [];\r\n                                        this.savedPlotsData[index].dialogInfo = [];\r\n                                        this.savedPlotsData[index].cmdUuid = '';\r\n                                        this.savedPlotsData[index].weatherType = '';\r\n                                        this.savedPlotsData[index].bCmdAutoText = false;\r\n                                        const parsebubble = (bdata)=>{\r\n                                            for(let i =0;i < bdata.length;i++){\r\n                                                let bubblemode = bdata[i];\r\n                                                let modecommands = {\r\n                                                    args:bubblemode.args\r\n                                                    ,type:bubblemode.type\r\n                                                    ,uuid:bubblemode.uuid\r\n                                                }\r\n                                                let bubbleary = [];\r\n                                                let curbubbleary = [];\r\n                                                let ishide = !bubblemode.show;\r\n                                                let iscurrent = (i === bdata.length -1);\r\n                                                if(bubblemode.bubble && bubblemode.bubble.length > 0){\r\n                                                    for(let j = 0;j < bubblemode.bubble.length;j++){\r\n                                                        bubbleary.push(bubblemode.bubble[j]);\r\n                                                    }\r\n                                                    curbubbleary = bubblemode.bubble.slice(bubblemode.bubble.length - bubblemode.currentCount);\r\n                                                }\r\n                                                this.savedPlotsData[index].bubble.push({bubbleMode:modecommands,bubble:bubbleary,curbubble:curbubbleary,ishide:ishide,iscurrent:iscurrent})\r\n                                            }\r\n\t\t\t\t\t\t\t\t\t\t}\r\n                                        if (cdata.commandObj && cdata.commandObj.historyCommand) {\r\n                                            let {images, dialog, autotext, weather} = cdata.commandObj.historyCommand;\r\n                                            //this.savedPlotsData[index].bk = cdata.backgroundObject ? {url: cdata.backgroundObject.url, opacity: cdata.backgroundObject.opacity} : {};\r\n                                            this.savedPlotsData[index].cmdUuid = cdata.commandObj.commandUuid;\r\n                                            this.savedPlotsData[index].bCmdAutoText = autotext ? autotext.args[0] : false;\r\n                                            this.savedPlotsData[index].dialogInfo = dialog && dialog.command ? dialog.command.args : [];\r\n                                            this.savedPlotsData[index].weatherType = weather && weather.args[0];\r\n                                            if(cdata.commandObj.historyCommand.animateScene){\r\n                                                this.savedPlotsData[index].animateScene = cdata.commandObj.historyCommand.animateScene;\r\n\t\t\t\t\t\t\t\t\t\t\t}else{\r\n                                                this.savedPlotsData[index].animateScene = null;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n                                            if (images) {\r\n                                                for (let v=0; v<images.length; v++) {\r\n                                                    if (images[v].index > 1) {\r\n                                                        let item = {url:images[v].url, x:images[v].x, y:images[v].y, width:images[v].width, height:images[v].height, opacity: images[v].opacity\r\n                                                            , rotate:images[v].rotate, index:images[v].index,mirrorH:(images[v].mirrorH ? images[v].mirrorH : false),mirrorV:(images[v].mirrorV ? images[v].mirrorV : false)};\r\n                                                        this.savedPlotsData[index].charsAndProps.push(item);\r\n                                                    }\r\n                                                    else if (images[v].index === 1) {\r\n                                                        this.savedPlotsData[index].bk = {url:images[v].url, opacity:images[v].opacity};\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                            this.savedPlotsData[index].bubble  = []\r\n                                            cdata.commandObj.historyCommand.bubbleMode && parsebubble(cdata.commandObj.historyCommand.bubbleMode);\r\n                                            this.savedPlotsData[index].bubbleCount = [];\r\n\t\t\t\t\t\t\t\t\t\t\tif(cdata.commandObj.historyCommand.bubbleCount){\r\n                                                this.savedPlotsData[index].bubbleCount = cdata.commandObj.historyCommand.bubbleCount.concat();\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n                                        }else{\r\n                                        \t//普通剧情\r\n                                            this.savedPlotsData[index].bubble  = [];\r\n                                            cdata.bubbleMode && parsebubble(cdata.bubbleMode);\r\n                                            this.savedPlotsData[index].bubbleCount = [];\r\n                                            this.savedPlotsData[index].bubbleCount = cdata.bubbleCount && cdata.bubbleCount.concat()\r\n\t\t\t\t\t\t\t\t\t\t}\r\n                                        if (cdata.commandInserts && cdata.commandInserts.length) {\r\n                                            // 高级剧情有插播\r\n                                            this.savedPlotsData[index].context.commandInserts = cdata.commandInserts.concat();\r\n                                        }\r\n                                        if(cdata.inserts && cdata.inserts.length){\r\n                                        \t//普通剧情有插播\r\n                                            this.savedPlotsData[index].context.inserts = cdata.inserts.concat();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n                                        this.cloudPlotsData[index] = JSON.parse(JSON.stringify(this.savedPlotsData[index]));\r\n                                    }\r\n                                };\r\n                                convertCloudData(rs);\r\n                                this.loadRecord(index);\r\n                                this.showMenu();\r\n                            }, () => {\r\n                                Dialog.error('获取存档数据失败')\r\n                            });\r\n                        }\r\n                        else {\r\n                            this.loadRecord(index);\r\n                            this.showMenu();\r\n                        }\r\n                    } else {\r\n                        Dialog.info('读档失败，请登录正确的账号后重新尝试');\r\n                    }\r\n                }\r\n                return true;\r\n\t\t\t}\r\n            if (flashvars.u==='' && flashvars.token==='' && flashvars.client==='') {\r\n                let uid = Utils.getUidByCookie();\r\n                flashvars.uid = uid;\r\n            }\r\n            if(flashvars.client === 'wap' && flashvars.uid === ''){\r\n            \treturn this.getUserInfoFromWap().then(()=>{\r\n\t\t\t\t\treturn get();\r\n\t\t\t\t})\r\n\t\t\t}else{\r\n            \treturn get();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tonPlaybackBackBtnClicked: function () {\r\n\t\t\tthis.visibleLayout[0] && (this.visibleLayout[0].visible = true);\r\n            if (this.visibleLayout[0] !== this.mainMenuLayer) {\r\n                this.onResume();\r\n            }\r\n            this.playBackLayer.removeAll(true);\r\n\t\t\tthis.visibleLayout = this.visibleLayout.slice(1);\r\n\t\t\tthis.playBackLayer.visible = false;\r\n\t\t},\r\n\r\n\t\taddPlayBackContent: function (data) {\r\n\t\t\tthis.sendNotification(diygamePlayer.AppConstants.ADD_PLAYBACK_CONTENT, data);\r\n\t\t},\r\n\r\n\t\tshowLoadingToast: function (type) {\r\n\t\t\tif (1 === type) {\r\n\t\t\t\tthis.loadingToastLayer.visible = true;\r\n                this.viewComponent.game.world.bringToTop(this.loadingToastLayer);\r\n\t\t\t}\r\n\t\t\telse if (0 === type) {\r\n                this.loadingToastLayer.visible = false;\r\n\t\t\t}\r\n        },\r\n\r\n        showToast: function (type, text) {\r\n            let ss = this.toastLayer.getByName('typeSuccess');\r\n            let ee = this.toastLayer.getByName('typeError');\r\n            if (ss) {\r\n                if (0 === type) {\r\n                    ss.visible = true;\r\n                    ss.children[2].text = text;\r\n                    ss.children[0].width = ss.children[2].width + 36;\r\n                    ss.x = (this.viewComponent.game.world.width - ss.children[0].width) / 2;\r\n                    ss.y = flashvars.vertical ? 100 : 252;\r\n                } else {\r\n                    ss.visible = false;\r\n                }\r\n            }\r\n            if (ee) {\r\n                if (1 === type) {\r\n                    ee.visible = true;\r\n                    ee.children[2].text = text;\r\n                    ee.children[0].width = ee.children[2].width + 36;\r\n                    ee.children[1].visible = true;\r\n                    ee.children[2].x = 30;\r\n                    ee.x = (this.viewComponent.game.world.width - ee.children[0].width) / 2;\r\n                    ee.y = flashvars.vertical ? 100 : 252;\r\n                } else if (2 === type) {\r\n                    ee.visible = true;\r\n                    ee.children[2].text = text;\r\n                    ee.children[0].width = ee.children[2].width + 20;\r\n                    ee.children[1].visible = false;\r\n                    ee.children[2].x = 10;\r\n                    ee.x = (this.viewComponent.game.world.width - ee.children[0].width) / 2;\r\n                    ee.y = flashvars.vertical ? 100 : 252;\r\n\t\t\t\t} else {\r\n                    ee.visible = false;\r\n                }\r\n            }\r\n            this.toastLayer.alpha = 0;\r\n            this.viewComponent.game.world.bringToTop(this.toastLayer);\r\n            this.viewComponent.game.add.tween(this.toastLayer).from({alpha: 1}, 2500, null, true).name = 'toast';\r\n        },\r\n\r\n        addRetroText: function (x, y, w, h, txtData) {\r\n            let font = this.viewComponent.game.add.retroFont(FontUtils.fontFamily, FontUtils.charWidth, FontUtils.charHeight, FontUtils.fontChars, FontUtils.countPerRow);\r\n            let txtImg = this.viewComponent.game.add.image(x ? x : 0, y ? y : 0, font);\r\n            txtImg.fontImg = font;\r\n            if (document.body.clientWidth < document.body.clientHeight) {\r\n                font.stamp.angle = -90;\r\n            }\r\n            if (txtData) {\r\n                font.setText(txtData, true, 0, 0, 'center', true);\r\n                if (w) {\r\n                    txtImg.width = w;\r\n                }\r\n                if (h) {\r\n                    txtImg.height = h;\r\n                }\r\n            }\r\n\r\n            return txtImg;\r\n        },\r\n\r\n        addImageFontTextColors: function (data, txtObj, context) {\r\n            // 先清除上一次保存的颜色值\r\n            txtObj.colors.splice(0, txtObj.colors.length);\r\n\r\n            let iPos = 0;\r\n            let color = this.json_data.default_settings.color;\r\n            txtObj.fill = color;\r\n            for (let i=0; i<data.length; i++) {\r\n                let realData = '';\r\n                if (data[i].lineBreak) continue;  // 换行符不计入设置颜色的字符个数\r\n                else if (data[i].placeholder && '\\\\' === data[i].data[0]) {   // 停顿\r\n                    realData = this.Expression.parseWaitTime(data[i].data);\r\n                }\r\n                else {\r\n                    realData = this.Expression.parseValue(data[i].data, context);\r\n                }\r\n                color = data[i].color ? data[i].color : this.json_data.default_settings.color;\r\n                if (color[0] === '#' && color.length === 4) {\r\n                \tlet clr = '#' + color[1] + color[1] + color[2] + color[2] + color[3] + color[3];\r\n                \tcolor = clr;\r\n\t\t\t\t}\r\n                txtObj.addColor(color, iPos);\r\n                iPos += realData.length;\r\n            }\r\n        },\r\n\r\n        addImageFontText: function (data, font_width, font_height, txtObj, context, bSpeaking, bSpeakHidden) {\r\n            const {Expression} = this;\r\n            // 先清除上一剧情fontImage\r\n\t\t\tif (txtObj.children.length) {\r\n                let charGroup = txtObj.children[0];\r\n                let mask = txtObj.children[1];\r\n                for (let i=0; i<charGroup.children.length; i++) {\r\n                    let txtImg = charGroup.getChildAt(i);\r\n                    let fontImg = txtImg.fontImg;\r\n                    fontImg.destroy();\r\n                    txtImg.destroy();\r\n                }\r\n                charGroup.destroy();\r\n                mask && mask.destroy();\r\n                txtObj.removeChildren();\r\n            }\r\n\r\n            let xPos = 0;\r\n            let yPos = 0;\r\n            let cr = '#fffffe';\r\n            let bkWidth = 0;\r\n            let firstMargin = 0;\r\n            let fontHeight = parseFloat(font_height);\r\n            let fontWidth = parseFloat(font_width);\r\n            let t_h = this.json_data.font.size ? (this.json_data.font.size.target.height ? this.json_data.font.size.target.height : this.json_data.font.size.target) : this.json_data.default_settings.font_size;\r\n            let sizeRow = this.json_data.font.size ? (fontHeight * this.json_data.font.size.source / t_h) : fontHeight;\r\n            let seperation = this.json_data.font.size ? (1.5 * sizeRow - fontHeight) : (0.5 * sizeRow);\r\n            let fontChars = [];\r\n            let itemChar = {content:'', color:'#fffffe', x:0, y:0, space:0};\r\n            let charCount = 0;\r\n            let posInfo = [];\r\n            yPos += 0.5 * seperation;\t// 客户端第一行与顶部有0.5个间距 issue8176\r\n\r\n            for (let i=0; i<data.length; i++) {\r\n                let realData = '';\r\n                if (data[i].lineBreak) {\r\n                    if (i === data.length-1) {    // 最后一个换行符不输出\r\n                        break;\r\n                    }\r\n                    yPos += fontHeight + seperation;\r\n                    xPos = 0;\r\n                    continue;\r\n                }\r\n                else if (data[i].placeholder && '\\\\' === data[i].data[0]) {   // 停顿\r\n                    realData = Expression.parseWaitTime(data[i].data);\r\n                }\r\n                else {\r\n                    realData = Expression.parseValue(data[i].data, context);\r\n                }\r\n\r\n                for (let j=0; j<realData.length; j++) {\r\n                    if (txtObj.colors[charCount]) {\r\n                        cr = txtObj.colors[charCount];\r\n                        if (cr === '#ffffff') cr = '#fefefe';\r\n                    }\r\n\r\n                    const m = FontUtils.getLeftMargin(realData[j], fontWidth);\r\n                    const s = FontUtils.getCharSpace(realData[j], fontWidth);\r\n\r\n                    let x = xPos + m;\r\n                    if (x + s > txtObj.style.wordWrapWidth) { // 检测是否还能放下一个字符\r\n                        if (bkWidth < x+s) {\r\n                            bkWidth = x+s;\r\n                        }\r\n                        xPos = 0;\r\n                        x = xPos + m;\r\n                        yPos += fontHeight + seperation;\r\n                        firstMargin = m;\r\n                    }\r\n\r\n                    if (itemChar.space === 0) {\r\n                    \titemChar.space = s;\r\n                    \titemChar.color = cr;\r\n                    \titemChar.x = x;\r\n                    \titemChar.y = yPos;\r\n                    \tif (firstMargin === 0) {\r\n                    \t\tfirstMargin = m;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (32 === realData[j].charCodeAt(0) || 160 === realData[j].charCodeAt(0) || '\\u2002' === realData[j]  // 半角空格\r\n\t\t\t\t\t\t|| '\\u3000' === realData[j] || 8195 === realData[j].charCodeAt(0)) { // 全角空格\r\n                        itemChar.content && fontChars.push(itemChar);\r\n                        fontChars.push({content: realData[j], color:cr, x:x, y:yPos, space:s});\r\n                        itemChar = {content:'', color:'#fffffe', x:0, y:0, space:0};\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (itemChar.space !== s || itemChar.color !== cr || itemChar.y !== yPos || fontWidth !== s) {\r\n                        itemChar.content && fontChars.push(itemChar);\r\n                    \titemChar = {content:realData[j], color:cr, x:x, y:yPos, space:s};\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n                    \titemChar.content += realData[j];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tposInfo.push({x: x, y: yPos, space: s, bottomInText: yPos + fontHeight});\r\n\r\n\t\t\t\t\tcharCount++;\r\n                    xPos += s;\r\n                }\r\n            }\r\n            if (data.length) {\r\n            \tif (itemChar.content) {\r\n                    fontChars[fontChars.length - 1] !== itemChar && fontChars.push(itemChar);\r\n                    if (bkWidth < xPos) {\r\n                    \tbkWidth = xPos;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet charsBk = this.viewComponent.game.add.sprite(0, 0);\r\n                fontChars.forEach(item => {\r\n                \tif (32 === item.content.charCodeAt(0) || 160 === item.content.charCodeAt(0) || '\\u2002' === item.content\r\n\t\t\t\t\t\t|| '\\u3000' === item.content || 8195 === item.content.charCodeAt(0))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n                    let imgTxt = this.addRetroText(item.x, item.y, fontWidth * item.content.length, fontHeight, item.content);\r\n                    imgTxt.tint = parseInt(item.color.replace('#', '0x'));\r\n                    charsBk.addChild(imgTxt);\r\n                });\r\n                charsBk.extWidth = bkWidth;\r\n                charsBk.extMargin = firstMargin;\r\n                txtObj.addChild(charsBk);\r\n                txtObj.posInfo = posInfo;\r\n                fontChars.length && (txtObj.imgFBottom = fontChars[fontChars.length-1].y + fontHeight);\r\n\r\n                if (bSpeaking) {\r\n                    let mask = this.viewComponent.game.add.graphics(0, 0);\r\n                    let maskWidth = txtObj.style.wordWrapWidth;\r\n                    let maskHeight = bSpeakHidden ? 540 : this.json_data.template.json.dialog.rect.height;\r\n                    mask.beginFill(0xffffff);\r\n                    mask.drawRect(-maskWidth, -maskHeight, 2 * maskWidth, maskHeight);\r\n                    mask.drawRect(-maskWidth, 0, maskWidth, fontHeight);\r\n                    mask.endFill();\r\n                    charsBk.mask = mask;\r\n                    txtObj.addChild(mask);\r\n                }\r\n\t\t\t}\r\n        },\r\n\r\n        saveData: function (index, auto) {\r\n            return new Promise((resolve, reject) => {\r\n                if (flashvars.uuid && !this.bCloudSel) {\r\n                    Utils.localStorageSetItem(flashvars.uuid + flashvars.uid, JSON.stringify(this.savedPlotsData));\r\n                    !auto && this.showToast(0, '存档成功，下次可以从这里读档继续哦~');\r\n                    resolve();\r\n                }\r\n                else if (flashvars.gid && this.bCloudSel) {\r\n                \tthis.showLoadingToast(1);\r\n                    this.saveCloudRecord(index).then(rs => {\r\n                    \tthis.showLoadingToast(0);\r\n                        !auto && this.showToast(0, '存档成功，下次可以从这里读档继续哦~');\r\n                        resolve();\r\n                    }, rj => {\r\n                        //Dialog.error(rj)\r\n                        this.showLoadingToast(0);\r\n                        !auto && this.showToast(1, '存档失败，请检查您的网络哦~');\r\n                        reject();\r\n                    });\r\n                }\r\n            })\r\n        },\r\n\r\n\t\tloadData: function (bLocalCloudSwitch) {\r\n        \tconst load = ()=>{\r\n                if (!this.bCloudSel) {\r\n                    this.recUidBelongTo = flashvars.uid;\r\n                }\r\n                else if (this.recUidBelongTo === '') {\r\n                    this.recUidBelongTo = flashvars.uid;\r\n                }\r\n\r\n                if (flashvars.uuid) {\r\n                    if (this.bSignedIn && this.bCloudSel) {\r\n                        this.savedPlotsData = JSON.parse(JSON.stringify(this.cloudPlotsData));\r\n                    }\r\n                    else {\r\n                        let savedData = Utils.localStorageGetItem(flashvars.uuid + flashvars.uid);\r\n                        if (savedData && 'ios' === flashvars.client) {\r\n                            savedData = savedData.replace(/\\n/g, '');\r\n                            savedData = savedData.replace(/\\r/g, '');\r\n                        }\r\n                        this.savedPlotsData = JSON.parse(savedData);\r\n                    }\r\n                }\r\n                if (!this.savedPlotsData) {\r\n                    this.savedPlotsData = Array(12).fill({});\r\n                }\r\n\t\t\t}\r\n            if (flashvars.u==='' && flashvars.token==='' && flashvars.client==='') {\r\n                let uid = Utils.getUidByCookie();\r\n                if ('' !== uid && flashvars.uid !== uid) {\r\n                    flashvars.uid = uid;\r\n                    this.localRecFileToUidRecFile(bLocalCloudSwitch);\r\n                } else {\r\n                \tflashvars.uid = uid;\r\n\t\t\t\t}\r\n            }\r\n            if(flashvars.client === 'wap' && flashvars.uid === ''){\r\n            \tthis.getUserInfoFromWap().then(()=>{\r\n\t\t\t\t\tload();\r\n\t\t\t\t})\r\n\t\t\t}else{\r\n            \tload();\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tgetSnap: function () {\r\n            const canvas = document.createElement('canvas');\r\n            canvas.width = (this.isWapOther() || flashvars.client==='wap') ? this.viewComponent.game.world.width : this.viewComponent.game.world.width / 3;\r\n            canvas.height = (this.isWapOther() || flashvars.client==='wap') ? this.viewComponent.game.world.height : this.viewComponent.game.world.height / 3;\r\n            this.viewComponent.game.updateRender(1);\r\n            const ctx = canvas.getContext('2d');\r\n\t\t\tconst w = (window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth)\r\n\t\t\tconst h = (window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight)\r\n\t\t\tif (w > h) {\r\n\t\t\t\tif(flashvars.vertical){\r\n                    ctx.save();\r\n                    ctx.translate(0, canvas.height);\r\n                    ctx.rotate(-90 * Math.PI / 180);\r\n                    ctx.drawImage(this.viewComponent.game.canvas, 0, 0);\r\n                    ctx.restore();\r\n\t\t\t\t}else{\r\n                    ctx.drawImage(this.viewComponent.game.canvas, 0, 0, this.viewComponent.game.world.width, this.viewComponent.game.world.height, 0, 0, canvas.width, canvas.height);\r\n\t\t\t\t}\r\n                this.plotSnap = canvas.toDataURL(\"image/jpeg\", 0.3);\r\n\t\t\t}\r\n\t\t\telse {\r\n                if(flashvars.vertical){\r\n                    ctx.drawImage(this.viewComponent.game.canvas, 0, 0, this.viewComponent.game.world.width, this.viewComponent.game.world.height, 0, 0, canvas.width, canvas.height);\r\n                }else{\r\n                    ctx.save();\r\n                    ctx.translate(0, canvas.height);\r\n                    ctx.rotate(-90 * Math.PI / 180);\r\n                    ctx.drawImage(this.viewComponent.game.canvas, 0, 0);\r\n                    ctx.restore();\r\n\t\t\t\t}\r\n\r\n                this.plotSnap = canvas.toDataURL(\"image/jpeg\", 0.3);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tgetChapterByPlotUuid: function (game, uuid, chapterUuid) {\r\n\t\t\tconst searchPlot = (plots, chapter, uuid, chapterUuid) => {\r\n\t\t\t\tlet result = null;\r\n\t\t\t\tif (chapterUuid && chapter.uuid !== chapterUuid) {\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t}\r\n\t\t\t\telse if (chapterUuid && chapter.uuid === chapterUuid && chapter.plots.length === 0) {\r\n\t\t\t\t\tresult = {chapter: chapter, index: -4};\r\n\t\t\t\t}\r\n\t\t\t\tplots.find((plot, i) => {\r\n\t\t\t\t\tif (plot.uuid === uuid) {\r\n\t\t\t\t\t\tresult = {chapter: chapter, index: i};\r\n\t\t\t\t\t} else if (chapter.plots[i].options) {\r\n\t\t\t\t\t\tresult = searchPlotByOption(chapter, i, uuid);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn result !== null;\r\n\t\t\t\t});\r\n\r\n\t\t\t\treturn result;\r\n\t\t\t};\r\n\r\n\t\t\tconst searchPlotByOption = (chapter, nIndex, uuid) => {\r\n\t\t\t\tlet result = null;\r\n\t\t\t\tconst plot = chapter.plots[nIndex];\r\n\t\t\t\tplot.options.find((option, i) => {\r\n\t\t\t\t\tresult = searchPlot(option.plots, {plots: option.plots, parent: {pChapter: chapter, pnPlot: nIndex}, uuid: chapter.uuid, md5:chapter.md5, downloadUuid:chapter.downloadUuid}, uuid);\r\n\t\t\t\t\treturn result !== null\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (result) {\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tplot.condition_options && plot.condition_options.find((option, i) => {\r\n\t\t\t\t\tresult = searchPlot(option.plots, {plots: option.plots, parent: {pChapter: chapter, pnPlot: nIndex}, uuid: chapter.uuid, md5:chapter.md5, downloadUuid:chapter.downloadUuid}, uuid);\r\n\t\t\t\t\treturn result !== null\r\n\t\t\t\t});\r\n\r\n\t\t\t\treturn result;\r\n\t\t\t};\r\n\r\n\t\t\tconst searchPlotByChapter = (chapter, uuid, chapterUuid) => {\r\n\t\t\t\tlet result = null;\r\n\t\t\t\tresult = searchPlot(chapter.plots, chapter, uuid, chapterUuid);\r\n\t\t\t\tif (result) {\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t}\r\n\t\t\t\tchapter.subchapters.find((subchapter, i) => {\r\n\t\t\t\t\tresult = searchPlotByChapter(chapter.subchapters[i], uuid, chapterUuid);\r\n\t\t\t\t\treturn result !== null\r\n\t\t\t\t});\r\n\r\n\t\t\t\treturn result;\r\n\t\t\t};\r\n\r\n\t\t\tlet result = null;\r\n\t\t\tgame.chapters.find((chapter, i) => {\r\n                result = searchPlotByChapter(game.chapters[i], uuid, chapterUuid);\r\n                return result !== null\r\n\t\t\t});\r\n\t\t\tif (!result || -4 === result.index && !result.chapter.md5) {\r\n\t\t\t\tDialog.error('该剧情已被作者删除啦！\\r\\n无法从该剧情继续哦~');\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t},\r\n\r\n\t\tgetCommandByCommandUuid: function (plot, uuid) {\r\n            const searchCommandInOption = (ops, pCmdInfo, pIndex) => {\r\n            \tfor (let i=0; i<ops.length; i++) {\r\n                    let result = null;\r\n                    result = searchCommand({commands: ops[i].commands, parentInfo: pCmdInfo, parentCmdIndex: pIndex});\r\n            \t\tif (result.cmdInfo !== null) return result;\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t};\r\n\r\n            const searchCommand = (cmdInfo) => {\r\n            \tlet result = null;\r\n            \tcmdInfo.commands.find((command, i) => {\r\n            \t\tif (command.uuid === uuid) {\r\n            \t\t\tresult = {cmdIndex: i, uuid: uuid, cmdInfo: {commands: cmdInfo.commands, parentInfo: cmdInfo.parentInfo, parentCmdIndex: cmdInfo.parentCmdIndex}}\r\n                    }\r\n            \t\telse if (command.type === 'options' || command.type === 'conditionOptions') {\r\n            \t\t\tresult = searchCommandInOption(command.args, cmdInfo, i);\r\n                    }\r\n\r\n                    return null !== result;\r\n\t\t\t\t});\r\n            \tif (null === result) {\r\n            \t\treturn {cmdIndex: -1, cmdInfo: null};\r\n                }\r\n                return result;\r\n\t\t\t};\r\n\r\n            let cmdInfo = {commands: plot.commands, parentInfo: null, parentCmdIndex: -1};\r\n            return searchCommand(cmdInfo);\r\n        },\r\n\r\n\t\tgetMusic: function (chapter, nPlot) {\r\n\t\t\tlet url = null;\r\n\t\t\tfor (let i = nPlot; i >= 0; i--) {\r\n\t\t\t\tconst plot = chapter.plots[i];\r\n\t\t\t\tif (plot.music && plot.music.url !== \"inherit\") {\r\n\t\t\t\t\turl = plot.music.url;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!url && chapter.parent) {\r\n\t\t\t\treturn this.getMusic(chapter.parent.pChapter, chapter.parent.pnPlot);\r\n\t\t\t}\r\n\t\t\tif (!url && chapter.isFirst) {\r\n\t\t\t\tif (this.json_data.cover.music && this.json_data.cover.music.url !== 'inherit') {\r\n                    return this.json_data.cover.music.url;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn url;\r\n\t\t},\r\n\r\n\t\tgetCmdScreenSnap: function () {\r\n\t\t\tlet {bk_music, plotSounds, curPlotLayer} = this;\r\n\t\t\tlet bkInfo = curPlotLayer.children[1];\r\n\t\t\tlet chAndProps = [];\r\n            let plotViews = [];\r\n            let dialogInfo = this.lstDialogInfo.concat();\r\n            let menuInfo = this.menuInfo.concat();\r\n            let music = bk_music ? {url: bk_music.key, volume: bk_music.volume} : null;\r\n            let sounds = plotSounds.map(s => {\r\n                if (s) {\r\n                    return {\r\n                        url: s.key,\r\n                        volume: s.volume,\r\n                        time: s.loop ? 0 : 1\r\n                    }\r\n                }\r\n                return null;\r\n            });\r\n            let bk = bkInfo ? {url: bkInfo.key, opacity: bkInfo.alpha, width: bkInfo.width, height: bkInfo.height} : null;\r\n\r\n            this.saveBubbleDataVector = []\r\n            let bubble =  this.getBubbleData().concat();\r\n            this.apToFinalState();\r\n            this.charsAndPropsLayer && this.charsAndPropsLayer.children.forEach(g => {\r\n            \tlet c = g.children[0];\r\n\t\t\t\tlet item = {url:c.key, x:c.x, y:c.y, width:c.width, height:c.height, opacity: c.alpha, pivotX: c.pivot.x, pivotY: c.pivot.y\r\n\t\t\t\t\t, scaleX:c.scale.x, scaleY:c.scale.y, rotate:c.angle, cmdUuid:c.cmdUuid, index:g.zIndex, parentScale: g.scale.x};\r\n\t\t\t\tchAndProps.push(item);\r\n\t\t\t});\r\n            this.getViewData(this.plotViews, plotViews);\r\n            return {bk: bk, charsAndProps: chAndProps, sounds: sounds, music: music, plotViews: plotViews, dialogInfo: dialogInfo, menuInfo: menuInfo, autoText: this.bCmdAutoText, weatherType: this.getWeatherType(),bubble:bubble};\r\n        },\r\n\r\n\t\tgetNextPlot: function (context, chapter, nPlot, type, eArg) {\r\n            const searchChapterByUUID = Utils.searchChapterByUUID;\r\n\t\t\tlet {json_data, Expression} = this;\r\n\t\t\tconst game = json_data;\r\n\t\t\tlet cmdPlotSnap = {cmdIndex: 0, cmdInfo: null, cmdScreenSnap: null,animateScene:{shake:null}};\r\n\t\t\tlet nIndex = nPlot;\r\n\t\t\tlet nChapter = chapter;\r\n\t\t\tlet preStackFrame = undefined;\r\n\t\t\tlet preCmdStackFrame = undefined;\r\n\t\t\tconst plot = chapter.plots[nPlot];\r\n\t\t\tnIndex++;\r\n\r\n\t\t\tif (type === 'option') { \r\n\t\t\t\tif (plot.options[eArg]) {\r\n                    const frame = {};\r\n                    frame.type = 'options';\r\n                    frame.index = eArg;\r\n                    frame.loopCondition = null;\r\n                    frame.loopCount = 1;\r\n                    context.stack = [frame, ...context.stack];\r\n                    nChapter = {plots: plot.options[eArg].plots, parent: {pChapter: nChapter, pnPlot: nPlot}, uuid: chapter.uuid};\r\n                    nIndex = 0;\r\n\t\t\t\t}\r\n\t\t\t} else if (plot && !plot.insert && !plot.jump && !plot.back && !type) {\r\n                const condOptIndex = (plot.condition_options || []).findIndex(option => {\r\n                    return Expression.safeEval(option.expression, context)\r\n                        && (option.count ? parseInt(Expression.safeEval(option.count, context)) > 0 : true)\r\n                });\r\n                const condOpt = condOptIndex < 0 ? null : plot.condition_options[condOptIndex];\r\n                if (condOpt) {\r\n                    const frame = {};\r\n                    frame.type = 'condition_options';\r\n                    frame.index = condOptIndex;\r\n                    frame.loopCondition = \"loop\" === condOpt.type || \"countLoop\" === condOpt.type ? condOpt.expression : null;\r\n                    frame.loopCount = 1;\r\n                    frame.loopCountExpr = condOpt.count;\r\n                    context.stack = [frame, ...context.stack];\r\n                    nIndex = 0;\r\n                    nChapter = {plots: condOpt.plots, parent: {pChapter: chapter, pnPlot: nPlot}, uuid: chapter.uuid};\r\n                }\r\n\t\t\t}\r\n\r\n\t\t\tif (plot && ((plot.jump && !type) || (plot.jump && 'nextPlot' === type) || type === 'jump')) {\r\n\t\t\t\tlet jumpUuid = type === 'jump' ? eArg : plot.jump;\r\n\t\t\t\tconst jumpChapter = searchChapterByUUID(game, jumpUuid);\r\n\t\t\t\tif (jumpChapter) {\r\n\t\t\t\t\tnChapter = jumpChapter;\r\n\t\t\t\t\tnIndex = 0;\r\n\t\t\t\t\tcontext.stack = [];\r\n\t\t\t\t\tcontext.cmdStack = [];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (plot && (plot.back ||  type === 'back')) {\r\n\t\t\t\tnIndex = -2;\r\n\t\t\t\tcontext.stack = [];\r\n\t\t\t}\r\n\r\n            if (plot && type === 'jumpOption') {\r\n                context = JSON.parse(JSON.stringify(this.context));\r\n\r\n                for (let t = 0; t < eArg; t++) {\r\n                    if (!nChapter.parent) {\r\n                        break;//return false;\r\n                    }\r\n                    if (context.stack[0] && context.stack[0].type !== 'insert') {\r\n                        context.stack = context.stack.splice(1);\r\n                        nIndex = nChapter.parent.pnPlot;\r\n                        nChapter = nChapter.parent.pChapter;\r\n                    } else {\r\n                    \tbreak;\r\n\t\t\t\t\t}\r\n                }\r\n                if (-1 !== nIndex) {\r\n                    this.context = context;\r\n                    nIndex++;\r\n                }\r\n            }\r\n\r\n            if (plot && type === 'backOption') {\r\n                context = JSON.parse(JSON.stringify(this.context));\r\n                for (let t = 0; t < eArg; t++) {\r\n                    if (!nChapter.parent) {\r\n                        break;//return false;\r\n                    }\r\n                    if (context.stack[0] && context.stack[0].type !== 'insert') {\r\n                        context.stack = context.stack.splice(1);\r\n                        nIndex = nChapter.parent.pnPlot;\r\n                        nChapter = nChapter.parent.pChapter;\r\n                    } else {\r\n                    \tbreak;\r\n\t\t\t\t\t}\r\n                }\r\n                if (-1 < nIndex) {\r\n                    this.context = context;\r\n                    return {chapter: nChapter, nIndex: nIndex, context: context};\r\n                }\r\n            }\r\n\r\n\t\t\tif (plot && (plot.insert && !type || type === 'insertPlot' && eArg)) {\r\n\t\t\t\tconst chapterUuid = eArg || plot.insert;\r\n\t\t\t\tconst c = searchChapterByUUID(game, chapterUuid);\r\n\t\t\t\tif (c) {\r\n\t\t\t\t\tconst frame = {};\r\n\t\t\t\t\tframe.type = 'insert';\r\n\t\t\t\t\tframe.isCommand = chapter.plots[nPlot].commands ? true : false;\r\n\t\t\t\t\tframe.cmdInfo = frame.isCommand ? this.curCmdInfo : null;\r\n\t\t\t\t\tframe.cmdIndex = frame.isCommand ? this.curCmdIndex : null;\r\n\t\t\t\t\tframe.cmdScreenSnap = frame.isCommand ? this.getCmdScreenSnap() : null;\r\n                    frame.isCommand && (context.cmdStack = [{type:'insert'}, ...context.cmdStack]);\r\n\t\t\t\t\tframe.loopCondition = null;\r\n\t\t\t\t\tframe.loopCount = 1;\r\n\t\t\t\t\tframe.pPlotUuid = nChapter.plots[nIndex-1].uuid;\r\n\t\t\t\t\tframe.chapterUuid = nChapter.uuid;\r\n                    frame.animateScene = {shake:null};\r\n\t\t\t\t\tframe.animateScene.shake = this.getScreenAnime().commands;//获取振动效果\r\n\t\t\t\t\tcontext.stack = [frame, ...context.stack];\r\n\t\t\t\t\tnChapter = {plots:c.plots, md5:c.md5, uuid:c.uuid, downloadUuid: c.downloadUuid, charge: c.charge, parent:{pChapter:nChapter, pnPlot:nIndex - 1}};\r\n\t\t\t\t\tnIndex = 0;\r\n\r\n\t\t\t\t\tif (this.mainMenuLayer.visible)\r\n            \t    {\r\n            \t    \tif (this.mainMenuLayer.children[1] && this.mainMenuLayer.children[1].isMenu) {\r\n            \t    \t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_DESTROY_VIEW, {name:this.mainMenuLayer.children[1].name, isMainMenu: true});\r\n\t\t\t\t\t\t}\r\n                \t    this.onMainMenuBackBtnClicked();\r\n                \t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\twhile ((!nChapter.plots[nIndex] && nIndex !== 0 && nChapter.plots.length && context.stack && 0 < context.stack.length)\r\n\t\t\t\t\t|| (!nChapter.plots[nIndex] && nIndex === 0 && !nChapter.plots.length && !nChapter.md5 && context.stack && 0 < context.stack.length)) {\r\n                //context.stack有值\r\n                const frame = context.stack[0];\r\n                if (frame.loopCondition && Expression.safeEval(frame.loopCondition, context)) {\r\n                    //满足循环条件\r\n                    nIndex = 0;\r\n                    if (frame.loopCount) {\r\n                        frame.loopCount++;\r\n                    }\r\n                    if (frame.loopCountExpr) {\r\n                        const count = parseInt(Expression.safeEval(frame.loopCountExpr, context));\r\n                        if (frame.loopCount <= count) {\r\n                            //满足次数循环条件\r\n                            break;\r\n                        }\r\n                    } else {\r\n                        break;\r\n                    }\r\n                }\r\n                context.stack = context.stack.splice(1);\r\n                if (frame.type === 'insert' && context.cmdStack.length && context.cmdStack[0].type && context.cmdStack[0].type === 'insert') {\r\n                    preCmdStackFrame = context.cmdStack[0];\r\n                    context.cmdStack = context.cmdStack.splice(1);\r\n                    this.saveBubbleDataVector = this.getBubbleData(true).concat();\r\n\r\n                    // 修复flash存档数据高级剧情insert部分\r\n                    if (context.commandInserts) {\r\n                        for (let i=0; i<context.commandInserts.length; i++) {\r\n                            if (frame.pPlotUuid !== context.commandInserts[i].uuid) {\r\n                                continue;\r\n                            }\r\n                            const result = this.getChapterByPlotUuid(this.json_data, frame.pPlotUuid, frame.chapterUuid);\r\n                            if (null === result || result.chapter && result.index === -4) {\r\n                                break;\r\n                            }\r\n                            const cmdResult = this.getCommandByCommandUuid(result.chapter.plots[result.index], context.commandInserts[i].data.commandUuid);\r\n                            frame.cmdInfo = cmdResult.cmdInfo;\r\n                            frame.cmdIndex = cmdResult.cmdIndex;\r\n\r\n                            if (context.commandInserts[i].data.historyCommand) {\r\n                                let snap = {charsAndProps:[], sounds: Array(12), music: null, plotViews: [], menuInfo: []};\r\n                                let {images, dialog, autoText, weather, viewsData} = context.commandInserts[i].data.historyCommand;\r\n                                snap.autoText = autoText ? autoText.args[0] : false;\r\n                                snap.dialogInfo = dialog && dialog.command ? dialog.command.args : [];\r\n                                snap.weatherType = weather ? weather.args[0] : '';\r\n                                if (images) {\r\n                                    for (let v=0; v<images.length; v++) {\r\n                                        if (images[v].index > 1) {\r\n                                            let item = {url:images[v].url, x:images[v].x, y:images[v].y, width:images[v].width, height:images[v].height, opacity: images[v].opacity\r\n                                                , rotate:images[v].rotate, index:images[v].index};\r\n                                            snap.charsAndProps.push(item);\r\n                                        }\r\n                                        else if (images[v].index === 1) {\r\n                                            snap.bk = {url:images[v].url, opacity:images[v].opacity};\r\n                                        }\r\n                                    }\r\n                                }\r\n                                if (viewsData && viewsData.length) {\r\n                                    for (let j=0; j<viewsData.length; j++) {\r\n                                        snap.plotViews[j] = this.copyFlashViewData(viewsData[j]);\r\n                                        snap.plotViews[j].x = 0;\r\n                                        snap.plotViews[j].y = 0;\r\n                                        snap.plotViews[j].parent = 'plotViewsLayer';\r\n                                    }\r\n                                }\r\n                                frame.cmdScreenSnap = snap;\r\n                            }\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (nChapter.parent && 'insert' !== frame.type) {\r\n                    cmdPlotSnap.cmdIndex = frame.isCommand ? frame.cmdIndex+1 : -1;\r\n                    cmdPlotSnap.cmdInfo = frame.cmdInfo;\r\n                    cmdPlotSnap.cmdScreenSnap = frame.cmdScreenSnap;\r\n                    nIndex = frame.isCommand ? nChapter.parent.pnPlot : nChapter.parent.pnPlot + 1;\r\n                    nChapter = nChapter.parent.pChapter;\r\n                    //修复flash存档普通剧情insert部分\r\n                    if(context.inserts && context.inserts.length && !nChapter.plots[nIndex] && context.stack.length <= 0){\r\n\t\t\t\t\t\tconst {chapterUuid,plotUuid} = context.inserts.pop();\r\n                        const serchchapter = searchChapterByUUID(game,chapterUuid);\r\n                        if(!serchchapter) break;\r\n                        nChapter = serchchapter;\r\n                        nIndex = plotUuid;\r\n                    }\r\n                    this.saveBubbleDataVector = this.getBubbleData(true).concat();\r\n                } else if (frame.pPlotUuid && frame.type === 'insert') {\r\n                    cmdPlotSnap.cmdIndex = frame.isCommand ? frame.cmdIndex+1 : -1;\r\n                    cmdPlotSnap.cmdInfo = frame.cmdInfo;\r\n                    cmdPlotSnap.cmdScreenSnap = frame.cmdScreenSnap;\r\n                    cmdPlotSnap.bubble = frame.bubble ? frame.bubble.concat() : [];\r\n                    if(frame.animateScene && frame.animateScene.shake !== null){\r\n                        cmdPlotSnap.animateScene.shake = Object.assign(frame.animateScene.shake,{})\r\n\t\t\t\t\t}\r\n                    const {chapter: c, index: n} = this.getChapterByPlotUuid(this.json_data, frame.pPlotUuid, frame.chapterUuid);\r\n                    nIndex = frame.isCommand ? n : n+1;\r\n                    nChapter = c;\r\n                    preStackFrame = frame;\r\n                    this.saveBubbleDataVector = this.getBubbleData(true).concat();\r\n                }\r\n\t\t\t};\r\n\t\t\treturn {chapter: nChapter, nIndex: nIndex, cmdPlotSnap, context, preStackFrame, preCmdStackFrame}\r\n\t\t},\r\n\r\n\t\tgetNextCommand: function (context, cmdInfo, index, action) {\r\n            let {Expression} = this;\r\n            let rCmdInfo = cmdInfo;\r\n            let rIndex = index;\r\n            rIndex++;\r\n\r\n            if ('options' === action.type) {\r\n                const args = cmdInfo.commands[index].args;\r\n                if (action.index >= 0 && args[action.index].commands.length > 0) {\r\n                    const frame = {};\r\n                    frame.loopCondition = null;\r\n                    frame.loopCount = 1;\r\n                    context.cmdStack = [frame, ...context.cmdStack];\r\n\r\n                    rIndex = 0;\r\n                    rCmdInfo = {commands: args[action.index].commands, parentInfo: cmdInfo, parentCmdIndex: index};\r\n                }\r\n                else {\r\n                    this.optionLayer.destroy();\r\n                }\r\n            }\r\n            else if ('cdtOptions' === action.type) {\r\n                const args = cmdInfo.commands[index].args;\r\n                const condOptIndex = (args).findIndex(option => {\r\n                    return Expression.safeEval(option.expression, context)\r\n                        && (option.count ? parseInt(Expression.safeEval(option.count, context)) > 0 : true)\r\n                });\r\n                const condOpt = condOptIndex < 0 ? null : args[condOptIndex];\r\n                if (condOpt) {\r\n                    const frame = {};\r\n                    frame.loopCondition = \"loop\" === condOpt.type || \"countLoop\" === condOpt.type ? condOpt.expression : null;\r\n                    frame.loopCount = 1;\r\n                    frame.loopCountExpr = condOpt.count;\r\n                    context.cmdStack = [frame, ...context.cmdStack];\r\n                    rIndex = 0;\r\n                    rCmdInfo = {commands: condOpt.commands, parentInfo: cmdInfo, parentCmdIndex: index};\r\n\t\t\t\t}\r\n            }\r\n            else if ('backOption' === action.type) {\r\n                for (let i=0; i<action.eArg; i++) {\r\n                \tif (!rCmdInfo.parentInfo) {\r\n                \t\tbreak;\r\n\t\t\t\t\t}\r\n                    if (context.cmdStack[0] && context.cmdStack[0].type !== 'insert') {\r\n                        context.cmdStack = context.cmdStack.splice(1);\r\n                        rIndex = rCmdInfo.parentCmdIndex;\r\n                        rCmdInfo = rCmdInfo.parentInfo;\r\n                    } else {\r\n                        break;\r\n                    }\r\n                }\r\n                if (rIndex > -1 && rCmdInfo.commands) {\r\n                \treturn {info: rCmdInfo, index: rIndex};\r\n                }\r\n            }\r\n            else if ('jumpOption' === action.type) {\r\n                for (let i=0; i<action.eArg; i++) {\r\n                \tif (!rCmdInfo.parentInfo) {\r\n                \t\tbreak;\r\n\t\t\t\t\t}\r\n                    if (context.cmdStack[0] && context.cmdStack[0].type !== 'insert') {\r\n                        context.cmdStack = context.cmdStack.splice(1);\r\n                        rIndex = rCmdInfo.parentCmdIndex;\r\n                        rCmdInfo = rCmdInfo.parentInfo;\r\n                    } else {\r\n                \t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n                rIndex++;\r\n\t\t\t}\r\n\r\n            while (rCmdInfo && !rCmdInfo.commands[rIndex] && context.cmdStack && 0 < context.cmdStack.length) {\r\n                const frame = context.cmdStack[0];\r\n                if (frame.loopCondition && Expression.safeEval(frame.loopCondition, context)) {\r\n                    //满足循环条件\r\n                    rIndex = 0;\r\n                    if (frame.loopCount) {\r\n                        frame.loopCount++;\r\n                    }\r\n                    if (frame.loopCountExpr) {\r\n                        const count = parseInt(Expression.safeEval(frame.loopCountExpr, context));\r\n                        if (frame.loopCount <= count) {\r\n                            //满足次数循环条件\r\n                            break;\r\n                        }\r\n                    } else {\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                if (!frame.type || frame.type !== 'insert') {\r\n                    context.cmdStack = context.cmdStack.splice(1);\r\n                }\r\n\r\n                if (frame.type && frame.type === 'insert') {\r\n                    rIndex = -1;\r\n                    rCmdInfo = null;\r\n\t\t\t\t}\r\n                else if (rCmdInfo.parentInfo) {\r\n                    rIndex = rCmdInfo.parentCmdIndex + 1;\r\n                    rCmdInfo = rCmdInfo.parentInfo;\r\n\t\t\t\t}\r\n            }\r\n\r\n            return {info: rCmdInfo, index: rIndex};\r\n        },\r\n\r\n\t\tremoveInputView: function (layer) {\r\n            if (layer.inputElement) {\r\n                layer.inputElement.destroy();\r\n            }\r\n            else if (layer.children && layer.children.length) {\r\n                for (let i = 0; i < layer.children.length; i++) {\r\n                    this.removeInputView(layer.children[i]);\r\n                }\r\n            }\r\n        },\r\n\r\n        removeViewTimer: function (view) {\r\n            if (view.viewType === 'TIMER') {\r\n                if (view.timerType === 'timeOut') {\r\n                    clearTimeout(view.timerHandler);\r\n                } else {\r\n                    clearInterval(view.timerHandler);\r\n                }\r\n                return;\r\n            }\r\n            else {\r\n                view.children.forEach(v => this.removeViewTimer(v));\r\n            }\r\n        },\r\n\r\n\t\tfilterInexistentPlotViews: function (views, plotInfo) {\r\n\t\t\t// 过滤高级剧情中已移除的高级UI\r\n\t\t\tif (!plotInfo.commands || 0 === plotInfo.commands.length) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst isUuidExist = (uuid, cmdInfo) => {\r\n\t\t\t\tfor (let i=0; i<cmdInfo.length; i++) {\r\n\t\t\t\t\tif (cmdInfo[i].uuid === uuid) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if ('options' === cmdInfo[i].type || 'conditionOptions' === cmdInfo[i].type) {\r\n\t\t\t\t\t\tfor (let j=0; j<cmdInfo[i].args.length; j++) {\r\n\t\t\t\t\t\t\tif (isUuidExist(uuid, cmdInfo[i].args[j].commands)) {\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\t\t\tfor (let i=0; i<views.length; i++) {\r\n\t\t\t\tif (!views[i].generateType) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tconst cmdUuid = views[i].generateType;\r\n\t\t\t\tif (isUuidExist(cmdUuid, plotInfo.commands)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tviews.splice(i, 1);\r\n\t\t\t\ti--;\r\n\t\t\t}\r\n        },\r\n\r\n\t\tdestroyAll: function () {\r\n            this.playBackLayer.removeAll(true);\r\n            this.globalViews && this.globalViews.forEach(s => {\r\n                this.removeInputView(s);\r\n                s.destroy && s.destroy()\r\n            });\r\n            this.globalViews = null;\r\n            this.plotViewsLayer.children.forEach(c => {\r\n\t\t\t\tthis.removeViewTimer(c);\r\n            \tthis.removeInputView(c)\r\n            });\r\n            this.plotViewsLayer.removeAll(true);\r\n            if ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n            \tPhoneUtils.stopMusic();\r\n            \tPhoneUtils.removeAudioUrl(PhoneUtils.musicInfo.key);\r\n            \t\r\n            \tfor (let i=0; i<10; i++) {\r\n            \t\tif (PhoneUtils.soundsInfo[i].key) {\r\n            \t\t\tPhoneUtils.stopSound(i);\r\n            \t\t\tPhoneUtils.removeAudioUrl(PhoneUtils.soundsInfo[i].key);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n                this.bk_music && this.bk_music.destroy();\r\n                this.bk_music = null;\r\n                this.plotSounds && this.plotSounds.forEach(s => s && s.destroy());\r\n                this.plotSounds = [];\r\n\t\t\t}\r\n\r\n            if (this.lstPlotLayer) {\r\n                this.lstPlotLayer.destroy();\r\n                this.lstPlotLayer = null;\r\n            }\r\n        },\r\n\r\n\t\treStart: function (isextend = false) {\r\n            //重播调用app  结束接口\r\n            if (flashvars.client === 'ios') {\r\n                if(flashvars.offline === 1){\r\n                    javascript:workFinished('1');\r\n                }else{\r\n                    window.webkit && window.webkit.messageHandlers.workFinished.postMessage('1');\r\n                }\r\n            }\r\n            else if (flashvars.client === 'android') {\r\n                window.app && window.app.workFinished('1');\r\n            }\r\n            this.dialogLayer.visible = false;\t\t// 隐藏对话框层\r\n\t\t\tthis.unlockChapterCallBack = null;\t\t// 清除解锁回调\r\n\t\t\tthis.mallPayCallback = null;\r\n\t\t\tthis.destroyAll();\r\n            if (this.bubbleLayer.children.length > 0){\r\n                this.bubbleLayer.removeAll(true);\r\n            }\r\n            this.saveBubbleVector = [];\r\n            this.bubbleArchivalCount = [];\r\n\t\t\tthis.initContext(this.context);\r\n            const back = ()=>{\r\n                if (!this.json_data.cover.hidden) {\r\n                    return this.showCover();// 创建封面\r\n                } else {\r\n                    const chapter = this.findFirstChapter();\r\n                    const chapterUuid = chapter.downloadUuid ? chapter.downloadUuid : chapter.uuid;\r\n\r\n                    //第三方\r\n                    if(this.isWapOther()){\r\n                        this.checkIfChapterFree(chapterUuid, chapter.md5).then((plots)=>{\r\n                            chapter.plots.push(...plots);\r\n                            this.preloadChapterAssets(this.context, chapter,undefined,undefined,undefined,true);\r\n                        },(msg)=>{\r\n                            //章节需要付费\r\n                            if (-1 === msg.indexOf('code=87')) {\r\n                                Dialog.error(msg);\r\n                            } else { // 未购买此章节\r\n                                this.unlockChapterByWapOther(chapterUuid, chapter.charge, chapter.md5, null)\r\n                            }\r\n                        });\r\n                        return;\r\n                    }\r\n\r\n                    if (chapter.md5 && chapter.plots.length === 0) {\r\n                        if (chapter.charge && ('android' === flashvars.client || 'ios' === flashvars.client || flashvars.client === 'wap')) {\r\n                            const unlockFinish = (bSuccess) => {\r\n                                if (bSuccess) {\r\n                                    this.checkIfChapterFree(chapterUuid, chapter.md5).then((plots)=>{\r\n                                        this.unlockChapterCallBack = null;\r\n                                        chapter.plots = plots;\r\n                                        this.preloadChapterAssets(this.context, chapter,undefined,undefined,undefined,true);\r\n                                    }, () => {\r\n                                        if(flashvars.client === 'wap'){\r\n                                            window.parent && window.parent.playLogin();\r\n                                        }else{\r\n                                            Dialog.error('获取付费章节信息失败')\r\n\t\t\t\t\t\t\t\t\t\t}\r\n                                    })\r\n                                }\r\n                            };\r\n\r\n                            this.unlockChapter(chapterUuid, chapter.charge, chapter.md5, unlockFinish);\r\n                        } else {\r\n                            this.checkIfChapterFree(chapterUuid, chapter.md5).then((plots)=>{\r\n                                chapter.plots = plots;\r\n                                this.preloadChapterAssets(this.context, chapter,undefined,undefined,undefined,true);\r\n                            }, (msg)=>{\r\n                                if (-1 === msg.indexOf('code=87')) {\r\n                                    Dialog.error(msg);\r\n                                } else { // 未购买此章节\r\n                                    if(flashvars.wap === 'zxwwap'){\r\n                                        Dialog.info('当前为收费章节，是否前往闪艺抢先体验？').then(()=>{\r\n                                            window.location.href = 'https://wap.3000.com/?m=detail&op=index&ac=index&id='+ flashvars.gid;\r\n                                        })\r\n                                    }else{\r\n                                        Dialog.info('当前为收费章节，请前往闪艺app或电脑端进行购买');\r\n\t\t\t\t\t\t\t\t\t}\r\n                                }\r\n                            })\r\n                        }\r\n                    } else {\r\n                        this.preloadChapterAssets(this.context, chapter,undefined,undefined,undefined,true);\r\n                    }\r\n                }\r\n            };\r\n\t\t\tif(isextend !== false){\r\n\t\t\t\t//推广返回封面\r\n\t\t\t\tDialog.custom(\"Info\",\"没体验够？下载闪艺APP，继续玩！\",\"提示\",\"下载闪艺\",\"取消\").then(()=>{\r\n                    window.location.href = \"http://app.3000.com/\"\r\n\t\t\t\t},(rj)=>{\r\n\t\t\t\t\tback();\r\n\t\t\t\t})\r\n\t\t\t}else{\r\n\t\t\t\tback();\r\n\t\t\t}\r\n\t\t},\r\n\r\n        /**\r\n\t\t * 数值操作\r\n         * @param context\t\t\tcontext\r\n         * @param values\t\t\t数值\r\n         * @param bCancelUpload\t\t是否上传保存分数\r\n         * @param callback\t\t\t数值操作回调函数\r\n         */\r\n\t\tvalueOperation: function (context, values, bCancelUpload,callback=null,ispay=false) {\r\n\t\t\tthis.isSetValues = true;//数值操作中\r\n\t\t\t//上传保存数值\r\n\t\t\tconst uploadPayValue = ()=>{\r\n\t\t\t\t//上传payvalue 数值\r\n                return this.savePayInfo().then(()=>{ return this.saveAccountInfo()})\r\n\t\t\t}\r\n\t\t\t//\r\n\t\t\tconst indexValueOperator = (index, v, reference) => {\r\n\t\t\t\tif (!reference) {\r\n\t\t\t\t\tif (v < 1) {\r\n                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n\t\t\t\t\t}\r\n                    else if (context.indexValues[index].init.type === 'value' && v>context.values.length) {\r\n                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (context.indexValues[index].init.type === 'savedValue' && v>context.savedValues.length) {\r\n                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (context.indexValues[index].init.type === 'stringValue' && v>context.stringValues.length) {\r\n                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (context.indexValues[index].init.type === 'payValue' && v>context.payValues.length) {\r\n                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcontext.indexValues[index].value = v;\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\r\n                const i = context.indexValues[index].value === undefined ? context.indexValues[index].init.value-1 : context.indexValues[index].value-1;\r\n\t\t\t\tif (context.indexValues[index].init.type === 'value') {\r\n\t\t\t\t\tif (i<0 || i>=context.values.length) {\r\n\t\t\t\t\t\tDialog.info('出现未知数值操作，请联系作者检查修改');\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n                    context.values[i].value = v;\r\n\t\t\t\t}\r\n                else if (context.indexValues[index].init.type === 'savedValue') {\r\n                    if (i<0 || i>=context.savedValues.length) {\r\n                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n                        return;\r\n                    }\r\n                    context.savedValues[i].value = v;\r\n                }\r\n                else if (context.indexValues[index].init.type === 'stringValue') {\r\n                    if (i<0 || i>=context.stringValues.length) {\r\n                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n                        return;\r\n                    }\r\n                    context.stringValues[i].value = v;\r\n                }\r\n                else if (context.indexValues[index].init.type === 'payValue') {\r\n                    if (i<0 || i>=context.payValues.length) {\r\n                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n                        return;\r\n                    }\r\n                    isupload = true;\r\n                    context.payValues[i].value = v;\r\n                }\r\n\t\t\t};\r\n\r\n\t\t\tif (values && values.length > 0) {\r\n\t\t\t\tlet i = 0;\r\n\t\t\t\tconst isnext = (i)=>{\r\n\t\t\t\t\tif(i >= values.length - 1){\r\n                        uploadPayValue().then(()=>{\r\n                            if(callback !== null) {this.isSetValues = false;callback()}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn i < values.length - 1;\r\n\t\t\t\t}\r\n\t\t\t\tconst setvalues = (i)=>{\r\n                    let value = values[i];\r\n                    const v = this.Expression.safeEval(value.expression, this.context);\r\n                    const uuid = value.uuid;\r\n                    let index;\r\n                    if ((index = this.context.values.findIndex(v => v.uuid === uuid)) !== -1) {\r\n                        context.values[index].value = v;\r\n                        isnext(i) && setvalues(i+=1);\r\n                    }\r\n                    else if ((index = this.context.savedValues.findIndex(v => v.uuid === uuid)) !== -1) {\r\n                        context.savedValues[index].value = v;\r\n                        Utils.localStorageSetItem(flashvars.uuid + 'savedValues' + flashvars.uid, JSON.stringify(context.savedValues));\r\n                        isnext(i) && setvalues(i+=1);\r\n                    }\r\n                    else if ((index = this.context.stringValues.findIndex(v => v.uuid === uuid)) !== -1) {\r\n                        context.stringValues[index].value = v;\r\n                        isnext(i) && setvalues(i+=1);\r\n                    }\r\n                    else if ((index = this.context.payValues.findIndex(v => v.uuid === uuid)) !== -1) {\r\n                        context.payValues[index].value = v;\r\n                        isnext(i) && setvalues(i+=1)\r\n                    }\r\n                    else if ((index = this.context.indexValues.findIndex(v => v.uuid === uuid)) !== -1) {\r\n                        indexValueOperator(index, v, value.reference);\r\n                        isnext(i) && setvalues(i+=1);\r\n                    }\r\n                    else {\r\n                        console.error('Cannot find value/savedValue with uuid = ', uuid);\r\n                        isnext(i) && setvalues(i+=1);\r\n                    }\r\n\t\t\t\t};\r\n                setvalues(i);\r\n\t\t\t}else{\r\n                if(callback !== null) {this.isSetValues = false;callback()}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tupdateValues: function (oldContext) {\r\n\t\t\tlet tempValues = JSON.parse(JSON.stringify(this.json_data.values));\r\n\t\t\tfor (let i=0; i<oldContext.values.length; i++) {\r\n\t\t\t\tfor (let j=0; j<tempValues.length; j++) {\r\n\t\t\t\t\tif (tempValues[j].uuid === oldContext.values[i].uuid) {\r\n\t\t\t\t\t\ttempValues[j].value = oldContext.values[i].value;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\toldContext.values = tempValues.concat();\r\n\r\n\t\t\ttempValues = JSON.parse(JSON.stringify(this.json_data.savedValues));\r\n            for (let i=0; i<oldContext.savedValues.length; i++) {\r\n                for (let j=0; j<tempValues.length; j++) {\r\n                    if (tempValues[j].uuid === oldContext.savedValues[i].uuid) {\r\n                        tempValues[j].value = oldContext.savedValues[i].value;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            oldContext.savedValues = tempValues.concat();\r\n\r\n            tempValues = JSON.parse(JSON.stringify(this.json_data.stringValues));\r\n            for (let i=0; i<oldContext.stringValues.length; i++) {\r\n                for (let j=0; j<tempValues.length; j++) {\r\n                    if (tempValues[j].uuid === oldContext.stringValues[i].uuid) {\r\n                        tempValues[j].value = oldContext.stringValues[i].value;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            oldContext.stringValues = tempValues.concat();\r\n\r\n            if (this.json_data.payValues) {\r\n                tempValues = JSON.parse(JSON.stringify(this.json_data.payValues));\r\n                if (oldContext.payValues) {\r\n                    for (let i=0; i<oldContext.payValues.length; i++) {\r\n                        for (let j=0; j<tempValues.length; j++) {\r\n                            if (tempValues[j].uuid === oldContext.payValues[i].uuid) {\r\n                                tempValues[j].value = oldContext.payValues[i].value;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n\t\t\t\t}\r\n                oldContext.payValues = tempValues.concat();\r\n            }\r\n\r\n            if (this.json_data.indexValues) {\r\n                tempValues = JSON.parse(JSON.stringify(this.json_data.indexValues));\r\n                if (oldContext.indexValues) {\r\n                    for (let i=0; i<oldContext.indexValues.length; i++) {\r\n                        for (let j=0; j<tempValues.length; j++) {\r\n                            if (tempValues[j].uuid === oldContext.indexValues[i].uuid) {\r\n                                tempValues[j].value = oldContext.indexValues[i].value;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                oldContext.indexValues = tempValues.concat();\r\n\t\t\t}\r\n\r\n        },\r\n\r\n\t\tinitContext: function (oldContext, isLoad) {\r\n\t\t\tconst copy = (obj) => {\r\n\t\t\t\tif (!obj) {\r\n\t\t\t\t\treturn obj;\r\n\t\t\t\t}\r\n\t\t\t\treturn JSON.parse(JSON.stringify(obj))\r\n\t\t\t};\r\n\t\t\tconst context = {};\r\n\t\t\tisLoad && this.updateValues(oldContext);\r\n\t\t\tcontext.auto = this.context && this.context.auto || false;\r\n\t\t\tcontext.fullScreen = this.context && this.context.fullScreen || false;\r\n            context.savedValues = copy(oldContext && oldContext.savedValues || this.json_data.savedValues);\r\n            if (!oldContext && !isLoad) {\r\n                const strSavedValues = Utils.localStorageGetItem(flashvars.uuid + 'savedValues' + flashvars.uid);\r\n                if (strSavedValues) {\r\n                    const lstSavedValues = JSON.parse(strSavedValues);\r\n                    for (let i=0; i<lstSavedValues.length; i++) {\r\n                    \tfor (let j=0; j<context.savedValues.length; j++) {\r\n                    \t\tif (context.savedValues[j].uuid === lstSavedValues[i].uuid) {\r\n                    \t\t\tcontext.savedValues[j].value = lstSavedValues[i].value;\r\n                    \t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n                }\r\n\t\t\t}\r\n            if (isLoad) {\r\n                context.values = copy(oldContext.values);\r\n                context.stringValues = copy(oldContext.stringValues);\r\n                context.payValues = copy(this.context.payValues);\r\n                context.indexValues = copy(oldContext.indexValues);\r\n            }\r\n            else {\r\n                context.values = copy(this.json_data.values);\r\n                context.stringValues = copy(this.json_data.stringValues);\r\n                context.payValues = copy(this.json_data.payValues ? this.json_data.payValues : this.context.payValues);\r\n                context.indexValues = copy(this.json_data.indexValues ? this.json_data.indexValues : this.context.indexValues);\r\n                for (let i=0; i<context.payValues.length; i++) {\r\n                \tfor (let j=0; j<this.context.payValues.length; j++) {\r\n                        if (context.payValues[i].uuid === this.context.payValues[j].uuid) {\r\n                            context.payValues[i].value = this.context.payValues[j].value;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (this.json_data.systemValues) {\r\n                context.systemValues = copy(this.json_data.systemValues);\r\n                if (context.systemValues.length===1) {\r\n                    context.systemValues = context.systemValues.concat([{},{},{},{},{},{},{},{},{},{}]);\r\n\t\t\t\t} else if (context.systemValues.length===9) {\r\n                    context.systemValues = context.systemValues.concat([{},{}]);\r\n\t\t\t\t} else if (context.systemValues.length===10) {\r\n                \tcontext.systemValues = context.systemValues.concat([{}]);\r\n\t\t\t\t}\r\n                context.systemValues[0].value = this.context.systemValues[0].value;\r\n                context.systemValues[1].value = this.context.systemValues[1].value;\r\n                context.systemValues[9].value = this.context.systemValues[9].value;\r\n            }\r\n\t\t\telse {\r\n                context.systemValues = copy(this.context.systemValues);\r\n\t\t\t}\r\n\r\n\t\t\tif (-1 === Utils.timeStamp) {\r\n                Utils.getTimeOffset().then(() => {Utils.updateContextTimeValues(context)}, null);\r\n            }\r\n            else {\r\n                let date = new Date(Utils.timeStamp * 1000);\r\n                context.systemValues[2].value = Utils.timeStamp;\r\n                context.systemValues[3].value = date.getFullYear();\r\n                context.systemValues[4].value = date.getMonth() + 1;\r\n                context.systemValues[5].value = date.getDate();\r\n                context.systemValues[6].value = date.getHours();\r\n                context.systemValues[7].value = date.getMinutes();\r\n                context.systemValues[8].value = date.getSeconds();\r\n                context.systemValues[10].value = date.getDay();\r\n\t\t\t}\r\n\r\n            if (isLoad && oldContext && oldContext.stack) {\r\n                context.stack = copy(oldContext.stack);\r\n\t\t\t\tcontext.cmdStack = copy(oldContext.cmdStack);\r\n            } else {\r\n                context.stack = [];\r\n                context.cmdStack = [];\r\n            }\r\n\t\t\tthis.context = context;\r\n\t\t},\r\n\r\n\t\tdoInCT: function (context, func) {\r\n\t\t\tif (context !== this.context) {\r\n\t\t\t\treturn Promise.reject('timeline changed');\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn func();\r\n\t\t\t}\r\n\t\t},\r\n\r\n        txtLineSpace: function (fontSize) {\r\n            let space = 0;\r\n            if (fontSize==12 || fontSize==14 || fontSize==16 || fontSize==18) space = -4 + fontSize / 2;\r\n            else if (fontSize < 19) space = -5 + fontSize / 2;\r\n            else if (fontSize < 28) space = -6 + fontSize / 2;\r\n            else if (fontSize < 37) space = -7 + fontSize / 2;\r\n            else if (fontSize < 46) space = -9 + fontSize / 2;\r\n            else if (fontSize < 56) space = -10 + fontSize / 2;\r\n            else space = (-Math.ceil(fontSize / 5)) + fontSize / 2;\r\n            !this.viewComponent.game.device.desktop && (space -= 2);\r\n            return space;\r\n        },\r\n\r\n\t\t/**更新music声音大小*/\r\n\t\tupdateMusicVolume:function (volume) {\r\n\t\t\tUtils.musicVolume = volume;\r\n            if ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n                PhoneUtils.updateMusicVolume('music',volume);\r\n            }else{\r\n                if(this.bk_music){\r\n                \tif(this.bk_music.prevolume === 0 && this.bk_music.volume !== 0){\r\n                        //还在动画中，有声音，记录的原始声音为0时\r\n                        this.bk_music.prevolume = this.bk_music.volume;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 如果存在插播音量\r\n\t\t\t\t\tlet value = (this.bk_music.inheritvolume !== undefined && this.bk_music.inheritvolume !== -1)  ? this.bk_music.inheritvolume * volume : this.bk_music.prevolume * volume;\r\n                    this.bk_music.volume  = value;\r\n                    for(let i = 0; i<this.lstPlotTweens.length;i++ ){\r\n                        let tween = this.lstPlotTweens[i];\r\n                        if(tween.target && (tween.target.animateMusic === 'music')){\r\n                            tween.pause();\r\n                            tween.stop(true);\r\n                        }\r\n                    }\r\n                }\r\n\t\t\t}\r\n\r\n        },\r\n        /**更新sound声音大小*/\r\n\t\tupdateSoundVolume:function (volume) {\r\n\t\t\tUtils.soundVolume = volume;\r\n            if('ios' === flashvars.client && '1.5.0' <= flashvars.app_version){\r\n                PhoneUtils.updateSoundVolume('sound',volume)\r\n            }else{\r\n                if(this.plotSounds && this.plotSounds.length > 0){\r\n                    for(let i =0; i< this.plotSounds.length;i++){\r\n                        let s = this.plotSounds[i];\r\n                        if(s){\r\n                            if(s.prevolume === 0 && s.volume !== 0){\r\n                                //还在动画中，有声音，记录的原始声音为0时\r\n                                s.prevolume = s.volume;\r\n                            }\r\n                            let value = (s.inheritvolume !== undefined && s.inheritvolume !== -1) ? s.inheritvolume * volume : s.prevolume * volume;\r\n\t\t\t\t\t\t\ts.volume = value;\r\n                        }\r\n                    }\r\n                }\r\n                for(let i = 0; i<this.lstPlotTweens.length;i++ ){\r\n                    let tween = this.lstPlotTweens[i];\r\n                    if(tween.target && (tween.target.animateMusic === 'sound')){\r\n                        tween.pause();\r\n                        tween.stop(true);\r\n                    }\r\n                }\r\n\t\t\t}\r\n\r\n        },\r\n\r\n\t\tstopMusic: function (nextToPlay, isViewEvent = false) {\r\n            if ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n            \tPhoneUtils.stopMusic(!isViewEvent);\r\n            } else {\r\n                if (nextToPlay && this.bk_music && nextToPlay === this.bk_music.key) {\r\n                    this.bk_music.stop();\r\n                } else if (this.bk_music) {\r\n                    this.bk_music.destroy();\r\n                    this.bk_music = null;\r\n                    this.decodeCacheAudio(nextToPlay);\r\n                }\r\n\t\t\t}\r\n\r\n            !isViewEvent && ResourcesManager.updateUsingKey({type:'music', key: ''});\r\n        },\r\n\r\n\t\tplayMusic: function (key, volume, loop, isViewEvent = false) {\r\n            ResourcesManager.updateUsingKey({type:'music', key});\r\n\t\t\tif ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n\t\t\t\tPhoneUtils.playMusic(key, volume, loop,Utils.musicVolume);\r\n\t\t\t} else {\r\n                if (!this.bk_music || key !== this.bk_music.key) {\r\n                    this.bk_music = this.viewComponent.game.add.sound(key, volume, loop);\r\n                    this.bk_music.prevolume = volume;\r\n                    this.bk_music.inheritvolume = -1;\r\n                }\r\n                this.bk_music.play();\r\n                this.bk_music.volume = this.bk_music.prevolume * Utils.musicVolume\r\n\t\t\t}\r\n        },\r\n\r\n\t\tplayInheritMusic: function (volume) {\r\n            if ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n            \tPhoneUtils.playInheritMusic(volume,Utils.musicVolume);\r\n            } else {\r\n                if (this.bk_music && volume !== undefined) {\r\n                \tthis.bk_music.inheritvolume = volume;//记录声音插播的音量\r\n                    this.bk_music.volume = volume * Utils.musicVolume;\r\n                }\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tstopSound: function (index, nextToPlay, isViewEvent = false) {\r\n\t\t\tif (null === index || undefined === index) return;\r\n            if ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n            \tPhoneUtils.stopSound(index);\r\n            } else {\r\n            \tif(index === -1){\r\n            \t\t//停止所有音效\r\n\t\t\t\t\tfor(let i = 0;i < this.plotSounds.length;i++){\r\n\t\t\t\t\t\tlet s = this.plotSounds[i];\r\n\t\t\t\t\t\tif(s){\r\n                            s.stop();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n                    if (nextToPlay && this.plotSounds[index] && nextToPlay === this.plotSounds[index].key) {\r\n                        this.plotSounds[index].stop();\r\n                    } else if (this.plotSounds[index]) {\r\n                        this.plotSounds[index].destroy();\r\n                        this.plotSounds[index] = null;\r\n                        this.decodeCacheAudio(nextToPlay);\r\n                    }\r\n\t\t\t\t}\r\n\r\n            }\r\n\r\n            !isViewEvent && ResourcesManager.updateUsingKey({type:'sound', key: '', index});\r\n        },\r\n\r\n\t\tplaySound: function (index, key, volume, loop, isViewEvent = false) {\r\n            ResourcesManager.updateUsingKey({type:'sound', key, index});\r\n\t\t\tif ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n\t\t\t\tPhoneUtils.playSound(index, key, volume, loop,Utils.soundVolume);\r\n\t\t\t} else {\r\n                if (!this.plotSounds[index] || this.plotSounds[index].key !== key) {\r\n                    this.plotSounds[index] = this.viewComponent.game.add.sound(key, volume, loop);\r\n                    this.plotSounds[index].prevolume = volume;\r\n                    this.plotSounds[index].inheritvolume = -1;\r\n                    this.plotSounds[index].volume *= Utils.soundVolume;\r\n                }\r\n                this.plotSounds[index].play();\r\n\t\t\t}\r\n        },\r\n\r\n\t\tplayInheritSound: function (index, volume) {\r\n\t\t\tif ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n\t\t\t\tPhoneUtils.playInheritSound(index, volume,Utils.soundVolume);\r\n\t\t\t} else {\r\n                if (this.plotSounds[index] && volume !== undefined) {\r\n                    this.plotSounds[index].inheritvolume = volume;\r\n                    this.plotSounds[index].volume *= Utils.soundVolume;\r\n                }\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tdecodeCacheAudio: function (nextToPlay) {\r\n\t\t\tif (nextToPlay) {\r\n\t\t\t\tlet sound = this.viewComponent.game.load.cache.getSound(nextToPlay);\r\n\t\t\t\tif (sound && !sound.decoded && !sound.isDecoding) {\r\n\t\t\t\t\tthis.viewComponent.game.sound.decode(nextToPlay);\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tlet countDecoded = 0;\r\n            let audioKeys = this.viewComponent.game.load.cache.getKeys(Phaser.Cache.SOUND);\r\n\t\t\tfor (let i in audioKeys) {\r\n\t\t\t\tlet sound = this.viewComponent.game.load.cache.getSound(audioKeys[i]);\r\n\t\t\t\tif (sound.decoded || sound.isDecoding) countDecoded++;\r\n\t\t\t\tif (countDecoded > 4) return;\r\n\t\t\t}\r\n            audioKeys.some(k => {\r\n                let sound = this.viewComponent.game.load.cache.getSound(k);\r\n                if (!sound.decoded && !sound.isDecoding) {\r\n                \tthis.viewComponent.game.sound.decode(k);\r\n                \treturn true;\r\n\t\t\t\t} else {\r\n                \treturn false;\r\n\t\t\t\t}\r\n            })\r\n        },\r\n\r\n\t\ttoRealImageFontHeight: function(size) {\r\n            const t = this.json_data.font.size.target.height ? this.json_data.font.size.target.height : this.json_data.font.size.target;\r\n            return (parseFloat(size) * t / this.json_data.font.size.source);\r\n\t\t},\r\n\r\n\t\ttoRealImageFontWidth: function (size) {\r\n            const t = this.json_data.font.size.target.width ? this.json_data.font.size.target.width : this.json_data.font.size.target;\r\n            return (parseFloat(size) * t / this.json_data.font.size.source);\r\n        },\r\n\r\n        isWap3000: function(){\r\n            return (!flashvars.wap || (flashvars.wap && flashvars.wap === \"3000\"))\r\n        },\r\n\t\t/**是否来自第三方*/\r\n\t\tisWapOther:function () {\r\n\t\t\treturn Boolean(flashvars.wap && flashvars.wap !== \"3000\" && flashvars.wap !== \"zxwwap\" && flashvars.wap !== undefined && flashvars.wap !== \"\")\r\n        },\r\n\t\t//是否为推广\r\n\t\tisExtend:function () {\r\n\t\t\treturn Boolean(flashvars.extend && flashvars.extend !== undefined && flashvars.extend !== \"\");\r\n        },\r\n\t\t//是否显示本地存档按钮\r\n\t\tget isShowLocalBtn (){\r\n\t\t\tif(this.isWapOther()/*第三方来源（联运）不显示本地存档按钮*/){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\t//是否显示云存档按钮\r\n\t\tget isShowCloudBtn (){\r\n\t\t\tif(this.isExtend()/*推广，不显示云存档按钮*/\r\n\t\t\t || Boolean(flashvars.wap && flashvars.wap === \"zxwwap\") /*wap为在线完时*/\r\n\t\t\t || this.isWapOther() /*第三方来源取消云存档按钮*/){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\tExpression: class {\r\n\r\n\t\t\tstatic isString(data) {\r\n\t\t\t\treturn Object.prototype.toString.apply(data) === '[object String]';\r\n\t\t\t}\r\n\r\n\t\t\tstatic isArray(data) {\r\n\t\t\t\treturn Object.prototype.toString.apply(data) === '[object Array]';\r\n\t\t\t}\r\n\r\n\t\t\tstatic toN(x) {\r\n\t\t\t\tconst n = Number(x);\r\n\t\t\t\tif (isNaN(n)) {\r\n\t\t\t\t\tconsole.warn(`${x} is not a number`);\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn n;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tstatic toInt(x, radix = 10) {\r\n\t\t\t\tconst n = parseInt(x, radix);\r\n\t\t\t\tif (isNaN(n)) {\r\n\t\t\t\t\tconsole.warn(`${x} is not a int`);\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn n;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tstatic toWeek(x) {\r\n\t\t\t\tswitch (x)\r\n\t\t\t\t{\r\n\t\t\t\t\tcase 0: return 7;//'星期天';\r\n\t\t\t\t\tdefault: return x;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tstatic safeEval(expr, context) {\r\n\r\n\t\t\t\tconst evaluate = (expr, context) => {\r\n\t\t\t\t\tlet arg1;\r\n\t\t\t\t\tlet arg2;\r\n\t\t\t\t\tlet value;\r\n\t\t\t\t\tswitch (expr.type) {\r\n\t\t\t\t\t\tcase \"arg1\":\r\n\t\t\t\t\t\t\treturn evaluate(expr.arg1, context);\r\n\t\t\t\t\t\tcase \"+\":\r\n\t\t\t\t\t\t\targ1 = evaluate(expr.arg1, context);\r\n\t\t\t\t\t\t\targ2 = evaluate(expr.arg2, context);\r\n\t\t\t\t\t\t\tif (this.isString(arg1) || this.isString(arg2)) {\r\n\t\t\t\t\t\t\t\treturn ('#' + arg1 + arg2).slice(1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn this.add(evaluate(expr.arg1, context), evaluate(expr.arg2, context));\r\n\t\t\t\t\t\tcase \"-\":\r\n\t\t\t\t\t\t\targ1 = evaluate(expr.arg1, context);\r\n\t\t\t\t\t\t\targ2 = evaluate(expr.arg2, context);\r\n\t\t\t\t\t\t\tif (this.isString(arg1) || this.isString(arg2)) {\r\n\t\t\t\t\t\t\t\treturn (arg1 + '').split(arg2 + '').join('');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn this.sub(evaluate(expr.arg1, context), evaluate(expr.arg2, context));\r\n\t\t\t\t\t\tcase \"*\":\r\n\t\t\t\t\t\t\treturn this.mul(evaluate(expr.arg1, context), evaluate(expr.arg2, context));\r\n\t\t\t\t\t\tcase \"/\":\r\n\t\t\t\t\t\t\treturn this.div(evaluate(expr.arg1, context), evaluate(expr.arg2, context));\r\n\t\t\t\t\t\tcase \"%\":\r\n                            arg1 = parseInt(evaluate(expr.arg1, context));\r\n                            arg2 = parseInt(evaluate(expr.arg2, context));\r\n                            if (arg2 === 0) {\r\n                                Dialog.error('求余除数不能为 0');\r\n                                return 0;\r\n                            }\r\n\r\n                            return this.mod(arg1, arg2);\r\n\t\t\t\t\t\tcase \"==\":\r\n\t\t\t\t\t\t\treturn evaluate(expr.arg1, context) === evaluate(expr.arg2, context);\r\n\t\t\t\t\t\tcase \"!=\":\r\n\t\t\t\t\t\t\treturn evaluate(expr.arg1, context) !== evaluate(expr.arg2, context);\r\n\t\t\t\t\t\tcase \">\":\r\n\t\t\t\t\t\t\treturn evaluate(expr.arg1, context) > evaluate(expr.arg2, context);\r\n\t\t\t\t\t\tcase \"<\":\r\n\t\t\t\t\t\t\treturn evaluate(expr.arg1, context) < evaluate(expr.arg2, context);\r\n\t\t\t\t\t\tcase \">=\":\r\n\t\t\t\t\t\t\treturn evaluate(expr.arg1, context) >= evaluate(expr.arg2, context);\r\n\t\t\t\t\t\tcase \"<=\":\r\n\t\t\t\t\t\t\treturn evaluate(expr.arg1, context) <= evaluate(expr.arg2, context);\r\n\t\t\t\t\t\tcase \"min\":\r\n\t\t\t\t\t\t\treturn Math.min.apply(null,\r\n\t\t\t\t\t\t\t\texpr.args.map(arg => evaluate(arg, context))\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\tcase \"max\":\r\n\t\t\t\t\t\t\treturn Math.max.apply(null,\r\n\t\t\t\t\t\t\t\texpr.args.map(arg => evaluate(arg, context))\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\tcase \"all\":\r\n\t\t\t\t\t\t\treturn expr.args.map(arg => evaluate(arg, context)).every(v => v);\r\n\t\t\t\t\t\tcase \"any\":\r\n\t\t\t\t\t\t\treturn expr.args.map(arg => evaluate(arg, context)).some(v => v);\r\n\t\t\t\t\t\tcase \"literal\":\r\n\t\t\t\t\t\t\treturn Number(expr.value);\r\n                        case \"int\":\r\n                            return parseInt(this.toN(evaluate(expr.arg1, context)));\r\n                        case 'random':\r\n\t\t\t\t\t\t\tconst start = this.toInt(expr.range[0]);\r\n\t\t\t\t\t\t\tconst end = this.toInt(expr.range[1]);\r\n\t\t\t\t\t\t\treturn ~~(Math.random() * (end - start + 1) + start);\r\n\t\t\t\t\t\tcase 'value':\r\n\t\t\t\t\t\tcase 'savedValue':\r\n                        case 'payValue':\r\n                            value = [...context.values, ...context.savedValues, ...context.payValues]\r\n\t\t\t\t\t\t\t\t.find(v => v.uuid === expr.arg1);\r\n\t\t\t\t\t\t\treturn value.value !== undefined ? this.toN(value.value) : this.safeInitValue(value);\r\n                        case 'systemValue':\r\n                            value = context.systemValues.find(v => v.uuid === expr.arg1);\r\n                            if (value.value !== undefined) {\r\n                            \tif (value.uuid !== context.systemValues[0].uuid && value.uuid !== context.systemValues[1].uuid\r\n\t\t\t\t\t\t\t\t\t&& value.uuid !== context.systemValues[9].uuid) {\r\n                                    Utils.updateContextTimeValues(context);\r\n                                    //return this.toN(context.systemValues[2].value);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (value.uuid === context.systemValues[10].uuid) {\r\n                            \t\treturn this.toWeek(value.value);\r\n\t\t\t\t\t\t\t\t} else {\r\n                                    return this.toN(value.value);\r\n                                }\r\n\t\t\t\t\t\t\t} else {\r\n                            \treturn this.safeInitValue(value);\r\n\t\t\t\t\t\t\t}\r\n                        case 'indexValue':\r\n                        \tvalue = context.indexValues.find(v => v.uuid === expr.arg1);\r\n                            return value.value !== undefined ? this.toN(value.value) : this.safeInitValue(value);\r\n                        case \"string\":\r\n\t\t\t\t\t\t\treturn (expr.value + '');\r\n\t\t\t\t\t\tcase \"stringValue\":\r\n\t\t\t\t\t\t\tvalue = context.stringValues.find(v => v.uuid === expr.arg1);\r\n\t\t\t\t\t\t\treturn value.value !== undefined ? (value.value + '') : this.safeInitValue(value);\r\n\t\t\t\t\t\tcase 'reference':\r\n\t\t\t\t\t\t\tvalue = context.indexValues.find(v => v.uuid == expr.arg1);\r\n\t\t\t\t\t\t\tif (value) {\r\n\t\t\t\t\t\t\t\tconst i = (value.value === undefined ? this.safeInitValue(value) : this.toN(value.value)) - 1;\r\n\t\t\t\t\t\t\t\tif (value.init.type === 'value') {\r\n\t\t\t\t\t\t\t\t\tif (i<0 || i>=context.values.length) {\r\n\t\t\t\t\t\t\t\t\t\tDialog.info('出现未知数值操作，请联系作者检查修改');\r\n\t\t\t\t\t\t\t\t\t\treturn '[未知数值]';\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn context.values[i].value !== undefined ? this.toN(context.values[i].value) : this.safeInitValue(context.values[i]);\r\n                                }\r\n                                else if (value.init.type === 'savedValue') {\r\n                                    if (i<0 || i>=context.savedValues.length) {\r\n                                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n                                        return '[未知数值]';\r\n                                    }\r\n\t\t\t\t\t\t\t\t\treturn context.savedValues[i].value !== undefined ? this.toN(context.savedValues[i].value) : this.safeInitValue(context.savedValues[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if (value.init.type === 'payValue') {\r\n                                    if (i<0 || i>=context.payValues.length) {\r\n                                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n                                        return '[未知数值]';\r\n                                    }\r\n                                    return context.payValues[i].value !== undefined ? this.toN(context.payValues[i].value) : this.safeInitValue(context.payValues[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if (value.init.type === 'stringValue') {\r\n                                    if (i<0 || i>=context.stringValues.length) {\r\n                                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n                                        return '[未知数值]';\r\n                                    }\r\n                                    return context.stringValues[i].value !== undefined ? (context.stringValues[i].value + '') : this.safeInitValue(context.stringValues[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase \"contain\":\r\n\t\t\t\t\t\t\targ1 = evaluate(expr.arg1, context);\r\n\t\t\t\t\t\t\targ2 = evaluate(expr.arg2, context);\r\n\t\t\t\t\t\t\treturn (arg1 + '').indexOf(arg2 + '') > -1;\r\n\t\t\t\t\t\tcase \"stringLength\":\r\n\t\t\t\t\t\t\targ1 = evaluate(expr.arg1, context);\r\n\t\t\t\t\t\t\treturn arg1 ? arg1.length : 0;\r\n\t\t\t\t\t\tdefault :\r\n\t\t\t\t\t\t\tthrow new error(\"expr type  is  error\");\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\treturn evaluate(expr, context);\r\n\t\t\t\t}\r\n\t\t\t\tcatch (e) {\r\n\t\t\t\t\tconsole.error(e);\r\n\t\t\t\t\treturn NaN;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tstatic safeInitValue(value) {\r\n\t\t\t\tfunction initValue(value) {\r\n\t\t\t\t\tif (value.init.type === 'const' || value.init.type === 'system') {\r\n\t\t\t\t\t\tvalue.value  = value.init.value;\r\n\t\t\t\t\t\treturn value.value;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (value.init.type === 'random') {\r\n\t\t\t\t\t\tconst start = Number(value.init.range[0]);\r\n\t\t\t\t\t\tconst end = Number(value.init.range[1]);\r\n\t\t\t\t\t\tvalue.value = ~~(Math.random() * (end - start + 1) + start);\r\n\t\t\t\t\t\treturn value.value;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (value.init.type === 'string') {\r\n\t\t\t\t\t\tvalue.value = (value.init.value + '');\r\n\t\t\t\t\t\treturn value.value;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (value.init.onlyRead) {\t// 索引\r\n\t\t\t\t\t\tvalue.value = value.init.value;\r\n\t\t\t\t\t\treturn value.value;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tconsole.error('unknown init type');\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\treturn initValue(value);\r\n\t\t\t\t}\r\n\t\t\t\tcatch (e) {\r\n\t\t\t\t\tconsole.error(e);\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tstatic fix(expr, context) {\r\n\t\t\t\tconst {type, arg1, arg2, args, value:oldValue} = expr;\r\n\t\t\t\tconst newExpr = {type};\r\n\t\t\t\tlet value;\r\n\t\t\t\tswitch (type) {\r\n\t\t\t\t\tcase \"arg1\":\r\n\t\t\t\t\tcase \"stringLength\":\r\n\t\t\t\t\t\tconst fixArg1 = this.fix(arg1, context);\r\n\t\t\t\t\t\tif (!fixArg1) {\r\n\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnewExpr.arg1 = fixArg1;\r\n\t\t\t\t\t\treturn newExpr;\r\n\t\t\t\t\tcase \"+\":\r\n\t\t\t\t\tcase \"-\":\r\n\t\t\t\t\tcase \"*\":\r\n\t\t\t\t\tcase \"/\":\r\n\t\t\t\t\tcase \"%\":\r\n\t\t\t\t\tcase \"==\":\r\n\t\t\t\t\tcase \"!=\":\r\n\t\t\t\t\tcase \">\":\r\n\t\t\t\t\tcase \"<\":\r\n\t\t\t\t\tcase \">=\":\r\n\t\t\t\t\tcase \"<=\":\r\n\t\t\t\t\tcase \"contain\":\r\n\t\t\t\t\t\tnewExpr.arg1 = this.fix(arg1, context);\r\n\t\t\t\t\t\tnewExpr.arg2 = this.fix(arg2, context);\r\n\t\t\t\t\t\tif (!newExpr.arg1 || !newExpr.arg2) {\r\n\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn newExpr;\r\n\t\t\t\t\tcase \"min\":\r\n\t\t\t\t\tcase \"max\":\r\n\t\t\t\t\tcase \"all\":\r\n\t\t\t\t\tcase \"any\":\r\n\t\t\t\t\t\tconst fixArgs = args.map(arg => this.fix(arg, context));\r\n\t\t\t\t\t\tnewExpr.args = fixArgs.filter(arg => arg !== null);\r\n\t\t\t\t\t\treturn newExpr;\r\n\t\t\t\t\tcase \"literal\":\r\n\t\t\t\t\t\tnewExpr.value = Number(oldValue);\r\n\t\t\t\t\t\treturn newExpr;\r\n\t\t\t\t\tcase 'random':\r\n\t\t\t\t\t\tnewExpr.range = (expr.range || [0, 100]).map(value => this.toInt(value));\r\n\t\t\t\t\t\tnewExpr.range.sort();\r\n\t\t\t\t\t\treturn newExpr;\r\n\t\t\t\t\tcase 'value':\r\n\t\t\t\t\tcase 'savedValue':\r\n                    case 'payValue':\r\n                    case 'systemValues':\r\n\t\t\t\t\tcase 'indexValue':\r\n\t\t\t\t\t\tvalue = [...context.values, ...context.savedValues, ...context.payValues, ...context.systemValues, ...context.indexValues]\r\n\t\t\t\t\t\t\t.find(v => v.uuid === expr.arg1);\r\n\t\t\t\t\t\tif (value === undefined) {\r\n\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnewExpr.arg1 = arg1;\r\n\t\t\t\t\t\treturn newExpr;\r\n\t\t\t\t\tcase \"string\":\r\n\t\t\t\t\t\tnewExpr.value = (oldValue + '' || '');\r\n\t\t\t\t\t\treturn newExpr;\r\n\t\t\t\t\tcase \"stringValue\":\r\n\t\t\t\t\t\tvalue = context.stringValues.find(v => v.uuid === expr.arg1);\r\n\t\t\t\t\t\tif (value === undefined) {\r\n\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnewExpr.arg1 = arg1;\r\n\t\t\t\t\t\treturn newExpr;\r\n\t\t\t\t\tdefault :\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tstatic parseValue(string, context, isGetName) {\r\n\t\t\t\tconst parseValueFormat = /([\\s\\S]*)&(s|v|sv|p|x|i|iv)\\[(\\d+)\\]([\\s\\S]*)/;\r\n\t\t\t\tlet value = parseValueFormat.exec(string), nameStr;\r\n\t\t\t\tlet str = string;\r\n\t\t\t\twhile (value) {\r\n\t\t\t\t\tconst type = value[2];\r\n\t\t\t\t\tconst index = parseInt(value[3]);\r\n\t\t\t\t\tlet temp = '[未知数值]';\r\n\t\t\t\t\tif (type === 's' && context.savedValues[index]) {\r\n\t\t\t\t\t\tnameStr = '[' + 'Y' + (index + 1) + ':' + context.savedValues[index].name + ']';\r\n\t\t\t\t\t\ttemp = context.savedValues[index].value === undefined\r\n\t\t\t\t\t\t\t? this.safeInitValue(context.savedValues[index])\r\n\t\t\t\t\t\t\t: context.savedValues[index].value;\r\n\t\t\t\t\t\tif (isGetName) {\r\n\t\t\t\t\t\t\ttemp = nameStr;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n                            temp = this.toFixed(temp,2);\r\n                        }\r\n                    }\r\n\t\t\t\t\telse if (type === 'v' && context.values[index]) {\r\n\t\t\t\t\t\tnameStr = '[' + 'P' + (index + 1) + ':' + context.values[index].name + ']';\r\n\t\t\t\t\t\ttemp = context.values[index].value === undefined\r\n\t\t\t\t\t\t\t? this.safeInitValue(context.values[index])\r\n\t\t\t\t\t\t\t: context.values[index].value;\r\n\t\t\t\t\t\tif (isGetName) {\r\n\t\t\t\t\t\t\ttemp = nameStr;\r\n\t\t\t\t\t\t}\r\n \t\t\t\t\t\telse {\r\n                            temp = this.toFixed(temp,2);\r\n                        }\r\n                    }\r\n\t\t\t\t\telse if (type === 'sv' && context.stringValues[index]) {\r\n\t\t\t\t\t\tnameStr = '[' + 'Z' + (index + 1) + ':' + context.stringValues[index].name + ']';\r\n\t\t\t\t\t\ttemp = context.stringValues[index].value === undefined\r\n\t\t\t\t\t\t\t? this.safeInitValue(context.stringValues[index])\r\n\t\t\t\t\t\t\t: context.stringValues[index].value;\r\n\t\t\t\t\t\tif (isGetName) {\r\n\t\t\t\t\t\t\ttemp = nameStr;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n                    else if (type === 'p' && context.payValues[index]) {\r\n                        nameStr = '[' + 'X' + (index + 1) + ':' + context.payValues[index].name + ']';\r\n                        temp = context.payValues[index].value === undefined\r\n                            ? this.safeInitValue(context.payValues[index])\r\n                            : context.payValues[index].value;\r\n                        if (isGetName) {\r\n                            temp = nameStr;\r\n                        }\r\n                        else {\r\n                            temp = this.toFixed(temp,2);\r\n                        }\r\n                    }\r\n                    else if (type === 'x' && context.systemValues[index]) {\r\n\t\t\t\t\t\tif (-1 === Utils.timeStamp) {\r\n\t\t\t\t\t\t\tUtils.getTimeOffset().then(() => {\r\n\t\t\t\t\t\t\t\tUtils.updateContextTimeValues(context);\r\n\t\t\t\t\t\t\t}, () => {\r\n                                Dialog.info('当前网络不佳，获取系统时间失败');\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tUtils.updateContextTimeValues(context);\r\n\t\t\t\t\t\t}\r\n\r\n                        nameStr = '[' + 'S' + (index + 1) + ':' + context.systemValues[index].name + ']';\r\n                        temp = context.systemValues[index].value === undefined\r\n                            ? this.safeInitValue(context.systemValues[index])\r\n                            : index === 10 ? this.toWeek(context.systemValues[10].value) : context.systemValues[index].value;\r\n                        if (isGetName) {\r\n                            temp = nameStr;\r\n                        }\r\n                        else {\r\n                            temp = this.toFixed(temp,2);\r\n                        }\r\n                    }\r\n                    else if (type === 'i' && context.indexValues[index]) {\r\n                        nameStr = '[' + 'I' + (index + 1) + ':' + context.indexValues[index].name + ']';\r\n                        temp = context.indexValues[index].value === undefined ? this.safeInitValue(context.indexValues[index]) : context.indexValues[index].value;\r\n                        if (isGetName) {\r\n                            temp = nameStr;\r\n                        }\r\n                        else {\r\n                        \ttemp = this.toFixed(temp, 2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (type === 'iv') {\r\n\t\t\t\t\t\tif (index >= context.indexValues.length) {\r\n\t\t\t\t\t\t\ttemp = '[未知数值]';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n                            nameStr = '[' + 'IV' + (index + 1) + ':' + context.indexValues[index].name + ']';\r\n                            const i = (context.indexValues[index].value === undefined ? this.safeInitValue(context.indexValues[index]) : context.indexValues[index].value) - 1;\r\n                            if (isGetName) {\r\n                                temp = nameStr;\r\n                            }\r\n                            else {\r\n                                const ii = this.toFixed(i, 2);\r\n                                if (context.indexValues[index].init.type === 'value') {\r\n                                    if (i<0 || i>=context.values.length) {\r\n                                        temp = '[未知数值]';\r\n                                    }\r\n                                    else {\r\n                                        temp = context.values[ii].value === undefined ? this.safeInitValue(context.values[ii]) : context.values[ii].value;\r\n                                        temp = this.toFixed(temp, 2);\r\n                                    }\r\n                                }\r\n                                else if (context.indexValues[index].init.type === 'savedValue') {\r\n                                    if (i<0 || i>=context.savedValues.length) {\r\n                                        temp = '[未知数值]';\r\n                                    }\r\n                                    else {\r\n                                        temp = context.savedValues[ii].value === undefined ? this.safeInitValue(context.savedValues[ii]) : context.savedValues[ii].value;\r\n                                        temp = this.toFixed(temp, 2);\r\n                                    }\r\n                                }\r\n                                else if (context.indexValues[index].init.type === 'payValue') {\r\n                                    if (i<0 || i>=context.payValues.length) {\r\n                                        temp = '[未知数值]';\r\n                                    }\r\n                                    else {\r\n                                        temp = context.payValues[ii].value === undefined ? this.safeInitValue(context.payValues[ii]) : context.payValues[ii].value;\r\n                                        temp = this.toFixed(temp, 2);\r\n                                    }\r\n                                }\r\n                                else if (context.indexValues[index].init.type === 'stringValue') {\r\n                                    if (i<0 || i>=context.stringValues.length) {\r\n                                        temp = '[未知数值]';\r\n                                    }\r\n                                    else {\r\n                                        temp = context.stringValues[ii].value === undefined ? this.safeInitValue(context.stringValues[ii]) : context.stringValues[ii].value;\r\n                                    }\r\n                                }\r\n                            }\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tstr = value[1] + temp + value[4];\r\n\t\t\t\t\tvalue = parseValueFormat.exec(str);\r\n\t\t\t\t}\r\n\t\t\t\treturn str;\r\n\t\t\t}\r\n\r\n\t\t\tstatic parseWaitTime(data, show) {\r\n\t\t\t\tconst parsePauseFormat = /([\\s\\S]*)\\\\(\\d+)\\s([\\s\\S]*)/;\r\n\t\t\t\tlet value = parsePauseFormat.exec(data);\r\n\t\t\t\twhile (value) {\r\n\t\t\t\t\tif (show) {\r\n\t\t\t\t\t\tdata = value[1] + `[停顿:${value[2]}ms]` + value[3]\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdata = value[1] + value[3];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvalue = parsePauseFormat.exec(data);\r\n\t\t\t\t}\r\n\t\t\t\treturn data;\r\n\t\t\t}\r\n\r\n\t\t\tstatic getGameValueByTimer(timer, context) {\r\n\t\t\t\tlet value = {};\r\n\t\t\t\tif (!timer) {\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t}\r\n\t\t\t\tconst { type, arg1 } = timer.time;\r\n\r\n\t\t\t\tif (type === 'value') {\r\n\t\t\t\t\tvalue = context.values.find(v => v.uuid === arg1)\r\n\t\t\t\t} else if (type === 'savedValue') {\r\n\t\t\t\t\tvalue = context.savedValues.find(v => v.uuid === arg1)\r\n\t\t\t\t} else if (type === 'literal') {\r\n\t\t\t\t\tvalue.value = timer.time.value\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t}\r\n\t\t\t\tconst countDown = value && value.value === undefined\r\n\t\t\t\t\t? this.safeInitValue(value)\r\n\t\t\t\t\t: value.value;\r\n\t\t\t\treturn Math.max(countDown, 0);\r\n\t\t\t}\r\n\r\n            static add(num1, num2) {\r\n                let len1 = 0, len2 = 0, m = 1;\r\n                try {\r\n                    len1 = num1.toString().split('.')[1].length;\r\n                } catch (e) {\r\n                }\r\n                try {\r\n                    len2 = num2.toString().split(\".\")[1].length;\r\n                } catch (e) {\r\n                }\r\n                m = Math.max(len1, len2);\r\n                num1 = parseInt(num1.toString().replace(\".\", \"\")) * Math.pow(10, m - len1);\r\n                num2 = parseInt(num2.toString().replace(\".\", \"\")) * Math.pow(10, m - len2);\r\n                return (num1 + num2) / Math.pow(10, m);\r\n            }\r\n\r\n            static sub(num1, num2) {\r\n                let len1 = 0, len2 = 0, m = 1;\r\n                try {\r\n                    len1 = num1.toString().split('.')[1].length;\r\n                } catch (e) {\r\n                }\r\n                try {\r\n                    len2 = num2.toString().split(\".\")[1].length;\r\n                } catch (e) {\r\n                }\r\n                m = Math.max(len1, len2);\r\n                num1 = parseInt(num1.toString().replace(\".\", \"\")) * Math.pow(10, m - len1);\r\n                num2 = parseInt(num2.toString().replace(\".\", \"\")) * Math.pow(10, m - len2);\r\n                return (num1 - num2) / Math.pow(10, m);\r\n            }\r\n\r\n            static div(num1, num2) {\r\n                if (!num2) {\r\n                \tDialog.error('除数不能为 0');\r\n                    return 0;\r\n                }\r\n                let len1 = 0, len2 = 0, temp;\r\n                try {\r\n                    len1 = num1.toString().split('.')[1].length;\r\n                } catch (e) {\r\n                }\r\n                try {\r\n                    len2 = num2.toString().split(\".\")[1].length;\r\n                } catch (e) {\r\n                }\r\n                temp = parseInt(num1.toString().replace(\".\", \"\")) / parseInt(num2.toString().replace(\".\", \"\"));\r\n                if (len2 - len1 < 0 || temp !== parseInt(temp)) {\r\n                    return this.mul(temp, Math.pow(10, len2 - len1));\r\n                }\r\n                return temp * Math.pow(10, len2 - len1);\r\n            }\r\n\r\n            static mul(num1, num2) {\r\n                let m = 0, str1 = num1.toString(), str2 = num2.toString();\r\n                try {\r\n                    m += str1.includes('1e-') ? parseInt(str1.split('1e-')[1]) : str1.split(\".\")[1].length\r\n                } catch (e) {\r\n                }\r\n                try {\r\n                    m += str2.includes('1e-') ? parseInt(str2.split('1e-')[1]) : str2.split(\".\")[1].length\r\n                } catch (e) {\r\n                }\r\n                return parseInt(str1.replace(\".\", \"\")) * parseInt(str2.replace(\".\", \"\")) / Math.pow(10, m);\r\n            }\r\n\r\n            static mod(num1, num2) {\r\n                let len1 = 0, len2 = 0, m = 1;\r\n                try {\r\n                    len1 = num1.toString().split('.')[1].length;\r\n                } catch (e) {\r\n                }\r\n                try {\r\n                    len2 = num2.toString().split(\".\")[1].length;\r\n                } catch (e) {\r\n                }\r\n                m = Math.pow(10, Math.max(len1, len2));\r\n                return ((num1 * m) % (num2 * m)) / m;\r\n            }\r\n\r\n            static toFixed(value = 0, fixed = 2) {\r\n                let len = 0;\r\n                try {\r\n                    len = value.toString().split(\".\")[1].length;\r\n                } catch (e) {\r\n                }\r\n                let str = value.toString();\r\n                if (len > fixed && fixed >= 0) {\r\n                    str = str.substring(0, str.indexOf('.') + fixed + 1);\r\n                    len = fixed;\r\n                }\r\n                value = parseInt(str.replace(\".\", \"\"));\r\n                return value / Math.pow(10, len);\r\n            }\r\n        }\r\n\t},\r\n\r\n\t// CLASS MEMBERS\r\n\t{\r\n\t\t/**\r\n\t\t * The TextProxy's name.\r\n\t\t *\r\n\t\t * @static\r\n\t\t * @type {string}\r\n\t\t */\r\n\t\tNAME: 'SceneProxy'\r\n\t\t, guideLayer:null \t\t//指引层\r\n\t\t, logo: null\t\t\t// Logo层\r\n\t\t, coverLayer: null\t\t// 封面层\r\n\t\t, progressLayer: null\t// 进度条层\r\n\t\t, dialogLayer: null\t\t// 对话框层\r\n\t\t, menuLayer: null\t\t// 菜单层\r\n\t\t, mainMenuLayer: null\t// 主菜单层\r\n\t\t, settingsLayer: null\t// 设置层\r\n\t\t, recordLayer: null\t\t// 保存的进度层\r\n\t\t, playBackLayer: null\t// 回放层\r\n\t\t, weatherLayer: null\t// 天气\r\n\t\t, charsAndPropsLayer: null\t// 角色&道具层\r\n\t\t, optionLayer: null\t\t// 选项层\r\n\t\t, plotViewsLayer: null\t// 剧情高级UI层\r\n\t\t, globalViews: null\t\t// 全局高级UI\r\n\t\t, plotViews: null\t\t// 剧情高级UI\r\n\t\t, prgsViews: null\t\t// 高级UI进度条\r\n\t\t, endLayer: null\t\t// 结尾层\r\n\t\t, toastLayer: null\t\t// toast层\r\n\t\t, loadingToastLayer: null\t// 加载中提示层\r\n\t\t, quickPlayLayer: null\t// 快速播放提示层\r\n\t\t, bubbleLayer: null\t\t//气泡层\r\n\r\n\t\t, bk_music: null\t\t// 背景音乐\r\n\t\t, plotSounds: null\t\t// 剧情音效\r\n\t\t, btn_sound: null\t\t// 按钮音效\r\n\t\t, audioDecodedCount: 0\t// 自动解码的音频数\r\n\r\n\t\t, lstPlotBkKey: null\t// 前一个剧情背景Key\r\n\t\t, prePlotBkKey: null\t// 上一个剧情背景Key\r\n\t\t, lstPlotBkOpacity: 0\t// 前一剧情背景透明度\r\n\t\t, lstPlotBkFlex: 1\t\t// 前一剧情背景flex\r\n\t\t, lstGameBk: null\t\t// 上一张游戏背景\r\n\t\t, curPlotLayer: null\t// 当前播放剧情层\r\n\t\t, lstPlotLayer: null\t// 上一剧情层\r\n\r\n\t\t, viewComponent: null\r\n\r\n\t\t// data\r\n\t\t, json_data: {}\t\t\t// 游戏json数据\r\n\t\t, Template: {}\t\t\t// 游戏中模板数据\r\n\t\t, stringMap: {}\t\t\t// 文本映射\r\n\t\t, progressTips: []\t\t// 加载tip\r\n\t\t, unlockChapterCallBack: null\t// 解锁付费章节回调\r\n\t\t, mallPayCallback: null\t// 商城购买回调\r\n\r\n\t\t, context: {}\t\t\t// 播放过程的数据\r\n\t\t, plotSnap: null\t\t// 剧情快照(可用于存档缩略图)\r\n\t\t, savedPlotsData: null\t// 存档数据\r\n\t\t, cloudPlotsData: null\t// 云端存档数据\r\n\t\t, recUidBelongTo: ''\t// 存档所属UID\r\n\t\t, gameUidBelongTo: ''\t// 游戏所属UID\r\n\t\t, bSwitchAccInPlot: true\t// 是否在剧情中切换账号\r\n\t\t, payValueUid: ''\t\t// payValues所属UID\r\n\t\t, playPause: false\t\t// 是否已暂停播放\r\n\t\t, bViewLoaded: false\t// 全局UI已初始化\r\n\t\t, bSignedIn: false\t\t// 是否已登录\r\n\t\t, bCloudSel: false\t\t// 是否选择云端存档\r\n\r\n\t\t, curChapter: null\t\t// 当前播放的章节信息\r\n\t\t, curPlotInfo: null\t\t// 当前展示的剧情信息\r\n\t\t, curPlotIndex: 0\t\t// 当前播放剧情索引\r\n\t\t, cmdPlotSnap: null\t\t// 高级剧情快照\r\n\t\t, curCmdUuid: ''\t\t// 当前剧情指令UUID\r\n\t\t, bCmdAutoText: false\t// 高级剧情是否自动播放\r\n\t\t, lstDialogInfo: null\t// 高级剧情对话框信息\r\n\t\t, menuInfo: null\t\t// 高级剧情菜单信息\r\n\t\t, charsAndPropsInfo: []\t// 高级剧情人物道具信息\r\n\t\t, bToSaveFile: true\t\t// 是否为保存进度(false = 读取存档)\r\n\r\n\t\t, space_key: null       // 空格键\r\n        , globalViewKeys: null  // 高级UI消息键\r\n        , plotViewKeys: null    // 剧情UI消息键\r\n\t\t, quickPlay: false     // 快速播放\r\n\t\t, isScreenHold: false\t// 屏幕是否按住\r\n\t\t, isQuickPlay: true\t\t//是否要执行屏幕按住 快速播放\r\n\t\t, isShowGuide:true    //是否需要显示引导层（存档提示引导层）\r\n\t\t, recordTipCount:0\t\t//存档引导提示次数\r\n\t\t, visibleLayout: []\t\t// 所有显示层\r\n\t\t, resourceManager: {}\r\n\t\t, lstPlotTweens: []\r\n\t\t, twinkleTimer: null\t// 闪烁计时器\r\n\t\t, uiOnLoadQueue: []\t\t// 高级UIonLoad事件回调队列\r\n\t\t, timerCounts: []\t\t// 计时组件已计时次数(用于读档时恢复计时次数)\r\n\t\t, menuTimer: []\t\t\t// 自制菜单中的计时器\r\n\r\n\t\t, cmdPlotNextPromise: null\t// 高级剧情前一指令Promise处理器\r\n\t\t, cmdPlayHandlerFun: null\t// 高级剧情playHandler函数指针\r\n\t\t, curCmdInfo: null\t\t\t// 当前执行指令信息\r\n\t\t, curCmdIndex: 0\t\t\t// 当前执行指令索引\r\n\t\t, preWaitCmdUuid: ''\t\t// 前一个等待指令uuid\r\n\r\n\t\t, isGameStarted: false\t\t// 记录游戏是否已开始\r\n\t\t, usedStarCount: 0\t\t\t// 已使用的星星数\r\n\t\t, gameStarLimit: 0\t\t\t// 单作品可用星星上限\r\n        , isPaying:\tfalse\t\t\t// 是否正在进行pay操作\r\n\t\t, isGettingNext: false\t\t// 是否正在获取下一剧情信息\r\n\t\t, isPreferentialFinished : false\t//是否通知章节限免结束\r\n\t\t, preferentialVector:[]\t\t//限免已结束的章节\r\n\t\t, isSetValues : false\t\t//数值操作中\r\n\t\t, isPaySuccess : false\t\t//是否pay操作成功\r\n\t\t, isGoToCommand: true\t\t//是否继续高级指令\r\n\t\t, shakeLoopObj: null\t\t//循环振动数据\r\n\t\t, hasCountDown: null\t\t//是否存在倒计时\r\n\t\t, playAdCallBack: null\t\t//广告回调函数\r\n        , saveBubbleVector:[]\t\t//记录气泡模式\r\n        , saveBubbleDataVector:[]\t//记录气泡数据\r\n        , bubbleArchivalCount:[]\t//气泡数据存档计数 上线1000条\r\n        , dialogNext:null\t\t\t//气泡模式存在，对话框下一步\r\n\t}\r\n);","/**\r\n * @class demo.view.TextComponent\r\n * @implements EventListener\r\n *\r\n * TextComponent is implemented without any abstract concept of a UiComponent\r\n * or Sprite, and uses standard HTML5 methods to manipulate the DOM. It\r\n * does however implement the {@link #handleEvent W3C EventListener interface}\r\n * which means it can be passed directly to HTMLElement#addEventListener, rather\r\n * than providing a Function, leading to tidier code and no need for Function#bind\r\n * to preserve the execution scope of its methods.\r\n */\r\nimport puremvc from 'puremvc';\r\nimport * as Xhr from '../../common/XmlHttpRequest.js';\r\nimport RePhaser from '../../common/RePhaser.js';\r\nimport Utils, {ResourcesManager, AudioTagPool} from '../../common/Utils.js';\r\nimport commit from '../../common/Version.js';\r\nimport PhoneUtils from '../../common/PhoneUtils.js';\r\nimport FontUtils from '../../common/FontUtils.js';\r\n\r\npuremvc.define\r\n(\r\n    // CLASS INFO\r\n    {\r\n        name: 'diygamePlayer.view.component.Scene',\r\n\r\n        /** @constructor */\r\n        constructor: function () {\r\n            //test9\r\n            var scene = this;\r\n            const ww = flashvars.vertical ? 540 : 960;\r\n            const hh = flashvars.vertical ? 960 : 540;\r\n            var state = {\r\n                init: function () {\r\n                    // Delete this init block or replace with your own logic.\r\n                    !scene.game.device.desktop && (scene.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL);\r\n                    if(flashvars.wap && flashvars.wap=== \"qh\"){\r\n                        scene.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;//群黑平台游戏默认全屏显示\r\n                    }\r\n                    scene.game.scale.fullScreenScaleMode = Phaser.ScaleManager.SHOW_ALL;\r\n                    scene.game.scale.pageAlignVertically = true;\r\n                    scene.game.scale.pageAlignHorizontally = true;\r\n                    scene.game.stage.disableVisibilityChange = true;\r\n                    const isIphone = ()=>{\r\n                        return (navigator.userAgent.indexOf('iPhone') > -1 && (window.orientation && window.orientation === 0));\r\n                    }\r\n                    scene.game.scale.setResizeCallback((scaleManager, rectangle) => {\r\n                        const game = document.getElementById(\"game\");\r\n                        let w = isIphone() ? (global.width): (window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth)\r\n                        let h = isIphone() ? (global.height): (window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight);\r\n                        if(isIphone()){\r\n                            if(w > h){\r\n                                w = global.height;\r\n                                h = global.width;\r\n                            }\r\n                        }\r\n                        game.style.width = w + 'px';\r\n                        game.style.height = h + 'px';\r\n                        if (w > h) {\r\n                            if(flashvars.vertical){\r\n                                if (scene.game.world.angle !== 90) {\r\n                                    scene.game.scale.setGameSize(960, 540);\r\n                                    scene.game.world.angle = 90;\r\n                                    scene.game.world.setBounds(-960, 0, 540, 960);\r\n                                    scene.game.scale.refresh();\r\n                                }\r\n                            }else{\r\n                                if (scene.game.world.angle !== 0) {\r\n                                    scene.game.scale.setGameSize(960, 540);\r\n                                    scene.game.world.angle = 0;\r\n                                    scene.game.world.setBounds(0, 0, 960, 540);\r\n                                    scene.game.scale.refresh();\r\n                                }\r\n                            }\r\n                        } else {\r\n                            if(flashvars.vertical){\r\n                                if (scene.game.world.angle !== 0) {\r\n                                    scene.game.scale.setGameSize(540, 960);\r\n                                    scene.game.world.angle = 0;\r\n                                    scene.game.world.setBounds(0, 0, 540, 960);\r\n                                    scene.game.scale.refresh();\r\n                                }\r\n                            }else{\r\n                                if (scene.game.world.angle !== 90) {\r\n                                    scene.game.scale.setGameSize(540, 960);\r\n                                    scene.game.world.angle = 90;\r\n                                    scene.game.world.setBounds(-960, 0, 960, 540);\r\n                                    scene.game.scale.refresh();\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                    });\r\n                    scene.game.load.loadImageTag = RePhaser.loadImageTag;\r\n                    scene.game.load.onSoundExtendLoad = new Phaser.Signal();\r\n                    scene.game.load.onSoundExtendLoadError = new Phaser.Signal();\r\n                    PhoneUtils.load = scene.game.load;\r\n                    scene.game.renderer.renderSession.roundPixels = true;\r\n                    scene.game.sound.decode = RePhaser.soundDecode;\r\n                    scene.game.sound.onSoundDecodeError = new Phaser.Signal();\r\n\r\n                    //fix iOS audio tag volume always stays set at 1\r\n\r\n                    const init = () => {\r\n                        scene.game.sound.touchLocked = false;\r\n                        AudioTagPool.fill();\r\n                        const keys = scene.game.cache.getKeys(Phaser.Cache.SOUND);\r\n                        keys.forEach(key => {\r\n                            var sound = scene.game.cache.getSound(key);\r\n                            if (sound && !AudioTagPool.exist(sound.data)) {\r\n                                scene.game.cache.reloadSound(key);\r\n                            }\r\n                        });\r\n                    };\r\n\r\n                    if (scene.game.device.iOS) {\r\n                        if (scene.game.device.iOSVersion > 8) {\r\n                            scene.game.input.touch.addTouchLockCallback(init, scene.game, true);\r\n                        } else {\r\n                            scene.game.input.touch.addTouchLockCallback(init, scene.game);\r\n                        }\r\n                    } else {\r\n                        if(flashvars.client === 'wap' && scene.game.device.android && (navigator.userAgent.indexOf('vivo Y66') !== -1\r\n                           || navigator.userAgent.indexOf('DIG-AL00') !== -1  )){\r\n                            scene.game.input.touch.addTouchLockCallback(init, scene.game,true);\r\n                        }else{\r\n                            init();\r\n                        }\r\n                    }\r\n\r\n                    ResourcesManager.cache = scene.game.cache;\r\n                    ResourcesManager.load = scene.game.load;\r\n                    scene.game.destroyComponent.add(key => {\r\n                        ResourcesManager.subRefCount('img', key, 'play');\r\n                    });\r\n                    window.ResourcesManager = ResourcesManager;\r\n                },\r\n                preload: function () {\r\n                },\r\n                create: function () {\r\n                    this.game.canvas.oncontextmenu = e => e.preventDefault();\r\n                    // State create logic goes here\r\n                    // Create simple text display for current Phaser version\r\n                    let startBk = scene.game.add.graphics(0, 0);\r\n                    startBk.name = 'startBk';\r\n                    startBk.beginFill(0x62d3d5);\r\n                    startBk.drawRect(0, 0, ww, hh);\r\n                    startBk.endFill();\r\n                    //scene.game.stage.backgroundColor = \"#62d3d5\";\r\n                    if (scene.onRendered) {\r\n                        scene.onRendered();\r\n                    }\r\n                },\r\n                update: function () {\r\n                    // State Update Logic goes here.\r\n                }\r\n            };\r\n            // 闪退手机浏览器版本: Chrome/50.0.2661.86 & Chrome/51.0.2704.81 渲染方式改为自动\r\n            let phaserRender = Phaser.CANVAS;\r\n            let agentV = navigator.userAgent.match(/chrome\\/((([0-9]*)+(\\.))*)+([0-9]*)/gi);\r\n            if (agentV) {\r\n                if (agentV[0] == 'Chrome/50.0.2661.86' || agentV[0] == 'Chrome/51.0.2704.81') {\r\n                    if (-1 === navigator.userAgent.indexOf('Android 6.0.1; MI 4LTE')\r\n                        && -1 === navigator.userAgent.indexOf('vivo Y67')) {\r\n                        phaserRender = Phaser.AUTO;\r\n                    }\r\n                }\r\n                else if (agentV[0] == 'Chrome/46.0.2490.76' && -1 !== navigator.userAgent.indexOf('OPPO R9s')) {\r\n                    phaserRender = Phaser.AUTO;\r\n                }\r\n            }\r\n            scene.game = new Phaser.Game(\r\n                ww,\r\n                hh,\r\n                phaserRender,\r\n                'game',\r\n                state\r\n            );\r\n            scene.game.preserveDrawingBuffer = true;\r\n            window.game = scene.game;\r\n            window['AudioContext'] = null;\r\n            window['webkitAudioContext'] = null;\r\n            console.log('versionCommit: ', commit);\r\n        }\r\n    },\r\n\r\n    // INSTANCE MEMBERS\r\n    {\r\n        showLogo: function () {\r\n            let logo_preloader = this.game.world.getByName('logo_preloader');\r\n            if (!logo_preloader) {\r\n                logo_preloader = this.game.add.image(this.game.world.width / 2, this.game.world.height / 2, 'logo_preloader');\r\n                logo_preloader.name = 'logo_preloader';\r\n                logo_preloader.anchor.setTo(0.5, 0.5);\r\n            }\r\n            logo_preloader.visible = true;\r\n        },\r\n\r\n        //离线背景图片\r\n        showOfflineBg:function () {\r\n            let offlinebg = this.game.world.getByName('offlinebg');\r\n            if (!offlinebg) {\r\n                //const opg = Utils.localStorageGetItem('shanyi3000opg');\r\n                offlinebg = this.game.add.image(this.game.world.width / 2, this.game.world.height / 2, 'Operation_tip');\r\n                offlinebg.name = 'offlinebg';\r\n                offlinebg.inputEnabled = true;\r\n                offlinebg.anchor.setTo(0.5, 0.5);\r\n                this.game.world.setChildIndex(offlinebg,1);//放底部\r\n            }\r\n            offlinebg.visible = true;\r\n        },\r\n\r\n        showLoading: function () {\r\n            let logo_preloader = this.game.world.getByName('logo_preloader');\r\n            let loading_gif = this.game.world.getByName('loading_gif');\r\n            if (!loading_gif) {\r\n                loading_gif = this.game.add.image(this.game.world.width / 2, flashvars.vertical ? (this.game.world.height / 2 - 100) : this.game.world.height, 'loading_gif');\r\n                loading_gif.anchor.set(0.5,0.5);\r\n                loading_gif.x = this.game.world.width / 2;\r\n                loading_gif.y = flashvars.vertical ? (this.game.world.height / 2 - loading_gif.height / 2) : (this.game.world.height / 2 - 80);\r\n                loading_gif.name = 'loading_gif';\r\n                this.addGifAnimation(loading_gif);\r\n            }\r\n            if (logo_preloader) {\r\n                logo_preloader.scale.setTo(0.35, 0.35);\r\n                logo_preloader.x = this.game.world.width - logo_preloader.width + 25;\r\n                logo_preloader.y = this.game.world.height - logo_preloader.height + 12;\r\n            }\r\n            loading_gif.visible = true;\r\n            return true;\r\n        },\r\n\r\n        destroyLogo: function () {\r\n            const startBk = this.game.world.getByName('startBk');\r\n            const logo_preloader = this.game.world.getByName('logo_preloader');\r\n            const loading_gif = this.game.world.getByName('loading_gif');\r\n            const logInfo = this.game.world.getByName('logInfo');\r\n            //const offlinebg = this.game.world.getByName(\"offlinebg\");\r\n            startBk && startBk.destroy();\r\n            logo_preloader && logo_preloader.destroy();\r\n            loading_gif && loading_gif.destroy();\r\n            logInfo && logInfo.destroy();\r\n            //offlinebg && offlinebg.destroy();\r\n        },\r\n\r\n        preLoadCertainAssets: function () {\r\n            if(!flashvars.vertical)this.game.load.spritesheet('wind', './img/wind.png', 960, 540);\r\n            this.game.load.image('icon_back', './img/icon_back.png');\r\n            this.game.load.image('icon_back_over_pressed', './img/icon_back_over_pressed.png');\r\n            this.game.load.image('icon_candy', './img/icon_candy.png');\r\n            this.game.load.image('icon_candy_over_pressed', './img/icon_candy_over_pressed.png');\r\n            this.game.load.image('icon_get', './img/icon_get.png');\r\n            this.game.load.image('icon_get_hover_pressed', './img/icon_get_hover_pressed.png');\r\n            this.game.load.image('icon_save', './img/icon_save.png');\r\n            this.game.load.image('icon_save_over_pressed', './img/icon_save_over_pressed.png');\r\n            //this.game.load.image('logo_preloader', './img/logo_preloader.png');\r\n            //this.game.load.image('loading_gif', './img/loading_gif.gif');\r\n            this.game.load.image('cloud', './img/cloud.png');\r\n            this.game.load.image('cloud_hover', './img/cloud_hover.png');\r\n            this.game.load.image('local', './img/local.png');\r\n            this.game.load.image('local_hover', './img/local_hover.png');\r\n            this.game.load.image('icon_success', './img/icon_success.png');\r\n            this.game.load.image('icon_error', './img/icon_error.png');\r\n            this.game.load.image('light', './img/light.png');\r\n            this.game.load.image('toast_loading', './img/toast_loading.gif');\r\n            this.game.load.image('app_button_speed', './img/app_button_speed.png');\r\n            this.game.load.image('app_icon_speed', './img/app_icon_speed.png');\r\n            if(flashvars.client === 'wap') this.game.load.image('wapback', './img/wapback.png');//wap端增加退出按钮\r\n            this.game.load.image('Operation_tip', flashvars.vertical ? './img/Operation_tip_1.png':'./img/Operation_tip.png');\r\n            this.game.load.image('Cloud_record_tip', './img/Cloud_record_tip.png');\r\n            this.game.load.image('offlinebg',flashvars.vertical ? './img/offlinebg_1.png' : './img/offlinebg.png');//离线背景图片\r\n            this.game.load.image('Continue', './img/Continue.png');\r\n            this.game.load.image('menuMore', './img/more.png');\r\n            this.game.load.image('menuMoreHover', './img/more_hover.png');\r\n            if (flashvars.offline === '1') {\r\n                if(flashvars.vertical){\r\n                    for(let i=0;i < 20;i++){\r\n                        this.game.load.image('/weather/'+ Utils.getWeatherFilePathName(\"wind\") +'/feng_' + Utils.formatNum(i) + '.png', './img/'+ Utils.getWeatherFilePathName(\"wind\") + '/feng_' + Utils.formatNum(i) + '.png');\r\n                    }\r\n                }\r\n\r\n                for (let i=0; i<50; i++) {\r\n                    this.game.load.image('/weather/'+ Utils.getWeatherFilePathName(\"rain\") +'/xiayu_' + Utils.formatNum(i) + '.png', './img/'+ Utils.getWeatherFilePathName(\"rain\") + '/xiayu_' + Utils.formatNum(i) + '.png');\r\n                }\r\n                for (let i=0; i<120; i++) {\r\n                    this.game.load.image('/weather/' + Utils.getWeatherFilePathName(\"snow\") + '/xuehua_' + Utils.formatNum(i) + '.png', './img/' + Utils.getWeatherFilePathName(\"snow\") + '/xuehua_' + Utils.formatNum(i) + '.png');\r\n                }\r\n                for (let i=0; i<90; i++) {\r\n                    this.game.load.image('/weather/'+Utils.getWeatherFilePathName(\"mapleLeaves\")+ '/fengye_' + Utils.formatNum(i) + '.png', './img/'+Utils.getWeatherFilePathName(\"mapleLeaves\")+ '/fengye_' + Utils.formatNum(i) + '.png');\r\n                }\r\n                for (let i=0; i<90; i++) {\r\n                    this.game.load.image('/weather/' + Utils.getWeatherFilePathName(\"beachBlossom\")+'/taohua_' + Utils.formatNum(i) + '.png', './img/' + Utils.getWeatherFilePathName(\"beachBlossom\")+'/taohua_' + Utils.formatNum(i) + '.png');\r\n                }\r\n                for (let i=0; i<90; i++) {\r\n                    this.game.load.image('/weather/' + Utils.getWeatherFilePathName(\"blossom\")+ '/yinghua_' + Utils.formatNum(i) + '.png', './img/' + Utils.getWeatherFilePathName(\"blossom\")+ '/yinghua_' + Utils.formatNum(i) + '.png');\r\n                }\r\n                for (let i=0; i<50; i++) {\r\n                    this.game.load.image('/weather/'+ Utils.getWeatherFilePathName(\"lightning\") + '/shandian_' + Utils.formatNum(i) + '.png', './img/' + Utils.getWeatherFilePathName(\"lightning\") + '/shandian_' + Utils.formatNum(i) + '.png');\r\n                }\r\n            }\r\n        },\r\n\r\n        preLoad: function () {\r\n            return new Promise((resolve, reject) => {\r\n                this.preLoadCertainAssets();\r\n                this.game.load.onLoadStart.addOnce(() => {\r\n                    this.addLog('正在准备播放..')\r\n                });\r\n                this.game.load.onFileComplete.add((progress, cacheKey, success, totalLoaded, totalFiles) => {\r\n                    //if ('logo_preloader' === cacheKey) this.showLogo();\r\n                    if(\"offlinebg\" === cacheKey) this.showOfflineBg();\r\n                    this.addLog('正在准备播放.. ' + progress + \"%\", true);\r\n                });\r\n                this.game.load.onLoadComplete.addOnce(() => {\r\n                    this.game.load.onFileComplete.removeAll();\r\n                    this.addLog(\"正在准备播放..【成功】\", true);\r\n                    return resolve();\r\n                });\r\n\r\n                this.game.load.start();\r\n            })\r\n        },\r\n\r\n        getGameJson: function (iswapother) {\r\n            flashvars.uuid = flashvars.uuid || '41138941-7f1c-4701-9a94-394893483662';\r\n            const uuid = flashvars.uuid;\r\n\r\n            document.title = flashvars.name && decodeURI(flashvars.name) || \"测试\";\r\n\r\n            const onProgress = evt => {\r\n                if (evt.lengthComputable) {\r\n                    const percentComplete = evt.loaded / evt.total;\r\n                    this.addLog(\"加载剧情配置.. \" + ~~percentComplete + '%', true);\r\n                } else {\r\n                    this.addLog(\"加载剧情配置.. \" + evt.loaded, true);\r\n                }\r\n            };\r\n\r\n            this.addLog(\"加载剧情配置..\");\r\n            const getGame = iswapother ? Xhr.getOtherGame : (flashvars.type == 1 ? Xhr.getTestGame : Xhr.getGame);\r\n            return getGame(uuid, onProgress).then(game => {\r\n                this.addLog(\"加载剧情配置..【成功】\", true);\r\n                return game;\r\n            }, e => {\r\n                this.addLog(\"发生错误：\" + e);\r\n                return Promise.reject(e);\r\n            });\r\n        },\r\n\r\n        addLog: function (info, replace) {\r\n            if (!info) {\r\n                return;\r\n            }\r\n            let logInfo = this.game.world.getByName('logInfo');\r\n            if (!logInfo) {\r\n                const style = {font: \"16px 宋体\", fill: \"#fff\"};\r\n                //logInfo = this.game.add.text(18, 540 - 36, '', style);\r\n                logInfo = this.game.add.text(18, this.game.world.height - 36, '', style);\r\n                logInfo.name = 'logInfo';\r\n            }\r\n            let text = logInfo.text;\r\n            const textGroup = text.split(/\\r?\\n/gi).filter(t => !!t);\r\n            if (replace) {\r\n                textGroup[textGroup.length - 1] = info;\r\n            } else {\r\n                textGroup.push(info);\r\n            }\r\n            logInfo.text = '';\r\n            textGroup.slice(-4).map(str => logInfo.text += str + '\\n');\r\n            logInfo.y = this.game.world.height - textGroup.length * 26;\r\n        },\r\n\r\n        addButton: function (x, y, width, height, key_normal, key_active, onClick, text, audio, name, parent, isCheckBox) {\r\n            const changeImageText = (textInfo, content, width, height, textObj) => {\r\n                const txtImgOld = textObj.children[0];\r\n                const strContent = content ? content : txtImgOld ? txtImgOld.text : '';\r\n\r\n                if (!strContent) {\r\n                    return;\r\n                }\r\n\r\n                const fontSize = textInfo.fontSize ? parseInt(textInfo.fontSize) : 25;\r\n                const color = textInfo.color ? textInfo.color : '#fefefe';\r\n                const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(fontSize) : fontSize;\r\n                const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(fontSize) : fontSize;\r\n                if (color.indexOf('rgb') !== -1) {\r\n                    const rgb = color.replace('rgb(', '').replace(')', '').split(',');\r\n                    textObj.addColor('#' + ('00000' + (parseInt(rgb[0]) << 16 | parseInt(rgb[1]) << 8 | parseInt(rgb[2])).toString(16)).substr(-6), 0);\r\n                }\r\n                else {\r\n                    textObj.addColor(color === '#ffffff' ? '#fefefe' : color, 0);\r\n                }\r\n                textObj.wordWrapWidth = 540/*width*/;\r\n                this.sceneProxy.addImageFontText([{data:strContent}], fw, fh, textObj, this.sceneProxy.context);\r\n                const w = textObj.children[0].extWidth ? textObj.children[0].extWidth : fw * strContent.length;\r\n                const x = (width - w) / 2 - (textObj.children[0].extMargin ? textObj.children[0].extMargin : 0);\r\n                const y = (height - fh) / 2;\r\n                textObj.children[0].x = x;\r\n                textObj.children[0].y = y;\r\n                textObj.children[0].text = strContent;\r\n\r\n                if (txtImgOld) {\r\n                    txtImgOld.children.forEach(item => item.fontImg.destroy());\r\n                    txtImgOld.destroy();\r\n                }\r\n\r\n                textObj.text = ' ';\r\n            };\r\n            const changeBackground = (buttonGroup, key, text, clear) => {\r\n                const background = buttonGroup.getByName('background');\r\n                const btnObj = buttonGroup.getByName('button');\r\n                const txtObj = buttonGroup.getByName('text');\r\n                const bk_key = this.game.load.cache.checkImageKey(key) ? key : null;\r\n\r\n                if (!btnObj) {\r\n                    return\r\n                }\r\n\r\n                if (txtObj && text) {\r\n                    if (FontUtils.fontFamily) {\r\n                        changeImageText(text, '', width, height, txtObj);\r\n                    }\r\n                    else {\r\n                        txtObj.font = text.fontFamily　|| txtObj.font;\r\n                        txtObj.fontSize = text.fontSize ||　txtObj.fontSize;\r\n                        txtObj.fontWeight = text.fontWeight || txtObj.fontWeight;\r\n                        txtObj.fill = text.color ||　txtObj.fill;\r\n                    }\r\n\r\n                    txtObj.visible = !text.hidden;\r\n                }\r\n                if (bk_key) {\r\n                    let scale = 1;\r\n                    const {width, height} = btnObj;\r\n                    const image = this.game.cache.getImage(bk_key);\r\n\r\n                    if (!image.delay) {\r\n                        scale = Math.min(width / image.width, height / image.height);\r\n                        background.loadTexture(bk_key);\r\n                        background.scale.setTo(scale, scale);\r\n                        background.x = (width - background.width) / 2;\r\n                        background.y = (height - background.height) / 2;\r\n                    }\r\n                    else if (background.key !== bk_key) {\r\n                        this.addGifAnimation(background, bk_key);\r\n                    }\r\n                } else if (!clear) {\r\n                    background.loadTexture(null);\r\n                }\r\n            };\r\n\r\n            const btnGroup= this.game.add.group();\r\n            btnGroup.name = name;\r\n            parent && parent.add(btnGroup);\r\n            btnGroup.x = x;\r\n            btnGroup.y = y;\r\n\r\n            const bk_key_normal = this.game.load.cache.checkImageKey(key_normal) ? key_normal : null;\r\n            const bk_key_active = this.game.load.cache.checkImageKey(key_active) ? key_active : null;\r\n            const bk = this.game.add.image(0, 0, bk_key_normal, null, btnGroup);\r\n            bk.name = 'background';\r\n            const scale = Math.min(width / bk.width, height / bk.height);\r\n            bk.scale.setTo(scale, scale);\r\n            bk.x = (width - bk.width) / 2;\r\n            bk.y = (height - bk.height) / 2;\r\n            this.addGifAnimation(bk, bk_key_normal);\r\n            let isdown = false;\r\n            let btnobj = null;\r\n            let btnpointer = null;\r\n            const butclick = (obj, pointer)=>{\r\n                btnobj = obj;\r\n                btnpointer = pointer;\r\n            }\r\n            const btn = this.game.add.button(0, 0, null, isCheckBox ? onClick : butclick, this, 0, 0, 0, 0, btnGroup);\r\n            btn.width = width;\r\n            btn.height = height;\r\n            btn.name = \"button\";\r\n            if (audio) {\r\n                audio.prevolume = audio.prevolume !== undefined ? audio.prevolume : audio.volume;\r\n                this.game.device.desktop ? btn.setOverSound(audio) : btn.setDownSound(audio);\r\n                this.game.device.desktop ? btn.onInputOut.add(() => audio.stop()) : btn.onInputUp.add(() => {});\r\n            }\r\n\r\n            let textObj = null;\r\n            if (text) {\r\n                const fontStyle = {};\r\n                let ff = '';\r\n                ff += text.normal.fontWeight ? text.normal.fontWeight + ' ' : 'normal ';\r\n                ff += text.normal.fontSize ? parseInt(text.normal.fontSize) + 'px ' : '';\r\n                ff += text.normal.fontFamily ? text.normal.fontFamily : this.sceneProxy.json_data.font ? this.sceneProxy.json_data.font.fontFamily : '';\r\n\r\n                fontStyle.font = ff;\r\n                fontStyle.fill = text.normal.color;\r\n                fontStyle.stroke = text.normal.stroke;\r\n                fontStyle.strokeThickness = text.normal.stroke ? 2 : 0;\r\n\r\n                fontStyle.boundsAlignH = \"center\";\r\n                fontStyle.boundsAlignV = \"middle\";\r\n                textObj = this.game.add.text(0, 0, text.text, fontStyle, btnGroup);\r\n                textObj.name = 'text';\r\n                if (FontUtils.fontFamily) {\r\n                    changeImageText(text.normal, text.text, width, height, textObj);\r\n                }\r\n                else {\r\n                    textObj.setTextBounds(0, (textObj.height - parseInt(text.normal.fontSize || 12)) / 2, width, height);\r\n                }\r\n                text.normal.hidden && (textObj.visible = false);\r\n            }\r\n            btn.input.mouseOut = function () {\r\n                if (this.sprite === null || !this.sprite.inputEnabled)\r\n                {\r\n                    //  Abort. We've been destroyed.\r\n                    return;\r\n                }\r\n                var data = this._pointerData[0];\r\n\r\n                data.isOver = false;\r\n                data.isOut = true;\r\n                data.timeOut = this.game.time.time;\r\n\r\n                if (this.useHandCursor && data.isDragged === false)\r\n                {\r\n                    this.game.canvas.style.cursor = \"default\";\r\n                    this._setHandCursor = false;\r\n                }\r\n\r\n                if (this.sprite && this.sprite.events)\r\n                {\r\n                    this.sprite.events.onInputOut$dispatch(this.sprite, null);\r\n\r\n                    if (this.sprite && this.sprite.parent && this.sprite.parent.type === Phaser.GROUP)\r\n                    {\r\n                        this.sprite.parent.onChildInputOut.dispatch(this.sprite, null);\r\n                    }\r\n                }\r\n            };\r\n            !isCheckBox && btn.onInputOver.add(() => {\r\n                btn.onOverSound && (btn.onOverSound.volume = (btn.onOverSound.prevolume !== undefined ? btn.onOverSound.prevolume : btn.onOverSound.volume) * Utils.soundVolume)\r\n                changeBackground(btnGroup, bk_key_active, text && text.normal);\r\n                /*this.game.input.mouse.onMouseOut = () => {\r\n                    btn.input.mouseOut();\r\n                };*/\r\n            });\r\n            !isCheckBox && btn.onInputOut.add(() => {isdown = false;changeBackground(btnGroup, bk_key_normal, text && text.normal)});\r\n            !isCheckBox && btn.onInputDown.add(() => {\r\n                isdown = true;\r\n                btn.onDownSound && (btn.onDownSound.volume = (btn.onDownSound.prevolume !== null ?  btn.onDownSound.prevolume: btn.onDownSound.volume) * Utils.soundVolume)\r\n                changeBackground(btnGroup, bk_key_active, text && text.active)\r\n            });\r\n            !isCheckBox && btn.onInputUp.add(() => {isdown = false;changeBackground(btnGroup, bk_key_normal, text && text.normal);onClick && onClick(btnobj,btnpointer)});\r\n\r\n            btnGroup.changeBackground = function (key, text, type) {\r\n                changeBackground(this, key, text, type)\r\n            };\r\n            btnGroup.button = btn;\r\n            btnGroup.text = textObj;\r\n            return btnGroup;\r\n        },\r\n\r\n        addGifAnimation: function(obj, key) {\r\n            const image = this.game.cache.getImage(obj.key, true);\r\n            const {frames, loopCount} = image.data;\r\n            if (frames) {\r\n                let nCount = 1;\r\n                const setFrame = index => {\r\n                    if (!frames[index] || !frames[index].blobUrl) {\r\n                        return;\r\n                    }\r\n                    const img = new Image();\r\n                    img.onload = e => {\r\n                        const base = new PIXI.BaseTexture(e.target);\r\n                        const texture = new PIXI.Texture(base);\r\n                        obj && obj.parent && obj.setTexture(texture);\r\n                    };\r\n                    //img.src = frames[index].base64;\r\n                    img.src = frames[index].blobUrl;\r\n                };\r\n\r\n                const update = index => {\r\n                    Utils.timeout(frames[index].delay * 10).then(() => {\r\n                        setFrame(index);\r\n                        index++;\r\n                        if (index >= frames.length) {\r\n                            if (loopCount && nCount >= loopCount || !obj || !obj.parent) {\r\n                                return;\r\n                            } else {\r\n                                nCount++;\r\n                                update(0)\r\n                            }\r\n                        } else {\r\n                            update(index)\r\n                        }\r\n                    });\r\n                };\r\n                update(0);\r\n            }\r\n        },\r\n\r\n        addFitImageSprint: function (x, y, width, height, key, parent, index) {\r\n            const sKey = this.game.load.cache.checkImageKey(key) ? key : null;\r\n            const sprite = this.game.add.sprite(x, y, sKey);\r\n            if (sKey) {\r\n                const scale = Math.min(width / sprite.width, height / sprite.height);\r\n                sprite.pivot.x = sprite.width / 2;\r\n                sprite.pivot.y = sprite.height / 2;\r\n                sprite.scale.setTo(scale, scale);\r\n                sprite.x += sprite.width / 2;\r\n                sprite.y += sprite.height / 2;\r\n            }\r\n            if (index > 0) {\r\n                let i = 0;\r\n                for (i=0; i<parent.children.length; i++) {\r\n                    let rs = parent.getAt(i);\r\n                    if (-1 === rs) break;\r\n                    if (rs.zIndex === index) {\r\n                        parent.removeChildAt(i);\r\n                        rs.destroy();\r\n                        break;\r\n                    }\r\n                    else if (rs.zIndex > index) {\r\n                        break;\r\n                    }\r\n                }\r\n                let childGroup = this.game.add.group();\r\n                childGroup.add(sprite);\r\n                childGroup.zIndex = index;\r\n                parent.add(childGroup, false, i);\r\n            }\r\n            else {\r\n                parent.add(sprite);\r\n            }\r\n\r\n            return sprite;\r\n        },\r\n\r\n\r\n\r\n        game: null,\r\n        onRendered: null,\r\n        sceneProxy: null\r\n    },\r\n\r\n    // STATIC MEMBERS\r\n    {\r\n        /**\r\n         * @static\r\n         * @type {string}\r\n         */\r\n        TEXT_CHANGED: 'textChanged'\r\n    }\r\n);\r\n","/**\r\n * Created by 4399-1126 on 2016/9/13.\r\n */\r\nimport puremvc from 'puremvc';\r\nimport FontUtils from '../../common/FontUtils.js';\r\nimport PhoneUtils from '../../common/PhoneUtils.js';\r\n\r\npuremvc.define\r\n(\r\n    {\r\n        name: 'diygamePlayer.view.mediator.CoverMediator',\r\n        parent: puremvc.Mediator\r\n    },\r\n    {\r\n        listNotificationInterests: function () {\r\n            return [\r\n                diygamePlayer.AppConstants.SCENE_GOTO_COVERMENU\r\n            ]\r\n        },\r\n\r\n        handleNotification: function (note) {\r\n            switch (note.getName()) {\r\n                case diygamePlayer.AppConstants.SCENE_GOTO_COVERMENU:\r\n                    this.showCoverLayer();\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        },\r\n\r\n        onRegister: function () {\r\n            this.sceneProxy = this.facade.retrieveProxy(diygamePlayer.model.proxy.SceneProxy.NAME);\r\n            const sceneMediator = this.facade.retrieveMediator(diygamePlayer.view.mediator.SceneMediator.NAME);\r\n            this.game = sceneMediator.viewComponent && sceneMediator.viewComponent.game;\r\n            this.viewComponent = sceneMediator.viewComponent;\r\n        },\r\n\r\n        addCover: function () {\r\n            const {template, cover} = this.sceneProxy.json_data;\r\n            const {titleContainer, startMenu, loadMenu, settingsMenu, overMenu} = template.json.cover;\r\n            const worldWidth = this.game.world.width;\r\n            const worlHeight = this.game.world.height;\r\n\r\n            const addTextContent = (x, y, width, height, content, objText, name, isTitle) => {\r\n                const fontStyle = {};\r\n                let ff = '';\r\n                ff += objText.fontWeight ? objText.fontWeight + ' ' : 'normal ';\r\n                ff += objText.fontSize ? parseInt(objText.fontSize) + 'px ' : '';\r\n                ff += objText.fontFamily ? objText.fontFamily : '';\r\n\r\n                fontStyle.font = ff;\r\n                fontStyle.fill = objText.color;\r\n                fontStyle.stroke = objText.stroke;\r\n                fontStyle.strokeThickness = objText.stroke ? 2 : 0;\r\n\r\n                fontStyle.boundsAlignH = \"center\";\r\n                fontStyle.boundsAlignV = isTitle ? \"bottom\" : \"middle\";\r\n                const txt = this.game.add.text(0, 0, content, fontStyle, this.sceneProxy.coverLayer);\r\n                txt.name = name;\r\n                if (FontUtils.fontFamily) {\r\n                    const color = (objText.color === '#ffffff' ? '#fefefe' : objText.color).replace('#', '0x');\r\n                    const fontSize = objText.fontSize ? parseInt(objText.fontSize) : 25;\r\n                    txt.colors.splice(0, txt.colors.length);\r\n                    txt.text = ' ';\r\n                    txt.fill = color;\r\n                    txt.addColor(color, 0);\r\n                    txt.x = (worldWidth - fontSize * content.length) / 2;\r\n                    txt.y = y;\r\n                    txt.wordWrapWidth = worldWidth;\r\n\r\n                    const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(fontSize) : fontSize;\r\n                    const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(fontSize) : fontSize;\r\n                    this.sceneProxy.addImageFontText([{data:content}], fw, fh, txt, this.sceneProxy.context);\r\n                }\r\n                else {\r\n                    txt.setTextBounds(x, y + (txt.height - parseInt(objText.fontSize)) / 2, width, height);\r\n                }\r\n                objText.hidden && (txt.visible = false);\r\n                return txt;\r\n            };\r\n\r\n            const addButton = (obj, name, text) => {\r\n                const t = {};\r\n                t.normal = obj.normal.text;\r\n                t.active = obj.active.text;\r\n                t.text = text;\r\n                const btnGroup = this.viewComponent.addButton(obj.rect.x,\r\n                    obj.rect.y,\r\n                    obj.rect.width,\r\n                    obj.rect.height,\r\n                    obj.normal.background.url,\r\n                    obj.active.background.url,\r\n                    onBtnClicked,\r\n                    t,\r\n                    this.sceneProxy.btn_sound,\r\n                    name,\r\n                    this.sceneProxy.coverLayer\r\n                );\r\n                btnGroup.button.onInputUp.add(() => this.sceneProxy.btn_sound && this.sceneProxy.btn_sound.stop())\r\n            };\r\n\r\n            const onBtnClicked = (obj, pointer) => {\r\n                if (pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n                    return;\r\n                }\r\n                if (obj.parent.name === 'cover_button_start') {\r\n                    // 开始游戏\r\n                    this.sceneProxy.onCoverStartBtnClicked();\r\n                }\r\n                else if (obj.parent.name === 'cover_button_load') {\r\n                    // 加载按钮\r\n                    this.sceneProxy.onCoverLoadBtnClicked();\r\n                }\r\n                else if (obj.parent.name === 'cover_button_settings') {\r\n                    // 设置按钮\r\n                    this.sceneProxy.onCoverSettingBtnClicked();\r\n                }\r\n                else if (obj.parent.name === 'cover_button_over') {\r\n                    // 游戏结束\r\n                    this.sceneProxy.onCoverOverBtnClicked();\r\n                }\r\n            };\r\n\r\n            let bk = this.viewComponent.game.add.graphics(0, 0, this.sceneProxy.coverLayer);\r\n            bk.beginFill(0);\r\n            bk.drawRect(0,0,worldWidth,worlHeight);\r\n            bk.endFill();\r\n            /*blackBk.beginFill(0x0);\r\n            blackBk.moveTo(0, 0);\r\n            blackBk.lineTo(worldWidth, 0);\r\n            blackBk.lineTo(worldWidth, worlHeight);\r\n            blackBk.lineTo(0, worlHeight);\r\n            blackBk.lineTo(0, 0);\r\n            blackBk.endFill();\r\n            blackBk.inputEnabled = true;*/\r\n\r\n            const backgroundKey = cover.background.url;\r\n            if(this.game.load.cache.checkImageKey(backgroundKey)){\r\n                bk = this.sceneProxy.coverLayer.create(0, 0,backgroundKey);\r\n            }\r\n            this.sceneProxy.prePlotBkKey = this.sceneProxy.lstPlotBkKey;\r\n            this.sceneProxy.lstPlotBkKey = cover.background.url;\r\n            this.sceneProxy.lstPlotBkFlex = cover.background.flex;\r\n            this.sceneProxy.lstPlotBkOpacity = cover.background.opacity;\r\n            this.sceneProxy.lstGameBk = this.viewComponent.game.add.sprite(0, 0, this.game.load.cache.checkImageKey(backgroundKey) && backgroundKey);\r\n            bk.inputEnabled = true;\r\n            if (cover.background.flex === 3) {// 填充\r\n                let rate = bk.width / bk.height < worldWidth / worlHeight ? worldWidth / bk.width : worlHeight / bk.height;\r\n                bk.width *= rate;\r\n                bk.height *= rate;\r\n                bk.x = -(bk.width - worldWidth) / 2;\r\n                bk.y = -(bk.height - worlHeight) / 2;\r\n            }\r\n            else if (cover.background.flex === 5) {// 适应\r\n                let rate = 0;\r\n                if (bk.width / bk.height > worldWidth / worlHeight) {\r\n                    rate = worldWidth / bk.width;\r\n                    bk.width *= rate;\r\n                    bk.height *= rate;\r\n                    bk.y = (worlHeight - bk.height) / 2;\r\n                }\r\n                else {\r\n                    rate = worlHeight / bk.height;\r\n                    bk.width *= rate;\r\n                    bk.height *= rate;\r\n                    bk.x = (worldWidth - bk.width) / 2;\r\n                }\r\n            }\r\n            else {\r\n                bk.width = worldWidth;\r\n                bk.height = worlHeight;\r\n            }\r\n            this.sceneProxy.lstGameBk.x = bk.x;\r\n            this.sceneProxy.lstGameBk.y = bk.y;\r\n            this.sceneProxy.lstGameBk.width = bk.width;\r\n            this.sceneProxy.lstGameBk.height = bk.height;\r\n            // 封面标题背景\r\n            if (cover.title.data && !titleContainer.title.text.hidden) {\r\n                this.viewComponent.addFitImageSprint(titleContainer.rect.x,\r\n                    titleContainer.rect.y,\r\n                    titleContainer.rect.width,\r\n                    titleContainer.rect.height,\r\n                    titleContainer.background.url,\r\n                    this.sceneProxy.coverLayer\r\n                );\r\n            }\r\n\r\n            const {font_size, color, bold, fontFamily, hidden} = cover.title;\r\n            const titleText = titleContainer.title.text;\r\n            font_size && (titleText.fontSize = font_size);\r\n            color && (titleText.color = color);\r\n            bold !== undefined && (titleText.fontWeight = bold ? 'bold' : 'normal');\r\n            titleText.fontFamily = this.sceneProxy.json_data.font ? this.sceneProxy.json_data.font.fontFamily : fontFamily ? fontFamily : '';\r\n            hidden !== undefined && (titleText.hidden = hidden);\r\n\r\n            // 封面标题文字\r\n            addTextContent(titleContainer.title.rect.x + titleContainer.rect.x\r\n                , titleContainer.title.rect.y + titleContainer.rect.y\r\n                , titleContainer.title.rect.width\r\n                , titleContainer.title.rect.height\r\n                , cover.title.data\r\n                , titleText\r\n                , 'cover_text_title'\r\n                , true);\r\n\r\n            // 封面菜单-开始游戏\r\n            if (!startMenu.hidden) {\r\n                addButton(startMenu, 'cover_button_start', this.sceneProxy.stringMap.startMenu);\r\n            }\r\n\r\n            // 封面菜单-加载档案\r\n            if (!loadMenu.hidden) {\r\n                addButton(loadMenu, 'cover_button_load', this.sceneProxy.stringMap.loadMenu);\r\n            }\r\n\r\n            // 封面菜单-环境设置\r\n            if (!settingsMenu.hidden) {\r\n                addButton(settingsMenu, 'cover_button_settings', this.sceneProxy.stringMap.settingsMenu);\r\n            }\r\n\r\n            // 封面菜单-游戏结束\r\n            if (!overMenu.hidden) {\r\n                addButton(overMenu, 'cover_button_over', this.sceneProxy.stringMap.overMenu);\r\n            }\r\n            this.sceneProxy.coverLayer.visible = false;\r\n        },\r\n\r\n        showCoverLayer: function () {\r\n            this.sceneProxy.lstPlotLayer && this.sceneProxy.lstPlotLayer.destroy();\r\n            this.sceneProxy.curPlotLayer && this.sceneProxy.curPlotLayer.destroy();\r\n            this.sceneProxy.dialogLayer.visible = false;\r\n            this.sceneProxy.menuLayer.visible = false;\r\n            this.sceneProxy.lstGameBk && (this.sceneProxy.lstGameBk.visible = true);\r\n            if (this.sceneProxy.coverLayer.children.length === 0) {\r\n                this.addCover()\r\n            }\r\n\r\n            // 封面背景音乐\r\n            const {music, background} = this.sceneProxy.json_data.cover;\r\n            if (this.sceneProxy.bk_music) {\r\n                this.sceneProxy.stopMusic();\r\n            }\r\n            if (music && (this.game.load.cache.checkSoundKey(music.url) || PhoneUtils.isAudioInCache(music.url) && flashvars.client === 'ios' && '1.5.0' <= flashvars.app_version)) {\r\n                this.sceneProxy.playMusic(music.url, music.volume, true);\r\n            }\r\n            this.sceneProxy.lstPlotBkKey = background.url;\r\n            this.sceneProxy.lstPlotBkOpacity = background.opacity;\r\n            this.sceneProxy.lstPlotBkFlex = background.flex;\r\n            this.sceneProxy.coverLayer.visible = true;\r\n            this.game.world.bringToTop(this.sceneProxy.coverLayer);\r\n        }\r\n    },\r\n    {\r\n        /**\r\n         * @static\r\n         * @type {string}\r\n         */\r\n        NAME: 'CoverMediator'\r\n    }\r\n);","/**\r\n * Created by liuE on 2016/10/9.\r\n */\r\n/**\r\n * Created by 4399-1126 on 2016/9/13.\r\n */\r\nimport puremvc from 'puremvc';\r\npuremvc.define\r\n(\r\n    {\r\n        name: 'diygamePlayer.view.mediator.EndMediator',\r\n        parent: puremvc.Mediator\r\n    },\r\n    {\r\n        listNotificationInterests: function () {\r\n            return [\r\n                diygamePlayer.AppConstants.SCENE_GOTO_END\r\n            ]\r\n        },\r\n\r\n        handleNotification: function (note) {\r\n            switch (note.getName()) {\r\n                case diygamePlayer.AppConstants.SCENE_GOTO_END:\r\n                    this.showEndLayer();\r\n                default:\r\n                    break;\r\n            }\r\n        },\r\n\r\n        onRegister: function () {\r\n            this.sceneProxy = this.facade.retrieveProxy(diygamePlayer.model.proxy.SceneProxy.NAME);\r\n            const sceneMediator = this.facade.retrieveMediator(diygamePlayer.view.mediator.SceneMediator.NAME);\r\n            this.game = sceneMediator.viewComponent && sceneMediator.viewComponent.game;\r\n        },\r\n\r\n        btnStatesChanged: function (b, p, btnObj, txtObj, keyBk, text, inputEnabled) {\r\n            if (txtObj) {\r\n                txtObj.font = text.fontFamily;\r\n                txtObj.fontSize = text.fontSize;\r\n                txtObj.fontWeight = text.fontWeight;\r\n                txtObj.fill = text.color;\r\n                txtObj.visible = !text.hidden;\r\n                if (inputEnabled !== undefined) {\r\n                    txtObj.inputEnabled = inputEnabled;\r\n                }\r\n            }\r\n\r\n            this.loadTexture(btnObj, keyBk);\r\n        },\r\n\r\n        loadTexture: function (button, key) {\r\n            if (!button) {\r\n                return;\r\n            }\r\n            const {width, height} = button;\r\n            const buttonKey = this.game.load.cache.checkImageKey(key) ? key : null;\r\n            button.loadTexture(buttonKey);\r\n            button.width = width;\r\n            button.height = height;\r\n        },\r\n\r\n        addEnd: function () {\r\n\r\n            const addButton = (x, y, key, width, height, name) => {\r\n                const bk_key = this.game.load.cache.checkImageKey(key) ? key : null;\r\n                const button = this.game.add.button(x, y, bk_key, onBtnClicked, this, 0, 0, 0, 0, this.sceneProxy.endLayer);\r\n                button.width = width;\r\n                button.height = height;\r\n                button.name = name;\r\n                return button;\r\n            };\r\n\r\n            const addTextContent = (x, y, width, height, content, objText, name) => {\r\n                const fontStyle = {};\r\n                let ff = '';\r\n                ff += objText.fontWeight ? objText.fontWeight + ' ' : 'normal ';\r\n                ff += objText.fontSize ? parseInt(objText.fontSize) + 'px ' : '';\r\n                ff += objText.fontFamily ? objText.fontFamily : '';\r\n\r\n                fontStyle.font = ff;\r\n                fontStyle.fill = objText.color;\r\n                fontStyle.boundsAlignH = \"center\";\r\n                fontStyle.boundsAlignV = \"middle\";\r\n                const txt = this.game.add.text(0, 0, content, fontStyle, this.sceneProxy.endLayer);\r\n                txt.name = name;\r\n                txt.setTextBounds(x, y + (txt.height - parseInt(objText.fontSize)) / 2, width, height);\r\n                objText.hidden && (txt.visible = false);\r\n                return txt;\r\n            };\r\n\r\n            /*const giveCandy = () => {\r\n                let text = this.sceneProxy.endLayer.getByName(\"end_text_candy_tip\");\r\n\r\n                !text && (text = addTextContent(144\r\n                    , 220\r\n                    , 96\r\n                    , 20\r\n                    , \"赠送糖果成功(测试)\"\r\n                    , {\r\n                        fontFamily: \"\",\r\n                        fontSize: \"12px\",\r\n                        color: \"#ef7297\"\r\n                    }\r\n                    , 'end_text_candy_tip'));\r\n                text.visible = true;\r\n                this.timer && this.game.time.events.remove(this.timer);\r\n                this.timer = this.game.time.events.add(1000, () => {\r\n                    text.visible = false;\r\n                })\r\n            };*/\r\n\r\n            const onBtnClicked = (obj, pointer) => {\r\n                if (pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n                    return;\r\n                }\r\n                switch (obj.name) {\r\n                    /*case 'end_button_candy':\r\n                        this.btnStatesChanged(null, null, obj, this.sceneProxy.endLayer.getByName(\"end_text_candy\"), 'icon_candy', text_normal);\r\n                        giveCandy();\r\n                        break;*/\r\n                    case 'end_button_get':\r\n                        this.btnStatesChanged(null, null, obj, this.sceneProxy.endLayer.getByName('end_text_gte'), 'icon_get', text_normal);\r\n                        this.sceneProxy.endLayer.visible = false;\r\n                        this.sceneProxy.visibleLayout = [this.sceneProxy.endLayer, ...this.sceneProxy.visibleLayout];\r\n                        this.sceneProxy.showLoad();\r\n                        break;\r\n                    case 'end_button_back':\r\n                        this.sceneProxy.reStart(this.sceneProxy.isExtend());\r\n                        this.btnStatesChanged(null, null, obj, this.sceneProxy.endLayer.getByName(\"end_text_back\"), 'icon_back', text_normal);\r\n                        this.sceneProxy.endLayer.visible = false;\r\n                        break;\r\n                    case 'end_button_save':\r\n                        this.btnStatesChanged(null, null, obj, this.sceneProxy.endLayer.getByName(\"end_text_save\"), 'icon_save', text_normal);\r\n                        this.sceneProxy.showSave();\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }\r\n            };\r\n\r\n            const itemBlackBk = this.game.add.bitmapData(this.game.world.width, this.game.world.height);\r\n            itemBlackBk.fill(0, 0, 0, 0.8);\r\n            const item_bk = this.game.add.sprite(0, 0, itemBlackBk);\r\n            item_bk.width = this.game.world.width;\r\n            item_bk.height = this.game.world.height;\r\n            item_bk.inputEnabled = true;\r\n            this.sceneProxy.endLayer.add(item_bk);\r\n\r\n            const text_normal = {\r\n                fontFamily: \"\",\r\n                fontSize: \"14px\",\r\n                color: \"#ffffff\"\r\n            };\r\n\r\n            const text_active = {\r\n                fontFamily: \"\",\r\n                fontSize: \"14px\",\r\n                color: \"#ef7297\"\r\n            };\r\n\r\n            /*const btn_candy = addButton(144, 100, 'icon_candy', 96, 96, 'end_button_candy');\r\n            const txt_candy = addTextContent(144, 200, 96, 30, \"游戏好棒，送颗糖\", text_normal, 'end_text_candy');\r\n\r\n            btn_candy.onInputOver.add(this.btnStatesChanged, this, 0, btn_candy, txt_candy, 'icon_candy_over_pressed', text_active);\r\n            btn_candy.onInputDown.add(this.btnStatesChanged, this, 0, btn_candy, txt_candy, 'icon_candy_over_pressed', text_active);\r\n            btn_candy.onInputOut.add(this.btnStatesChanged, this, 0, btn_candy, txt_candy, 'icon_candy', text_normal);*/\r\n\r\n            const btn_load = addButton(flashvars.vertical ? 55 : 168, flashvars.vertical ? 427 : 100, 'icon_get', 96, 96, 'end_button_get');\r\n            const txt_load = addTextContent(flashvars.vertical ? 55 : 168, flashvars.vertical ? 527 : 200, 96, 30, \"读取进度\", text_normal, 'end_text_get');\r\n\r\n            btn_load.onInputOver.add(this.btnStatesChanged, this, 0, btn_load, txt_load, 'icon_get_hover_pressed', text_active);\r\n            btn_load.onInputDown.add(this.btnStatesChanged, this, 0, btn_load, txt_load, 'icon_get_hover_pressed', text_active);\r\n            btn_load.onInputOut.add(this.btnStatesChanged, this, 0, btn_load, txt_load, 'icon_get', text_normal);\r\n\r\n            const btn_back = addButton(flashvars.vertical ? 216 : 432, flashvars.vertical ? 427 : 100, 'icon_back', 96, 96, 'end_button_back');\r\n            const txt_back = addTextContent(flashvars.vertical ? 216 : 432, flashvars.vertical ? 527 : 200, 96, 30, \"返回封面\", text_normal, 'end_text_back');\r\n\r\n            btn_back.onInputOver.add(this.btnStatesChanged, this, 0, btn_back, txt_back, 'icon_back_over_pressed', text_active);\r\n            btn_back.onInputDown.add(this.btnStatesChanged, this, 0, btn_back, txt_back, 'icon_back_over_pressed', text_active);\r\n            btn_back.onInputOut.add(this.btnStatesChanged, this, 0, btn_back, txt_back, 'icon_back', text_normal);\r\n\r\n            const btn_save = addButton(flashvars.vertical ? 377 : 696, flashvars.vertical ? 427 : 100, 'icon_save', 96, 96, 'end_button_save');\r\n            const txt_save = addTextContent(flashvars.vertical ? 377 : 696, flashvars.vertical ? 527 : 200, 96, 30, \"存个档，下次玩\", text_normal, 'end_text_save');\r\n\r\n            btn_save.onInputOver.add(this.btnStatesChanged, this, 0, btn_save, txt_save, 'icon_save_over_pressed', text_active);\r\n            btn_save.onInputDown.add(this.btnStatesChanged, this, 0, btn_save, txt_save, 'icon_save_over_pressed', text_active);\r\n            btn_save.onInputOut.add(this.btnStatesChanged, this, 0, btn_save, txt_save, 'icon_save', text_normal);\r\n\r\n            this.sceneProxy.endLayer.visible = false;\r\n        },\r\n\r\n        showEndLayer: function () {\r\n            this.sceneProxy.getSnap();\r\n            if (this.sceneProxy.endLayer.children.length === 0) {\r\n                this.addEnd()\r\n            }\r\n\r\n            this.game.world.bringToTop(this.sceneProxy.endLayer);\r\n            this.sceneProxy.endLayer.visible = true;\r\n        }\r\n    },\r\n    {\r\n        /**\r\n         * @static\r\n         * @type {string}\r\n         */\r\n        NAME: 'EndMediator'\r\n    }\r\n);","import Utils from '../../common/Utils.js';\r\n\r\nexport function HtmlTextBox(game,x,y,width,height,text,color,size,family,bold)\r\n{\r\n    Phaser.Group.call(this,game);\r\n\r\n    this.game = game;\r\n    this.name = 'input';\r\n    this.parentElement = game.canvas.parentNode;\r\n\r\n    //创建一个inputElement\r\n    this.textBoxElement = document.createElement('input');\r\n    this.textBoxElement.style.position = 'absolute';\r\n    this.textBoxElement.style.margin = '0';\r\n    this.textBoxElement.style.border = '0';\r\n    this.textBoxElement.style.padding = '0';\r\n    this.textBoxElement.style.left = x+'px';\r\n    this.textBoxElement.style.top = y+'px';\r\n    this.textBoxElement.style.width = width+'px';\r\n    this.textBoxElement.style.height = height+'px';\r\n    this.textBoxElement.style.color = color;\r\n    this.textBoxElement.style.backgroundColor = 'transparent';\r\n    this.textBoxElement.style.borderColor = 'transparent transparent transparent transparent';\r\n    this.textBoxElement.style.outline = 'none';\r\n    this.textBoxElement.style.fontSize = size + 'px';\r\n    this.textBoxElement.style.fontFamily = family;\r\n    this.textBoxElement.style.fontWeight = bold ? 'bold' : 'normal';\r\n    this.parentElement.insertBefore(this.textBoxElement,game.canvas);\r\n\r\n    this._x = x;\r\n    this._y = y;\r\n    this._width = width;\r\n    this._height = height;\r\n    this._fontSize = size;\r\n    this.text = text;\r\n    this.isValue = false;\r\n\r\n    game.add.existing(this);\r\n    this.onDestroy.add(function(group)\r\n    {\r\n        //删除界面上的Element\r\n        this.parentElement.removeChild(this.textBoxElement);\r\n    },this);\r\n    //this.update();\r\n}\r\n\r\nHtmlTextBox.prototype = Object.create(Phaser.Group.prototype);\r\nHtmlTextBox.prototype.constructor = HtmlTextBox;\r\n//更新函数，用来重新计算TextBox的位置\r\nHtmlTextBox.prototype.update  = function()\r\n{\r\n    let canvas = this.game.canvas;\r\n\r\n    let canvasX = canvas.offsetLeft;\r\n    let canvasY =  canvas.offsetTop;\r\n    let canvasWidth = canvas.offsetWidth;\r\n    let canvasHeight = canvas.offsetHeight;\r\n\r\n    if (this.oldCanvasWidth == canvasWidth && this.oldCanvasHeight == canvasHeight\r\n        && this.oldCanvasX == canvasX && this.oldCanvasY == canvasY) {\r\n        return;\r\n    }\r\n\r\n    let gameWidth = this.game.world.width;\r\n    let gameHeight = this.game.world.height;\r\n\r\n    if (canvas.offsetWidth > canvas.offsetHeight) {\r\n        let widthScale = (flashvars.vertical ? canvasHeight : canvasWidth)/gameWidth;\r\n        let heightScale = (flashvars.vertical ? canvasWidth : canvasHeight)/gameHeight;\r\n\r\n        let xScale = this._x/gameWidth;\r\n        let yScale = this._y/gameHeight;\r\n\r\n        let newX = flashvars.vertical ? (canvasX + canvasWidth - canvasWidth * yScale) : (canvasX + canvasWidth * xScale);\r\n        let newY = flashvars.vertical ? (canvasY + canvasHeight * xScale) : (canvasY + canvasHeight * yScale);\r\n        let newWidth = this._width * widthScale;\r\n        let newHeight = this._height * heightScale;\r\n        let fontSize = this._fontSize * heightScale;\r\n\r\n\r\n        this.setLeft(flashvars.vertical ? (newX - newWidth/2 - newHeight/2) : newX);\r\n        this.setTop(flashvars.vertical ? (newY + newWidth / 2 - newHeight / 2) : newY);\r\n        this.setWidth(newWidth);\r\n        this.setHeight(newHeight);\r\n        this.setFontSize(fontSize);\r\n        this.textBoxElement.style.transform = flashvars.vertical ? 'rotate(90deg)' : 'rotate(0deg)';\r\n    }\r\n    else {\r\n        let widthScale = (flashvars.vertical ? canvasWidth : canvasHeight)/gameWidth;\r\n        let heightScale = (flashvars.vertical ? canvasHeight : canvasWidth)/gameHeight;\r\n\r\n        let xScale = this._x/gameWidth;\r\n        let yScale = this._y/gameHeight;\r\n\r\n        let newX = flashvars.vertical ? (canvasX + canvasWidth * xScale) : (canvasX + canvasWidth - canvasWidth * yScale);\r\n        let newY = flashvars.vertical ? (canvasY + canvasHeight * yScale) : (canvasY + canvasHeight * xScale);\r\n        let newWidth = this._width * widthScale;\r\n        let newHeight = this._height * heightScale;\r\n        let fontSize = this._fontSize * heightScale;\r\n\r\n        this.setLeft(flashvars.vertical ? newX : (newX - newWidth/2 - newHeight/2));\r\n        this.setTop(flashvars.vertical ? newY : (newY + newWidth / 2 - newHeight / 2));\r\n        this.setWidth(newWidth);\r\n        this.setHeight(newHeight);\r\n        this.setFontSize(fontSize);\r\n\r\n        this.textBoxElement.style.transform = flashvars.vertical ? 'rotate(0deg)' : 'rotate(90deg)';\r\n    }\r\n\r\n    this.oldCanvasWidth = canvasWidth;\r\n    this.oldCanvasHeight = canvasHeight;\r\n    this.oldCanvasX = canvasX;\r\n    this.oldCanvasY = canvasY;\r\n};\r\n\r\nHtmlTextBox.prototype.destroy = function () {\r\n    this.parentElement.removeChild(this.textBoxElement);\r\n};\r\n\r\nHtmlTextBox.prototype.show = function (bShow) {\r\n    this.textBoxElement.style.visibility = bShow ? 'visible' : 'hidden';\r\n};\r\n\r\nHtmlTextBox.prototype.setInputCallback = function (callback) {\r\n    const inputUpdate = () => {\r\n        this._text = this.textBoxElement.value;\r\n        Utils.sensitiveWords.forEach(word => {\r\n            if (word.length === 0) return;\r\n\r\n            let index = this._text.indexOf(word);\r\n            if (index !== -1) {\r\n                let rw = '*'.repeat(word.length);\r\n                this._text = this._text.replace(new RegExp(word, 'gi'), rw);\r\n                this.textBoxElement.value = this._text;\r\n            }\r\n        })\r\n        callback(this._text);\r\n    };\r\n    if (flashvars.client === 'ios' || navigator.userAgent.indexOf('iPhone') > -1) {\r\n        /*this.textBoxElement.addEventListener('compositionstart', ()=>{\r\n            this.textBoxElement.style.backgroundColor = \"black\";\r\n        });\r\n        this.textBoxElement.addEventListener(\"compositionupdate\", () => {\r\n            this.textBoxElement.style.backgroundColor = \"red\"; //开始编辑，背景变成黄色\r\n        });*/\r\n        let agentV = navigator.userAgent.match(/CPU\\siPhone\\sOS\\s((([0-9]*)+(_))*)+([0-9]*)/gi);\r\n        if (agentV && (agentV[0] >= 'CPU iPhone OS 10_3_1' || agentV[0] === 'CPU iPhone OS 10_0_2')) {\r\n            this.textBoxElement.addEventListener(\"input\", inputUpdate, false);\r\n        } else {\r\n            this.textBoxElement.addEventListener('compositionend', () => {\r\n                this.textBoxElement.removeEventListener(\"input\", inputUpdate, false);\r\n                this.textBoxElement.addEventListener(\"input\", inputUpdate, false);\r\n            }, false);\r\n        }\r\n    } else {\r\n        this.textBoxElement.addEventListener(\"input\", inputUpdate, false);\r\n    }\r\n\r\n    this.textBoxElement.onblur = ()=> {\r\n        if (this.isValue) {\r\n            let v = parseFloat(this._text);\r\n            v ? this.text = v + '' : this.text = '0';\r\n        }\r\n    }\r\n};\r\n\r\nHtmlTextBox.prototype.setClickCallback = function (callback) {\r\n    this.textBoxElement.addEventListener('click', () => {callback(this);}, false);\r\n};\r\n\r\n//设置位置X\r\nHtmlTextBox.prototype.setLeft = function (left) {\r\n    this.textBoxElement.style.left = left+'px';\r\n};\r\n\r\nHtmlTextBox.prototype.setTop = function (top) {\r\n    this.textBoxElement.style.top = top+'px';\r\n};\r\n\r\n//设置width\r\nHtmlTextBox.prototype.setWidth = function(width) {\r\n    this.textBoxElement.style.width = width+'px';\r\n};\r\n\r\n//设置height\r\nHtmlTextBox.prototype.setHeight = function(height) {\r\n    this.textBoxElement.style.height = height+'px';\r\n};\r\n\r\n// 设置字体大小\r\nHtmlTextBox.prototype.setFontSize = function (fontSize) {\r\n    this.textBoxElement.style.fontSize = fontSize + 'px';\r\n};\r\n\r\n// Enable\r\nHtmlTextBox.prototype.setEnable = function (bEnabled) {\r\n    this.textBoxElement.readOnly = (!!bEnabled).toString();\r\n};\r\n\r\n//使用属性的方式操作X\r\nObject.defineProperty(HtmlTextBox.prototype,'x',\r\n    {\r\n        get:function()\r\n        {\r\n            return this._x;\r\n        },\r\n        set:function(value)\r\n        {\r\n            this.setLeft(value);\r\n            this._x = value;\r\n        }\r\n    });\r\n//使用属性的方式操作Y\r\nObject.defineProperty(HtmlTextBox.prototype,'y',\r\n    {\r\n        get:function()\r\n        {\r\n            return this._y;\r\n        },\r\n        set:function(value)\r\n        {\r\n            this.setTop(value);\r\n            this._y = value;\r\n        }\r\n    });\r\n\r\n//使用属性的方式操作width\r\nObject.defineProperty(HtmlTextBox.prototype,'width',\r\n    {\r\n        get:function()\r\n        {\r\n            return this._width;\r\n        },\r\n        set:function(value)\r\n        {\r\n            this.setWidth(value);\r\n            this._width = value;\r\n        }\r\n    });\r\n\r\n//使用属性的方式操作height\r\nObject.defineProperty(HtmlTextBox.prototype,'height',\r\n    {\r\n        get:function()\r\n        {\r\n            return this._height;\r\n        },\r\n        set:function(value)\r\n        {\r\n            this.setHeight(value);\r\n            this._height = value;\r\n        }\r\n    });\r\n\r\n//使用属性的方式操作fontSize\r\nObject.defineProperty(HtmlTextBox.prototype,'fontSize',\r\n    {\r\n        get:function () {\r\n            return this._fontSize;\r\n        },\r\n        set:function (value) {\r\n            this.setFontSize(value);\r\n            this._fontSize = value;\r\n        }\r\n    });\r\n\r\n//使用属性的方式操作style\r\nObject.defineProperty(HtmlTextBox.prototype,'style',\r\n    {\r\n        get:function()\r\n        {\r\n            return this._style;\r\n        },\r\n        set:function(value)\r\n        {\r\n            for(var key in value)\r\n            {\r\n                this.textBoxElement.style[key] = value[key];\r\n            }\r\n            this._style = value;\r\n        }\r\n    });\r\n\r\n//设置字体\r\nObject.defineProperty(HtmlTextBox.prototype,'text',\r\n    {\r\n        get:function()\r\n        {\r\n            return this._text;\r\n        },\r\n        set:function(value)\r\n        {\r\n            this.textBoxElement.value = value;\r\n            this._text = value;\r\n        }\r\n    });\r\n\r\n// enable\r\nObject.defineProperty(HtmlTextBox.prototype,'readOnly',\r\n    {\r\n        get:function()\r\n        {\r\n            return this.readOnly;\r\n        },\r\n        set:function(value)\r\n        {\r\n            this.setEnable(value);\r\n            this.textBoxElement.readOnly = (!!value).toString();\r\n        }\r\n    });","/**\r\n * Created by 4399-1126 on 2016/9/13.\r\n */\r\nimport puremvc from 'puremvc';\r\nimport FontUtils from '../../common/FontUtils.js';\r\npuremvc.define\r\n(\r\n    {\r\n        name: 'diygamePlayer.view.mediator.MainMenuMediator',\r\n        parent: puremvc.Mediator\r\n    },\r\n    {\r\n        listNotificationInterests: function () {\r\n            return [\r\n                diygamePlayer.AppConstants.SCENE_GOTO_MAINMENU\r\n            ]\r\n        },\r\n\r\n        handleNotification: function (note) {\r\n            const body = note.getBody();\r\n            switch (note.getName()) {\r\n                case diygamePlayer.AppConstants.SCENE_GOTO_MAINMENU:\r\n                    this.showMainMenuLayer(body);\r\n                default:\r\n                    break;\r\n            }\r\n        },\r\n\r\n        onRegister: function () {\r\n            this.sceneProxy = this.facade.retrieveProxy(diygamePlayer.model.proxy.SceneProxy.NAME);\r\n            this.sceneMediator = this.facade.retrieveMediator(diygamePlayer.view.mediator.SceneMediator.NAME);\r\n            this.game = this.sceneMediator.viewComponent && this.sceneMediator.viewComponent.game;\r\n            this.viewComponent = this.sceneMediator.viewComponent;\r\n            this.isAllHide = false;\r\n        },\r\n        /**\r\n         * 添加系统菜单\r\n         */\r\n        addMainMenu: function () {\r\n            const {background, header, save, load, playback, settings, autoplay, back} = this.sceneProxy.json_data.template.json.mainMenu;\r\n\r\n            const addImgFontText = (textInfo, x, y, width, height, content, textObj) => {\r\n                const fontSize = textInfo.fontSize ? parseInt(textInfo.fontSize) : 25;\r\n                const color = textInfo.color ? textInfo.color : '#fefefe';\r\n\r\n                const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(fontSize) : fontSize;\r\n                const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(fontSize) : fontSize;\r\n                const w = fw * content.length;\r\n                const l = x + (width - w) / 2;\r\n                const t = y + (height - fh) / 2;\r\n                const txtImg = this.sceneProxy.addRetroText(l, t, w, fh, content);\r\n                txtImg.tint = (color === '#ffffff' ? '#fefefe' : color).replace('#', '0x');\r\n\r\n                textObj.addChild(txtImg);\r\n                textObj.text = ' ';\r\n            };\r\n            const addTextContent = (x, y, width, height, content, objText, name) => {\r\n                const fontStyle = {};\r\n                let ff = '';\r\n                ff += objText.fontWeight ? objText.fontWeight + ' ' : 'normal ';\r\n                ff += objText.fontSize ? parseInt(objText.fontSize) + 'px ' : '';\r\n                ff += this.sceneProxy.json_data.font ? this.sceneProxy.json_data.font.fontFamily : objText.fontFamily ? objText.fontFamily : '';\r\n\r\n                fontStyle.font = ff;\r\n                fontStyle.fill = objText.color;\r\n                fontStyle.boundsAlignH = \"center\";\r\n                fontStyle.boundsAlignV = \"middle\";\r\n                fontStyle.stroke = objText.stroke;\r\n                fontStyle.strokeThickness = objText.stroke ? 2 : 0;\r\n\r\n                const txt = this.viewComponent.game.add.text(0, 0, content, fontStyle, this.sceneProxy.mainMenuLayer);\r\n                txt.name = name;\r\n                if (FontUtils.fontFamily) {\r\n                    addImgFontText(objText, x, y, width, height, content, txt);\r\n                }\r\n                else {\r\n                    txt.setTextBounds(x, y + (txt.height - parseInt(objText.fontSize)) / 2, width, height);\r\n                }\r\n\r\n                objText.hidden && (txt.visible = false);\r\n                return txt;\r\n            };\r\n            const addButton = (obj, name, text) => {\r\n                const t = {};\r\n                t.normal = obj.normal.text;\r\n                t.active = obj.active.text;\r\n                t.text = text;\r\n                const btnGroup = this.viewComponent.addButton(obj.rect.x,\r\n                    obj.rect.y,\r\n                    obj.rect.width,\r\n                    obj.rect.height,\r\n                    obj.normal.background.url,\r\n                    obj.active.background.url,\r\n                    onBtnClicked,\r\n                    t,\r\n                    this.sceneProxy.btn_sound,\r\n                    name,\r\n                    this.sceneProxy.mainMenuLayer\r\n                );\r\n                btnGroup.button.onInputUp.add(() => this.sceneProxy.btn_sound && this.sceneProxy.btn_sound.stop())\r\n            };\r\n\r\n            const onBtnClicked = (obj, pointer) => {\r\n                if (pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n                    return;\r\n                }\r\n                if (obj.parent.name === 'mainMenu_button_save') {\r\n                    // 保存进度\r\n                    this.sceneProxy.onMainMenuSaveBtnClicked();\r\n                }\r\n                else if (obj.parent.name === 'mainMenu_button_load') {\r\n                    // 读取进度\r\n                    this.sceneProxy.onMainMenuLoadBtnClicked();\r\n                }\r\n                else if (obj.parent.name === 'mainMenu_button_playback') {\r\n                    // 剧情回放\r\n                    this.sceneProxy.onMainMenuPlaybackBtnClicked();\r\n                }\r\n                else if (obj.parent.name === 'mainMenu_button_autoplay') {\r\n                    // 自动播放\r\n                    this.sceneProxy.onMainMenuAutoplayBtnClicked();\r\n                }\r\n                else if (obj.parent.name === 'mainMenu_button_settings') {\r\n                    // 游戏设置\r\n                    this.sceneProxy.onMainMenuSettingsBtnClicked();\r\n                }\r\n                else if (obj.parent.name === 'mainMenu_button_back') {\r\n                    // 返回\r\n                    this.sceneProxy.onMainMenuBackBtnClicked();\r\n                }\r\n            };\r\n\r\n            const bk = this.viewComponent.game.add.image(0, 0, this.viewComponent.game.load.cache.checkImageKey(background.url) && background.url);\r\n            bk.width = this.viewComponent.game.world.width;\r\n            bk.height = this.viewComponent.game.world.height;\r\n            bk.inputEnabled = true;\r\n            this.sceneProxy.mainMenuLayer.add(bk);\r\n\r\n            // header\r\n            if (this.viewComponent.game.load.cache.checkImageKey(header.background.url)) {\r\n                const head = this.sceneProxy.mainMenuLayer.create(header.rect.x\r\n                    , header.rect.y\r\n                    , header.background.url);\r\n                head.width = header.rect.width;\r\n                head.height = header.rect.height;\r\n            }\r\n            if (!header.title.text.hidden) {\r\n                addTextContent(header.title.rect.x + header.rect.x\r\n                    , header.title.rect.y + header.rect.y\r\n                    , header.title.rect.width\r\n                    , header.title.rect.height\r\n                    , this.sceneProxy.stringMap.mainMenu\r\n                    , header.title.text\r\n                    , 'mainMenu_text_header');\r\n            }\r\n\r\n            // 按钮-保存进度\r\n            if (!save.hidden) {\r\n                addButton(save, 'mainMenu_button_save', this.sceneProxy.stringMap.save);\r\n            }\r\n\r\n            // 按钮-读取进度\r\n            if (!load.hidden) {\r\n                addButton(load, 'mainMenu_button_load', this.sceneProxy.stringMap.load);\r\n            }\r\n\r\n            // 按钮-剧情回放\r\n            if (!playback.hidden) {\r\n                addButton(playback, 'mainMenu_button_playback', this.sceneProxy.stringMap.playback);\r\n            }\r\n\r\n            // 按钮-自动播放\r\n            if (!autoplay.hidden) {\r\n                addButton(autoplay, 'mainMenu_button_autoplay', this.sceneProxy.stringMap.autoplay);\r\n            }\r\n\r\n            // 按钮-游戏设置\r\n            if (!settings.hidden) {\r\n                addButton(settings, 'mainMenu_button_settings', this.sceneProxy.stringMap.settings);\r\n            }\r\n\r\n            // 按钮-返回\r\n            if (!back.hidden) {\r\n                addButton(back, 'mainMenu_button_back', this.sceneProxy.stringMap.back);\r\n            }\r\n            this.sceneProxy.mainMenuLayer.visible = false;\r\n            if(save.hidden && load.hidden && playback.hidden && settings.hidden && back.hidden){\r\n                //系统菜单项隐藏 点击菜单无效\r\n                this.isAllHide = true;\r\n            }\r\n        },\r\n        /***\r\n         * 添加diy菜单\r\n         */\r\n        addDiyMainMenuenu:function () {\r\n            const {mainMenu: mainMenuView} = this.sceneProxy.json_data.default_settings;\r\n            let bk = this.viewComponent.game.add.graphics(0, 0, this.sceneProxy.mainMenuLayer);\r\n            bk.beginFill(0x0, 0);\r\n            bk.drawRect(0, 0, this.viewComponent.game.world.width, this.viewComponent.game.world.height);\r\n            bk.endFill();\r\n            bk.inputEnabled = true;\r\n            this.sceneMediator.registerViewKey(mainMenuView.ref, mainMenuView.events, this.sceneProxy.plotViewKeys);\r\n            let menuView = this.sceneMediator.addView(this.sceneProxy.mainMenuLayer, mainMenuView.ref, mainMenuView.instanceUuid\r\n                , mainMenuView.x, mainMenuView.y, mainMenuView.events,false,false,true);\r\n            menuView.isMenu = true;\r\n            // 找出菜单中添加的计时器\r\n            const getTimerInMenu = ()=> {\r\n                const visitInChild = view => {\r\n                    if (view.viewType === 'TIMER') {\r\n                        this.sceneProxy.menuTimer[this.sceneProxy.menuTimer.length] = view.name;\r\n                    }\r\n                    view.children.forEach(v => {visitInChild(v)});\r\n                };\r\n                menuView.children.forEach(v => {visitInChild(v)});\r\n            };\r\n            getTimerInMenu();\r\n            this.sceneMediator.uiOnLoadInvoker();\r\n        },\r\n\r\n        showMainMenuLayer: function (context) {\r\n            if (this.sceneProxy.mainMenuLayer.children.length > 0 && this.sceneProxy.json_data.default_settings.mainMenu){\r\n                //diy菜单\r\n                this.sceneProxy.mainMenuLayer.removeAll(true);\r\n            }\r\n            if (this.sceneProxy.mainMenuLayer.children.length === 0) {\r\n                if (this.sceneProxy.json_data.default_settings.mainMenu) {\r\n                    this.addDiyMainMenuenu();\r\n                } else {\r\n                    this.addMainMenu();\r\n                }\r\n            }\r\n            const autoButton = this.sceneProxy.mainMenuLayer.getByName('mainMenu_button_autoplay');\r\n            const autoText = autoButton ? autoButton.getByName(\"text\") : undefined;\r\n            if (context.auto) {\r\n                if (autoText) {\r\n                    if (FontUtils.fontFamily) {\r\n                        const txtImgOld = autoText.children[0];\r\n                        if (txtImgOld) {\r\n                            //autoText.children[0].fontImg.text = this.sceneProxy.stringMap.manualPlay;\r\n\r\n                            const {autoplay} = this.sceneProxy.json_data.template.json.mainMenu;\r\n                            const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(autoplay.normal.text.fontSize) : autoplay.normal.text.fontSize;\r\n                            const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(autoplay.normal.text.fontSize) : autoplay.normal.text.fontSize;\r\n                            const w = fw * this.sceneProxy.stringMap.manualPlay.length;\r\n                            const x = (autoplay.rect.width - w) / 2;\r\n                            const y = (autoplay.rect.height - fh) / 2;\r\n                            this.sceneProxy.addImageFontText([{data: this.sceneProxy.stringMap.manualPlay}], fw, fh, autoText, context);\r\n                            autoText.children[0].x = x;\r\n                            autoText.children[0].y = y;\r\n                            txtImgOld.children.forEach(item => item.fontImg.destroy());\r\n                            txtImgOld.destroy();\r\n                            autoText.text = ' ';\r\n                        }\r\n                    }\r\n                    else {\r\n                        autoText.text = this.sceneProxy.stringMap.manualPlay;\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                if (autoText) {\r\n                    if (FontUtils.fontFamily) {\r\n                        const txtImgOld = autoText.children[0];\r\n                        if (txtImgOld) {\r\n                            //autoText.children[0].fontImg.text = this.sceneProxy.stringMap.autoplay;\r\n\r\n                            const {autoplay} = this.sceneProxy.json_data.template.json.mainMenu;\r\n                            const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(autoplay.normal.text.fontSize) : autoplay.normal.text.fontSize;\r\n                            const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(autoplay.normal.text.fontSize) : autoplay.normal.text.fontSize;\r\n                            const w = fw * this.sceneProxy.stringMap.autoplay.length;\r\n                            const x = (autoplay.rect.width - w) / 2;\r\n                            const y = (autoplay.rect.height - fh) / 2;\r\n                            this.sceneProxy.addImageFontText([{data: this.sceneProxy.stringMap.autoplay}], fw, fh, autoText, context);\r\n                            autoText.children[0].x = x;\r\n                            autoText.children[0].y = y;\r\n                            txtImgOld.children.forEach(item => item.fontImg.destroy());\r\n                            txtImgOld.destroy();\r\n                            autoText.text = ' ';\r\n                        }\r\n                    }\r\n                    else {\r\n                        autoText.text = this.sceneProxy.stringMap.autoplay;\r\n                    }\r\n                }\r\n            }\r\n            this.viewComponent.game.world.bringToTop(this.sceneProxy.mainMenuLayer);\r\n            this.sceneProxy.mainMenuLayer.visible = true;\r\n            if(this.isAllHide !== false){\r\n                this.sceneProxy.onMainMenuBackBtnClicked();\r\n            }\r\n        }\r\n    },\r\n    {\r\n        /**\r\n         * @static\r\n         * @type {string}\r\n         */\r\n        NAME: 'MainMenuMediator'\r\n        ,isAllHide : false\r\n    }\r\n);","/**\r\n * Created by 4399-1126 on 2016/9/13.\r\n */\r\nimport puremvc from 'puremvc';\r\nimport RePhaser from '../../common/RePhaser.js';\r\nimport FontUtils from '../../common/FontUtils.js';\r\n\r\npuremvc.define\r\n(\r\n    {\r\n        name: 'diygamePlayer.view.mediator.PlaybackMediator',\r\n        parent: puremvc.Mediator\r\n    },\r\n    {\r\n        listNotificationInterests: function () {\r\n            return [\r\n                diygamePlayer.AppConstants.SCENE_GOTO_PLAYBACK,\r\n                diygamePlayer.AppConstants.ADD_PLAYBACK_CONTENT\r\n            ]\r\n        },\r\n\r\n        handleNotification: function (note) {\r\n            switch (note.getName()) {\r\n                case diygamePlayer.AppConstants.SCENE_GOTO_PLAYBACK:\r\n                    this.callbackInfo = note.getBody();\r\n                    this.showPlaybackLayer();\r\n                    break;\r\n                case diygamePlayer.AppConstants.ADD_PLAYBACK_CONTENT:\r\n                    const body = note.getBody();\r\n                    this.addPlaybackContent(body);\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        },\r\n\r\n        onRegister: function () {\r\n            this.sceneProxy = this.facade.retrieveProxy(diygamePlayer.model.proxy.SceneProxy.NAME);\r\n            const sceneMediator = this.facade.retrieveMediator(diygamePlayer.view.mediator.SceneMediator.NAME);\r\n            this.game = sceneMediator.viewComponent && sceneMediator.viewComponent.game;\r\n            this.viewComponent = sceneMediator.viewComponent;\r\n        },\r\n\r\n        addTextContent: function (x, y, width, height, content, objText) {\r\n            const fontStyle = {boundsAlignH: 'center', boundsAlignV: 'middle', wordWrap: true};\r\n            let ff = '';\r\n            ff += objText.fontWeight ? objText.fontWeight + ' ' : 'normal ';\r\n            ff += objText.fontSize ? parseInt(objText.fontSize) + 'px ' : '';\r\n            ff += objText.fontFamily ? objText.fontFamily : '黑体';\r\n\r\n            fontStyle.font = ff;\r\n            fontStyle.fill = objText.color;\r\n            fontStyle.wordWrapWidth = width;\r\n            if (this.sceneProxy.stringMap.back === content) {\r\n                fontStyle.boundsAlignH = 'center';\r\n                fontStyle.boundsAlignV = \"middle\";\r\n            } else {\r\n                fontStyle.boundsAlignH = 'left';\r\n                fontStyle.boundsAlignV = 'top';\r\n            }\r\n            const txt = this.game.add.text(0, 0, content, fontStyle, this.sceneProxy.playBackLayer);\r\n            txt.setTextBounds(x, y + (txt.height - parseInt(objText.fontSize || 12)) / 2, width, height);\r\n            return txt;\r\n        },\r\n\r\n        addPlayback: function () {\r\n            const {scrollBox, back, background} = this.sceneProxy.json_data.template.json.playback;\r\n\r\n            // 背景\r\n            const bk = this.sceneProxy.playBackLayer.create(0, 0, this.game.load.cache.checkImageKey(background.url) && background.url);\r\n            bk.width = this.game.world.width;\r\n            bk.height = this.game.world.height;\r\n            bk.inputEnabled = true;\r\n            // scrollBox\r\n            const boxX = scrollBox.rect.x;\r\n            const boxY = scrollBox.rect.y;\r\n            const boxWidth = scrollBox.rect.width;\r\n            const boxHeight = scrollBox.rect.height;\r\n            const backgroundRect = Object.assign({x: 0, y: 0, width: boxWidth, height: boxHeight}, scrollBox.background.rect);\r\n\r\n            const scrollBk = this.sceneProxy.playBackLayer.create(boxX + backgroundRect.x,\r\n                boxY + backgroundRect.y,\r\n                this.game.load.cache.checkImageKey(scrollBox.background.url) && scrollBox.background.url);\r\n            scrollBk.width = backgroundRect.width;\r\n            scrollBk.height = backgroundRect.height;\r\n\r\n            const scrollPane = this.game.add.sprite(0, 0);\r\n            const scrollX = boxX;\r\n            const scrollY = boxY;\r\n            scrollPane.x = scrollX;\r\n            scrollPane.y = scrollY;\r\n            scrollPane.name = 'scrollPane';\r\n            this.sceneProxy.playBackLayer.add(scrollPane);\r\n\r\n            // item\r\n            const itemWidth = scrollBox.item.rect.width;\r\n            const itemHeight = scrollBox.item.rect.height;\r\n            const hSpace = Math.max(itemHeight - scrollBox.item.content.rect.height, 0);\r\n            let dragStartPointX = 0;\r\n            let dragStartY = null;\r\n            let wheelEvent = false;\r\n            const onMove = (pointer, x, y) => {\r\n                const point = getPoint(pointer);\r\n                const mousewheelevt = (/Firefox/i.test(navigator.userAgent)) ? \"DOMMouseScroll\" : \"mousewheel\";\r\n                if (!point) {\r\n                    if (wheelEvent) {\r\n                        document.removeEventListener(mousewheelevt, onMouseWheel);\r\n                        wheelEvent = false;\r\n                    }\r\n                }\r\n                else {\r\n                    if (!wheelEvent) {\r\n                        document.addEventListener(mousewheelevt, onMouseWheel);\r\n                        wheelEvent = true;\r\n                    }\r\n                }\r\n            };\r\n            const onScroll = (x, y) => {\r\n                const height = scrollPane.children.length * itemHeight - hSpace;\r\n                if (height < boxHeight) {\r\n                    scrollPane.y = boxY;\r\n                    return;\r\n                }\r\n                if (x !== boxX) {\r\n                    scrollPane.x = boxX;\r\n                }\r\n                if (y > boxY) {\r\n                    scrollPane.y = boxY;\r\n                }\r\n                else if (y + height < boxY + boxHeight) {\r\n                    scrollPane.y = boxY + boxHeight - height;\r\n                }\r\n                else {\r\n                    scrollPane.y = y;\r\n                }\r\n            };\r\n            const onDragUpdate = (sprite, pointer, x, y, pt, bFromStart) => {\r\n                let px = x;\r\n                let py = y;\r\n                bFromStart && (dragStartPointX = x);\r\n                dragStartY = scrollPane.y;\r\n                if (document.body.clientWidth < document.body.clientHeight && dragStartY !== null) {\r\n                    py = dragStartY - x + dragStartPointX;\r\n                }\r\n                onScroll(px, py);\r\n            };\r\n            const getPoint = (pointer) => {\r\n                let x, y;\r\n                let w = (window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth);\r\n                let h = (window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight);\r\n                if (w > h) {\r\n                    if(flashvars.vertical){\r\n                        x = pointer.worldY;\r\n                        y = -pointer.worldX;\r\n                    }else{\r\n                        x = pointer.worldX;\r\n                        y = pointer.worldY;\r\n                    }\r\n                }\r\n                else {\r\n                    if(flashvars.vertical){\r\n                        x = pointer.worldX;\r\n                        y = pointer.worldY;\r\n                    }else{\r\n                        x = pointer.worldY;\r\n                        y = -pointer.worldX;\r\n                    }\r\n                }\r\n                if (y < scrollY || y > /*boxY*/scrollY + boxHeight ||\r\n                    x < scrollX || x > /*boxX*/scrollX + boxWidth) {\r\n                    return null;\r\n                }\r\n                return {x, y}\r\n            };\r\n            const onInputDown = (sprite, pointer, x, y) => {\r\n                if (!getPoint(pointer)) {\r\n                    return sprite.input.disableDrag();\r\n                }\r\n                return sprite.input.enableDrag();\r\n            };\r\n            const onMouseWheel = e => {\r\n                const delta = e.wheelDelta ? e.wheelDelta / 120 : -e.detail / 3;\r\n                onScroll(0, scrollPane.y + delta * 100)\r\n            };\r\n\r\n            scrollPane.inputEnabled = true;\r\n            scrollPane.input.enableDrag();\r\n            scrollPane.input.allowHorizontalDrag = false;\r\n            scrollPane.events.onDragUpdate.add(onDragUpdate, this);\r\n            scrollPane.events.onInputDown.add(onInputDown, this);\r\n            this.game.input.addMoveCallback(onMove, this);\r\n            // mask\r\n            const mask = this.game.add.graphics(0, 0);\r\n            mask.beginFill(0xffffff);\r\n            mask.drawRect(boxX, boxY, boxWidth, boxHeight);\r\n            this.sceneProxy.playBackLayer.add(mask);\r\n            scrollPane.mask = mask;\r\n            // 返回按钮\r\n            const onBtnClicked = (obj, pointer) => {\r\n                if (pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n                    return;\r\n                }\r\n                this.sceneProxy.onPlaybackBackBtnClicked();\r\n                if (this.callbackInfo) {\r\n                    this.callbackInfo.callbackFun(this.callbackInfo.callbackArgs);\r\n                    this.callbackInfo = null;\r\n                }\r\n            };\r\n            if (!back.hidden) {\r\n                const t = {};\r\n                t.normal = back.normal.text;\r\n                t.active = back.active.text;\r\n                t.text = this.sceneProxy.stringMap.back;\r\n                let btn_sound = null;\r\n                if(this.sceneProxy.json_data.template.json.sound){\r\n                    const {sound} = this.sceneProxy.json_data.template.json;\r\n                    if(this.sceneProxy.viewComponent.game.load.cache.checkSoundKey(sound.url)){\r\n                        btn_sound = this.sceneProxy.viewComponent.game.add.sound(sound.url, sound.volume)\r\n                    }\r\n                }\r\n                const btnGroup = this.viewComponent.addButton(back.rect.x,\r\n                    back.rect.y,\r\n                    back.rect.width,\r\n                    back.rect.height,\r\n                    back.normal.background.url,\r\n                    back.active.background.url,\r\n                    onBtnClicked,\r\n                    t,\r\n                    btn_sound,\r\n                    \"playBack_button_back\",\r\n                    this.sceneProxy.playBackLayer\r\n                );\r\n                btnGroup.button.onInputUp.add(() => btn_sound && btn_sound.stop())\r\n            }\r\n            this.sceneProxy.playBackLayer.visible = false;\r\n        },\r\n\r\n        addPlaybackContent: function (data) {\r\n            this.sceneProxy.playbackData.push(data);\r\n            if (this.sceneProxy.playbackData.length > 100) {\r\n                this.sceneProxy.playbackData.splice(0, 1);\r\n            }\r\n        },\r\n\r\n        addPlaybackItem: function (data) {\r\n            const scrollPane = this.sceneProxy.playBackLayer.getByName('scrollPane');\r\n            const {scrollBox} = this.sceneProxy.json_data.template.json.playback;\r\n\r\n            const keyItemBk = this.game.load.cache.checkImageKey(scrollBox.item.background.url) ? scrollBox.item.background.url : null;\r\n            const keySubItemBk = this.game.load.cache.checkImageKey(scrollBox.item.content.background.url) ? scrollBox.item.content.background.url : null;\r\n            const contentX = scrollBox.item.rect.x + scrollBox.item.content.rect.x;\r\n            const contentY = scrollBox.item.rect.y + scrollBox.item.content.rect.y;\r\n\r\n            const itemGroup = this.game.add.group();\r\n            itemGroup.x = scrollBox.item.rect.x;\r\n            itemGroup.y = scrollBox.item.rect.y + scrollBox.item.rect.height * scrollPane.children.length;\r\n\r\n            const itemBackground = this.game.add.sprite(0, 0, keyItemBk);\r\n            itemBackground.width = scrollBox.item.rect.width;\r\n            itemBackground.height = scrollBox.item.rect.height;\r\n            const itemContent = this.game.add.sprite(contentX, contentY, keySubItemBk);\r\n            itemContent.width = scrollBox.item.content.rect.width;\r\n            itemContent.height = scrollBox.item.content.rect.height;\r\n\r\n            const itemText = this.addTextContent(contentX + 10,\r\n                contentY,\r\n                scrollBox.item.content.rect.width - 10,\r\n                scrollBox.item.content.rect.height,\r\n                \"\",\r\n                scrollBox.item.content.text);\r\n            itemText.useAdvancedWrap = true;\r\n            itemText.updateText = RePhaser.updateText;\r\n            itemText.advancedWordWrap = RePhaser.advancedWordWrap;\r\n            itemText.lineSpacing = -parseInt(scrollBox.item.content.text.fontSize || 12) / 5;\r\n            itemText.text = data;\r\n            itemText.name = 'text';\r\n\r\n            const mask = this.game.add.graphics(0, 0);\r\n            mask.beginFill(0xffffff);\r\n            mask.drawRect(contentX, contentY, itemContent.width, itemContent.height);\r\n            itemText.mask = mask;\r\n            itemGroup.addChild(mask);\r\n\r\n            itemGroup.add(itemBackground);\r\n            itemGroup.add(itemContent);\r\n            itemGroup.add(itemText);\r\n            scrollPane.addChild(itemGroup);\r\n            /*if (scrollPane.children.length > 100) {\r\n                scrollPane.removeChildAt(0);\r\n                scrollPane.children.forEach(c => c.y -= scrollBox.item.rect.height)\r\n            }*/\r\n        },\r\n\r\n        showPlaybackLayer: function () {\r\n            /*if (this.sceneProxy.playBackLayer.children.length === 0) {\r\n                this.addPlayback();\r\n            }*/\r\n            this.sceneProxy.playBackLayer.removeAll(true);\r\n            this.addPlayback();\r\n            this.sceneProxy.playbackData.forEach(d => {this.addPlaybackItem(d)});\r\n            this.game.world.bringToTop(this.sceneProxy.playBackLayer);\r\n            this.sceneProxy.playBackLayer.visible = true;\r\n            // 滚动位置\r\n            const {rect, item} = this.sceneProxy.json_data.template.json.playback.scrollBox;\r\n            const scrollPane = this.sceneProxy.playBackLayer.getByName('scrollPane');\r\n            const hSpace = Math.max(item.rect.height - item.content.rect.height, 0);\r\n            const height = scrollPane.children.length * item.rect.height - hSpace;\r\n            const y = rect.y + item.rect.y;\r\n            if (height < rect.height) {\r\n                scrollPane.y = y;\r\n            } else {\r\n                scrollPane.y = y - height + rect.height;\r\n            }\r\n        }\r\n    },\r\n    {\r\n        /**\r\n         * @static\r\n         * @type {string}\r\n         */\r\n        NAME: 'PlaybackMediator'\r\n    }\r\n);","/**\r\n * Created by 4399-1126 on 2016/9/13.\r\n */\r\nimport puremvc from 'puremvc';\r\nimport MD5 from 'spark-md5';\r\nimport Dialog from './../../common/Dialog.js';\r\nimport Utils from './../../common/Utils.js';\r\nimport FontUtils from '../../common/FontUtils.js';\r\n\r\npuremvc.define\r\n(\r\n    {\r\n        name: 'diygamePlayer.view.mediator.RecordMediator',\r\n        parent: puremvc.Mediator\r\n    },\r\n    {\r\n        listNotificationInterests: function () {\r\n            return [\r\n                diygamePlayer.AppConstants.SCENE_GOTO_RECORD\r\n            ]\r\n        },\r\n\r\n        handleNotification: function (note) {\r\n            const body = note.getBody();\r\n            this.callbackInfo = !!body ? body : (this.sceneProxy.recordLayer ? this.callbackInfo : null);\r\n            switch (note.getName()) {\r\n                case diygamePlayer.AppConstants.SCENE_GOTO_RECORD:\r\n                    this.showRecordLayer();\r\n                    break;\r\n                default:\r\n                    break\r\n            }\r\n        },\r\n\r\n        onRegister: function () {\r\n            this.sceneProxy = this.facade.retrieveProxy(diygamePlayer.model.proxy.SceneProxy.NAME);\r\n            const sceneMediator = this.facade.retrieveMediator(diygamePlayer.view.mediator.SceneMediator.NAME);\r\n            this.game = sceneMediator.viewComponent && sceneMediator.viewComponent.game;\r\n            this.viewComponent = sceneMediator.viewComponent;\r\n            this.localMode = true;\r\n            this.isChangeClick = false;\r\n            this.clicktime = 0;\r\n            this.clickchangetime = 0;\r\n        },\r\n\r\n        onLocalBtnClicked: function() {\r\n            if(this.clickInterval(800) !== true) return;\r\n            if (!this.localMode) {\r\n                this.localMode = true;\r\n                this.isChangeClick = true;\r\n                const btnLocal = this.sceneProxy.recordLayer.getByName('local_btn');\r\n                const btnCloud = this.sceneProxy.recordLayer.getByName('cloud_btn');\r\n                btnLocal && btnLocal.changeBackground('local_hover');\r\n                btnCloud && btnCloud.changeBackground('cloud');\r\n                this.sceneProxy.onRecordLocalBtnClicked();\r\n            }\r\n        },\r\n\r\n        onCloudBtnClicked: function() {\r\n            if(this.clickInterval(800) !== true) return;\r\n            if (this.localMode) {\r\n                this.sceneProxy.isSignedIn().then(() => {\r\n                    this.localMode = false;\r\n                    this.isChangeClick = true;\r\n                    const btnLocal = this.sceneProxy.recordLayer.getByName('local_btn');\r\n                    const btnCloud = this.sceneProxy.recordLayer.getByName('cloud_btn');\r\n                    btnLocal && btnLocal.changeBackground('local');\r\n                    btnCloud && btnCloud.changeBackground('cloud_hover');\r\n                    this.sceneProxy.onRecordCloudBtnClicked();\r\n                }, rj => {\r\n                    let n = rj.indexOf('- status:-1');\r\n                    n = n >= 0 ? n : rj.indexOf('- status:2');\r\n                    if (n >= 0) {\r\n                        this.sceneProxy.context.fullScreen && this.sceneProxy.onSettingsWindowModeBtnClicked();\r\n                        //频繁操作，强行切换到本地存档   先切换 再弹窗;\r\n                        if(rj.indexOf('- status:-110') > 0){\r\n                            const btnLocal = this.sceneProxy.recordLayer.getByName('local_btn');\r\n                            const btnCloud = this.sceneProxy.recordLayer.getByName('cloud_btn');\r\n                            btnLocal && btnLocal.changeBackground(\"local_hover\",\"local_btn\");\r\n                            btnCloud && btnCloud.changeBackground(\"cloud\",\"cloud_btn\");\r\n                            this.sceneProxy.onRecordLocalBtnClicked();\r\n                            this.localMode = true;\r\n                            Dialog.error(rj.substr(0, n)).then(()=>{},()=>{});\r\n                            return;\r\n                        }\r\n                        if (flashvars.app_version >= '1.2.0') {\r\n                            window.location.href = 'lzj3000://logout';\r\n                        }\r\n                        if(flashvars.client === 'wap'){\r\n                            window.parent && window.parent.playLogin();\r\n                        }else{\r\n                            Dialog.error(rj.substr(0, n)).then(()=>{\r\n                                window.location.href = 'lzj3000://login';\r\n                            })\r\n                        }\r\n                    } else if (0 <= rj.indexOf('error')) {\r\n                        this.sceneProxy.context.fullScreen && this.sceneProxy.onSettingsWindowModeBtnClicked();\r\n                        Dialog.error('网络异常，请检查您的网络！');\r\n                    }\r\n                });\r\n            }\r\n        },\r\n\r\n        addRecord: function () {\r\n            const {background, scrollBox, back} = this.sceneProxy.json_data.template.json.record;\r\n            let {rect: boxRect, item: boxItem, itemsOffsetX, itemsOffsetY, itemSpaceX: hSpace, itemSpaceY: vSpace} = scrollBox;\r\n            const {rect: itemRect, hint, content} = boxItem;\r\n            const {rect: hintRect, text: hintText} = hint;\r\n            const {rect: contentRect} = content;\r\n            const {x: boxX, y: boxY, width: boxWidth, height: boxHeight} = boxRect;\r\n            const {x: itemX, y: itemY, width: itemWidth, height: itemHeight} = itemRect;\r\n            const {x: hintX, y: hintY, width: hintWidth, height: hintHeight} = hintRect;\r\n            const {x: contentX, y: contentY, width: contentWidth, height: contentHeight} = contentRect;\r\n            hSpace = hSpace === undefined ? 20 : hSpace;\r\n            vSpace = vSpace === undefined ? 12 : vSpace;\r\n            itemsOffsetX = itemsOffsetX === undefined ? 0 : itemsOffsetX;\r\n            itemsOffsetY = itemsOffsetY === undefined ? 0 : itemsOffsetY;\r\n\r\n            const fontStyle = {boundsAlignH: 'center', boundsAlignV: 'middle'};\r\n            const addTextContent = (x, y, width, height, content, objText) => {\r\n                let txt;\r\n                let ff = '';\r\n                ff += objText.fontWeight ? objText.fontWeight + ' ' : 'normal ';\r\n                ff += objText.fontSize ? parseInt(objText.fontSize) + 'px ' : '';\r\n                ff += this.sceneProxy.json_data.font ? this.sceneProxy.json_data.font.fontFamily : objText.fontFamily ? objText.fontFamily : '';\r\n\r\n                fontStyle.font = ff;\r\n                fontStyle.fill = objText.color;\r\n                txt = this.game.add.text(0, 0, content, fontStyle, this.sceneProxy.recordLayer);\r\n\r\n                if (FontUtils.fontFamily) {\r\n                    const color = (objText.color ? objText.color : this.json_data.default_settings.color).replace('#', '0x');\r\n                    if (color.indexOf('rgb') !== -1) {\r\n                        const rgb = color.replace('rgb(', '').replace(')', '').split(',');\r\n                        txt.addColor('#' + ('00000' + (parseInt(rgb[0]) << 16 | parseInt(rgb[1]) << 8 | parseInt(rgb[2])).toString(16)).substr(-6), 0);\r\n                    }\r\n                    else {\r\n                        txt.addColor(color, 0);\r\n                    }\r\n\r\n                    const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(txt.fontSize) : txt.fontSize;\r\n                    txt.x = x + (width - 14 * 14 * fw / 25 - 21 - 22 * fw / 25) / 2;\r\n                    txt.y = y + (txt.height - parseInt(txt.fontSize)) / 2;\r\n                    txt.wordWrapWidth = 20 * 13 * fw / 25;\r\n                }\r\n                else {\r\n                    txt.setTextBounds(x, y + (txt.height - parseInt(objText.fontSize)) / 2, width, height);\r\n                }\r\n\r\n                return txt;\r\n            };\r\n\r\n            // 背景\r\n            const bk = this.sceneProxy.recordLayer.create(0, 0, this.game.load.cache.checkImageKey(background.url) && background.url);\r\n            bk.width = this.game.world.width;\r\n            bk.height = this.game.world.height;\r\n            bk.inputEnabled = true;\r\n\r\n            // scrollBox\r\n            const scrollPane = this.game.add.sprite(0,0);\r\n\r\n            const backgroundRect = Object.assign({x: 0, y: 0, width: boxWidth, height: boxHeight}, background.rect);\r\n            const scrollBk = this.sceneProxy.recordLayer.create(boxX + backgroundRect.x,\r\n                boxY + backgroundRect.y,\r\n                this.game.load.cache.checkImageKey(scrollBox.background.url) && scrollBox.background.url);\r\n            scrollBk.width = backgroundRect.width;\r\n            scrollBk.height = backgroundRect.height;\r\n\r\n            const scrollX = boxX + itemsOffsetX;\r\n            const scrollY = boxY + itemsOffsetY;\r\n            scrollPane.x = scrollX;\r\n            scrollPane.y = scrollY;\r\n            scrollPane.name = 'scrollPane';\r\n            this.sceneProxy.recordLayer.add(scrollPane);\r\n            // item  横屏 4列3行  竖屏  1列 12行\r\n            const nRow = flashvars.vertical ? 12 : 3;//Math.ceil(boxHeight / itemHeight);\r\n            const nCol = flashvars.vertical ? 1 : 4;//Math.floor(boxWidth / itemWidth);\r\n            let nLeft = 0;\r\n            let nTop = 0;\r\n            let keyItemBk;\r\n            let ptDown = {x: 0, y: 0};\r\n            const dragBk = this.game.add.sprite(0, 0);\r\n            dragBk.width = (itemWidth + hSpace) * nCol;\r\n            dragBk.height = (itemHeight + vSpace) * nRow;\r\n            scrollPane.addChild(dragBk);\r\n\r\n            let dragStartPointX = 0;\r\n            let dragStartY = null;\r\n            let isSaveOrGet = true;// 是否读档存档\r\n            const onScroll = (x, y) => {\r\n                if((Math.abs(scrollPane.y - dragStartY) > 2 || Math.abs(scrollPane.x - dragStartPointX) > 2) && (dragStartY)){\r\n                    isSaveOrGet = false;\r\n                }\r\n                const scrollHeight = itemHeight * nRow + vSpace * (nRow - 1);\r\n                if (y > scrollY || scrollHeight <= boxHeight) {\r\n                    scrollPane.y = scrollY;\r\n                }\r\n                else if (y + scrollHeight < boxY + boxHeight) {\r\n                    scrollPane.y = boxY + boxHeight - (itemHeight * nRow + vSpace * (nRow - 1));\r\n                }\r\n                else {\r\n                    scrollPane.y = y;\r\n                }\r\n            };\r\n\r\n            const onDragUpdate = (sprite, pointer, x, y, pt, bFromStart) => {\r\n                let px = x;\r\n                let py = y;\r\n                let w = (window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth);\r\n                let h = (window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight);\r\n                if (w < h && dragStartY !== null && !flashvars.vertical) {\r\n                    py = dragStartY - x + dragStartPointX;\r\n                }\r\n                onScroll(px, py);\r\n            };\r\n\r\n            const onDragStart = (sprite, pointer, x, y, pt, bFromStart) => {\r\n                dragStartPointX = x;\r\n                dragStartY = scrollPane.y;\r\n            };\r\n\r\n            const onDragStop = (sprite, pointer, x, y, pt, bFromStart) => {\r\n                dragStartY = scrollPane.y;\r\n            };\r\n\r\n            const getPoint = (pointer) => {\r\n                let x, y;\r\n                let w = (window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth);\r\n                let h = (window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight);\r\n                if (w > h) {\r\n                    if(flashvars.vertical){\r\n                        x = pointer.worldY;\r\n                        y = -pointer.worldX;\r\n                    }else{\r\n                        x = pointer.worldX;\r\n                        y = pointer.worldY;\r\n                    }\r\n                }\r\n                else {\r\n                    if(flashvars.vertical){\r\n                        x = pointer.worldX;\r\n                        y = pointer.worldY;\r\n                    }else{\r\n                        x = pointer.worldY;\r\n                        y = -pointer.worldX;\r\n                    }\r\n                }\r\n                if (y < scrollY || y > /*boxY*/scrollY + boxHeight ||\r\n                    x < scrollX || x > /*boxX*/scrollX + boxWidth) {\r\n                    return null;\r\n                }\r\n                return {x, y}\r\n            };\r\n\r\n            const onInputDown = (sprite, pointer, x, y) => {\r\n                isSaveOrGet = true;\r\n                if (!getPoint(pointer)) {\r\n                    return sprite.input.disableDrag();\r\n                }\r\n                return sprite.input.enableDrag();\r\n            };\r\n\r\n            const onItemUp = (m, pt) => {\r\n                if(isSaveOrGet !== true) return;\r\n                const point = getPoint(pt);\r\n                if (!point || pt.pointerMode === Phaser.PointerMode.CURSOR && pt.button !== 0) {\r\n                    return;\r\n                }\r\n                //防止快速点击，做0.8秒时间间隔\r\n                if(this.clicktime === 0){\r\n                    this.clicktime = this.game.time.now\r\n                }else{\r\n                    if((this.game.time.now - this.clicktime) >= 800){\r\n                        this.clicktime = 0;\r\n                    }else{\r\n                        return\r\n                    }\r\n                }\r\n                ptDown.x = 0;\r\n                ptDown.y = 0;\r\n                const x = point.x - scrollPane.x;\r\n                const y = point.y - scrollPane.y;\r\n                const w = itemWidth + hSpace;\r\n                const h = itemHeight + vSpace;\r\n                if (x % w < itemWidth && y % h < itemHeight) {\r\n                    const iCol = Math.floor(x / w);\r\n                    const iRow = Math.floor(y / h);\r\n                    flashvars.vertical ? this.sceneProxy.onRecordItemClicked(iRow,iCol) : this.sceneProxy.onRecordItemClicked(iCol,iRow);\r\n                    if (!this.sceneProxy.bToSaveFile) {\r\n                        this.callbackInfo = null;\r\n                    }\r\n                }\r\n            };\r\n\r\n            const onMouseWheel = e => {\r\n                const delta = e.wheelDelta ? e.wheelDelta / 120 : -e.detail / 3;\r\n                onScroll(0, scrollPane.y + delta * 100)\r\n            };\r\n\r\n            let wheelEvent = false;\r\n            const onMove = (pointer, x, y) => {\r\n                const point = getPoint(pointer);\r\n                const mousewheelevt = (/Firefox/i.test(navigator.userAgent)) ? \"DOMMouseScroll\" : \"mousewheel\";\r\n                if (!point) {\r\n                    if (wheelEvent) {\r\n                        document.removeEventListener(mousewheelevt, onMouseWheel);\r\n                        wheelEvent = false;\r\n                    }\r\n                }\r\n                else {\r\n                    if (!wheelEvent) {\r\n                        document.addEventListener(mousewheelevt, onMouseWheel);\r\n                        wheelEvent = true;\r\n                    }\r\n                }\r\n            };\r\n\r\n            keyItemBk = this.game.load.cache.checkImageKey(boxItem.background.url) ? boxItem.background.url : null;\r\n\r\n            for (let r = 0; r < nRow; r++) {\r\n                for (let c = 0; c < nCol; c++) {\r\n                    const itemGroup = this.game.add.group();\r\n                    itemGroup.x = c * (itemWidth + hSpace) + itemX;\r\n                    itemGroup.y = r * (itemHeight + vSpace) + itemY;\r\n                    itemGroup.name = `recordItem_${r * nCol + c}`;\r\n                    const item_bk = this.game.add.sprite(nLeft, nTop, keyItemBk);\r\n                    item_bk.width = itemWidth;\r\n                    item_bk.height = itemHeight;\r\n\r\n                    const subItem = this.sceneProxy.recordLayer.create(contentX, contentY, this.game.load.cache.checkImageKey(content.background.url) && content.background.url);\t\t// content\r\n                    subItem.name = 'content';\r\n                    subItem.width = contentWidth;\r\n                    subItem.height = contentHeight;\r\n\r\n                    const txtTime = addTextContent(hintX\r\n                        , hintY\r\n                        , hintWidth\r\n                        , hintHeight\r\n                        , ''\r\n                        , hintText);\r\n                    txtTime.name = 'textTime';\r\n                    const itemMask = this.game.add.graphics(0, 0);\r\n                    itemMask.beginFill();\r\n                    itemMask.drawRect(0, 0, itemWidth, itemHeight);\r\n                    itemMask.endFill();\r\n                    itemGroup.addChild(itemMask);\r\n                    itemGroup.mask = itemMask;\r\n                    itemGroup.add(item_bk);\r\n                    itemGroup.add(subItem);\r\n                    itemGroup.add(txtTime);\r\n\r\n                    if (this.sceneProxy.json_data.default_settings.autoSaveOrLoad && r === 0 && c === 0) {\r\n                        const autoRecord_Bk = this.game.add.bitmapData(itemWidth, itemHeight);\r\n                        autoRecord_Bk.fill(0, 0, 0, 0.4);\r\n                        const autoRecord = this.game.add.sprite(0, 0, autoRecord_Bk);\r\n                        autoRecord.width = itemWidth;\r\n                        autoRecord.height = itemHeight;\r\n                        const fontStyle = {\r\n                            font: '16px Microsoft YaHei',\r\n                            fill: 'white',\r\n                            boundsAlignH: 'center',\r\n                            boundsAlignV: 'middle'\r\n                        };\r\n                        const autoRecord_txt = this.game.add.text(0, 0, '自动存档', fontStyle, this.sceneProxy.coverLayer);\r\n                        autoRecord_txt.setTextBounds(0, (autoRecord_txt.height - 16) / 2, itemWidth, itemHeight);\r\n                        itemGroup.add(autoRecord);\r\n                        itemGroup.add(autoRecord_txt);\r\n                    }\r\n\r\n                    scrollPane.addChild(itemGroup);\r\n                }\r\n            }\r\n            scrollPane.inputEnabled = true;\r\n            scrollPane.input.enableDrag();\r\n            scrollPane.input.allowHorizontalDrag = false;\r\n            scrollPane.events.onDragUpdate.add(onDragUpdate, this);\r\n            scrollPane.events.onDragStart.add(onDragStart, this);\r\n            scrollPane.events.onDragStop.add(onDragStop, this);\r\n            scrollPane.events.onInputUp.add(onItemUp, this);\r\n            scrollPane.events.onInputDown.add(onInputDown, this);\r\n            this.game.input.addMoveCallback(onMove, this);\r\n\r\n            // mask\r\n            const mask = this.game.add.graphics(0, 0);\r\n            mask.beginFill();\r\n            mask.drawRect(scrollPane.x, scrollPane.y, boxWidth - itemsOffsetX, boxHeight - itemsOffsetY);\r\n            mask.endFill();\r\n            this.sceneProxy.recordLayer.add(mask);\r\n            scrollPane.mask = mask;\r\n\r\n            // 返回按钮\r\n            const t = {};\r\n            t.normal = back.normal.text;\r\n            t.active = back.active.text;\r\n            t.text = this.sceneProxy.stringMap.back;\r\n\r\n            const onBtnClicked = (obj, pointer) => {\r\n                if (pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n                    return;\r\n                }\r\n                if ('record_button_back' === obj.parent.name) {\r\n                    this.sceneProxy.onRecordBackBtnClicked();\r\n                    if (this.callbackInfo) {\r\n                        this.callbackInfo.callbackFun(this.callbackInfo.callbackArgs);\r\n                        this.callbackInfo = null;\r\n                    }\r\n                }\r\n                else if ('local_btn' === obj.parent.name) {\r\n                    this.onLocalBtnClicked();\r\n                }\r\n                else if ('cloud_btn' === obj.parent.name) {\r\n                    this.onCloudBtnClicked();\r\n                }\r\n            };\r\n\r\n            if (!back.hidden) {\r\n                const btnGroup = this.viewComponent.addButton(back.rect.x,\r\n                    back.rect.y,\r\n                    back.rect.width,\r\n                    back.rect.height,\r\n                    back.normal.background.url,\r\n                    back.active.background.url,\r\n                    onBtnClicked,\r\n                    t,\r\n                    this.sceneProxy.btn_sound,\r\n                    \"record_button_back\",\r\n                    this.sceneProxy.recordLayer\r\n                );\r\n                btnGroup.button.onInputUp.add(() => this.sceneProxy.btn_sound && this.sceneProxy.btn_sound.stop())\r\n            }\r\n            // 本地--云 按钮\r\n            /*t.text = '';\r\n            if(this.sceneProxy.isShowLocalBtn){\r\n                let localx = this.sceneProxy.viewComponent.game.world.width - 74;\r\n                let localy = 25;\r\n                this.viewComponent.addButton(localx, localy, 68, 68\r\n                    , 'local_hover', null\r\n                    , onBtnClicked\r\n                    , t, null, 'local_btn'\r\n                    , this.sceneProxy.recordLayer\r\n                    , true);\r\n            }\r\n\r\n            if(this.sceneProxy.isShowCloudBtn){ //不存在来源wap或wap=3000 、非推广  没有云存档按钮\r\n                let cloundx = this.sceneProxy.viewComponent.game.world.width - 74;\r\n                let cloundy = 107;\r\n                this.viewComponent.addButton(cloundx, cloundy, 68, 68\r\n                    , 'cloud', null\r\n                    , onBtnClicked\r\n                    , t, null, 'cloud_btn'\r\n                    , this.sceneProxy.recordLayer\r\n                    , true);\r\n            }*/\r\n            this.sceneProxy.recordLayer.visible = false;\r\n        },\r\n\r\n        updateItems: function () {\r\n            this.sceneProxy.savedPlotsData.forEach((data, i) => {\r\n                const setPreviewImage = key => {\r\n                    const bKey = this.game.load.cache.checkImageKey(key) ? key : null;\r\n                    const itemContent = item.getByName('content');\r\n                    const {width, height} = itemContent;\r\n                    itemContent.loadTexture(bKey);\r\n                    itemContent.width = width;\r\n                    itemContent.height = height;\r\n                };\r\n                const {timestamp, plotSnap} = data ? data : {};\r\n                const item = this.sceneProxy.recordLayer.getByName('scrollPane').children.find(c => c.name === `recordItem_${i}`);\r\n                if (!item) {\r\n                    return;\r\n                }\r\n                if (!timestamp) {\r\n                    setPreviewImage(this.sceneProxy.json_data.template.json.record.scrollBox.item.content.background.url);\r\n                    item.getByName('textTime').text = '';\r\n                    return;\r\n                }\r\n                const itemTime = item.getByName('textTime');\r\n                const snapMd5 = MD5.hash(plotSnap);\r\n\r\n                if (!this.game.load.cache.checkImageKey(snapMd5)) {\r\n                    const data = new Image();\r\n                    data.src = plotSnap;\r\n                    data.onload = e => {\r\n                        if (!this.game.load.cache.checkImageKey(snapMd5)) {\r\n                            this.game.cache.addImage(snapMd5, plotSnap, e.target);\r\n                        }\r\n                        setPreviewImage(snapMd5);\r\n                    };\r\n                } else {\r\n                    setPreviewImage(snapMd5);\r\n                }\r\n                const strText = Utils.getCurrentDateTime(timestamp);\r\n                if (FontUtils.fontFamily) {\r\n                    const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(itemTime.fontSize) : itemTime.fontSize;\r\n                    const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(itemTime.fontSize) : itemTime.fontSize;\r\n                    this.sceneProxy.addImageFontText([{data:strText}], fw, fh, itemTime, this.sceneProxy.context);\r\n                    itemTime.text = ' ';\r\n                }\r\n                else {\r\n                    itemTime.text = strText;\r\n                }\r\n            });\r\n        },\r\n\r\n        showRecordLayer: function () {\r\n            //定位到云存档，如果登入状态，直接显示云存档，没登入显示云存档提示\r\n            this.clicktime = 0;\r\n            if (this.sceneProxy.recordLayer.children.length === 0) {\r\n                this.addRecord();\r\n            }\r\n            //本地和云存档按钮存在，同时云和本地存档按钮未点击\r\n            if(this.sceneProxy.isShowCloudBtn && this.sceneProxy.isShowLocalBtn && this.isChangeClick !== true\r\n                || this.isChangeClick !== true && this.sceneProxy.isWapOther()/*第三方来源，定位到云存档*/){\r\n                this.sceneProxy.isSignedIn().then(() => {\r\n                    //登入\r\n                    this.localMode = false;\r\n                    this.isChangeClick = true;\r\n                    const btnLocal = this.sceneProxy.recordLayer.getByName('local_btn');\r\n                    const btnCloud = this.sceneProxy.recordLayer.getByName('cloud_btn');\r\n                    btnLocal && btnLocal.changeBackground('local');\r\n                    btnCloud && btnCloud.changeBackground('cloud_hover');\r\n                    this.sceneProxy.onRecordCloudBtnClicked();\r\n                    return;\r\n                },(rj) =>{\r\n                    //未登入\r\n                    this.updateItems();\r\n                    this.game.world.bringToTop(this.sceneProxy.recordLayer);\r\n                    this.showGuide();\r\n                    this.sceneProxy.recordLayer.visible = true;\r\n                    return;\r\n                })\r\n            }else{\r\n                this.updateItems();\r\n                this.game.world.bringToTop(this.sceneProxy.recordLayer);\r\n                this.showGuide();\r\n                this.sceneProxy.recordLayer.visible = true;\r\n            }\r\n        },\r\n        //显示存档提示\r\n        showGuide:function () {\r\n            if(this.sceneProxy.isShowGuide === true\r\n                && this.sceneProxy.recordLayer.visible !== true\r\n                && !this.sceneProxy.isExtend()\r\n                && !Boolean(flashvars.wap && flashvars.wap === \"zxwwap\")\r\n                && !this.sceneProxy.isWapOther()){\r\n                this.sceneProxy.showGuideTip(1);\r\n            }\r\n        },\r\n        //点击间隔\r\n        clickInterval:function (times) {\r\n            if(this.clickchangetime === 0){\r\n                this.clickchangetime = this.game.time.now;\r\n                return true;\r\n            }else{\r\n                if((this.game.time.now - this.clickchangetime) >= times){\r\n                    this.clickchangetime = 0;\r\n                    return true;\r\n                }else{\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    {\r\n        /**\r\n         * @static\r\n         * @type {string}\r\n         */\r\n        NAME: 'RecordMediator'\r\n        , localMode: true\r\n        , isChangeClick:false //是否已点击切换\r\n        , clicktime:0  //存档点击的间隔时间\r\n        , clickchangetime:0 //存档切换时间间隔\r\n    }\r\n);","/**\r\n * @class demo.view.TextComponentMediator\r\n * @extends puremvc.Mediator\r\n */\r\nimport './CoverMediator.js';\r\nimport './MainMenuMediator.js';\r\nimport './SettingsMediator.js';\r\nimport './PlaybackMediator.js';\r\nimport './RecordMediator.js';\r\nimport './EndMediator.js';\r\nimport  * as TextBox from './HtmlTextBox.js';\r\nimport Dialog from './../../common/Dialog.js';\r\nimport RePhaser from '../../common/RePhaser.js';\r\nimport Utils, {ResourcesManager} from '../../common/Utils.js';\r\nimport PhoneUtils from '../../common/PhoneUtils.js';\r\nimport FontUtils from '../../common/FontUtils.js';\r\nimport OtherWap from '../../common/OtherWap.js';\r\nimport Copy from 'copy-to-clipboard';\r\n\r\nimport puremvc from 'puremvc';\r\n\r\npuremvc.define\r\n(\r\n\t// CLASS INFO\r\n\t{\r\n\t\tname: 'diygamePlayer.view.mediator.SceneMediator',\r\n\t\tparent: puremvc.Mediator\r\n\t},\r\n\r\n\t// INSTANCE MEMBERS\r\n\t{\r\n\t\t/** @override */\r\n\t\tlistNotificationInterests: function ()\r\n\t\t{\r\n\t\t\treturn [\r\n\t\t\t\tdiygamePlayer.AppConstants.SCENE_SHOW_AD,\r\n\t\t\t\tdiygamePlayer.AppConstants.SCENE_PRELOADING_BEGIN,\r\n\t\t\t\tdiygamePlayer.AppConstants.SCENE_PRELOADING_PROGRESS,\r\n\t\t\t\tdiygamePlayer.AppConstants.SCENE_PRELOADING_COMPLETE,\r\n\t\t\t\tdiygamePlayer.AppConstants.SCENE_LOADING_BEGIN,\r\n\t\t\t\tdiygamePlayer.AppConstants.SCENE_LOADING_PROGRESS,\r\n\t\t\t\tdiygamePlayer.AppConstants.SCENE_LOADING_COMPLETE,\r\n\t\t\t\tdiygamePlayer.AppConstants.SCENE_SHOW_LOGO,\r\n                diygamePlayer.AppConstants.SCENE_PLOT_LOAD_ASSETS_READY,\r\n                diygamePlayer.AppConstants.SCENE_PLOT_LOAD_ASSETS_LOADED,\r\n\t\t\t\tdiygamePlayer.AppConstants.SCENE_DESTROY_VIEW,\r\n                diygamePlayer.AppConstants.SCENE_SHOW_GUIDE,\r\n\t\t\t\tdiygamePlayer.AppConstants.SCENE_SHOW_INPUT_VIEW\r\n\t\t\t\t\t]\r\n\t\t},\r\n\r\n\t\t/** @override */\r\n\t\thandleNotification: function (note)\r\n\t\t{\r\n\t\t\tconst body = note.getBody();\r\n\t\t\tswitch ( note.getName() )\r\n\t\t\t{\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_SHOW_AD:\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_PRELOADING_BEGIN:\r\n\t\t\t\t\tthis.sceneProxy.viewComponent = this.viewComponent;\r\n\t\t\t\t\tthis.sceneProxy.space_key = this.viewComponent.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);\r\n\t\t\t\t\tconst z_key = this.viewComponent.game.input.keyboard.addKey(Phaser.Keyboard.Z);\r\n\t\t\t\t\tz_key.onDown.add(() => this.sceneProxy.quickPlay = true);\r\n\t\t\t\t\tz_key.onUp.add(() => this.sceneProxy.quickPlay = false);\r\n\r\n\t\t\t\t\tthis.viewComponent.game.input.onHold.add(() => {\r\n\t\t\t\t\t\tthis.screenCaptured();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.viewComponent.game.input.onUp.add(() => {\r\n\t\t\t\t\t\tthis.screenReleased();\r\n\t\t\t\t\t});\r\n\r\n                    // 创建各个层\r\n\t\t\t\t\tthis.generateLayers();\r\n\t\t\t\t\t// 设置允许跨域\r\n\t\t\t\t\tthis.viewComponent.game.load.crossOrigin = 'anonymous';\r\n\t\t\t\t\t// 加载json\r\n\t\t\t\t\tthis.viewComponent.preLoad()\r\n\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t//Utils.getSensitiveWords();\r\n                            this.addToastLayer();\r\n                            this.addLoadingToastLayer();\r\n                            return this.viewComponent.getGameJson(this.sceneProxy.isWapOther())\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.then(game => {\r\n\t\t\t\t\t\t\tif (Object.keys(game).length === 0) {\r\n\t\t\t\t\t\t\t\treturn Promise.reject(\"链接已过期\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis.viewComponent.addLog('解析剧情配置...');\r\n\t\t\t\t\t\t\t//this.viewComponent.showLoading();//离线去除 loading 动画\r\n                            this.viewComponent.showOfflineBg();\r\n\t\t\t\t\t\t\treturn this.sceneProxy.parseJsonFile(game).then(() => {\r\n\t\t\t\t\t\t\t\tthis.viewComponent.addLog('解析剧情配置..【成功】', true);\r\n\r\n\t\t\t\t\t\t\t\treturn new Promise((resolve, reject) => {\r\n                                    const offlinebg = this.viewComponent.game.world.getByName('offlinebg');\r\n                                    if (offlinebg && 'Operation_tip' === offlinebg.key) {\r\n                                        const onClick = (obj, pointer) => {\r\n                                            if (pointer && pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n                                                return;\r\n                                            }\r\n                                            offlinebg.events.onInputDown.remove(onClick);\r\n                                            const imgContinue = this.viewComponent.game.world.getByName('Continue');\r\n                                            imgContinue && imgContinue.destroy();\r\n                                            Utils.localStorageSetItem('shanyi3000opg', 'showed');\r\n                                            return resolve();\r\n                                        }\r\n                                        if (this.viewComponent.game.cache.checkImageKey('Continue')) {\r\n                                            const cimg = this.viewComponent.game.add.image(0, 0, 'Continue');\r\n                                            cimg.name = 'Continue';\r\n                                            cimg.x = (this.viewComponent.game.world.width - cimg.width) / 2;\r\n                                            cimg.y = flashvars.vertical ? ((this.viewComponent.game.world.height - cimg.height) / 2) : (this.viewComponent.game.world.height - 30);\r\n                                        }\r\n                                        offlinebg.events.onInputDown.addOnce(onClick);\r\n                                    }\r\n                                    else {\r\n                                        return resolve();\r\n                                    }\r\n                                });\r\n\t\t\t\t\t\t\t}, e => {\r\n\t\t\t\t\t\t\t\tthis.viewComponent.addLog('剧情配置解析错误:' + e);\r\n\t\t\t\t\t\t\t\treturn Promise.reject(e || \"解析Json错误\")\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t})\r\n                        .then(() => {\r\n\t\t\t\t\t\t\t\tthis.sceneProxy.updateAccInfo(false,true);\r\n                                //Utils.sendStatistics();\r\n                                //Utils.uploadLocalStorage().then(r => Utils.downloadLocalStorage());\r\n                            }, e => {\r\n\t\t\t\t\t\t\t\treturn Promise.reject(e)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t.then(() => null, e => {\r\n\t\t\t\t\t\t\tif (flashvars.client && flashvars.client !== '') {\r\n\t\t\t\t\t\t\t\tDialog.warn(e + '关闭播放器吗？').then(() =>{window.location.href = 'lzj3000://quit'}, () => null)\r\n\t\t\t\t\t\t\t} else {\r\n                                Dialog.warn(e + \"，返回闪艺首页吗？\").then(() => window.location.href = \"http:\\\\\\\\www.3000.com\", () => null)\r\n                            }\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_PRELOADING_PROGRESS:\r\n\t\t\t\t\t// 启动资源加载\r\n\t\t\t\t\tthis.assetsLoaderStart(diygamePlayer.AppConstants.SCENE_PRELOADING_COMPLETE);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_PRELOADING_COMPLETE:\r\n\t\t\t\t\tthis.viewComponent.destroyLogo();\r\n\t\t\t\t\tconst game = this.sceneProxy.json_data;\r\n\t\t\t\t\tthis.sceneProxy.initContext();\r\n\t\t\t\t\tthis.sceneProxy.updateAccInfo();\r\n\t\t\t\t\tconst {sound} = this.sceneProxy.json_data.template.json;\r\n                    const offlinebg = this.viewComponent.game.world.getByName('offlinebg');\r\n                    const imgContinue = this.viewComponent.game.world.getByName('Continue');\r\n                    offlinebg && offlinebg.destroy();\r\n                    imgContinue && imgContinue.destroy();\r\n                    if (this.viewComponent.game.load.cache.checkSoundKey(sound.url)) {\r\n\t\t\t\t\t\tthis.sceneProxy.btn_sound = this.viewComponent.game.add.sound(sound.url, sound.volume);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//显示引导层\r\n                    //this.showGuideTip(0).then(() =>{\r\n                        if (game.logo && !game.logo.background.hidden) {\r\n                            this.sceneProxy.showLogo();// 创建Logo\r\n                        }\r\n                        else if (!game.cover.hidden) {\r\n                            this.sceneProxy.showCover();// 创建封面\r\n                        }\r\n                        else {\r\n                            let chapter = this.sceneProxy.findFirstChapter();\r\n                            const chapterUuid = chapter.downloadUuid ? chapter.downloadUuid : chapter.uuid;\r\n                            if (chapter.md5 && chapter.plots.length === 0) {\r\n                                //第三方\r\n                                if(this.sceneProxy.isWapOther()){\r\n                                    const otherback = (plots)=>{\r\n                                        if(plots === null){\r\n                                            Dialog.error('获取付费章节信息失败');\r\n                                        }else if(plots === \"fail\"){\r\n                                            //查询失败\r\n                                            Dialog.custom(\"Error\",\"仍未查询到您的支付信息哦，请确认已经支付~ 如有疑问请添加闪艺客服QQ：819786897 ~\",\"提示\",\"复制QQ\",\"取消\",false).then(()=>{\r\n                                                Copy(\"819786897\",{\r\n                                                    debug: false,\r\n                                                    message: '复制成功',\r\n                                                })\r\n                                            },()=>{\r\n                                            })\r\n                                        }else{\r\n                                            chapter.plots = plots ? plots : [];\r\n                                            this.sceneProxy.preloadChapterAssets(this.sceneProxy.context, chapter);\r\n                                        }\r\n                                    }\r\n                                    this.sceneProxy.unlockChapterByWapOther(chapterUuid,chapter.charge,chapter.md5,otherback);\r\n                                    return;\r\n                                }\r\n                                if (chapter.charge && ('android' === flashvars.client || 'ios' === flashvars.client || flashvars.client === 'wap')) {\r\n                                    const unlockFinish = (bSuccess) => {\r\n                                        if (bSuccess) {\r\n                                            this.sceneProxy.checkIfChapterFree(chapterUuid, chapter.md5).then((plots)=>{\r\n                                                this.sceneProxy.unlockChapterCallBack = null;\r\n                                                chapter.plots.push(...plots);\r\n                                                this.sceneProxy.preloadChapterAssets(this.sceneProxy.context, chapter);\r\n                                            }, () => {\r\n                                                if(flashvars.client === 'wap'){\r\n                                                    window.parent && window.parent.playLogin();\r\n                                                }else{\r\n                                                    Dialog.error('获取付费章节信息失败');\r\n                                                }\r\n                                            })\r\n                                        } else {\r\n                                            Dialog.error('章节解锁失败');\r\n                                        }\r\n                                    };\r\n\r\n                                    this.sceneProxy.unlockChapter(chapterUuid, chapter.charge, chapter.md5, unlockFinish);\r\n                                } else {\r\n                                    this.sceneProxy.checkIfChapterFree(chapterUuid, chapter.md5).then((plots)=>{\r\n                                        chapter.plots.push(...plots);\r\n                                        this.sceneProxy.preloadChapterAssets(this.sceneProxy.context, chapter);\r\n                                    }, (msg)=>{\r\n                                        if (-1 === msg.indexOf('code=87')) {\r\n                                            Dialog.error(msg);\r\n                                        } else { // 未购买此章节\r\n                                            if(flashvars.wap === 'zxwwap'){\r\n                                                Dialog.info('当前为收费章节，是否前往闪艺抢先体验？').then(()=>{\r\n                                                    window.location.href = 'https://wap.3000.com/?m=detail&op=index&ac=index&id='+ flashvars.gid;\r\n                                                })\r\n                                            }else{\r\n                                                Dialog.info('当前为收费章节，请前往闪艺app或电脑端进行购买');\r\n                                            }\r\n                                        }\r\n                                    })\r\n                                }\r\n                            }\r\n                            else {// 播放剧情\r\n                                this.sceneProxy.preloadChapterAssets(this.sceneProxy.context, chapter);\r\n                            }\r\n                        }\r\n                    //})\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_LOADING_BEGIN:\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_LOADING_PROGRESS:\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_LOADING_COMPLETE:\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_SHOW_LOGO:\r\n\t\t\t\t\tthis.showLogo();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_PLOT_LOAD_ASSETS_READY:\r\n\t\t\t\t\tthis.assetsLoaderStart(diygamePlayer.AppConstants.SCENE_PLOT_LOAD_ASSETS_LOADED, body);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_PLOT_LOAD_ASSETS_LOADED:\r\n                    this.addMenuLayer(!!this.sceneProxy.json_data.template.json.shanyiMenu);\r\n\t\t\t\t\tthis.showPlot(body.context, this.sceneProxy.curChapter, this.sceneProxy.curPlotIndex, this.sceneProxy.cmdPlotSnap, body.loadData);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_DESTROY_VIEW:\r\n\t\t\t\t\tthis.destroyView(body.name, body.isMainMenu);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_SHOW_GUIDE:\r\n\t\t\t\t\tthis.showGuideTip(body.id);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_SHOW_INPUT_VIEW:\r\n\t\t\t\t\tthis.showInputView(this.sceneProxy.plotViewsLayer, !!body);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tgenerateLayers: function () {\r\n            this.sceneProxy.coverLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.coverLayer.name = 'coverLayer';\r\n            this.sceneProxy.progressLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.progressLayer.name = 'progressLayer';\r\n            this.sceneProxy.dialogLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.dialogLayer.name = 'dialogLayer';\r\n            this.sceneProxy.dialogLayer.animateTweens = [];\r\n            this.sceneProxy.menuLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.menuLayer.name = 'menuLayer';\r\n            this.sceneProxy.mainMenuLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.mainMenuLayer.name = 'mainMenuLayer';\r\n            this.sceneProxy.mainMenuLayer.visible = false;\r\n            this.sceneProxy.settingsLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.settingsLayer.name = 'settingsLayer';\r\n            this.sceneProxy.settingsLayer.visible = false;\r\n            this.sceneProxy.recordLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.recordLayer.name = 'recordLayer';\r\n            this.sceneProxy.recordLayer.visible = false;\r\n            this.sceneProxy.playBackLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.playBackLayer.name = 'playBackLayer';\r\n            this.sceneProxy.playBackLayer.visible = false;\r\n            this.sceneProxy.weatherLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.weatherLayer.name = 'weatherLayer';\r\n            this.sceneProxy.plotViewsLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.plotViewsLayer.name = 'plotViewsLayer';\r\n            this.sceneProxy.endLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.endLayer.name = 'endLayer';\r\n            this.sceneProxy.toastLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.toastLayer.name = 'toastLayer';\r\n            this.sceneProxy.loadingToastLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.loadingToastLayer.name = 'loadToastLayer';\r\n            this.sceneProxy.quickPlayLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.quickPlayLayer.name = 'quickPlayLayer';\r\n            this.sceneProxy.guideLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.guideLayer.name = 'guideLayer';\r\n            this.sceneProxy.bubbleLayer = this.viewComponent.game.add.group(); //气泡层\r\n            this.sceneProxy.bubbleLayer.name = 'bubbleLayer';\r\n            this.sceneProxy.bubbleLayer.animateTweens = [];\r\n        },\r\n\r\n\t\tscreenCaptured: function () {\r\n\t\t\tif (!this.sceneProxy.isGameStarted) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n            if(this.sceneProxy.isQuickPlay !== true){\r\n\t\t\t    return;\r\n            }\r\n            if (this.sceneProxy.quickPlayLayer.children.length === 0) {\r\n                const bk = this.sceneProxy.quickPlayLayer.create(0, 0, 'app_button_speed');\r\n                const icon = this.sceneProxy.quickPlayLayer.create(0, 0, 'app_icon_speed');\r\n                const f1 = {font: '25px PingFang-SC-Regular', fill: '#333333'};\r\n                const t1 = this.viewComponent.game.add.text(0, 0, '快进中...', f1, this.sceneProxy.quickPlayLayer);\r\n                const f2 = {font: '20px PingFang-SC-Regular', fill: '#aaadb3'};\r\n                const t2 = this.viewComponent.game.add.text(0, 0, '松开手指恢复播放', f2, this.sceneProxy.quickPlayLayer);\r\n\r\n                bk.x = (this.viewComponent.game.world.width - bk.width) / 2;\r\n                bk.y = (this.viewComponent.game.world.height - bk.height) / 2;\r\n                icon.x = bk.x + 90;\r\n                icon.y = bk.y + 25;\r\n                t1.x = icon.x - 10;\r\n                t1.y = icon.y + icon.height + 14;\r\n                t2.x = bk.x + 39;\r\n                t2.y = t1.y + 33;\r\n            }\r\n\r\n            this.sceneProxy.isScreenHold = true;\r\n\t\t\tthis.sceneProxy.quickPlay = true;\r\n\t\t\tthis.sceneProxy.removePlotTweens();\r\n\r\n            const quickPlayHandler = () => {\r\n                const sceneProxy = this.sceneProxy;\r\n                const game = this.viewComponent.game;\r\n                return function () {\r\n                    const hasView = sceneProxy.plotViewsLayer.children.length > 0;\r\n                    const hasBubble = sceneProxy.bubbleLayer.children.length > 0;\r\n                    if ((!hasView || !hasBubble) && sceneProxy.playPause !== true) { //没有高级界面,没有气泡，同时不处于暂停状态\r\n                        let pointer = new Phaser.Pointer(game, 1, Phaser.PointerMode.CURSOR);\r\n                        pointer.button = 0;\r\n                        sceneProxy.curPlotLayer.onChildInputDown.dispatch('quickPlayHandler', pointer);\r\n                    }\r\n\r\n                    if (sceneProxy.isScreenHold) {\r\n                        setTimeout(quickPlayHandler(), 500);\r\n                    }\r\n                }\r\n            };\r\n            setTimeout(quickPlayHandler(), 20);\r\n\r\n            this.sceneProxy.quickPlayLayer.alpha = 1;\r\n\t\t\tthis.viewComponent.game.world.bringToTop(this.sceneProxy.quickPlayLayer);\r\n        },\r\n\t\tscreenReleased: function () {\r\n\t\t\tif (this.sceneProxy.isScreenHold) {\r\n\t\t\t\tthis.sceneProxy.isScreenHold = false;\r\n\t\t\t\tthis.sceneProxy.quickPlay = false;\r\n\r\n                this.sceneProxy.quickPlayLayer.alpha = 0;\r\n                //this.viewComponent.game.add.tween(this.sceneProxy.quickPlayLayer).from({alpha: 1}, 800, null, true).name = 'toast';\r\n\t\t\t}\r\n        },\r\n\r\n        cmdPlotLoadResources: function(context, chapter, nPlot, cmdInfo, index) {\r\n            const load = this.viewComponent.game.load;\r\n            const cache = load.cache;\r\n            const cmd = cmdInfo.commands[index];\r\n            const resources = ResourcesManager.getCommandResources(cmd);\r\n            const usePhoneUtils = 'ios' === flashvars.client && flashvars.app_version >= '1.5.0';\r\n            let needLoadNum = 0;\r\n            let loadingAssets = [];\r\n\r\n            resources.forEach(({ type, url }) => {\r\n                if (!url) {\r\n                    return;\r\n                }\r\n                if (type === 'audio' && usePhoneUtils) {\r\n                    !PhoneUtils.isAudioInCache(url) && (needLoadNum++);\r\n                    return;\r\n                }\r\n                let exist = type === 'img' ? cache.checkImageKey(url) : cache.checkSoundKey(url);\r\n                if (!exist) {\r\n                    needLoadNum++;\r\n                    exist = load.getAsset('img' === type ? 'image' : 'audio', url)\r\n                    if (exist) {\r\n                        loadingAssets.push({ type, key:url });\r\n                    }\r\n                }\r\n            });\r\n\r\n            let countCmd = 0;\r\n            const newResources = [];\r\n            const getInCommands = commands => {\r\n                for (let i = 0; i < commands.length && countCmd < 5; i++) {\r\n                    const cmd = commands[i];\r\n                    const res = ResourcesManager.getCommandResources(cmd);\r\n                    if (res.length) {\r\n                        newResources.push(...res);\r\n                        countCmd++;\r\n                    }\r\n\r\n                    if ((cmd.type === 'options' || cmd.type === 'conditionOptions')) {\r\n                        for (let j = 0; j < cmd.args.length && countCmd < 5; j++) {\r\n                            getInCommands(cmd.args[j].commands);\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n            ResourcesManager.clearPreCmdResources(cmdInfo.commands, index);\r\n            if (needLoadNum !== loadingAssets.length) {\r\n                return this.sceneProxy.preloadCommandsAssets(context, chapter, nPlot, cmdInfo, index).then(needLoadList => this.assetsLoader(needLoadList, true, true));\r\n            } else if (needLoadNum) {\r\n                getInCommands(cmdInfo.commands.slice(index));         \r\n                loadingAssets = newResources.filter(({ type, url }) => load.getAsset('img' === type ? 'image' : 'audio', url)).map(a => Object.assign(a, { key: a.url }));\r\n                return this.assetsLoader(loadingAssets, true);\r\n            }\r\n            return Promise.resolve();\r\n        },\r\n\r\n        //引导层\r\n        showGuideTip:function (showtype) {\r\n\t\t\treturn new Promise((resolve,reject) =>{\r\n                if('android' !== flashvars.client && 'ios' !== flashvars.client){\r\n                    //非移动端 无需引导图\r\n                    this.sceneProxy.guideLayer.visible = false;\r\n                    return resolve();\r\n                }\r\n                const show=(type) =>{\r\n                    if(this.sceneProxy.isShowGuide === true){\r\n                        let CloudImg = this.sceneProxy.guideLayer.getByName(\"Cloud_record_tip\");\r\n                        if(this.sceneProxy.guideLayer.children.length <= 0){\r\n                            this.sceneProxy.guideLayer.inputEnableChildren = true;\r\n                            this.sceneProxy.guideLayer.inputEnabled = true;\r\n                            if(!this.viewComponent.game.load.cache.checkImageKey(\"Cloud_record_tip\") && type === 1){\r\n                                //图片不存在时  不显示引导\r\n                                return resolve();\r\n                            }\r\n                            CloudImg = this.sceneProxy.guideLayer.create(this.viewComponent.game.world.width / 2, this.viewComponent.game.world.height / 2,\"Cloud_record_tip\");\r\n                            CloudImg.name = 'Cloud_record_tip';\r\n                            CloudImg.anchor.setTo(0.5, 0.5);\r\n                            CloudImg.visible =false;\r\n                        }\r\n\r\n                        this.sceneProxy.guideLayer.alpha = 1;\r\n                        this.sceneProxy.guideLayer.visible = true;\r\n                        CloudImg.visible = type === 0 ? false : true;\r\n                        this.viewComponent.game.world.bringToTop(this.sceneProxy.guideLayer);\r\n                        const onClick = (obj, pointer) => {\r\n                            if (pointer && pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n                                return;\r\n                            }\r\n                            this.sceneProxy.guideLayer.onChildInputDown.remove(onClick)\r\n                            this.tweenToPromise(\r\n                                this.sceneProxy.guideLayer,\r\n                                {alpha:0},\r\n                                1000, null, true, 0, 0, false)\r\n                                .then(() =>{\r\n                                    this.sceneProxy.guideLayer.visible = false;\r\n                                    this.sceneProxy.guideLayer.alpha = 0;\r\n                                    if(type !==0 ) this.sceneProxy.isShowGuide = false;\r\n                                    Utils.localStorageSetItem(uuid, JSON.stringify({count:this.sceneProxy.recordTipCount}));\r\n                                    return resolve();\r\n                                })\r\n                        };\r\n                        this.sceneProxy.guideLayer.onChildInputDown.add(onClick);\r\n                    }\r\n                };\r\n\r\n\t\t\t\tconst uuid = \"shanyi3000guide\";//\"guide\" + flashvars.uuid;\r\n\t\t\t\tconst guidedata = JSON.parse(Utils.localStorageGetItem(uuid));\r\n\t\t\t\tif(guidedata !== null && guidedata !== undefined ){\r\n\t\t\t\t\t//存档有值\r\n\t\t\t\t\tthis.sceneProxy.recordTipCount = guidedata.count;\r\n                    if(showtype === 1){\r\n                            //超过10次 无须引导\r\n\t\t\t\t\t\tif(this.sceneProxy.recordTipCount >= 10){\r\n\t\t\t\t\t\t\tthis.sceneProxy.isShowGuide = false;\r\n                            this.sceneProxy.guideLayer.visible = false;\r\n\t\t\t\t\t\t\treturn resolve();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.sceneProxy.recordTipCount ++;\r\n                        show(showtype);\r\n\t\t\t\t\t} else if(showtype === 0){\r\n                    \tthis.sceneProxy.guideLayer.visible = false;\r\n                        return resolve();\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\t//没有存档值，显示0引导图\r\n                    this.sceneProxy.isShowGuide = true;\r\n                    show(showtype);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n        },\r\n\r\n\t\taddLoadingToastLayer: function () {\r\n\t\t\tif (this.sceneProxy.loadingToastLayer.children.length === 0) {\r\n                let g = this.viewComponent.game.add.group();\r\n                this.sceneProxy.loadingToastLayer.add(g);\r\n\r\n                let bk = this.viewComponent.game.add.graphics(/*350*/0, /*252*/0, g);\r\n                bk.beginFill(0x3dc4cc);\r\n                bk.drawRect(0, 0, 135, 36);\r\n                bk.endFill();\r\n\r\n                const tl = g.create(8, 9, 'toast_loading');\r\n                this.viewComponent.addGifAnimation(tl, 'toast_loading');\r\n\r\n                const fontStyle = {font: '16px 微软雅黑', fill: '#ffffff'};\r\n                let toastText = this.viewComponent.game.add.text(/*380*/33, /*260*/8, '保存档案中~', fontStyle, g);\r\n                toastText.name = 'toastText';\r\n                g.x = (this.viewComponent.game.world.width - toastText.width) / 2;\r\n                g.y = flashvars.vertical ? 100 : 252;\r\n                g.alpha = 0.8;\r\n                this.sceneProxy.loadingToastLayer.visible = false;\r\n            }\r\n        },\r\n\r\n\t\taddToastLayer: function () {\r\n\t\t\tif (this.sceneProxy.toastLayer.children.length === 0) {\r\n\t\t\t\tlet typeSuccess = this.viewComponent.game.add.group();\r\n\t\t\t\tlet typeError = this.viewComponent.game.add.group();\r\n\t\t\t\ttypeSuccess.name = 'typeSuccess';\r\n\t\t\t\ttypeError.name = 'typeError';\r\n\t\t\t\tthis.sceneProxy.toastLayer.add(typeSuccess);\r\n\t\t\t\tthis.sceneProxy.toastLayer.add(typeError);\r\n\r\n\t\t\t\tlet bk1 = this.viewComponent.game.add.graphics(/*320*/0, /*252*/0, typeSuccess);\r\n                let bk2 = this.viewComponent.game.add.graphics(/*350*/0, /*252*/0, typeError);\r\n                bk1.beginFill(0x3dc4cc);\r\n                bk1.drawRect(0, 0, 320, 36);\r\n                bk1.endFill();\r\n                bk2.beginFill(0x3dc4cc);\r\n                bk2.drawRect(0, 0, 260, 36);\r\n                bk2.endFill();\r\n\r\n\t\t\t\ttypeSuccess.create(/*330*/10, /*262*/10, 'icon_success');\r\n\t\t\t\ttypeError.create(/*360*/10, /*262*/10, 'icon_error');\r\n\r\n                const fontStyle = {font: '16px 微软雅黑', fill: '#ffffff'};\r\n                let toastText = this.viewComponent.game.add.text(/*350*/30, /*260*/8, '存档成功，下次可以从这里读档继续哦~', fontStyle, typeSuccess);\r\n                toastText.name = 'toastText';\r\n\r\n                toastText = this.viewComponent.game.add.text(/*380*/30, /*260*/8, '存档失败，请检查您的网络哦~', fontStyle, typeError);\r\n                toastText.name = 'toastText';\r\n\r\n                typeSuccess.visible = false;\r\n                typeError.visible = false;\r\n                this.sceneProxy.toastLayer.alpha = 0;\r\n            }\r\n        },\r\n\r\n\t\tassetsLoaderStart: function (nextNotifier, body) {\r\n\t\t\tconst { needLoadList=[] } = body || {};\r\n\t\t\treturn this.assetsLoader(needLoadList, !!body).then(() => this.sceneProxy.sendNotification(nextNotifier, body));\r\n\t\t},\r\n\r\n\t\tassetsLoader: function (assets = [], isChapter=true, show=true) {\r\n\t\t\tconst context = Object.create(null);\r\n\t\t\tconst decodingAudios = [];\r\n\t\t\tconst { game } = this.viewComponent;\r\n            let loadedFileCount = 0;\r\n            const { load, sound, cache } = game;\r\n            const canUsePhoneAudioLoad = 'ios' === flashvars.client && '1.5.0' <= flashvars.app_version;\r\n            assets = assets.filter(({type, key}) => {\r\n                if ('img' === type) {\r\n                    return !cache.checkImageKey(key) && load.getAsset('image', key);\r\n                } else if ('audio' === type) {\r\n                    return canUsePhoneAudioLoad\r\n                        ? !PhoneUtils.isAudioInCache(key) && PhoneUtils.isLoadingAudio(key)\r\n                        : !cache.checkSoundKey(key) && load.getAsset('audio', key);\r\n                }\r\n            });\r\n            let covermusickey = '';\r\n            if(!isChapter && this.sceneProxy.json_data.cover.music && this.sceneProxy.json_data.cover.music.url && canUsePhoneAudioLoad && flashvars.offline === ''){\r\n                covermusickey = this.sceneProxy.json_data.cover.music.url;\r\n                if(!PhoneUtils.isAudioInCache(covermusickey) && !PhoneUtils.isAudioError(covermusickey)){ //没在缓存中 也没有加载出错\r\n                    load._totalFileCount +=1;\r\n                }else{\r\n                    covermusickey = '';\r\n                }\r\n            }\r\n            let totalFileCount = isChapter ? assets.length : load._totalFileCount;\r\n\t\t\tlet isLoadComplete = false;\r\n            if (!totalFileCount) {\r\n                return Promise.resolve();\r\n            }\r\n            \r\n\t\t\treturn new Promise((resolve, reject) => {\r\n                let covermusiccomplete = covermusickey === '';\r\n                const updateLoadedCount = (key) => {\r\n                    if (assets.length) {\r\n                        assets.forEach(asset =>{//遍历数组中相同key  loaded = true\r\n                            if(asset.key === key){\r\n                                if (asset && !asset.loaded) {\r\n                                    asset.loaded = true;\r\n                                    loadedFileCount++;\r\n                                }\r\n                            }\r\n                        })\r\n                        /*const asset = assets.find(a => a.key === key);\r\n                        if (asset && !asset.loaded) {\r\n                            asset.loaded = true;\r\n                            loadedFileCount++;\r\n                        }*/\r\n                    } else {\r\n                        loadedFileCount++;\r\n                    }\r\n                };\r\n\t\t\t\tconst checkFinished = () => {\r\n\t\t\t\t\tconst hasAudioLoadFinish = canUsePhoneAudioLoad \r\n\t\t\t\t\t\t? ((covermusickey !== ''&& !isChapter) ? covermusiccomplete : assets.every(a => a.loaded))/*? assets.every(a => a.loaded)*/\r\n\t\t\t\t\t\t: decodingAudios.every(sound => sound.decoded);\r\n                    if (isLoadComplete && hasAudioLoadFinish) {\r\n                    \tPhoneUtils.audioCountLoadByPhone.total = 0;\r\n                    \tPhoneUtils.audioCountLoadByPhone.loaded = 0;\r\n                    \tsound.onSoundDecode.removeAll(context);\r\n                    \tsound.onSoundDecodeError.removeAll(context);\r\n                        load.onSoundExtendLoad.removeAll(context);\r\n                        load.onSoundExtendLoadError.removeAll(context);\r\n                    \tthis.sceneProxy.progressLayer.visible = false;\r\n                    \tresolve();\r\n                    }\r\n                    load.onFileComplete.removeAll(context);\r\n\t\t\t\t};\r\n                const handleSoundExtendLoad = (key) => {\r\n                    if(covermusickey !== '' && !isChapter){\r\n                        if(key === covermusickey){\r\n                            covermusiccomplete = true\r\n                        }else{\r\n                            return;\r\n                        }\r\n                    }\r\n                    if (assets.every(a => a.loaded) && isLoadComplete === true && covermusickey === '') {\r\n                        return;\r\n                    }\r\n                    updateLoadedCount(key);\r\n                    const progress = parseInt(100 * loadedFileCount / totalFileCount);\r\n                    show && this.showProgress(progress, loadedFileCount, totalFileCount, isChapter);\r\n                    assets.every(a => a.loaded) && (isLoadComplete = true) && checkFinished();\r\n                };\r\n\t\t\t\tconst handleSoundDecodeError = (key) => {\r\n\t\t\t\t\tlet index = -1;\r\n\t\t\t\t\tconst sound = cache.getSound(key);\r\n\t\t\t\t\tif ((index = decodingAudios.findIndex(s => s === sound)) !== -1) {\r\n\t\t\t\t\t\tdecodingAudios.splice(index, 1);\r\n\t\t\t\t\t\tcache.removeSound(key);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcheckFinished();\r\n\t\t\t\t};\r\n\t\t\t\tsound.onSoundDecode.add(() => checkFinished(), context);\r\n\t\t\t\tsound.onSoundDecodeError.add(handleSoundDecodeError, context);\r\n                load.onSoundExtendLoad.add(handleSoundExtendLoad, context);\r\n                load.onSoundExtendLoadError.add(handleSoundExtendLoad, context);\r\n\r\n\t\t\t\tload.onFileComplete.add((progress, cacheKey, success, totalLoaded, totalFiles) => {\r\n\t\t\t\t\tupdateLoadedCount(cacheKey);\r\n\r\n\t\t\t\t\tprogress = parseInt(100 * loadedFileCount / totalFileCount);\r\n\t\t\t\t\tshow && this.showProgress(progress, loadedFileCount, totalFileCount, isChapter);\r\n\r\n\t\t\t\t\tif(cache.checkKey(Phaser.Cache.SOUND, cacheKey)){\r\n\t\t\t\t\t\tconst sound = cache.getSound(cacheKey);\r\n\t\t\t\t\t\tif (sound && sound.autoDecode && sound.isDecoding  && !sound.decoded) {\r\n\t\t\t\t\t\t\tdecodingAudios.push(sound);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (assets.length && assets.every(a => a.loaded)) {\r\n\t\t\t\t\t\tisLoadComplete = true;\r\n\t\t\t\t\t\tcheckFinished();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, context, 0);\r\n\t\t\t\tload.onLoadComplete.addOnce(function() {\r\n\t\t\t\t\tif(!isLoadComplete){\r\n\t\t\t\t\t\tisLoadComplete = true;\r\n\t\t\t\t\t\tcheckFinished();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, context, 0);\r\n                \r\n                totalFileCount && this.showProgress(0, 0, 0, isChapter);\r\n\t\t\t\tload.start();\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tshowLogo: function () {\r\n\t\t\tconst {json_data, context} = this.sceneProxy;\r\n\t\t\tconst {logo, chapters, cover} = json_data;\r\n\t\t\tif (!logo || !logo.background || logo.background.hidden || !this.viewComponent.game.load.cache.checkImageKey(logo.background.url)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst {flex, opacity} = logo.background;\r\n            this.sceneProxy.prePlotBkKey = this.sceneProxy.lstPlotBkKey;\r\n            this.sceneProxy.lstPlotBkKey = logo.background.url;\r\n            this.sceneProxy.lstPlotBkOpacity = logo.background.opacity;\r\n            this.sceneProxy.lstPlotBkFlex = flex;\r\n\t\t\tconst game_logo = this.viewComponent.game.add.image(0, 0, logo.background.url);\r\n\t\t\tthis.backgroundFlex(game_logo, flex);\r\n\t\t\tgame_logo.bringToTop();\r\n\t\t\tgame_logo.alpha = 0;\r\n\t\t\tthis.tweenToPromise(game_logo, {alpha: opacity}, 1000, null, true, 0)\r\n\t\t\t\t.then(() => Utils.timeout(1000))\r\n\t\t\t\t.then(() => this.tweenToPromise(game_logo, {alpha: 0}, 1000, null, true, 0).then(() => {\r\n\t\t\t\t\t\tif (!cover.hidden) {\r\n\t\t\t\t\t\t\tthis.sceneProxy.showCover();// 创建封面\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tlet chapter = this.sceneProxy.findFirstChapter();\r\n\t\t\t\t\t\t\tconst chapterUuid = chapter.downloadUuid ? chapter.downloadUuid : chapter.uuid;\r\n                            if (chapter.md5 && chapter.plots.length === 0) {\r\n                                //第三方\r\n                                if(this.sceneProxy.isWapOther()){\r\n                                    const otherback = (plots)=>{\r\n                                        if(plots === null){\r\n                                            Dialog.error('获取付费章节信息失败');\r\n                                        }else if(plots === \"fail\"){\r\n                                            //查询失败\r\n                                            Dialog.custom(\"Error\",\"仍未查询到您的支付信息哦，请确认已经支付~ 如有疑问请添加闪艺客服QQ：819786897 ~\",\"提示\",\"复制QQ\",\"取消\",false).then(()=>{\r\n                                                Copy(\"819786897\",{\r\n                                                    debug: false,\r\n                                                    message: '复制成功',\r\n                                                })\r\n                                            },()=>{\r\n                                            })\r\n                                        }else{\r\n                                            chapter.plots = plots ? plots : [];\r\n                                            this.sceneProxy.preloadChapterAssets(this.sceneProxy.context, chapter);\r\n                                        }\r\n                                    }\r\n                                    this.sceneProxy.unlockChapterByWapOther(chapterUuid,chapter.charge,chapter.md5,otherback);\r\n                                    return;\r\n                                }\r\n                                if (chapter.charge && ('android' === flashvars.client || 'ios' === flashvars.client || flashvars.client === 'wap')) {\r\n                                    const unlockFinish = (bSuccess) => {\r\n                                        if (bSuccess) {\r\n                                            this.sceneProxy.checkIfChapterFree(chapterUuid, chapter.md5).then((plots)=>{\r\n                                                this.sceneProxy.unlockChapterCallBack = null;\r\n                                                chapter.plots.push(...plots);\r\n                                                this.sceneProxy.preloadChapterAssets(context, chapter);\r\n                                            }, () => {\r\n                                                if(flashvars.client === 'wap'){\r\n                                                    window.parent && window.parent.playLogin();\r\n                                                }else{\r\n                                                    Dialog.error('获取付费章节信息失败')\r\n                                                }\r\n                                            })\r\n                                        } else {\r\n                                            Dialog.error('章节解锁失败');\r\n                                        }\r\n                                    };\r\n\r\n                                    this.sceneProxy.unlockChapter(chapterUuid, chapter.charge, chapter.md5, unlockFinish);\r\n\t\t\t\t\t\t\t\t} else {\r\n                                    this.sceneProxy.checkIfChapterFree(chapterUuid, chapter.md5).then((plots)=>{\r\n                                        chapter.plots.push(...plots);\r\n                                        this.sceneProxy.preloadChapterAssets(context, chapter);\r\n                                    }, (msg)=>{\r\n                                        if (-1 === msg.indexOf('code=87')) {\r\n                                            Dialog.error(msg);\r\n                                        } else { // 未购买此章节\r\n                                            if(flashvars.wap === 'zxwwap'){\r\n                                                Dialog.info('当前为收费章节，是否前往闪艺抢先体验？').then(()=>{\r\n                                                    window.location.href = 'https://wap.3000.com/?m=detail&op=index&ac=index&id='+ flashvars.gid;\r\n                                                })\r\n                                            }else{\r\n                                                Dialog.info('当前为收费章节，请前往闪艺app或电脑端进行购买');\r\n                                            }\r\n                                        }\r\n                                    })\r\n\t\t\t\t\t\t\t\t}\r\n                            }\r\n                            else {// 播放剧情\r\n                            \tthis.sceneProxy.preloadChapterAssets(context, chapter);\r\n                            }\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t},\r\n\r\n\t\tshowProgress: function (progress, totalLoaded, totalFiles, isChapter) {\r\n\t\t\tlet background = this.sceneProxy.progressLayer.getByName(\"background\");\r\n\t\t\tlet type0 = this.sceneProxy.progressLayer.getByName(\"type0\");\r\n\t\t\tlet type1 = this.sceneProxy.progressLayer.getByName(\"type1\");\r\n\t\t\tconst width = this.viewComponent.game.world.width;\r\n\t\t\tconst height = this.viewComponent.game.world.height;\r\n\r\n\t\t\tif (!background) {\r\n\t\t\t\tbackground = this.viewComponent.game.add.graphics(0, 0, this.sceneProxy.progressLayer);\r\n\t\t\t\tbackground.beginFill(0x0);\r\n\t\t\t\tbackground.drawRect(0, 0, width, height);\r\n\t\t\t\tbackground.endFill();\r\n\t\t\t\tbackground.name = 'background';\r\n\t\t\t\tbackground.inputEnabled = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (isChapter) {\r\n\r\n\t\t\t\t//章节素材加载\r\n\t\t\t\tbackground.alpha = 0.5;\r\n\t\t\t\tif (!type1) {\r\n\t\t\t\t\ttype1 = this.viewComponent.game.add.group();\r\n\t\t\t\t\ttype1.name = 'type1';\r\n\t\t\t\t\tthis.sceneProxy.progressLayer.add(type1);\r\n\t\t\t\t}\r\n\r\n                let progressText = type1.getByName('progressText');\r\n                if (!progressText) {\r\n                    const fontSytle = { font: '24px 微软雅黑', fill: '#ffffff', boundsAlignH: \"center\", boundsAlignV: \"middle\" };\r\n                    progressText = this.viewComponent.game.add.text(0, 0, '', fontSytle, type1);\r\n                    progressText.name = 'progressText';\r\n                    progressText.setTextBounds(width / 2 - 90, height / 2 - 20, 180, 30);\r\n                }\r\n                progressText.text = \"加载中...\" + progress + '%';\r\n\r\n\t\t\t\ttype0 && (type0.visible = false);\r\n\t\t\t\ttype1 && (type1.visible = true);\r\n\t\t\t\tthis.sceneProxy.progressLayer.bringToTop(type1);\r\n\t\t\t} else {\r\n\t\t\t    return;//  无需开头加载\r\n\t\t\t\t//开头加载\r\n\t\t\t\tbackground.alpha = 0;\r\n\t\t\t\tif (!type0) {\r\n\t\t\t\t\ttype0 = this.viewComponent.game.add.group();\r\n\t\t\t\t\ttype0.name = 'type0';\r\n\t\t\t\t\tthis.sceneProxy.progressLayer.add(type0);\r\n\t\t\t\t}\r\n\t\t\t\tlet progressText = type0.getByName('progressText');\r\n\t\t\t\tlet tipText = type0.getByName('tipText');\r\n\t\t\t\tlet progressBar = type0.getByName(\"progressBar\");\r\n\t\t\t\tlet tipLight = type0.getByName('tipLight');\r\n\r\n\t\t\t\tif (!progressText) {\r\n\t\t\t\t\t//const fontSytle = {font: flashvars.vertical ? \"16px 微软雅黑\" : '18px 微软雅黑', fill: '#ffffff', boundsAlignH: \"center\", boundsAlignV: \"middle\" };\r\n\t\t\t\t\tconst fontSytle = {font:'18px 微软雅黑', fill: '#ffffff', boundsAlignH: \"center\", boundsAlignV: \"middle\",align:\"center\",wordWrap:true};\r\n\t\t\t\t\tprogressText = this.viewComponent.game.add.text(0, 0, \"\", fontSytle, type0);\r\n\t\t\t\t\tprogressText.name = 'progressText';\r\n                    //progressText.setTextBounds(28, 390, width-25, 18);\r\n                    progressText.setTextBounds(28, flashvars.vertical ? (height / 2 + 50) : 390, width-25, 18);\r\n\t\t\t\t}\r\n\t\t\t\tlet tipcontent = \"小贴士：\" +  this.sceneProxy.progressTips[Math.floor(Math.random()*this.sceneProxy.progressTips.length)];\r\n\t\t\t\tif(flashvars.vertical){//竖屏时，自动换行（phaser text自动换行无效，判断长度超过22 插入换行）\r\n                    if(tipcontent.length > 22){\r\n                        const tipary = tipcontent.split(\"\");\r\n                        tipary.splice(20,0,\"\\n\");\r\n                        tipcontent = tipary.join(\"\").toString();\r\n                    }\r\n                }\r\n                progressText.text == '' && (progressText.text =tipcontent);\r\n                //progressText.text === '' && (progressText.text = (\"小贴士: \" +  this.sceneProxy.progressTips[Math.floor(Math.random()*this.sceneProxy.progressTips.length)]));\r\n\r\n\t\t\t\tif (!tipLight) {\r\n\t\t\t\t\t//tipLight = this.viewComponent.game.add.image((width - progressText.width - 28) / 2,385 , 'light', 0, type0);\r\n\t\t\t\t\ttipLight = this.viewComponent.game.add.image((width - progressText.width - 28) / 2,flashvars.vertical ? (tipcontent.length > 22 ? (height / 2 + 33) : (height / 2 + 46)) : 385 , 'light', 0, type0);\r\n\t\t\t\t\ttipLight.name = 'tipLight';\r\n\t\t\t\t}\r\n\t\t\t\tif (!tipText) {\r\n\t\t\t\t\ttipText = this.viewComponent.game.add.text(0, 0, '', {font: '28px 微软雅黑', fill: '#ffffff', boundsAlignH: \"center\", boundsAlignV: \"middle\"}, type0);\r\n                    tipText.anchor.set(0.3,0.5)\r\n\t\t\t\t\ttipText.name = 'tipText';\r\n\t\t\t\t}\r\n\t\t\t\ttipText.visible = progress > 0 ? true : false;\r\n\t\t\t\t//tipText.setTextBounds(width / 2,350,40,22);\r\n\t\t\t\ttipText.setTextBounds(width / 2,flashvars.vertical ? (height / 2 + 20) : 350,40,22);\r\n\t\t\t\ttipText.text = progress + '%';\r\n\t\t\t\ttype0 && (type0.visible = true);\r\n\t\t\t\ttype1 && (type1.visible = false);\r\n\t\t\t\tthis.sceneProxy.progressLayer.bringToTop(type0);\r\n\t\t\t}\r\n\t\t\tthis.sceneProxy.progressLayer.visible = true;\r\n\t\t\tthis.viewComponent.game.world.bringToTop(this.sceneProxy.progressLayer);\r\n            this.sceneProxy.quickPlayLayer.alpha && this.viewComponent.game.world.bringToTop(this.sceneProxy.quickPlayLayer);\r\n\t\t},\r\n\r\n\t\taddDialogLayer: function () {\r\n\t\t\tconst {background, rect, avatarContainer, titleContainer, content} = this.sceneProxy.json_data.template.json.dialog;\r\n\r\n\t\t\tif (this.sceneProxy.dialogLayer.children.length === 0) {\r\n\t\t\t\t//this.sceneProxy.dialogLayer.inputEnableChildren = true;\r\n\r\n\t\t\t\tlet x, y, texture;\r\n\r\n\t\t\t\t// 对话框背景\r\n\t\t\t\tif (this.viewComponent.game.load.cache.checkImageKey(background.url)) {\r\n\t\t\t\t\tconst dialog_bk = this.sceneProxy.dialogLayer.create(0, 0, background.url);\r\n\t\t\t\t\tdialog_bk.width = rect.width;\r\n\t\t\t\t\tdialog_bk.height = rect.height;\r\n\t\t\t\t\tdialog_bk.name = 'dialog_bk';\r\n\t\t\t\t}\r\n\t\t\t\t// 标题背景\r\n\t\t\t\tx = titleContainer.rect.x;\r\n\t\t\t\ty = titleContainer.rect.y;\r\n\t\t\t\tif (this.viewComponent.game.load.cache.checkImageKey(titleContainer.background.url)) {\r\n\t\t\t\t\tconst dialog_bk_title = this.sceneProxy.dialogLayer.create(x, y, titleContainer.background.url);\r\n\t\t\t\t\tdialog_bk_title.width = titleContainer.rect.width;\r\n\t\t\t\t\tdialog_bk_title.height = titleContainer.rect.height;\r\n\t\t\t\t\tdialog_bk_title.name = 'dialog_bk_title';\r\n\t\t\t\t}\r\n\t\t\t\t// 标题文本\r\n\t\t\t\tlet txt;\r\n\t\t\t\tx = titleContainer.rect.x + titleContainer.title.rect.x;\r\n\t\t\t\ty = titleContainer.rect.y + titleContainer.title.rect.y;\r\n                txt = this.viewComponent.game.add.text(0, 0, '', {fill:'#fff'}, this.sceneProxy.dialogLayer);\r\n                txt.name = 'dialog_text_title';\r\n                txt.setTextBounds(x + (titleContainer.title.rect.width - titleContainer.rect.width) / 2, y, titleContainer.rect.width, titleContainer.rect.height);\r\n\t\t\t\t// 头像背景\r\n\t\t\t\tif (this.viewComponent.game.load.cache.checkImageKey(avatarContainer.background.url)) {\r\n\t\t\t\t\tx = avatarContainer.rect.x;\r\n\t\t\t\t\ty = avatarContainer.rect.y;\r\n\t\t\t\t\ttexture = this.sceneProxy.dialogLayer.create(x, y, avatarContainer.background.url);\r\n\t\t\t\t\ttexture.width = avatarContainer.rect.width;\r\n\t\t\t\t\ttexture.height = avatarContainer.rect.height;\r\n\t\t\t\t\ttexture.name = 'dialog_bk_avatar';\r\n\t\t\t\t}\r\n\t\t\t\t// 头像\r\n\t\t\t\tx = avatarContainer.rect.x + avatarContainer.avatar.x;\r\n\t\t\t\ty = avatarContainer.rect.y + avatarContainer.avatar.y;\r\n\t\t\t\tconst avatar = this.sceneProxy.dialogLayer.create(x, y);\r\n\t\t\t\tavatar.name = 'dialog_avatar';\r\n\t\t\t\tavatar.width = avatarContainer.avatar.width;\r\n\t\t\t\tavatar.height = avatarContainer.avatar.height;\r\n\t\t\t\t// 对话文本\r\n\t\t\t\ttxt = this.viewComponent.game.add.text(content.rect.x\r\n\t\t\t\t\t, content.rect.y\r\n\t\t\t\t\t, ''\r\n\t\t\t\t\t, {fill:'#fff', boundsAlignH: \"left\", boundsAlignV: \"top\", wordWrap: true, wordWrapWidth: content.rect.width}\r\n\t\t\t\t\t, this.sceneProxy.dialogLayer);\r\n\t\t\t\ttxt.name = 'dialog_text_content';\r\n\t\t\t\ttxt.useAdvancedWrap = true;\r\n\t\t\t\ttxt.updateText = RePhaser.updateText;\r\n\t\t\t\ttxt.advancedWordWrap = RePhaser.advancedWordWrap;\r\n\t\t\t}\r\n\r\n\t\t\tthis.sceneProxy.dialogLayer.x = rect.x;\r\n\t\t\tthis.sceneProxy.dialogLayer.y = rect.y;\r\n\t\t\tthis.sceneProxy.dialogLayer.alpha = 1;\r\n\t\t\tthis.sceneProxy.dialogLayer.visible = true;\r\n\t\t\tthis.viewComponent.game.world.bringToTop(this.sceneProxy.dialogLayer);\r\n\t\t\tthis.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n            this.sceneProxy.quickPlayLayer.alpha && this.viewComponent.game.world.bringToTop(this.sceneProxy.quickPlayLayer);\r\n\t\t},\r\n\r\n\t\taddMenuLayer: function (bSetFixed) {\r\n\t\t\tif (this.sceneProxy.menuLayer.children.length === 0) {\r\n                const {rect, normal, active} = this.sceneProxy.json_data.template.json.menu;\r\n                const menuBtnClick = (obj, pointer) => {\r\n\t\t\t\t\tif (pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (obj.parent.name === 'menu_button') {\r\n                        this.sceneProxy.cmdPlotNextPromise = null;\r\n                        this.sceneProxy.onMenuBtnClicked();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.sceneProxy.onSyMenuBtnClicked();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\tconst t = {};\r\n\t\t\t\tt.normal = normal.text;\r\n\t\t\t\tt.active = active.text;\r\n\t\t\t\tt.text = '菜单';\r\n\t\t\t\tthis.viewComponent.addButton(flashvars.vertical ? 442 : 866, 26, rect.width, rect.height, normal.background.url, active.background.url\r\n\t\t\t\t\t, menuBtnClick, t, this.sceneProxy.btn_sound, \"menu_button\", this.sceneProxy.menuLayer);\r\n\r\n                this.viewComponent.addButton(flashvars.vertical ? 450 : 874, 100, 56, 56, 'menuMore', 'menuMoreHover'\r\n                    , menuBtnClick, t, this.sceneProxy.btn_sound, \"menu_button_more\", this.sceneProxy.menuLayer);\r\n\r\n\t\t\t\t/*if (this.sceneProxy.json_data.template.json.shanyiMenu) {\r\n                    const {rect:rectSy, normal:normalSy, active:activeSy} = this.sceneProxy.json_data.template.json.shanyiMenu;\r\n                    t.normal = normalSy.text;\r\n                    t.active = activeSy.text;\r\n                    t.text = '闪艺';\r\n                    this.viewComponent.addButton(rectSy.x, rectSy.y, rectSy.width, rectSy.height, flashvars.client ==='wap' ? 'wapback' : normalSy.background.url, flashvars.client ==='wap' ? 'wapback' : activeSy.background.url\r\n                        , menuBtnClick, flashvars.client === 'wap' ? '' : t, this.sceneProxy.btn_sound, \"shanyi_menu_button\", this.sceneProxy.menuLayer);\r\n                }else{\r\n\t\t\t\t    if(flashvars.client === 'wap'){\r\n                        this.viewComponent.addButton(flashvars.vertical ? 442 : 886, flashvars.client ? 30 : 26, 68, 68, 'wapback', 'wapback'\r\n                            , menuBtnClick, '', this.sceneProxy.btn_sound, \"shanyi_menu_button\", this.sceneProxy.menuLayer);\r\n                    }\r\n                }*/\r\n\t\t\t}\r\n\t\t\tthis.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n\t\t\tthis.sceneProxy.menuLayer.visible = true;\r\n\t\t},\r\n\r\n        doEffectsAnimation: function (group) {\r\n            const doAnimation = (index) => {\r\n                Utils.timeout(40).then(() => {\r\n                \tif (group.children.length === 0) {\r\n                \t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!group.visible) {\r\n                \t\tdoAnimation(index);\r\n                \t\treturn;\r\n\t\t\t\t\t}\r\n                    if (0 === index) {\r\n                        group.children[group.children.length-1].visible = false;\r\n                    }\r\n                    else {\r\n                        group.children[index-1].visible = false;\r\n                    }\r\n                    group.children[index].visible = true;\r\n                    doAnimation(++index % group.children.length);\r\n                });\r\n            };\r\n\r\n            doAnimation(0);\r\n        },\r\n\r\n\t\taddRainEffect: function () {\r\n\t\t\tlet rain = this.sceneProxy.weatherLayer.getByName('rain');\r\n\t\t\tif (!rain) {\r\n\t\t\t\train = this.viewComponent.game.add.group();\r\n\t\t\t\train.name = 'rain';\r\n\t\t\t\tthis.sceneProxy.weatherLayer.add(rain);\r\n\t\t\t\tconst rain1 = [];\r\n\t\t\t\tfor (let i=0; i<50; i++) {\r\n\t\t\t\t\train1[i] = this.viewComponent.game.add.sprite(0, 0, `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"rain\")}/xiayu_${Utils.formatNum(i)}.png`);\r\n                    rain.add(rain1[i]);\r\n                    rain1[i].visible = false;\r\n                }\r\n                this.doEffectsAnimation(rain);\r\n\t\t\t}\r\n\t\t\tthis.sceneProxy.weatherLayer.visible = true;\r\n\t\t\train.visible = true;\r\n\t\t\tthis.sceneProxy.weatherLayer.bringToTop(rain);\r\n\t\t},\r\n\r\n\t\taddSnowEffect: function () {\r\n\t\t\tlet snow = this.sceneProxy.weatherLayer.getByName('snow');\r\n\t\t\tif (!snow) {\r\n\t\t\t\tsnow = this.viewComponent.game.add.group();\r\n\t\t\t\tsnow.name = 'snow';\r\n\t\t\t\tthis.sceneProxy.weatherLayer.add(snow);\r\n\t\t\t\tconst snow1 = [];\r\n\t\t\t\tfor (let i=0; i<120; i++) {\r\n\t\t\t\t\tsnow1[i] = this.viewComponent.game.add.sprite(0, 0, `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"snow\")}/xuehua_${ Utils.formatNum(i)}.png`);\r\n\t\t\t\t\tsnow.add(snow1[i]);\r\n\t\t\t\t\tsnow1[i].visible = false;\r\n\t\t\t\t}\r\n\t\t\t\tthis.doEffectsAnimation(snow);\r\n\t\t\t}\r\n\t\t\tthis.sceneProxy.weatherLayer.visible = true;\r\n\t\t\tsnow.visible = true;\r\n\t\t\tthis.sceneProxy.weatherLayer.bringToTop(snow);\r\n\t\t},\r\n\r\n\t\taddWindEffect: function () {\r\n\t\t\tlet wind = this.sceneProxy.weatherLayer.getByName('wind');\r\n\t\t\tif (!wind) {\r\n\t\t\t\twind = this.viewComponent.game.add.group();\r\n\t\t\t\twind.name = 'wind';\r\n\t\t\t\tthis.sceneProxy.weatherLayer.add(wind);\r\n\t\t\t\tif(flashvars.vertical){\r\n                    const wind1 = [];\r\n                    for (let i=0; i<20; i++) {\r\n                        wind1[i] = this.viewComponent.game.add.sprite(0, 0, `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"wind\")}/feng_${Utils.formatNum(i)}.png`);\r\n                        wind.add(wind1[i]);\r\n                        wind1[i].visible = false;\r\n                    }\r\n                    this.doEffectsAnimation(wind)\r\n                }else{\r\n                    this.viewComponent.game.add.tileSprite(0, 0, 960, 540, 'wind', 1, wind).autoScroll(-360, 0);\r\n                }\r\n\t\t\t}\r\n\t\t\tthis.sceneProxy.weatherLayer.visible = true;\r\n\t\t\twind.visible = true;\r\n\t\t\tthis.sceneProxy.weatherLayer.bringToTop(wind);\r\n\t\t},\r\n\r\n        addFallingLeavesEffect: function () {\r\n            let fLeaves = this.sceneProxy.weatherLayer.getByName('fallingLeaves');\r\n            if (!fLeaves) {\r\n                fLeaves = this.viewComponent.game.add.group();\r\n                fLeaves.name = 'fallingLeaves';\r\n                this.sceneProxy.weatherLayer.add(fLeaves);\r\n                const fLeaves1 = [];\r\n                for (let i=0; i<90; i++) {\r\n                    fLeaves1[i] = this.viewComponent.game.add.sprite(0, 0, `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"mapleLeaves\")}/fengye_${Utils.formatNum(i)}.png`);\r\n                    fLeaves.add(fLeaves1[i]);\r\n                    fLeaves1[i].visible = false;\r\n                }\r\n                this.doEffectsAnimation(fLeaves);\r\n            }\r\n            this.sceneProxy.weatherLayer.visible = true;\r\n            fLeaves.visible = true;\r\n            this.sceneProxy.weatherLayer.bringToTop(fLeaves);\r\n        },\r\n\r\n        addBeachBlossomEffect: function () {\r\n            let beachBlossom = this.sceneProxy.weatherLayer.getByName('beachBlossom');\r\n            if (!beachBlossom) {\r\n                beachBlossom = this.viewComponent.game.add.group();\r\n                beachBlossom.name = 'beachBlossom';\r\n                this.sceneProxy.weatherLayer.add(beachBlossom);\r\n                const beachBlossom1 = [];\r\n                for (let i=0; i<90; i++) {\r\n                    beachBlossom1[i] = this.viewComponent.game.add.sprite(0, 0, `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"beachBlossom\")}/taohua_${Utils.formatNum(i)}.png`);\r\n                    beachBlossom.add(beachBlossom1[i]);\r\n                    beachBlossom1[i].visible = false;\r\n\t\t\t\t}\r\n                this.doEffectsAnimation(beachBlossom);\r\n            }\r\n            this.sceneProxy.weatherLayer.visible = true;\r\n            beachBlossom.visible = true;\r\n            this.sceneProxy.weatherLayer.bringToTop(beachBlossom);\r\n        },\r\n\r\n        addBlossomEffect: function () {\r\n            let blossom = this.sceneProxy.weatherLayer.getByName('blossom');\r\n            if (!blossom) {\r\n                blossom = this.viewComponent.game.add.group();\r\n                blossom.name = 'blossom';\r\n                this.sceneProxy.weatherLayer.add(blossom);\r\n                const blossom1 = [];\r\n                for (let i=0; i<90; i++) {\r\n                    blossom1[i] = this.viewComponent.game.add.sprite(0, 0, `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"blossom\")}/yinghua_${Utils.formatNum(i)}.png`);\r\n                    blossom.add(blossom1[i]);\r\n                    blossom1[i].visible = false;\r\n\t\t\t\t}\r\n\t\t\t\tthis.doEffectsAnimation(blossom);\r\n            }\r\n            this.sceneProxy.weatherLayer.visible = true;\r\n            blossom.visible = true;\r\n            this.sceneProxy.weatherLayer.bringToTop(blossom);\r\n        },\r\n\r\n        addLightningEffect: function () {\r\n            let lightning = this.sceneProxy.weatherLayer.getByName('lightning');\r\n            if (!lightning) {\r\n                lightning = this.viewComponent.game.add.group();\r\n                lightning.name = 'lightning';\r\n                this.sceneProxy.weatherLayer.add(lightning);\r\n                const lightning1 = [];\r\n                for (let i=0; i<50; i++) {\r\n                    lightning1[i] = this.viewComponent.game.add.sprite(0, 0, `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"lightning\")}/shandian_${Utils.formatNum(i)}.png`);\r\n                    lightning.add(lightning1[i]);\r\n                    lightning1[i].visible = false;\r\n\t\t\t\t}\r\n\t\t\t\tthis.doEffectsAnimation(lightning);\r\n            }\r\n            this.sceneProxy.weatherLayer.visible = true;\r\n            lightning.visible = true;\r\n            this.sceneProxy.weatherLayer.bringToTop(lightning);\r\n        },\r\n\r\n\t\tregisterViewKey: function (refUuid, parentEvents, arrKeys) {\r\n\t\t\tconst {viewMap} = this.sceneProxy.json_data;\r\n\t\t\tconst reg = events => {\r\n                for (let e in events) {\r\n                    if (events[e].type === 'onKeyUp') {\r\n                        this.viewComponent.game.input.keyboard.removeKey(events[e].keyCode);\r\n                        arrKeys[events[e].keyCode] = this.viewComponent.game.input.keyboard.addKey(events[e].keyCode);\r\n                    }\r\n                }\r\n\t\t\t};\r\n\t\t\tconst doReg = (uuid) => {\r\n\t\t\t\treg(viewMap[uuid].events);\r\n\r\n                for (let i in viewMap[uuid].children) {\r\n                    doReg(viewMap[uuid].children[i].ref);\r\n                    reg(viewMap[uuid].children[i].events);\r\n                }\r\n            };\r\n\r\n\t\t\tdoReg(refUuid);\r\n\t\t\treg(parentEvents);\r\n\t\t},\r\n\r\n\t\tremoveViewKey: function (arrKeys) {\r\n\t\t\tfor (let k in arrKeys) {\r\n\t\t\t\tthis.viewComponent.game.input.keyboard.removeKey(k);\r\n\t\t\t\tarrKeys.splice(k, 1);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tremoveViewKeyByInstance: function (view, arrKeys) {\r\n            const {viewMap} = this.sceneProxy.json_data;\r\n            const unReg = events => {\r\n                for (let e in events) {\r\n                    if (events[e].type === 'onKeyUp') {\r\n                        this.viewComponent.game.input.keyboard.removeKey(events[e].keyCode);\r\n                        arrKeys.splice(events[e].keyCode,1);\r\n                    }\r\n                }\r\n            };\r\n            const doUnReg = (v) => {\r\n                v.name && viewMap[v.name] && unReg(viewMap[v.name].events);\r\n\r\n                for (let i in v.children) {\r\n                    doUnReg(v.children[i]);\r\n                }\r\n            };\r\n\r\n            doUnReg(view);\r\n        },\r\n\r\n\t\taddGlobalView: function (refUuidToHide) {\r\n\t\t\tif (!this.sceneProxy.globalViews) {\r\n\t\t\t\tthis.sceneProxy.globalViews = [];\r\n\t\t\t\tthis.sceneProxy.globalViewKeys = [];\r\n\t\t\t\tconst views = this.sceneProxy.json_data.views;\r\n\t\t\t\tfor (let p in views) {\r\n\t\t\t\t\tthis.registerViewKey(views[p].ref, views[p].events, this.sceneProxy.globalViewKeys);\r\n\t\t\t\t\tthis.sceneProxy.globalViews[p] = this.addView(null, views[p].ref, views[p].instanceUuid, views[p].x, views[p].y, views[p].events);\r\n                    this.sceneProxy.globalViews[p].isGlobal = true;\r\n\t\t\t\t\tif (views[p].scale) {\r\n\t\t\t\t\t\tthis.sceneProxy.globalViews[p].scale.set(views[p].scale, views[p].scale);\r\n\t\t\t\t\t\tthis.sceneProxy.globalViews[p].x += views[p].x.value * (1 - views[p].scale);\r\n\t\t\t\t\t\tthis.sceneProxy.globalViews[p].y += views[p].y.value * (1 - views[p].scale);\r\n\t\t\t\t\t\tthis.scaleInputView(this.sceneProxy.globalViews[p], views[p].scale);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n                this.uiOnLoadInvoker();\r\n\t\t\t}\r\n\t\t\tfor (let p in this.sceneProxy.globalViews) {\r\n\t\t\t\tif (refUuidToHide[this.sceneProxy.globalViews[p].name]) {\r\n\t\t\t\t\tthis.sceneProxy.globalViews[p].visible = false;\r\n                    this.showInputView(this.sceneProxy.globalViews[p], false);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.sceneProxy.globalViews[p].visible = true;\r\n                    this.showInputView(this.sceneProxy.globalViews[p], true);\r\n\t\t\t\t\tthis.viewComponent.game.world.bringToTop(this.sceneProxy.globalViews[p]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\taddView: function (parentLayer, refUuid, instanceUuid, xInfo, yInfo, eventsInfo, isRefresh = false,isload=false,diymenu=false) {\r\n\t\t\tif (!refUuid) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n            let result = true;\r\n            const viewInfo = this.sceneProxy.json_data.viewMap[refUuid];\r\n            if (!viewInfo) {\r\n                return null;\r\n            }\r\n            const containerLayer = this.viewComponent.game.add.group();\r\n            containerLayer.name = refUuid;\r\n            containerLayer.instanceUuid = instanceUuid;\r\n            containerLayer.xInfo = xInfo;\r\n            containerLayer.yInfo = yInfo;\r\n            containerLayer.eventsInfo = eventsInfo;\r\n            containerLayer.inputEnableChildren = true;\r\n            containerLayer.viewInfoName = viewInfo.name;\r\n            parentLayer && parentLayer.add(containerLayer);\r\n\r\n            const {Expression, curChapter, uiOnLoadQueue} = this.sceneProxy;\r\n            let {context} = this.sceneProxy;\r\n            const pointX = Expression.safeEval(xInfo, context);\r\n            const pointY = Expression.safeEval(yInfo, context);\r\n            const clearDiyMenu = ()=>{\r\n                if (diymenu){\r\n                    //diy菜单\r\n                    if(this.sceneProxy.mainMenuLayer.children.length > 0 && this.sceneProxy.json_data.default_settings.mainMenu){\r\n                        this.sceneProxy.mainMenuLayer.removeAll(true);\r\n                    }\r\n                    this.sceneProxy.onResume();\r\n                }\r\n            }\r\n\r\n            const eventHandler = (obj, events, type, nextAction,ispay=false,isplayad=false) => {\r\n                let i=0;\r\n                for (i=0; i<events.length; i++) {\r\n                    if (events[i].type === 'jump') {\r\n                        if (!this.sceneProxy.isGettingNext) { // 正在获取下一剧情信息时不响应该事件，以免修改context无法正常下一剧情\r\n                            this.sceneProxy.uiOnLoadQueue = [];\r\n                            this.sceneProxy.mainMenuLayer.visible && this.sceneProxy.onMainMenuBackBtnClicked();\t// 主菜单可见 说明是自制菜单的jump事件\r\n                            this.sceneProxy.context = JSON.parse(JSON.stringify(context));\r\n                            this.showNextPlot(this.sceneProxy.context, this.sceneProxy.curChapter, this.sceneProxy.curPlotIndex, events[i].type, events[i].handle.uuid);\r\n                        }\r\n                        return false;\r\n                    }\r\n                    else if (events[i].type === 'playMusic') {\r\n                        if (this.viewComponent.game.load.cache.checkSoundKey(events[i].handle.music.url)\r\n                            || ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version)) {\r\n                            this.sceneProxy.stopMusic(events[i].handle.music.url, true);\r\n                            this.sceneProxy.playMusic(events[i].handle.music.url, events[i].handle.music.volume, true, true);\r\n                        }\r\n                    }\r\n                    else if (events[i].type === 'stopMusic') {\r\n                        this.sceneProxy.stopMusic(null, true);\r\n                    }\r\n                    else if (events[i].type === 'playSound') {\r\n                        for (let s=0; s<events[i].handle.sounds.length; s++) {\r\n                            if(events[i].handle.sounds[s]) {\r\n                                let url = events[i].handle.sounds[s] ? events[i].handle.sounds[s].url : '';\r\n                                if (url === 'inherit') {\r\n                                    continue;\r\n                                }\r\n                                else if (this.viewComponent.game.load.cache.checkSoundKey(url)) {\r\n                                    let volume = events[i].handle.sounds[s].volume === 'inherit' ? this.sceneProxy.plotSounds[s].volume : events[i].handle.sounds[s].volume;\r\n                                    this.sceneProxy.stopSound(s, url, true);\r\n                                    this.sceneProxy.playSound(s, url, volume, !events[i].handle.sounds[s].time, true);\r\n                                }\r\n                                else if ('ios' === flashvars.client && flashvars.app_version >= '1.5.0') {\r\n                                    let volume = events[i].handle.sounds[s].volume === 'inherit' ? PhoneUtils.soundsInfo[s].volume : events[i].handle.sounds[s].volume;\r\n                                    this.sceneProxy.stopSound(s, url, true);\r\n                                    this.sceneProxy.playSound(s, url, volume, !events[i].handle.sounds[s].time, true);\r\n                                }\r\n                                else {\r\n                                    this.sceneProxy.stopSound(s);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    else if (events[i].type === 'stopSound') {\r\n                        this.sceneProxy.stopSound(-1,null,true)\r\n                        //this.sceneProxy.plotSounds.forEach((s, i) => this.sceneProxy.stopSound(i, null, true));\r\n                    }\r\n                    else if (events[i].type === 'callUI') {\r\n                        this.sceneProxy.sendNotification(diygamePlayer.AppConstants.SCENE_SHOW_INPUT_VIEW, false);\r\n                        if (events[i].handle.id === 'save-record' && events[i].handle.type === 'system') {\r\n                            const disableSaveOrLoad = this.sceneProxy.context.disableSaveOrLoad;\r\n                            if (disableSaveOrLoad && disableSaveOrLoad.save) {\r\n                                this.sceneProxy.showToast(1, '抱歉，作者在此设置了禁用存档');\r\n                                return false;\r\n                            }\r\n                            !this.sceneProxy.mainMenuLayer.visible && this.sceneProxy.getSnap();\r\n                            this.sceneProxy.showSave();\r\n                            return false;\r\n                        }\r\n                        else if (events[i].handle.id === 'load-record' && events[i].handle.type === 'system') {\r\n                            const disableSaveOrLoad = this.sceneProxy.context.disableSaveOrLoad;\r\n                            if (disableSaveOrLoad && disableSaveOrLoad.load) {\r\n                                this.sceneProxy.showToast(1, '抱歉，作者在此设置了禁用读档');\r\n                                return false;\r\n                            }\r\n                            this.sceneProxy.showLoad();\r\n                            return false;\r\n                        }\r\n                        else if (events[i].handle.id === 'playback' && events[i].handle.type === 'system') {\r\n                            this.sceneProxy.showPlayback();\r\n                            return false;\r\n                        }\r\n                        else if (events[i].handle.id === 'settings' && events[i].handle.type === 'system') {\r\n                            this.sceneProxy.showSettings(this.sceneProxy.context);\r\n                            return false;\r\n                        }\r\n                        else if (events[i].handle.uuid){\r\n                            const xInfo = Object.assign({}, events[i].handle.position.x);\r\n                            const yInfo = Object.assign({}, events[i].handle.position.y);\r\n                            const nCount = events[i].handle.count ? Expression.safeEval(events[i].handle.count, this.sceneProxy.context) : 1;\r\n                            for (let n=0; n<nCount; n++) {\r\n                                this.registerViewKey(events[i].handle.uuid, [], this.sceneProxy.plotViewKeys);\r\n                                const view = this.addView(parentLayer, events[i].handle.uuid, '', xInfo, yInfo,{},false,false,diymenu);\r\n                                if (!view) {\r\n                                    continue;\r\n                                }\r\n                                if (!parentLayer) {\r\n                                    view.isGlobal = true;\r\n                                    this.viewComponent.game.world.bringToTop(view);\r\n                                    this.sceneProxy.globalViews.push(view);\r\n                                }\r\n                                else if (parentLayer.name === 'plotViewsLayer') {\r\n                                    this.sceneProxy.plotViews.push(view);\r\n                                }\r\n                                else if (parentLayer.xInfo && parentLayer.yInfo) {\r\n                                    view.x += Expression.safeEval(parentLayer.xInfo, this.sceneProxy.context);\r\n                                    view.y += Expression.safeEval(parentLayer.yInfo, this.sceneProxy.context);\r\n                                }\r\n\r\n                                /*if ((parentLayer && parentLayer.parent && parentLayer.parent.name !== 'mainMenuLayer') && this.sceneProxy.mainMenuLayer.visible !== true) {\r\n                                    console.log('菜单')\r\n                                    this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n                                }*/\r\n\r\n\r\n                                // 非onLoad事件触发的 则执行onLoad\r\n                                if('onLoad' !== type)this.uiOnLoadInvoker();\r\n                                /*if(parentLayer && parentLayer.parent){\r\n                                    parentLayer.parent.bringToTop(parentLayer);//置顶全局高级界面\r\n                                }*/\r\n\r\n                            }\r\n                        }\r\n                    }\r\n                    else if (events[i].type === 'refreshUI') {\r\n                        let refreshViews = this.refreshView(events[i].handle.uuid);\r\n                    }\r\n                    else if (events[i].type === 'reload') {\r\n                        let refreshViews = this.refreshView(events[i].handle.uuid, true);\r\n                        if (events[i].handle.uuid === parentLayer.name) {\r\n                            for (let n=0; n<refreshViews.length; n++) {\r\n                                if (refreshViews[n].name === parentLayer.name) {\r\n                                    parentLayer = refreshViews[n];\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                        /*for(let i = 0;i < refreshViews.length;i++){\r\n                            refreshViews[i].onLoadBack && this.sceneProxy.uiOnLoadQueue.push(refreshViews[i].onLoadBack)\r\n                        }*/\r\n                        // 重载组件需要重新调用onLoad事件\r\n                        this.uiOnLoadInvoker();\r\n                    }\r\n                    else if (events[i].type === 'closeUI') {\r\n                        this.sceneProxy.sendNotification(diygamePlayer.AppConstants.SCENE_SHOW_INPUT_VIEW, true);\r\n                        let uuidToClose = events[i].handle.uuid;\r\n                        let objParent = obj;\r\n                        let bCloseMainMenu = false;\r\n                        const getCloseUuid = (bSingleToClose) => {\r\n                            objParent = objParent && objParent.parent;\r\n                            while (1) {\r\n                                if (!objParent) {\r\n                                    break;\r\n                                } else if (objParent.viewType) {\r\n                                    if (bSingleToClose) {\r\n                                        objParent.name += '_1';\r\n                                    }\r\n                                    return objParent.name;\r\n                                }\r\n                                objParent = objParent.parent;\r\n                            }\r\n                        };\r\n                        if (events[i].handle.type === 'system' && events[i].handle.id === 'diyMainMenu') {\r\n                            if(this.sceneProxy.json_data.default_settings.mainMenu){\r\n                                let diyMainMenu = this.sceneProxy.mainMenuLayer.children[1];\r\n                                if (diyMainMenu) {\r\n                                    uuidToClose = diyMainMenu.name;\r\n                                    bCloseMainMenu = true;\r\n                                }\r\n                                else {\r\n                                    uuidToClose = null;\r\n                                    this.sceneProxy.onMainMenuBackBtnClicked();\r\n                                    this.sceneProxy.mainMenuLayer.removeAll(true, false, true);\r\n                                }\r\n                            }else{\r\n                                //没有diy菜单\r\n                                return\r\n                            }\r\n                        } else {\r\n                            if (!uuidToClose) {\r\n                                if (obj.viewType) {\r\n                                    uuidToClose = obj.name;\r\n                                    events[i].isParent && (uuidToClose = getCloseUuid(objParent, true));\r\n                                } else {\r\n                                    uuidToClose = getCloseUuid(objParent, true);\r\n                                    events[i].isParent && (uuidToClose = getCloseUuid(objParent, true));\r\n                                }\r\n                            }\r\n                        }\r\n                        if (uuidToClose) {\r\n                            // 关闭组件后 对应的onLoad事件不再执行\r\n                            const self = uuidToClose.indexOf('_1') > 0;\r\n                            let realUuid = uuidToClose.substring(0, 36);\r\n                            for (let n=0; n<uiOnLoadQueue.length; n++) {\r\n                                if ((uiOnLoadQueue[n].name === realUuid || uiOnLoadQueue[n].instanceUuid === realUuid) && !self) {\r\n                                    uiOnLoadQueue.splice(n--, 1);\r\n                                }\r\n                            }\r\n                            // closeUI\r\n                            this.destroyView(uuidToClose, bCloseMainMenu);\r\n                        }\r\n                        if (events[i].handle.type === 'system') {\r\n                            return;\r\n                        }\r\n                    }\r\n                    else if (events[i].type === 'back') {\t// 返回封面\r\n                        clearDiyMenu();\r\n                        this.sceneProxy.uiOnLoadQueue = [];\r\n                        this.sceneProxy.mainMenuLayer.visible && this.sceneProxy.onResume();\r\n                        this.sceneProxy.context = JSON.parse(JSON.stringify(context));\r\n                        this.showNextPlot(this.sceneProxy.context, curChapter, this.sceneProxy.curPlotIndex, events[i].type);\r\n                        return false;\r\n                    }\r\n                    else if (events[i].type === 'nextPlot') { // 下个剧情\r\n                        clearDiyMenu();\r\n                        this.sceneProxy.uiOnLoadQueue = [];\r\n                        if (curChapter.plots[this.sceneProxy.curPlotIndex].commands) {\r\n                            this.sceneProxy.optionLayer.destroy();\r\n                            this.sceneProxy.cmdPlotNextPromise && this.sceneProxy.cmdPlotNextPromise({type: ''});\r\n                            return false;\r\n                        }\r\n                        this.sceneProxy.context = JSON.parse(JSON.stringify(context));\r\n                        if (curChapter.plots[this.sceneProxy.curPlotIndex].condition_options.length > 0) {\r\n                            this.showNextPlot(this.sceneProxy.context, curChapter, this.sceneProxy.curPlotIndex);\r\n                            return false;\r\n                        }\r\n                        this.showNextPlot(this.sceneProxy.context, curChapter, this.sceneProxy.curPlotIndex, events[i].type);\r\n                        return false;\r\n                    }\r\n                    else if (events[i].type === 'jumpOption') { // 跳出分支\r\n                        clearDiyMenu();\r\n                        this.sceneProxy.uiOnLoadQueue = [];\r\n                        const n = Expression.safeEval(events[i].handle.value, context);\r\n                        if (curChapter.plots[this.sceneProxy.curPlotIndex].commands) {\r\n                            const {info, index} = this.sceneProxy.getNextCommand(context, this.sceneProxy.curCmdInfo, -1, {eArg: n, type: 'jumpOption'});\r\n                            if (index !== -1) {\r\n                                this.sceneProxy.cmdPlayHandlerFun(info, index);\r\n                            }\r\n                            return false;\r\n                        }\r\n\r\n                        this.showNextPlot(this.sceneProxy.context, curChapter, this.sceneProxy.curPlotIndex, events[i].type, n);\r\n                        return false;\r\n                    }\r\n                    else if (events[i].type === 'backOption') {\r\n                        clearDiyMenu();\r\n                        this.sceneProxy.uiOnLoadQueue = [];\r\n                        const n = Expression.safeEval(events[i].handle.value, context);\r\n                        if (curChapter.plots[this.sceneProxy.curPlotIndex].commands) {\r\n                            const {info, index} = this.sceneProxy.getNextCommand(context, this.sceneProxy.curCmdInfo, -1, {eArg: n, type: 'backOption'});\r\n                            if (index !== -1) {\r\n                                this.sceneProxy.cmdPlayHandlerFun(info, index);\r\n                            }\r\n                            return false;\r\n                        }\r\n\r\n                        this.showNextPlot(this.sceneProxy.context, curChapter, this.sceneProxy.curPlotIndex, events[i].type, n);\r\n                        return false;\r\n                    }\r\n                    else if (events[i].type === 'insertPlot') { // 插播剧情\r\n                        clearDiyMenu();\r\n                        this.sceneProxy.uiOnLoadQueue = [];\r\n                        // 先结束当前剧情\r\n                        let pointer = new Phaser.Pointer(this.viewComponent.game, 1, Phaser.PointerMode.CURSOR);\r\n                        pointer.button = 0;\r\n                        this.sceneProxy.curPlotLayer.onChildInputDown.dispatch('insertPlot', pointer);\r\n                        // 插播\r\n                        this.showNextPlot(this.sceneProxy.context, this.sceneProxy.curChapter, this.sceneProxy.curPlotIndex, events[i].type, events[i].handle.uuid);\r\n                        return false;\r\n                    }\r\n                    else if (events[i].type === 'setValue') { // 数值设置\r\n                        if(isplayad !== false){\r\n                            nextAction && (nextAction.paused = true);//暂停后续\r\n                            if (i<events.length) {\r\n                                return eventHandler(obj, events.slice(i+1), type, nextAction,ispay,true);\r\n                            }\r\n                            break;\r\n                        } //购买不足 播放广告后面数值操作不执行\r\n                        if(this.sceneProxy.isSetValues !== false){ break }//数值正在操作中\r\n                        nextAction && (nextAction.paused = true);//暂停后续\r\n                        this.sceneProxy.valueOperation(context, events[i].handle.values,false,()=>{\r\n                            if (i<events.length) {\r\n                                return eventHandler(obj, events.slice(i+1), type, nextAction,ispay);\r\n                            }\r\n                        },ispay);\r\n                        break;\r\n                    }\r\n                    else if (events[i].type === 'pay') {\t// 扣费事件\r\n                        //直接购买成功  无需执行购买\r\n                        const price = Expression.safeEval(events[i].handle.price, context);\r\n                        if(context.systemValues[0].value >= price){\r\n                            //支付\r\n                            context.systemValues[0].value = context.systemValues[0].value - price;\r\n                            this.sceneProxy.saveAccountInfo();\r\n                        }else{\r\n                            this.sceneProxy.context.fullScreen && this.sceneProxy.onSettingsWindowModeBtnClicked();\r\n                            Dialog.custom(\"Info\",\"当前闪币余额不足，观看广告可获得更多闪币哟！\",\"提示\",\"立即获得\",\"取消\",false).then(()=>{\r\n                                //播放广告\r\n                                const adback = (backtype)=>{\r\n                                    this.sceneProxy.playAdCallBack = null;\r\n                                    //this.sceneProxy.onResume();//唤醒游戏继续\r\n                                    if(backtype === '1' || backtype === 1){context.systemValues[0].value +=1};//成功 金币+1\r\n                                    this.sceneProxy.saveAccountInfo();\r\n                                    if (i<events.length) {\r\n                                        return eventHandler(obj, events.slice(i+1), type, nextAction,false,true);\r\n                                    }\r\n                                };\r\n                                if(window.app){\r\n                                    //this.sceneProxy.onPause();//播放广告暂停\r\n                                    this.sceneProxy.playAdCallBack = adback;\r\n                                    nextAction && (nextAction.paused = true);//暂停后续\r\n                                    window.app.playAdVideo();//android apk 播放广告\r\n                                }\r\n                            },()=>{});\r\n                            break;\r\n                        }\r\n                    }\r\n                    else if(events[i].type === 'playad'){\r\n                        //播放广告\r\n                        const adback = (backtype)=>{\r\n                            this.sceneProxy.playAdCallBack = null;\r\n                            //this.sceneProxy.onResume();//唤醒游戏继续\r\n                            if(backtype === '1' || backtype === 1){context.systemValues[0].value +=1};//成功 金币+1\r\n                            this.sceneProxy.saveAccountInfo();\r\n                            if (i<events.length) {\r\n                                return eventHandler(obj, events.slice(i+1), type, nextAction,false);\r\n                            }\r\n                        };\r\n                        if(window.app){\r\n                            //this.sceneProxy.onPause();//播放广告暂停\r\n                            this.sceneProxy.playAdCallBack = adback;\r\n                            nextAction && (nextAction.paused = true);//暂停后续\r\n                            window.app.playAdVideo();//android apk 播放广告\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n                if (nextAction && nextAction.paused && i>=events.length) {\r\n                    // 遇到pay事件需暂停后续事件，所以在pay事件结束，pay所在的动作都完成后需调用后续动作callback\r\n                    nextAction.callback();\r\n                }\r\n                return true;\r\n            };\r\n            const keyUpCallback = (obj, event) => {\r\n                if (Expression.safeEval(event.expression, context)) {\r\n                    eventHandler(obj, event.events, 'onKeyUp');\r\n                }\r\n            };\r\n            const eventCallback = (obj, type,callfun) => {\r\n                let invokeEventInfo = [];\r\n                let events;\r\n                events = viewInfo.events;\r\n                if(obj.viewInfoName && obj.viewInfoName === 'g6Hsa9WoK8'){\r\n                    //播放广告\r\n                    if((events.length > 0 && events[0].name !== 'g6Hsa9WoK8') || events.length === 0){\r\n                        events.unshift({events:[{type: \"playad\", handle: {uuid: \"g6Hsa9WoK8\"}}],expression:{type:'playad',value:'ad'},name:'g6Hsa9WoK8',type:'onClick'});\r\n                    }\r\n                }\r\n                if (eventsInfo) {\r\n                    const parentEvents = Object.assign([], eventsInfo);\r\n                    parentEvents.forEach(es => es.events.forEach(e => e.isParent = true));\r\n                    events = parentEvents.concat(events);\r\n                }\r\n                for (let i in events) {\r\n                    if (events[i].type === type && events[i].type != 'onKeyUp') {\r\n                        invokeEventInfo[invokeEventInfo.length] = events[i];\r\n                    }\r\n                    else if (events[i].type === type && events[i].type === 'onKeyUp') {\r\n                        let code = events[i].keyCode;\r\n                        let key = this.sceneProxy.plotViewKeys && this.sceneProxy.plotViewKeys[code] ? this.sceneProxy.plotViewKeys[code]\r\n                            : this.sceneProxy.globalViewKeys && this.sceneProxy.globalViewKeys[code] ? this.sceneProxy.globalViewKeys[code] : undefined;\r\n                        if (key) {\r\n                            key.onUp.add(() => keyUpCallback(obj, events[i]));\r\n                        }\r\n                    }\r\n                }\r\n                let result = true;\r\n                const invokeHandler = events => {\r\n                    for (let v=0; v<events.length; v++) {\r\n                        if (events[v].expression.type === 'playad' || (events[v].expression.type !== 'playad' && Expression.safeEval(events[v].expression, context))) {\r\n                            const pausedCallback = () => { invokeHandler(events.slice(v+1)) };\r\n                            let nextAction = {paused: false, callback: pausedCallback};\r\n\r\n                            // 因遇到pay事件需暂停后续事件，所以在pay事件结束，pay所在的动作都完成后再执行后续动作callback\r\n                            if (!eventHandler(obj, events[v].events, type, nextAction)) {\r\n                                result = false;\r\n                                break;\r\n                            }\r\n                            else if (nextAction.paused) {\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                };\r\n                invokeHandler(invokeEventInfo);\r\n                if(callfun)callfun();\r\n                return result;\r\n            };\r\n            const onViewClicked = (obj, pointer) => {\r\n                if (obj.isHanding || this.sceneProxy.isPaying) {\r\n                    return;\r\n                }\r\n                if (pointer && pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n                    return;\r\n                }\r\n                obj.isHanding = true;\r\n                eventCallback(obj, 'onClick',()=>{obj.isHanding = false;});//eventcallback增加回调函数\r\n            };\r\n            const addItemClickedCallback = (obj) => {\r\n                obj.events.onInputDown.add(onViewClicked, this, 0, obj);\r\n            };\r\n            const onLoadCallback = (obj) => {\r\n                if (!isRefresh) {\r\n                    return eventCallback(obj, 'onLoad');\r\n                }\r\n                return true;\r\n            };\r\n            const onKeyUpCallback = (obj) => {\r\n                eventCallback(obj, 'onKeyUp');\r\n            };\r\n\r\n            if ('button' === viewInfo.type) {\r\n                let sound = null;\r\n                if (viewInfo.content.sound && viewInfo.content.sound.url) {\r\n                    sound = this.viewComponent.game.add.sound(viewInfo.content.sound.url, viewInfo.content.sound.volume, false);\r\n                }\r\n                const btn = this.viewComponent.addButton(pointX,\r\n                    pointY,\r\n                    viewInfo.width,\r\n                    viewInfo.height,\r\n                    viewInfo.content.background.normal.url,\r\n                    viewInfo.content.background.active.url,\r\n                    (btn, pointer) => onViewClicked(btn.parent, pointer),\r\n                    null,\r\n                    sound,\r\n                    null,\r\n                    containerLayer\r\n                );\r\n                onKeyUpCallback(btn.parent);\r\n                btn.viewInfoName = viewInfo.name;\r\n                containerLayer.viewType = 'BUTTON';\r\n                //result = onLoadCallback(btn.parent);\r\n                containerLayer.onLoadBack = {name: refUuid, instanceUuid: instanceUuid, object: btn.parent, callBack: onLoadCallback};//记录载入事件\r\n                !isload && this.sceneProxy.uiOnLoadQueue.push({name: refUuid, instanceUuid: instanceUuid, object: btn.parent, callBack: onLoadCallback});\r\n            }\r\n            else if ('image' === viewInfo.type) {\r\n                let img = this.viewComponent.game.add.image(pointX, pointY, viewInfo.content.background.url);\r\n                img.width = viewInfo.width;\r\n                img.height = viewInfo.height;\r\n                containerLayer.add(img);\r\n                img.viewInfoName = viewInfo.name;\r\n                addItemClickedCallback(img);\r\n                onKeyUpCallback(img);\r\n                this.viewComponent.addGifAnimation(img, viewInfo.content.background.url);\r\n\r\n                containerLayer.viewType = 'IMAGE';\r\n                //result = onLoadCallback(img);\r\n                containerLayer.onLoadBack = {name: refUuid, instanceUuid: instanceUuid, object: img, callBack: onLoadCallback};//记录载入事件\r\n                !isload && this.sceneProxy.uiOnLoadQueue.push({name: refUuid, instanceUuid: instanceUuid, object: img, callBack: onLoadCallback});\r\n            }\r\n            else if ('text' === viewInfo.type) {\r\n                let ff;\r\n                let fontStyle = {boundsAlignH: \"left\", boundsAlignV: \"bottom\", wordWrap: true};\r\n                ff = viewInfo.content.font_size + '';\r\n                if (ff.indexOf('px') < 0) {\r\n                    ff = ff + 'px';\r\n                }\r\n                if (viewInfo.content.bold === true) {\r\n                    ff = 'bold ' + ff + ' ' + viewInfo.content.fontFamily;\r\n                }\r\n                else {\r\n                    if (viewInfo.content.fontFamily) {\r\n                        ff = ff + ' ' + viewInfo.content.fontFamily;\r\n                    }\r\n                    else if (this.sceneProxy.json_data.font) {\r\n                        ff = ff + ' ' + this.sceneProxy.json_data.font.fontFamily;\r\n                    }\r\n                }\r\n\r\n                fontStyle.font = ff;\r\n                fontStyle.fill = viewInfo.content.color;\r\n                fontStyle.wordWrapWidth = viewInfo.width;\r\n\r\n                let txt = this.viewComponent.game.add.text(pointX, pointY, '', fontStyle, containerLayer);\r\n                let str = '';\r\n                if (Expression.isArray(viewInfo.content.value)) {\r\n                    viewInfo.content.value.forEach(v => str += Expression.parseValue(v.data, context));\r\n                    this.sceneProxy.addImageFontTextColors(viewInfo.content.value, txt, context);\r\n                    if (FontUtils.fontFamily) {\r\n                        const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(viewInfo.content.font_size) : viewInfo.content.font_size;\r\n                        const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(viewInfo.content.font_size) : viewInfo.content.font_size;\r\n                        this.sceneProxy.addImageFontText(viewInfo.content.value, fw, fh, txt, context);\r\n                    }\r\n                }\r\n                else {\r\n                    str = Expression.parseValue(viewInfo.content.value, context);\r\n                }\r\n                txt.inputEnabled = true;\r\n                txt.input.useHandCursor = true;\r\n                txt.useAdvancedWrap = true;\r\n                txt.lineSpacing = this.sceneProxy.txtLineSpace(viewInfo.content.font_size);\r\n                txt.updateText = RePhaser.updateText;\r\n                txt.advancedWordWrap = RePhaser.advancedWordWrap;\r\n                if (FontUtils.fontFamily) {\r\n                    txt.children.forEach(v => {v.visible = true});\r\n                    txt.text = ' ';\r\n                }\r\n                else {\r\n                    txt.text = str;\r\n                }\r\n                addItemClickedCallback(txt);\r\n                onKeyUpCallback(txt);\r\n                containerLayer.viewType = 'TEXT';\r\n                //result = onLoadCallback(txt);\r\n                containerLayer.onLoadBack = {name: refUuid, instanceUuid: instanceUuid, object: txt, callBack: onLoadCallback};//记录载入事件\r\n                !isload && this.sceneProxy.uiOnLoadQueue.push({name: refUuid, instanceUuid: instanceUuid, object: txt, callBack: onLoadCallback});\r\n                const eventsInfoCopy = eventsInfo ? eventsInfo : [];\r\n                const clickEvent = [...viewInfo.events, ...eventsInfoCopy].filter(a => a.type === 'onClick');\r\n                !clickEvent.length && (txt.inputEnabled = false);\r\n            }\r\n            else if ('bar' === viewInfo.type) {\r\n                let bkImg = this.viewComponent.game.add.sprite(pointX, pointY, viewInfo.content.background.normal.url);\r\n                bkImg.width = viewInfo.width;\r\n                bkImg.height = viewInfo.height;\r\n                containerLayer.add(bkImg);\r\n                addItemClickedCallback(bkImg);\r\n                this.viewComponent.addGifAnimation(bkImg, viewInfo.content.background.normal.url);\r\n\r\n                let bkPrgs = this.viewComponent.game.add.sprite(pointX// + viewInfo.content.basePoint.x\r\n                    , pointY// + viewInfo.content.basePoint.y\r\n                    , viewInfo.content.background.progress.url);\r\n                bkPrgs.width = viewInfo.width;\r\n                bkPrgs.height = viewInfo.height;\r\n                containerLayer.add(bkPrgs);\r\n                addItemClickedCallback(bkPrgs);\r\n                this.viewComponent.addGifAnimation(bkPrgs, viewInfo.content.background.progress.url);\r\n\r\n                let mask = this.viewComponent.game.add.graphics(pointX, pointY);\r\n                mask.beginFill(0xffffff);\r\n                mask.drawRect(0, 0, viewInfo.width, viewInfo.height);\r\n                mask.endFill();\r\n                containerLayer.add(mask);\r\n                bkPrgs.mask = mask;\r\n                addItemClickedCallback(mask);\r\n                onKeyUpCallback(mask);\r\n\r\n                let hType = '';\r\n                let vType = '';\r\n\r\n                if (viewInfo.content.basePoint.x === 0) {hType = 'left';}\r\n                else if (viewInfo.content.basePoint.x === viewInfo.width) {hType = 'right';}\r\n                else {hType = 'middle';}\r\n\r\n                if (viewInfo.content.basePoint.y === 0) {vType = 'top';}\r\n                else if (viewInfo.content.basePoint.y === viewInfo.height) {vType = 'bottom';}\r\n                else {vType = 'center';}\r\n\r\n                const {prgsViews} = this.sceneProxy;\r\n                let index = 0;\r\n                for (; index<prgsViews.length; index++) {\r\n                    if (prgsViews[index].uuid === viewInfo.uuid && prgsViews[index].layer.children.length === 0) {\r\n                        break;\r\n                    }\r\n                }\r\n                prgsViews[index] = {uuid: viewInfo.uuid\r\n                    , layer: containerLayer\r\n                    , type: hType + '-' + vType\r\n                    , content: viewInfo.content};\r\n\r\n                this.updateProgressView();\r\n                containerLayer.viewType = 'BAR';\r\n                //result = onLoadCallback(mask);\r\n                containerLayer.onLoadBack = {name: refUuid, instanceUuid: instanceUuid, object: mask, callBack: onLoadCallback};//记录载入事件\r\n                !isload && this.sceneProxy.uiOnLoadQueue.push({name: refUuid, instanceUuid: instanceUuid, object: mask, callBack: onLoadCallback});\r\n            }\r\n            else if ('input' === viewInfo.type) {\r\n                const initValue = Expression.safeEval(viewInfo.content.value, context);\r\n                let textBoxElement = new TextBox.HtmlTextBox(this.viewComponent.game\r\n                    , pointX, pointY\r\n                    , viewInfo.width, viewInfo.height\r\n                    , initValue\r\n                    , viewInfo.content.color\r\n                    , viewInfo.content.font_size\r\n                    , viewInfo.content.fontFamily ? viewInfo.content.fontFamily : this.sceneProxy.json_data.font ? this.sceneProxy.json_data.font.fontFamily : ''\r\n                    , viewInfo.content.bold ? viewInfo.content.bold : null);\r\n\r\n                if ('[未知数值]' === initValue) {\r\n                    textBoxElement.setEnable(false);\r\n                }\r\n\r\n                const inputCallback = (text)=>{\r\n                    const v = text;\r\n                    const uuid = viewInfo.content.value.arg1;\r\n                    const updateValue = (index, v, type) => {\r\n                        let realV = '';\r\n                        for (let i=0; i<v.length; i++) {\r\n                            if (v[i]>='0' && v[i]<='9' || v[i] === '.' && i !== 0) {\r\n                                realV += v[i];\r\n                            }\r\n                        }\r\n                        let vv = parseFloat(realV);\r\n                        vv = vv ? vv : 0;\r\n                        if (vv < -99999999999999) {\r\n                            vv = -99999999999999;\r\n                        }\r\n                        else if (vv > 99999999999999) {\r\n                            vv = 99999999999999;\r\n                        }\r\n                        if (type === 'value') {\r\n                            this.sceneProxy.context.values[index].value = vv;\r\n                        } else if (type === 'savedValue') {\r\n                            this.sceneProxy.context.savedValues[index].value = vv;\r\n                        }\r\n                        textBoxElement.isValue = true;\r\n                        if (parseFloat(realV) !== vv && 0 !== vv) {\r\n                            textBoxElement.text = vv + '';\r\n                        }\r\n                        else if (realV !== v) {\r\n                            textBoxElement.text = realV;\r\n                        }\r\n                    };\r\n                    let index;\r\n                    if ((index = context.values.findIndex(v => v.uuid === uuid)) !== -1) {\r\n                        updateValue(index, v, 'value');\r\n                    }\r\n                    else if ((index = context.savedValues.findIndex(v => v.uuid === uuid)) !== -1) {\r\n                        updateValue(index, v, 'savedValue');\r\n                    }\r\n                    else if ((index = context.stringValues.findIndex(v => v.uuid === uuid)) !== -1) {\r\n                        context.stringValues[index].value = v;\r\n                    }\r\n                    else if ((index = context.indexValues.findIndex(v => v.uuid === uuid)) !== -1) {\r\n                        const ri = (context.indexValues[index].value === undefined ? Expression.safeInitValue(context.indexValues[index], context) : context.indexValues[index].value) - 1;\r\n                        if (context.indexValues[index].init.type === 'value') {\r\n                            updateValue(ri, v, 'value');\r\n                        }\r\n                        else if (context.indexValues[index].init.type === 'savedValue') {\r\n                            updateValue(ri, v, 'savedValue');\r\n                        }\r\n                        else if (context.indexValues[index].init.type === 'stringValue') {\r\n                            context.stringValues[ri].value = v;\r\n                        }\r\n                    }\r\n                };\r\n\r\n                textBoxElement.setInputCallback(inputCallback);\r\n                textBoxElement.setClickCallback(onViewClicked);\r\n                textBoxElement.mgrParent = containerLayer;\r\n                containerLayer.inputElement = textBoxElement;\r\n                onKeyUpCallback(textBoxElement);\r\n                containerLayer.viewType = 'INPUT';\r\n                //result = onLoadCallback(textBoxElement);\r\n                containerLayer.onLoadBack = {name: refUuid, instanceUuid: instanceUuid, object: textBoxElement, callBack: onLoadCallback};//记录载入事件\r\n                !isload && this.sceneProxy.uiOnLoadQueue.push({name: refUuid, instanceUuid: instanceUuid, object: textBoxElement, callBack: onLoadCallback});\r\n            }\r\n            else if ('timer' === viewInfo.type) {\r\n                const sceneProxy = this.sceneProxy;\r\n                let img = this.viewComponent.game.add.image(0, 0, null);\r\n                containerLayer.add(img);\r\n                containerLayer.currentCount = 0;\r\n\r\n                const isStepCanSkip = () => {\r\n                    if (sceneProxy.playPause) {\r\n                        // 菜单可见 则不可跳过菜单中的计时器\r\n                        for (let i=0; i<sceneProxy.menuTimer.length; i++) {\r\n                            if (sceneProxy.menuTimer[i] === containerLayer.name) {\r\n                                return false;\r\n                            }\r\n                        }\r\n                        return true;\r\n                    }\r\n                    else {\r\n                        // 菜单不可见  则可跳过菜单中的计时器\r\n                        for (let i=0; i<sceneProxy.menuTimer.length; i++) {\r\n                            if (sceneProxy.menuTimer[i] === containerLayer.name) {\r\n                                return true;\r\n                            }\r\n                        }\r\n                        return false;\r\n                    }\r\n                };\r\n                const onStepTimeOut = () => {\r\n                    return function () {\r\n                        if (isStepCanSkip()) {\r\n                            containerLayer.timerHandler = setTimeout(onStepTimeOut(), viewInfo.content.step.value);\r\n                            return;\r\n                        }\r\n                        if (containerLayer.currentCount++ < viewInfo.content.count.value) {\r\n                            eventCallback(img, 'onStep');\r\n                            containerLayer.timerHandler = setTimeout(onStepTimeOut(), viewInfo.content.step.value);\r\n                        }\r\n                    }\r\n                };\r\n\r\n                const onStepInterval = () => {\r\n                    return function () {\r\n                        if (isStepCanSkip()) {\r\n                            return;\r\n                        }\r\n                        eventCallback(img, 'onStep');\r\n                    }\r\n                };\r\n\r\n                if (viewInfo.content.count.value === 0) {\r\n                    containerLayer.timerHandler = setInterval(onStepInterval(), viewInfo.content.step.value);\r\n                    containerLayer.timerType = 'timeInterval';\r\n                } else {\r\n                    containerLayer.timerHandler = setTimeout(onStepTimeOut(), viewInfo.content.step.value);\r\n                    containerLayer.timerType = 'timeOut';\r\n                }\r\n\r\n                // 读档还原计时器已计时次数\r\n                for (let i=0; i<this.sceneProxy.timerCounts.length; i++) {\r\n                    const item = this.sceneProxy.timerCounts[i];\r\n                    if (containerLayer.name === item.name && item.parent === parentLayer.name) {\r\n                        containerLayer.currentCount = item.currentCount;\r\n                        this.sceneProxy.timerCounts.splice(i,1);\r\n                        break;\r\n                    }\r\n                }\r\n                // 主菜单可见 判断为计时器是主菜单子控件\r\n                this.sceneProxy.mainMenuLayer.visible && (this.sceneProxy.menuTimer[this.sceneProxy.menuTimer.length] = refUuid)\r\n                containerLayer.viewType = 'TIMER';\r\n                containerLayer.onLoadBack = {name: refUuid, instanceUuid: instanceUuid, object: img, callBack: onLoadCallback};//记录载入事件\r\n                !isload && this.sceneProxy.uiOnLoadQueue.push({name: refUuid, instanceUuid: instanceUuid, object: img, callBack: onLoadCallback});\r\n            }\r\n            else if ('container' === viewInfo.type) {\r\n                let bk = null;\r\n                if (viewInfo.content.background.url) {\r\n                    bk = this.viewComponent.game.add.image(pointX, pointY, viewInfo.content.background.url);\r\n                    bk.width = viewInfo.width;\r\n                    bk.height = viewInfo.height;\r\n                } else {\r\n                    bk = this.viewComponent.game.add.graphics(0, 0);\r\n                    bk.beginFill(0x0, 1);\r\n                    bk.drawRect(pointX, pointY, viewInfo.width, viewInfo.height);\r\n                    bk.endFill();\r\n                    bk.alpha = 0;\r\n                }\r\n\r\n                containerLayer.add(bk);\r\n                addItemClickedCallback(bk);\r\n                onKeyUpCallback(bk);\r\n                containerLayer.viewType = 'CONTAINER';\r\n                containerLayer.onLoadBack = {name: refUuid, instanceUuid: instanceUuid, object: bk, callBack: onLoadCallback};//记录载入事件\r\n                !isload && this.sceneProxy.uiOnLoadQueue.push({name: refUuid, instanceUuid: instanceUuid, object: bk, callBack: onLoadCallback});\r\n                for (let i in viewInfo.children) {\r\n                    const child = this.addView(containerLayer, viewInfo.children[i].ref, viewInfo.children[i].instanceUuid, viewInfo.children[i].x, viewInfo.children[i].y, viewInfo.children[i].events, isRefresh,isload,diymenu);\r\n                    const scalechild = ()=>{\r\n                        child.x += pointX;\r\n                        child.y += pointY;\r\n                        if (viewInfo.children[i].scale) {\r\n                            child.scale.set(viewInfo.children[i].scale, viewInfo.children[i].scale);\r\n                            child.x += Expression.safeEval(viewInfo.children[i].x, context) * (1 - viewInfo.children[i].scale);\r\n                            child.y += Expression.safeEval(viewInfo.children[i].y, context) * (1 - viewInfo.children[i].scale);\r\n                        }\r\n\r\n                        if (child.inputElement) {\r\n                            child.inputElement.x += pointX;\r\n                            child.inputElement.y += pointY;\r\n\r\n                            if (viewInfo.children[i].scale) {\r\n                                child.inputElement.fontSize *= viewInfo.children[i].scale;\r\n                                child.inputElement.width *= viewInfo.children[i].scale;\r\n                                child.inputElement.height = child.inputElement.fontSize;\r\n                            }\r\n                            else {\r\n                                child.inputElement.update();\r\n                            }\r\n                        }\r\n                    }\r\n                    if (!child) {\r\n                        return false;\r\n                    };\r\n                    scalechild();\r\n                }\r\n\r\n                //result = onLoadCallback(bk);\r\n            }\r\n\r\n            return result ? containerLayer : result;\r\n\t\t},\r\n\r\n\t\tuiOnLoadInvoker: function () {\r\n\t\t\twhile (0 < this.sceneProxy.uiOnLoadQueue.length) {\r\n\t\t\t\tlet item = this.sceneProxy.uiOnLoadQueue[0];\r\n\t\t\t\tthis.sceneProxy.uiOnLoadQueue.splice(0, 1);\r\n\t\t\t\titem.callBack(item.object);\r\n\t\t\t}\r\n        },\r\n\r\n\t\tupdateProgressView: function () {\r\n\t\t\tfor (let i = 0; i < this.sceneProxy.prgsViews.length; i++) {\r\n\t\t\t\tconst prgs = this.sceneProxy.prgsViews[i];\r\n\t\t\t\tif (!prgs.layer.children.length) { continue; }\r\n\r\n\t\t\t\tconst bkImg = prgs.layer.children[0];\r\n\t\t\t\tconst bkPrgs = prgs.layer.children[1];\r\n\t\t\t\tconst mask = prgs.layer.children[2];\r\n\t\t\t\tconst nWidth = this.sceneProxy.Expression.safeEval(prgs.content.value.normal.width, this.sceneProxy.context);\r\n\t\t\t\tconst nHeight = this.sceneProxy.Expression.safeEval(prgs.content.value.normal.height, this.sceneProxy.context);\r\n\t\t\t\tconst pWidth = this.sceneProxy.Expression.safeEval(prgs.content.value.progress.width, this.sceneProxy.context);\r\n\t\t\t\tconst pHeight = this.sceneProxy.Expression.safeEval(prgs.content.value.progress.height, this.sceneProxy.context);\r\n\t\t\t\tconst update = (obj, x, y, width, height) => {\r\n\t\t\t\t\tif (obj.isMask) {\r\n\t\t\t\t\t\tobj.destroy();\r\n\t\t\t\t\t\tobj = this.viewComponent.game.add.graphics(x, y);\r\n\t\t\t\t\t\tobj.beginFill(0xffffff);\r\n\t\t\t\t\t\tobj.drawRect(0, 0, width, height);\r\n\t\t\t\t\t\tobj.endFill();\r\n\t\t\t\t\t\tobj.inputEnabled = false;\r\n\t\t\t\t\t\tprgs.layer.add(obj);\r\n\t\t\t\t\t\tbkPrgs.mask = obj;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tobj.x = x;\r\n\t\t\t\t\t\tobj.y = y;\r\n\t\t\t\t\t\tobj.width = width;\r\n\t\t\t\t\t\tobj.height = height;\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\tlet mover = prgs.content.style === 'clip' ? mask : bkPrgs;\r\n\t\t\t\tconst w = Math.min(nWidth === 0 ? 0 : pWidth * bkImg.width / nWidth, bkImg.width);\r\n\t\t\t\tconst h = Math.min(nHeight ===0 ? 0 : pHeight * bkImg.height / nHeight, bkImg.height);\r\n\r\n\t\t\t\tswitch (prgs.type) {\r\n\t\t\t\t\tcase 'left-top':\r\n\t\t\t\t\t\tupdate(mover, bkImg.x, bkImg.y, w, h);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'middle-top':\r\n\t\t\t\t\t\tupdate(mover, bkImg.x+(bkImg.width-w)/2, bkImg.y, w, h);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'right-top':\r\n\t\t\t\t\t\tupdate(mover, bkImg.x+bkImg.width-w, bkImg.y, w, h);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'left-center':\r\n\t\t\t\t\t\tupdate(mover, bkImg.x, bkImg.y+(bkImg.height-h)/2, w, h);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'middle-center':\r\n\t\t\t\t\t\tupdate(mover, bkImg.x+(bkImg.width-w)/2, bkImg.y+(bkImg.height-h)/2, w, h);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'right-center':\r\n\t\t\t\t\t\tupdate(mover, bkImg.x+bkImg.width-w, bkImg.y+(bkImg.height-h)/2, w, h);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'left-bottom':\r\n\t\t\t\t\t\tupdate(mover, bkImg.x, bkImg.y+bkImg.height-h, w, h);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'middle-bottom':\r\n\t\t\t\t\t\tupdate(mover, bkImg.x+(bkImg.width-w)/2, bkImg.y+bkImg.height-h, w, h);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'right-bottom':\r\n\t\t\t\t\t\tupdate(mover, bkImg.x+bkImg.width-w,  bkImg.y+bkImg.height-h, w, h);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tdestroyView: function (viewLayerName, bCloseMainMenu) {\r\n\t\t\tconst destroyInChild = (child, name) => {\r\n\t\t\t\tif (child.name && child.name === name || child.instanceUuid && child.instanceUuid === name) {\r\n                    this.removeViewKeyByInstance(child, this.sceneProxy.plotViewKeys); // 组件销毁前，移除其按键事件\r\n                    this.sceneProxy.removeInputView(child);\r\n                    this.sceneProxy.removeViewTimer(child);\r\n                    child.destroy();\r\n\t\t\t\t\tif (child.isMenu && bCloseMainMenu) {\r\n\t\t\t\t\t\tthis.sceneProxy.onMainMenuBackBtnClicked();\r\n\t\t\t\t\t\tthis.sceneProxy.mainMenuLayer.removeAll(true, false, true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\telse if (child.children && child.children.length > 0) {\r\n\t\t\t\t\tfor (let i=0; i<child.children.length; i++) {\r\n\t\t\t\t\t\tdestroyInChild(child.children[i], name) && i--;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\t\t\tdestroyInChild(this.viewComponent.game.world, viewLayerName);\r\n\t\t},\r\n\r\n        showInputView: function (layer, bShow) {\r\n            if (layer.inputElement) {\r\n                layer.inputElement.show(bShow);\r\n            }\r\n            else if (layer.children && layer.children.length) {\r\n                for (let i=0; i<layer.children.length; i++) {\r\n                    this.showInputView(layer.children[i], bShow);\r\n                }\r\n            }\r\n        },\r\n\r\n\t\tscaleInputView: function (layer, scale) {\r\n\t\t\tif (layer.inputElement) {\r\n                layer.inputElement.fontSize *= scale;\r\n                layer.inputElement.width *= scale;\r\n\t\t\t\tlayer.inputElement.height = layer.inputElement.fontSize + 6;\r\n\t\t\t\t// 无需移动位置\r\n\t\t\t\t//layer.inputElement.x = layer.inputElement._x + this.sceneProxy.Expression.safeEval(layer.xInfo, this.sceneProxy.context) * (scale - 1);\r\n\t\t\t\t//layer.inputElement.y = layer.inputElement._y + this.sceneProxy.Expression.safeEval(layer.yInfo, this.sceneProxy.context) * (scale - 1);\r\n\t\t\t\tlayer.inputElement.update();\r\n\t\t\t}\r\n\t\t\telse if (layer.children && layer.children.length) {\r\n\t\t\t\tfor (let i=0; i<layer.children.length; i++) {\r\n\t\t\t\t\tthis.scaleInputView(layer.children[i], scale);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n        /**组件刷新*/\r\n\t\trefreshView: function (refUuid, bReload) {\r\n\r\n\t\t\tconst getRefreshViews = (view, refUuid) => {\r\n\t\t\t\tlet views = [];\r\n\t\t\t\tif (view.name && view.name === refUuid) {\r\n\t\t\t\t\tviews.push(view);\r\n\t\t\t\t} else {\r\n                    views = view.children.reduce((r, c) => r.concat(getRefreshViews(c, refUuid)), []);\r\n\t\t\t\t}\r\n\t\t\t\treturn views;\r\n\t\t\t};\r\n\t\t\tlet newViews = [];\r\n\t\t\tconst refreshViews = getRefreshViews(this.viewComponent.game.world, refUuid);\r\n            if(bReload){\r\n                //载入\r\n                if (refreshViews.length > 0) {\r\n                    const {viewMap} = this.sceneProxy.json_data;\r\n                    const events = viewMap[refUuid].events;\r\n                    for (let e in events) {\r\n                        if (events[e].type === 'onKeyUp') {\r\n                            this.sceneProxy.plotViewKeys[events[e].keyCode].onUp.removeAll();\r\n                        }\r\n                    }\r\n                }\r\n                refreshViews.forEach(oldView => {\r\n                    const {xInfo, yInfo, scale, isGlobal, children, instanceUuid} = oldView;\r\n\r\n                    for (let e in oldView.eventsInfo) {\r\n                        if (oldView.eventsInfo[e].type === 'onKeyUp') {\r\n                            this.sceneProxy.plotViewKeys[oldView.eventsInfo[e].keyCode].onUp.removeAll();\r\n                        }\r\n                    }\r\n\r\n                    const newView = this.addView(oldView.parent, refUuid, instanceUuid, xInfo, yInfo, oldView.eventsInfo, !bReload);\r\n                    if (!newView) {\r\n                        return;\r\n                    }\r\n\r\n                    this.viewComponent.game.world.add(newView);\r\n\r\n                    for (let n=0; n<children.length; n++) {\r\n                        let bExist = false;\r\n                        for (let c in newView.children) {\r\n                            if (newView.children[c].name === children[n].name) {\r\n                                bExist = true;\r\n                                break;\r\n                            }\r\n                        }\r\n\r\n                        if (!bExist && !bReload) {\r\n                            //this.addView(newView, children[n].name, children[n].instanceUuid, children[n].xInfo, children[n].yInfo, null, !bReload);\r\n                            newView.addChild(children[n]);\r\n                            n -= 1;\r\n                        }\r\n                    }\r\n\r\n                    if (oldView.parent.viewType === 'CONTAINER') {\r\n                        newView.x += this.sceneProxy.Expression.safeEval(oldView.parent.xInfo, this.sceneProxy.context);\r\n                        newView.y += this.sceneProxy.Expression.safeEval(oldView.parent.yInfo, this.sceneProxy.context);\r\n                    }\r\n\r\n                    if (scale) {\r\n                        newView.scale.set(scale.x, scale.y);\r\n                        newView.x += this.sceneProxy.Expression.safeEval(xInfo, this.sceneProxy.context) * (1 - scale.x);\r\n                        newView.y += this.sceneProxy.Expression.safeEval(yInfo, this.sceneProxy.context) * (1 - scale.y);\r\n                        this.scaleInputView(newView, scale.x);\r\n                    }\r\n\r\n                    if (isGlobal) {\r\n                        newView.isGlobal = true;\r\n                        const index = this.sceneProxy.globalViews.findIndex(v => v.name === refUuid);\r\n                        this.sceneProxy.globalViews.splice(index, 1, newView);\r\n                    }\r\n\r\n                    if (oldView.isMenu) {\r\n                        newView.isMenu = true;\r\n                    }\r\n\r\n                    if (oldView.parent && oldView.parent.name === 'plotViewsLayer') {\r\n                        const oldIndex = this.sceneProxy.plotViews.indexOf(oldView);\r\n                        this.sceneProxy.plotViews.splice(oldIndex, 1, newView);\r\n                    }\r\n                    this.sceneProxy.removeViewTimer(oldView);\r\n                    oldView.parent.replace(oldView, newView).destroy();\r\n                    newViews.push(newView);\r\n                });\r\n            }else{\r\n                refreshViews.forEach(view =>{\r\n                    let views = {sx:0,sy:0};\r\n                    const refresh =(v,refxy)=>{\r\n                        newViews.push(v);//刷新的组件\r\n                        let cws = {sx:0,sy:0};\r\n                        const getScaleValue = (vv)=>{\r\n                            let point = {sx:0,sy:0};\r\n                            if(vv.scale && vv.xInfo && vv.yInfo){\r\n                                point.sx = this.sceneProxy.Expression.safeEval(vv.xInfo, this.sceneProxy.context) * (1 - vv.scale.x);\r\n                                point.sy = this.sceneProxy.Expression.safeEval(vv.yInfo, this.sceneProxy.context) * (1 - vv.scale.y);\r\n                            }\r\n                            return point;\r\n                        }\r\n                        if(refxy === true){\r\n                            views = getScaleValue(v);\r\n                        }\r\n                        const viewInfo = this.sceneProxy.json_data.viewMap[v.parent.name];\r\n                        if(v.parent){\r\n                            let vx = 0;\r\n                            let vy = 0;\r\n                            if(v.parent.xInfo && v.parent.yInfo){\r\n                                vx = this.sceneProxy.Expression.safeEval(v.parent.xInfo, this.sceneProxy.context);\r\n                                vy = this.sceneProxy.Expression.safeEval(v.parent.yInfo, this.sceneProxy.context);\r\n                                if(v.parent.viewType === 'CONTAINER'){\r\n                                    cws = getScaleValue(v);\r\n                                    vx += (cws.sx);\r\n                                    vy += (cws.sy);\r\n                                }\r\n                                v.x = vx;\r\n                                v.y = vy;\r\n                            }else{\r\n                                if(refxy === true){\r\n                                    v.x = views.sx;\r\n                                    v.y = views.sy;\r\n                                }\r\n                            }\r\n                            if(v.parent.viewType === 'BAR'){\r\n                                let hType = '';\r\n                                let vType = '';\r\n                                if (viewInfo.content.basePoint.x === 0) {hType = 'left';}\r\n                                else if (viewInfo.content.basePoint.x === viewInfo.width) {hType = 'right';}\r\n                                else {hType = 'middle';}\r\n                                if (viewInfo.content.basePoint.y === 0) {vType = 'top';}\r\n                                else if (viewInfo.content.basePoint.y === viewInfo.height) {vType = 'bottom';}\r\n                                else {vType = 'center';}\r\n                                const type = hType + '-' + vType;\r\n                                const bkImg = v.parent.children[0];\r\n                                const bkPrgs = v.parent.children[1];\r\n                                const mask = v.parent.children[2];\r\n                                const layer = v.parent;\r\n                                const nWidth = this.sceneProxy.Expression.safeEval(viewInfo.content.value.normal.width, this.sceneProxy.context);\r\n                                const nHeight = this.sceneProxy.Expression.safeEval(viewInfo.content.value.normal.height, this.sceneProxy.context);\r\n                                const pWidth = this.sceneProxy.Expression.safeEval(viewInfo.content.value.progress.width, this.sceneProxy.context);\r\n                                const pHeight = this.sceneProxy.Expression.safeEval(viewInfo.content.value.progress.height, this.sceneProxy.context);\r\n                                const update = (obj, x, y, width, height) => {\r\n                                    if (obj.isMask) {\r\n                                        obj.destroy();\r\n                                        obj = this.viewComponent.game.add.graphics(x, y);\r\n                                        obj.beginFill(0xffffff);\r\n                                        obj.drawRect(0, 0, width, height);\r\n                                        obj.endFill();\r\n                                        obj.inputEnabled = false;\r\n                                        layer.add(obj);\r\n                                        bkPrgs.mask = obj;\r\n                                    } else {\r\n                                        obj.x = x;\r\n                                        obj.y = y;\r\n                                        obj.width = width;\r\n                                        obj.height = height;\r\n                                    }\r\n                                };\r\n\r\n                                let mover = viewInfo.content.style === 'clip' ? mask : bkPrgs;\r\n                                if(!mover) return;\r\n                                const w = Math.min(pWidth * bkImg.width / nWidth, bkImg.width);\r\n                                const h = Math.min(pHeight * bkImg.height / nHeight, bkImg.height);\r\n                                switch (type) {\r\n                                    case 'left-top':\r\n                                        update(mover, bkImg.x, bkImg.y, w, h);\r\n                                        break;\r\n                                    case 'middle-top':\r\n                                        update(mover, bkImg.x+(bkImg.width-w)/2, bkImg.y, w, h);\r\n                                        break;\r\n                                    case 'right-top':\r\n                                        update(mover, bkImg.x+bkImg.width-w, bkImg.y, w, h);\r\n                                        break;\r\n                                    case 'left-center':\r\n                                        update(mover, bkImg.x, bkImg.y+(bkImg.height-h)/2, w, h);\r\n                                        break;\r\n                                    case 'middle-center':\r\n                                        update(mover, bkImg.x+(bkImg.width-w)/2, bkImg.y+(bkImg.height-h)/2, w, h);\r\n                                        break;\r\n                                    case 'right-center':\r\n                                        update(mover, bkImg.x+bkImg.width-w, bkImg.y+(bkImg.height-h)/2, w, h);\r\n                                        break;\r\n                                    case 'left-bottom':\r\n                                        update(mover, bkImg.x, bkImg.y+bkImg.height-h, w, h);\r\n                                        break;\r\n                                    case 'middle-bottom':\r\n                                        update(mover, bkImg.x+(bkImg.width-w)/2, bkImg.y+bkImg.height-h, w, h);\r\n                                        break;\r\n                                    case 'right-bottom':\r\n                                        update(mover, bkImg.x+bkImg.width-w,  bkImg.y+bkImg.height-h, w, h);\r\n                                        break;\r\n                                }\r\n                            }\r\n                            else if(v.parent.viewType === 'INPUT' ){\r\n                                const initValue = this.sceneProxy.Expression.safeEval(viewInfo.content.value, this.sceneProxy.context);\r\n                                v.parent.inputElement.text = initValue;\r\n                            }\r\n                            else if(v.parent.viewType === 'TEXT'){\r\n                                const txt = v.parent.children[0];\r\n                                let str = '';\r\n                                if (this.sceneProxy.Expression.isArray(viewInfo.content.value)) {\r\n                                    viewInfo.content.value.forEach(v => str += this.sceneProxy.Expression.parseValue(v.data, this.sceneProxy.context));\r\n                                    this.sceneProxy.addImageFontTextColors(viewInfo.content.value, txt, this.sceneProxy.context);\r\n                                    if (FontUtils.fontFamily) {\r\n                                        const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(viewInfo.content.font_size) : viewInfo.content.font_size;\r\n                                        const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(viewInfo.content.font_size) : viewInfo.content.font_size;\r\n                                        this.sceneProxy.addImageFontText(viewInfo.content.value, fw, fh, txt, this.sceneProxy.context);\r\n                                    }\r\n                                }else {\r\n                                    str = this.sceneProxy.Expression.parseValue(viewInfo.content.value, this.sceneProxy.context);\r\n                                }\r\n                                if (FontUtils.fontFamily) {\r\n                                    txt.children.forEach(v => {v.visible = true});\r\n                                    txt.text = ' ';\r\n                                }\r\n                                else {\r\n                                    txt.text = str;\r\n                                }\r\n                            }\r\n                        }\r\n                        if(v.children && v.children.length > 0){\r\n                            for(let i =0;i<v.children.length;i++){\r\n                                refresh(v.children[i],false)\r\n                            }\r\n                        }\r\n                    }\r\n                    refresh(view,true)\r\n                })\r\n            }\r\n            return newViews;\r\n\t\t},\r\n\r\n\t\tbackgroundFlex: function (bkSprite, flex) {\r\n\t\t\tif (flex === 3) {// 填充\r\n\t\t\t\tlet rate = bkSprite.width / bkSprite.height < this.viewComponent.game.world.width / this.viewComponent.game.world.height ? this.viewComponent.game.world.width / bkSprite.width : this.viewComponent.game.world.height / bkSprite.height;\r\n\t\t\t\tbkSprite.width *= rate;\r\n\t\t\t\tbkSprite.height *= rate;\r\n\t\t\t\tbkSprite.x = -(bkSprite.width - this.viewComponent.game.world.width) / 2;\r\n\t\t\t\tbkSprite.y = -(bkSprite.height - this.viewComponent.game.world.height) / 2;\r\n\t\t\t}\r\n\t\t\telse if (flex === 5) {// 适应\r\n\t\t\t\tlet rate = 0;\r\n\t\t\t\tif (bkSprite.width / bkSprite.height > this.viewComponent.game.world.width / this.viewComponent.game.world.height) {\r\n\t\t\t\t\trate = this.viewComponent.game.world.width / bkSprite.width;\r\n\t\t\t\t\tbkSprite.width *= rate;\r\n\t\t\t\t\tbkSprite.height *= rate;\r\n\t\t\t\t\tbkSprite.y = (this.viewComponent.game.world.height - bkSprite.height) / 2;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\trate = this.viewComponent.game.world.height / bkSprite.height;\r\n\t\t\t\t\tbkSprite.width *= rate;\r\n\t\t\t\t\tbkSprite.height *= rate;\r\n\t\t\t\t\tbkSprite.x = (this.viewComponent.game.world.width - bkSprite.width) / 2;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tbkSprite.width = this.viewComponent.game.world.width;\r\n\t\t\t\tbkSprite.height = this.viewComponent.game.world.height;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\ttweenToPromise: function (obj, properties, duration, ease, autoStart, delay, repeat, yoyo) {\r\n\t\t\tduration = Math.max(duration, 1);\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tconst tween = this.viewComponent.game.add.tween(obj).to(properties\r\n\t\t\t\t\t, duration\r\n\t\t\t\t\t, ease, autoStart\r\n\t\t\t\t\t, delay, repeat, yoyo);\r\n\t\t\t\ttween.onComplete.add(() => resolve());\r\n\t\t\t\tthis.sceneProxy.lstPlotTweens.push(tween);\r\n                !obj.animateTweens && (obj.animateTweens = []);\r\n\t\t\t\t/*obj && 'dialogLayer' === obj.name && */obj.animateTweens.push(tween);\r\n                if(obj.parent && obj.parent.parent && obj.parent.parent.parent &&obj.parent.parent.parent.name === 'bubbleLayer'){\r\n                    obj.parent.parent.parent.animateTweens.push(tween);\r\n                }\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\ttweenFromPromise: function (obj, properties, duration, ease, autoStart, delay, repeat, yoyo) {\r\n            duration = Math.max(duration, 1);\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tconst tween = this.viewComponent.game.add.tween(obj).from(properties\r\n\t\t\t\t\t, duration\r\n\t\t\t\t\t, ease, autoStart\r\n\t\t\t\t\t, delay, repeat, yoyo);\r\n\t\t\t\ttween.onComplete.add(() => resolve());\r\n                this.sceneProxy.lstPlotTweens.push(tween);\r\n                !obj.animateTweens && (obj.animateTweens = []);\r\n                /*obj && 'dialogLayer' === obj.name && */obj.animateTweens.push(tween);\r\n                if(obj.parent && obj.parent.parent && obj.parent.parent.parent && obj.parent.parent.parent.name === 'bubbleLayer'){\r\n                    obj.parent.parent.parent.animateTweens.push(tween);\r\n                }\r\n\t\t\t})\r\n\t\t},\r\n\r\n        /**\r\n         * 显示气泡， 添加气泡显示区域边框\r\n         * @param layer\r\n         */\r\n        addBubbleBorder:function (layer,commands) {\r\n            if(!commands) return null;\r\n            const bdata = commands.args[0];\r\n            const border = this.viewComponent.game.add.group();\r\n            border.uuid = bdata.uuid;\r\n            border.remove = bdata.remove;\r\n            border.remark = bdata.remark;\r\n            border.index = bdata.index;\r\n            border.width = bdata.rect.width;\r\n            border.height = bdata.rect.height;\r\n            border.origialH = bdata.rect.height;\r\n            border.itemlength = 0; //开始的长度为0\r\n            border.bubbley = 0;//开始坐标\r\n            border.savebubble = [];//记录保留的气泡内容\r\n            border.curbubble = [];//当前显示的气泡内容\r\n            border.ishide = false;//是否隐藏\r\n            border.iscurrent = true; //是否是当前气泡\r\n            border.commands = commands;//存入指令\r\n            border.isdown = false;\r\n            border.x = bdata.rect.x;\r\n            border.y = bdata.rect.y;\r\n            layer && layer.addChild(border);\r\n            //气泡背景\r\n            let bg = null;\r\n            if(bdata.url !== '' && this.viewComponent.game.load.cache.checkImageKey(bdata.url)){\r\n                this.viewComponent.addFitImageSprint(0,0,\r\n                    bdata.rect.width,\r\n                    bdata.rect.height,\r\n                    bdata.url,\r\n                    border,\r\n                    bdata.index)\r\n            }else{\r\n                bg = this.viewComponent.game.add.graphics(0,0);\r\n                bg.beginFill(0xffffff,0);//透明背景\r\n                bg.drawRect(0,0,bdata.rect.width,bdata.rect.height);\r\n                bg.endFill();\r\n                border.addChild(bg);\r\n            }\r\n            const scrollPane = this.viewComponent.game.add.sprite(0,0); //用于拖动和存放发射气泡\r\n            scrollPane.name = 'borderScrollPane';\r\n            border.addChild(scrollPane);\r\n\r\n            //用于点击滚动的透明图\r\n            const scrollgraphics = this.viewComponent.game.add.graphics();\r\n            scrollgraphics.name = 'scrollgraphics';\r\n            scrollgraphics.beginFill(0xfff000,0);//透明背景\r\n            scrollgraphics.drawRect(0,0,0,0);\r\n            scrollgraphics.endFill();\r\n            scrollPane.addChild(scrollgraphics);\r\n\r\n            let dragStartPointX = 0,dragStartY = null;\r\n            let wheelEvent = false;\r\n            let startx=0,starty=0,updatex=0,updatey=0;\r\n            const getPoint = (pointer)=>{\r\n                    let x, y;\r\n                    let w = (window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth);\r\n                    let h = (window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight);\r\n                    if (w > h) {\r\n                        if(flashvars.vertical){\r\n                            x = pointer.worldY;\r\n                            y = -pointer.worldX;\r\n                        }else{\r\n                            x = pointer.worldX;\r\n                            y = pointer.worldY;\r\n                        }\r\n                    }\r\n                    else {\r\n                        if(flashvars.vertical){\r\n                            x = pointer.worldX;\r\n                            y = pointer.worldY;\r\n                        }else{\r\n                            x = pointer.worldY;\r\n                            y = -pointer.worldX;\r\n                        }\r\n                    }\r\n                    return {x,y};\r\n                }\r\n            const onScroll = (x,y) =>{\r\n                if(border.itemlength < bdata.rect.height){\r\n                    try{\r\n                        scrollPane.input.disableDrag();\r\n                    }catch (e){ }\r\n                    return;\r\n                }\r\n                if(y > 0){\r\n                    scrollPane.y = 0;\r\n                }else if(y < -(border.itemlength - bdata.rect.height)){\r\n                    scrollPane.y = -(border.itemlength - bdata.rect.height);\r\n                }else{\r\n                    scrollPane.y = y;\r\n                }\r\n            }\r\n            const onMove = (pointer, x, y) => {\r\n                const point = getPoint(pointer);\r\n                const mousewheelevt = (/Firefox/i.test(navigator.userAgent)) ? \"DOMMouseScroll\" : \"mousewheel\";\r\n                if (!point) {\r\n                    if (wheelEvent) {\r\n                        document.removeEventListener(mousewheelevt, onMouseWheel);\r\n                        wheelEvent = false;\r\n                    }\r\n                }\r\n                else {\r\n                    if (!wheelEvent) {\r\n                        document.addEventListener(mousewheelevt, onMouseWheel);\r\n                        wheelEvent = true;\r\n                    }\r\n                }\r\n            };\r\n            const onMouseWheel = e => {\r\n                const delta = e.wheelDelta ? e.wheelDelta / 120 : -e.detail / 3;\r\n                onScroll(0, scrollPane.y + delta * 100)\r\n            };\r\n            const onDragUpdate = (sprite, pointer, x, y, pt, bFromStart)=>{\r\n                    let w = (window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth);\r\n                    let h = (window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight);\r\n                    let px = x;\r\n                    let py = y;\r\n                    bFromStart && (dragStartPointX = x);\r\n                    dragStartY = scrollPane.y;\r\n                    if (w < h && dragStartY !== null) {\r\n                        py = dragStartY - x + dragStartPointX;\r\n                    }\r\n                    onScroll(px, py);\r\n                }\r\n            const onDragStart = (sprite, pointer, x, y, pt, bFromStart)=>{\r\n                dragStartPointX = x;\r\n                dragStartY = scrollPane.y;\r\n            };\r\n            const onDragStop = (sprite, pointer, x, y, pt, bFromStart)=>{\r\n                dragStartY = scrollPane.y;\r\n            }\r\n            const onItemUp = (m, pt) => {\r\n                updatex = this.viewComponent.game.input.x;\r\n                updatey = this.viewComponent.game.input.y;\r\n                if((Math.abs(startx-updatex) <=1 || Math.abs(starty - updatey) <=1) && border.isdown){\r\n                    border.isdown = false;\r\n                    if(this.sceneProxy.dialogNext !== null){\r\n                        this.sceneProxy.dialogNext();\r\n                    }\r\n                    border.gonext && border.gonext(border);\r\n                }\r\n                startx=0,starty=0,updatex=0,updatey=0;\r\n                border.isdown = false;\r\n            };\r\n            const onInputDown = (sprite,pointer)=>{\r\n                border.isdown = true;\r\n                startx = this.viewComponent.game.input.x;\r\n                starty = this.viewComponent.game.input.y;\r\n                if(!getPoint(pointer)){\r\n                    return sprite.input.disableDrag();\r\n                }\r\n                return sprite.input.enableDrag();\r\n            }\r\n            scrollPane.inputEnabled = true;\r\n            scrollPane.input.enableDrag();\r\n            scrollPane.input.allowHorizontalDrag = false;\r\n            scrollPane.events.onDragUpdate.add(onDragUpdate, this);\r\n            scrollPane.events.onDragStart.add(onDragStart, this);\r\n            scrollPane.events.onDragStop.add(onDragStop, this);\r\n            scrollPane.events.onInputDown.add(onInputDown, this);\r\n            scrollPane.events.onInputUp.add(onItemUp, this);\r\n            this.viewComponent.game.input.addMoveCallback(onMove, this);\r\n            //添加遮罩\r\n            let mask = this.viewComponent.game.add.graphics();\r\n            mask.beginFill(0,0);\r\n            mask.drawRect(0,0,bdata.rect.width,bdata.rect.height);\r\n            mask.endFill();\r\n            border.addChild(mask);\r\n            border.mask = mask;\r\n            border.scorllfun = onScroll;\r\n            layer && this.viewComponent.game.world.bringToTop(layer);\r\n            !this.sceneProxy.dialogLayer.isbottom && this.viewComponent.game.world.bringToTop(this.sceneProxy.dialogLayer)\r\n            this.viewComponent.game.world.bringToTop(this.sceneProxy.plotViewsLayer);\r\n            if(this.sceneProxy.menuLayer.children.length > 0)this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n            this.sceneProxy.quickPlayLayer.alpha && this.viewComponent.game.world.bringToTop(this.sceneProxy.quickPlayLayer);\r\n            return border;\r\n        },\r\n\r\n        /**\r\n         * 生成气泡\r\n         * @param bdata\r\n         * @param border  边框\r\n         */\r\n        createBubble:function (cmds,border) {\r\n            return new Promise((resolve,reject) =>{\r\n                const group = this.viewComponent.game.add.group();\r\n                group.commands = cmds;\r\n                const bdata = cmds.args[0];\r\n                const {type,content,avatar,role,position} = bdata;\r\n                const bubbleborder = border.getByName('borderScrollPane');\r\n                const scrollgraphics = bubbleborder && bubbleborder.getChildAt(0);\r\n                let onlycontent = false;\r\n                let cbgcolor = 0xffffff;\r\n                //位置\r\n                let x = 0,y=0;\r\n                switch (position){\r\n                    case 'left':\r\n                        x = 0;y = border.itemlength;\r\n                        cbgcolor = 0xffffff;\r\n                        break;\r\n                    case 'center':\r\n                        onlycontent = true;\r\n                        x = border.width / 2;y = border.itemlength;\r\n                        cbgcolor = 0xdadada;\r\n                        break;\r\n                    case 'right':\r\n                        x = border.width;y = border.itemlength;\r\n                        cbgcolor = 0x98e165;\r\n                        break;\r\n                }\r\n                group.x = x;\r\n                group.y = y;\r\n                //头像\r\n                if(this.viewComponent.game.load.cache.checkImageKey(avatar.url) && position !== 'center'){\r\n                    const bubbleavatar = group.create(avatar.rect.x,avatar.rect.y,avatar.url);\r\n                    const scale = Math.min(avatar.rect.width/bubbleavatar.width,avatar.rect.height/bubbleavatar.height)\r\n                    bubbleavatar.width *= scale;\r\n                    bubbleavatar.height *= scale;\r\n                    bubbleavatar.x = (avatar.rect.width - bubbleavatar.width) / 2 + avatar.rect.x;\r\n                    bubbleavatar.y = (avatar.rect.height - bubbleavatar.height) / 2 + avatar.rect.y;\r\n                }\r\n                //用户名\r\n                if(position !== 'center'){\r\n                    const rolestyle = {\r\n                        fill:role.color\r\n                        ,font:role.font_size + 'px ' +role.fontFamily\r\n                    }\r\n                    const roledata = this.sceneProxy.Expression.parseValue(role.data, this.sceneProxy.context);\r\n                    const roletxt = this.viewComponent.game.add.text(0,0,roledata,rolestyle,group);\r\n                    roletxt.setTextBounds(role.rect.x,role.rect.y,role.rect.width,role.rect.height);\r\n                }\r\n\r\n                //气泡内容\r\n                if(type === 'image'){\r\n                    //图片内容\r\n                    if(this.viewComponent.game.load.cache.checkImageKey(content.url)){\r\n                        const contentimg = group.create(content.rect.x,onlycontent ? 0 : content.rect.y,content.url);\r\n                        contentimg.width = content.rect.width;\r\n                        contentimg.height = content.rect.height;\r\n                    }\r\n\r\n                }else if(type === 'text'){\r\n                    //文本内容\r\n                    const contenttextstyle = {\r\n                        fill:content.color\r\n                        ,font:content.font_size + 'px ' + content.fontFamily\r\n                        , boundsAlignH: \"center\"\r\n                        , boundsAlignV: \"middle\"\r\n                        , wordWrap: true\r\n                        , wordWrapWidth: content.rect.width}\r\n\r\n                    const contentext = this.viewComponent.game.add.text(content.rect.x + 4,onlycontent ? 2 : content.rect.y + 2,'',contenttextstyle,group);\r\n                    contentext.useAdvancedWrap = true;\r\n                    contentext.updateText = RePhaser.updateText;\r\n                    contentext.lineSpacing = this.sceneProxy.txtLineSpace(content.font_size)\r\n                    let contextdata = '';\r\n                    if (this.sceneProxy.Expression.isArray(content.data)) {\r\n                        for (let i=0; i<content.data.length; i++) {\r\n                            contextdata += this.sceneProxy.Expression.parseValue(content.data[i].data, this.sceneProxy.context);\r\n                            // 设置颜色\r\n                            this.sceneProxy.addImageFontTextColors(content.data, contentext, this.sceneProxy.context);\r\n                            //content.data[i].color && (contentext.style.fill = content.data[i].color);\r\n                        }\r\n                    }\r\n                    else {\r\n                        contextdata = this.sceneProxy.Expression.parseValue(content.data, this.sceneProxy.context);\r\n                        content.data.color && (contentext.style.fill = content.data.color);\r\n                    }\r\n                    while (contextdata.length && contextdata[contextdata.length-1] === '\\n') {\r\n                        //最后换行结尾 空字符\r\n                        contextdata = contextdata.substring(0, contextdata.length-1);\r\n                    }\r\n                    contentext.text = contextdata;\r\n                    if(contextdata !== ''){\r\n                        //有内容\r\n                        //对话框内容底图\r\n                        const contentbg = this.viewComponent.game.add.graphics();\r\n                        const ch = contentext.height > content.rect.height ? contentext.height : content.rect.height;\r\n                        contentbg.beginFill(cbgcolor)\r\n                        contentbg.drawRoundedRect(content.rect.x,onlycontent ? 0 : content.rect.y,content.rect.width,ch,6,6);\r\n                        contentbg.endFill();\r\n                        group.addChildAt(contentbg,0);\r\n                        //小三角\r\n                        if(position !== 'center'){\r\n                            let offsetx = 0,offsety = 0;\r\n                            let trianglex = content.rect.x,triangley = content.rect.y +5;\r\n                            if(position === 'left'){\r\n                                offsetx = -10;\r\n                                offsety = 10;\r\n                                trianglex += 2;\r\n                            }else if(position === 'right'){\r\n                                offsetx = 10;\r\n                                offsety = 10;\r\n                                trianglex += (content.rect.width - 2);\r\n                            }\r\n                            const triangle = this.viewComponent.game.add.graphics();\r\n                            triangle.beginFill(cbgcolor);\r\n                            triangle.moveTo(trianglex,triangley);\r\n                            triangle.lineTo(trianglex + offsetx ,triangley + offsety);\r\n                            triangle.lineTo(trianglex,triangley + 25);\r\n                            triangle.endFill();\r\n                            group.addChildAt(triangle,0);\r\n                        }\r\n                    }\r\n\r\n                }else{\r\n                    //未知置内容类型\r\n                }\r\n                border.itemlength += group.height + 20; //长度\r\n                if(scrollgraphics){\r\n                    scrollgraphics.clear();\r\n                    scrollgraphics.beginFill(0x000000,0);//透明背景\r\n                    scrollgraphics.drawRect(0,0,border.width,border.itemlength);\r\n                    scrollgraphics.endFill();\r\n                }\r\n                bubbleborder.addChild(group);\r\n                if(border.itemlength > border.origialH){\r\n                    bubbleborder.y = -(border.itemlength - border.origialH);\r\n                }\r\n                return resolve(group);\r\n            })\r\n        },\r\n\r\n\r\n        showPlot: function (context, chapter, nPlot, cmdPlotSnap, loadData) {\r\n\t\t\tconst {Expression} = this.sceneProxy;\r\n\t\t\tconst plot = chapter.plots[nPlot];\r\n            let bkSprite = null;\t// 背景\r\n\t\t\tlet titleTxt = null;\t// 文本标题\r\n\t\t\tlet contentTxt = null;\t// 文本\r\n\t\t\tlet isShowAll = false;\r\n\t\t\tif( this.sceneProxy.isQuickPlay !== true){\r\n                appCanBack(flashvars.client,flashvars.app_version,false,flashvars.offline === '1'); //允许滑动\r\n            }\r\n            this.sceneProxy.isQuickPlay = true;\r\n\r\n\t\t\tif (!this.sceneProxy.isGameStarted && chapter.isFirst && nPlot===0) {\r\n\t\t\t\t// 告知游戏开始\r\n\t\t\t\tthis.sceneProxy.notifyGameStarted();\r\n\t\t\t}\r\n\r\n\t\t\t// 振动效果\r\n\t\t\tconst sceneShake = (offSet/*=18*/, duration/*=600*/, delay) => {\r\n\t\t\t\tconst curOffSet = offSet;\r\n\t\t\t\tconst sceneProxy = this.sceneProxy;\r\n\t\t\t\tconst properties = {\r\n\t\t\t\t\tx: sceneProxy.dialogLayer.x - curOffSet,\r\n\t\t\t\t\ty: sceneProxy.dialogLayer.y - curOffSet\r\n\t\t\t\t};\r\n\t\t\t\tlet promises = [];\r\n                sceneProxy.curPlotLayer.isShaking = true;\r\n                if (plot.speaking && plot.speaking.coverage === 'bottom') {\r\n                    sceneProxy.dialogLayer.snakename = 'shake';\r\n                    promises.push(this.tweenToPromise(sceneProxy.dialogLayer, properties, 40, null, true, delay, 0, true));\r\n                }\r\n                if (sceneProxy.charsAndPropsLayer && sceneProxy.charsAndPropsLayer.visible) {\r\n                    const cnpx = sceneProxy.charsAndPropsLayer.x;\r\n                    const cnpy = sceneProxy.charsAndPropsLayer.y;\r\n                    sceneProxy.charsAndPropsLayer.snakename = 'shake';\r\n                    promises.push(this.tweenToPromise(sceneProxy.charsAndPropsLayer,\r\n                        {x: sceneProxy.charsAndPropsLayer.x - curOffSet, y: sceneProxy.charsAndPropsLayer.y - curOffSet},\r\n                        40, null, true, delay, 0, true).then(()=>{\r\n                        sceneProxy.charsAndPropsLayer.x = cnpx;\r\n                        sceneProxy.charsAndPropsLayer.y = cnpy;\r\n                    }));\r\n                }\r\n                sceneProxy.curPlotLayer.snakename = 'shake';\r\n                promises.push(this.tweenToPromise(sceneProxy.curPlotLayer, {\r\n                    x: -curOffSet,\r\n                    y: -curOffSet\r\n                }, 40, null, true, delay, 0, true)\r\n                    .then(() => {\r\n                        sceneProxy.curPlotLayer.x = 0;\r\n                        sceneProxy.curPlotLayer.y = 0;\r\n                        if(this.sceneProxy.shakeLoopObj.duration === 0){\r\n                            sceneProxy.curPlotLayer.isShaking = false;\r\n                            return Promise.resolve();\r\n                        }\r\n                        if (0 < duration && !sceneProxy.quickPlay && chapter === sceneProxy.curChapter && nPlot === sceneProxy.curPlotIndex) {\r\n                            return sceneShake(curOffSet, duration-100, 0);\r\n                        }\r\n                        else {\r\n                            sceneProxy.curPlotLayer.isShaking = false;\r\n                            return Promise.resolve();\r\n                        }\r\n                    }));\r\n\t\t\t\treturn Promise.all(promises)\r\n\t\t\t};\r\n\t\t\t/**暂停 清除振动*/\r\n\t\t\tconst clearShake = ()=>{\r\n                this.sceneProxy.curPlotLayer && (this.sceneProxy.curPlotLayer.isShaking = false)\r\n                this.sceneProxy.shakeLoopObj.loop = false;\r\n                this.sceneProxy.shakeLoopObj.duration = 0;\r\n                for(let i = 0; i<this.sceneProxy.lstPlotTweens.length;i++ ){\r\n                    let tween = this.sceneProxy.lstPlotTweens[i];\r\n                    if(tween.target && tween.target.snakename === 'shake'){\r\n                        tween.pause();\r\n                        tween.stop(true);\r\n                    }\r\n                }\r\n            }\r\n\r\n\t\t\t// 闪烁效果\r\n\t\t\tconst sceneTwinkle = (duration, delay, color) => {\r\n\t\t\t\tthis.sceneProxy.twinkleTimer = Utils.timeout(delay || 0);\r\n                return this.sceneProxy.twinkleTimer.then(() => {\r\n                    const twinkle = this.viewComponent.game.add.graphics(0, 0);\r\n                    twinkle.beginFill(Utils.fixColorValue(color).replace('#', '0x'));\r\n                    twinkle.moveTo(0, 0);\r\n                    twinkle.lineTo(this.viewComponent.game.world.width, 0);\r\n                    twinkle.lineTo(this.viewComponent.game.world.width, this.viewComponent.game.world.height);\r\n                    twinkle.lineTo(0, this.viewComponent.game.world.height);\r\n                    twinkle.lineTo(0, 0);\r\n                    twinkle.endFill();\r\n                    twinkle.name = 'twinkle';\r\n                    this.sceneProxy.twinkleTimer = null;\r\n                    return this.tweenToPromise(twinkle, {alpha: 0}, duration, null, true, 0).then(() => twinkle.destroy());\r\n\t\t\t\t})\r\n\t\t\t};\r\n\r\n\t\t\t// 淡入效果\r\n\t\t\tconst fadeIn = (duration, delay) => {\r\n\t\t\t\tif (bkSprite) {\r\n\t\t\t\t\treturn this.tweenFromPromise(bkSprite, {alpha: 0}, duration, null, true, delay);\r\n\t\t\t\t}\r\n\t\t\t\treturn Promise.resolve();\r\n\t\t\t};\r\n\r\n            //帷幕\r\n\t\t\tconst curtain = (duration, delay) =>{\r\n\t\t\t    let screen1 = this.viewComponent.game.world.getByName('curtainscreen1')\r\n                let screen2 = this.viewComponent.game.world.getByName('curtainscreen2')\r\n                if(!screen1){\r\n                    screen1 = this.viewComponent.game.add.graphics(0,0);\r\n                    screen1.beginFill(0x000000);\r\n                    screen1.drawRect(0,0,this.viewComponent.game.width / 2,this.viewComponent.game.height);\r\n                    screen1.endFill();\r\n                    screen1.name = 'curtainscreen1';\r\n                }\r\n                if(!screen2){\r\n                    screen2 = this.viewComponent.game.add.graphics(0,0);\r\n                    screen2.beginFill(0x000000);\r\n                    screen2.drawRect(0,0,this.viewComponent.game.width / 2,this.viewComponent.game.height);\r\n                    screen2.endFill();\r\n                    screen2.name = 'curtainscreen2';\r\n                }\r\n                screen1.x = 0;\r\n                screen2.x = this.viewComponent.game.width / 2;\r\n                this.viewComponent.game.world.bringToTop(screen1);\r\n                this.viewComponent.game.world.bringToTop(screen2);\r\n                this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n                const promises = [];\r\n                promises.push(this.tweenToPromise(screen1,{x: - (this.viewComponent.game.width / 2)},duration,null,true,delay));\r\n                promises.push(this.tweenToPromise(screen2,{x: this.viewComponent.game.width},duration,null,true,delay));\r\n                return Promise.all(promises)\r\n            }\r\n\r\n            //交错\r\n            const interlacing = (duration, delay) =>{\r\n\t\t\t    let screen1 = this.viewComponent.game.world.getByName('interlacingscreen1');\r\n\t\t\t    let screen2 = this.viewComponent.game.world.getByName('interlacingscreen2');\r\n\t\t\t    const createScreen = (type)=>{\r\n                    let screen = this.viewComponent.game.add.graphics(0,0);\r\n                    screen.beginFill(0x000000,0);\r\n                    screen.drawRect(0,0,this.viewComponent.game.width,this.viewComponent.game.height);\r\n                    screen.endFill();\r\n                    const spase = (this.viewComponent.game.height / 6);\r\n                    const createmask = (__x,__y)=>{\r\n                        let mask = this.viewComponent.game.add.graphics(0,0);\r\n                        mask.beginFill(0x000000);\r\n                        mask.drawRect(0,0,this.viewComponent.game.width,spase);\r\n                        mask.endFill();\r\n                        mask.x = __x;\r\n                        mask.y = __y;\r\n                        return mask;\r\n                    }\r\n                    screen.addChild(createmask(0,spase * (type === 1 ? 0 : 1)))\r\n                    screen.addChild(createmask(0,spase * (type === 1 ? 2 : 3)))\r\n                    screen.addChild(createmask(0,spase * (type === 1 ? 4 : 5)))\r\n                    screen.name = 'interlacingscreen'+type;\r\n                    return screen;\r\n                }\r\n                if(!screen1){\r\n                    screen1 = createScreen(1);\r\n                }\r\n                if(!screen2){\r\n                    screen2 = createScreen(2);\r\n                }\r\n                screen1.x = 0;\r\n                screen2.x = 0;\r\n                this.viewComponent.game.world.bringToTop(screen1);\r\n                this.viewComponent.game.world.bringToTop(screen2);\r\n                this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n                const promises = [];\r\n                promises.push(this.tweenToPromise(screen1,{x: - (this.viewComponent.game.width)},duration,null,true,delay));\r\n                promises.push(this.tweenToPromise(screen2,{x: this.viewComponent.game.width},duration,null,true,delay));\r\n                return Promise.all(promises)\r\n            }\r\n\r\n            //遮黑\r\n            const coverblack =(duration, delay) =>{\r\n                let screen = this.viewComponent.game.world.getByName('coverblackscreen');\r\n                if(!screen){\r\n                    screen = this.viewComponent.game.add.graphics(0,0);\r\n                    screen.beginFill(0x000000);\r\n                    screen.drawRect(0,0,this.viewComponent.game.width,this.viewComponent.game.height);\r\n                    screen.endFill();\r\n                    screen.name = 'coverblackscreen';\r\n                }\r\n                screen.x = - this.viewComponent.game.width;\r\n                let bk_x = 0;\r\n                let bk_y = 0;\r\n                if(bkSprite){\r\n                    bk_x = bkSprite.x;\r\n                    bk_y = bkSprite.y;\r\n                }\r\n                if (this.sceneProxy.prePlotBkKey && this.viewComponent.game.load.cache.checkImageKey(this.sceneProxy.prePlotBkKey)) {\r\n                    if(bkSprite){\r\n                        //当前的背景图片存在，先替换上个剧情背景图片\r\n                        bkSprite = this.sceneProxy.curPlotLayer.create(bkSprite.x, bkSprite.y, this.sceneProxy.prePlotBkKey);\r\n                        bkSprite.alpha = this.sceneProxy.lstPlotBkOpacity === undefined ? 1 : this.sceneProxy.lstPlotBkOpacity;\r\n                        this.backgroundFlex(bkSprite, this.sceneProxy.lstPlotBkFlex);\r\n                        this.viewComponent.addGifAnimation(bkSprite, this.sceneProxy.lstPlotBkKey);\r\n                    }\r\n                }\r\n                this.viewComponent.game.world.bringToTop(screen);\r\n                this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n                const promises = [];\r\n                promises.push(this.tweenToPromise(screen,{x: 0},duration / 2,null,true,delay).then(() =>{\r\n                    bkSprite = this.sceneProxy.curPlotLayer.create(bk_x, bk_y, this.sceneProxy.lstPlotBkKey);//背景图片替换回去\r\n                    bkSprite.alpha = this.sceneProxy.lstPlotBkOpacity === undefined ? 1 : this.sceneProxy.lstPlotBkOpacity;\r\n                    this.backgroundFlex(bkSprite, this.sceneProxy.lstPlotBkFlex);\r\n                    this.viewComponent.addGifAnimation(bkSprite, this.sceneProxy.lstPlotBkKey);\r\n                    this.tweenToPromise(screen,{x: this.viewComponent.game.width},duration / 2,null,true,delay)\r\n                }))\r\n                return Promise.all(promises)\r\n            }\r\n\r\n            //展开\r\n            const spread =(duration, delay)=>{\r\n                const sceneProxy = this.sceneProxy;\r\n                let promises = [];\r\n                let visibleweather = false;\r\n                //记录原先的index\r\n                let plotindex = this.viewComponent.game.world.getChildIndex(sceneProxy.curPlotLayer);\r\n                let cnpindex = this.viewComponent.game.world.getChildIndex(sceneProxy.charsAndPropsLayer);\r\n                let dialogindex = this.viewComponent.game.world.getChildIndex(sceneProxy.dialogLayer);\r\n                if(this.sceneProxy.weatherLayer.visible){ this.sceneProxy.weatherLayer.visible = false;visibleweather = true;} //天气先关闭\r\n\r\n                const spreadgroup = this.viewComponent.game.add.group();\r\n                sceneProxy.curPlotLayer.snakename = 'spread';\r\n                spreadgroup.add(sceneProxy.curPlotLayer);\r\n                if (sceneProxy.charsAndPropsLayer && sceneProxy.charsAndPropsLayer.visible) {\r\n                    sceneProxy.charsAndPropsLayer.visible = true;\r\n                    spreadgroup.add(sceneProxy.charsAndPropsLayer);\r\n                }else{\r\n                    cnpindex = -1;\r\n                }\r\n                spreadgroup.add(sceneProxy.dialogLayer);\r\n                /*if (sceneProxy.dialogLayer.visible) {\r\n                    spreadgroup.add(sceneProxy.dialogLayer);\r\n                }else{\r\n                    dialogindex = -1;\r\n                }*/\r\n                this.sceneProxy.curPlotLayer.isSpreading = true;\r\n                let spreadmask = this.viewComponent.game.add.graphics(0,0);\r\n                spreadmask.beginFill(0);\r\n                spreadmask.drawRect(0,0,this.viewComponent.game.world.width,this.viewComponent.game.world.height);\r\n                spreadmask.endFill();\r\n                spreadgroup.add(spreadmask)\r\n                spreadgroup.mask = spreadmask;\r\n\r\n                const plotx = spreadgroup.x;\r\n                const ploty = spreadgroup.y;\r\n                const plotw = spreadgroup.width;\r\n                const ploth = spreadgroup.height;\r\n                spreadgroup.x = this.viewComponent.game.world.centerX;\r\n                spreadgroup.y = this.viewComponent.game.world.centerY;\r\n                spreadgroup.width = 0;\r\n                spreadgroup.height = 0;\r\n                this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n                promises.push(this.tweenToPromise(spreadgroup, {x:plotx,y:ploty,width:plotw,height:ploth}, duration, null, true, delay, 0, false).then(()=>{\r\n                    spreadgroup.x = plotx\r\n                    spreadgroup.y = ploty\r\n                    spreadmask && spreadmask.destroy();\r\n                    if(plotindex !== -1){this.viewComponent.game.world.addChildAt(sceneProxy.curPlotLayer,plotindex)}\r\n                    if(cnpindex !== -1){this.viewComponent.game.world.addChildAt(sceneProxy.charsAndPropsLayer,cnpindex)}\r\n                    if(dialogindex !== -1){this.viewComponent.game.world.addChildAt(sceneProxy.dialogLayer,dialogindex)}\r\n                    if(visibleweather){\r\n                        this.sceneProxy.weatherLayer.visible = true;\r\n                    }\r\n                    spreadgroup.destroy();\r\n                    this.sceneProxy.curPlotLayer.isSpreading = false;\r\n                }));\r\n                return Promise.all(promises)\r\n            }\r\n\r\n\t\t\t// 展示特效\r\n\t\t\tconst playEffect = animations => {\r\n\t\t\t\tconst promises = [];\r\n\t\t\t\tanimations.forEach(animation => {\r\n\t\t\t\t\tconst delay = this.sceneProxy.quickPlay ? 0 : animation.delay;\r\n\t\t\t\t\tconst duration = this.sceneProxy.quickPlay ? 100 : animation.duration;\r\n\t\t\t\t\tif (animation.type === 'twinkle') {\r\n\t\t\t\t\t\tpromises.push(sceneTwinkle(duration, delay, animation.color));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (animation.type === 'shake') {\r\n                        duration && promises.push(sceneShake(animation.level ? animation.level * 5 : 18, duration, delay));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (animation.type === 'fadein') {\r\n\t\t\t\t\t\tpromises.push(fadeIn(duration, delay).then(() => this.sceneProxy.doInCT(context, () => {\r\n\t\t\t\t\t\t\tthis.sceneProxy.lstPlotLayer && this.sceneProxy.lstPlotLayer.destroy();\r\n\t\t\t\t\t\t\tthis.sceneProxy.lstPlotLayer = null;\r\n\t\t\t\t\t\t\tthis.sceneProxy.lstPlotLayer = this.sceneProxy.curPlotLayer;\r\n\t\t\t\t\t\t})));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(animation.type === 'curtain'){\r\n                        //帷幕\r\n                        promises.push(curtain(duration, delay))\r\n                    }\r\n                    if(animation.type === 'interlacing'){\r\n                        //交错\r\n                        promises.push(interlacing(duration, delay))\r\n                    }\r\n                    if(animation.type === 'coverblack'){\r\n                        //遮黑\r\n                        promises.push(coverblack(duration, delay))\r\n                    }\r\n                    if(animation.type === 'spread'){\r\n                        //展开\r\n                        promises.push(spread(duration, delay))\r\n                    }\r\n\t\t\t\t});\r\n\t\t\t\treturn Promise.all(promises)\r\n\t\t\t};\r\n\r\n\t\t\t// 添加对话框\r\n\t\t\tconst addDialogLayer = (dialogInfo) => {\r\n\t\t\t\tconst {dialogLayer} = this.sceneProxy;\r\n\t\t\t\t// 对话框\r\n\t\t\t\tthis.addDialogLayer();\r\n\t\t\t\tconst {avatarContainer, titleContainer, content} = this.sceneProxy.json_data.template.json.dialog;\r\n\t\t\t\tconst dialog_bk = dialogLayer.getByName('dialog_bk');\r\n\t\t\t\tconst dialog_bk_avatar = dialogLayer.getByName('dialog_bk_avatar');\r\n\t\t\t\tconst dialog_avatar = dialogLayer.getByName('dialog_avatar');\r\n\t\t\t\tconst dialog_bk_title = dialogLayer.getByName('dialog_bk_title');\r\n\t\t\t\ttitleTxt = dialogLayer.getByName('dialog_text_title');\r\n\t\t\t\tcontentTxt = dialogLayer.getByName('dialog_text_content');\r\n\r\n\t\t\t\tif (dialog_bk) {\r\n\t\t\t\t\tdialog_bk.visible = !dialogInfo.speaking.hidden;\r\n\t\t\t\t}\r\n\t\t\t\tif (dialog_bk_avatar) {\r\n\t\t\t\t\tdialog_bk_avatar.visible = !dialogInfo.avatar.hidden;\r\n\t\t\t\t}\r\n\t\t\t\tif (dialog_bk_title) {\r\n\t\t\t\t\tdialog_bk_title.visible = !dialogInfo.dialogtitle.hidden;\r\n\t\t\t\t}\r\n\t\t\t\tdialog_avatar.visible = !dialogInfo.avatar.hidden;\r\n\t\t\t\ttitleTxt.visible = !dialogInfo.dialogtitle.hidden;\r\n\r\n\t\t\t\tthis.sceneProxy.dialogLayer.x = dialogInfo.speaking.x;\r\n\t\t\t\tthis.sceneProxy.dialogLayer.y = dialogInfo.speaking.y;\r\n\t\t\t\tthis.sceneProxy.dialogLayer.alpha = undefined === dialogInfo.speaking.opacity ? 1 : dialogInfo.speaking.opacity;\r\n\r\n\t\t\t\tif (this.viewComponent.game.load.cache.checkImageKey(dialogInfo.avatar.url)) {\r\n\t\t\t\t\tlet {x, y, width, height, clip} = avatarContainer.avatar;\r\n\t\t\t\t\tx = x + avatarContainer.rect.x;\r\n\t\t\t\t\ty = y + avatarContainer.rect.y;\r\n\r\n\t\t\t\t\tdialog_avatar.loadTexture(dialogInfo.avatar.url);\r\n\t\t\t\t\t//dialog_avatar.width = width;\r\n\t\t\t\t\t//dialog_avatar.height = height;\r\n\r\n                    const scale = Math.min(width * dialog_avatar.scale.x / dialog_avatar.width, height * dialog_avatar.scale.y / dialog_avatar.height);\r\n                    width = dialog_avatar.width / dialog_avatar.scale.x * scale;\r\n                    height = dialog_avatar.height / dialog_avatar.scale.y * scale;\r\n                    x = avatarContainer.avatar.x + avatarContainer.rect.x + (avatarContainer.avatar.width - width) / 2;\r\n                    y = avatarContainer.avatar.y + avatarContainer.rect.y + (avatarContainer.avatar.height - height) / 2;\r\n                    dialog_avatar.x = x;\r\n                    dialog_avatar.y = y;\r\n                    dialog_avatar.width = width;\r\n                    dialog_avatar.height = height;\r\n\r\n\t\t\t\t\tdialog_avatar.mask && dialog_avatar.mask.destroy();\r\n\t\t\t\t\tconst mask = this.viewComponent.game.add.graphics(0, 0);\r\n\t\t\t\t\tmask.beginFill();\r\n\t\t\t\t\tswitch (clip) {\r\n\t\t\t\t\t\tcase 'square':\r\n\t\t\t\t\t\t\tmask.drawRect(x, y, width, height);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'hexagon':\r\n\t\t\t\t\t\t\tconst poly = new Phaser.Polygon();\r\n\t\t\t\t\t\t\tpoly.setTo([new Phaser.Point(width / 2 + x, y),\r\n\t\t\t\t\t\t\t\tnew Phaser.Point(width / 2 + height / 4 * Math.pow(3, 1 / 2) + x, height / 4 + y),\r\n\t\t\t\t\t\t\t\tnew Phaser.Point(width / 2 + height / 4 * Math.pow(3, 1 / 2) + x, height / 4 * 3 + y),\r\n\t\t\t\t\t\t\t\tnew Phaser.Point(width / 2 + x, height + y),\r\n\t\t\t\t\t\t\t\tnew Phaser.Point(width / 2 - height / 4 * Math.pow(3, 1 / 2) + x, height / 4 * 3 + y),\r\n\t\t\t\t\t\t\t\tnew Phaser.Point(width / 2 - height / 4 * Math.pow(3, 1 / 2) + x, height / 4 + y)]);\r\n\t\t\t\t\t\t\tmask.drawPolygon(poly.points);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'heart':\r\n\t\t\t\t\t\t\tmask.moveTo(width / 2 + x, width / 4 + y);\r\n\t\t\t\t\t\t\tmask.bezierCurveTo(width * 3 / 4 + x, -width / 4 + y, width * 3 / 2 + x, width / 4 + y, width / 2 + x, width + y);\r\n\t\t\t\t\t\t\tmask.bezierCurveTo(-width / 2 + x, width / 4 + y, width / 4 + x, -width / 4 + y, width / 2 + x, width / 4 + y);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'round':\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tmask.drawCircle(x + width / 2, y + height / 2, width);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tmask.endFill();\r\n\t\t\t\t\tthis.sceneProxy.dialogLayer.add(mask);\r\n\t\t\t\t\tdialog_avatar.mask = mask;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst {font_size, color, bold, fontFamily, hidden} = dialogInfo.dialogtitle;\r\n\t\t\t\tconst titleStyle = titleContainer.title.text;\r\n\t\t\t\tfont_size && (titleStyle.fontSize = font_size);\r\n\t\t\t\tcolor && (titleStyle.color = color);\r\n\t\t\t\tbold !== undefined && (titleStyle.fontWeight = bold ? 'bold' : 'normal');\r\n                fontFamily ? titleStyle.fontFamily = fontFamily : this.sceneProxy.json_data.font ? titleStyle.fontFamily = this.sceneProxy.json_data.font.fontFamily : '';\r\n\t\t\t\thidden !== undefined && (titleStyle.hidden = hidden);\r\n\r\n\t\t\t\tlet ff = '';\r\n\t\t\t\tif (FontUtils.fontFamily) {\r\n\t\t\t\t    let txtImg = titleTxt.children[0];\r\n\t\t\t\t    let strText = Expression.parseValue(dialogInfo.dialogtitle.data, context);\r\n                    (color === '#ffffff' || color === '#fff') && (titleStyle.color = '#fefefe');\r\n                    if (txtImg) {\r\n                        txtImg.fontImg.destroy();\r\n                        txtImg.destroy();\r\n                    }\r\n                    txtImg = this.sceneProxy.addRetroText();\r\n                    titleTxt.addChild(txtImg);\r\n                    txtImg.fontImg.setText(strText ? strText : ' ', true, 0, 0, 'left', true);\r\n                    txtImg.tint = parseInt(titleStyle.color.replace('#', '0x'));\r\n                    const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(titleStyle.fontSize) : titleStyle.fontSize;\r\n                    const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(titleStyle.fontSize) : titleStyle.fontSize;\r\n\t\t\t\t    txtImg.width = fw * txtImg.fontImg.text.length;\r\n\t\t\t\t    txtImg.height = fh;\r\n\r\n                    const titleX = titleContainer.rect.x + titleContainer.title.rect.x + (titleContainer.title.rect.width - txtImg.width) / 2;\r\n                    const titleY = titleContainer.rect.y + titleContainer.title.rect.y;\r\n                    titleTxt.setTextBounds(titleX, titleY, titleContainer.title.rect.width, titleContainer.title.rect.height);\r\n                    titleTxt.text = ' ';\r\n                }\r\n                else {\r\n                    ff += titleStyle.fontWeight ? titleStyle.fontWeight + ' ' : 'normal ';\r\n                    ff += titleStyle.fontSize ? parseInt(titleStyle.fontSize) + 'px ' : '';\r\n                    ff += titleStyle.fontFamily ? titleStyle.fontFamily : '';\r\n\r\n                    titleTxt.setStyle({\r\n                        font: ff,\r\n                        fill: titleStyle.color,\r\n                        boundsAlignH: \"center\",\r\n                        boundsAlignV: \"middle\"\r\n                    });\r\n                    titleTxt.text = Expression.parseValue(dialogInfo.dialogtitle.data, context);\r\n\r\n                    const titleX = titleContainer.rect.x + titleContainer.title.rect.x;\r\n                    const titleY = titleContainer.rect.y + titleContainer.title.rect.y;\r\n                    titleTxt.setTextBounds(titleX\r\n                        , titleY + (titleTxt.height - parseInt(titleStyle.fontSize || 12)) / 2\r\n                        , titleContainer.title.rect.width\r\n                        , titleContainer.title.rect.height);\r\n\t\t\t\t}\r\n\r\n                ff = dialogInfo.speaking.font_size + '';\r\n\t\t\t\tif (ff.indexOf('px') < 0) {\r\n\t\t\t\t\tff = ff + 'px';\r\n\t\t\t\t}\r\n                if (dialogInfo.speaking.bold === true) {\r\n                    ff = 'bold ' + ff;\r\n                }\r\n\t\t\t\tff = ff + ' ' + (this.sceneProxy.json_data.font ? this.sceneProxy.json_data.font.fontFamily : dialogInfo.speaking.fontFamily ? dialogInfo.speaking.fontFamily : '');\r\n\t\t\t\tcontentTxt.style.font = ff;\r\n\t\t\t\tcontentTxt.style.fill = dialogInfo.speaking.color;\r\n\t\t\t\tcontentTxt.text = '';\r\n\t\t\t\tcontentTxt.top = content.rect.y;\r\n\t\t\t\tcontentTxt.lineSpacing = this.sceneProxy.txtLineSpace(dialogInfo.speaking.font_size);//- parseInt(plot.speaking.font_size) / 5;\r\n\r\n\t\t\t\tcontentTxt.mask && contentTxt.mask.destroy();\r\n\t\t\t\tconst mask = this.viewComponent.game.add.graphics(0, 0);\r\n\t\t\t\tmask.beginFill();\r\n\t\t\t\tmask.drawRect(content.rect.x,\r\n\t\t\t\t\tcontent.rect.y,\r\n\t\t\t\t\tcontent.rect.width,\r\n                    dialogInfo.speaking.hidden ? this.viewComponent.game.world.height : content.rect.height);\r\n\t\t\t\tmask.endFill();\r\n\t\t\t\tthis.sceneProxy.dialogLayer.add(mask);\r\n\t\t\t\tcontentTxt.mask = mask;\r\n                if(dialogInfo && dialogInfo.speaking && dialogInfo.speaking.animations && dialogInfo.speaking.animations.length > 0){ //对话框有动画时，先隐藏\r\n                    this.sceneProxy.dialogLayer.visible = false;\r\n                }\r\n\t\t\t\treturn Promise.resolve();\r\n\t\t\t};\r\n\r\n\t\t\t// 剧情音效\r\n\t\t\tconst playPlotSound = () => {\r\n\t\t\t\tlet sounds = plot.plot_sound;\r\n\t\t\t\tif (loadData) {\r\n                    sounds = loadData.sounds;\r\n\t\t\t\t}\r\n\t\t\t\tif (Object.prototype.toString.call(sounds) === '[object Array]') {\r\n\t\t\t\t\tfor (let item in sounds) {\r\n\t\t\t\t\t\tif (sounds[item]) {\r\n\t\t\t\t\t\t\tif (sounds[item].url === 'inherit') {\r\n\t\t\t\t\t\t\t\tthis.sceneProxy.playInheritSound(item, sounds[item].volume);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (this.viewComponent.game.load.cache.checkSoundKey(sounds[item].url)\r\n                                    || 'ios' === flashvars.client && flashvars.app_version >= '1.5.0') {\r\n\t\t\t\t\t\t\t\tthis.sceneProxy.stopSound(item, sounds[item].url,true);\r\n\t\t\t\t\t\t\t\tthis.sceneProxy.playSound(item, sounds[item].url, sounds[item].volume, sounds[item].time === 0);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tthis.sceneProxy.stopSound(item);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse if (this.viewComponent.game.load.cache.checkSoundKey(plot.plot_sound.url)\r\n                        || 'ios' === flashvars.client && flashvars.app_version >= '1.5.0') {\r\n\t\t\t\t\tthis.sceneProxy.playSound(0, plot.plot_sound.url, plot.plot_sound.volume, false);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// music\r\n\t\t\tconst playMusic = (music) => {\r\n\t\t\t\tif (!music.url || music.url === '') {\r\n\t\t\t\t\tthis.sceneProxy.stopMusic();\r\n\t\t\t\t}\r\n\t\t\t\telse if (music.url === 'inherit') {\r\n\t\t\t\t\tthis.sceneProxy.playInheritMusic(music.volume);\r\n\t\t\t\t}\r\n\t\t\t\telse if (this.viewComponent.game.load.cache.checkSoundKey(music.url)\r\n                        || 'ios' === flashvars.client && flashvars.app_version >= '1.5.0') {\r\n\t\t\t\t    let volume = music.volume;\r\n\t\t\t\t    if(music.inheritvolume !== undefined && music.inheritvolume !== -1){ volume = music.inheritvolume};\r\n\t\t\t\t\tthis.sceneProxy.stopMusic(music.url,true);\r\n\t\t\t\t\tthis.sceneProxy.playMusic(music.url, volume, music.time !== 1,false);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// 背景\r\n\t\t\tconst addBackground = (plotLayer) => {\r\n\t\t\t\t// 填充黑色背景\r\n\t\t\t\tbkSprite = this.viewComponent.game.add.graphics(0, 0, plotLayer);\r\n\t\t\t\tbkSprite.beginFill(0x0, 1);\r\n\t\t\t\tbkSprite.drawRect(0, 0, this.viewComponent.game.world.width, this.viewComponent.game.world.height);\r\n\t\t\t\tbkSprite.endFill();\r\n\r\n                if (plot.commands) {return;}\r\n\r\n                if (this.sceneProxy.lstGameBk && this.sceneProxy.lstGameBk.visible) {\r\n                    !plot.animations.filter(a => a.type === 'fadein').length && (this.sceneProxy.lstGameBk.visible = false);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst isInherit = plot.background.url === 'inherit';\r\n\t\t\t\tlet bk_alpha = isInherit ? this.sceneProxy.lstPlotBkOpacity : plot.background.opacity;\r\n                let bk_flex = isInherit ? this.sceneProxy.lstPlotBkFlex : plot.background.flex;\r\n\t\t\t\tlet bk_key = isInherit ? this.sceneProxy.lstPlotBkKey : plot.background.url;\r\n\t\t\t\t!isInherit && ResourcesManager.updateUsingKey({ type: 'background', key: bk_key });\r\n                if (!!bk_key) {\r\n                    this.sceneProxy.prePlotBkKey = this.sceneProxy.lstPlotBkKey;\r\n                    this.sceneProxy.lstPlotBkKey = bk_key;\r\n                    this.sceneProxy.lstPlotBkOpacity = bk_alpha;\r\n                    this.sceneProxy.lstPlotBkFlex = bk_flex;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.viewComponent.game.load.cache.checkImageKey(bk_key)) {\r\n                \tbkSprite.alpha = 0;\r\n                    bkSprite = plotLayer.create(plot.background.x, plot.background.y, bk_key);\r\n\t\t\t\t\tbkSprite.alpha = bk_alpha === undefined ? 1 : bk_alpha;\r\n\t\t\t\t\tthis.backgroundFlex(bkSprite, bk_flex);\r\n                    this.viewComponent.addGifAnimation(bkSprite, bk_key);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// 角色 & 道具\r\n\t\t\tconst addCharsProps = (characters, props, cmdUuid) => {\r\n\t\t\t\t/*if (!this.sceneProxy.charsAndPropsLayer || !this.sceneProxy.charsAndPropsLayer.exists) {\r\n                    this.sceneProxy.charsAndPropsLayer = this.viewComponent.game.add.group();\r\n                    this.sceneProxy.charsAndPropsLayer.name = \"charactersAndProps\";\r\n                }*/\r\n\t\t\t\tfor (let item of [...characters, ...props]) {\r\n\t\t\t\t\tconst ch = this.viewComponent.addFitImageSprint(item.x, item.y, item.width, item.height, item.url, this.sceneProxy.charsAndPropsLayer, item.index);\r\n\t\t\t\t\tch.alpha = item.opacity === undefined ? 1 : item.opacity;\r\n\t\t\t\t\tch.angle = parseInt(item.rotate) === 180 ? 179.9 : item.rotate || 0;\r\n\t\t\t\t\tch.data.animations = item.animations;\r\n\t\t\t\t\tch.cmdUuid = cmdUuid;\r\n\t\t\t\t\tthis.viewComponent.addGifAnimation(ch, item.url);\r\n\r\n\t\t\t\t\tif (item.mirrorH) {\r\n\t\t\t\t\t\tch.angle = -ch.angle;\r\n\t\t\t\t\t\tch.scale.x = -ch.scale.x;\r\n\t\t\t\t\t\tch.mirrorH = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (item.mirrorV) {\r\n\t\t\t\t\t\tch.angle = -ch.angle;\r\n\t\t\t\t\t\tch.scale.y = -ch.scale.y;\r\n\t\t\t\t\t\tch.mirrorV = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.viewComponent.game.world.bringToTop(this.sceneProxy.charsAndPropsLayer);\r\n\t\t\t\tif(this.sceneProxy.dialogLayer.visible && !this.sceneProxy.dialogLayer.isbottom){\r\n                    this.viewComponent.game.world.bringToTop(this.sceneProxy.dialogLayer);\r\n                }\r\n\t\t\t\t//如果天气存在，天气置顶\r\n                if(this.sceneProxy.weatherLayer.visible){this.viewComponent.game.world.bringToTop(this.sceneProxy.weatherLayer)};\r\n                if(this.sceneProxy.menuLayer.visible !== false){  this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);} //菜单置顶\r\n\t\t\t};\r\n\r\n\t\t\tconst cApAnimationIn = () => {\r\n\t\t\t\tconst promises = [];\r\n\t\t\t\tfor (let item of this.sceneProxy.charsAndPropsLayer.children) {\r\n\t\t\t\t\tfor (let a of item.data.animations) {\r\n\t\t\t\t\t\tif ((a.trigger === 'in' || a.trigger === 'animateIn') && !this.sceneProxy.quickPlay) {\r\n\t\t\t\t\t\t\tif (a.type === 'fadein') {\r\n\t\t\t\t\t\t\t\tpromises.push(this.tweenFromPromise(item, {alpha: 0}\r\n\t\t\t\t\t\t\t\t\t, a.duration\r\n\t\t\t\t\t\t\t\t\t, null, true\r\n\t\t\t\t\t\t\t\t\t, a.delay, 0, false))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (a.type === 'moveFrom') {\r\n\t\t\t\t\t\t\t\tlet x = item.mirrorH ? a.x - item.width/2 : a.x + item.width/2;\r\n\t\t\t\t\t\t\t\tlet y = item.mirrorV ? a.y - item.height/2 : a.y + item.height/2;\r\n\t\t\t\t\t\t\t\tpromises.push(this.tweenFromPromise(item, {x: x, y: y}\r\n\t\t\t\t\t\t\t\t\t, a.duration\r\n\t\t\t\t\t\t\t\t\t, null, true\r\n\t\t\t\t\t\t\t\t\t, a.delay, 0, false))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn Promise.all(promises);\r\n\t\t\t};\r\n\r\n\t\t\t// 选项\r\n\t\t\tconst addOptions = (txtOptions, condition_options) => {\r\n\t\t\t\tlet hasOption = false;\r\n\r\n                return new Promise((resolve, reject) => {\r\n\t\t\t\t\tif (plot.jump || plot.back || plot.insert) {\r\n\t\t\t\t\t\treturn resolve({type: 0})\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst condOptIndex = (condition_options || []).findIndex(option => Expression.safeEval(option.expression, context));\r\n\t\t\t\t\tconst condOpt = condOptIndex < 0 ? null : condition_options[condOptIndex];\r\n\t\t\t\t\tif (condOpt) {\r\n\t\t\t\t\t\treturn resolve({type: 2, index:condOptIndex});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet timerHandles = [];\r\n\t\t\t\t\tconst countDownPromises = [];\r\n\t\t\t\t\tfor (let i = 0; i < txtOptions.length; i++) {\r\n\t\t\t\t\t\tconst {rect, normal, active} = this.sceneProxy.json_data.template.json.option;\r\n\t\t\t\t\t\tlet {x, y, width, height} = rect;\r\n\t\t\t\t\t\tlet normal_bk_key = normal.background.url;\r\n\t\t\t\t\t\tlet active_bk_key = active.background.url;\r\n\t\t\t\t\t\tlet disable_bk_key = null;\r\n\t\t\t\t\t\tconst {font, timer, disable} = txtOptions[i];\r\n\r\n\t\t\t\t\t\tif (txtOptions[i].x !== undefined) {\r\n\t\t\t\t\t\t\tx = txtOptions[i].x;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (txtOptions[i].y !== undefined) {\r\n\t\t\t\t\t\t\ty = txtOptions[i].y;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (txtOptions[i].width !== undefined && txtOptions[i].hasOwnProperty(\"background\")) {\r\n\t\t\t\t\t\t\twidth = txtOptions[i].width;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (txtOptions[i].height !== undefined && txtOptions[i].hasOwnProperty(\"background\")) {\r\n\t\t\t\t\t\t\theight = txtOptions[i].height;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (txtOptions[i].background\r\n\t\t\t\t\t\t\t&& this.viewComponent.game.load.cache.checkImageKey(txtOptions[i].background.normal.url)) {\r\n\t\t\t\t\t\t\tnormal_bk_key = txtOptions[i].background.normal.url;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (txtOptions[i].background\r\n\t\t\t\t\t\t\t&& this.viewComponent.game.load.cache.checkImageKey(txtOptions[i].background.active.url)) {\r\n\t\t\t\t\t\t\tactive_bk_key = txtOptions[i].background.active.url;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (txtOptions[i].background && txtOptions[i].background.disable\r\n\t\t\t\t\t\t\t&& this.viewComponent.game.load.cache.checkImageKey(txtOptions[i].background.disable.url)) {\r\n\t\t\t\t\t\t\tdisable_bk_key = txtOptions[i].background.disable.url;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst onBtnClicked = (obj, pointer) => {\r\n\t\t\t\t\t\t\tfor (let t of timerHandles) {\r\n\t\t\t\t\t\t\t\tt.close();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (obj.chapter.plots.length > 0) {\r\n\t\t\t\t\t\t\t\tresolve({type: 1, index: i});\r\n                                this.sceneProxy.optionLayer.destroy();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tresolve({type: 3});\r\n                                this.sceneProxy.optionLayer.destroy();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tUtils.selOptions.push(txtOptions[i].uuid);\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tconst textInfo = {\r\n\t\t\t\t\t\t\tfontFamily: font.normal.fontFamily ? font.normal.fontFamily : this.sceneProxy.json_data.font ? this.sceneProxy.json_data.font.fontFamily : ''\r\n\t\t\t\t\t\t\t, fontSize: font.normal.font_size\r\n\t\t\t\t\t\t\t, fontWeight: font.normal.bold ? 'bold' : 'normal'\r\n\t\t\t\t\t\t\t, color: font.normal.color\r\n\t\t\t\t\t\t\t, hidden: font.normal.hidden\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tconst disabledTextInfo = {\r\n\t\t\t\t\t\t\tfontFamily: font.disable.fontFamily ? font.disable.fontFamily : this.sceneProxy.json_data.font ? this.sceneProxy.json_data.font.fontFamily : ''\r\n\t\t\t\t\t\t\t, fontSize: font.disable.font_size\r\n\t\t\t\t\t\t\t, fontWeight: font.disable.bold ? 'bold' : 'normal'\r\n\t\t\t\t\t\t\t, color: font.disable.color\r\n\t\t\t\t\t\t\t, hidden: font.disable.hidden\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tconst t = {};\r\n\t\t\t\t\t\tt.normal = textInfo;\r\n\t\t\t\t\t\tt.active = textInfo;\r\n\t\t\t\t\t\tt.text = txtOptions[i].name;\r\n\t\t\t\t\t\tlet op_sound;\r\n\t\t\t\t\t\tif (txtOptions[i].sound && this.viewComponent.game.load.cache.checkSoundKey(txtOptions[i].sound.url)) {\r\n\t\t\t\t\t\t\top_sound = this.viewComponent.game.add.sound(txtOptions[i].sound.url, txtOptions[i].sound.volume, false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst btng = this.viewComponent.addButton(x,\r\n\t\t\t\t\t\t\ty,\r\n\t\t\t\t\t\t\twidth,\r\n\t\t\t\t\t\t\theight,\r\n\t\t\t\t\t\t\tnormal_bk_key,\r\n\t\t\t\t\t\t\tactive_bk_key,\r\n\t\t\t\t\t\t\tonBtnClicked,\r\n\t\t\t\t\t\t\tt,\r\n\t\t\t\t\t\t\top_sound,\r\n\t\t\t\t\t\t\t'option',\r\n                            this.sceneProxy.optionLayer\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tconst btn = btng.getByName('button');\r\n\t\t\t\t\t\tconst txtObj = btng.getByName('text');\r\n\t\t\t\t\t\tbtn.chapter = {plots: txtOptions[i].plots ? txtOptions[i].plots : txtOptions[i].commands, parent: {pChapter: chapter, pnPlot: nPlot}};\r\n\r\n\t\t\t\t\t\tif (disable) {\r\n\t\t\t\t\t\t\tbtn.inputEnabled = false;\r\n\t\t\t\t\t\t\tbtng.changeBackground(disable_bk_key || normal_bk_key, disabledTextInfo);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (timer) {\r\n\t\t\t\t\t\t    this.sceneProxy.hasCountDown = true;\r\n\t\t\t\t\t\t\tconst countDown = () => {\r\n\t\t\t\t\t\t\t\treturn new Promise((resolve, reject) => {\r\n                                    let time = Expression.getGameValueByTimer(timer, context);\r\n\t\t\t\t\t\t\t\t\tif (!txtOptions[i].hideTimer) {\r\n                                        txtObj.text = txtOptions[i].name + `(${time})`;\r\n                                        if (FontUtils.fontFamily) {\r\n                                            const txtImgOld = txtObj.children[0];\r\n                                            if (txtImgOld) {\r\n                                                const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(textInfo.fontSize) : textInfo.fontSize;\r\n                                                const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(textInfo.fontSize) : textInfo.fontSize;\r\n                                                const w = fw * txtObj.text.length;\r\n                                                const x = (width - w) / 2;\r\n                                                const y = (height - fh) / 2;\r\n                                                this.sceneProxy.addImageFontText([{data: txtObj.text}], fw, fh, txtObj, context);\r\n                                                txtObj.children[0].x = x;\r\n                                                txtObj.children[0].y = y;\r\n                                                txtImgOld.children.forEach(item => item.fontImg.destroy());\r\n                                                txtImgOld.destroy();\r\n                                                txtObj.text = ' ';\r\n                                            }\r\n                                        }\r\n                                        else {\r\n                                        }\r\n\t\t\t\t\t\t\t\t\t}\r\n                                    const timerHandle = this.viewComponent.game.time.events.loop(Phaser.Timer.SECOND, () => {\r\n                                        time--;\r\n                                        if (!txtOptions[i].hideTimer) {\r\n                                            txtObj.text = txtOptions[i].name + `(${time})`;\r\n                                            if (FontUtils.fontFamily) {\r\n                                                const txtImgOld = txtObj.children[0];\r\n                                                if (txtImgOld) {\r\n                                                    const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(textInfo.fontSize) : textInfo.fontSize;\r\n                                                    const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(textInfo.fontSize) : textInfo.fontSize;\r\n                                                    const w = fw * txtObj.text.length;\r\n                                                    const x = (width - w) / 2;\r\n                                                    const y = (height - fh) / 2;\r\n                                                    this.sceneProxy.addImageFontText([{data: txtObj.text}], fw, fh, txtObj, context);\r\n                                                    txtObj.children[0].x = x;\r\n                                                    txtObj.children[0].y = y;\r\n                                                    txtImgOld.children.forEach(item => item.fontImg.destroy());\r\n                                                    txtImgOld.destroy();\r\n                                                    txtObj.text = ' ';\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                        if (time <= 0) {\r\n                                            txtObj.text = txtOptions[i].name;\r\n                                            if (FontUtils.fontFamily) {\r\n                                                const txtImgOld = txtObj.children[0];\r\n                                                if (txtImgOld) {\r\n                                                    const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(textInfo.fontSize) : textInfo.fontSize;\r\n                                                    const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(textInfo.fontSize) : textInfo.fontSize;\r\n                                                    const w = fw * txtObj.text.length;\r\n                                                    const x = (width - w) / 2;\r\n                                                    const y = (height - fh) / 2;\r\n                                                    this.sceneProxy.addImageFontText([{data: txtObj.text}], fw, fh, txtObj, context);\r\n                                                    txtObj.children[0].x = x;\r\n                                                    txtObj.children[0].y = y;\r\n                                                    txtImgOld.children.forEach(item => item.fontImg.destroy());\r\n                                                    txtImgOld.destroy();\r\n                                                    txtObj.text = ' ';\r\n                                                }\r\n                                            }\r\n                                            this.viewComponent.game.time.events.remove(timerHandle);\r\n                                            if ('disable' === timer.type) {\r\n                                                if (btn.alive) {\r\n                                                    btn.inputEnabled = false;\r\n                                                    btng.changeBackground(disable_bk_key || normal_bk_key, disabledTextInfo);\r\n                                                }\r\n                                                resolve(false);\r\n                                            } else {\r\n                                                if (btn.alive) {\r\n                                                    btn.inputEnabled = true;\r\n                                                    btn.input.useHandCursor = true;\r\n                                                    btng.changeBackground(normal_bk_key, textInfo);\r\n                                                }\r\n                                                resolve(true);\r\n                                            }\r\n                                        }\r\n                                    });\r\n\t\t\t\t\t\t\t\t\tconst close = () => {\r\n                                        this.viewComponent.game.time.events.remove(timerHandle);\r\n\t\t\t\t\t\t\t\t\t\tresolve(true);\r\n                                    };\r\n                                    timerHandles.push({close});\r\n                                    this.viewComponent.game.time.events.start();\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t};\r\n                            countDownPromises.push(countDown())\r\n\t\t\t\t\t\t} else {\r\n                            countDownPromises.push(Promise.resolve(!disable))\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thasOption = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!hasOption) {\r\n\t\t\t\t\t\tresolve({type: 0});\r\n                        this.sceneProxy.optionLayer.destroy();\r\n\t\t\t\t\t}\r\n                    Promise.all(countDownPromises).then(results => {\r\n                        this.sceneProxy.hasCountDown = false;\r\n                        if (!results.some(r => !!r)) {\r\n                        \tresolve({type: 3})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\t// 天气\r\n\t\t\tconst addWeather = (type) => {\r\n\t\t\t\tthis.sceneProxy.weatherLayer.visible = false;\r\n\r\n\t\t\t\tfor (let n=0; n<this.sceneProxy.weatherLayer.children.length; n++) {\r\n\t\t\t\t\tconst {visible, name} = this.sceneProxy.weatherLayer.children[n];\r\n\t\t\t\t\tif (visible && name !== type) {\r\n                        this.sceneProxy.weatherLayer.children[n].destroy();\r\n                        n--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n                        this.sceneProxy.weatherLayer.children[n].visible = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (type === 'windy') {\r\n\t\t\t\t    if(flashvars.vertical){\r\n                        this.viewComponent.game.load.cache.checkImageKey(`/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"wind\")}/feng_00019.png`) && this.addWindEffect();\r\n                    }else{\r\n                        this.addWindEffect();\r\n                    }\r\n\t\t\t\t}\r\n\t\t\t\telse if (type === 'snowy') {\r\n                    this.viewComponent.game.load.cache.checkImageKey(`/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"snow\")}/xuehua_00119.png`) && this.addSnowEffect();\r\n\t\t\t\t}\r\n\t\t\t\telse if (type === 'rainy') {\r\n                    this.viewComponent.game.load.cache.checkImageKey(`/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"rain\")}/xiayu_00049.png`) && this.addRainEffect();\r\n\t\t\t\t}\r\n                else if (type === 'defoliation') {\r\n                    this.viewComponent.game.load.cache.checkImageKey(`/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"mapleLeaves\")}/fengye_00089.png`) && this.addFallingLeavesEffect();\r\n                }\r\n                else if (type === 'fallingPeach') {\r\n                    this.viewComponent.game.load.cache.checkImageKey(`/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"beachBlossom\")}/taohua_00089.png`) && this.addBeachBlossomEffect();\r\n                }\r\n                else if (type === 'fallingFlower') {\r\n                    this.viewComponent.game.load.cache.checkImageKey(`/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"blossom\")}/yinghua_00089.png`) && this.addBlossomEffect();\r\n                }\r\n                else if (type === 'lightning') {\r\n                    this.viewComponent.game.load.cache.checkImageKey(`/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"lightning\")}/shandian_00049.png`) && this.addLightningEffect();\r\n\t\t\t\t}\r\n\t\t\t\tthis.viewComponent.game.world.bringToTop(this.sceneProxy.weatherLayer);\r\n\t\t\t};\r\n\r\n\t\t\t// 剧情高级UI\r\n\t\t\tconst addPlotViews = (views, loadData, cmdUuid) => {\r\n                if (loadData) {\r\n                \t// 先过滤掉已不在剧情中的UI\r\n                    let ary = [];\r\n\t\t\t\t\tfor (let i=0; i<this.sceneProxy.plotViews.length; i++) {\r\n\t\t\t\t\t\tif (this.sceneProxy.plotViews[i].generateType === 'plotInfo') {\r\n\t\t\t\t\t\t    const found = (v)=>{\r\n\t\t\t\t\t\t        for (let i =0;i < views.length;i++){\r\n\t\t\t\t\t\t            if(v.name === views[i].ref){\r\n\t\t\t\t\t\t                return true;\r\n                                    }\r\n                                }\r\n                                return false;\r\n                            }\r\n                            if(!found(this.sceneProxy.plotViews[i])){ary.push(this.sceneProxy.plotViews[i])}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n                    for(let j=0;j <ary.length;j++ ){\r\n                        let index = this.sceneProxy.plotViews.indexOf(ary[j]);\r\n                        this.sceneProxy.plotViews.splice(index,1)\r\n                    }\r\n\r\n                    loadSubViews(this.sceneProxy.plotViews,true);\r\n                    this.sceneProxy.uiOnLoadQueue.splice(0);\r\n                    this.viewComponent.game.world.bringToTop(this.sceneProxy.plotViewsLayer);\r\n                    this.sceneProxy.plotViewsLayer.visible = false;\r\n                    return;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (let p in views) {\r\n\t\t\t\t\tthis.registerViewKey(views[p].ref, views[p].events, this.sceneProxy.plotViewKeys);\r\n\t\t\t\t\tlet sView = this.addView(this.sceneProxy.plotViewsLayer, views[p].ref, views[p].instanceUuid, views[p].x, views[p].y, views[p].events);\r\n\t\t\t\t\tif (!sView) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (views[p].scale) {\r\n\t\t\t\t\t\tsView.scale.set(views[p].scale, views[p].scale);\r\n\t\t\t\t\t\tsView.x += Expression.safeEval(views[p].x, context) * (1 - views[p].scale);\r\n\t\t\t\t\t\tsView.y += Expression.safeEval(views[p].y, context) * (1 - views[p].scale);\r\n\t\t\t\t\t\tthis.scaleInputView(sView, views[p].scale);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsView.generateType = cmdUuid ? cmdUuid : 'plotInfo';\t// 保存生成UI方式为剧情脚本\r\n                    this.sceneProxy.plotViews.push(sView);\r\n\t\t\t\t}\r\n\r\n                this.uiOnLoadInvoker();\r\n\t\t\t\tthis.updateProgressView();\r\n                this.viewComponent.game.world.bringToTop(this.sceneProxy.plotViewsLayer);\r\n                this.sceneProxy.plotViewsLayer.visible = false;\r\n            };\r\n\r\n\t\t\t// 全局高级UI\r\n\t\t\tconst showGlobalViews = (bLoadRec, hideGlobalViews) => {\r\n                let refUuidToHide = [];\r\n\t\t\t\tfor (let p in hideGlobalViews) {\r\n\t\t\t\t\tfor (let q in this.sceneProxy.json_data.views) {\r\n\t\t\t\t\t\tif (hideGlobalViews[p] === this.sceneProxy.json_data.views[q].instanceUuid) {\r\n\t\t\t\t\t\t\trefUuidToHide[this.sceneProxy.json_data.views[q].ref] = (this.sceneProxy.json_data.views[q].ref);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n                if (bLoadRec && this.sceneProxy.globalViews) {\r\n\t\t\t\t\tconst found =(id) =>{\r\n\t\t\t\t\t    for(let i =0;i <this.sceneProxy.json_data.views.length;i++){\r\n\t\t\t\t\t        if(id === this.sceneProxy.json_data.views[i].instanceUuid){\r\n\t\t\t\t\t            return true;\r\n                            }\r\n                        }\r\n\t\t\t\t\t    return false;\r\n                    }\r\n                    let ary = [];\r\n                    for(let i = 0;i < this.sceneProxy.globalViews.length;i++){\r\n\t\t\t\t\t    if(!found(this.sceneProxy.globalViews[i].instanceUuid)){\r\n                            ary.push(this.sceneProxy.globalViews[i]);//不存在\r\n                        }\r\n                    }\r\n                    for(let j=0;j <ary.length;j++ ){\r\n                        if(ary[j].isGlobal === true){\r\n                            let index = this.sceneProxy.globalViews.indexOf(ary[j]);\r\n                            this.sceneProxy.globalViews.splice(index,1)\r\n                        }\r\n                    }\r\n                    loadSubViews(this.sceneProxy.globalViews,true);\r\n\r\n                    for (let p in this.sceneProxy.globalViews) {\r\n                    \tthis.viewComponent.game.world.bringToTop(this.sceneProxy.globalViews[p]);\r\n                        if (refUuidToHide[this.sceneProxy.globalViews[p].name]) {\r\n                            this.sceneProxy.globalViews[p].visible = false;\r\n                            this.showInputView(this.sceneProxy.globalViews[p], false);\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    this.addGlobalView(refUuidToHide);\r\n                }\r\n\t\t\t};\r\n\r\n\t\t\t// 读档子UI\r\n\t\t\tconst loadSubViews = (savedSubView,isload = false) => {\r\n\t\t\t\tthis.sceneProxy.timerCounts = [];\t// 清空\r\n\t\t\t\tconst fixTimerCount = (items) => {\r\n\t\t\t\t\tfor (let i=0; i<items.length; i++) {\r\n\t\t\t\t\t\tconst item = items[i];\r\n\t\t\t\t\t\tif (item.currentCount) {\r\n\t\t\t\t\t\t\tthis.sceneProxy.timerCounts[this.sceneProxy.timerCounts.length] = {name: item.name, parent: item.parent, currentCount:item.currentCount};\r\n\t\t\t\t\t\t}\r\n                        fixTimerCount(item.children);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tconst fixViewEventsInfo = (items) => {\r\n\t\t\t\t\t// 还原外部事件\r\n\t\t\t\t\tfor (let i=0; i<items.length; i++) {\r\n\t\t\t\t\t\tif (items[i].eventsInfo) {\r\n\t\t\t\t\t\t\t// 若已有信息，说明是从h5中读取的存档，不需要再获取外部事件\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (let j=0; j<plot.views.length; j++) {\r\n\t\t\t\t\t\t\tif (plot.views[j].ref === items[i].name) {\r\n\t\t\t\t\t\t\t\titems[i].eventsInfo = plot.views[j].events.concat();\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tfixTimerCount(savedSubView);\r\n\t\t\t\t!plot.commands && fixViewEventsInfo(savedSubView);\r\n\t\t\t\tfor (let i=0; i<savedSubView.length; i++) {\r\n\t\t\t\t\tconst item = savedSubView[i];\r\n\t\t\t\t\tconst parent = item.parent === '__world' ? null : this.viewComponent.game.world.getByName(item.parent);\r\n                    const view = this.addView(parent, item.name, item.instanceUuid, item.xInfo, item.yInfo, item.eventsInfo,false,isload)\r\n                    //删除\r\n                    const deleteSubView = (itemInfo, parentView) =>{\r\n                        //在记录数据中是否存在\r\n                        const promises = [];\r\n                        const foundinItem = (v)=>{\r\n                            let ary = itemInfo.children ? itemInfo.children.concat() : [];\r\n                            for(let i = 0;i < ary.length;i++){\r\n                                if(ary[i] && (v.name === ary[i].name && v.instanceUuid === ary[i].instanceUuid)){\r\n                                    return true;//找到\r\n                                }\r\n                            }\r\n                            return false;\r\n                        }\r\n                        let tempRefer = parentView.children ? parentView.children.concat() : [];\r\n                        for(let j=0;j < tempRefer.length;j++){\r\n                            if(!foundinItem(tempRefer[j])){\r\n                                //没找到  删除\r\n                                promises.push(this.destroyView(tempRefer[j].name));\r\n                            }\r\n                        }\r\n                        return Promise.all(promises);\r\n                    }\r\n                    const createSubView = (itemInfo, parentView) => {\r\n                        deleteSubView(itemInfo, parentView).then(()=>{\r\n                            if(itemInfo && !itemInfo.children){\r\n                                return; //记录数据中不存在children  无需增加\r\n                            }\r\n                            let tempRefer = parentView.children ? parentView.children.concat():[];\r\n                            const foundTemp = (v,ary)=>{ // 原始数据中查找\r\n                                for(let i = 0;i < ary.length;i++){\r\n                                    if(v.name === ary[i].name && v.instanceUuid === ary[i].instanceUuid){\r\n                                        return true;//找到\r\n                                    }\r\n                                }\r\n                                return false;\r\n                            }\r\n                            //增加  记录的数据 在原始数据中不存在的时 增加\r\n                            for (let i=0; i<itemInfo.children.length; i++) {\r\n                                if(foundTemp(itemInfo.children[i],tempRefer)){\r\n                                    let found = true;\r\n                                    if(itemInfo.children[i].children){\r\n                                        for(let n =0 ;n < itemInfo.children[i].children.length;n++){\r\n                                            if(foundTemp(itemInfo.children[i].children[n],tempRefer)){\r\n                                                //找到\r\n                                                found = true;\r\n                                            }else{\r\n                                                //没找到\r\n                                                found = false;\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                    if(found === true) continue;\r\n                                };\r\n                                //add\r\n                                let subView = this.addView(parentView, itemInfo.children[i].name, itemInfo.children[i].instanceUuid\r\n                                    , itemInfo.children[i].xInfo, itemInfo.children[i].yInfo, itemInfo.children[i].eventsInfo,false,isload);\r\n                                if (parentView.xInfo && parentView.yInfo && subView) {\r\n                                    subView.x += this.sceneProxy.Expression.safeEval(parentView.xInfo, this.sceneProxy.context);\r\n                                    subView.y += this.sceneProxy.Expression.safeEval(parentView.yInfo, this.sceneProxy.context);\r\n                                }\r\n                                subView && createSubView(itemInfo.children[i], subView);\r\n                            }\r\n                        })\r\n                    };\r\n\r\n\t\t\t\t\tif (!view) {\r\n                        savedSubView.splice(i--, 1);\r\n                        continue;\r\n\t\t\t\t\t}\r\n                    !item.isGlobal && createSubView(item, view);\r\n                    view.scale.set(item.scale.x, item.scale.y);\r\n                    view.x = item.x;\r\n                    view.y = item.y;\r\n                    this.scaleInputView(view, item.scale.x);\r\n\r\n                    view.visible = item.visible;\r\n                    savedSubView[i] = view;\r\n\t\t\t\t\tif (parent) {\r\n\t\t\t\t\t\tparent.add(view);\r\n                    }\r\n                    else {\r\n\t\t\t\t\t\tview.isGlobal = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// 音乐淡入\r\n\t\t\tconst musicIn = () => {\r\n\t\t\t\tif (plot.music.animation && (plot.music.animation.type === 'fadeinfadeout' || plot.music.animation.type === 'fadein'))\r\n\t\t\t\t{\r\n                    if (this.sceneProxy.bk_music) {\r\n                        if(this.sceneProxy.bk_music.prevolume === 0){\r\n                            this.sceneProxy.bk_music.prevolume = this.sceneProxy.bk_music.volume;\r\n                            this.sceneProxy.bk_music.inheritvolume = this.sceneProxy.bk_music.volume;\r\n                        }\r\n                        this.sceneProxy.bk_music.volume = this.sceneProxy.bk_music.prevolume * Utils.musicVolume\r\n                        return this.tweenFromPromise(this.sceneProxy.bk_music, {volume:0}, this.sceneProxy.quickPlay ? 10 : 1000, null, true, 0, 0, false)\r\n                    }\r\n                    else if ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n                    \treturn PhoneUtils.tweenFromMusic(0, this.sceneProxy.quickPlay ? 10 : 1000, 0);\r\n                    }\r\n                }\r\n\t\t\t\treturn Promise.resolve();\r\n\t\t\t};\r\n\r\n\t\t\t// 音乐淡出\r\n\t\t\tconst musicOut = (action) => {\r\n\t\t\t    if (plot.music.animation && (plot.music.animation.type === 'fadeinfadeout' || plot.music.animation.type === 'fadeout'))\r\n                {\r\n                    if (this.sceneProxy.bk_music) {\r\n                        return new Promise((resolve, reject) => {\r\n                            const tween = this.viewComponent.game.add.tween(this.sceneProxy.bk_music).to({volume:0}, this.sceneProxy.quickPlay ? 10 : 1000, null, true, 0, 0, false);\r\n                            tween.onComplete.add(() => {\r\n                                this.sceneProxy.bk_music.volume *= Utils.musicVolume;\r\n                                resolve(action)\r\n                            });\r\n                        })\r\n                    }\r\n                    else if ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n                        return PhoneUtils.tweenToMusic(0, this.sceneProxy.quickPlay ? 10 : 1000, 0);\r\n                    }\r\n                }\r\n\r\n\t\t\t\treturn Promise.resolve(action);\r\n\t\t\t};\r\n\r\n\t\t\tconst dialogIn = (animations) => {\r\n                this.sceneProxy.dialogLayer.visible = true;\r\n\t\t\t\tif (!animations.length) {\r\n\t\t\t\t\treturn Promise.resolve();\r\n\t\t\t\t}\r\n\t\t\t\tconst In = animations.filter(a => a.type === 'fadein');\r\n\t\t\t\tconst From = animations.filter(a => a.type === 'moveFrom');\r\n\r\n\t\t\t\tconst fadeIn = () => {\r\n\t\t\t\t\tif (In.length) {\r\n\t\t\t\t\t\treturn this.tweenFromPromise(this.sceneProxy.dialogLayer, {alpha:0}, In[0].duration, null, true, In[0].delay, 0, false);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tconst moveFrom = () => {\r\n\t\t\t\t\tif (From.length) {\r\n\t\t\t\t\t\treturn this.tweenFromPromise(this.sceneProxy.dialogLayer, {x:From[0].x, y:From[0].y}, From[0].duration, null, true, From[0].delay, 0, false);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\treturn Promise.all([fadeIn(), moveFrom()]);\r\n\t\t\t};\r\n\r\n\t\t\tconst dialogOut = (animations) => {\r\n\t\t\t\tif (!animations.length) {\r\n\t\t\t\t\treturn Promise.resolve();\r\n\t\t\t\t}\r\n\t\t\t\tconst Out = animations.filter(a => a.type === 'fadeout');\r\n\t\t\t\tconst To = animations.filter(a => a.type === 'moveTo');\r\n\r\n\t\t\t\tconst fadeOut = () => {\r\n\t\t\t\t\tif (Out.length) {\r\n\t\t\t\t\t\treturn this.tweenToPromise(this.sceneProxy.dialogLayer, {alpha:0}, Out[0].duration, null, true, Out[0].delay, 0, false);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tconst moveTo = () => {\r\n\t\t\t\t\tif (To.length) {\r\n\t\t\t\t\t\treturn this.tweenToPromise(this.sceneProxy.dialogLayer, {x:To[0].x, y:To[0].y}, To[0].duration, null, true, To[0].delay, 0, false);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\treturn Promise.all([fadeOut(), moveTo()]);\r\n\t\t\t};\r\n\r\n\t\t\tconst animateIn = () => {\r\n\t\t\t\treturn this.sceneProxy.doInCT(context, () => playEffect(plot.animations.filter(a => a.trigger === 'in')))\r\n\t\t\t\t\t.then(() => {\r\n                        this.sceneProxy.charsAndPropsLayer && (this.sceneProxy.charsAndPropsLayer.visible = true);\r\n                        this.sceneProxy.plotViewsLayer.visible = true;\r\n\t\t\t\t\t\treturn this.sceneProxy.doInCT(context, () => Promise.all([cApAnimationIn() ,playEffect(plot.animations.filter(a => a.trigger === 'animateIn')),dialogIn(plot.speaking.animations.filter(a => a.trigger === 'animateIn'))]))\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(() => this.sceneProxy.doInCT(context, () => playEffect(plot.animations.filter(a => a.trigger === 'animateInEnd'))))\r\n\t\t\t};\r\n\r\n\t\t\tconst animateOut = action => {\r\n\t\t\t\tconst promises = [];\r\n\t\t\t\tfor (let item of this.sceneProxy.charsAndPropsLayer.children) {\r\n\t\t\t\t\tfor (let a of item.data.animations) {\r\n\t\t\t\t\t\tif ((a.trigger === 'out' || a.trigger === 'animateOut') && !this.sceneProxy.quickPlay) {\r\n\t\t\t\t\t\t\tif (a.type === 'fadeout') {\r\n\t\t\t\t\t\t\t\tpromises.push(this.tweenToPromise(item, {alpha: 0}\r\n\t\t\t\t\t\t\t\t\t, a.duration\r\n\t\t\t\t\t\t\t\t\t, null, true\r\n\t\t\t\t\t\t\t\t\t, a.delay, 0, false))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (a.type === 'moveTo') {\r\n\t\t\t\t\t\t\t    let xStep = item.scale.x < 0 ? -item.width/2 : item.width/2;\r\n\t\t\t\t\t\t\t    let yStep = item.scale.y < 0 ? -item.height/2 : item.height/2;\r\n\t\t\t\t\t\t\t\tpromises.push(this.tweenToPromise(item, {x: a.x + xStep, y: a.y + yStep}\r\n\t\t\t\t\t\t\t\t\t, a.duration\r\n\t\t\t\t\t\t\t\t\t, null, true\r\n\t\t\t\t\t\t\t\t\t, a.delay, 0, false))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn this.sceneProxy.doInCT(context, () => Promise.all(promises))\r\n\t\t\t};\r\n\r\n\t\t\tconst pauseSpeaking = remain => {\r\n\t\t\t\tif (\"\\\\\" === remain[0]) {\r\n\t\t\t\t\tlet pause = /\\\\(\\d+)\\s([\\s\\S]*)/.exec(remain);\r\n\t\t\t\t\tif (pause) {\r\n\t\t\t\t\t\treturn Utils.timeout(this.sceneProxy.quickPlay ? 0 : pause[1])\r\n\t\t\t\t\t\t\t.then(() => pauseSpeaking(remain.slice(pause[1].length + 2)));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (this.sceneProxy.playPause) {\r\n\t\t\t\t\treturn Utils.timeout(1000)\r\n\t\t\t\t\t\t.then(() => pauseSpeaking(remain));\r\n\t\t\t\t}\r\n\t\t\t\treturn Promise.resolve(remain)\r\n\t\t\t};\r\n\r\n\t\t\tconst contextScrollToBottom = (bSpeakHidden, bottom) => {\r\n\t\t\t\tconst {content} = this.sceneProxy.json_data.template.json.dialog;\r\n\t\t\t\tconst maxHeight = bSpeakHidden ? this.viewComponent.game.world.height : content.rect.height;\r\n\t\t\t\tconst n = bottom - maxHeight;\r\n\t\t\t\tif (n > 0) {\r\n\t\t\t\t\tcontentTxt.top = -n + content.rect.y;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tconst animationSpeak = (current, remain, context, speed, bSpeakHidden) => {\r\n                if (FontUtils.fontFamily) {\r\n                    const textShow = current;\r\n                    let nLine = 0;      // 换行符数\r\n                    current.replace(/[\\n]/g, function(m, i) {nLine++;});\r\n                    if (textShow.length && textShow.length - nLine > 0) {\r\n                        const index = textShow.length - nLine - 1;\r\n                        const mask = contentTxt.children[1];\r\n                        const posInfo = contentTxt.posInfo;\r\n                        if (posInfo[index]) {\r\n                            mask.x = posInfo[index].x + posInfo[index].space;\r\n                            mask.y = posInfo[index].y;\r\n                            contextScrollToBottom(bSpeakHidden, posInfo[index].bottomInText);\r\n                            contentTxt.setText(' ', true);\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    const textShow = this.viewComponent.game.device.desktop ? current : current.replace(new RegExp(' ', 'gm'), '  ');\r\n                    contentTxt.setText(textShow, true);\r\n                    contextScrollToBottom(bSpeakHidden, contentTxt.height);\r\n                }\r\n\t\t\t\treturn pauseSpeaking(remain)\r\n\t\t\t\t\t.then((remain) => {\r\n\t\t\t\t\t\treturn this.sceneProxy.doInCT(context, () => Utils.timeout(speed).then(() => {\r\n\t\t\t\t\t\t\tif (isShowAll) {\r\n\t\t\t\t\t\t\t\treturn Promise.reject();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (!remain) {\r\n\t\t\t\t\t\t\t\treturn Promise.resolve();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn this.sceneProxy.doInCT(context, () => animationSpeak(current + (remain[0] ? remain[0] : ''), remain.slice(1), context, speed, bSpeakHidden))\r\n\t\t\t\t\t\t}))\r\n\t\t\t\t\t})\r\n\t\t\t};\r\n\r\n\t\t\tconst doSpeak = (speakInfo, showImmediate) => {\r\n                let data = '';\r\n                if (Expression.isArray(speakInfo.data)) {\r\n                    for (let i=0; i<speakInfo.data.length; i++) {\r\n                        data += Expression.parseValue(speakInfo.data[i].data, context);\r\n                    }\r\n                    // 设置颜色\r\n                    this.sceneProxy.addImageFontTextColors(speakInfo.data, contentTxt, context);\r\n                }\r\n                else {\r\n                    data = Expression.parseValue(speakInfo.data, context);\r\n                }\r\n                if (data.length && data[data.length-1] === '\\n') {\r\n                    data = data.substring(0, data.length-1);\r\n                }\r\n                if (FontUtils.fontFamily) {\r\n                    const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(speakInfo.font_size) : speakInfo.font_size;\r\n                    const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(speakInfo.font_size) : speakInfo.font_size;\r\n                    this.sceneProxy.addImageFontText(speakInfo.data, fw, fh, contentTxt, context, true, speakInfo.hidden);\r\n                }\r\n                if (showImmediate || speakInfo.immediate) {\r\n                    if (FontUtils.fontFamily) {\r\n                        contentTxt.children[1] && (contentTxt.children[1].y = contentTxt.imgFBottom);\r\n                        contentTxt.text = ' ';\r\n                        contextScrollToBottom(speakInfo.hidden, contentTxt.imgFBottom);\r\n                    }\r\n                    else {\r\n                        let txt = Expression.parseWaitTime(data);\r\n                        contentTxt.text = this.viewComponent.game.device.desktop ? txt : txt.replace(new RegExp(' ', 'gm'), '  ');\r\n                    }\r\n                    return Promise.resolve();\r\n                }\r\n\r\n                isShowAll = false;\r\n                const clickProxy = new Promise((resolve, reject) => {\r\n                    this.sceneProxy.curPlotLayer.onChildInputDown.add((params, pointer) => {\r\n                        if (params === 'auto' || pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n                            return;\r\n                        }\r\n                        resolve()\r\n                    });\r\n                });\r\n                const keyProxy = new Promise((resolve, reject) => {\r\n                    this.sceneProxy.space_key.onDown.add(() => {resolve()});\r\n                });\r\n                return this.sceneProxy.doInCT(context, () => Promise.race([animationSpeak(\"\", data, context, this.sceneProxy.quickPlay ? 0 : parseInt(speakInfo.speed), speakInfo.hidden), clickProxy, keyProxy]))\r\n                    .then(() => {\r\n                        isShowAll = true;\r\n                        this.sceneProxy.curPlotLayer.onChildInputDown.removeAll();\r\n                        this.sceneProxy.space_key.onDown.removeAll();\r\n                        if (FontUtils.fontFamily) {\r\n                            contentTxt.children[1] && (contentTxt.children[1].y = contentTxt.imgFBottom);\r\n                            contextScrollToBottom(speakInfo.hidden, contentTxt.imgFBottom);\r\n                            contentTxt.setText(' ', true);\r\n                        }\r\n                        else {\r\n                            let txt = Expression.parseWaitTime(data);\r\n                            contentTxt.text = this.viewComponent.game.device.desktop ? txt : txt.replace(new RegExp(' ', 'gm'), '  ');\r\n                            contextScrollToBottom(speakInfo.hidden, contentTxt.height);\r\n                        }\r\n                    })\r\n\t\t\t};\r\n\r\n            const playWait = (time, action) => {\r\n                const waitTime = this.sceneProxy.quickPlay ? 10 : (time < 10 ? 10 : time);\r\n                return Utils.timeout(waitTime).then(() => {\r\n                    if (this.sceneProxy.playPause) {\r\n                        return playWait(500, action);\r\n                    }\r\n                    return Promise.resolve(action)\r\n                });\r\n            };\r\n\r\n\t\t\tconst savePlayBackContent = (info) => {\r\n\t\t\t    let speakData = '';\r\n                if (Object.prototype.toString.call(info.speaking.data) === '[object Array]') {\r\n                    for (let i=0; i<info.speaking.data.length; i++) {\r\n                        speakData += info.speaking.data[i].data;\r\n                    }\r\n                }\r\n                else {\r\n                    speakData = info.speaking.data;\r\n                }\r\n\t\t\t\tspeakData = speakData.replace(/\\n/g,\"\");\r\n                let data = info.dialogtitle.hidden || info.dialogtitle.data === '' ? speakData : info.dialogtitle.data + ':' + speakData;\r\n                data && this.sceneProxy.addPlayBackContent(Expression.parseWaitTime(Expression.parseValue(data, context)));\r\n\t\t\t};\r\n\r\n\t\t\tconst play = () => {\r\n\t\t\t\tif (!plot) {\t// 该章节无剧情\r\n\t\t\t\t\treturn this.showNextPlot(context, chapter, nPlot);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst playNormal = () => {\r\n                    this.sceneProxy.curCmdUuid = '';\r\n                    this.sceneProxy.context.disableSaveOrLoad = plot.disableSaveOrLoad ? plot.disableSaveOrLoad : {save: false, load: false};\r\n                    // 保存对话内容\r\n\t\t\t\t\tlet dialogInfo = {avatar: plot.avatar, dialogtitle: plot.dialogtitle, speaking: plot.speaking};\r\n                    if (plot.speaking.data && !loadData) {\r\n                    \tsavePlayBackContent(plot);\r\n                    }\r\n\r\n                    // 显示菜单\r\n                    if (!plot.menu.hidden) {\r\n                    \tif (this.sceneProxy.json_data.template.json.shanyiMenu) {\r\n                            this.addMenuLayer(true);\r\n                        } else {\r\n                    \t\tthis.addMenuLayer(false);\r\n                            this.sceneProxy.menuLayer.x = plot.menu.x;\r\n                            this.sceneProxy.menuLayer.y = plot.menu.y;\r\n\t\t\t\t\t\t}\r\n                    }\r\n                    if (!plot.animations.find(a => a.type === 'fadein')) {\r\n                        this.sceneProxy.lstPlotLayer && this.sceneProxy.lstPlotLayer.destroy();\r\n                        this.sceneProxy.lstPlotLayer = this.sceneProxy.curPlotLayer;\r\n                        ResourcesManager.updateUsingKey({ type: 'preBackground', key: this.sceneProxy.lstPlotBkKey });\r\n                    }\r\n                    const nromalnext = ()=>{\r\n                        playPlotSound();\r\n                        playMusic(loadData ? loadData.music : plot.music);\r\n                        addBackground(this.sceneProxy.curPlotLayer);\r\n                        if (plot.speaking.coverage === 'bottom') {\r\n                            addDialogLayer(dialogInfo);\r\n                            addCharsProps(plot.characters, plot.props);\r\n                            addWeather(plot.weather.value);\r\n                            this.sceneProxy.dialogLayer.isbottom = true;//底部属性\r\n                        } else {\r\n                            addCharsProps(plot.characters, plot.props);\r\n                            addWeather(plot.weather.value);\r\n                            addDialogLayer(dialogInfo);\r\n                            this.sceneProxy.dialogLayer.isbottom = false;//底部属性\r\n                        }\r\n                        // 选项置顶\r\n                        this.sceneProxy.optionLayer && this.viewComponent.game.world.bringToTop(this.sceneProxy.optionLayer);\r\n                        this.sceneProxy.charsAndPropsLayer && (this.sceneProxy.charsAndPropsLayer.visible = false);\r\n                        addPlotViews(plot.views, loadData);\r\n                        showGlobalViews(loadData !== null && loadData !== undefined, plot.hideGlobalViews);\r\n                        if (this.sceneProxy.json_data.default_settings && this.sceneProxy.json_data.default_settings.autoSaveOrLoad && plot.autoSaveOrLoad && plot.autoSaveOrLoad.type === 1 && !loadData) {\r\n                            if (this.sceneProxy.loadRecord(0)) {\r\n                                return;\r\n                            } else {\r\n                                return Dialog.warn(\"Sorry~读不到存档内容，即将返回封面\").then(() => {\r\n                                    return this.sceneProxy.reStart(this.sceneProxy.isExtend())\r\n                                }, () => {\r\n                                    return this.sceneProxy.reStart(this.sceneProxy.isExtend())\r\n                                })\r\n                            }\r\n                        }\r\n                        this.sceneProxy.shakeLoopObj.duration = -1;\r\n                        this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n                        //this.viewComponent.game.world.bringToTop(this.sceneProxy.plotViewsLayer);\r\n                        return Promise.all([animateIn(),musicIn()])\r\n                            .then(() => {\r\n                                this.sceneProxy.lstGameBk && (this.sceneProxy.lstGameBk.visible = false);\r\n                                return doSpeak(plot.speaking)\r\n                            })\r\n                            .then(() => {return addOptions(plot.options, plot.condition_options)})\r\n                            .then(action => {\r\n                                if (this.sceneProxy.json_data.default_settings && this.sceneProxy.json_data.default_settings.autoSaveOrLoad && plot.autoSaveOrLoad && plot.autoSaveOrLoad.type === 0) {\r\n                                    this.sceneProxy.getSnap();\r\n                                    this.sceneProxy.saveRecord(0, true);\r\n                                }\r\n                                const hasView = this.sceneProxy.plotViewsLayer.children.length > 0;\r\n                                return new Promise((resolve, reject) => {\r\n                                    if (action.type === 0 || action.type === 2) {\r\n                                        if ((plot.autotext || (!hasView && (this.sceneProxy.quickPlay || context.auto))) && !this.sceneProxy.playPause) { // 自动播放下一剧情\r\n                                            Utils.timeout(100).then(()=>{resolve(action);})\r\n                                        } else {\r\n                                            const onClick = (o, e) => {\r\n                                                if (e && e.pointerMode === Phaser.PointerMode.CURSOR && e.button !== 0 || 'auto' === o && hasView) {\r\n                                                    return;\r\n                                                }\r\n                                                this.sceneProxy.curPlotLayer.onChildInputDown.remove(onClick);\r\n                                                if ('insertPlot' === o)  {\r\n                                                    reject();\r\n                                                } else {\r\n                                                    resolve(action)\r\n                                                }\r\n                                            };\r\n                                            this.sceneProxy.curPlotLayer.onChildInputDown.add(onClick);\r\n                                            !hasView && this.sceneProxy.space_key.onDown.addOnce(() => resolve(action));\r\n                                        }\r\n                                    } else {\r\n                                        resolve(action)\r\n                                    }\r\n                                })\r\n                            })\r\n                            .then(action => playWait(plot.wait.value, action))\r\n                            .then(action => {\r\n                                return Promise.all([animateOut(action), musicOut(action), dialogOut(plot.speaking.animations.filter(a => a.trigger === 'animateOut'))])\r\n                                    .then(() => this.sceneProxy.doInCT(context, () => {\r\n                                        return Promise.resolve(action)\r\n                                    }))\r\n                            })\r\n                            .then(action => {\r\n                                if (action.type === 1) {\r\n                                    this.showNextPlot(context, chapter, nPlot, \"option\", action.index)\r\n                                } else {\r\n                                    this.showNextPlot(context, chapter, nPlot)\r\n                                }\r\n                            }, e => {\r\n                                //失败\r\n                                Promise.reject(e);\r\n                            });\r\n                    }\r\n                    if(!loadData){\r\n                        this.sceneProxy.valueOperation(context, plot.values,false,()=>{\r\n                            nromalnext();\r\n                        });\r\n                    }else{\r\n                        nromalnext();\r\n                    }\r\n\t\t\t\t};\r\n\t\t\t\tconst playCommands = () => {\r\n\t\t\t\t    let isRecover = false;//是否为恢复存档\r\n\t\t\t\t\tlet hideGlobalViews = [];\r\n\t\t\t\t\tlet curborder = null;//当前气泡边框\r\n                    this.sceneProxy.isGoToCommand = true;\r\n\t\t\t\t\tconst recoverCmdSnap = (snapInfo, commands, index,animateScene = null) => {\r\n\t\t\t\t\t    return new Promise((resolve,reject) =>{\r\n                            if(animateScene && animateScene.shake){\r\n                                //恢复振动\r\n                                const screencommands = animateScene.shake;\r\n                                this.sceneProxy.shakeLoopObj.loop = screencommands.args[0].loop;\r\n                                this.sceneProxy.shakeLoopObj.level = screencommands.args[0].level;\r\n                                this.sceneProxy.shakeLoopObj.duration = screencommands.args[0].duration;\r\n                                this.sceneProxy.shakeLoopObj.delay = screencommands.args[0].delay;\r\n                                this.sceneProxy.shakeLoopObj.commands = screencommands;//记录当前的指令\r\n                                const doShake = ()=>{\r\n                                    this.sceneProxy.curPlotLayer.isShaking = true;\r\n                                    return sceneShake(screencommands.args[0].level ? screencommands.args[0].level * 5 : 18, screencommands.args[0].duration, screencommands.args[0].delay).then(()=>{\r\n                                        this.sceneProxy.curPlotLayer.isShaking = false;\r\n                                        if(screencommands.args[0].loop && screencommands.args[0].level > 0 && this.sceneProxy.shakeLoopObj.loop){\r\n                                            //喜欢振动 时间延迟设为0\r\n                                            screencommands.args[0].delay = 0;\r\n                                            return doShake();\r\n                                        }else{\r\n                                            return Promise.resolve();\r\n                                        }\r\n                                    });\r\n                                }\r\n                                doShake().then(()=>{\r\n                                    //\r\n                                    this.sceneProxy.curPlotLayer.isShaking = false;\r\n                                })\r\n                            }\r\n                            if (!snapInfo.music || ResourcesManager.usingKeyMap.music === '') { //声音中断\r\n                                this.sceneProxy.stopMusic();\r\n                            }\r\n                            if (snapInfo.music && (this.viewComponent.game.load.cache.checkSoundKey(snapInfo.music.url)\r\n                                    || 'ios' === flashvars.client && flashvars.app_version >= '1.5.0')) {\r\n                                let volume = snapInfo.music.volume;\r\n                                if(snapInfo.music.inheritvolume !== undefined && snapInfo.music.inheritvolume !== -1){volume = snapInfo.music.inheritvolume}\r\n                                this.sceneProxy.stopMusic(snapInfo.music.url);\r\n                                this.sceneProxy.playMusic(snapInfo.music.url, volume, true);\r\n                            }\r\n\r\n                            for (let item in snapInfo.sounds) {\r\n                                if (snapInfo.sounds[item] && ResourcesManager.usingKeyMap.sounds[item] !== '') { //音效没有被中断\r\n                                    if (this.viewComponent.game.load.cache.checkSoundKey(snapInfo.sounds[item].url)\r\n                                        || 'ios' === flashvars.client && flashvars.app_version >= '1.5.0') {\r\n                                        let volume = snapInfo.sounds[item].volume;\r\n                                        if (snapInfo.sounds[item].inheritvolume !== undefined && snapInfo.sounds[item].inheritvolume !== -1) {\r\n                                            volume = snapInfo.sounds[item].inheritvolume\r\n                                        }\r\n                                        this.sceneProxy.stopSound(item, snapInfo.sounds[item].url, true);\r\n                                        this.sceneProxy.playSound(item, snapInfo.sounds[item].url, volume, snapInfo.sounds[item].time === 0);\r\n                                    }\r\n                                }\r\n                                if (snapInfo.music && (this.viewComponent.game.load.cache.checkSoundKey(snapInfo.music.url)\r\n                                        || 'ios' === flashvars.client && flashvars.app_version >= '1.5.0')) {\r\n                                    let volume = snapInfo.music.volume;\r\n                                    if (snapInfo.music.inheritvolume !== undefined && snapInfo.music.inheritvolume !== -1) {\r\n                                        volume = snapInfo.music.inheritvolume\r\n                                    }\r\n                                    this.sceneProxy.stopMusic(snapInfo.music.url);\r\n                                    this.sceneProxy.playMusic(snapInfo.music.url, volume, true);\r\n                                }\r\n\r\n                                for (let item in snapInfo.sounds) {\r\n                                    if (snapInfo.sounds[item] && ResourcesManager.usingKeyMap.sounds[item] !== '') { //音效没有被中断\r\n                                        if (this.viewComponent.game.load.cache.checkSoundKey(snapInfo.sounds[item].url)\r\n                                            || 'ios' === flashvars.client && flashvars.app_version >= '1.5.0') {\r\n                                            let volume = snapInfo.sounds[item].volume;\r\n                                            if (snapInfo.sounds[item].inheritvolume !== undefined && snapInfo.sounds[item].inheritvolume !== -1) {\r\n                                                volume = snapInfo.sounds[item].inheritvolume\r\n                                            }\r\n                                            this.sceneProxy.stopSound(item, snapInfo.sounds[item].url, true);\r\n                                            this.sceneProxy.playSound(item, snapInfo.sounds[item].url, volume, snapInfo.sounds[item].time === 0);\r\n                                        }\r\n                                    }\r\n                                    else {\r\n                                        this.sceneProxy.stopSound(item);\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                            !snapInfo.bk && (snapInfo.bk = {opacity: 0});\r\n                            bkSprite = this.sceneProxy.curPlotLayer.create(0, 0, snapInfo.bk.url);\r\n                            bkSprite.alpha = snapInfo.bk.opacity;\r\n                            bkSprite.width = this.viewComponent.game.world.width;\r\n                            bkSprite.height = this.viewComponent.game.world.height;\r\n                            this.viewComponent.addGifAnimation(bkSprite, snapInfo.bk.url);\r\n                            if (!this.sceneProxy.charsAndPropsLayer || !this.sceneProxy.charsAndPropsLayer.exists) {\r\n                                this.sceneProxy.charsAndPropsLayer = this.viewComponent.game.add.group();\r\n                                this.sceneProxy.charsAndPropsLayer.name = \"charactersAndProps\";\r\n                            }\r\n                            for (let item of snapInfo.charsAndProps) {\r\n                        \tconst x = item.x;\r\n                        \tconst y = item.y;\r\n                            item.width = Math.abs(item.width)\r\n                            item.height = Math.abs(item.height)\r\n                            if (item.pivotX && item.pivotY) {\r\n                                item.x -= item.width / 2;\r\n                                item.y -= item.height / 2;\r\n                            }\r\n                            const ch = this.viewComponent.addFitImageSprint(item.x, item.y, Math.abs(item.width), item.height, item.url, this.sceneProxy.charsAndPropsLayer, item.index);\r\n                        \tch.alpha = item.opacity;\r\n                            ch.angle = item.rotate;\r\n                            if (item.pivotX) {\r\n                                ch.scale.x = item.scaleX;\r\n                                ch.scale.y = item.scaleY;\r\n                                ch.x = x;\r\n                                ch.y = y;\r\n                                if (item.mirrorH) ch.mirrorH = true;\r\n                                if (item.mirrorV) ch.mirrorV = true;\r\n                            }else {\r\n                                if (item.mirrorH) {\r\n                                    ch.angle = -ch.angle;\r\n                                    ch.scale.x = -ch.scale.x;\r\n                                    ch.mirrorH = true;\r\n                                }\r\n                                if (item.mirrorV) {\r\n                                    ch.angle = -ch.angle;\r\n                                    ch.scale.y = -ch.scale.y;\r\n                                    ch.mirrorV = true;\r\n                                }\r\n                            }\r\n                                //\r\n                                ch.cmdUuid = item.cmdUuid;\r\n                                if (item.parentScale) {\r\n                                    ch.parent.scale.setTo(item.parentScale, item.parentScale);\r\n                                }\r\n                                this.viewComponent.addGifAnimation(ch, item.url);\r\n                            }\r\n                            this.sceneProxy.weatherType !== '' && addWeather(snapInfo.weatherType);\r\n                            this.sceneProxy.bCmdAutoText = snapInfo.autoText;\r\n\r\n                            if (snapInfo.dialogInfo[0] && (index >= commands.length || index < commands.length && commands[index].type !== 'showDialog')) {\r\n                                addDialogLayer(snapInfo.dialogInfo[0]);\r\n                                doSpeak(snapInfo.dialogInfo[0].speaking, true);\r\n                                //let txt = Expression.parseWaitTime(Expression.parseValue(snapInfo.dialogInfo[0].speaking.data, context));\r\n                                //contentTxt.text = this.viewComponent.game.device.desktop ? txt : txt.replace(new RegExp(' ', 'gm'), '  ');\r\n                            } else {\r\n                                this.sceneProxy.dialogLayer.visible = false;\r\n                            }\r\n                            const recbubble = ()=>{\r\n                                isRecover = true;\r\n                                if (this.sceneProxy.bubbleLayer.children.length > 0) {\r\n                                    this.sceneProxy.bubbleLayer.removeAll(true);\r\n                                }\r\n                                return new Promise((resolve,reject)=> {\r\n                                    //恢复气泡\r\n                                    const addborder = (i)=>{\r\n                                        if(this.sceneProxy.saveBubbleVector[i]){\r\n                                            let bordercommands = this.sceneProxy.saveBubbleVector[i].commands;\r\n                                            let id = hasborder(bordercommands.args[0].index);\r\n                                            const border = this.addBubbleBorder(this.sceneProxy.bubbleLayer, bordercommands);\r\n                                            if(id !==-1){\r\n                                                const saveary = this.sceneProxy.saveBubbleVector[id].savebubble.concat();\r\n                                                const curary = this.sceneProxy.saveBubbleVector[id].curbubble.concat();\r\n                                                const hide = this.sceneProxy.saveBubbleVector[i].ishide;\r\n                                                const iscurrent = this.sceneProxy.saveBubbleVector[i].iscurrent;\r\n                                                this.sceneProxy.saveBubbleVector[id] = border;\r\n                                                border.savebubble = saveary.concat();\r\n                                                border.curbubble = curary.concat();\r\n                                                border.ishide = hide;\r\n                                                border.iscurrent = iscurrent;\r\n                                                border.itemlength = 0;\r\n                                                border.visible = (border.ishide === false);\r\n                                            }else{\r\n                                                this.sceneProxy.saveBubbleVector.push(border);\r\n                                                border.savebubble = [];\r\n                                                border.curbubble = [];\r\n                                                border.itemlength = 0;\r\n                                            }\r\n                                            border.iscurrent && (curborder = border);\r\n                                            return Promise.resolve(border)\r\n                                        }else{\r\n                                            return Promise.reject();\r\n                                        }\r\n                                    }\r\n\r\n                                    const addbubble = (j,border)=>{\r\n                                        if(border.savebubble[j]){\r\n                                            let bubblecommands = border.savebubble[j];\r\n                                            return this.createBubble(bubblecommands, border).then((b)=>{\r\n                                                j ++;\r\n                                                return addbubble(j,border);\r\n                                            })\r\n                                        }else{\r\n                                            return Promise.resolve();\r\n                                        }\r\n                                    }\r\n                                    let i = 0;\r\n                                    let j = 0;\r\n                                    const recover = (i)=>{\r\n                                        return addborder(i).then((b) =>{\r\n                                            j =0;\r\n                                            return addbubble(j,b).then(()=>{\r\n                                                i++;\r\n                                                return recover(i)\r\n                                            })\r\n                                        },()=>{\r\n                                            //全部加完\r\n                                            return resolve();\r\n                                        })\r\n                                    }\r\n                                    return recover(i);\r\n                                })\r\n                            }\r\n                            const recViews = ()=>{\r\n                                this.sceneProxy.removeViewTimer(this.sceneProxy.plotViewsLayer);\r\n                                this.sceneProxy.removeInputView(this.sceneProxy.plotViewsLayer);\r\n                                this.sceneProxy.plotViewsLayer.removeAll(true);\r\n                                this.sceneProxy.filterInexistentPlotViews(snapInfo.plotViews, plot);\r\n                                this.removeViewKey(this.sceneProxy.plotViewKeys);\r\n                                loadSubViews(snapInfo.plotViews);\r\n                                this.viewComponent.game.world.bringToTop(this.sceneProxy.plotViewsLayer);\r\n                                for (let i in this.sceneProxy.globalViews) {\r\n                                    if (!this.sceneProxy.globalViews[i].visible) {\r\n                                        for (let q in this.sceneProxy.json_data.views) {\r\n                                            if (this.sceneProxy.json_data.views[q].ref === this.sceneProxy.globalViews[i].name) {\r\n                                                hideGlobalViews[i] = (this.sceneProxy.json_data.views[q].instanceUuid);\r\n                                                break;\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                                showGlobalViews(true, hideGlobalViews);\r\n                            }\r\n                            const recMenu = ()=>{\r\n                                if (snapInfo.menuInfo[0]) {\r\n                                    this.addMenuLayer(false);\r\n                                    this.sceneProxy.menuLayer.x = snapInfo.menuInfo[0].x;\r\n                                    this.sceneProxy.menuLayer.y = snapInfo.menuInfo[0].y;\r\n                                }\r\n                            }\r\n                            return recbubble().then(()=>{\r\n                                recViews();\r\n                                recMenu();\r\n                                return resolve();\r\n                            })\r\n                        })\r\n                    };\r\n\t\t\t\t\t//查找已有气泡 是否存在\r\n                    const hasborder = (index)=>{\r\n                        if(this.sceneProxy.saveBubbleVector.length > 0){\r\n                            for(let i = 0;i <this.sceneProxy.saveBubbleVector.length;i++ ){\r\n                                if(parseInt(this.sceneProxy.saveBubbleVector[i].index) === parseInt(index) && this.sceneProxy.saveBubbleVector[i]){\r\n                                    return i;\r\n                                }\r\n                            }\r\n                        }\r\n                        return -1;\r\n                    };\r\n                    const resetBorder = () =>{\r\n                        this.sceneProxy.saveBubbleVector.forEach((b,index)=>{b.iscurrent = false});\r\n                    }\r\n\t\t\t\t\tconst handle = (cmdInfo, i) =>{\r\n                        let action = {type: ''};\r\n                        this.sceneProxy.curCmdInfo = cmdInfo;\r\n\t\t\t\t\t\tthis.sceneProxy.curCmdIndex = i;\r\n                        showGlobalViews(false, hideGlobalViews);\r\n\t\t\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\t\t    if ('systemUI' === cmdInfo.commands[i].type || 'jump' === cmdInfo.commands[i].type\r\n                                || 'back' === cmdInfo.commands[i].type || 'insert' === cmdInfo.commands[i].type) {\r\n\t\t\t\t\t\t\t    this.sceneProxy.cmdPlotNextPromise = null;\r\n                            }\r\n                            else if ('showDialog' === cmdInfo.commands[i].type) {\r\n\t\t\t\t\t\t        const nextCmdCallback = (a) => {\r\n                                    let pointer = new Phaser.Pointer(this.viewComponent.game, 1, Phaser.PointerMode.CURSOR);\r\n                                    pointer.button = 0;\r\n                                    this.sceneProxy.curPlotLayer.onChildInputDown.dispatch('nextCmd', pointer);\r\n                                    this.sceneProxy.curPlotLayer.onChildInputDown.dispatch('nextCmd', pointer);\r\n                                    resolve(a);\r\n                                };\r\n\t\t\t\t\t\t        this.sceneProxy.cmdPlotNextPromise = nextCmdCallback;\r\n                            }\r\n                            else {\r\n                                this.sceneProxy.cmdPlotNextPromise = resolve;\r\n                            }\r\n\r\n                            const commands = cmdInfo.commands;\r\n                            const args = commands[i].args;\r\n                            this.sceneProxy.curCmdUuid = commands[i].uuid;\r\n                            switch (commands[i].type) {\r\n                                case 'addView':\r\n                                    addPlotViews(args, null, commands[i].uuid);\r\n                                    this.sceneProxy.plotViewsLayer.visible = true;\r\n                                    break;\r\n                                case 'delView':\r\n                                    this.destroyView(args[0]);\r\n                                    break;\r\n\t\t\t\t\t\t\t\tcase 'systemUI':\r\n                                    this.sceneProxy.cmdPlotNextPromise = ()=>{resolve(action);}\r\n\t\t\t\t\t\t\t\t\tif (args[0] === 'save-record') {\r\n                                        const disableSaveOrLoad = this.sceneProxy.context.disableSaveOrLoad;\r\n                                        if (disableSaveOrLoad && disableSaveOrLoad.save) {\r\n                                            this.sceneProxy.showToast(1, '抱歉，作者在此设置了禁用存档');\r\n                                            return resolve(action);\r\n                                        }\r\n                                        !this.sceneProxy.mainMenuLayer.visible && this.sceneProxy.getSnap();\r\n                                        this.sceneProxy.showSave(false, {callbackFun:resolve, callbackArgs: action});\r\n                                        return;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse if (args[0] === 'load-record') {\r\n                                        const disableSaveOrLoad = this.sceneProxy.context.disableSaveOrLoad;\r\n                                        if (disableSaveOrLoad && disableSaveOrLoad.load) {\r\n                                            this.sceneProxy.showToast(1, '抱歉，作者在此设置了禁用读档');\r\n                                            return resolve(action);\r\n                                        }\r\n                                        this.sceneProxy.showLoad(false, {callbackFun:resolve, callbackArgs: action});\r\n                                        return;\r\n\t\t\t\t\t\t\t\t\t}\r\n                                    else if (args[0] === 'settings') {\r\n                                        this.sceneProxy.showPlayback({callbackFun:resolve, callbackArgs: action});\r\n                                        return;\r\n\t\t\t\t\t\t\t\t\t}\r\n                                    else if (args[0] === 'playback') {\r\n                                        this.sceneProxy.showSettings(context, {callbackFun:resolve, callbackArgs: action});\r\n                                        return;\r\n\t\t\t\t\t\t\t\t\t}\r\n                                case 'addImage':\r\n                                \tif (args[0].index === 1) {\r\n                                \t\tconst isInherit = args[0].url === 'inherit';\r\n                                        let bk_key = isInherit ? this.sceneProxy.lstPlotBkKey : args[0].url;\r\n                                        let bk_flex = isInherit ? this.sceneProxy.lstPlotBkFlex : args[0].flex;\r\n                                        let bk_alpha = isInherit ? this.sceneProxy.lstPlotBkOpacity : args[0].opacity;\r\n                                        if (this.viewComponent.game.load.cache.checkImageKey(bk_key)) {\r\n                                            let old = this.sceneProxy.curPlotLayer.children.splice(1, 1);\r\n                                            old.length && old[0].destroy();\r\n                                            bkSprite = this.sceneProxy.curPlotLayer.create(args[0].x, args[0].y, bk_key);\r\n                                            bkSprite.alpha = bk_alpha === undefined ? 1 : bk_alpha;\r\n                                            this.backgroundFlex(bkSprite, bk_flex);\r\n                                            if (this.sceneProxy.lstGameBk && this.sceneProxy.lstGameBk.visible) {this.sceneProxy.lstGameBk.visible = false;}\r\n                                            this.sceneProxy.prePlotBkKey = this.sceneProxy.lstPlotBkKey;\r\n                                            this.sceneProxy.lstPlotBkKey = bk_key;\r\n                                            this.sceneProxy.lstPlotBkOpacity = bk_alpha;\r\n                                            this.sceneProxy.lstPlotBkFlex = bk_flex;\r\n                                            this.viewComponent.addGifAnimation(bkSprite, args[0].url);\r\n                                        }\r\n\t\t\t\t\t\t\t\t\t}\r\n                                \telse {\r\n                                        addCharsProps(args, [], commands[i].uuid);\r\n\t\t\t\t\t\t\t\t\t}\r\n                                    showGlobalViews(false, hideGlobalViews);\r\n                                    break;\r\n                                case 'delImage':\r\n                                \tif (1 === args[0]) {\r\n                                        let old = this.sceneProxy.curPlotLayer.children.splice(1, 1);\r\n                                        old.length && old[0].destroy();\r\n\t\t\t\t\t\t\t\t\t} else {\r\n                                        for (let i=0; i<this.sceneProxy.charsAndPropsLayer.children.length; i++) {\r\n                                            let rs = this.sceneProxy.charsAndPropsLayer.getAt(i);\r\n                                            if (-1 === rs) break;\r\n                                            if (rs.zIndex === args[0]) {\r\n                                                this.sceneProxy.charsAndPropsLayer.removeChildAt(i);\r\n                                                rs.destroy();\r\n                                                break;\r\n                                            }\r\n                                        }\r\n\t\t\t\t\t\t\t\t\t}\r\n                                    break;\r\n                                case 'showMenu':\r\n                                    this.sceneProxy.menuInfo = args.concat();\r\n                                    this.addMenuLayer(false);\r\n                                    this.sceneProxy.menuLayer.x = args[0].x;\r\n                                    this.sceneProxy.menuLayer.y = args[0].y;\r\n                                    break;\r\n                                case 'hideMenu':\r\n                                    this.sceneProxy.menuInfo = [];\r\n                                    this.sceneProxy.menuLayer.visible = false;\r\n                                    break;\r\n                                case 'showGlobalView':\r\n                                    for (let i=0; i<hideGlobalViews.length; i++) {\r\n                                        if (hideGlobalViews[i] === args[0]) {\r\n                                            hideGlobalViews.splice(i, 1);\r\n                                            break;\r\n                                        }\r\n                                    }\r\n                                    showGlobalViews(false, hideGlobalViews);\r\n                                    break;\r\n                                case 'hideGlobalView':\t{\r\n                                    let i = 0;\r\n                                    for (; i<hideGlobalViews.length; i++) {\r\n                                        if (hideGlobalViews[i] === args[0]) break;\r\n                                    }\r\n                                    if (i >= hideGlobalViews.length) hideGlobalViews[i] = args[0];\r\n                                }\r\n                                    showGlobalViews(false, hideGlobalViews);\r\n                                    break;\r\n                                case 'showDialog':\r\n                                    this.sceneProxy.lstDialogInfo = args.concat();\r\n                                    this.sceneProxy.dialogLayer.animateTweens.forEach((t,i) => {t.stop()});\r\n                                    this.sceneProxy.dialogLayer.animateTweens.splice(0);\r\n                                    savePlayBackContent(args[0]);\r\n                                    return addDialogLayer(args[0])\r\n                                        .then(() => {\r\n                                            if (args[0].speaking.coverage && args[0].speaking.coverage === 'bottom') {\r\n                                                this.viewComponent.game.world.bringToTop(this.sceneProxy.charsAndPropsLayer);\r\n                                                this.viewComponent.game.world.bringToTop(this.sceneProxy.bubbleLayer);\r\n                                                this.viewComponent.game.world.bringToTop(this.sceneProxy.weatherLayer);\r\n                                                this.sceneProxy.dialogLayer.isbottom = true;//底部属性\r\n                                            }else{\r\n                                                this.viewComponent.game.world.bringToTop(this.sceneProxy.dialogLayer);\r\n                                                this.viewComponent.game.world.bringToTop(this.sceneProxy.weatherLayer);\r\n                                                this.sceneProxy.dialogLayer.isbottom = false;//底部属性\r\n                                            }\r\n                                            this.viewComponent.game.world.bringToTop(this.sceneProxy.plotViewsLayer);\r\n                                            showGlobalViews(false, hideGlobalViews);\r\n                                            return doSpeak(args[0].speaking)\r\n                                        })\r\n                                        .then(() => {\r\n                                            const hasView = this.sceneProxy.plotViewsLayer.children.length > 0;\r\n                                            const hasBubble = this.sceneProxy.bubbleLayer.children.length > 0;\r\n                                            if ((this.sceneProxy.bCmdAutoText || (!hasView && (this.sceneProxy.quickPlay || this.sceneProxy.context.auto))) && !this.sceneProxy.playPause) { // 自动播放下一指令\r\n                                                Utils.timeout(100).then(()=>{return resolve(action);})\r\n                                            } else {\r\n                                                const onClick = (o, e) => {\r\n                                                    if (e && e.pointerMode === Phaser.PointerMode.CURSOR && e.button !== 0 || 'auto' === o && hasView ) {\r\n                                                        return;\r\n                                                    }\r\n                                                    this.sceneProxy.curPlotLayer.onChildInputDown.remove(onClick);\r\n                                                    if ('insertPlot' === o)  {\r\n                                                        return reject();\r\n                                                    } else {\r\n                                                        return resolve(action)\r\n                                                    }\r\n                                                };\r\n                                                this.sceneProxy.curPlotLayer.onChildInputDown.add(onClick);\r\n                                                if(hasBubble){\r\n                                                    this.sceneProxy.dialogNext = ()=>{\r\n                                                        this.sceneProxy.dialogNext = null;\r\n                                                        return resolve(action)\r\n                                                    }\r\n                                                }\r\n                                                //hasBubble && this.sceneProxy.dialogLayer.onChildInputDown.addOnce(onClick)\r\n                                                !hasView && this.sceneProxy.space_key.onDown.addOnce(() => {return resolve(action)});\r\n                                            }\r\n                                        });\r\n                                case 'hideDialog':\r\n                                    this.sceneProxy.lstDialogInfo = [];\r\n                                    this.sceneProxy.dialogLayer.visible = false;\r\n                                    break;\r\n                                case 'playMusic':\r\n                                    playMusic(args[0]);\r\n                                    break;\r\n                                case 'stopMusic':\r\n                                    this.sceneProxy.stopMusic();\r\n                                    break;\r\n                                case 'playSound':\r\n                                    if (args[0].url === 'inherit') {\r\n                                    \tif (this.sceneProxy.plotSounds[args[0].index]) {\r\n\t\t\t\t\t\t\t\t\t\t\tthis.sceneProxy.playInheritSound(args[0].index, args[0].volume);\r\n                                        }\r\n                                        break;\r\n                                    }\r\n                                    else if (this.viewComponent.game.load.cache.checkSoundKey(args[0].url)\r\n                                            || 'ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n                                        this.sceneProxy.stopSound(args[0].index, args[0].url);\r\n                                        this.sceneProxy.playSound(args[0].index, args[0].url, args[0].volume, args[0].time === 0);\r\n                                    }\r\n                                    break;\r\n                                case 'stopSound':\r\n                                    this.sceneProxy.stopSound(args[0]);\r\n                                    break;\r\n                                case 'animateImage':\r\n                                    if(this.sceneProxy.dialogLayer.visible !== false){//非底部对话框，层级低于素材层级时置顶\r\n                                        const index1= this.viewComponent.game.world.getChildIndex(this.sceneProxy.dialogLayer)\r\n                                        const index2= this.viewComponent.game.world.getChildIndex(this.sceneProxy.charsAndPropsLayer)\r\n                                        if(index1 < index2 && !this.sceneProxy.dialogLayer.isbottom){\r\n                                            this.viewComponent.game.world.bringToTop(this.sceneProxy.dialogLayer);\r\n                                        }\r\n                                    }\r\n                                    if(this.sceneProxy.menuLayer.visible !== false){\r\n                                        this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n                                        this.viewComponent.game.world.bringToTop(this.sceneProxy.plotViewsLayer);\r\n                                        showGlobalViews(false, hideGlobalViews);\r\n                                    }\r\n                                    const delay = this.sceneProxy.quickPlay ? 0 : args[0].delay;\r\n                                    const duration = this.sceneProxy.quickPlay ? 0 : args[0].duration;\r\n                                    if (args[0].index > 1 && this.sceneProxy.charsAndPropsLayer.exists) {\r\n                                        for (let i=0; i<this.sceneProxy.charsAndPropsLayer.children.length; i++) {\r\n                                            let imgGroup = this.sceneProxy.charsAndPropsLayer.children[i];\r\n                                            if (imgGroup.zIndex === args[0].index) {\r\n                                            \tlet img = imgGroup.children[0];\r\n                                            \tconst doAnimation = () => {\r\n                                            \t\t// begin结束前一次缓动并赋予缓动最终状态\r\n                                                    if (imgGroup.animateTweens) {\r\n                                                    \timgGroup.animateTweens.forEach((t,i) => {t.stop(false)});\r\n                                                        imgGroup.animateTweens.splice(0);\r\n                                                    }\r\n                                                    if (img.animateTweens) {\r\n                                                    \timg.animateTweens.forEach((t,i) => {t.stop(false)});\r\n                                                        img.animateTweens.splice(0);\r\n                                                    }\r\n                                                    if (img.finalState) {\r\n                                                    \timg.alpha = img.finalState.alpha;\r\n                                                        img.angle = img.finalState.angle;\r\n                                                        img.x = img.finalState.x;\r\n                                                        img.y = img.finalState.y;\r\n                                                        imgGroup.x = 0;\r\n                                                        imgGroup.y = 0;\r\n                                                        imgGroup.scale.x = imgGroup.finalState.scale.x;\r\n                                                        imgGroup.scale.y = imgGroup.finalState.scale.y;\r\n                                                    }// -end\r\n\r\n                                                    let alpha = args[0].opacity;\r\n                                                    let angle = parseInt(args[0].rotate) === 180 ? 179.9 : args[0].rotate;\r\n                                                    let scaleX = args[0].scaleX === undefined ? 1 : args[0].scaleX;\r\n                                                    let scaleY = args[0].scaleY === undefined ? 1 : args[0].scaleY;\r\n                                                    let x = args[0].x / scaleX + img.width/2;\r\n                                                    let y = args[0].y / scaleY + img.height/2;\r\n\r\n\r\n                                                    img.mirrorH && (angle = -angle, x -= img.width);\r\n                                                    img.mirrorV && (angle = -angle, y -= img.height);\r\n\r\n                                                    if (!img.lstAlpha && img.alpha !== alpha || img.lstAlpha !== alpha) {\r\n                                                        img.lstAlpha = alpha;\r\n                                                        this.tweenToPromise(img, {alpha: alpha}, duration, null, true, delay);\r\n                                                    }\r\n                                                    if (!img.lstAngle && img.angle !== angle || img.lstAngle !== angle) {\r\n                                                        img.lstAngle = angle;\r\n                                                        this.tweenToPromise(img, {angle: angle}, duration, null, true, delay);\r\n                                                    }\r\n                                                    if (!img.lstX && img.x !== x || img.lstX !== x) {\r\n                                                        img.lstX = x;\r\n                                                        let xRaw = img.mirrorH ? (img.x + img.width/2)  * imgGroup.scale.x : (img.x - img.width/2)  * imgGroup.scale.x;\r\n                                                        let xMoveTo = args[0].x - xRaw * (scaleX / imgGroup.scale.x);\r\n                                                        this.tweenToPromise(imgGroup, {x:xMoveTo}, duration, null, true, delay).then(()=>{\r\n                                                            imgGroup.x = 0;\r\n                                                            img.x = img.lstX;\r\n                                                        });\r\n                                                        //this.tweenToPromise(img, {x: x}, args[0].duration, null, true, args[0].delay);\r\n                                                    }\r\n                                                    if (!img.lstY && img.y !== y || img.lstY !== y) {\r\n                                                        img.lstY = y;\r\n                                                        let yRaw = img.mirrorV ? (img.y + img.height/2) * imgGroup.scale.y : (img.y - img.height/2) * imgGroup.scale.y;\r\n                                                        let yMoveTo = args[0].y - yRaw * (scaleY / imgGroup.scale.y);\r\n                                                        this.tweenToPromise(imgGroup, {y:yMoveTo}, duration, null, true, delay).then(()=>{\r\n                                                            imgGroup.y = 0;\r\n                                                            img.y = img.lstY;\r\n                                                        });\r\n                                                        //this.tweenToPromise(img, {y: y}, args[0].duration, null, true, args[0].delay);\r\n                                                    }\r\n                                                    img.finalState = {alpha:alpha, angle:angle, x:x, y:y};\r\n\r\n                                                    if (!imgGroup.lstScaleX && imgGroup.scale.x !== scaleX || imgGroup.lstScaleX !== scaleX) {\r\n                                                        imgGroup.lstScaleX = scaleX;\r\n                                                        this.tweenToPromise(imgGroup.scale, {x:scaleX}, duration, null, true, delay);\r\n                                                    }\r\n                                                    if (!imgGroup.lstScaleY && imgGroup.scale.y !== scaleY || imgGroup.lstScaleY !== scaleY) {\r\n                                                        imgGroup.lstScaleY = scaleY;\r\n                                                        this.tweenToPromise(imgGroup.scale, {y:scaleY}, duration, null, true, delay);\r\n                                                    }\r\n                                                    imgGroup.finalState = {scale:{x:scaleX, y:scaleY}};\r\n\t\t\t\t\t\t\t\t\t\t\t\t};\r\n                                            \tdoAnimation();\r\n                                                break;\r\n                                            }\r\n                                        }\r\n                                    } else if (args[0].index === 1 && this.sceneProxy.curPlotLayer.children[1]) {\r\n                                    \tthis.tweenToPromise(this.sceneProxy.curPlotLayer.children[1], {alpha: args[0].opacity}, duration, null, true, delay).then(()=>{\r\n                                            this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n                                    \t    this.viewComponent.game.world.bringToTop(this.sceneProxy.plotViewsLayer);\r\n                                            showGlobalViews(false, hideGlobalViews);\r\n                                        });\r\n                                    \tthis.sceneProxy.curPlotLayer.children[1].finalState = {alpha: args[0].opacity};\r\n                                    \tthis.sceneProxy.lstPlotBkOpacity = args[0].opacity;\r\n\t\t\t\t\t\t\t\t\t}\r\n                                    break;\r\n                                case 'animateDialog':\r\n                                    if (this.sceneProxy.dialogLayer.visible) {\r\n                                    \tlet delay = this.sceneProxy.quickPlay ? 0 : args[0].delay;\r\n                                    \tlet duration = this.sceneProxy.quickPlay ? 0 : args[0].duration;\r\n                                        const normalPropsTo = () => {\r\n                                            let properties = {alpha:args[0].opacity, angle:args[0].rotate, x:parseFloat(args[0].x), y:parseFloat(args[0].y)};\r\n                                            if(this.sceneProxy.lstDialogInfo[0]){\r\n                                                this.sceneProxy.lstDialogInfo[0].opacity = args[0].opacity;\r\n                                                this.sceneProxy.lstDialogInfo[0].rotate = args[0].rotate;\r\n                                                this.sceneProxy.lstDialogInfo[0].x = args[0].x;\r\n                                                this.sceneProxy.lstDialogInfo[0].y = args[0].y;\r\n                                            }\r\n                                            return this.tweenToPromise(this.sceneProxy.dialogLayer, properties, duration, null, true, delay).then(()=>{\r\n                                                this.sceneProxy.dialogLayer.visible = true;\r\n                                                !this.sceneProxy.dialogLayer.isbottom && this.viewComponent.game.world.bringToTop(this.sceneProxy.dialogLayer)\r\n                                            });\r\n                                        };\r\n                                        const scalePropTo = () => {\r\n                                            return this.tweenToPromise(this.sceneProxy.dialogLayer.scale, {x:args[0].scaleX, y:args[0].scaleY}, duration, null, true, delay).then(()=>{\r\n                                                this.sceneProxy.dialogLayer.visible = true;\r\n                                                !this.sceneProxy.dialogLayer.isbottom && this.viewComponent.game.world.bringToTop(this.sceneProxy.dialogLayer)\r\n                                            });\r\n                                        };\r\n                                        normalPropsTo() && scalePropTo();\r\n                                    }\r\n                                    break;\r\n                                case 'animateScene':\r\n                                \tif (! this.sceneProxy.quickPlay) {\r\n                                        if (args[0].type === 'twinkle') {\r\n                                            sceneTwinkle(args[0].duration, args[0].delay, args[0].color);\r\n                                        }\r\n                                        if (args[0].type === 'shake') {\r\n                                            let loop = args[0].loop && args[0].loop || false;\r\n                                            if ((!loop || this.sceneProxy.shakeLoopObj.loop) && this.sceneProxy.curPlotLayer.isShaking === true ) {\r\n                                                clearShake();\r\n                                            }\r\n                                            this.sceneProxy.shakeLoopObj.loop = loop\r\n                                            this.sceneProxy.shakeLoopObj.level = args[0].level;\r\n                                            this.sceneProxy.shakeLoopObj.duration = args[0].duration;\r\n                                            this.sceneProxy.shakeLoopObj.delay = args[0].delay;\r\n                                            this.sceneProxy.shakeLoopObj.commands = commands[i];//记录当前的指令\r\n                                            if (!this.sceneProxy.curPlotLayer.isShaking && args[0].duration) {\r\n                                                const doShake = ()=>{\r\n                                                    this.sceneProxy.curPlotLayer.isShaking = true;\r\n                                                    return sceneShake(args[0].level ? args[0].level * 5 : 18, args[0].duration, args[0].delay).then(()=>{\r\n                                                        this.sceneProxy.curPlotLayer.isShaking = false;\r\n                                                        if(this.sceneProxy.shakeLoopObj.loop && args[0].level > 0){\r\n                                                            if(args[0].level !== this.sceneProxy.shakeLoopObj.level) args[0].level = this.sceneProxy.shakeLoopObj.level; //振动级别变化\r\n                                                            if(args[0].duration !== this.sceneProxy.shakeLoopObj.duration) args[0].duration = this.sceneProxy.shakeLoopObj.duration; //振动持续时间变化\r\n                                                            //if(args[0].delay !== this.sceneProxy.shakeLoopObj.delay) args[0].level = this.sceneProxy.shakeLoopObj.delay; //振动延迟时间变化\r\n                                                            //继续喜欢振动  延迟设为0\r\n                                                            args[0].delay = 0;\r\n                                                            return doShake();\r\n                                                        }else{\r\n                                                            return Promise.resolve();\r\n                                                        }\r\n                                                    });\r\n                                                }\r\n                                                doShake().then(()=>{\r\n                                                    //\r\n                                                    this.sceneProxy.curPlotLayer.isShaking = false;\r\n                                                })\r\n                                            }\r\n                                        }\r\n                                        if(args[0].type === 'spread'){\r\n                                            //展开\r\n                                            !this.sceneProxy.curPlotLayer.isSpreading && spread(args[0].duration, args[0].delay)\r\n                                        }\r\n\t\t\t\t\t\t\t\t\t}\r\n                                    break;\r\n                                case 'animateMusic':\r\n                                    if(this.sceneProxy.bk_music){\r\n                                        this.sceneProxy.bk_music.prevolume = args[0].volume;\r\n                                        this.sceneProxy.bk_music.inheritvolume = args[0].volume;\r\n                                    }\r\n                                    if ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n                                        if(PhoneUtils.musicInfo){\r\n                                            PhoneUtils.musicInfo.inheritvolume = args[0].volume;\r\n                                            PhoneUtils.musicInfo.prevolume = args[0].volume;\r\n                                        }\r\n                                        args[0].volume *= Utils.musicVolume;\r\n                                        PhoneUtils.tweenToMusic(args[0].volume, args[0].duration, args[0].delay);\r\n                                    } else {\r\n                                        args[0].volume *= Utils.musicVolume;\r\n                                        if(this.sceneProxy.bk_music){\r\n                                            this.sceneProxy.bk_music.animateMusic = 'music';//声音动画\r\n                                            this.tweenToPromise(this.sceneProxy.bk_music, {volume: args[0].volume}, args[0].duration, null, true, args[0].delay).then(()=>{\r\n                                                //this.sceneProxy.bk_music.volume = (this.sceneProxy.bk_music.prevolume * Utils.musicVolume);\r\n                                            })\r\n                                        }\r\n                                    }\r\n                                    break;\r\n                                case 'animateSound':\r\n                                    if(this.sceneProxy.plotSounds[args[0].index]){\r\n                                        this.sceneProxy.plotSounds[args[0].index].prevolume = args[0].volume;\r\n                                        this.sceneProxy.plotSounds[args[0].index].inheritvolume = args[0].volume;\r\n                                    }\r\n                                    if ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n                                        if(PhoneUtils.soundsInfo[args[0].index]){\r\n                                            PhoneUtils.soundsInfo[args[0].index].prevolume = args[0].volume;\r\n                                            PhoneUtils.soundsInfo[args[0].index].inheritvolume = args[0].volume;\r\n                                        }\r\n                                        args[0].volume *= Utils.soundVolume;\r\n                                        PhoneUtils.tweenToSound(args[0].index, args[0].volume, args[0].duration, args[0].delay);\r\n                                    } else {\r\n                                        args[0].volume *= Utils.soundVolume;\r\n                                        if(this.sceneProxy.plotSounds[args[0].index]){\r\n                                            this.sceneProxy.plotSounds[args[0].index].animateMusic = 'sound';//音效动画\r\n                                            this.tweenToPromise(this.sceneProxy.plotSounds[args[0].index], {volume: args[0].volume}, args[0].duration, null, true, args[0].delay).then(()=>{\r\n                                                this.sceneProxy.plotSounds[args[0].index].volume = this.sceneProxy.plotSounds[args[0].index].prevolume * Utils.soundVolume;\r\n                                            });\r\n                                        }                                        \r\n                                    }\r\n                                    break;\r\n                                case 'setValues':\r\n                                    this.sceneProxy.valueOperation(context, args,false,()=>{\r\n                                        return resolve(action);\r\n                                    });\r\n                                    break;\r\n                                case 'wait':\r\n                                \tif (this.sceneProxy.quickPlay && this.sceneProxy.preWaitCmdUuid !== commands[i].uuid) { // 上一等待指令与当前等待指令相同，说明作者设置了循环等待\r\n                                \t    this.sceneProxy.preWaitCmdUuid = commands[i].uuid;\r\n                                        return resolve(action);\r\n\t\t\t\t\t\t\t\t\t}\r\n                                    return playWait(args[0].value, { type: 0 }).then(() => {\r\n                                        if(this.sceneProxy.curCmdInfo !== cmdInfo) {\r\n                                            //高级剧情wait返回的指令集与当前正在播放的指令集不相同，无需执行指令 重置章节数据，剧情编号，指令集，指令编号\r\n                                            chapter = {};\r\n                                            Object.assign(chapter,this.sceneProxy.curChapter)\r\n                                            nPlot = this.sceneProxy.curPlotIndex;\r\n                                            cmdInfo = {};\r\n                                            Object.assign(cmdInfo,this.sceneProxy.curCmdInfo);\r\n                                            i  = this.sceneProxy.curCmdIndex;\r\n                                            return resolve(false);\r\n                                        }\r\n                                \t    return resolve(action)\r\n                                \t});\r\n                                case 'jump':\r\n                                    this.sceneProxy.context = JSON.parse(JSON.stringify(this.sceneProxy.context));\r\n                                    this.showNextPlot(this.sceneProxy.context, this.sceneProxy.curChapter, this.sceneProxy.curPlotIndex, 'jump', args[0]);\r\n                                    return resolve(false);\r\n                                case 'back':\r\n                                    this.sceneProxy.context = JSON.parse(JSON.stringify(this.sceneProxy.context));\r\n                                    this.showNextPlot(this.sceneProxy.context, this.sceneProxy.curChapter, this.sceneProxy.curPlotIndex, 'back');\r\n                                    return resolve(false);\r\n                                case 'insert':\r\n                                    this.showNextPlot(this.sceneProxy.context, this.sceneProxy.curChapter, this.sceneProxy.curPlotIndex, 'insertPlot', args[0]);\r\n                                    return resolve(false);\r\n                                case 'options':\r\n                                    isRecover = false;\r\n                                    if (!this.sceneProxy.optionLayer || !this.sceneProxy.optionLayer.exists) {\r\n                                        this.sceneProxy.optionLayer = this.viewComponent.game.add.group();\r\n                                    }\r\n                                    this.viewComponent.game.world.bringToTop(this.sceneProxy.optionLayer);\r\n                                    this.viewComponent.game.world.bringToTop(this.sceneProxy.plotViewsLayer);\r\n                                    showGlobalViews(false, hideGlobalViews);\r\n                                    this.sceneProxy.isScreenHold && this.viewComponent.game.world.bringToTop(this.sceneProxy.quickPlayLayer);\r\n                                    return addOptions(args, null).then(opt => {\r\n                                    \taction.type = 'options';\r\n\t\t\t\t\t\t\t\t\t\taction.index = opt.index;\r\n\t\t\t\t\t\t\t\t\t\tResourcesManager.resetCmdPOptionPreload(commands, i, action.index);\r\n                                    \treturn resolve(action);\r\n                                    });\r\n                                case 'conditionOptions':\r\n                                    isRecover = false;\r\n                                    if (!this.sceneProxy.optionLayer || !this.sceneProxy.optionLayer.exists) {\r\n                                        this.sceneProxy.optionLayer = this.viewComponent.game.add.group();\r\n                                    }\r\n                                    return addOptions([], args).then(opt => {\r\n                                        if (opt.type === 2) {\r\n                                        \taction.type = 'cdtOptions';\r\n\t\t\t\t\t\t\t\t\t\t}\r\n                                        ResourcesManager.resetCmdPOptionPreload(commands, i, opt.type === 2 ? opt.index : -1);\r\n                                        return resolve(action);\r\n                                    });\r\n                                case 'backOption':\r\n                                \taction.type = 'backOption';\r\n                                    action.eArg = this.sceneProxy.Expression.safeEval(cmdInfo.commands[i].args[0], context);\r\n                                    break;\r\n                                case 'jumpOption':\r\n                                \taction.type = 'jumpOption';\r\n                                    action.eArg = this.sceneProxy.Expression.safeEval(cmdInfo.commands[i].args[0], context);\r\n                                    break;\r\n                                case 'autoSaveOrLoad':\r\n                                    if (this.sceneProxy.json_data.default_settings && this.sceneProxy.json_data.default_settings.autoSaveOrLoad) {\r\n                                        if (args[0].type === 1) {\r\n                                            if (!this.sceneProxy.loadRecord(args[0].index)) {\r\n                                                return Dialog.warn(\"Sorry~读不到存档内容，即将返回封面\").then(() => {\r\n                                                    this.sceneProxy.reStart(this.sceneProxy.isExtend());\r\n                                                    return Promise.resolve(-1);\r\n                                                }, () => {\r\n                                                    this.sceneProxy.reStart(this.sceneProxy.isExtend());\r\n                                                    return Promise.resolve(-1);\r\n                                                })\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n                                            return Promise.resolve(-1);\r\n                                        }\r\n                                        else if (args[0].type === 0) {\r\n                                            this.sceneProxy.getSnap();\r\n                                            this.sceneProxy.saveRecord(args[0].index, true);\r\n                                        }\r\n                                    }\r\n                                    break;\r\n                                case 'autotext':\r\n                                    this.sceneProxy.bCmdAutoText = args[0];\r\n                                    break;\r\n                                case 'weather':\r\n                                    if ('none' === args[0]) {\r\n                                        this.sceneProxy.weatherLayer.visible = false;\r\n                                    }\r\n                                    else {\r\n                                        addWeather(args[0]);\r\n                                    }\r\n                                    break;\r\n\t\t\t\t\t\t\t\tcase 'disableSaveOrLoad':\r\n\t\t\t\t\t\t\t\t\tthis.sceneProxy.context.disableSaveOrLoad = args[0];\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n                                case 'showBubble':\r\n                                    //显示气泡模式\r\n                                    let bi = hasborder(args[0].index);\r\n                                    this.sceneProxy.clearBubbleData(bi);\r\n                                    bi = hasborder(args[0].index);\r\n                                    resetBorder();\r\n                                    if(bi !== -1){\r\n                                        //需要显示的气泡已存在\r\n                                        const saveary = this.sceneProxy.saveBubbleVector[bi].savebubble.concat();\r\n                                        this.sceneProxy.bubbleLayer.removeChild(this.sceneProxy.saveBubbleVector[bi]);\r\n                                        this.sceneProxy.saveBubbleVector[bi].destroy();\r\n                                        let border = this.addBubbleBorder(this.sceneProxy.bubbleLayer,commands[i]);\r\n                                        this.sceneProxy.saveBubbleVector.splice(bi,1); // 删除原先\r\n                                        this.sceneProxy.saveBubbleVector.push(border); // 放数组最后\r\n                                        border.savebubble = saveary.concat();\r\n                                        border.visible = true;\r\n                                        border.itemlength = 0;\r\n                                        border.iscurrent = true;\r\n                                        curborder = border;\r\n                                        const addbubble = (i = 0)=>{\r\n                                            if(i >= curborder.savebubble.length){\r\n                                                return Promise.resolve();\r\n                                            } else{\r\n                                                return this.createBubble(curborder.savebubble[i],curborder).then((b)=>{\r\n                                                    i ++;\r\n                                                    return addbubble(i)\r\n                                                })\r\n                                            }\r\n                                        }\r\n                                        return addbubble().then(()=>{ showGlobalViews(false, hideGlobalViews);return resolve(action)})\r\n                                    }else{\r\n                                        let border = this.addBubbleBorder(this.sceneProxy.bubbleLayer,commands[i]);\r\n                                        this.sceneProxy.saveBubbleVector.push(border);\r\n                                        border.iscurrent = true;\r\n                                        curborder = border;//当前气泡指向\r\n                                        showGlobalViews(false, hideGlobalViews);\r\n                                        return resolve(action);\r\n                                    }\r\n                                case 'emitBubble':\r\n                                    //发射气泡\r\n                                    if(curborder.ishide === true){\r\n                                        const getcur = ()=>{\r\n                                            for(let i = this.sceneProxy.saveBubbleVector.length -1;i >= 0;i--){\r\n                                                let getborder =  this.sceneProxy.saveBubbleVector[i];\r\n                                                if(getborder && getborder.ishide !== true){\r\n                                                    resetBorder();\r\n                                                    getborder.iscurrent = true;\r\n                                                    return getborder;\r\n                                                }\r\n                                            }\r\n                                            return null;\r\n                                        }\r\n                                        let gborder = getcur();\r\n                                        if(gborder){\r\n                                            curborder = gborder;\r\n                                        }\r\n                                    }\r\n                                    const hasView = this.sceneProxy.plotViewsLayer.children.length > 0;\r\n                                    const addClick = (ac)=>{\r\n                                        const onClick = (o, e) => {\r\n                                            if (e && e.pointerMode === Phaser.PointerMode.CURSOR && e.button !== 0 || 'auto' === o && hasView) {\r\n                                                return;\r\n                                            }\r\n                                            this.sceneProxy.curPlotLayer.onChildInputDown.remove(onClick);\r\n                                            if ('insertPlot' === o)  {\r\n                                                return reject();\r\n                                            } else {\r\n                                                return resolve(ac ? ac : action)\r\n                                            }\r\n                                        };\r\n                                        this.sceneProxy.curPlotLayer.onChildInputDown.add(onClick);\r\n                                        !hasView && this.sceneProxy.space_key.onDown.addOnce(() => {return resolve(action)});\r\n                                    };\r\n                                    if(loadData && isRecover){\r\n                                        //读档\r\n                                        addClick(action);\r\n                                        curborder.gonext = (b)=>{\r\n                                            if(b && b !== curborder){\r\n                                                curborder.gonext && curborder.gonext();\r\n                                            }else{\r\n                                                return resolve(action);\r\n                                            }\r\n                                        }\r\n                                        isRecover = false;\r\n                                        return\r\n                                    }\r\n                                    this.sceneProxy.bubbleLayer.animateTweens.forEach((t,i) => {t.stop(true)});\r\n                                    this.sceneProxy.bubbleLayer.animateTweens.splice(0);\r\n                                    return this.createBubble(commands[i],curborder).then((bubble)=>{\r\n                                        //记录需要保留的气泡之类\r\n                                        this.sceneProxy.bubbleArchivalCount.push(commands[i].uuid);\r\n                                        curborder.savebubble.push(commands[i])\r\n                                        curborder.curbubble.push(commands[i]);//记录当前显示\r\n                                        const doAnimation = ()=>{\r\n                                            return new Promise((resolve,reject) =>{\r\n                                                if(args[0].animation){\r\n                                                    if(args[0].animation.type === 'fadein'){\r\n                                                        return this.tweenFromPromise(bubble, {alpha: 0}, args[0].animation.duration, null, true, args[0].animation.delay).then(()=>{\r\n                                                            bubble.alpha = 1;\r\n                                                            return resolve();\r\n                                                        })\r\n                                                    }\r\n                                                }else{\r\n                                                    return resolve();\r\n                                                }\r\n                                            })\r\n                                        }\r\n                                        curborder.gonext = (b)=>{\r\n                                            if(b && b !== curborder){\r\n                                                curborder.gonext && curborder.gonext();\r\n                                            }else{\r\n                                                if (!((this.sceneProxy.bCmdAutoText || ((!hasView) && (this.sceneProxy.quickPlay || this.sceneProxy.context.auto))) && !this.sceneProxy.playPause)) { // 非自动播放下一指令\r\n                                                    return resolve(action);\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                        if (!((this.sceneProxy.bCmdAutoText || ((!hasView) && (this.sceneProxy.quickPlay || this.sceneProxy.context.auto))) && !this.sceneProxy.playPause)){\r\n                                            addClick();\r\n                                        }\r\n                                        return doAnimation().then(() =>{\r\n                                            if ((this.sceneProxy.bCmdAutoText || ((!hasView) && (this.sceneProxy.quickPlay || this.sceneProxy.context.auto))) && !this.sceneProxy.playPause) { // 自动播放下一指令\r\n                                                //自动播放下一集 延迟1秒执行\r\n                                                setTimeout(()=>{return resolve(action);},1000)\r\n                                            }else{\r\n                                                addClick(action);\r\n                                            }\r\n                                        })\r\n                                    });\r\n                                case 'hideBubble':\r\n                                    //隐藏气泡模式\r\n                                    const id = hasborder(args[0]);\r\n                                    if(id !== -1){\r\n                                        this.sceneProxy.saveBubbleVector[id].visible = false;\r\n                                        this.sceneProxy.saveBubbleVector[id].ishide = true;\r\n                                    }\r\n                                    break;\r\n                            }\r\n                            if(commands[i].type !== \"setValues\") return resolve(action);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tconst playHandler = (cmdInfo, index) => {\r\n\t\t\t\t\t\treturn this.cmdPlotLoadResources(context, chapter, nPlot, cmdInfo, index).then(() => handle(cmdInfo, index).then(r => {\r\n                            this.sceneProxy.cmdPlotNextPromise = null;\r\n\t\t\t\t\t\t\tif (r && context === this.sceneProxy.context && this.sceneProxy.isGoToCommand !== false) {\r\n                                const {info:info, index:i} = this.sceneProxy.getNextCommand(context, cmdInfo, index, r);\r\n                                info && info.commands[i] ? playHandler(info, i) : this.showNextPlot(context, chapter, nPlot);\r\n                            }\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t};\r\n\r\n                    this.sceneProxy.lstPlotLayer && this.sceneProxy.lstPlotLayer.destroy();\r\n                    this.sceneProxy.lstPlotLayer = this.sceneProxy.curPlotLayer;\r\n                    ResourcesManager.updateUsingKey({ type: 'preBackground', key: this.sceneProxy.lstPlotBkKey });\r\n\t\t\t\t\tthis.sceneProxy.bCmdAutoText = false;\r\n                    this.sceneProxy.lstDialogInfo = [];\r\n\t\t\t\t\tthis.sceneProxy.cmdPlayHandlerFun = playHandler;\r\n                    addBackground(this.sceneProxy.curPlotLayer);\r\n\r\n\t\t\t\t\tlet cmdInfo = {commands: plot.commands, parentInfo: null, parentCmdIndex: -1};\r\n\t\t\t\t\tlet cmdIndex = 0;\r\n                    const doCmdInfo = ()=>{\r\n                        this.addMenuLayer(!!this.sceneProxy.json_data.template.json.shanyiMenu);\r\n                        cmdInfo && cmdInfo.commands[cmdIndex] ? playHandler(cmdInfo, cmdIndex) : this.showNextPlot(context, chapter, nPlot);\r\n                    }\r\n\t\t\t\t\tif (cmdPlotSnap && cmdPlotSnap.cmdInfo) {\r\n                        this.sceneProxy.context.disableSaveOrLoad = plot.disableSaveOrLoad ? plot.disableSaveOrLoad : this.sceneProxy.context.disableSaveOrLoad;\r\n\t\t\t\t\t\tcmdInfo = cmdPlotSnap.cmdInfo;\r\n\t\t\t\t\t\tcmdIndex = cmdPlotSnap.cmdIndex;\r\n\t\t\t\t\t\tif (cmdInfo.commands[cmdIndex] && cmdInfo.commands[cmdIndex].type === 'systemUI') {\r\n\t\t\t\t\t\t\tcmdIndex++;\r\n\t\t\t\t\t\t}\r\n                        if (cmdInfo.commands[cmdIndex] && cmdInfo.commands[cmdIndex].type === 'autoSaveOrLoad') {\r\n                            cmdIndex++;\r\n                        }\r\n                        recoverCmdSnap(cmdPlotSnap.cmdScreenSnap, cmdInfo.commands, cmdIndex,cmdPlotSnap.animateScene ? cmdPlotSnap.animateScene : null).then(()=>{\r\n\t\t\t\t\t\t    isRecover = true;\r\n                            if (!cmdInfo.commands[cmdIndex]) {\r\n                                const {info, index} = this.sceneProxy.getNextCommand(context, cmdInfo, cmdIndex-1, {type:'insert'});\r\n                                cmdInfo = info;\r\n                                cmdIndex = index;\r\n                            }\r\n                            doCmdInfo();\r\n                        });\r\n\t\t\t\t\t}else{\r\n                        this.sceneProxy.context.disableSaveOrLoad = plot.disableSaveOrLoad ? plot.disableSaveOrLoad : {save: false, load: false};\r\n                        doCmdInfo();\r\n                    }\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthis.sceneProxy.isGettingNext = false;\r\n                this.sceneProxy.curPlotLayer = this.viewComponent.game.add.group();\r\n                this.sceneProxy.curPlotLayer.inputEnableChildren = true;\r\n                this.sceneProxy.curPlotLayer.isShaking = false;//振动效果默认不在执行中\r\n                this.sceneProxy.curPlotLayer.isSpreading = false;//展开效果默认不在执行中\r\n                this.sceneProxy.curPlotLayer.name = 'plotLayer';\r\n                this.sceneProxy.charsAndPropsLayer && this.sceneProxy.charsAndPropsLayer.destroy();\r\n                this.sceneProxy.charsAndPropsLayer = this.viewComponent.game.add.group();\r\n                this.sceneProxy.charsAndPropsLayer.name = \"charactersAndProps\";\r\n                this.sceneProxy.optionLayer && this.sceneProxy.optionLayer.destroy();\r\n                this.sceneProxy.optionLayer = this.viewComponent.game.add.group();\r\n\t\t\t\t// 置顶\r\n                this.viewComponent.game.world.bringToTop(this.sceneProxy.curPlotLayer);\r\n                this.viewComponent.game.world.bringToTop(this.sceneProxy.charsAndPropsLayer);\r\n                this.viewComponent.game.world.bringToTop(this.sceneProxy.dialogLayer);\r\n                //\r\n                clearShake();\r\n\r\n                // 清理上一剧情高级UI\r\n\t\t\t\tif (!loadData) {\r\n                    this.sceneProxy.removeViewTimer(this.sceneProxy.plotViewsLayer);\r\n                    this.sceneProxy.removeInputView(this.sceneProxy.plotViewsLayer);\r\n                    this.sceneProxy.plotViewsLayer.removeAll(true);\r\n                    this.sceneProxy.plotViews.splice(0, this.sceneProxy.plotViews.length);\r\n                    this.removeViewKey(this.sceneProxy.plotViewKeys);\r\n                }\r\n                if(loadData || (cmdPlotSnap && cmdPlotSnap.cmdInfo)){\r\n                    //存档数据 或插播返回  恢复\r\n                    if(this.sceneProxy.saveBubbleDataVector.length > 0){\r\n                        this.sceneProxy.saveBubbleVector = [];\r\n                        for(let j = 0;j < this.sceneProxy.saveBubbleDataVector.length;j++){\r\n                            const bcommands = this.sceneProxy.saveBubbleDataVector[j].bubbleMode;\r\n                            let border = this.addBubbleBorder( null, bcommands);\r\n                            border.savebubble = this.sceneProxy.saveBubbleDataVector[j].bubble.concat(); //记录的气泡数据\r\n                            border.curbubble = this.sceneProxy.saveBubbleDataVector[j].curbubble.concat();//记录的当前气泡数据\r\n                            border.ishide = this.sceneProxy.saveBubbleDataVector[j].ishide;\r\n                            border.iscurrent = this.sceneProxy.saveBubbleDataVector[j].iscurrent;\r\n                            this.sceneProxy.saveBubbleVector.push(border);\r\n                        }\r\n                        this.sceneProxy.saveBubbleDataVector = [];\r\n                    }\r\n                }\r\n\r\n                this.sceneProxy.curPlotInfo = plot;\t\t\t// 保存当前要播放的剧情信息\r\n                this.sceneProxy.curChapter = chapter;\t\t// 保存当前章节信息\r\n                this.sceneProxy.curPlotIndex = nPlot;\t\t// 保存当前剧情索引\r\n\t\t\t\tif (plot.commands){\r\n\t\t\t\t\tplayCommands();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tplayNormal();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tplay();\r\n            this.sceneProxy.isScreenHold && this.viewComponent.game.world.bringToTop(this.sceneProxy.quickPlayLayer);\r\n\t\t},\r\n\r\n\t\tendPlot: function (bhide) {\r\n            this.sceneProxy.saveBubbleVector.forEach((b,i) =>{\r\n                this.sceneProxy.clearBubbleData(i);\r\n                !bhide && (b.ishide = true);\r\n            });\r\n            if (this.sceneProxy.bubbleLayer.children.length > 0){\r\n                this.sceneProxy.bubbleLayer.removeAll(true);\r\n            }\r\n\t\t\tthis.sceneProxy.coverLayer.visible = false;\r\n\t\t\tthis.viewComponent.game.input.onDown.removeAll();\t// 移除鼠标点击事件\r\n\t\t\tthis.sceneProxy.dialogLayer.visible = false;\t\t// 隐藏对话框层\r\n\t\t\tthis.sceneProxy.menuLayer.visible = false;\t\t\t// 隐藏菜单层\r\n\t\t\tthis.sceneProxy.space_key.onDown.removeAll();\t\t// 移除空格键\r\n            this.sceneProxy.plotViews.splice(0, this.sceneProxy.plotViews.length);\r\n\t\t\tthis.sceneProxy.removePlotTweens();\r\n\t\t},\r\n\r\n\t\tshowNextPlot: function (context, chapter, nPlot, type, eArg) {\r\n\t\t    this.sceneProxy.isGoToCommand = false;//显示下一个剧情。取消高级剧情接下去指令\r\n\r\n            const { stack } = context;\r\n\t\t\tlet {chapter: nChapter, nIndex, cmdPlotSnap, context: newContext, preStackFrame, preCmdStackFrame} = this.sceneProxy.getNextPlot(context, chapter, nPlot, type, eArg);\r\n            const goNext = () => {\r\n                if(nIndex.length >= 36){\r\n                    //flash插播返回uuid\r\n                    let index = -2\r\n                    const getPlotIndex = (puuid) =>{\r\n                        nChapter.plots.find((plot,j) =>{\r\n                            if(plot.uuid === puuid){\r\n                                index = j;\r\n                            }\r\n                        })\r\n                        return index;//不存在\r\n                    }\r\n                    nIndex = getPlotIndex(nIndex);\r\n                }\r\n                if (!nChapter.plots[nIndex]) {\r\n                    if (nIndex === -2) {\r\n                        this.endPlot();\r\n                        return this.sceneProxy.reStart(this.sceneProxy.isExtend());\r\n                    }\r\n                    else if (nIndex < -2) {\r\n                        if (preStackFrame) {\r\n                            newContext.stack = [preStackFrame, ...newContext.stack];\r\n                            preCmdStackFrame && (newContext.cmdStack = [preCmdStackFrame, ...newContext.cmdStack]);\r\n                        }\r\n                        const {chapter: c, nIndex: n, cmdPlotSnap: cps, context: nc, preStackFrame:np, preCmdStackFrame:npc} = this.sceneProxy.getNextPlot(context, chapter, nPlot, type, eArg);\r\n                        nChapter = c, nIndex = n, cmdPlotSnap = cps, newContext = nc, preStackFrame = np, preCmdStackFrame = npc;\r\n                        this.endPlot(cmdPlotSnap && cmdPlotSnap.cmdInfo);\r\n                        if (nIndex < -2) {\r\n                            if (preStackFrame) {\r\n                                context.stack = [preStackFrame, ...newContext.stack];\r\n                                preCmdStackFrame && (newContext.cmdStack = [preCmdStackFrame, ...newContext.cmdStack]);\r\n                            }\r\n                            return this.showNextPlot(context, chapter, nPlot, type, eArg);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (nIndex === 0) {\r\n                        this.endPlot(cmdPlotSnap && cmdPlotSnap.cmdInfo);\r\n                    \tthis.showNextPlot(context, nChapter, nIndex);\r\n                    \treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n                        this.sceneProxy.dialogLayer.visible = true;\t\t// 游戏结束不隐藏对话框层\r\n                        this.sceneProxy.menuLayer.visible = true;\t\t\t// 游戏结束不隐藏菜单层\r\n                        return this.gameOver();\r\n                    }\r\n\t\t\t\t}\r\n                this.endPlot(cmdPlotSnap && cmdPlotSnap.cmdInfo)\r\n                let optionType = null;\r\n                let optionIndex = null;\r\n                let nextPlotType = null;\r\n                if (stack !== newContext.stack) {\r\n                    const frame = newContext.stack[0] || {};\r\n                    const { type, index } = frame;\r\n                    if (type === 'options' || type === 'condition_options') {\r\n                        optionType = type;\r\n                        optionIndex = index;\r\n                    } else if (type === 'insert') {\r\n                        nextPlotType = 'insert';\r\n                    } else if (!newContext.stack.length&&!nIndex) {\r\n                        nextPlotType = 'jump';\r\n                    }\r\n                }\r\n                ResourcesManager.resetPlotOptionPreload(chapter.plots[nPlot], optionType, optionIndex);\r\n                ResourcesManager.clearPrePlotResources(chapter.plots, nPlot);\r\n\r\n\t\t\t\tif (nextPlotType === 'jump' || nextPlotType === 'insert') {\r\n\t\t\t\t\tnextPlotType === 'jump' ? ResourcesManager.resetJumpPreload(nChapter): ResourcesManager.resetInsertPreload(nChapter) ;\r\n                }\r\n\r\n                if (!this.sceneProxy.isPlotResourceExist(nChapter.plots[nIndex])) {\r\n                \tthis.sceneProxy.preloadChapterAssets(newContext, nChapter, nIndex, cmdPlotSnap);\r\n                } else {\r\n                    const loadingResourceList = this.sceneProxy.getLoadingPlotResource(nChapter.plots[nIndex]);\r\n                    loadingResourceList.length\r\n                        ? this.assetsLoader(loadingResourceList, true, true).then(() => this.showPlot(newContext, nChapter, nIndex, cmdPlotSnap))\r\n                        : this.showPlot(newContext, nChapter, nIndex, cmdPlotSnap);\r\n                }\r\n\t\t\t};\r\n            const stayCurrentPlot = () => {\r\n                this.endPlot();\r\n                if (nPlot === 0) {\r\n                    this.showPlot(context, chapter, 0);\r\n                } else {\r\n                \tif (preStackFrame) {\r\n                \t\tnewContext.stack = [preStackFrame, ...newContext.stack];\r\n                        preCmdStackFrame && (newContext.cmdStack = [preCmdStackFrame, ...newContext.cmdStack]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//付费返回停留在当前剧情，type类型不执行\r\n                    const {chapter: nChapter, nIndex, cmdPlotSnap, context: newContext} = this.sceneProxy.getNextPlot(context, chapter, nPlot-1, ''/*type*/, eArg);\r\n\t\t\t\t\tthis.sceneProxy.preloadChapterAssets(newContext, nChapter, nIndex, cmdPlotSnap);\r\n                }\r\n\t\t\t};\r\n\r\n            this.sceneProxy.isGettingNext = true;\r\n            this.sceneProxy.shakeLoopObj.loop = false;\r\n            //this.endPlot()\r\n\r\n            if (nChapter.md5 && nChapter.plots.length === 0) {\r\n                this.sceneProxy.isPreferentialFinished = false;//下一个章节 取消限免状态\r\n            \tconst chapterUuid = nChapter.downloadUuid ? nChapter.downloadUuid : nChapter.uuid;\r\n            \t//第三方\r\n            \tif(this.sceneProxy.isWapOther()){\r\n            \t    const otherback = (plots)=>{\r\n            \t        if(plots === null){\r\n                            Dialog.error('获取付费章节信息失败').then(()=>{stayCurrentPlot()},()=>{stayCurrentPlot()})\r\n                        }else if(plots === \"fail\"){\r\n                            //查询失败\r\n                            Dialog.custom(\"Error\",\"仍未查询到您的支付信息哦，请确认已经支付~ 如有疑问请添加闪艺客服QQ：819786897 ~\",\"提示\",\"复制QQ\",\"取消\",false).then(()=>{\r\n                                Copy(\"819786897\",{\r\n                                    debug: false,\r\n                                    message: '复制成功',\r\n                                })\r\n                                stayCurrentPlot();\r\n                            },()=>{\r\n                                stayCurrentPlot();\r\n                            })\r\n                        }else{\r\n                            nChapter.plots = plots ? plots : [];\r\n                            goNext();\r\n                        }\r\n                    }\r\n                    this.sceneProxy.unlockChapterByWapOther(chapterUuid,nChapter.charge,nChapter.md5,otherback);\r\n            \t    return;\r\n                }\r\n\r\n            \tif (nChapter.charge && ('android' === flashvars.client || 'ios' === flashvars.client || flashvars.client === 'wap')) {\r\n            \t    const unlock =()=>{\r\n                        const unlockFinish = (bSuccess, stayIfFail) => {\r\n                            if (bSuccess) {\r\n                                this.sceneProxy.checkIfChapterFree(chapterUuid, nChapter.md5).then((plots)=>{\r\n                                    this.sceneProxy.unlockChapterCallBack = null;\r\n                                    nChapter.plots.push(...plots);\r\n                                    goNext();\r\n                                }, () => {\r\n                                    if(flashvars.client === 'wap'){\r\n                                        window.parent && window.parent.playLogin();\r\n                                    }else{\r\n                                        Dialog.error('获取付费章节信息失败');\r\n                                    }\r\n                                    stayCurrentPlot();\r\n                                })\r\n                            } else if (stayIfFail) {\r\n                                stayCurrentPlot();\r\n                            } else {\r\n                                Dialog.error('章节解锁失败');\r\n                                goNext();\r\n                            }\r\n                        };\r\n                        this.sceneProxy.unlockChapter(chapterUuid, nChapter.charge, nChapter.md5, unlockFinish);\r\n                    }\r\n                    if(flashvars.uid !== '' && flashvars.client === 'wap'){\r\n                        //wap端 已登 解锁之前再请求一次接口数据\r\n                        this.sceneProxy.checkIfChapterFree(chapterUuid, nChapter.md5).then((plots)=>{\r\n                            this.sceneProxy.unlockChapterCallBack = null;\r\n                            nChapter.plots.push(...plots);\r\n                            goNext();\r\n                        }, () => {\r\n                            unlock();\r\n                        })\r\n                    }else{\r\n                        unlock();\r\n                    }\r\n\t\t\t\t} else {\r\n                    this.sceneProxy.checkIfChapterFree(chapterUuid, nChapter.md5).then((plots)=>{\r\n\t\t\t\t\t\tnChapter.plots.push(...plots);\r\n                        goNext();\r\n                    }, (msg)=>{\r\n                        if (-1 === msg.indexOf('code=87')) {\r\n                            Dialog.error(msg);\r\n                        } else { // 未购买此章节\r\n                            if(flashvars.wap === 'zxwwap'){\r\n                                Dialog.info('当前为收费章节，是否前往闪艺抢先体验？').then(()=>{\r\n                                    window.location.href = 'https://wap.3000.com/?m=detail&op=index&ac=index&id='+ flashvars.gid;\r\n                                },()=>{\r\n                                    stayCurrentPlot();\r\n                                })\r\n                            }else{\r\n                                Dialog.info('当前为收费章节，请前往闪艺app或电脑端进行购买').then(() => stayCurrentPlot(), () => goNext());\r\n                            }\r\n                        }\r\n                    })\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n                if(('android' === flashvars.client || 'ios' === flashvars.client) && nChapter.charge){\r\n                    const chapterUuid = nChapter.downloadUuid ? nChapter.downloadUuid : nChapter.uuid;\r\n                    const ispreferent = (duuid)=>{\r\n                        for(let i =0;i < this.sceneProxy.preferentialVector.length;i++){\r\n                            if(duuid === this.sceneProxy.preferentialVector[i]) return true;\r\n                        }\r\n                        return false;\r\n                    }\r\n                    if(this.sceneProxy.isPreferentialFinished !== false || ispreferent(chapterUuid)){\r\n                        const unlock = ()=>{\r\n                            const unlockPreferentialFinish = (bSuccess, stayIfFail) => {\r\n                                if (bSuccess) {\r\n                                    this.sceneProxy.checkIfChapterFree(chapterUuid, nChapter.md5).then((plots)=>{\r\n                                        this.sceneProxy.isPreferentialFinished = false;//限免解锁成功 取消限免状态\r\n                                        this.sceneProxy.dislodgePreferentVector(chapterUuid);\r\n                                        this.sceneProxy.unlockChapterCallBack = null;\r\n                                        nChapter.plots = plots;\r\n                                        goNext();\r\n                                    }, () => {\r\n                                        if(flashvars.client === 'wap'){\r\n                                            window.parent && window.parent.playLogin();\r\n                                        }else{\r\n                                            Dialog.error('获取付费章节信息失败');\r\n                                        }\r\n                                        stayCurrentPlot();\r\n                                    })\r\n                                } else if (stayIfFail) {\r\n                                    stayCurrentPlot();\r\n                                } else {\r\n                                    Dialog.error('章节解锁失败');\r\n                                    goNext();\r\n                                }\r\n                            };\r\n                            this.sceneProxy.unlockChapter(chapterUuid, nChapter.charge, nChapter.md5, unlockPreferentialFinish);\r\n                        }\r\n                        //已有通知限免结束\r\n                        this.sceneProxy.checkIfChapterFree(chapterUuid,nChapter.md5).then((plots)=>{\r\n                            //有数据，继续\r\n                            this.sceneProxy.dislodgePreferentVector(chapterUuid);\r\n                            goNext();\r\n                        },(msg)=>{\r\n                            //没有数据\r\n                            if(this.sceneProxy.isPreferentialFinished !== false){\r\n                                Dialog.custom(\"Info\",\"作品限免已结束，需要付费才能继续观看哦\",\"限免提示\",\"取消\",\"去支付\",true).then(()=>{\r\n                                    //点击了取消\r\n                                    stayCurrentPlot();\r\n                                },(msg1)=>{\r\n                                    if(msg1 === \"cancel\"){\r\n                                        //点击了去支付\r\n                                        unlock();\r\n                                    }else if(msg1 === \"close\"){\r\n                                        //点击了取消\r\n                                        stayCurrentPlot();\r\n                                    }\r\n                                });\r\n                            }else if(ispreferent(chapterUuid)){\r\n                                unlock();\r\n                            }\r\n\r\n                        });\r\n                        return;\r\n                    }\r\n                }\r\n\r\n            \tgoNext();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tgameOver: function () {\r\n\t\t    //结束调用app接口\r\n            if (flashvars.client === 'ios') {\r\n                if(flashvars.offline === 1){\r\n                    javascript:workFinished('1');\r\n                }else{\r\n                    window.webkit && window.webkit.messageHandlers.workFinished.postMessage('1');\r\n                }\r\n            }\r\n            else if (flashvars.client === 'android') {\r\n                window.app && window.app.workFinished('1');\r\n            }\r\n\t\t\tthis.sceneProxy.showEnd();\r\n\t\t},\r\n\r\n\t\t/** @override */\r\n\t\tonRegister: function ()\r\n\t\t{\r\n\t\t\t// Initialize the TextComponentMediator's view component when its\r\n\t\t\t// registered with the Facade and listen to its TEXT_CHANGED events\r\n\t\t\tthis.setViewComponent( new diygamePlayer.view.component.Scene );\r\n\t\t\tthis.facade.registerMediator(new diygamePlayer.view.mediator.CoverMediator);\r\n\t\t\tthis.facade.registerMediator(new diygamePlayer.view.mediator.SettingsMediator);\r\n\t\t\tthis.facade.registerMediator(new diygamePlayer.view.mediator.MainMenuMediator);\r\n\t\t\tthis.facade.registerMediator(new diygamePlayer.view.mediator.RecordMediator);\r\n\t\t\tthis.facade.registerMediator(new diygamePlayer.view.mediator.PlaybackMediator);\r\n\t\t\tthis.facade.registerMediator(new diygamePlayer.view.mediator.EndMediator);\r\n\r\n\t\t\tvar that = this;\r\n\t\t\tthis.viewComponent.onRendered =(function(){\r\n                that.viewComponent.sceneProxy = that.sceneProxy;\r\n\t\t\t\tthat.sceneProxy.preloadingBegin();\r\n\t\t\t});\r\n\r\n\t\t\t// add the TextComponentMediator as a listener for TEXT_CHANGED events\r\n\t\t\t// when the\r\n\t\t\t//this.viewComponent.addEventListener( diygamePlayer.view.component.Scene.TEXT_CHANGED, this );\r\n\t\t\tthis.sceneProxy = this.facade.retrieveProxy(diygamePlayer.model.proxy.SceneProxy.NAME);\r\n\t\t},\r\n\r\n\t\t/** @override */\r\n\t\tonRemove: function ()\r\n\t\t{\r\n\t\t\t// The TextComponentMediator has been removed from the Facade, and so is no longer\r\n\t\t\t// in use. Clean up by removing event listeners and dereferencing its viewComponent\r\n\t\t\t//this.viewComponent.removeEventListener( diygamePlayer.view.component.Scene.TEXT_CHANGED, this );\r\n\t\t\tthis.setViewComponent(null);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Handle the W3CTextComponent.TEXT_CHANGED event\r\n\t\t * @param {Event} textChangedEvent\r\n\t\t * @return {void}\r\n\t\t */\r\n\t//handleEvent: function (textChangedEvent)\r\n\t//\t{\r\n\t//\t\tthis.sendNotification( diygamePlayer.AppConstants.PROCESS_TEXT, textChangedEvent.text );\r\n\t//\t}\r\n\r\n\t\t, curChapter: null\r\n\t},\r\n\r\n\t// STATIC MEMBERS\r\n\t{\r\n\t\t/**\r\n\t\t * @static\r\n\t\t * @type {string}\r\n\t\t */\r\n\t\tNAME: 'SceneMediator'\r\n\t}\r\n);","/**\r\n * Created by 4399-1126 on 2016/9/13.\r\n */\r\nimport puremvc from 'puremvc';\r\nimport FontUtils from '../../common/FontUtils.js';\r\nimport Utils from '../../common/Utils.js';\r\npuremvc.define\r\n(\r\n    {\r\n        name: 'diygamePlayer.view.mediator.SettingsMediator',\r\n        parent: puremvc.Mediator\r\n    },\r\n    {\r\n        listNotificationInterests: function () {\r\n            return [\r\n                diygamePlayer.AppConstants.SCENE_GOTO_SETTINGS\r\n            ]\r\n        },\r\n\r\n        handleNotification: function (note) {\r\n            const body = note.getBody();\r\n            switch (note.getName()) {\r\n                case diygamePlayer.AppConstants.SCENE_GOTO_SETTINGS:\r\n                    this.callbackInfo = body.callbackInfo;\r\n                    this.showSettingsLayer(body.context);\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        },\r\n\r\n        onRegister: function () {\r\n            this.sceneProxy = this.facade.retrieveProxy(diygamePlayer.model.proxy.SceneProxy.NAME);\r\n            const sceneMediator = this.facade.retrieveMediator(diygamePlayer.view.mediator.SceneMediator.NAME);\r\n            this.game = sceneMediator.viewComponent && sceneMediator.viewComponent.game;\r\n            this.viewComponent = sceneMediator.viewComponent;\r\n        },\r\n\r\n        fullMode: function () {\r\n            const {fullMode, windowMode} = this.sceneProxy.json_data.template.json.settings;\r\n            const full = this.sceneProxy.settingsLayer.getByName('settings_button_fullMode');\r\n            const window = this.sceneProxy.settingsLayer.getByName('settings_button_windowMode');\r\n            full && full.changeBackground(fullMode.checked.background.url, fullMode.checked.text);\r\n            window && window.changeBackground(windowMode.unchecked.background.url, windowMode.unchecked.text);\r\n        },\r\n\r\n        windowMode: function () {\r\n            const {fullMode, windowMode} = this.sceneProxy.json_data.template.json.settings;\r\n            const full = this.sceneProxy.settingsLayer.getByName('settings_button_fullMode');\r\n            const window = this.sceneProxy.settingsLayer.getByName('settings_button_windowMode');\r\n            full && full.changeBackground(fullMode.unchecked.background.url, fullMode.unchecked.text);\r\n            window && window.changeBackground(windowMode.checked.background.url, windowMode.checked.text);\r\n        },\r\n\r\n        autoOn: function () {\r\n            const {autoOn, autoOff} = this.sceneProxy.json_data.template.json.settings;\r\n            const on = this.sceneProxy.settingsLayer.getByName('settings_button_autoOn');\r\n            const off = this.sceneProxy.settingsLayer.getByName('settings_button_autoOff');\r\n            on && on.changeBackground(autoOn.checked.background.url, autoOn.checked.text);\r\n            off && off.changeBackground(autoOff.unchecked.background.url, autoOff.unchecked.text);\r\n        },\r\n\r\n        autoOff: function () {\r\n            const {autoOn, autoOff} = this.sceneProxy.json_data.template.json.settings;\r\n            const on = this.sceneProxy.settingsLayer.getByName('settings_button_autoOn');\r\n            const off = this.sceneProxy.settingsLayer.getByName('settings_button_autoOff');\r\n            on && on.changeBackground(autoOn.unchecked.background.url, autoOn.unchecked.text);\r\n            off && off.changeBackground(autoOff.checked.background.url, autoOff.checked.text);\r\n        },\r\n\r\n        updateVolumeProgress(type,value){\r\n            const progGroup = this.sceneProxy.settingsLayer.getByName(type + 'progGroup');\r\n            if(progGroup){\r\n                const pk = progGroup.getByName('pk');\r\n                const progbk = progGroup.getByName('progbk');\r\n                const totalwidth = progbk.width;\r\n                if(value <= 0){pk.width = 0.01;}else{ //遮罩宽度为0时 遮罩效果无效\r\n                    pk.width = value * totalwidth;\r\n                }\r\n            }\r\n\r\n        },\r\n\r\n        addSettings: function () {\r\n            const {background, header, displayHeader, textHeader, displayCaption, textCaption, fullMode, windowMode, autoOn, autoOff, back} = this.sceneProxy.json_data.template.json.settings;\r\n\r\n            //添加进度条\r\n            const addProgress = (type,norkey,progkey,rc,callback)=>{\r\n                const progGroup = this.game.add.group();\r\n                progGroup.x = rc.x;\r\n                progGroup.y = rc.y;\r\n                progGroup.name = type + 'progGroup';\r\n                this.sceneProxy.settingsLayer.add(progGroup);\r\n                const normalkey = this.game.load.cache.checkImageKey(norkey) ? norkey : '';\r\n                const progresskey = this.game.load.cache.checkImageKey(progkey) ? progkey : '';\r\n                let progbk = this.game.add.image(0,0,normalkey,null,progGroup);\r\n                progbk.width = rc.width;\r\n                progbk.height = rc.height;\r\n                progbk.name = 'progbk';\r\n                let progpk = this.game.add.image(0,0,progresskey,null,progGroup);\r\n                progpk.width = rc.width;\r\n                progpk.height = rc.height;\r\n                progpk.name = 'progpk';\r\n\r\n                const pk = this.game.add.graphics(0,0);\r\n                pk.beginFill(0xfff000,0.5);\r\n                pk.drawRect(0, 0, rc.width, rc.height);\r\n                pk.endFill();\r\n                pk.name = 'pk'\r\n                progGroup.add(pk);\r\n                progpk.mask = pk;\r\n\r\n                let isProgDown = false;\r\n                progbk.inputEnabled = true;\r\n                const totalwidth = progbk.width; //总长度\r\n                let progress = 0;\r\n                this.game.time.events.stop(false);\r\n                const update = (value)=>{\r\n                    if(value <= 0){pk.width = 0.01;}else{ //遮罩宽度为0时 遮罩效果无效\r\n                        pk.width = value * totalwidth;\r\n                    }\r\n                }\r\n                progbk.events.onInputDown.add((obj,point)=>{\r\n                    isProgDown = true;\r\n                    progress = ((point.x - rc.x) / totalwidth)\r\n                    update(progress)\r\n                    this.game.time.events.start();\r\n                },this);//按下\r\n                this.game.time.events.loop(10,()=>{\r\n                    if(isProgDown){\r\n                        progress = ((this.game.input.x - rc.x) / totalwidth)\r\n                        if(progress <=0) progress = 0;\r\n                        if(progress >=1) progress = 1;\r\n                        update(progress);\r\n                    }\r\n                },this);\r\n\r\n                this.game.input.onUp.add(()=>{\r\n                    if(isProgDown){\r\n                        if(callback)callback(progress);\r\n                        this.game.time.events.stop(false);\r\n                    }\r\n                    isProgDown = false;\r\n                },this)//弹起\r\n            }\r\n\r\n            const addTextBk = (bkKey, rc, name) => {\r\n                const key = this.game.load.cache.checkImageKey(bkKey) ? bkKey : '';\r\n                const bk = this.sceneProxy.settingsLayer.create(rc.x, rc.y, key);\r\n                bk.width = rc.width;\r\n                bk.height = rc.height;\r\n                bk.name = name;\r\n            };\r\n\r\n            const addTextContent = (x, y, width, height, content, objText, name) => {\r\n                const fontStyle = {};\r\n                let ff = '';\r\n                ff += objText.fontWeight ? objText.fontWeight + ' ' : 'normal ';\r\n                ff += objText.fontSize ? parseInt(objText.fontSize) + 'px ' : '';\r\n                ff += this.sceneProxy.json_data.font ? this.sceneProxy.json_data.font.fontFamily : objText.fontFamily ? objText.fontFamily : '';\r\n\r\n                fontStyle.font = ff;\r\n                fontStyle.fill = objText.color;\r\n                fontStyle.boundsAlignH = \"center\";\r\n                fontStyle.boundsAlignV = \"middle\";\r\n                fontStyle.stroke = objText.stroke;\r\n                fontStyle.strokeThickness = objText.stroke ? 2 : 0;\r\n\r\n                const txt = this.game.add.text(0, 0, content, fontStyle, this.sceneProxy.settingsLayer);\r\n                txt.name = name;\r\n                if (FontUtils.fontFamily) {\r\n                    const colorS = objText.color ? objText.color : '#fefefe';\r\n                    const fontSize = objText.fontSize ? parseInt(objText.fontSize) : 25;\r\n                    let color = '';\r\n                    if (colorS.indexOf('rgb') !== -1) {\r\n                        const rgb = colorS.replace('rgb(', '').replace(')', '').split(',');\r\n                        color = '0x' + parseInt(rgb[0], 16) + parseInt(rgb[1], 16) + parseInt(rgb[2], 16);\r\n                        color === '0xffffff' && (color = '0xfefefe');\r\n                    }\r\n                    else {\r\n                        color = (colorS === '#ffffff' ? '#fefefe' : colorS).replace('#', '0x');\r\n                    }\r\n                    const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(fontSize) : fontSize;\r\n                    const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(fontSize) : fontSize;\r\n                    txt.colors.splice(0, txt.colors.length);\r\n                    txt.text = ' ';\r\n                    txt.fill = color;\r\n                    txt.addColor(color, 0);\r\n                    txt.x = x + (width - fw * content.length) / 2;\r\n                    txt.y = y + (height - fh) / 2;\r\n                    txt.wordWrapWidth = fw * (content.length + 1);\r\n                    this.sceneProxy.addImageFontText([{data:content}], fw, fh, txt, this.sceneProxy.context);\r\n                }\r\n                else {\r\n                    txt.setTextBounds(x, y + (txt.height - parseInt(objText.fontSize)) / 2, width, height);\r\n                }\r\n                objText.hidden && (txt.visible = false);\r\n                return txt;\r\n            };\r\n\r\n            const addButton = (obj, name, text, isCheckBox) => {\r\n                const t = {};\r\n                t.normal = isCheckBox ? obj.unchecked.text : obj.normal.text;\r\n                t.active = isCheckBox ? null : obj.active.text;\r\n                t.text = text;\r\n                const btn = this.viewComponent.addButton(obj.rect.x,\r\n                    obj.rect.y,\r\n                    obj.rect.width,\r\n                    obj.rect.height,\r\n                    isCheckBox ? null : obj.normal.background.url,\r\n                    isCheckBox ? null : obj.active.background.url,\r\n                    modeBtnClicked,\r\n                    t,\r\n                    this.sceneProxy.btn_sound,\r\n                    name,\r\n                    this.sceneProxy.settingsLayer,\r\n                    isCheckBox\r\n                );\r\n                isCheckBox && btn.changeBackground(obj.unchecked.background.url, text);\r\n                return btn;\r\n            };\r\n\r\n            const modeBtnClicked = (argv, pointer) => {\r\n                if (pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n                    return;\r\n                }\r\n                if (argv.parent.name === 'settings_button_fullMode') {\r\n                    //this.fullMode();\r\n                    //this.sceneProxy.onSettingsFullModeBtnClicked();\r\n                }\r\n                else if (argv.parent.name === 'settings_button_windowMode') {\r\n                    //this.windowMode();\r\n                    //this.sceneProxy.onSettingsWindowModeBtnClicked();\r\n                }\r\n                else if (argv.parent.name === 'settings_button_autoOn') {\r\n                    this.autoOn();\r\n                    this.sceneProxy.onSettingsAutoOnBtnClicked();\r\n                }\r\n                else if (argv.parent.name === 'settings_button_autoOff') {\r\n                    this.autoOff();\r\n                    this.sceneProxy.onSettingsAutoOffBtnClicked();\r\n                }\r\n                else if (argv.parent.name === 'settings_button_back') {\r\n                    this.sceneProxy.isQuickPlay = true;\r\n                    appCanBack(flashvars.client,flashvars.app_version,false,flashvars.offline === '1');\r\n                    this.sceneProxy.onSettingsBackBtnClicked();\r\n                    if (this.callbackInfo) {\r\n                        this.callbackInfo.callbackFun(this.callbackInfo.callbackArgs);\r\n                        this.callbackInfo = null;\r\n                    }\r\n                }\r\n            };\r\n\r\n            const bk = this.sceneProxy.settingsLayer.create(0, 0, this.game.load.cache.checkImageKey(background.url) && background.url);\r\n            bk.width = this.game.world.width;\r\n            bk.height = this.game.world.height;\r\n            bk.name = 'settings_bk_main';\r\n            bk.inputEnabled = true;\r\n\r\n            // header\r\n            addTextBk(header.background.url, header.rect);\r\n            if (header.title.text.hidden != true) {\r\n                addTextContent(header.title.rect.x\r\n                    , header.title.rect.y\r\n                    , header.title.rect.width\r\n                    , header.title.rect.height\r\n                    , this.sceneProxy.stringMap.settings\r\n                    , header.title.text\r\n                    , 'settings_text_header');\r\n            }\r\n\r\n            // displayHeader\r\n            if(!displayHeader.hidden){\r\n                addTextBk(displayHeader.background.url, displayHeader.rect);\r\n                if (!displayHeader.title.text.hidden) {\r\n                    addTextContent(displayHeader.title.rect.x + displayHeader.rect.x\r\n                        , displayHeader.title.rect.y + displayHeader.rect.y\r\n                        , displayHeader.title.rect.width\r\n                        , displayHeader.title.rect.height\r\n                        , this.sceneProxy.stringMap.displayHeader\r\n                        , displayHeader.title.text\r\n                        , 'settings_text_displayHeader');\r\n                }\r\n            }\r\n\r\n            // textHeader\r\n            if(!textHeader.hidden){\r\n                addTextBk(textHeader.background.url, textHeader.rect);\r\n                if (!textHeader.title.text.hidden) {\r\n                    addTextContent(textHeader.title.rect.x + textHeader.rect.x\r\n                        , textHeader.title.rect.y + textHeader.rect.y\r\n                        , textHeader.title.rect.width\r\n                        , textHeader.title.rect.height\r\n                        , this.sceneProxy.stringMap.textHeader\r\n                        , textHeader.title.text\r\n                        , 'settings_text_textHeader');\r\n                }\r\n            }\r\n\r\n\r\n            // displayCaption\r\n            addTextBk(displayCaption.background.url, displayCaption.rect);\r\n            if (!displayCaption.text.hidden) {\r\n                addTextContent(displayCaption.rect.x\r\n                    , displayCaption.rect.y\r\n                    , displayCaption.rect.width\r\n                    , displayCaption.rect.height\r\n                    , this.sceneProxy.stringMap.displayCaption\r\n                    , displayCaption.text\r\n                    , 'settings_text_displayCaption');\r\n            }\r\n\r\n            // textCaption\r\n            addTextBk(textCaption.background.url, textCaption.rect);\r\n            if (!textCaption.text.hidden) {\r\n                addTextContent(textCaption.rect.x\r\n                    , textCaption.rect.y\r\n                    , textCaption.rect.width\r\n                    , textCaption.rect.height\r\n                    , this.sceneProxy.stringMap.textCaption\r\n                    , textCaption.text\r\n                    , 'settings_text_textCaption');\r\n            }\r\n\r\n            // fullMode\r\n            if (!fullMode.hidden) {\r\n                addButton(fullMode, 'settings_button_fullMode', this.sceneProxy.stringMap.fullMode, true);\r\n            }\r\n\r\n            // window mode\r\n            if (!windowMode.hidden) {\r\n                addButton(windowMode, 'settings_button_windowMode', this.sceneProxy.stringMap.windowMode, true);\r\n            }\r\n\r\n            // autoOn\r\n            if (!autoOn.hidden) {\r\n                addButton(autoOn, 'settings_button_autoOn', this.sceneProxy.stringMap.autoOn, true);\r\n            }\r\n\r\n            // autoOff\r\n            if (!autoOff.hidden) {\r\n                addButton(autoOff, 'settings_button_autoOff', this.sceneProxy.stringMap.autoOff, true);\r\n            }\r\n\r\n            // back\r\n            if (!back.hidden) {\r\n                const btnGroup = addButton(back, 'settings_button_back', this.sceneProxy.stringMap.back);\r\n                btnGroup.button.onInputUp.add(() => this.sceneProxy.btn_sound && this.sceneProxy.btn_sound.stop())\r\n            }\r\n\r\n            //musicCaption\r\n            if(this.sceneProxy.json_data.template.json.settings.musicCaption){\r\n                const musicCaption = this.sceneProxy.json_data.template.json.settings.musicCaption;\r\n                addTextBk(musicCaption.background.url,musicCaption.rect);\r\n                if (!musicCaption.text.hidden) {\r\n                    addTextContent(musicCaption.rect.x\r\n                        , musicCaption.rect.y\r\n                        , musicCaption.rect.width\r\n                        , musicCaption.rect.height\r\n                        , this.sceneProxy.stringMap.musicCaption\r\n                        , musicCaption.text\r\n                        , 'settings_text_musicCaption');\r\n                }\r\n            }\r\n            //musicVolume\r\n            if(this.sceneProxy.json_data.template.json.settings.musicVolume){\r\n                const musicVolume = this.sceneProxy.json_data.template.json.settings.musicVolume;\r\n                addProgress('music',musicVolume.normal.background.url,musicVolume.progress.background.url,musicVolume.rect,(value)=>{\r\n                    this.sceneProxy.updateMusicVolume(value);\r\n                });\r\n            }\r\n            //soundCaption\r\n            if(this.sceneProxy.json_data.template.json.settings.soundCaption){\r\n                const soundCaption = this.sceneProxy.json_data.template.json.settings.soundCaption;\r\n                addTextBk(soundCaption.background.url,soundCaption.rect);\r\n                if (!soundCaption.text.hidden) {\r\n                    addTextContent(soundCaption.rect.x\r\n                        , soundCaption.rect.y\r\n                        , soundCaption.rect.width\r\n                        , soundCaption.rect.height\r\n                        , this.sceneProxy.stringMap.soundCaption\r\n                        , soundCaption.text\r\n                        , 'settings_text_soundCaption');\r\n                }\r\n            }\r\n            //soundVolume\r\n            if(this.sceneProxy.json_data.template.json.settings.soundVolume){\r\n                const soundVolume = this.sceneProxy.json_data.template.json.settings.soundVolume;\r\n                addProgress('sound',soundVolume.normal.background.url,soundVolume.progress.background.url,soundVolume.rect,(value)=>{\r\n                    this.sceneProxy.updateSoundVolume(value)\r\n                });\r\n            }\r\n            //volumeHeader\r\n            if(this.sceneProxy.json_data.template.json.settings.volumeHeader){\r\n                const volumeHeader = this.sceneProxy.json_data.template.json.settings.volumeHeader;\r\n                addTextBk(volumeHeader.background.url, volumeHeader.rect);\r\n                if (!volumeHeader.title.text.hidden) {\r\n                    addTextContent(displayHeader.title.rect.x + displayHeader.rect.x\r\n                        , displayHeader.title.rect.y + displayHeader.rect.y\r\n                        , displayHeader.title.rect.width\r\n                        , displayHeader.title.rect.height\r\n                        , this.sceneProxy.stringMap.volumeHeader\r\n                        , displayHeader.title.text\r\n                        , 'settings_text_displayHeader');\r\n                }\r\n            }\r\n\r\n            this.sceneProxy.settingsLayer.visible = false;\r\n        },\r\n\r\n        showSettingsLayer: function (context) {\r\n            if (this.sceneProxy.settingsLayer.children.length === 0) {\r\n                this.addSettings();\r\n            }\r\n            const rectScreenMode = () => {\r\n                if (this.game.scale.isFullScreen) {\r\n                    this.fullMode();\r\n                    context.fullScreen = true;\r\n                } else {\r\n                    this.windowMode();\r\n                    context.fullScreen = false;\r\n                }\r\n            };\r\n            const rectTextMode = () => {\r\n                if (context.auto) {\r\n                    this.autoOn();\r\n                } else {\r\n                    this.autoOff();\r\n                }\r\n            };\r\n            if (!this.fullScreenHandler) {\r\n                this.fullScreenHandler = this.game.scale.onFullScreenChange.add(e => rectScreenMode());\r\n            }\r\n            if(this.sceneProxy.json_data.template.json.settings.musicVolume || this.sceneProxy.json_data.template.json.settings.soundVolume){\r\n                this.sceneProxy.isQuickPlay = false;\r\n                appCanBack(flashvars.client,flashvars.app_version,true,flashvars.offline === '1');\r\n            }\r\n            rectScreenMode();\r\n            rectTextMode();\r\n            this.updateVolumeProgress('sound',Utils.soundVolume);\r\n            this.updateVolumeProgress('music',Utils.musicVolume);\r\n            this.sceneProxy.settingsLayer.visible = true;\r\n            this.game.world.bringToTop(this.sceneProxy.settingsLayer);\r\n        }\r\n    },\r\n    {\r\n        /**\r\n         * @static\r\n         * @type {string}\r\n         */\r\n        NAME: 'SettingsMediator'\r\n    }\r\n);"]}