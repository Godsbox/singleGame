{"version":3,"sources":["app/js/AppConstants.js","app/js/ApplicationFacade.js","app/js/common/Dialog.js","app/js/common/FontUtils.js","app/js/common/OtherWap.js","app/js/common/PhoneUtils.js","app/js/common/RePhaser.js","app/js/common/ShanyiMenu.js","app/js/common/Utils.js","app/js/common/Version.js","app/js/common/XmlHttpRequest.js","app/js/controller/command/PrepareControllerCommand.js","app/js/controller/command/PrepareModelCommand.js","app/js/controller/command/PrepareViewCommand.js","app/js/controller/command/StartupCommand.js","app/js/main.js","app/js/model/proxy/SceneProxy.js","app/js/view/component/Scene.js","app/js/view/mediator/CoverMediator.js","app/js/view/mediator/EndMediator.js","app/js/view/mediator/HtmlTextBox.js","app/js/view/mediator/MainMenuMediator.js","app/js/view/mediator/PlaybackMediator.js","app/js/view/mediator/RecordMediator.js","app/js/view/mediator/SceneMediator.js","app/js/view/mediator/SettingsMediator.js"],"names":["window","diygamePlayer","AppConstants","CMD_STARTUP","CMD_FRAME_ENTER","CMD_SVG_MENU","CMD_LOAD_GAME","CMD_UPDATE_MUSIC_STATE","APP_DEBUG_MODE","APP_LOG","APP_SHOW_INSPECTOR","APP_SHOW_MENUBAR","APP_FPS_UPDATE","STAGE_TRAP_MOUSE","SCENE_SHOW_ERROR","SCENE_SHOW_SAVE_ALERT","SCENE_SHOW_AD","SCENE_TOOGLE_SCREEN_STATE","SCENE_SKIPPING","SCENE_PRELOADING_BEGIN","SCENE_PRELOADING_PROGRESS","SCENE_PRELOADING_COMPLETE","SCENE_LOADING_BEGIN","SCENE_LOADING_PROGRESS","SCENE_LOADING_COMPLETE","SCENE_TEMPLATE_LOADED","SCENE_SHOW_LOGO","SCENE_GOTO_COVERMENU","SCENE_GOTO_MAINMENU","SCENE_GOTO_SETTINGS","SCENE_GOTO_PLAYBACK","SCENE_GOTO_RECORD","SCENE_GOTO_END","SCENE_CLOSE_MENU","SCENE_PLOT_ANIM_BEGIN","SCENE_PLOT_SKIP","SCENE_PLOT_CLOSED","SCENE_PLOT_LOAD_BEGIN","SCENE_PLOT_LOAD_ASSETS_READY","SCENE_PLOT_LOAD_ASSETS_LOADED","SCENE_PLOT_LOAD_END","SCENE_BACKGROUND_COLOR_UPDATE","SCENE_BACKGROUND_UPDATE","SCENE_BACKGROUND_ENTERED","SCENE_BACKGROUND_SWITCH","SCENE_MUSIC_UPDATE","SCENE_SOUND_UPDATE","SCENE_CHARACTER_UPDATE","SCENE_PROP_UPDATE","SCENE_VIEW_UPDATE","SCENE_DIALOG_UPDATE","SCENE_DIALOG_COMPLETE","SCENE_CHECK_IF_SKIP","SCENE_CLICK_ON_SCENE","SCENE_OPTION_UPDATE","SCENE_MENUBUTTON_UPDATE","SCENE_WEATHER_UPDATE","SCENE_EFFECT_SHAKE","SCENE_EFFECT_TWINKLE","SCENE_CLEAR","SCENE_SHOW_GUIDE","ADD_PLAYBACK_CONTENT","SCENE_DESTROY_VIEW","SCENE_SHOW_INPUT_VIEW","_puremvc","require","_puremvc2","define","name","parent","Facade","startup","this","initialized","registerCommand","controller","command","StartupCommand","sendNotification","getInstance","multitonKey","instanceMap","instance","ApplicationFacade","NAME","Dialog","title","data","type","okText","cancelText","iscancle","arguments","length","undefined","cd","cdtype","showcancel","isShow","that","Promise","resolve","reject","ok","document","body","removeChild","modalContainer","cancel","closefun","createElement","classList","add","modalPortal","clientWidth","clientHeight","style","transform","onresize","flashvars","vertical","appendChild","titleDiv","titleData","innerText","space","close","onclick","content","contentData","buttons","buttonOk","buttonCancel","countdown","btn","wait","txt","removeAttribute","background","backgroundColor","border","color","setAttribute","setTimeout","showDialog","tileText","_Utils","FontUtils","baseFonts","testString","testSize","s","fontSize","innerHTML","defaultWidth","defaultHeight","index","fontFamily","offsetWidth","offsetHeight","detected","matched","font","default_font_size","_this","images","size","target","width","charWidth","charHeight","height","widthImg","countPerRow","heightImg","rowPerImg","isFontExist","i","url","fontChars","chars","c","ctx","getContext","len","nRow","Math","ceil","drawing","n","base64","toDataURL","blob","_Utils2","dataURLtoBlob","blobUrl","URL","createObjectURL","fontImage","img","Image","srcHeight","src","onload","drawImage","char","test","charCodeAt","_sparkMd","_XmlHttpRequest","Xhr","_Dialog","OtherWap","loadSdkJS","oHead","getElementsByTagName","item","oScript","then","msg","initdata","username","qh_username","gid","qh_qhgid","qhchannel","qh_qhchannel","qhchannelid","qh_qhchannelid","qhsdk","init","price","goodsId","indentId","chapteruuid","context","payindex","callback","sign","_sparkMd2","hash","toString","qh_key","paydata","userId","goodsName","money","roleName","ext","serverId","qh_serverid","payValues","encodeURI","sydata","game_id","uuid","chapter_uuid","amount","set_value","encodeBase64","JSON","stringify","event_id","send","d","xhrSend","rs","rj","pay","console","log","timeout","_Dialog2","custom","location","reload","responseText","retData","parse","status","success","uid","token","u","qhdata","qh_time","qh_isadult","qh_flag","qh_uid","qh_nname","refresh_token","H54399Api","load4399ApiJS","h5api","playAd","obj","code","message","e","canPlayAd","adcanplay","adremain","parseInt","remain","canplay","PhoneUtils","key","local","loadingAudioMap","audioErrorResourceRef","client","Arg","audioCountLoadByPhone","total","offline","loadAudioUrl","webkit","messageHandlers","postMessage","volume","loop","precent","musicKey","v","l","musicInfo","prevolume","inheritvolume","tweenId","random","playAudioUrl","isclear","stopAudioUrl","setAudioUrlVolume","duration","delay","nTimers","nStep","nCur","doEase","_this2","_this3","soundsInfo","soundKey","channel","some","k","audioResourceRef","removeAudioUrl","loaded","load","onSoundExtendLoad","dispatch","onSoundExtendLoadError","Rephaser","texture","baseTexture","resolution","_res","a","text","wordWrap","runWordWrap","realText","b","split","tabs","f","determineFontProperties","g","maxLines","_charCount","h","strokeThickness","padding","x","colors","strokeColors","fontWeights","fontStyles","measureLine","measureText","j","Array","isArray","m","game","math","snapToCeil","max","canvas","o","y","p","q","_lineSpacing","abs","scale","navigator","isCocoonJS","clearRect","fillStyle","fillRect","fill","strokeStyle","stroke","textBaseline","lineWidth","lineCap","lineJoin","r","ascent","align","autoRound","round","updateLine","updateShadow","shadowStroke","strokeText","renderTabLine","shadowFill","fillText","updateTexture","wordWrapWidth","isConnect","reg","combinators","RegExp","terminator","slice","substr","trimLeft","substring","replace","file","onLoad","xhr","arraybuffer","requestObject","response","ArrayBuffer","Uint8Array","isGif","crossOrigin","onComplete","onerror","fileComplete","revokeObjectURL","fileError","spliceGif","frames","loopCount","createBlob","transformUrl","complete","xhrLoad","isPlaying","_sound","usingWebAudio","externalNode","endfun","onended","disconnect","gainNode","stop","noteOff","alert","usingAudioTag","pause","currentTime","pendingPlayback","paused","prevMarker","currentMarker","onMarkerComplete","fadeTween","onStop","sound","_this4","soundData","cache","getSoundData","isSoundDecoded","updateSound","handleError","onSoundDecodeError","warn","decodeAudioData","buffer","decodedSound","onSoundDecode","_this5","indexOf","extension","lastIndexOf","Infinity","isDatAudio","toLowerCase","setFileData","touchLocked","AudioTagPool","get","audio","exist","playThroughEvent","clearTimeout","removeEventListener","onabort","addEventListener","userAgent","preload","convertDat","device","android","Blob","isDatFile","crop","w","rotated","source","globalCompositeOperation","PIXI","CanvasTinter","tintWithMultiply","Phaser","Game","prototype","destroyComponent","Signal","spriteDestroy","Sprite","destroy","apply","renderCanvas","_renderCanvas","imageDestroy","buttonDestroy","Button","_this6","Object","keys","forEach","hasOwnProperty","Sound","forceRemoveFileSet","Set","Loader","forceRemoveFile","_this7","asset","getAsset","loading","forceRemoveFileKeys","removeFromCache","has","checkSoundKey","removeSound","checkImageKey","removeImage","fileCompleteListener","progress","cacheKey","totalLoaded","totalFiles","onFileComplete","remove","_fileList","splice","cancelForceRemoveFile","loadAudioTag","soundDestroy","scratchBuffer","createBuffer","Cache","reloadSound","getSound","reloadSoundComplete","Device","canPlayAudio","mp3","ogg","opus","m4a","wav","webm","dolby","SoundManager","setMute","_muted","_muteVolume","masterGain","gain","value","_sounds","iOS","mute","onMute","unsetMute","_codeMuted","resume","onUnMute","ShanyiMenu","back","exit","urlToGo","gameCallback","syMenuBack","syMenuExit","wap","scrolling","frameBorder","_Version","_jsBase","_cryptoJs","_PhoneUtils","Utils","wname","resultUrl","parts","shift","join","path","single","currentData","currentPos","hdr","tmpCanvas","spliceCanvas","frame","lastDisposalMethod","transparency","disposalMethod","disposalRestoreFromIdx","lastImg","bitsToNum","ba","reduce","byteToBitArr","bite","push","Stream","readByte","Error","readBytes","bytes","read","String","fromCharCode","readUnsigned","lzwDecode","minCodeSize","pos","readCode","clearCode","eoiCode","codeSize","outputBlockSize","bufferBlockSize","output","dict","bufferOffset","outputOffset","clear","keep","enlargeOutput","outputSize","newoutput","set","enlargeBuffer","bufferSize","newbuffer","pushCode","last","newlength","byteLength","newdict","subarray","newsize","setSizes","setTransform","doHdr","_hdr","doGCE","gce","pushFrame","transparencyGiven","transparencyIndex","delayTime","dataUrl","doImg","currIdx","ct","lctFlag","lct","gct","putImageData","leftPos","topPos","imgData","getImageData","pixels","pixel","pix","idx","doNothing","doNetscape","block","iterations","handler","com","app","NETSCAPE","eof","parseGIF","st","parseCT","entries","readSubBlocks","offset","bufsize","resizeBuffer","newdata","parseHeader","sig","ver","bits","gctFlag","colorRes","sorted","gctSize","bgColor","pixelAspectRatio","parseExt","parseGCExt","reserved","userInput","parseComExt","comment","parsePTExt","ptHeader","ptData","pte","parseAppExt","parseNetscapeExt","unknown","parseUnknownAppExt","appData","identifier","authCode","parseUnknownExt","label","extType","parseImg","deinterlace","newPixels","rows","cpRow","toRow","fromRow","_ref","fromPixels","concat","_toConsumableArray","offsets","steps","pass","interlaced","lctSize","lzwMinCodeSize","lzwData","parseBlock","sentinel","stream","err","error","tempColor","match","toHex","hex","isNaN","time","handle","promise","timeStamp","curLocalTime","timeOffset","xhrGetServerTime","timestamp","localTime","setInterval","floor","Date","getTime","systemValues","date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getDay","seperator1","seperator2","toStr","min","currentdate","BlobBuilder","bb","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","append","getBlob","arr","mime","bStr","atob","u8arr","blobObj","Base64","encode","decode","rawKey","rawVec","_cryptoJs2","enc","Utf8","ivv","encrypted","AES","encrypt","iv","mode","CBC","pad","ZeroPadding","enstr","decrypted","decrypt","ECB","deStr","cookie","decodeURI","getCookie","app_version","localStorage","getItem","retValue","localStorage_getItem","returnValue","setItem","localStorage_setItem","arg","removeItem","removeLocalStorage","call","result","sensitiveWords","aesDecrypt","deviceId","getDeviceId","stime","sSign","aesEncrypt","encodeURIComponent","doSend","selOptions","timerHandler","searchChapter","chapter","subchapters","chapters","soundVolume","musicVolume","DelayRemoveManager","_classCallCheck","gifList","imgList","findIndex","ResourcesManager","getCount","now","addRefCount","popGif","popImg","isPlot","sKey","convertToAllowAccessControlOriginUrl","noLoading","image","bAutoDecode","forceDecode","music","sounds","noCache","_PhoneUtils2","isAudioInCache","isLoadingAudio","fun","refCount","filterKeys","oldData","_oldData$global","global","_oldData$cache","newData","prefix","startsWith","fKey","fRefType","tKey","tRefType","refType","count","_this8","_this9","acc","cur","force","_usingKeyMap","usingKeyMap","preBackground","audioTag","free","PreloadState","delayRemoveManager","startPreloadResources","getImage","_this10","createhMark","_ref2","pIndex","cmdInfo","cIndex","preloadType","preloadedCount","lock","_objectWithoutProperties","stack","cmdStack","getOptinsMarks","plot","mark","marks","options","option","plots","temp","t","checkCondOptionResources","commands","getCmdOptinsMarks","cmd","_mark$cIndex2","args","parentInfo","parentCmdIndex","updateMarkCmdInfo","updateMark","_mark","_mark$pIndex3","_mark$cIndex3","pChapter","pnPlot","cmdIndex","_preMark","searchChapterByUUID","gameData","updateLoadedMarks","specialTypes","LoadedMark","_mark2","_mark2$pIndex","_mark2$cIndex","weight","isNoUrgentlyMark","optionCount","_plot$options","_plot$condition_optio","condition_options","pushLoadMarks","_ref3","_ref4","_plot$options2","_plot$condition_optio2","oMarks","cMarks","jump","insert","revertMark","_mark$context$_preMar","loadChapter","md5","chapterUuid","downloadUuid","loadChapterPromise","_ref5","_ref5$plots","_chapter$plots","loadingChapterMap","sceneProxy","checkIfChapterFree","_mark$preloadType","types","map","optionIndexs","condOptionIndexs","gotoIndexs","preloadResources","promises","loadedCount","_loop","markPromises","_loop2","all","pushInLoader","assign","pushed","pushedList","filter","start","preloaded","finish","transferByRefCount","updateRefTypePrefix","updateLoadMarkByPrefix","_this11","cmdPlotSnap","_cmdPlotSnap$cmdIndex","resetReCount","usingResourceCountMap","forEachReCount","getResourcesByContext","_this12","opIndex","_this13","optionMarks","nextJump","every","isSame","clearLoadMarkByPrefix","_this14","_this15","optionType","_plot$options3","_plot$condition_optio3","sameIndex","_this16","_plot$condition_optio4","loadedMark","_this17","_loadedMark$pIndex","_loadedMark$cIndex","resources","addResource","getResourceSize","getInCmdInfo","getCommandResources","getInChapter","getPlotResources","needPop","pop","getWeatherOfflinePathName","getWeatherFilePathName","formatNum","isBackground","avatar","isMusic","isSound","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","normal","active","disable","getWeatherResources","_command$args$","plot_sound","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","characters","character","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","props","prop","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","weather","_this18","OptionResourcesCountMap","resourcesMap","getCountInOption","getCountInCmdOptions","getCountInOptions","getCountInCmdOption","_this19","canAddRefCount","isMaxSize","MaxSize","createMark","_ref6","createJumpMark","_content","newChapter","createInsertMark","_content2","getInCommand","musics","MaxForceDecodeMusic","preloadCmdOptions","optionPromises","_loop3","newCmdInfo","newpreloadType","pushMark","_loop4","opPlotIndex","_extends","_ret5","getInNextCommand","nextPlot","_ref7","Number","isInteger","getPlotOptionCount","getInPlot","preloadPlotOptions","opMarks","copMarks","condOptionPromises","loadPlotIntoPromise","_loop5","newPreloadType","optChapter","_loop6","optionPromise","condoptionPromise","getInNextPlot","checkResources","sizes","_ref8","oldKey","subRefCount","_usingKeyMap2","Map","freeAudio","pool","find","addAudio","play","freeCount","commit","version","serializeQuery","params","val","XMLHttpRequest","open","readyState","onProgress","ontimeout","onreadystatechange","withCredentials","setRequestHeader","istimeout","responseType","getJson","getMaterialRedirect","urls","materialRedirect","json","getGame","convertSingleJsonPath","getTestGame","getOtherGame","SimpleCommand","execute","note","facade","registerProxy","model","proxy","SceneProxy","registerMediator","view","mediator","SceneMediator","MacroCommand","initializeMacroCommand","addSubCommand","PrepareControllerCommand","PrepareModelCommand","PrepareViewCommand","innerWidth","documentElement","innerHeight","_ShanyiMenu","_FontUtils","_OtherWap","_copyToClipboard","_jsonp","Proxy","chargeMsgReceive","ev","originalEvent","newValue","resumeAudio","bk_music","plotSounds","isScreenHold","quickPlay","quickPlayLayer","alpha","pauseAudio","preloadingBegin","stringMap","loadMenu","overMenu","settingsMenu","startMenu","menu","mainMenu","save","playback","autoplay","manualPlay","settings","displayHeader","displayCaption","volumeHeader","musicCaption","soundCaption","textHeader","textCaption","autoOn","autoOff","windowMode","fullMode","progressTips","recordTipCount","isShowGuide","playbackData","plotViews","prgsViews","plotViewKeys","bViewLoaded","bSignedIn","bCloudSel","visibleLayout","resourceManager","plotIndex","resourceList","baseList","lstDialogInfo","menuInfo","bCmdAutoText","isGameStarted","usedStarCount","gameStarLimit","lstPlotTweens","twinkleTimer","uiOnLoadQueue","timerCounts","menuTimer","recUidBelongTo","gameUidBelongTo","bSwitchAccInPlot","payValueUid","unlockChapterCallBack","mallPayCallback","isPaying","isGettingNext","isPreferentialFinished","preferentialVector","isSetValues","isPaySuccess","isGoToCommand","shakeLoopObj","level","prePlotBkKey","isQuickPlay","hasCountDown","saveBubbleVector","saveBubbleDataVector","bubbleArchivalCount","dialogNext","setValueAfterPay","isInputFocus","z_key","isLineUpdatePaySuccess","playAdCallBack","playAdPayStatus","playPause","isWapOther","_OtherWap2","sendQHData","initQHSdk","audioMgr","bind","audioCanPlayCallBack","audioErrorCallBack","updateAccInfo","unlockChapterFinished","mallPay","preferentialFinished","showSave","showSaveInterface","playadBack","playadBackInterface","getTimeOffset","localUpdateTime","sendSelOptions","adtype","recordLayer","visible","fullScreen","onSettingsWindowModeBtnClicked","menuLayer","getSnap","downloaduuid","curChapter","stayIfFail","dislodgePreferentVector","checkIfMallPaySuccess","getData","serial_num","c_status","getUserInfoFromWap","addAssets","addImage","viewComponent","addImageUrl","parseJsonFile","json_data","template","parseTemplateCoverAssets","parseTemplateDialogAssets","parseTemplateMenuAssets","parseTemplateSyMenuAssets","parseTemplateMainMenuAssets","parseTemplateSettingsAssets","parseTemplateOptionAssets","parseTemplatePlaybackAssets","parseTemplateRecordAssets","parseTemplateSoundAssets","_FontUtils2","logo","cover","addEventAssets","events","subEvent","viewMap","children","child","_json_data$template$j","titleContainer","_json_data$template$j2","dialog","avatarContainer","_json_data$template$j3","shanyiMenu","_json_data$template$j4","_json_data$template$j5","header","_json_data$template$j6","unchecked","checked","_json_data$template$j7","_json_data$template$j8","scrollBox","_json_data$template$j9","record","_jsonp2","showLogo","showCover","showMainMenu","onPause","showSettings","callbackInfo","mainMenuLayer","showPlayback","bLocalCloudSwitch","bToSaveFile","loadData","showRecord","showLoad","getUidByCookie","getPayInfo","showEnd","workFinished","isPlotResourceExist","plotInfo","useIOSAudio","app_versionl","usingCountMap","hasCheckCount","isNotExist","isGlobal","isUsingKey","checkCmd","isExistWeatherResources","cmdState","autotext","hasOption","isSafeState","checkCmds","_arr","_i","getLoadingPlotResource","countCmd","getInCommands","res","_resources","keyMap","imgCount","world","soundCount","resetResources","usingCount","getResources","cmdScreenSnap","_ResourcesManager$usi","addResources","getMusic","charsAndProps","bubble","cp","getbubbleurl","ary","cmds","_cmds$args$","bubbleMode","_cmdPlotSnap$cmdScree","dialogInfo","bk","weatherType","preloadCommandsAssets","needLoad","preloadChapterAssets","restart","curPlotIndex","needLoadList","enableLayerInput","layer","bEnabled","enableChild","inputEnabled","apToFinalState","charsAndPropsLayer","exists","imgGroup","finalState","angle","removePlotTweens","tween","tweens","_tweens","onResume","resumeAll","onCoverStartBtnClicked","findFirstChapter","otherback","_copyToClipboard2","debug","unlockChapterByWapOther","charge","_chapter$plots2","info","href","coverLayer","unlockFinish","bSuccess","playLogin","unlockChapter","onCoverLoadBtnClicked","onCoverSettingBtnClicked","onCoverOverBtnClicked","opener","top","onMenuBtnClicked","onMenuBtnMoreClicked","moreWorks","onSyMenuBtnClicked","closGame","_ShanyiMenu2","showSyMenu","onMainMenuSaveBtnClicked","disableSaveOrLoad","showToast","onMainMenuLoadBtnClicked","onMainMenuPlaybackBtnClicked","onMainMenuAutoplayBtnClicked","auto","onMainMenuBackBtnClicked","onMainMenuSettingsBtnClicked","curPlotLayer","onChildInputDown","onSettingsFullModeBtnClicked","startFullScreen","stopFullScreen","onSettingsAutoOnBtnClicked","onSettingsAutoOffBtnClicked","onSettingsBackBtnClicked","settingsLayer","onRecordBackBtnClicked","showMenu","onRecordLocalBtnClicked","onRecordCloudBtnClicked","curPlotInfo","hidden","showGuideTip","id","isSignedIn","loadCloudRecord","convertCloudData","cdata","rdata","plotUuid","strTS","time_stamp","plotSnap","plot_snap","cloudPlotsData","getAccountInfo","checkChapter","isFirst","notifyGameStarted","gameStart","isWap3000","bLogout","bEntering","update","localRecFileToUidRecFile","doUpdate","copy","savePayInfo","getFansInfo","recId","userData","localStorageGetItem","savedData","localStorageSetItem","localStorageRemoveItem","fans_total","saveAccountInfo","sendData","systemvalue","saveGameValue","systemvaluestr","systemvalueBase64","systemData","readGameValue","values","decryptBase64","payment_available","game_coin_available","single_game_star_use","single_game_star","outlogin","payInfoData","aesKeyType","app_name","device_name","deviceOsVer","getPhoneData","sd","payvalue","payvaluestr","payvaluesBase64","dataIfFail","str","strBase64","getPayGoodsInfo","goodsid","formatdata","dd","getDiscounts","gameId","productId","platform","payOperation","disCounts","invokeApp","payArg","eid","special_price","balance","starsNeed","stars","starsUsed","starsLimited","worksmall","consume_falg","get_account_info","chapterInfoProgress","prgsInfo","group","getByName","graphics","beginFill","drawRect","endFill","boundsAlignH","boundsAlignV","setTextBounds","chapterMd5","_this20","showProgress","evt","callBack","_this21","getcount","game_uuid","payback","discounts","generateuuid","generateUUID","msg1","getchapterinfo","chapter_md5","chaptercharge","_this22","unlockArg","unlock","wapunlockArg","author_id","saveCloudRecord","savedPlotsData","getViewData","items","subView","visitChild","xInfo","yInfo","instanceUuid","eventsInfo","viewType","currentCount","generateType","getViewParentEvents","ref","copyFlashViewData","commandObj","bVisible","historyCommand","hideGlobalViews","dest","getWeatherType","weatherLayer","getScreenAnime","getBubbleData","clearBubbleData","savebubble","curbubble","ishide","iscurrent","bubbleUpper","_this23","buuid","cleardata","_this24","clearcount","getcountindex","gindex","removeborder","bubbleLayer","getindex","bc","ii","saveRecord","_this25","default_settings","autoSaveOrLoad","globalViews","chAndProps","saveData","bkKey","lstPlotBkKey","bkOpacity","lstPlotBkOpacity","bkFlex","lstPlotBkFlex","cmdUuid","curCmdUuid","animateScene","shake","bubbleCount","opacity","pivotX","pivot","pivotY","scaleX","scaleY","rotate","zIndex","parentScale","mirrorH","mirrorV","loadRecord","_this26","_savedPlotsData$index","goRecord","nChapter","nPlot","destroyAll","charsAndPropsInfo","endLayer","addPlayBackContent","getCommandByCommandUuid","autoText","initContext","commandInserts","inserts","goRecordHandle","_getChapterByPlotUuid","getChapterByPlotUuid","_getChapterByPlotUuid2","unlockLoadRecord","_chapter$plots3","_chapter$plots4","_chapter$plots6","_chapter$plots5","onRecordItemClicked","iCol","iRow","nCol","_this27","itemContent","itemTime","setPreviewImage","loadTexture","snapMd5","strText","getCurrentDateTime","fh","toRealImageFontHeight","fw","toRealImageFontWidth","addImageFontText","backgroundObject","savedValues","stringValues","indexValues","saved","vi","globalViewsData","Expression","safeEval","viewsData","speakings","parsebubble","bdata","bubblemode","modecommands","bubbleary","curbubbleary","show","_cdata$commandObj$his","commandUuid","onPlaybackBackBtnClicked","playBackLayer","removeAll","showLoadingToast","loadingToastLayer","bringToTop","ss","toastLayer","ee","from","addRetroText","txtData","retroFont","txtImg","fontImg","stamp","setText","addImageFontTextColors","txtObj","iPos","realData","lineBreak","placeholder","parseWaitTime","parseValue","clr","addColor","font_width","font_height","bSpeaking","bSpeakHidden","_this28","charGroup","mask","getChildAt","removeChildren","xPos","yPos","cr","bkWidth","firstMargin","fontHeight","parseFloat","fontWidth","t_h","font_size","sizeRow","seperation","itemChar","charCount","posInfo","getLeftMargin","getCharSpace","bottomInText","charsBk","sprite","imgTxt","tint","addChild","extWidth","extMargin","imgFBottom","maskWidth","maskHeight","rect","_this29","_this30","updateRender","translate","PI","restore","searchPlot","searchPlotByOption","nIndex","searchPlotByChapter","subchapter","searchCommandInOption","ops","pCmdInfo","searchCommand","getCmdScreenSnap","bkInfo","getNextPlot","eArg","isview","preStackFrame","preCmdStackFrame","loopCondition","condOptIndex","expression","condOpt","loopCountExpr","jumpUuid","jumpChapter","isCommand","curCmdInfo","curCmdIndex","isView","pPlotUuid","isMenu","isMainMenu","cmdResult","snap","_context$commandInser","_context$inserts$pop","serchchapter","_getChapterByPlotUuid3","getNextCommand","action","rCmdInfo","rIndex","optionLayer","removeInputView","inputElement","removeViewTimer","_this31","timerType","clearInterval","filterInexistentPlotViews","views","isUuidExist","_this32","plotViewsLayer","stopMusic","stopSound","lstPlotLayer","reStart","_this33","isextend","dialogLayer","_chapter$plots7","updatePayValue","_this34","isstep","isafterpay","haspayvalue","index1","_ret2","_typeof","valueOperation","bCancelUpload","_this35","ispay","isupload","normalValue","savedValue","stringValue","payValue","saveprevalues","recovervalues","uploadPayValue","indexValueOperator","reference","_ret3","isnext","setvalues","updateValues","oldContext","tempValues","isLoad","strSavedValues","lstSavedValues","updateContextTimeValues","doInCT","func","txtLineSpace","desktop","updateMusicVolume","animateMusic","updateSoundVolume","nextToPlay","isViewEvent","decodeCacheAudio","updateUsingKey","playMusic","playInheritMusic","playSound","playInheritSound","_this36","decoded","isDecoding","countDecoded","audioKeys","getKeys","SOUND","isExtend","extend","isShowLocalBtn","isShowCloudBtn","_createClass","radix","expr","_this37","evaluate","arg1","arg2","isString","sub","mul","div","mod","toN","toInt","range","end","safeInitValue","toWeek","NaN","initValue","onlyRead","_this38","oldValue","newExpr","fixArg1","fix","fixArgs","sort","string","isGetName","parseValueFormat","exec","nameStr","toFixed","parsePauseFormat","timer","_timer$time","countDown","num1","num2","len1","len2","pow","str1","str2","includes","fixed","guideLayer","progressLayer","btn_sound","audioDecodedCount","lstGameBk","Template","space_key","globalViewKeys","cmdPlotNextPromise","cmdPlayHandlerFun","preWaitCmdUuid","_RePhaser","constructor","initPlayer","scene","ww","hh","state","scaleMode","ScaleManager","SHOW_ALL","fullScreenScaleMode","pageAlignVertically","pageAlignHorizontally","stage","disableVisibilityChange","isIphone","orientation","setResizeCallback","scaleManager","rectangle","getElementById","setGameSize","setBounds","refresh","loadImageTag","_RePhaser2","renderer","renderSession","roundPixels","soundDecode","iOSVersion","input","touch","addTouchLockCallback","create","oncontextmenu","preventDefault","startBk","onRendered","phaserRender","CANVAS","agentV","AUTO","preserveDrawingBuffer","_Version2","logo_preloader","anchor","setTo","showLoading","loading_gif","addGifAnimation","showOfflineBg","offlinebg","setChildIndex","destroyLogo","logInfo","imgContinue","preLoadCertainAssets","spritesheet","preLoadWeatherAssets","preLoad","pload","onLoadStart","addOnce","addLog","onLoadComplete","init4399Api","getGameJson","iswapother","lengthComputable","percentComplete","textGroup","addButton","key_normal","key_active","onClick","isCheckBox","changeImageText","textInfo","textObj","txtImgOld","strContent","rgb","changeBackground","buttonGroup","btnObj","bk_key","fontWeight","btnGroup","bk_key_normal","bk_key_active","isdown","btnobj","btnpointer","butclick","pointer","button","setOverSound","setDownSound","onInputOut","onInputUp","fontStyle","ff","mouseOut","_pointerData","isOver","isOut","timeOut","useHandCursor","isDragged","cursor","_setHandCursor","onInputOut$dispatch","GROUP","onChildInputOut","onInputOver","onOverSound","onInputDown","onDownSound","_image$data","nCount","setFrame","base","BaseTexture","Texture","setTexture","addFitImageSprint","getAt","removeChildAt","childGroup","TEXT_CHANGED","Mediator","listNotificationInterests","handleNotification","getName","showCoverLayer","onRegister","retrieveProxy","sceneMediator","retrieveMediator","addCover","_sceneProxy$json_data","_template$json$cover","worldWidth","worlHeight","addTextContent","objText","isTitle","onBtnClicked","pointerMode","PointerMode","CURSOR","backgroundKey","flex","rate","_cover$title","bold","titleText","_sceneProxy$json_data2","showEndLayer","btnStatesChanged","keyBk","buttonKey","addEnd","text_normal","itemBlackBk","bitmapData","item_bk","text_active","btn_load","txt_load","btn_back","txt_back","btn_save","txt_save","HtmlTextBox","family","Group","parentElement","parentNode","textBoxElement","position","margin","left","borderColor","outline","insertBefore","_x","_y","_width","_height","_fontSize","isValue","existing","onDestroy","canvasX","offsetLeft","canvasY","offsetTop","canvasWidth","canvasHeight","oldCanvasWidth","oldCanvasHeight","oldCanvasX","oldCanvasY","gameWidth","gameHeight","widthScale","heightScale","xScale","yScale","newX","newY","newWidth","newHeight","setLeft","setTop","setWidth","setHeight","setFontSize","bShow","visibility","setInputCallback","inputUpdate","_text","word","rw","repeat","onblur","setClickCallback","setEnable","readOnly","defineProperty","_style","getBody","showMainMenuLayer","isAllHide","addMainMenu","addImgFontText","head","addDiyMainMenuenu","mainMenuView","registerViewKey","menuView","addView","getTimerInMenu","visitInChild","uiOnLoadInvoker","autoButton","showPlaybackLayer","addPlaybackContent","addPlayback","boxX","boxY","boxWidth","boxHeight","backgroundRect","scrollBk","scrollPane","scrollX","scrollY","itemHeight","hSpace","dragStartPointX","dragStartY","wheelEvent","onMove","point","getPoint","mousewheelevt","onMouseWheel","onScroll","onDragUpdate","pt","bFromStart","px","py","worldY","worldX","enableDrag","disableDrag","delta","wheelDelta","detail","allowHorizontalDrag","addMoveCallback","callbackFun","callbackArgs","addPlaybackItem","keyItemBk","keySubItemBk","contentX","contentY","itemGroup","itemBackground","itemText","useAdvancedWrap","updateText","advancedWordWrap","lineSpacing","showRecordLayer","localMode","isChangeClick","clicktime","clickchangetime","onLocalBtnClicked","clickInterval","btnLocal","btnCloud","onCloudBtnClicked","addRecord","boxRect","boxItem","itemsOffsetX","itemsOffsetY","itemSpaceX","vSpace","itemSpaceY","itemRect","hint","hintRect","hintText","contentRect","itemX","itemY","itemWidth","hintX","hintY","hintWidth","hintHeight","contentWidth","contentHeight","nLeft","nTop","ptDown","dragBk","isSaveOrGet","scrollHeight","onDragStart","onDragStop","onItemUp","subItem","txtTime","itemMask","autoRecord_Bk","autoRecord","autoRecord_txt","localx","localy","cloundx","cloundy","updateItems","bKey","showGuide","Boolean","times","_HtmlTextBox","TextBox","generateLayers","keyboard","addKey","Keyboard","SPACEBAR","addKeyBoardZ","onHold","screenCaptured","onUp","screenReleased","getSensitiveWords","addToastLayer","addLoadingToastLayer","onContinue","onDown","dispose","cimg","sendStatistics","assetsLoaderStart","showPlot","destroyView","showInputView","Z","removeKeyBoardZ","removeKey","animateTweens","icon","f1","t1","f2","t2","quickPlayHandler","hasView","Pointer","cmdPlotLoadResources","usePhoneUtils","needLoadNum","loadingAssets","newResources","clearPreCmdResources","assetsLoader","showtype","OperationImg","CloudImg","inputEnableChildren","tweenToPromise","guidedata","tl","toastText","typeSuccess","typeError","bk1","bk2","nextNotifier","_ref3$needLoadList","assets","isChapter","decodingAudios","loadedFileCount","canUsePhoneAudioLoad","covermusickey","isAudioError","_totalFileCount","totalFileCount","isLoadComplete","covermusiccomplete","updateLoadedCount","checkFinished","hasAudioLoadFinish","handleSoundExtendLoad","handleSoundDecodeError","checkKey","autoDecode","_sceneProxy","_logo$background","game_logo","backgroundFlex","type0","type1","progressText","fontSytle","tipText","tipLight","tipcontent","tipary","addDialogLayer","dialog_bk","dialog_bk_title","addMenuLayer","bSetFixed","menuBtnClick","menubtn","_sceneProxy$json_data3","rectSy","normalSy","activeSy","doEffectsAnimation","doAnimation","addRainEffect","rain","rain1","addSnowEffect","snow","snow1","addWindEffect","wind","wind1","tileSprite","autoScroll","addFallingLeavesEffect","fLeaves","fLeaves1","addBeachBlossomEffect","beachBlossom","beachBlossom1","addBlossomEffect","blossom","blossom1","addLightningEffect","lightning","lightning1","refUuid","parentEvents","arrKeys","keyCode","doReg","removeViewKey","removeViewKeyByInstance","unReg","doUnReg","addGlobalView","refUuidToHide","scaleInputView","closePlayAdButton","parentLayer","isRefresh","isload","diymenu","viewInfo","containerLayer","viewInfoName","_sceneProxy2","pointX","pointY","clearDiyMenu","eventHandler","nextAction","event","showNextPlot","refreshView","refreshViews","uuidToClose","objParent","bCloseMainMenu","getCloseUuid","bSingleToClose","diyMainMenu","isParent","closeSelf","realUuid","_sceneProxy$getNextCo","_sceneProxy$getNextCo2","showTip","adback","backtype","playAdVideo","n0","n1","paycontext","preOperation","getprevalues","handlegetvalue","afterOperation","goNextEvents","operationCallback","loadPayValues","dc","gohandler","keyUpCallback","eventCallback","callfun","invokeEventInfo","unshift","es","invokeHandler","onViewClicked","isHanding","addItemClickedCallback","onLoadCallback","onKeyUpCallback","onLoadBack","object","eventsInfoCopy","clickEvent","bkImg","bkPrgs","hType","vType","basePoint","updateProgressView","inputCallback","updateValue","realV","vv","ri","mgrParent","isStepCanSkip","onStepTimeOut","step","onStepInterval","scalechild","inputX","inputY","destroyInChild","prgs","nWidth","nHeight","pWidth","pHeight","isMask","mover","viewLayerName","hasInputView","bReload","getRefreshViews","newViews","oldView","newView","bExist","oldIndex","sx","sy","refxy","cws","getScaleValue","vx","vy","bkSprite","properties","ease","autoStart","yoyo","to","tweenFromPromise","addBubbleBorder","remark","origialH","itemlength","bubbley","bg","scrollgraphics","startx","starty","updatex","updatey","gonext","scorllfun","isbottom","createBubble","role","bubbleborder","onlycontent","cbgcolor","bubbleavatar","rolestyle","roledata","roletxt","contentimg","contenttextstyle","contentext","contextdata","contentbg","ch","drawRoundedRect","addChildAt","offsetx","offsety","trianglex","triangley","triangle","moveTo","lineTo","titleTxt","contentTxt","isShowAll","appCanBack","sceneShake","offSet","curOffSet","isShaking","speaking","coverage","snakename","cnpx","cnpy","clearShake","sceneTwinkle","twinkle","fixColorValue","fadeIn","curtain","screen1","screen2","interlacing","createScreen","screen","spase","createmask","__x","__y","coverblack","bk_x","bk_y","spread","visibleweather","plotindex","getChildIndex","cnpindex","dialogindex","spreadgroup","isSpreading","spreadmask","plotx","ploty","plotw","ploth","centerX","centerY","playEffect","animations","animation","_sceneProxy$json_data4","dialog_bk_avatar","dialog_avatar","dialogtitle","_avatarContainer$avat","clip","poly","Polygon","Point","drawPolygon","points","bezierCurveTo","drawCircle","_dialogInfo$dialogtit","titleStyle","titleX","titleY","setStyle","playPlotSound","addBackground","plotLayer","isInherit","bk_alpha","bk_flex","addCharsProps","_i3","cApAnimationIn","trigger","addOptions","txtOptions","timerHandles","countDownPromises","_sceneProxy$json_data5","normal_bk_key","active_bk_key","disable_bk_key","_txtOptions$i","disabledTextInfo","op_sound","btng","getGameValueByTimer","hideTimer","timerHandle","Timer","SECOND","alive","results","addWeather","_sceneProxy$weatherLa","addPlotViews","found","loadSubViews","sView","showGlobalViews","bLoadRec","savedSubView","fixTimerCount","fixViewEventsInfo","_i5","deleteSubView","itemInfo","parentView","foundinItem","tempRefer","createSubView","foundTemp","addSubView","sv","musicIn","tweenFromMusic","musicOut","tweenToMusic","dialogIn","In","From","moveFrom","dialogOut","Out","To","fadeOut","animateIn","animateOut","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","xStep","yStep","pauseSpeaking","contextScrollToBottom","bottom","maxHeight","animationSpeak","current","speed","textShow","nLine","doSpeak","speakInfo","showImmediate","immediate","clickProxy","keyProxy","race","playWait","waitTime","savePlayBackContent","speakData","playNormal","nromalnext","playCommands","isRecover","curborder","recoverCmdSnap","snapInfo","screencommands","doShake","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_step6","_iterator6","recbubble","addborder","bordercommands","hasborder","saveary","curary","hide","addbubble","bubblecommands","recover","recViews","recMenu","resetBorder","nextCmdCallback","_ret6","playHandler","old","hasBubble","index2","lstAlpha","lstAngle","lstX","xRaw","xMoveTo","lstY","yRaw","yMoveTo","lstScaleX","lstScaleY","_ret7","normalPropsTo","scalePropTo","tweenToSound","opt","resetCmdPOptionPreload","bi","getcur","getborder","gborder","addClick","ac","_sceneProxy$getNextCo3","doCmdInfo","_sceneProxy$getNextCo4","bcommands","endPlot","bhide","_sceneProxy$getNextPl","newContext","goNext","getPlotIndex","puuid","gameOver","_sceneProxy$getNextPl2","cps","nc","np","npc","optionIndex","nextPlotType","resetPlotOptionPreload","clearPrePlotResources","resetJumpPreload","resetInsertPreload","loadingResourceList","stayCurrentPlot","_sceneProxy$getNextPl3","_nChapter$plots3","_nChapter$plots","_nChapter$plots2","ispreferent","duuid","unlockPreferentialFinish","setViewComponent","component","Scene","CoverMediator","SettingsMediator","MainMenuMediator","RecordMediator","PlaybackMediator","EndMediator","onRemove","showSettingsLayer","full","on","off","updateVolumeProgress","progGroup","pk","progbk","totalwidth","addSettings","addProgress","norkey","progkey","rc","normalkey","progresskey","progpk","isProgDown","addTextBk","colorS","modeBtnClicked","argv","rectScreenMode","isFullScreen","rectTextMode","fullScreenHandler","onFullScreenChange"],"mappings":"y7CACAA,QAAOC,eAEHC,cAEIC,YAAa,cACbC,gBAAiB,kBACjBC,aAAc,eACdC,cAAe,gBACfC,uBAAwB,yBAGxBC,eAAgB,iBAChBC,QAAS,UACTC,mBAAoB,qBACpBC,iBAAkB,mBAClBC,eAAgB,iBAEhBC,iBAAkB,mBAElBC,iBAAkB,mBAClBC,sBAAuB,wBACvBC,cAAe,gBACfC,0BAA2B,4BAC3BC,eAAgB,iBAChBC,uBAAwB,yBACxBC,0BAA2B,4BAC3BC,0BAA2B,4BAC3BC,oBAAqB,sBACrBC,uBAAwB,yBACxBC,uBAAwB,yBACxBC,sBAAuB,wBACvBC,gBAAiB,kBACjBC,qBAAsB,uBACtBC,oBAAqB,sBACrBC,oBAAqB,sBACrBC,oBAAqB,sBACrBC,kBAAmB,oBACnBC,eAAgB,iBAChBC,iBAAkB,mBAClBC,sBAAuB,wBACvBC,gBAAiB,kBACjBC,kBAAmB,oBACnBC,sBAAuB,wBACvBC,6BAA8B,+BAC9BC,8BAA+B,gCAC/BC,oBAAqB,sBACrBC,8BAA+B,gCAC/BC,wBAAyB,0BACzBC,yBAA0B,2BAC1BC,wBAAyB,0BACzBC,mBAAoB,qBACpBC,mBAAoB,qBACpBC,uBAAwB,yBACxBC,kBAAmB,oBACnBC,kBAAmB,oBACnBC,oBAAqB,sBACrBC,sBAAuB,wBACvBC,oBAAqB,sBACrBC,qBAAsB,uBACtBC,oBAAqB,sBACrBC,wBAAyB,0BACzBC,qBAAsB,uBACtBC,mBAAoB,qBACpBC,qBAAsB,uBACtBC,YAAa,cACbC,iBAAiB,mBACjBC,qBAAsB,uBACtBC,mBAAoB,qBACpBC,sBAAuB,yJCjE/B,GAAAC,GAAAC,EAAA,iBACAC,GAAAA,WAAQC,QAINC,KAAM,kCACNC,OAAQH,EAAAA,WAAQI,SAUhBC,QAAS,WAEHC,KAAKC,cAETD,KAAKC,aAAa,EAElBD,KAAKE,gBAAiBzE,cAAcC,aAAaC,YAAaF,cAAc0E,WAAWC,QAAQC,gBAE/FL,KAAKM,iBAAkB7E,cAAcC,aAAaC,iBAepD4E,YAAa,SAAUC,GAOtB,GAAIC,GAAcf,EAAAA,WAAQI,OAAOW,YAC3BC,EAAWD,EAAYD,EAE7B,OAAIE,GACIA,EAGDD,EAAYD,GAAc,GAAI/E,eAAckF,kBAAkBH,IAOtEI,KAAM,geC7DaC,sFAECC,EAAOC,EAAMC,EAAMC,EAAQC,GAA+D,GAApDC,GAAoDC,UAAAC,OAAA,GAAAC,SAAAF,UAAA,IAAAA,UAAA,GAAnCG,EAAmCH,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAA9B,EAAEI,EAA4BJ,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAnB,EAAEK,IAAiBL,UAAAC,OAAA,GAAAC,SAAAF,UAAA,KAAAA,UAAA,IACvGpB,KAAK0B,SAAW1B,KAAK0B,QAAS,EAC/B,IAAMC,GAAO3B,IACb,OAAO,IAAI4B,SAAQ,SAACC,EAASC,GACzB,GAAMC,GAAK,WACPC,SAASC,KAAKC,YAAYC,GAC1BR,EAAKD,QAAS,EACdG,EAAQ,OAGNO,EAAS,WACXJ,SAASC,KAAKC,YAAYC,GAC1BR,EAAKD,QAAS,EACdI,EAAO,WAGLO,EAAW,WACbL,SAASC,KAAKC,YAAYC,GAC1BR,EAAKD,QAAS,EACdI,EAAO,UAGLK,EAAiBH,SAASM,cAAc,MAC9CH,GAAeI,UAAUC,IAAI,iBAC7B,IAAMC,GAAcT,SAASM,cAAc,MAC3CG,GAAYF,UAAUC,IAAI,eACtBR,SAASC,KAAKS,aAAeV,SAASC,KAAKU,eAC3CF,EAAYG,MAAMC,UAAY,iBAElCrH,OAAOsH,SAAW,WAEVd,SAASC,KAAKS,aAAeV,SAASC,KAAKU,aAC3CI,UAAUC,SAAWP,EAAYG,MAAMC,UAAY,YAAcJ,EAAYG,MAAMC,UAAY,gBAI/FE,UAAUC,SAAWP,EAAYG,MAAMC,UAAY,gBAAkBJ,EAAYG,MAAMC,UAAY,aAK3GV,EAAec,YAAYR,EAE3B,IAAMS,GAAWlB,SAASM,cAAc,MACxCY,GAASX,UAAUC,IAAI,QACvB,IAAMW,GAAYnB,SAASM,cAAc,OACzCa,GAAUC,UAAYtC,CACtB,IAAMuC,GAAQrB,SAASM,cAAc,OAErCe,GAAMd,UAAUC,IAAI,YACpB,IAAMc,GAAQtB,SAASM,cAAc,OACrCgB,GAAMf,UAAUC,IAAI,SACpBc,EAAMF,UAAY,IAClBE,EAAMC,QAAUpC,EAAWkB,EAAWD,EACtCc,EAASD,YAAYE,GACrBD,EAASD,YAAYI,GACrBH,EAASD,YAAYK,GACrBb,EAAYQ,YAAYC,EAExB,IAAMM,GAAUxB,SAASM,cAAc,MACvCkB,GAAQjB,UAAUC,IAAI,WACtBC,EAAYQ,YAAYO,EAExB,IAAMC,GAAczB,SAASM,cAAc,MAC3CmB,GAAYlB,UAAUC,IAAI,eAC1BxB,GAAQyC,EAAYlB,UAAUC,IAAIxB,GAClCyC,EAAYL,UAAYrC,EACxByC,EAAQP,YAAYQ,EAEpB,IAAMC,GAAU1B,SAASM,cAAc,MACvCoB,GAAQnB,UAAUC,IAAI,WACtBgB,EAAQP,YAAYS,EAEpB,IAAMC,GAAW3B,SAASM,cAAc,UAClCsB,EAAe5B,SAASM,cAAc,SAa5C,IAZAqB,EAASpB,UAAUC,IAAI,YACvBoB,EAAarB,UAAUC,IAAI,iBAC3BmB,EAASP,UAAYnC,GAAU,KAC/B2C,EAAaR,UAAYlC,GAAc,KACvCwC,EAAQT,YAAYU,GACjBlC,KAAe,GACdiC,EAAQT,YAAYW,GAExBD,EAASJ,QAAUxB,EACnB6B,EAAaL,QAAUnB,EACvBJ,SAASC,KAAKgB,YAAYd,GAEvBZ,EAAK,EAAE,CACN,GAAMsC,GAAY,QAAZA,GAAaC,EAAIC,EAAKC,GACrBD,GAAQ,GACPD,EAAIG,gBAAgB,YACpBH,EAAIlB,MAAMsB,WAAa,UACvBJ,EAAIlB,MAAMuB,gBAAkB,UAC5BL,EAAIlB,MAAMwB,OAAS,UACnBN,EAAIlB,MAAMyB,MAAQ,UAClBP,EAAIV,UAAYY,IAEhBF,EAAIQ,aAAa,YAAW,GAC5BR,EAAIlB,MAAMsB,WAAa,UACvBJ,EAAIlB,MAAMuB,gBAAkB,UAC5BL,EAAIlB,MAAMyB,MAAQ,UAClBP,EAAIlB,MAAMwB,OAAS,UACnBN,EAAIV,UAAYW,EAChBA,IACAQ,WAAW,WACPV,EAAUC,EAAIC,EAAKC,IACrB,MAGI,KAAXxC,EACCqC,EAAUF,EAASpC,EAAGoC,EAASP,WACf,IAAX5B,EACLqC,EAAUD,EAAarC,EAAGqC,EAAaR,WACvB,IAAX5B,IACLqC,EAAUF,EAASpC,EAAGoC,EAASP,WAC/BS,EAAUD,EAAarC,EAAGqC,EAAaR,YAG/C5H,OAAOsH,0CAIH/B,GACR,IAAIf,KAAK0B,OACT,MAAO1B,MAAKwE,WAAW,KAAMzD,EAAM,qCAG3BA,GACR,IAAIf,KAAK0B,OACT,MAAO1B,MAAKwE,WAAW,KAAMzD,EAAM,sCAG1BA,GACT,IAAIf,KAAK0B,OACT,MAAO1B,MAAKwE,WAAW,KAAMzD,EAAM,wCAWzBC,EAAKD,EAAK0D,EAASxD,EAAQC,EAAWC,EAASI,EAAGC,GAAyB,GAAlBC,KAAkBL,UAAAC,OAAA,GAAAC,SAAAF,UAAA,KAAAA,UAAA,EACrF,OAAIpB,MAAK0B,OAAkBE,QAAQE,SAC5B9B,KAAKwE,WAAWC,EAAU1D,EAAMC,EAAMC,EAAQC,EAAYC,EAASI,EAAGC,EAAOC,yBArJvEZ,wgBCHrB6D,EAAAjF,EAAA,qBAEqBkF,uFACE/E,GACf,GAAMgF,IAAa,kBAAmB,YAAa,aAAc,SAC3DC,EAAa,6BACbC,EAAW,OACXC,EAAI/C,SAASM,cAAc,OAGjC,IAFAyC,EAAEnC,MAAMoC,SAAWF,EACnBC,EAAEE,UAAYJ,GACT7E,KAAKkF,eAAiBlF,KAAKmF,cAAe,CAC3CnF,KAAKkF,gBACLlF,KAAKmF,gBACL,KAAK,GAAIC,KAASR,GACdG,EAAEnC,MAAMyC,WAAaT,EAAUQ,GAC/BpD,SAASC,KAAKgB,YAAY8B,GAC1B/E,KAAKkF,aAAaN,EAAUQ,IAAUL,EAAEO,YACxCtF,KAAKmF,cAAcP,EAAUQ,IAAUL,EAAEQ,aACzCvD,SAASC,KAAKC,YAAY6C,GAIlC,GAAIS,IAAW,CACf,KAAK,GAAIJ,KAASR,GAAW,CACzBG,EAAEnC,MAAMyC,WAAazF,EAAO,IAAMgF,EAAUQ,GAC5CpD,SAASC,KAAKgB,YAAY8B,EAC1B,IAAIU,GAAWV,EAAEO,aAAetF,KAAKkF,aAAaN,EAAUQ,KAAWL,EAAEQ,cAAgBvF,KAAKmF,cAAcP,EAAUQ,GACtHpD,UAASC,KAAKC,YAAY6C,GAC1BS,EAAWA,GAAYC,EAG3B,MAAOD,0CAGWE,EAAMC,GAAmB,GAAAC,GAAA5F,KACvC6F,IAkBJ,OAjBIH,GAAKI,KACDJ,EAAKI,KAAKC,OAAOC,OACjBhG,KAAKiG,UAAYP,EAAKI,KAAKC,OAAOC,MAClChG,KAAKkG,WAAaR,EAAKI,KAAKC,OAAOI,SAGnCnG,KAAKiG,UAAYP,EAAKI,KAAKC,OAC3B/F,KAAKkG,WAAaR,EAAKI,KAAKC,SAIhC/F,KAAKiG,UAAYN,EACjB3F,KAAKkG,WAAaP,GAEtB3F,KAAKoG,SAAWpG,KAAKqG,YAAcrG,KAAKiG,UACxCjG,KAAKsG,UAAYtG,KAAKuG,UAAYvG,KAAKkG,WAEhC,GAAItE,SAAQ,SAACC,EAASC,GACzB,IAAK4D,EACD,MAAO7D,IAGX,IAAI+D,EAAKY,YAAYd,EAAKL,YACtB,MAAOxD,IAGX8C,GAAUU,WAAaK,EAAKL,UAC5B,KAAK,GAAIoB,GAAE,EAAGA,EAAEf,EAAKG,OAAOxE,OAAQoF,IAChCZ,EAAOY,GAAK,8BAAgCf,EAAKG,OAAOY,GAAGC,IAC3Dd,EAAKe,WAAajB,EAAKG,OAAOY,GAAGG,KAIrC,IAAIC,GAAI7E,SAASM,cAAc,UAC3BwE,EAAMD,EAAEE,WAAW,MACnBC,EAAMnB,EAAOxE,OACb4F,EAAOC,KAAKC,KAAKvB,EAAKe,UAAUtF,OAASuE,EAAKS,YAElDQ,GAAEb,MAAQJ,EAAKQ,SACfS,EAAEV,OAASc,EAAOrB,EAAKM,UAKvB,IAAMkB,GAAU,QAAVA,GAAWC,GACb,KAAGA,EAAIL,GAQF,CAED,GAAIM,GAAST,EAAEU,UAAU,YAAa,GAClCC,EAAOC,EAAAA,WAAMC,cAAcJ,GAC3BK,EAAUH,EAAOI,IAAIC,gBAAgBL,GAAQF,CAEjD,OADA1B,GAAKkC,UAAYH,EACV9F,IAbP,GAAIkG,GAAM,GAAIC,OACVC,EAAYZ,IAAML,EAAM,EAAKC,EAAOrB,EAAKW,UAAaX,EAAKM,WAAaN,EAAKU,SACjFyB,GAAIG,IAAMrC,EAAOwB,GACjBU,EAAII,OAAS,WAET,MADArB,GAAIsB,UAAUL,EAAK,EAAG,EAAGpD,EAAUyB,SAAU6B,EAAW,EAAGZ,EAAE1C,EAAU2B,UAAW3B,EAAUyB,SAAU6B,GAC/Fb,EAAQC,EAAE,IAW7B,OAAOD,GAAQ,0CAKHiB,EAAMrD,GACtB,MAAI,cAAcsD,KAAKD,GACZ,GAAKrD,EAAW,GAElB,MAAQqD,GAAQ,MAAQA,EACtB,EAAIrD,EAAW,GAEjB,MAAQqD,EACN,GAAKrD,EAAW,GAElB,MAAQqD,GAAQ,MAAQA,EACtB,EAEF,KAAOA,EAAKE,WAAW,IAAM,MAAQF,EAAKE,WAAW,IAAM,MAAaF,EACtErD,GAAY,EAGZA,wCAIMqD,EAAMrD,GACvB,MAAI,kBAAkBsD,KAAKD,GAChB,EAEF,MAAQA,GAAQ,MAAQA,IACpB,EAAIrD,EAAW,IAEnB,MAAQqD,IACJrD,EAAW,IAEjB,EAAIA,EAAW,yBApITL,EAwIrBA,EAAUO,aAAe5D,OACzBqD,EAAUQ,cAAgB7D,OAC1BqD,EAAUmD,UAAYxG,OACtBqD,EAAUgC,UAAY,GACtBhC,EAAUU,WAAa,GACvBV,EAAUsB,UAAY,GACtBtB,EAAUuB,WAAa,GACvBvB,EAAU0B,YAAc,GACxB1B,EAAU4B,UAAY,GACtB5B,EAAUyB,SAAW,IACrBzB,EAAU2B,UAAY,wrBCnJtBkC,EAAA/I,EAAA,oBACAiF,EAAAjF,EAAA,qBACAgJ,EAAAhJ,EAAA,uBAAYiJ,OACZC,EAAAlJ,EAAA,sBAEqBmJ,uFAGb,GAAMC,GAAY,SAACX,GACf,MAAO,IAAItG,SAAQ,SAACC,EAAQC,GACxB,GAAIgH,GAAQ9G,SAAS+G,qBAAqB,QAAQC,KAAK,GACnDC,EAASjH,SAASM,cAAc,SACpC2G,GAAQjI,KAAO,kBACfiI,EAAQf,IAAMA,EACdY,EAAM7F,YAAYgG,GAClBA,EAAQd,OAAS,WACb,MAAOtG,GAAQ,yBAI3B,OAAOgH,GAAU,gCAAgCK,KAAK,SAACC,GACnD,GAAMC,IACFC,SAAWtG,UAAUuG,YACrBC,IAAMxG,UAAUyG,SAChBC,UAAY1G,UAAU2G,aACtBC,YAAc5G,UAAU6G,eAG5B,OADApO,QAAOqO,MAAMC,KAAKV,GACXxH,QAAQC,QAAQsH,iCAYpBY,EAAOC,EAASC,EAASC,EAAYC,EAAQC,EAASC,GAC7D,GAAMC,GAAOC,EAAAA,WAAIC,KAAKT,EAAMU,WAAa1H,UAAUuG,YAAcW,EAAWlH,UAAU2H,QAChFC,GACFC,OAAS7H,UAAUuG,YACnBC,IAAMxG,UAAUyG,SAChBQ,QAAUA,EACVa,UAAYd,EAAQ,KACpBe,MAAQf,EACRgB,SAAW,SACXC,IAAMf,EACNgB,SAAWlI,UAAUmI,YACrBZ,KAAOA,EAEI,KAAZF,IAAeD,EAAQgB,UAAU,GAAGvL,KAAOwL,UAAUjB,EAAQgB,UAAU,GAAGvL,MAC7E,IAAMyL,IACFC,QAAUvI,UAAUwG,IACnBgC,KAAOxI,UAAUwI,KACjBC,aAAetB,EACfuB,OAAS1B,EACT2B,UAAyB,IAAbtB,EAAiB,GAAG3C,EAAAA,WAAMkE,aAAaC,KAAKC,UAAU1B,EAAQgB,YAC1Ef,SAAWA,EACXY,IAAMf,EACN6B,SAAW9B,EACXV,YAAcvG,UAAUuG,YACxBE,SAAWzG,UAAUyG,UAEpBuC,EAAO,SAACrF,EAAIsF,GACdtD,EAAIuD,QAAQvF,EAAKsF,EAAG,KAAM,KAAM9C,KAAK,SAAAgD,KAElC,SAAAC,MAIPJ,GAAK,0CAA0CH,KAAKC,UAAUR,IAE9D7P,OAAOqO,MAAMuC,IAAIzB,EAAQ,WACrB0B,QAAQC,IAAI,YAEhB7E,EAAAA,WAAM8E,QAAQ,KAAKrD,KAAK,WAEJ,IAAbkB,EACCoC,EAAAA,WAAOC,OAAO,OAAO,+BAA+B,UAAU,QAAQ,QAAO,GAAOvD,KAAK,WAClFmB,GAAUA,EAAS,YACxB,WACKA,GAAUA,EAAS,YAG1BmC,EAAAA,WAAOC,OAAO,OAAO,uCAAuC,UAAU,QAAQ,QAAO,GAAOvD,KAAK,WAC7F1N,OAAOkR,SAASC,UAClB,WACKtC,GAAUA,6CAQzB,GAAM0B,GAAO,SAACrF,EAAIsF,GACd,MAAOtD,GAAIuD,QAAQvF,EAAKsF,EAAG,KAAM,KAAM9C,KAAK,SAAAgD,GAExC,GAA+B,IAA3BA,EAAGU,aAAavL,OAEhB,MAAOO,SAAQE,OAAO,+BAE1B,IAAI+K,GAAUjB,KAAKkB,MAAMZ,EAAGU,aAC5B,OAAsB,KAAnBC,EAAQE,QAAgBF,EAAQG,WAAY,GAAQH,EAAQ9L,MAC3DgC,UAAUkK,IAAMJ,EAAQ9L,KAAKkM,IAC7BlK,UAAUmK,MAAQL,EAAQ9L,KAAKmM,MAC/BnK,UAAUoK,EAAIN,EAAQ9L,KAAKoM,EACpBvL,QAAQC,WAJnB,QAMD,SAAAsK,OAIDiB,GACF9D,YAAcvG,UAAUuG,YACvB4B,YAAcnI,UAAUmI,YACxBmC,QAAUtK,UAAUsK,QACpBC,WAAavK,UAAUuK,WACvBC,QAAUxK,UAAUwK,QACpBC,OAASzK,UAAUyK,OACnBC,SAAWhG,EAAAA,WAAMkE,aAAa5I,UAAU0K,UACxC/D,aAAe3G,UAAU2G,aACzBE,eAAiB7G,UAAU6G,eAC3B8D,cAAgB,EAErB,OAAO3B,GAAK,iDAAiDH,KAAKC,UAAUuB,0BA3H/DxE,IAkIR+E,iGAKL,GAAMC,GAAgB,SAAC1F,GACnB,MAAO,IAAItG,SAAQ,SAACC,EAAQC,GACxB,GAAIgH,GAAQ9G,SAAS+G,qBAAqB,QAAQC,KAAK,GACnDC,EAASjH,SAASM,cAAc,SACpC2G,GAAQjI,KAAO,kBACfiI,EAAQf,IAAMA,EACdY,EAAM7F,YAAYgG,GAClBA,EAAQd,OAAS,WACb,MAAOtG,GAAQ,2BAI3B,OAAO+L,GAAc,mDAAmD1E,KAAK,SAACC,GAC1E,MAAOvH,SAAQC,QAAQsH,sCAQ3B,MAAO,IAAIvH,SAAQ,SAACC,EAAQC,GACxB,IACItG,OAAOqS,MAAMC,OAAO,SAACC,GACjB,MAAgB,OAAbA,EAAIC,KAEgB,QAAbD,EAAIC,MACV3B,QAAQC,IAAI,QACLzK,GAASmL,SAAQ,EAAK7D,IAAI,SAEjCkD,QAAQC,IAAI,QACLzK,GAASmL,SAAQ,EAAM7D,IAAI4E,EAAIE,eANtC5B,SAAQC,IAAI,UASvB,MAAO4B,GACJ,MAAOrM,IAASmL,SAAQ,EAAM7D,IAAI,mDAW1C,MAAO,IAAIvH,SAAQ,SAACC,EAASC,GACzB,IACItG,OAAOqS,MAAMM,UAAU,SAACpN,GACpB,GAAGA,EAAK,CACJ,GAAMqN,GAAYrN,EAAKoN,UACjBE,EAAWC,SAASvN,EAAKwN,OAC/B,OAAO1M,IAAS2M,QAAQJ,EAAUG,OAAOF,IAEzC,MAAOxM,IAAS2M,SAAQ,EAAMD,OAAO,MAGhD,MAAOL,GAEJ,MAAOrM,IAAS2M,SAAQ,EAAMD,OAAO,keCxMhCE,0MACGC,EAAKhI,EAAKiI,GAG1B,GAFA3O,KAAK4O,gBAAgBF,IAAO,EAC5B1O,KAAK6O,sBAAsBH,GAAO,EACT,QAArB3L,UAAU+L,OAAkB,CAC5B,GAAIC,IAAOL,IAAIA,EAAKhI,IAAKA,EAAKiI,MAAMA,EACpC3O,MAAKgP,sBAAsBC,QACH,MAArBlM,UAAUmM,QACEC,aAAavD,KAAKC,UAAUkD,IAEvCvT,OAAO4T,QAAU5T,OAAO4T,OAAOC,gBAAgBF,aAAaG,YAAY1D,KAAKC,UAAUkD,wCAKlFL,EAAKa,EAAQC,GAAkB,GAAbC,GAAarO,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAH,EACnCsO,EAAWhB,EAAMA,EAAM1O,KAAK0P,SAC5BC,EAAMJ,GAAqB,IAAXA,EAAoBA,EAAJ,EAChCK,EAAatO,SAATkO,GAA+B,OAATA,GAAuBA,CACvDxP,MAAK6P,UAAUnB,IAAMgB,EACrB1P,KAAK6P,UAAUN,OAASI,EAAIF,EAC5BzP,KAAK6P,UAAUC,UAAYH,EAC3B3P,KAAK6P,UAAUE,iBACf/P,KAAK6P,UAAUG,QAAU1B,SAAuB,IAAdpH,KAAK+I,UACvCjQ,KAAKkQ,aAAaR,EAAUC,EAAGC,EAAG,QAAQH,uCAGb,GAAhBU,KAAgB/O,UAAAC,OAAA,GAAAC,SAAAF,UAAA,KAAAA,UAAA,EAC7BpB,MAAKoQ,aAAa,SAClBD,IAAYnQ,KAAK6P,UAAUnB,IAAM,6CAGba,GAAkB,GAAXE,GAAWrO,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAH,CACnCpB,MAAK6P,UAAUE,cAAgBR,EAC/BvP,KAAKqQ,kBAAkB,QAASd,EAASE,0CAGvBF,EAAQe,EAAUC,GAAO,GAAA3K,GAAA5F,IAC3C,OAAO,IAAI4B,SAAQ,SAACC,EAASC,GACzB,GAAIwO,GAAY,GAGZ,MAFA1K,GAAKiK,UAAUN,OAASA,EACxB3J,EAAKyK,kBAAkB,QAASd,GACzB1N,GAGX,IAAI2O,GAAUF,EAAW,GACrBG,GAAS7K,EAAKiK,UAAUN,OAASA,GAAUiB,EAC3CE,EAAOnB,CAEX3J,GAAKiK,UAAUG,QAAU1B,SAAuB,IAAdpH,KAAK+I,SACvC,IAAID,GAAUpK,EAAKiK,UAAUG,QAEvBW,EAAS,QAATA,KACF,GAAOhP,GAAAA,CACP,OAAO,YACH,OAAKA,EAAKkO,UAAUN,OAASmB,GAAQD,EAAQ,GAAK9O,EAAKkO,UAAUN,OAASmB,GAAQD,EAAQ,IACnFT,IAAYrO,EAAKkO,UAAUG,SAC9BU,GAAQD,EACJC,EAAO,EAAGA,EAAO,EACZA,EAAO,IAAGA,EAAO,GAC1B/O,EAAK0O,kBAAkB,QAASK,GAChC/O,EAAKkO,UAAUN,OAASmB,EACxBnM,WAAWoM,IAAU,IALrBD,SAQA/O,EAAKkO,UAAUN,OAASA,EACxB5N,EAAKkO,UAAUC,UAAYP,EACpB1N,MAInB0C,YAAWoM,IAAUJ,0CAIThB,EAAQe,EAAUC,GAAO,GAAAK,GAAA5Q,IACzC,OAAO,IAAI4B,SAAQ,SAACC,EAASC,GACzB,GAAIwO,GAAY,GAGZ,MAFAM,GAAKf,UAAUN,OAASA,EACxBqB,EAAKP,kBAAkB,QAASd,GACzB1N,GAGX,IAAI2O,GAAUF,EAAW,GACrBG,GAASlB,EAASqB,EAAKf,UAAUN,QAAUiB,EAC3CE,EAAOE,EAAKf,UAAUN,MAE1BqB,GAAKf,UAAUG,QAAU1B,SAAuB,IAAdpH,KAAK+I,SACvC,IAAID,GAAUY,EAAKf,UAAUG,QAEvBW,EAAS,QAATA,KACF,GAAMhP,GAAAA,CACN,OAAO,YACH,OAAK+O,EAAOnB,GAAUkB,EAAQ,GAAKC,EAAOnB,GAAUkB,EAAQ,IAAMT,IAAYrO,EAAKkO,UAAUG,SACzFU,GAAQD,EACJC,EAAO,EAAGA,EAAO,EACZA,EAAO,IAAGA,EAAO,GAC1B/O,EAAK0O,kBAAkB,QAASK,GAChC/O,EAAKkO,UAAUN,OAASmB,EACxBnM,WAAWoM,IAAU,IALrBD,SAQA/O,EAAKkO,UAAUN,OAASA,EACxB5N,EAAKkO,UAAUC,UAAYP,EACpB1N,MAInB0C,YAAWoM,IAAUJ,0CAITnL,EAAOmK,EAAQe,EAAUC,GAAO,GAAAM,GAAA7Q,IAChD,OAAO,IAAI4B,SAAQ,SAACC,EAASC,GACzB,IAAK+O,EAAKC,WAAW1L,GAAOsJ,IACxB,MAAO7M,IAEX,IAAIyO,GAAY,GAGZ,MAFAO,GAAKC,WAAW1L,GAAOmK,OAASA,EAChCsB,EAAKR,kBAAkB,QAAQjL,EAAOmK,GAC/B1N,GAGX,IAAI2O,GAAUF,EAAW,GACrBG,GAASlB,EAASsB,EAAKC,WAAW1L,GAAOmK,QAAUiB,EACnDE,EAAOG,EAAKC,WAAW1L,GAAOmK,MAElCsB,GAAKC,WAAW1L,GAAO4K,QAAU1B,SAAuB,IAAdpH,KAAK+I,SAC/C,IAAID,GAAUa,EAAKC,WAAW1L,GAAO4K,QAE/BW,EAAS,QAATA,KACF,GAAMhP,GAAAA,CACN,OAAO,YACH,OAAK+O,EAAOnB,GAAUkB,EAAQ,GAAKC,EAAOnB,GAAUkB,EAAQ,IAAMT,IAAYrO,EAAKmP,WAAW1L,GAAO4K,SACjGU,GAAQD,EACJC,EAAO,EAAGA,EAAO,EACZA,EAAO,IAAGA,EAAO,GAC1B/O,EAAK0O,kBAAkB,QAAQjL,EAAOsL,GACtC/O,EAAKmP,WAAW1L,GAAOmK,OAASmB,EAChCnM,WAAWoM,IAAU,IALrBD,SAQA/O,EAAKmP,WAAW1L,GAAOmK,OAASA,EAChC5N,EAAKmP,WAAW1L,GAAO0K,UAAYP,EAC5B1N,MAInB0C,YAAWoM,IAAUJ,uCAIZnL,GACb,GAAGA,OACC,IAAI,GAAIqB,GAAG,EAAEA,EAAKzG,KAAK8Q,WAAWzP,OAAOoF,IAAI,CACzC,GAAI1B,GAAI/E,KAAK8Q,WAAWrK,EACrB1B,IACCA,EAAE2J,KAAO1O,KAAKoQ,aAAa,QAAQ3J,OAG1C,CACD,GAAMiI,GAAM1O,KAAK8Q,WAAW1L,GAAOsJ,GACnCA,IAAO1O,KAAKoQ,aAAa,QAAQhL,GACjCpF,KAAK8Q,WAAW1L,GAAOsJ,IAAM,sCAIpBtJ,EAAOsJ,EAAKa,EAAQC,GAAkB,GAAbC,GAAarO,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAH,EAC1C2P,EAAWrC,EAAMA,EAAM1O,KAAK8Q,WAAW1L,GAAOsJ,IAC9CiB,EAAMJ,GAAqB,IAAXA,EAAoBA,EAAJ,EAChCK,EAAatO,SAATkO,GAA+B,OAATA,GAAuBA,CACvDxP,MAAK8Q,WAAW1L,GAAOsJ,IAAMqC,EAC7B/Q,KAAK8Q,WAAW1L,GAAOmK,OAASI,EAAIF,EACpCzP,KAAK8Q,WAAW1L,GAAOoK,KAAOI,EAC9B5P,KAAK8Q,WAAW1L,GAAO0K,UAAYH,EACnC3P,KAAK8Q,WAAW1L,GAAO2K,iBACvB/P,KAAK8Q,WAAW1L,GAAO4K,QAAU1B,SAAuB,IAAdpH,KAAK+I,UAC/CjQ,KAAKkQ,aAAaa,EAAUpB,EAAGC,EAAG,QAAQxK,EAAMqK,4CAG5BrK,EAAOmK,GAAkB,GAAXE,GAAWrO,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAH,CAC1CpB,MAAK8Q,WAAW1L,GAAO2K,cAAgBR,EACvCvP,KAAKqQ,kBAAkB,QAAQjL,EAAOmK,EAASE,4JAG/Bf,EAAKa,EAAQC,EAAMwB,GAAqB,GAAbvB,GAAarO,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAH,CACrD,IAAyB,QAArB2B,UAAU+L,OAAkB,CAC5B,GAAIC,IAAOL,IAAKA,EAAKa,OAAOA,EAASE,EAASD,KAAKA,EAAK,EAAE,EAAGwB,QAAQA,EAC7C,IAArBjO,UAAUmM,QACEgB,aAAatE,KAAKC,UAAUkD,IAEvCvT,OAAO4T,QAAU5T,OAAO4T,OAAOC,gBAAgBa,aAAaZ,YAAY1D,KAAKC,UAAUkD,yJAK/EiC,GAChB,GAAyB,QAArBjO,UAAU+L,OAAkB,CAC5B,GAAIC,IAAOiC,QAASA,EACI,IAArBjO,UAAUmM,QACEkB,aAAaxE,KAAKC,UAAUkD,IAEvCvT,OAAO4T,QAAU5T,OAAO4T,OAAOC,gBAAgBe,aAAad,YAAY1D,KAAKC,UAAUkD,gDAI1EiC,GAAoB,GAAZvB,GAAYrO,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAF,CACvC,IAAGpB,KAAK6P,UAAU,CACd,GAAIN,GAA2CjO,SAAjCtB,KAAK6P,UAAUE,eAA+B/P,KAAK6P,UAAUE,mBAAuB/P,KAAK6P,UAAUE,cAAgBN,EAAUzP,KAAK6P,UAAUC,UAAYL,CACtKzP,MAAKqQ,kBAAkBW,EAAQzB,8CAGdyB,GAAkB,GAAVvB,GAAUrO,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAF,CACrC,IAAGpB,KAAK8Q,YAAc9Q,KAAK8Q,WAAWzP,OAAS,EAC3C,IAAI,GAAIoF,GAAG,EAAEA,EAAKzG,KAAK8Q,WAAWzP,OAAOoF,IAAI,CACzC,GAAI1B,GAAI/E,KAAK8Q,WAAWrK,EACxB,IAAG1B,EAAE,CACD,GAAIwK,GAA8BjO,SAApByD,EAAEgL,eAA+BhL,EAAEgL,mBAAwBhL,EAAEgL,cAAgBN,EAAU1K,EAAE+K,UAAYL,CACnHzP,MAAKqQ,kBAAkBW,EAAUvK,EAAE8I,+JAK1ByB,EAASzB,GAE9B,GAAyB,QAArBxM,UAAU+L,OAAkB,CAC5B,GAAIC,IAAOiC,QAASA,EAASzB,OAAOA,EAChCR,GAAIQ,QAAyB,IAAfR,EAAIQ,SAClBR,EAAIQ,OAAS,GAEF,UAAZyB,IACChR,KAAK6P,UAAUN,OAASR,EAAIQ,QAEP,MAAtBxM,UAAUmM,QACEmB,kBAAkBzE,KAAKC,UAAUkD,IAE5CvT,OAAO4T,QAAU5T,OAAO4T,OAAOC,gBAAgBgB,kBAAkBf,YAAY1D,KAAKC,UAAUkD,2JAKlFL,GAClB,GAAIA,IAAQ1O,KAAK6P,UAAUnB,MAAO1O,KAAK8Q,WAAWG,KAAK,SAAAC,GAAM,MAAOxC,KAAQwC,IAA5E,CAIA,GAAInC,IAAOL,IAAKA,EAChB1O,MAAKmR,iBAAiBzC,GAAO,EACL,GAArB3L,UAAUmM,QACEkC,eAAexF,KAAKC,UAAUkD,IAEzCvT,OAAO4T,QAAU5T,OAAO4T,OAAOC,gBAAgB+B,eAAe9B,YAAY1D,KAAKC,UAAUkD,6CAI3EL,GAClB,QAAS1O,KAAKmR,iBAAiBzC,wCAGfA,GAChB,QAAS1O,KAAK6O,sBAAsBH,0CAGlBA,GAClB,QAAS1O,KAAK4O,gBAAgBF,gDAGNA,SACjB1O,MAAK4O,gBAAgBF,GAC5B1O,KAAKgP,sBAAsBqC,SAC3BrR,KAAKsR,KAAKC,kBAAkBC,SAAS9C,GACrC1O,KAAKmR,iBAAiBzC,GAAO,6CAGPA,SACf1O,MAAK4O,gBAAgBF,GAC5B1O,KAAKgP,sBAAsBqC,SAC3BrR,KAAKsR,KAAKG,uBAAuBD,SAAS9C,GAC1C1O,KAAKmR,iBAAiBzC,GAAO,EAC7B1O,KAAK6O,sBAAsBH,GAAO,wBAvRrBD,EA0RrBA,EAAWG,mBACXH,EAAWO,uBAAyBqC,OAAO,EAAGpC,MAAM,GACpDR,EAAW6C,KAAO,KAClB7C,EAAWoB,WAAanB,IAAI,GAAIa,OAAO,EAAGS,QAAQ,GAClDvB,EAAWqC,aAAepC,IAAI,GAAIa,OAAO,EAAGC,MAAK,EAAOQ,QAAQ,IAAKtB,IAAI,GAAIa,OAAO,EAAGC,MAAK,EAAOQ,QAAQ,IAAKtB,IAAI,GAAIa,OAAO,EAAGC,MAAK,EAAOQ,QAAQ,IAC3HtB,IAAI,GAAIa,OAAO,EAAGC,MAAK,EAAOQ,QAAQ,IAAKtB,IAAI,GAAIa,OAAO,EAAGC,MAAK,EAAOQ,QAAQ,IAAKtB,IAAI,GAAGa,OAAO,EAAGC,MAAK,EAAOQ,QAAQ,IAC3HtB,IAAI,GAAIa,OAAO,EAAGC,MAAK,EAAOQ,QAAQ,IAAKtB,IAAI,GAAIa,OAAO,EAAGC,MAAK,EAAOQ,QAAQ,IAAKtB,IAAI,GAAIa,OAAO,EAAGC,MAAK,EAAOQ,QAAQ,IAC5HtB,IAAI,GAAIa,OAAO,EAAGC,MAAK,EAAOQ,QAAQ,IACjEvB,EAAW0C,oBACX1C,EAAWI,8hBChSXnK,EAAAjF,EAAA,qBAEqBiS,wFAEb1R,KAAK2R,QAAQC,YAAYC,WAAa7R,KAAK8R,KACvC9R,KAAKmK,QAAQzE,KAAO1F,KAAK4C,MAAM8C,IACnC,IAAIqM,GAAI/R,KAAKgS,IAEbhS,MAAK4C,MAAMqP,WAAaF,EAAI/R,KAAKkS,YAAYlS,KAAKgS,MAAOhS,KAAKmS,SAAWJ,EACzE,IAAIK,GAAIL,EAAEM,MAAM,kBACVxL,EAAI7G,KAAK4C,MAAM0P,KACftG,KACAkC,EAAI,EACJqE,EAAIvS,KAAKwS,wBAAwBxS,KAAK4C,MAAM8C,MAC5C+M,EAAIL,EAAE/Q,MACZrB,MAAK4C,MAAM8P,SAAW,GAAK1S,KAAK4C,MAAM8P,SAAWN,EAAE/Q,SAAWoR,EAAIzS,KAAK4C,MAAM8P,UACzE1S,KAAK2S,WAAa,CACtB,KAAK,GAAIC,GAAI,EAAGA,EAAIH,EAAGG,IAAK,CACxB,GAAI,IAAM/L,EAAG,CACT,GAAIJ,GAAIzG,KAAK4C,MAAMiQ,gBAAkB7S,KAAK8S,QAAQC,CAClDtM,IAAKzG,KAAKgT,OAAO3R,OAAS,GAAKrB,KAAKiT,aAAa5R,OAAS,GAAKrB,KAAKkT,YAAY7R,OAAS,GAAKrB,KAAKmT,WAAW9R,OAAS,EAAIrB,KAAKoT,YAAYhB,EAAEQ,IAAM5S,KAAKmK,QAAQkJ,YAAYjB,EAAEQ,IAAI5M,UAEhL,CACH,GAAIsN,GAAIlB,EAAEQ,GAAGP,MAAM,UACb5L,EAAIzG,KAAK8S,QAAQC,EAAI/S,KAAK4C,MAAMiQ,eACtC,IAAIU,MAAMC,QAAQ3M,GACd,IAAK,GAAIqK,GAAI,EAAGtB,EAAI,EAAGA,EAAI0D,EAAEjS,OAAQuO,IAAK,CACtC,GAAI6D,GAAI,CACRA,GAAIzT,KAAKgT,OAAO3R,OAAS,GAAKrB,KAAKiT,aAAa5R,OAAS,GAAKrB,KAAKkT,YAAY7R,OAAS,GAAKrB,KAAKmT,WAAW9R,OAAS,EAAIrB,KAAKoT,YAAYE,EAAE1D,IAAM1I,KAAKC,KAAKnH,KAAKmK,QAAQkJ,YAAYC,EAAE1D,IAAI5J,OAC5L4J,EAAI,IAAMsB,GAAKrK,EAAE+I,EAAI,IACjBnJ,EAAIyK,EAAIuC,MAGhB,KAAK,GAAI7D,GAAI,EAAGA,EAAI0D,EAAEjS,OAAQuO,IAAK,CAC/BnJ,GAAKzG,KAAKgT,OAAO3R,OAAS,GAAKrB,KAAKiT,aAAa5R,OAAS,GAAKrB,KAAKkT,YAAY7R,OAAS,GAAKrB,KAAKmT,WAAW9R,OAAS,EAAIrB,KAAKoT,YAAYE,EAAE1D,IAAM1I,KAAKC,KAAKnH,KAAKmK,QAAQkJ,YAAYC,EAAE1D,IAAI5J,MAC7L,IAAIqB,GAAIrH,KAAK0T,KAAKC,KAAKC,WAAWnN,EAAGI,GAAKJ,CAC1CA,IAAKY,GAGjB2E,EAAE4G,GAAK1L,KAAKC,KAAKV,GACbyH,EAAIhH,KAAK2M,IAAI3F,EAAGlC,EAAE4G,IAE1B5S,KAAK8T,OAAO9N,MAASkI,EAAIlO,KAAK8R,IAC9B,IAAIiC,GAAIxB,EAAEvN,SAAWhF,KAAK4C,MAAMiQ,gBAAkB7S,KAAK8S,QAAQkB,EACzDC,EAAIF,EAAItB,EACRyB,EAAIlU,KAAKmU,YACf,GAAID,GAAKhN,KAAKkN,IAAIF,GAAKH,IAAMG,GAAKH,GAClC,IAAMG,IAAMD,GAAKC,EAAI,EAAIA,EAAI9B,EAAE/Q,OAAS6S,GAAK9B,EAAE/Q,OAAS,IACpDrB,KAAK8T,OAAO3N,QAAU8N,EAAE,GAAKjU,KAAK8R,KAClC9R,KAAKmK,QAAQkK,MAAMrU,KAAK8R,KAAM9R,KAAK8R,MACvCwC,UAAUC,YAAcvU,KAAKmK,QAAQqK,UAAU,EAAG,EAAGxU,KAAK8T,OAAO9N,MAAOhG,KAAK8T,OAAO3N,QACpFnG,KAAK4C,MAAMuB,kBAAoBnE,KAAKmK,QAAQsK,UAAYzU,KAAK4C,MAAMuB,gBAC/DnE,KAAKmK,QAAQuK,SAAS,EAAG,EAAG1U,KAAK8T,OAAO9N,MAAOhG,KAAK8T,OAAO3N,SAC3DnG,KAAKmK,QAAQsK,UAAYzU,KAAK4C,MAAM+R,KACpC3U,KAAKmK,QAAQzE,KAAO1F,KAAK4C,MAAM8C,KAC/B1F,KAAKmK,QAAQyK,YAAc5U,KAAK4C,MAAMiS,OACtC7U,KAAKmK,QAAQ2K,aAAe,aAC5B9U,KAAKmK,QAAQ4K,UAAY/U,KAAK4C,MAAMiQ,gBACpC7S,KAAKmK,QAAQ6K,QAAU,QACvBhV,KAAKmK,QAAQ8K,SAAW,OAC5B,IAAIC,GAAGnQ,EAAG6N,CACV,KAAK5S,KAAK2S,WAAa,EACdC,EAAI,EAAGH,EAAIG,EAAGA,IACnBsC,EAAIlV,KAAK4C,MAAMiQ,gBAAkB,EAC7B9N,EAAI/E,KAAK4C,MAAMiQ,gBAAkB,EAAID,EAAImB,EAAIxB,EAAE4C,OACnDvC,EAAI,IAAM7N,GAAKmP,EAAItB,GACf,UAAY5S,KAAK4C,MAAMwS,MAAQF,GAAKhH,EAAIlC,EAAE4G,GAAK,WAAa5S,KAAK4C,MAAMwS,QAAUF,IAAMhH,EAAIlC,EAAE4G,IAAM,GACvG5S,KAAKqV,YAAcH,EAAIhO,KAAKoO,MAAMJ,GAC9BnQ,EAAImC,KAAKoO,MAAMvQ,IACf/E,KAAKgT,OAAO3R,OAAS,GAAKrB,KAAKiT,aAAa5R,OAAS,GAAKrB,KAAKkT,YAAY7R,OAAS,GAAKrB,KAAKmT,WAAW9R,OAAS,EAAIrB,KAAKuV,WAAWnD,EAAEQ,GAAIsC,EAAGnQ,IAAM/E,KAAK4C,MAAMiS,QAAU7U,KAAK4C,MAAMiQ,kBAAoB7S,KAAKwV,aAAaxV,KAAK4C,MAAM6S,cAClO,IAAM5O,EAAI7G,KAAKmK,QAAQuL,WAAWtD,EAAEQ,GAAIsC,EAAGnQ,GAAK/E,KAAK2V,cAAcvD,EAAEQ,GAAIsC,EAAGnQ,GAAG,IACnF/E,KAAK4C,MAAM+R,OAAS3U,KAAKwV,aAAaxV,KAAK4C,MAAMgT,YAC7C,IAAM/O,EAAI7G,KAAKmK,QAAQ0L,SAASzD,EAAEQ,GAAIsC,EAAGnQ,GAAK/E,KAAK2V,cAAcvD,EAAEQ,GAAIsC,EAAGnQ,GAAG,IACzF/E,MAAK8V,yDAGe/D,GACpB,IAAK,GAAIK,GAAIpS,KAAKmK,QAAStD,EAAI7G,KAAK4C,MAAMmT,cAAe/J,EAAI,GAAIkC,EAAI6D,EAAEM,MAAM,WAAYE,EAAIrE,EAAE7M,OAAQoR,EAAI,EAAGA,EAAIF,EAAGE,IAAK,CACtH,GAAIG,GAAI1E,EAAEuE,GACNa,EAAIlB,EAAEiB,YAAYT,GAAG5M,KACzB,IAAIsN,EAAIzM,EACJmF,GAAK4G,EAAI,SAaT,KAXA,GAAMoD,GAAY,SAACjE,EAAGK,GAClB,IAAKL,IAAMK,GAAK,KAAK9J,KAAKyJ,IAAM,KAAKzJ,KAAK8J,GACtC,OAAO,CAEX,IAAM6D,GAAM,kCACNC,EAAc,GAAIC,QAAO,4CACzBC,EAAa,GAAID,QAAO,yBAC9B,OAAOF,GAAI3N,KAAKyJ,IAAMmE,EAAY5N,KAAK8J,KAAO6D,EAAI3N,KAAKyJ,KAAOkE,EAAI3N,KAAK8J,KAAOgE,EAAW9N,KAAKyJ,IAE9FgC,EAAInB,EACJxN,EAAQ,IACF,CACN,GAAIqO,MACAS,EAAI,GACJD,EAAI7B,EAAEiB,YAAYU,GAAG/N,KACzB,MAAIiO,EAAIpN,GAuBD,CACHkN,IAAM/H,GAAK+H,EAAI,MACf3O,EAAQ,CACR,OAzBA,IAAK,GAAIqB,GAAI,EAAGsN,EAAEtN,KAAOyN,GAAKH,EAAEtN,GAC5BwN,EAAI7B,EAAEiB,YAAYa,GAAGlO,MAAOyN,EAAIuC,EAAUjC,EAAEtN,EAAI,GAAIsN,EAAEtN,IAAMgN,EAAIhN,EAAI,EAAGA,IACtEwN,EAAIpN,KAWT,GATI4M,QAAYA,IAAOS,EAAE7S,OAAS,GAC9B6S,IAAMA,EAAIA,EAAEmC,MAAM,EAAG5C,EAAI,IACzBM,EAAIA,EAAEuC,OAAOpC,EAAE7S,QAAQkV,aAEvBrC,IAAMA,EAAIA,EAAEmC,MAAM,OAClBtC,EAAIA,EAAEuC,OAAOpC,EAAE7S,QAAQkV,YAE3BnR,IACA4G,GAAKkI,EAAI,KACN9O,EAAQ,EAAE,CACT,KAAO4G,EAAE3K,QAA4B,OAAlB2K,EAAEA,EAAE3K,OAAO,IAE1B2K,EAAIA,EAAEwK,UAAU,EAAGxK,EAAE3K,OAAO,EAEhC0S,KAAM/H,GAAK,KAAO+H,EAAI,MACtB3O,EAAQ,CACR,SAUpB,MAAO4G,GAAIA,EAAEyK,QAAQ,QAAS,yCAGbC,GAAM,GAAA9F,GAAA5Q,KAEjB2W,EAAS,SAAAC,GACX,GAAMC,GAAcD,EAAIE,cAAcC,SAClChW,EAAAA,MACA8V,aAAuBG,eACvBjW,EAAO,GAAIkW,YAAWJ,GAE1B,IAAIK,IAAQ,CACRnW,GAAK,KAAO,IAAIwH,cACbxH,EAAK,KAAO,IAAIwH,cAChBxH,EAAK,KAAO,IAAIwH,cAChBxH,EAAK,KAAO,IAAIwH,cACfxH,EAAK,KAAO,IAAIwH,eAAgB,IAAIA,cACrCxH,EAAK,KAAO,IAAIwH,eACnB2O,GAAQ,GAGZR,EAAK3V,KAAO,GAAIiH,OAChB0O,EAAK3V,KAAKnB,KAAO8W,EAAKhI,IAElBkC,EAAKuG,cAELT,EAAK3V,KAAKoW,YAAcvG,EAAKuG,YAGjC,IAAMC,GAAa,WACXV,EAAK3V,KAAKoH,SAEVuO,EAAK3V,KAAKoH,OAAS,KACnBuO,EAAK3V,KAAKsW,QAAU,KACpBzG,EAAK0G,aAAaZ,IAI1BA,GAAK3V,KAAKoH,OAAS,WACfP,IAAI2P,gBAAgBb,EAAKhQ,KACzB0Q,KAGJV,EAAK3V,KAAKsW,QAAU,WAChBzP,IAAI2P,gBAAgBb,EAAKhQ,KACrBgQ,EAAK3V,KAAKoH,SAEVuO,EAAK3V,KAAKoH,OAAS,KACnBuO,EAAK3V,KAAKsW,QAAU,KACpBzG,EAAK4G,UAAUd,KAInBQ,EACAzP,EAAAA,WAAMgQ,UAAUZ,GAAa3N,KAAK,SAAAgM,GAC9BwB,EAAK3V,KAAK2W,OAASxC,EAAEwC,OACrBhB,EAAK3V,KAAK4W,UAAYzC,EAAEyC,UACxBjB,EAAKhQ,IAAMkB,IAAIC,gBAAgBJ,EAAAA,WAAMmQ,WAAWf,EAAa,KAC7DH,EAAK3V,KAAKmH,IAAM0I,EAAKiH,aAAanB,EAAKhQ,IAAKgQ,IAC7C,WACCA,EAAKhQ,IAAMkB,IAAIC,gBAAgBJ,EAAAA,WAAMmQ,WAAWf,EAAa,KAC7DH,EAAK3V,KAAKmH,IAAM0I,EAAKiH,aAAanB,EAAKhQ,IAAKgQ,MAGhDA,EAAKhQ,IAAMkB,IAAIC,gBAAgBJ,EAAAA,WAAMmQ,WAAWf,EAAa,KAC7DH,EAAK3V,KAAKmH,IAAM0I,EAAKiH,aAAanB,EAAKhQ,IAAKgQ,IAI5CA,EAAK3V,KAAK+W,UAAYpB,EAAK3V,KAAKiF,OAAS0Q,EAAK3V,KAAKoF,SAEnDuQ,EAAK3V,KAAKoH,OAAS,KACnBuO,EAAK3V,KAAKsW,QAAU,KACpBzG,EAAK0G,aAAaZ,IAI1B1W,MAAK+X,QAAQrB,EAAM1W,KAAK6X,aAAanB,EAAKhQ,IAAKgQ,GAAO,cAAeC,uCAGtD,GAAA9F,GAAA7Q,IAEf,IAAIA,KAAKgY,WAAahY,KAAKiY,OAEvB,GAAIjY,KAAKkY,cACT,CACI,GAAIlY,KAAKmY,aACT,CACI,GAAMC,GAASpY,KAAKiY,OAAOI,OAC3BrY,MAAKiY,OAAOI,QAAU,WAClBxH,EAAKoH,OAAOK,WAAWzH,EAAKsH,cAC5BC,GAAUA,SAGb,IAAIpY,KAAKuY,SACd,CACI,GAAMH,GAASpY,KAAKiY,OAAOI,OAC3BrY,MAAKiY,OAAOI,QAAU,WAClBxH,EAAKoH,OAAOK,WAAWzH,EAAK0H,UAC5BH,GAAUA,KAGlB,GAAyB9W,SAArBtB,KAAKiY,OAAOO,KAEZxY,KAAKiY,OAAOQ,QAAQ,OAIpB,KACIzY,KAAKiY,OAAOO,KAAK,GAErB,MAAOtK,GAEHwK,MAAMxK,QAMTlO,MAAK2Y,gBAEV3Y,KAAKiY,OAAOW,QACZ5Y,KAAKiY,OAAOY,YAAc,EAOlC,IAHA7Y,KAAK8Y,iBAAkB,EACvB9Y,KAAKgY,WAAY,GAEZhY,KAAK+Y,OACV,CACI,GAAMC,GAAahZ,KAAKiZ,aAEG,MAAvBjZ,KAAKiZ,eAELjZ,KAAKkZ,iBAAiB1H,SAASxR,KAAKiZ,cAAejZ,MAGvDA,KAAKiZ,cAAgB,GAEE,OAAnBjZ,KAAKmZ,WAELnZ,KAAKmZ,UAAUX,OAGnBxY,KAAKoZ,OAAO5H,SAASxR,KAAMgZ,wCAIhBtK,EAAK2K,GAAO,GAAAC,GAAAtZ,IAC3BqZ,GAAQA,GAAS,IACjB,IAAME,GAAYvZ,KAAK0T,KAAK8F,MAAMC,aAAa/K,EAC/C,IAAI6K,GACIvZ,KAAK0T,KAAK8F,MAAME,eAAehL,MAAS,EAAO,CAC/C1O,KAAK0T,KAAK8F,MAAMG,YAAYjL,EAAK,cAAc,EAC/C,IAAM/M,GAAO3B,KACP4Z,EAAc,WAChBN,EAAKO,mBAAmBrI,SAAS9C,GACjCrC,QAAQyN,KAAK,0BAA4BpL,GAE7C,KACI1O,KAAKmK,QAAQ4P,gBAAgBR,EAAW,SAAUS,GAC1CA,IACArY,EAAK+R,KAAK8F,MAAMS,aAAavL,EAAKsL,GAClCrY,EAAKuY,cAAc1I,SAAS9C,EAAK2K,MAHzCrZ,SAKS4Z,GAEb,MAAO1L,GACH0L,2CAMIlD,GAAM,GAAAyD,GAAAna,KAElB0G,EAAMgQ,EAAKhQ,GACXA,GAAI0T,QAAQ,MAAQ,IACpB1T,EAAMA,EAAI4P,OAAO,EAAG5P,EAAI0T,QAAQ,MAEpC,IAAIC,GAAY3T,EAAI4P,QAAQpP,KAAK2M,IAAI,EAAGnN,EAAI4T,YAAY,OAASC,EAAAA,GAAY,GACvEC,EAAyC,QAA5BH,EAAUI,cAEvBC,EAAc,SAAAhE,GAChB,GAAIyD,EAAKzG,KAAK2F,MAAMsB,YAEhBjE,EAAK3V,KAAO2D,EAAAkW,aAAaC,MACzBnE,EAAK3V,KAAKnB,KAAO8W,EAAKhI,IACtBgI,EAAK3V,KAAKmH,IAAMiS,EAAKtC,aAAanB,EAAKhQ,IAAKgQ,GAE5CyD,EAAK7C,aAAaZ,OACf,CACH,GAAIoE,GAAQpW,EAAAkW,aAAaC,KAIzB,IAHAnE,EAAK3V,KAAO+Z,EACZpE,EAAK3V,KAAKnB,KAAO8W,EAAKhI,KAEjBhK,EAAAkW,aAAaG,MAAMD,GAIpB,MAHAX,GAAKzG,KAAK2F,MAAMsB,aAAc,EAC9BjE,EAAK3V,KAAKmH,IAAMiS,EAAKtC,aAAanB,EAAKhQ,IAAKgQ,OAC5CyD,GAAK7C,aAAaZ,EAGtB,IAAInK,GAAU,KACRyO,EAAmB,QAAnBA,KACCzO,GAAS0O,aAAa1O,GACzBmK,EAAK3V,KAAKma,oBAAoB,iBAAkBF,GAAkB,GAClEtE,EAAK3V,KAAKma,oBAAoB,QAAStB,GAAa,GACpDlD,EAAK3V,KAAKma,oBAAoB,QAAStB,GAAa,GACpDlD,EAAK3V,KAAKma,oBAAoB,eAAgBtB,GAAa,GAC3DlD,EAAK3V,KAAKma,oBAAoB,iBAAkBtB,GAAa,GAC7DlD,EAAK3V,KAAKoa,QAAUzE,EAAK3V,KAAKsW,QAAU,KACxC8C,EAAK7C,aAAaZ,IAGhBkD,EAAc,QAAdA,KACCrN,GAAS0O,aAAa1O,GACzBmK,EAAK3V,KAAKma,oBAAoB,iBAAkBF,GAAkB,GAClEtE,EAAK3V,KAAKma,oBAAoB,QAAStB,GAAa,GACpDlD,EAAK3V,KAAKma,oBAAoB,QAAStB,GAAa,GACpDlD,EAAK3V,KAAKma,oBAAoB,eAAgBtB,GAAa,GAC3DlD,EAAK3V,KAAKma,oBAAoB,iBAAkBtB,GAAa,GAC7DlD,EAAK3V,KAAKoa,QAAUzE,EAAK3V,KAAKsW,QAAU,KACxC8C,EAAK7C,aAAaZ,GAGtBA,GAAK3V,KAAKqa,iBAAiB,iBAAkBJ,GAAkB,GAC/DtE,EAAK3V,KAAKqa,iBAAiB,QAASxB,GAAa,GACjDlD,EAAK3V,KAAKqa,iBAAiB,QAASxB,GAAa,GACjDlD,EAAK3V,KAAKqa,iBAAiB,eAAgBxB,GAAa,GACxDlD,EAAK3V,KAAKqa,iBAAiB,iBAAkBxB,GAAa,GAC1DlD,EAAK3V,KAAKmH,IAAMiS,EAAKtC,aAAanB,EAAKhQ,IAAKgQ,GACzCpC,UAAU+G,UAAUjB,QAAQ,gBAC3B1D,EAAK3V,KAAKua,QAAU,OACpB/O,EAAUhI,WAAW,WACdgI,GAAS0O,aAAa1O,GACzB4N,EAAK7C,aAAaZ,IACpB,KAEN,KACIA,EAAK3V,KAAKuQ,OACb,MAAMpD,GACA3B,GAAS0O,aAAa1O,GACzB4N,EAAK7C,aAAaZ,MAOxB6E,EAAa,SAAC7E,GAChB,MAAGyD,GAAKzG,KAAK8H,OAAOC,YAChBf,GAAYhE,OAGhByD,GAAKpC,QAAQrB,EAAMyD,EAAKtC,aAAanB,EAAKhQ,IAAKgQ,GAAO,cAAe,SAACA,EAAME,GACxEF,EAAKhQ,IAAMkB,IAAIC,gBAAgB,GAAI6T,OAAM9E,EAAIG,WAAa/V,KAAM,eAChE0V,EAAKiF,WAAY,EACjBjB,EAAYhE,KAIjB8D,GACCe,EAAW7E,GAEXgE,EAAYhE,4CAII/E,EAAStN,EAAOyP,GACpC,GAAI3J,GAAU2J,EAAO/M,WAAW,MAE5B6U,EAAOjK,EAAQiK,KACfC,EAAID,EAAK5V,MACT4M,EAAIgJ,EAAKzV,MAETwL,GAAQmK,UAERD,EAAIjJ,EACJA,EAAIgJ,EAAK5V,OAGT8N,EAAO9N,QAAU6V,GAAK/H,EAAO3N,SAAWyM,IAExCkB,EAAO9N,MAAQ6V,EACf/H,EAAO3N,OAASyM,GAGpBzI,EAAQqK,UAAU,EAAG,EAAGqH,EAAGjJ,GAE3BzI,EAAQ/B,UAAUuJ,EAAQC,YAAYmK,OAAQH,EAAK7I,EAAG6I,EAAK5H,EAAG6H,EAAGjJ,EAAG,EAAG,EAAGiJ,EAAGjJ,GAC7EzI,EAAQ6R,yBAA2B,cAEnC7R,EAAQsK,UAAY,KAAO,SAAmB,EAARpQ,GAAWoG,SAAS,KAAK6L;AAC/DnM,EAAQuK,SAAS,EAAG,EAAGmH,EAAGjJ,yBArablB,EAyarB,WACIuK,KAAKC,aAAaC,iBAAmBzK,EAASyK,iBAC9CC,OAAOC,KAAKC,UAAUC,iBAAmB,GAAIH,QAAOI,MAEpD,IAAMC,GAAgBL,OAAOM,OAAOJ,UAAUK,OAC9CP,QAAOM,OAAOJ,UAAUK,QAAU,WAC9B,GAAMjJ,GAAO1T,KAAK0T,IAClB+I,GAAcG,MAAM5c,KAAMoB,WAC1BsS,GAAQA,EAAK6I,kBAAoB7I,EAAK6I,iBAAiB/K,SAASxR,KAAK0O,KAAO,MAGhF,IAAMmO,GAAeT,OAAOM,OAAOJ,UAAUQ,aAC7CV,QAAOM,OAAOJ,UAAUQ,cAAgB,WACpC,IACID,EAAaD,MAAM5c,KAAMoB,WAC3B,MAAO8M,KAKb,IAAM6O,GAAeX,OAAOpU,MAAMsU,UAAUK,OAC5CP,QAAOpU,MAAMsU,UAAUK,QAAU,WAC7B,GAAMjJ,GAAO1T,KAAK0T,IAClBqJ,GAAaH,MAAM5c,KAAMoB,WACzBsS,GAAQA,EAAK6I,kBAAoB7I,EAAK6I,iBAAiB/K,SAASxR,KAAK0O,KAAO,MAGhF,IAAMsO,GAAgBZ,OAAOa,OAAOX,UAAUK,OAC9CP,QAAOa,OAAOX,UAAUK,QAAU,WAAY,GAAAO,GAAAld,IAC1Cmd,QAAOC,KAAKpd,MAAMqd,QAAQ,SAAA3O,GAClBwO,EAAKI,eAAe5O,IAGpBwO,EAAKxO,YAAgB0N,QAAOmB,OAC5BL,EAAKxO,GAAKiO,YAIlBK,EAAcJ,MAAM5c,KAAMoB,WAG9B,IAAMoc,GAAqB,GAAIC,IAC/BrB,QAAOsB,OAAOpB,UAAUqB,gBAAkB,SAAU3c,EAAM0N,GAAK,GAAAkP,GAAA5d,KACvD6d,EAAQ7d,KAAK8d,SAAS9c,EAAM0N,EAChC,IAAImP,EACA,GAAKA,EAAMxM,QAAWwM,EAAME,QAErB,CACHC,oBAAoBxb,IAAIkM,EACxB,IAAMuP,GAAkB,WAChBT,EAAmBU,IAAIxP,KAGlB,UAAT1N,GAAoB4c,EAAKpE,MAAM2E,cAAczP,IAAQkP,EAAKpE,MAAM4E,YAAY1P,GACnE,UAAT1N,GAAoB4c,EAAKpE,MAAM6E,cAAc3P,IAAQkP,EAAKpE,MAAM8E,YAAY5P,GAC5E8O,EAAAA,UAA0B9O,KAE1B6P,EAAuB,QAAvBA,GAAwBC,EAAUC,EAAUzR,EAAS0R,EAAaC,GAC9DF,GAAY/P,IACZuP,IACAL,EAAKgB,eAAeC,OAAON,IAGnCV,GAAMxM,QAAU4M,IAChBJ,EAAME,SAAW/d,KAAK4e,eAAepc,IAAI+b,OAlBzCve,MAAK8e,UAAUC,OAAOlB,EAAMzY,MAAO,IAuB/CgX,OAAOsB,OAAOpB,UAAU0C,sBAAwB,SAAUhe,EAAM0N,GAC7D8O,EAAAA,UAA0B9O,IAG7B0N,OAAOsB,OAAOpB,UAAU2C,aAAevN,EAASuN,YAEhD,IAAMC,GAAe9C,OAAOmB,MAAMjB,UAAUK,OAC5CP,QAAOmB,MAAMjB,UAAUK,QAAW,WAE9B,GADAuC,EAAatC,MAAM5c,KAAMoB,WACrBpB,KAAKkY,cAAe,CAChBlY,KAAK0T,KAAK2F,MAAMlP,UAAYnK,KAAK0T,KAAK2F,MAAM8F,gBAC5Cnf,KAAK0T,KAAK2F,MAAM8F,cAAgBnf,KAAK0T,KAAK2F,MAAMlP,QAAQiV,aAAa,EAAG,EAAG,OAE/E,KAAKpf,KAAKiY,OAAO+B,OAASha,KAAK0T,KAAK2F,MAAM8F,cAAgB,MAAOjR,KAErElO,KAAKiY,OAAS,MAGlBmE,OAAOiD,MAAM/C,UAAUgD,YAAc,SAAU5Q,GAC3C,GAAI9I,GAAQ5F,KACRqZ,EAAQrZ,KAAKuf,SAAS7Q,EAE1B,IAAI2K,IAAU3U,EAAAkW,aAAaG,MAAM1B,EAAMtY,MAAO,CAC1C,GAAI+Z,GAAQpW,EAAAkW,aAAaC,KACzB,KAAKnW,EAAAkW,aAAaG,MAAMD,GACpB,MAEJzB,GAAMtY,KAAO+Z,EACbzB,EAAMtY,KAAKmH,IAAMmR,EAAM3S,IACvB2S,EAAMtY,KAAKqa,iBAAiB,iBAAkB,WAC1C,MAAOxV,GAAM4Z,oBAAoB9Q,KAClC,GACH2K,EAAMtY,KAAKuQ,SAInB8K,OAAOqD,OAAOC,aAAe,SAAU1e,GACnC,QAAa,QAATA,IAAkBhB,KAAK2f,SAEP,QAAT3e,IAAmBhB,KAAK4f,MAAO5f,KAAK6f,UAE3B,QAAT7e,IAAkBhB,KAAK8f,SAEd,SAAT9e,IAAmBhB,KAAK6f,UAEf,QAAT7e,IAAkBhB,KAAK+f,SAEd,SAAT/e,IAAmBhB,KAAKggB,UAEf,QAAThf,IAAkBhB,KAAKigB,QAEf,QAATjf,SAMdob,OAAO8D,aAAa5D,UAAU6D,QAAU,WACpC,IAAIngB,KAAKogB,OAAT,CAGApgB,KAAKogB,QAAS,EAEVpgB,KAAKkY,gBACLlY,KAAKqgB,YAAcrgB,KAAKsgB,WAAWC,KAAKC,MACxCxgB,KAAKsgB,WAAWC,KAAKC,MAAQ,EAGjC,KAAK,GAAI/Z,GAAI,EAAGA,EAAIzG,KAAKygB,QAAQpf,OAAQoF,IACjCzG,KAAKygB,QAAQha,GAAGkS,gBAEhB3Y,KAAK0T,KAAK8H,OAAOkF,KAAO1gB,KAAKygB,QAAQha,GAAGmS,QACxC5Y,KAAKygB,QAAQha,GAAGka,MAAO,EAG/B3gB,MAAK4gB,OAAOpP,aAGhB4K,OAAO8D,aAAa5D,UAAUuE,UAAY,WACtC,GAAK7gB,KAAKogB,SAAUpgB,KAAK8gB,WAAzB,CAIA9gB,KAAKogB,QAAS,EAEVpgB,KAAKkY,gBACLlY,KAAKsgB,WAAWC,KAAKC,MAAQxgB,KAAKqgB,YAGtC,KAAK,GAAI5Z,GAAI,EAAGA,EAAIzG,KAAKygB,QAAQpf,OAAQoF,IACjCzG,KAAKygB,QAAQha,GAAGkS,gBAEhB3Y,KAAK0T,KAAK8H,OAAOkF,KAAO1gB,KAAKygB,QAAQha,GAAGsa,SACxC/gB,KAAKygB,QAAQha,GAAGka,MAAO,EAG/B3gB,MAAKghB,SAASxP,keChlBDyP,yFAEZjhB,KAAK0B,SAAW1B,KAAK0B,QAAS,EAC/B,IAAMC,GAAO3B,IACb,OAAO,IAAI4B,SAAQ,SAACC,EAASC,GACzB,GAAMof,GAAO,WACTlf,SAASC,KAAKC,YAAYC,GAC1BR,EAAKD,QAAS,EACdG,EAAQ,IAENsf,EAAO,SAACC,GACVpf,SAASC,KAAKC,YAAYC,GAC1BR,EAAKD,QAAS,EACdG,EAAQuf,GAGZC,cAAaC,WAAaJ,EAC1BG,aAAaE,WAAaJ,CAE1B,IAAMhf,GAAiBH,SAASM,cAAc,MAC9CH,GAAeI,UAAUC,IAAI,mBAC7B,IAAMC,GAAcT,SAASM,cAAc,MAC3CG,GAAYF,UAAUC,IAAI,iBACtBR,SAASC,KAAKS,aAAeV,SAASC,KAAKU,eAC3CF,EAAYG,MAAMC,UAAYE,UAAUC,SAAW,YAAc,iBAErExH,OAAOsH,SAAW,WACVd,SAASC,KAAKS,aAAeV,SAASC,KAAKU,aAC3CF,EAAYG,MAAMC,UAAYE,UAAUC,SAAW,YAAc,gBAGjEP,EAAYG,MAAMC,UAAYE,UAAUC,SAAW,gBAAkB,aAI7Eb,EAAec,YAAYR,EAE3B,IAAMe,GAAUxB,SAASM,cAAc,MACvCkB,GAAQjB,UAAUC,IAAI,aACtBC,EAAYQ,YAAYO,GACrBT,UAAUC,WAETQ,EAAQZ,MAAMoD,MAAQ,QACtBxC,EAAQZ,MAAMuD,OAAS,QAG3B,IAAM1C,GAAczB,SAASM,cAAc,SAC3CmB,GAAYyE,IAAM,wCAA0CnF,UAAUwI,KAAO,QAAUxI,UAAUye,IAAM,cAAgBze,UAAUC,SAAW,EAAI,GAChJS,EAAYge,UAAY,KACxBhe,EAAYuC,MAAQ,OACpBvC,EAAY0C,OAAS,OACrB1C,EAAYie,YAAc,IAC1Ble,EAAQP,YAAYQ,GAGpBzB,SAASC,KAAKgB,YAAYd,2BAvDjB8e,8lCCArBxY,EAAAhJ,EAAA,uBAAYmX,OACZ+K,EAAAliB,EAAA,gBACAmiB,QAAAniB,EAAA,cACAoiB,EAAApiB,EAAA,oBACA+I,EAAA/I,EAAA,oBACAqiB,EAAAriB,EAAA,0BAEqBsiB,kGAEaC,GAC1B,MAAOjf,WAAUC,SAAWgf,EAAQ,KAAOA,sDAK3C,MAA6B,MAAtBjf,UAAUmM,QAAVnM,uEAGiC2D,GACxC,IAAKA,EACD,MAAO9E,SAAQC,QAAQ,GAE3B,IAAY,mEAAR6E,EAEA,MAAO9E,SAAQC,QAAQ,wEAK3B,IAHe,MAAX6E,EAAI,KACJA,EAAMA,EAAI8P,UAAU,IAEnB,SAASlO,KAAK5B,GAiBf,MAAO9E,SAAQE,OAAO4E,EAhBtB,IAAIub,GAAAA,OACA7c,EAAQsB,EAAI0T,QAAQ,MACxB,IAAIhV,KAAY,CACZ,GAAM8c,GAAQxb,EAAI2L,MAAM,IACxB6P,GAAMC,QACND,EAAMC,QACND,EAAMC,QACNF,EAAY,+BAAiCC,EAAME,KAAK,SAGxDH,GAAY,+BAAiCvb,CAGjD,OADsB,MAAtB3D,UAAUmM,UAAoB+S,EAAY,OAASlf,UAAUwG,IAAM,IAAM0Y,EAAUzL,UAAU,KACtF5U,QAAQC,QAAQogB,iDAOF1W,GACzB,GAAI8W,GAAO,EAKX,OAJyB,MAAtBtf,UAAUmM,SAAmBnM,UAAUuf,SAEtCD,EAAO,OAAStf,UAAUwG,IAAM,SAAWgC,EAAO,SAE/C8W,oCAGMxL,GAAa,GAAAjR,GAAA5F,IAC1B,OAAO,IAAI4B,SAAQ,SAACC,EAASC,GAEzB,GAAIygB,GAAAA,OACAC,EAAa,EACbC,EAAAA,OACEC,EAAY1gB,SAASM,cAAc,UACnCqgB,EAAe3gB,SAASM,cAAc,UACxCsgB,EAAAA,OACAC,EAAAA,OACAC,EAAe,KACfvS,EAAQ,KACRwS,EAAiB,KACjBC,EAAyB,KACzBC,EAAU,KACVtL,EAAY,EACVD,KAEAwL,EAAY,SAAAC,GACd,MAAOA,GAAGC,OAAO,SAACre,EAAGsC,GACjB,MAAW,GAAJtC,EAAQsC,GAChB,IAGDgc,EAAe,SAAAC,GAEjB,IAAK,GADCvR,MACGtL,EAAI,EAAGA,GAAK,EAAGA,IACpBsL,EAAEwR,QAAQD,EAAQ,GAAK7c,GAE3B,OAAOsL,IAGLyR,EAAS,SAAUziB,GACrBwhB,EAAcxhB,EACdyhB,EAAa,EAEbxiB,KAAKyjB,SAAW,WACZ,GAAIjB,GAAczhB,EAAKM,OACnB,KAAM,IAAIqiB,OAAM,wCAEpB,OAAI3iB,aAAgBkW,YACTlW,EAAKyhB,KAE2B,IAAhCzhB,EAAKwH,WAAWia,MAG/BxiB,KAAK2jB,UAAY,SAAUtc,GAEvB,IAAK,GADDuc,MACKnd,EAAI,EAAGA,EAAIY,EAAGZ,IACnBmd,EAAML,KAAKvjB,KAAKyjB,WAEpB,OAAOG,IAGX5jB,KAAK6jB,KAAO,SAAUxc,GAElB,IAAK,GADDtC,GAAI,GACC0B,EAAI,EAAGA,EAAIY,EAAGZ,IACnB1B,GAAK+e,OAAOC,aAAa/jB,KAAKyjB,WAElC,OAAO1e,IAGX/E,KAAKgkB,aAAe,WAChB,GAAIjS,GAAI/R,KAAK2jB,UAAU,EACvB,QAAQ5R,EAAE,IAAM,GAAKA,EAAE,KAIzBkS,EAAY,SAACC,EAAanjB,GAC5B,GAAIojB,GAAM,EACNC,EAAW,SAAAte,GAEX,IAAK,GADDkI,GAAO,EACFvH,EAAI,EAAGA,EAAIX,EAAMW,IAClB1F,EAAKojB,GAAO,GAAM,IAAY,EAANA,KACxBnW,GAAQ,GAAKvH,GAEjB0d,GAEJ,OAAOnW,IAIPqW,EAAY,GAAKH,EACjBI,EAAUD,EAAY,EAEtBE,EAAWL,EAAc,EAEzBM,EAAkB,KAClBC,EAAkB,KAElBC,EAAS,GAAIzN,YAAWuN,GACxBxK,EAAS,GAAI/C,YAAWwN,GACxBE,KAEAC,EAAe,EACfC,EAAe,EAGblQ,EAAO,WACT,IAAK,GAAIlO,GAAI,EAAGA,EAAI4d,EAAW5d,IAC3Bke,EAAKle,GAAK,GAAIwQ,YAAW,GACzB0N,EAAKle,GAAG,GAAKA,CAEjBke,GAAKN,GAAa,GAAIpN,YAAW,GACjC0N,EAAKL,GAAW,MAEdQ,EAAQ,WACV,GAAMC,GAAOV,EAAY,CACzBM,GAAK5F,OAAOgG,EAAMJ,EAAKtjB,OAAS0jB,GAChCR,EAAWL,EAAc,EACzBU,EAAe,GAIbI,EAAgB,WAClB,GAAMC,GAAaP,EAAOrjB,OAASmjB,EAC7BU,EAAY,GAAIjO,YAAWgO,EACjCC,GAAUC,IAAIT,GACdA,EAASQ,EACTV,IAAqC,GAEnCY,EAAgB,WAClB,GAAMC,GAAarL,EAAO3Y,OAASojB,EAC/Ba,EAAY,GAAIrO,YAAWoO,EAC/BC,GAAUH,IAAInL,GACdA,EAASsL,EACTb,IAAqC,GAGnCc,EAAW,SAAUvX,EAAMwX,GAE7B,IADA,GAAIC,GAAYd,EAAKa,GAAME,WAAa,EACjCd,EAAea,EAAYzL,EAAO3Y,QAAQ+jB,GACjD,IAAIO,GAAU3L,EAAO4L,SAAShB,EAAcA,EAAea,EAC3DE,GAAQR,IAAIR,EAAKa,IACjBG,EAAQF,EAAY,GAAKd,EAAK3W,GAAM,GACpC4W,GAAgBa,EAChBd,EAAKpB,KAAKoC,IAGV3X,EAAAA,OACAwX,EAAAA,MAIJ,KAFA7Q,MAMI,GAHA6Q,EAAOxX,EACPA,EAAOoW,EAASG,GAEZvW,IAASqW,EAAb,CAIA,GAAIrW,IAASsW,EAAS,KAEtB,IAAItW,EAAO2W,EAAKtjB,OACRmkB,IAASnB,GACTkB,EAASvX,EAAMwX,OAGlB,CACD,GAAIxX,IAAS2W,EAAKtjB,OAAQ,KAAM,IAAIqiB,OAAM,oBAC1C6B,GAASC,EAAMA,GAInB,IADA,GAAMK,GAAUlB,EAAK3W,GAAM3M,OACpBwjB,EAAegB,EAAUnB,EAAOrjB,QAAQ2jB,GAC/CN,GAAOS,IAAIR,EAAK3W,GAAO6W,GACvBA,GAAgBgB,EAEZlB,EAAKtjB,SAAY,GAAKkjB,GAAaA,EAAW,IAE9CA,QAtBAO,IA4BR,OAAOJ,GAAOkB,SAAS,EAAGf,IAGxBiB,EAAW,SAACjK,EAAGjJ,GACjB8P,EAAU1c,MAAQ6V,EAClB6G,EAAUvc,OAASyM,EACnB8P,EAAU9f,MAAMoD,MAAQ6V,EAAI,KAC5B6G,EAAU9f,MAAMuD,OAASyM,EAAI,KAC7B8P,EAAU3b,WAAW,MAAMgf,aAAa,EAAG,EAAG,EAAG,EAAG,EAAG,GACvDpD,EAAa3c,MAAQ6V,EACrB8G,EAAaxc,OAAS0V,GAGpBiJ,EAAQ,WACVhC,EAAe,KACfvS,EAAQ,KACRsS,EAAqBE,EACrBA,EAAiB,KACjBH,EAAQ,MAGNoD,EAAQ,SAAAC,GACVxD,EAAMwD,EACNH,EAASrD,EAAIzc,MAAOyc,EAAItc,SAGtB+f,EAAQ,SAAAC,GACVC,IACAtB,IACAhC,EAAeqD,EAAIE,kBAAoBF,EAAIG,kBAAoB,KAC/D/V,EAAQ4V,EAAII,UACZxD,EAAiBoD,EAAIpD,gBAInBqD,EAAY,WACd,GAAKxD,EAAL,CACA,GAAI4D,GAAU9D,EAAUnb,UAAU,aAC9BC,EAAO5B,EAAK8B,cAAc8e,EAC9B9O,GAAO6L,MAEH5b,QAASH,EAAOI,IAAIC,gBAAgBL,GAAQgf,EAC5CjW,MAAOrJ,KAAK2M,IAAItD,EAAO,QAIzBkW,EAAQ,SAAA1e,GACL6a,IAAOA,EAAQF,EAAU3b,WAAW,MAEzC,IAAM2f,GAAUhP,EAAOrW,OAGjBslB,EAAK5e,EAAI6e,QAAU7e,EAAI8e,IAAMpE,EAAIqE,GAEnCJ,GAAU,IACiB,IAAvB7D,EAI+B,OAA3BG,EACGtL,EAAOsL,GAAwBjiB,MAAM6hB,EAAMmE,aAAarP,EAAOsL,GAAwBjiB,KAAM,EAAG,GAEnG6hB,EAAMpO,UAAUyO,EAAQ+D,QAAS/D,EAAQgE,OAAQhE,EAAQjd,MAAOid,EAAQ9c,QAG5E6c,EAAyB0D,EAAU,EAGZ,IAAvB7D,GAIAD,EAAMpO,UAAUyO,EAAQ+D,QAAS/D,EAAQgE,OAAQhE,EAAQjd,MAAOid,EAAQ9c,QAUhF,KAAK,GAHC+gB,GAAUtE,EAAMuE,aAAapf,EAAIif,QAASjf,EAAIkf,OAAQlf,EAAI/B,MAAO+B,EAAI5B,QAGlEM,EAAI,EAAGA,EAAIsB,EAAIqf,OAAO/lB,OAAQoF,IAAK,CACxC,GAAM4gB,GAAQtf,EAAIqf,OAAO3gB,EAEzB,IAAI4gB,IAAUvE,EAAc,CACxB,GAAMwE,GAAMX,EAAGU,GACTE,EAAU,EAAJ9gB,CACZygB,GAAQnmB,KAAKwmB,GAAOD,EAAI,GACxBJ,EAAQnmB,KAAKwmB,EAAM,GAAKD,EAAI,GAC5BJ,EAAQnmB,KAAKwmB,EAAM,GAAKD,EAAI,GAC5BJ,EAAQnmB,KAAKwmB,EAAM,GAAK,KAIhC3E,EAAMmE,aAAaG,EAASnf,EAAIif,QAASjf,EAAIkf,QAE7ChE,EAAUlb,GAGRyf,EAAY,aAGZC,EAAa,SAAAC,GACf/P,EAAY+P,EAAMC,YAGhBC,GACFnF,IAAKuD,EACLG,IAAKD,EACL2B,IAAKL,EAELM,KAEIC,SAAUN,GAEd1f,IAAK0e,EACLuB,IAAK,WAED5B,MAIF6B,EAAW,SAACC,EAAIN,GAClBA,IAAYA,KAGZ,IAAMO,GAAU,SAAUC,GAEtB,IAAK,GADCzB,MACGlgB,EAAI,EAAGA,EAAI2hB,EAAS3hB,IACzBkgB,EAAGpD,KAAK2E,EAAGvE,UAAU,GAEzB,OAAOgD,IAGL0B,EAAgB,WAClB,GAAIviB,GAAAA,OAAM/E,EAAAA,OAAMunB,EAAS,EACnBC,EAAU,IAChBxnB,GAAO,GAAIkW,YAAWsR,EAEtB,IAAMC,GAAe,WACjB,GAAMC,GAAU,GAAIxR,YAAWlW,EAAKM,OAASknB,EAC7CE,GAAQtD,IAAIpkB,GACZA,EAAO0nB,EAGX,GAAG,CAIC,IAHA3iB,EAAOoiB,EAAGzE,WAGH6E,EAASxiB,EAAO/E,EAAKM,QAAQmnB,GACpCznB,GAAKokB,IAAI+C,EAAGvE,UAAU7d,GAAOwiB,GAC7BA,GAAUxiB,QACI,IAATA,EACT,OAAO/E,GAAK6kB,SAAS,EAAG0C,IAGtBI,EAAc,WAChB,GAAMjG,KAGN,IAFAA,EAAIkG,IAAMT,EAAGrE,KAAK,GAClBpB,EAAImG,IAAMV,EAAGrE,KAAK,GACF,QAAZpB,EAAIkG,IAAe,KAAM,IAAIjF,OAAM,kBACvCjB,GAAIzc,MAAQkiB,EAAGlE,eACfvB,EAAItc,OAAS+hB,EAAGlE,cAEhB,IAAM6E,GAAOxF,EAAa6E,EAAGzE,WAC7BhB,GAAIqG,QAAUD,EAAK1G,QACnBM,EAAIsG,SAAW7F,EAAU2F,EAAK9J,OAAO,EAAG,IACxC0D,EAAIuG,OAASH,EAAK1G,QAClBM,EAAIwG,QAAU/F,EAAU2F,EAAK9J,OAAO,EAAG,IAEvC0D,EAAIyG,QAAUhB,EAAGzE,WACjBhB,EAAI0G,iBAAmBjB,EAAGzE,WACtBhB,EAAIqG,UACJrG,EAAIqE,IAAMqB,EAAQ,GAAM1F,EAAIwG,QAAU,IAE1CrB,EAAQnF,KAAOmF,EAAQnF,IAAIA,IAGzB2G,EAAW,SAAU1B,GACvB,GAAM2B,GAAa,SAAU3B,GACzB,GACMmB,IADYX,EAAGzE,WACRJ,EAAa6E,EAAGzE,YAC7BiE,GAAM4B,SAAWT,EAAK9J,OAAO,EAAG,GAChC2I,EAAM3E,eAAiBG,EAAU2F,EAAK9J,OAAO,EAAG,IAChD2I,EAAM6B,UAAYV,EAAK1G,QACvBuF,EAAMrB,kBAAoBwC,EAAK1G,QAE/BuF,EAAMnB,UAAY2B,EAAGlE,eAErB0D,EAAMpB,kBAAoB4B,EAAGzE,WAE7BiE,EAAMtR,WAAa8R,EAAGzE,WAEtBmE,EAAQzB,KAAOyB,EAAQzB,IAAIuB,IAGzB8B,EAAc,SAAU9B,GAC1BA,EAAM+B,QAAUpB,IAChBT,EAAQC,KAAOD,EAAQC,IAAIH,IAGzBgC,EAAa,SAAUhC,GAEPQ,EAAGzE,UACrBiE,GAAMiC,SAAWzB,EAAGvE,UAAU,IAC9B+D,EAAMkC,OAASvB,IACfT,EAAQiC,KAAOjC,EAAQiC,IAAInC,IAGzBoC,EAAc,SAAUpC,GAC1B,GAAMqC,GAAmB,SAAUrC,GACbQ,EAAGzE,UACrBiE,GAAMsC,QAAU9B,EAAGzE,WACnBiE,EAAMC,WAAaO,EAAGlE,eACtB0D,EAAMtR,WAAa8R,EAAGzE,WACtBmE,EAAQE,KAAOF,EAAQE,IAAIC,UAAYH,EAAQE,IAAIC,SAASL,IAG1DuC,EAAqB,SAAUvC,GACjCA,EAAMwC,QAAU7B,IAEhBT,EAAQE,KAAOF,EAAQE,IAAIJ,EAAMyC,aAAevC,EAAQE,IAAIJ,EAAMyC,YAAYzC,GAGhEQ,GAAGzE,UAGrB,QAFAiE,EAAMyC,WAAajC,EAAGrE,KAAK,GAC3B6D,EAAM0C,SAAWlC,EAAGrE,KAAK,GACjB6D,EAAMyC,YACV,IAAK,WACDJ,EAAiBrC,EACjB,MACJ,SACIuC,EAAmBvC,KAKzB2C,EAAkB,SAAU3C,GAC9BA,EAAM3mB,KAAOsnB,IACbT,EAAQoC,SAAWpC,EAAQoC,QAAQtC,GAIvC,QADAA,EAAM4C,MAAQpC,EAAGzE,WACTiE,EAAM4C,OACV,IAAK,KACD5C,EAAM6C,QAAU,MAChBlB,EAAW3B,EACX,MACJ,KAAK,KACDA,EAAM6C,QAAU,MAChBf,EAAY9B,EACZ,MACJ,KAAK,GACDA,EAAM6C,QAAU,MAChBb,EAAWhC,EACX,MACJ,KAAK,KACDA,EAAM6C,QAAU,MAChBT,EAAYpC,EACZ,MACJ,SACIA,EAAM6C,QAAU,UAChBF,EAAgB3C,KAKtB8C,EAAW,SAAUziB,GACvB,GAAM0iB,GAAc,SAAUrD,EAAQphB,GAelC,IAAK,GAZD0kB,GAAY,GAAInX,OAAM6T,EAAO/lB,QAC7BspB,EAAOvD,EAAO/lB,OAAS2E,EACvB4kB,EAAQ,SAAUC,EAAOC,GAAS,GAAAC,GAC9BC,EAAa5D,EAAO/Q,MAAMyU,EAAU9kB,GAAQ8kB,EAAU,GAAK9kB,EAC/D0kB,GAAU3L,OAAOnC,MAAM8N,GAAWK,GAACF,EAAQ7kB,EAAOA,IAAOilB,OAAvBrO,MAAAmO,EAAAG,EAAiCF,MAInEG,GAAW,EAAG,EAAG,EAAG,GACpBC,GAAS,EAAG,EAAG,EAAG,GAElBN,EAAU,EACLO,EAAO,EAAGA,EAAO,EAAGA,IACzB,IAAK,GAAIR,GAAQM,EAAQE,GAAOR,EAAQF,EAAME,GAASO,EAAMC,GACzDT,EAAMC,EAAOC,GACbA,GAIR,OAAOJ,GAGX3iB,GAAIif,QAAUkB,EAAGlE,eACjBjc,EAAIkf,OAASiB,EAAGlE,eAChBjc,EAAI/B,MAAQkiB,EAAGlE,eACfjc,EAAI5B,OAAS+hB,EAAGlE,cAEhB,IAAI6E,GAAOxF,EAAa6E,EAAGzE,WAC3B1b,GAAI6e,QAAUiC,EAAK1G,QACnBpa,EAAIujB,WAAazC,EAAK1G,QACtBpa,EAAIihB,OAASH,EAAK1G,QAClBpa,EAAIuhB,SAAWT,EAAK9J,OAAO,EAAG,GAC9BhX,EAAIwjB,QAAUrI,EAAU2F,EAAK9J,OAAO,EAAG,IAEnChX,EAAI6e,UACJ7e,EAAI8e,IAAMsB,EAAQ,GAAMpgB,EAAIwjB,QAAU,IAG1CxjB,EAAIyjB,eAAiBtD,EAAGzE,UAExB,IAAIgI,GAAUpD,GAEdtgB,GAAIqf,OAASnD,EAAUlc,EAAIyjB,eAAgBC,GAEvC1jB,EAAIujB,aACJvjB,EAAIqf,OAASqD,EAAY1iB,EAAIqf,OAAQrf,EAAI/B,QAG7C4hB,EAAQ7f,KAAO6f,EAAQ7f,IAAIA,IAGzB2jB,EAAa,QAAbA,KACF,GAAIhE,KAGJ,QAFAA,EAAMiE,SAAWzD,EAAGzE,WAEZK,OAAOC,aAAa2D,EAAMiE,WAC9B,IAAK,IACDjE,EAAM1mB,KAAO,MACbooB,EAAS1B,EACT,MACJ,KAAK,IACDA,EAAM1mB,KAAO,MACbwpB,EAAS9C,EACT,MACJ,KAAK,IACDA,EAAM1mB,KAAO,MACb4mB,EAAQI,KAAOJ,EAAQI,IAAIN,EAC3B,MACJ,SACI,KAAM,IAAIhE,OAAM,oBAAsBgE,EAAMiE,SAASlhB,SAAS,KAGnD,QAAfid,EAAM1mB,KACNuD,WAAWmnB,EAAY,GAEvB7pB,GACI8V,UAAWA,EACXD,OAAQA,KAKd5K,EAAQ,WACV4b,IACAnkB,WAAWmnB,EAAY,GAG3B5e,KAGJ,KACI,GAAM/L,GAAO,GAAIkW,YAAWJ,GACtB+U,EAAS,GAAIpI,GAAOziB,EAC1BwD,YAAW0jB,EAAS2D,EAAQhE,GAAU,GAE1C,MAAOiE,GACH/pB,EAAO+pB,GACPxf,QAAQyf,MAAM,mBAAqBD,uCAK/B9qB,GACZ,MAAiD,oBAA1Coc,OAAOb,UAAU7R,SAASmS,MAAM7b,yCAGtBsD,GACjB,GAAM0nB,GAAY1nB,EAAM2nB,MAAM,2DACxBC,EAAQ,SAAAzL,GACV,GAAM0L,GAAM5d,SAASkS,EAAO,IAAI/V,SAAS,GACzC,OAAmB,KAAfyhB,EAAI7qB,OACG,IAAM6qB,EAENA,EAIf,OAAIH,GACA1nB,EAAQ,IAAM4nB,EAAMF,EAAU,IAAME,EAAMF,EAAU,IAAME,EAAMF,EAAU,KAI1E1nB,GAAsB,MAAbA,EAAM,KACfA,EAAQ,IAAMA,GAGd8nB,MAAM7d,SAASjK,EAAMgS,MAAM,GAAI,OAC/BhS,EAAQ,WAGLA,EAAQA,EAAQ,6CAGF,GAAV+nB,GAAUhrB,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAH,EACdirB,EAAS,KACPC,EAAU,GAAI1qB,SAAQ,SAACC,EAASC,GAAV,MAAqBuqB,GAAS9nB,WAAW1C,EAASuqB,IAE9E,OADAE,GAAQlqB,OAAS,WAAA,MAAM6Y,cAAaoR,IAC7BC,0CAGY,GAAA1b,GAAA5Q,IACnB,IAAG+C,UAAUuf,QAA+B,MAArBvf,UAAUmM,QAG7B,MAFAlP,MAAKusB,UAAYvsB,KAAKwsB,eACtBxsB,KAAKysB,WAAa,EACX7qB,QAAQC,QAAQ7B,KAAKysB,WAEhC,IAAI/lB,GAAM,6EACV,OAAOkQ,GAAI8V,iBAAiBhmB,GAAKwC,KAAK,SAAAgD,GAClC,GAA+B,IAA3BA,EAAGU,aAAavL,OAChB,MAAOO,SAAQE,OAAO,oCAE1B,IAAI+K,GAAUjB,KAAKkB,MAAMZ,EAAGU,aAC5B,OAAuB,KAAnBC,EAAQE,QACR6D,EAAK2b,UAAY1f,EAAQ9L,KAAK4rB,UAC9B/b,EAAK6b,WAAa7b,EAAK2b,UAAY3b,EAAK4b,eACjC5qB,QAAQC,QAAQ+O,EAAK6b,aAGrB7qB,QAAQE,OAAO+K,EAAQ1D,IAAM,KAAO0D,EAAQE,SAExD,SAAAZ,GACC,MAAOvK,SAAQE,OAAOqK,+CAQvB4V,EAAM6K,iBAAkB7K,EAAM6K,UAAY5sB,KAAKwsB,gBAClDK,YAAY,WACR9K,EAAM6K,aACR,4CAMF,MAAO1lB,MAAK4lB,OAAO,GAAIC,OAAQC,UAAY,qDAGhB7iB,GAC3B,QAAWnK,KAAKusB,UAAhB,CAEApiB,EAAQ8iB,aAAa,GAAGzM,MAAQuB,EAAM6K,UAAY5sB,KAAKysB,UACvD,IAAIS,GAAO,GAAIH,MAAqC,IAAhC5iB,EAAQ8iB,aAAa,GAAGzM,MAC5CrW,GAAQ8iB,aAAa,GAAGzM,MAAQ0M,EAAKC,cACrChjB,EAAQ8iB,aAAa,GAAGzM,MAAQ0M,EAAKE,WAAa,EAClDjjB,EAAQ8iB,aAAa,GAAGzM,MAAQ0M,EAAKG,UACrCljB,EAAQ8iB,aAAa,GAAGzM,MAAQ0M,EAAKI,WACrCnjB,EAAQ8iB,aAAa,GAAGzM,MAAQ0M,EAAKK,aACrCpjB,EAAQ8iB,aAAa,GAAGzM,MAAQ0M,EAAKM,aACrCrjB,EAAQ8iB,aAAa,IAAIzM,MAAQ0M,EAAKO,qDAGhBd,GACtB,GAAIO,GAAO,GAAIH,MAAKJ,GAChBe,EAAa,IACbC,EAAa,IACbC,EAAQ,SAASpN,EAAO3M,EAAKga,GAC7B,MAAIrN,IAASqN,GAAOrN,GAAS3M,EACjB,IAAM2M,EAGN,GAAKA,GAGjBsN,EAAcZ,EAAKC,cACjBO,EAAaE,EAAMV,EAAKE,WAAa,EAAG,EAAG,GAC3CM,EAAaE,EAAMV,EAAKG,UAAW,EAAG,GACtC,IAAMO,EAAMV,EAAKI,WAAY,EAAG,GAChCK,EAAaC,EAAMV,EAAKK,aAAc,EAAG,GACzCI,EAAaC,EAAMV,EAAKM,aAAc,EAAG,EAC/C,OAAOM,sCAGO5L,EAAOlhB,GACrB,GAAI+sB,GAAAA,OAAaC,EAAAA,MACjB,KACI,MAAO,IAAItS,OAAMwG,IACnB,MAAOhU,GAKL,GAJA6f,EAAcvyB,OAAOuyB,aACjBvyB,OAAOyyB,mBACPzyB,OAAO0yB,gBACP1yB,OAAO2yB,cAIP,MAFAH,GAAK,GAAID,GACTC,EAAGI,OAAOlM,GACH8L,EAAGK,QAAQrtB,EAElB,MAAM,IAAI0iB,OAAM,gEAKP8C,GAGjB,IAFA,GAAI8H,GAAM9H,EAAQnU,MAAM,KAAMkc,EAAOD,EAAI,GAAGtC,MAAM,WAAW,GACzDwC,EAAOC,KAAKH,EAAI,IAAKjnB,EAAImnB,EAAKntB,OAAQqtB,EAAQ,GAAIzX,YAAW5P,GAC3DA,KACFqnB,EAAMrnB,GAAKmnB,EAAKjmB,WAAWlB,EAE/B,IAAIsnB,GAAU,IACd,KACIA,EAAU,GAAIjT,OAAMgT,IAAS1tB,KAAKutB,IACpC,MAAO1C,GACLxf,QAAQyf,MAAMD,EAAIjsB,KAAO,KAAOisB,EAAI5d,SAExC,MAAO0gB,wCAGSxlB,GAChB,MAAY,KAARA,EAAmB,GAChByY,EAAAgN,OAAOC,OAAO1lB,yCAGJA,GACjB,MAAY,KAARA,EAAmB,GAChByY,EAAAgN,OAAOE,OAAO3lB,sCAGPA,EAAKnI,GAEnB,GAAY,KAARmI,EAAY,MAAO,EACvB,IAAI4lB,GAAS,mBACTC,EAAS,kBACA,KAAThuB,GACA+tB,EAAS,mBACTC,EAAS,oBAEK,IAAThuB,GAEL+tB,EAAS,mBACTC,EAAS,oBAEK,IAAThuB,IAEL+tB,EAAS,mBACTC,EAAS,mBAGb,IAAItgB,GAAMugB,EAAAA,WAASC,IAAIC,KAAKriB,MAAMiiB,GAE9BK,EAAMH,EAAAA,WAASC,IAAIC,KAAKriB,MAAMkiB,GAE9BK,EAAYJ,EAAAA,WAASK,IAAIC,QAAQpmB,EAAI,GAAIuF,GAAM8gB,GAAIJ,EAAKK,KAAMR,EAAAA,WAASQ,KAAKC,IAAK5c,QAASmc,EAAAA,WAASU,IAAIC,cAEvGC,EAAQR,EAAU5kB,UACtB,OAAOolB,sCAGO1mB,EAAKnI,GAEnB,GAAY,KAARmI,EAAY,MAAO,EACvB,IAAI4lB,GAAS,mBACTC,EAAS,kBACA,KAAThuB,GACA+tB,EAAS,mBACTC,EAAS,oBAEK,IAAThuB,GAEL+tB,EAAS,mBACTC,EAAS,oBACK,IAAThuB,IAEL+tB,EAAS,mBACTC,EAAS,GAGb,IAAItgB,GAAMugB,EAAAA,WAASC,IAAIC,KAAKriB,MAAMiiB,GAE9BK,EAAMH,EAAAA,WAASC,IAAIC,KAAKriB,MAAMkiB,GAE9Bc,EAAYb,EAAAA,WAASK,IAAIS,QAAQ5mB,EAAKuF,GAAM8gB,GAAIJ,EAAKK,KAAe,IAATzuB,EAAaiuB,EAAAA,WAASQ,KAAKC,IAAMT,EAAAA,WAASQ,KAAKO,IAAKld,QAASmc,EAAAA,WAASU,IAAIC,cACrIK,EAAQH,EAAUrlB,SAASwkB,EAAAA,WAASC,IAAIC,KAC5C,OAAOc,qCAGMrwB,GACb,GAAI0uB,GAAAA,OAAIrY,EAAM,GAAIE,QAAO,QAAQvW,EAAK,gBACtC,QAAG0uB,EAAMtsB,SAASkuB,OAAOlE,MAAM/V,IACpBka,UAAU7B,EAAI,IAEd,8CAIX,GAAIrhB,GAAMjN,KAAKowB,UAAU,UACzB,IAAInjB,EAAK,CACL,GAAI7H,GAAQ6H,EAAImN,QAAQ,IACxBnN,GAAMA,EAAIuJ,UAAU,EAAGpR,GAE3B,MAAO6H,GAAMA,EAAM,0CAInB,GAAIjB,IAAI,GAAI+gB,OAAOC,UACfzhB,EAAO,uCAAuCkL,QAAQ,QAAS,SAAS5P,GACxE,GAAIqO,IAAKlJ,EAAkB,GAAd9E,KAAK+I,UAAa,GAAK,CAEpC,OADAjE,GAAI9E,KAAK4lB,MAAM9gB,EAAE,KACN,KAAHnF,EAASqO,EAAO,EAAFA,EAAM,GAAMzK,SAAS,KAE/C,OAAOc,+CAGgBmD,GACvB,GAAI3L,UAAUstB,YAAc,QACxB,MAAO70B,QAAO80B,aAAaC,QAAQ7hB,EAEvC,IAAyB,YAArB3L,UAAU+L,QAAwBtT,OAAOssB,IAAK,CAC9C,GAAM0I,GAAWh1B,OAAOssB,IAAI2I,qBAAqB/hB,EACjD,OAAqB,KAAb8hB,EAAkB,KAAOA,EAEhC,GAAyB,QAArBztB,UAAU+L,OAAkB,CACjC,GAAI4hB,GAAc,IAUlB,OAPIA,GADqB,MAAtB3tB,UAAUmM,QACKuhB,qBAAqB/hB,GAErBlT,OAAO80B,aAAaC,QAAQ7hB,GAG1B,KAAhBgiB,IAAoBA,EAAc,MAE/BA,EAEN,MAAyB,KAArB3tB,UAAU+L,OACRtT,OAAO80B,aAAaC,QAAQ7hB,GAGhC,iDAGgBA,EAAK8R,GAC5B,GAAIzd,UAAUstB,YAAc,QAKxB,WAJA70B,QAAO80B,aAAaK,QAAQjiB,EAAK8R,EAMrC,IAAyB,YAArBzd,UAAU+L,OACVtT,OAAOssB,KAAOtsB,OAAOssB,IAAI8I,qBAAqBliB,EAAK8R,OAElD,IAAyB,QAArBzd,UAAU+L,OAAkB,CACjC,GAAM+hB,IAAOniB,IAAKA,EAAK8R,MAAOA,EACL,OAAtBzd,UAAUmM,QACT0hB,qBAAqBhlB,KAAKC,UAAUglB,KAEpCr1B,OAAO4T,QAAU5T,OAAO4T,OAAOC,gBAAgBuhB,qBAAqBthB,YAAY1D,KAAKC,UAAUglB,IAC/Fr1B,OAAO80B,aAAaK,QAAQjiB,EAAK8R,QAIrChlB,QAAO80B,aAAaK,QAAQjiB,EAAK8R,kDAIX9R,GAC1B,MAAI3L,WAAUstB,YAAc,YACxB70B,QAAO80B,aAAaQ,WAAWpiB,QAGV,YAArB3L,UAAU+L,OACVtT,OAAOssB,KAAOtsB,OAAOssB,IAAIiJ,mBAAmBriB,GAElB,QAArB3L,UAAU+L,OACU,MAAtB/L,UAAUmM,QACT6hB,mBAAmBriB,IAEnBlT,OAAO4T,QAAU5T,OAAO4T,OAAOC,gBAAgB0hB,mBAAmBzhB,YAAYZ,GAC9ElT,OAAO80B,aAAaQ,WAAWpiB,IAInClT,OAAO80B,aAAaQ,WAAWpiB,gDAKnClT,OAAO80B,aAAaxL,oDAGG,GAAAjU,GAAA7Q,KACnB0G,EAAM,oEACN3F,EAAO,YACX,OAAO6V,GAAI3K,QAAQvF,EAAK3F,GAAMmI,KAAK,SAAAgD,GAC/B,GAA+B,IAA3BA,EAAGU,aAAavL,OAChB,MAAOO,SAAQE,OAAO,6CAE1B,IAAI+K,GAAUjB,KAAKkB,MAAMZ,EAAGU,aAC5B,IAAoB,KAAhBC,EAAQmB,KAAa,CACrB,GAAqD,kBAAlDmP,OAAOb,UAAU7R,SAASumB,KAAKnkB,EAAQokB,QACtCpgB,EAAKqgB,eAAiBrkB,EAAQokB,OAAOhG,aACpC,CACD,GAAMlqB,GAAO6K,KAAKkB,MAAMiV,EAAMoP,WAAWtkB,EAAQokB,OAAO,GACxDpgB,GAAKqgB,eAAiBnwB,EAAKkqB,SAE/B,MAAOrpB,SAAQC,UAGf,MAAOD,SAAQE,UAEpB,SAAAqK,GACC,MAAOvK,SAAQE,OAAOqK,2CAK1B,GAAyB,YAArBpJ,UAAU+L,OAAsB,CAChC,GAAIvD,GAAO+I,UAAU+G,UAAU2Q,MAAM,+EACrC,OAAOzgB,GAAOA,EAAK,GAAK,GAEvB,GAAyB,QAArBxI,UAAU+L,OAAkB,CACjC,GAAIvD,GAAO+I,UAAU+G,UAAU2Q,MAAM,mBACrC,OAAOzgB,GAAOA,EAAK,GAAK,GAE5B,MAAO,qCAGMlE,GACb,MAAI,KAAMA,EAAU,QACXA,EAAI,GAAY,OAASA,EACzBA,EAAI,IAAa,MAAQA,EACrB,KAAOA,2CAIpB,GAAyB,YAArBtE,UAAU+L,QAA6C,QAArB/L,UAAU+L,OAC5C,MAAOlN,SAAQC,SAGnB,IAAIuvB,GAAWpxB,KAAKqxB,cAChBC,EAAQpqB,KAAK4lB,OAAO,GAAIC,OAAQC,UAAY,KAAQhtB,KAAKysB,WACzD8E,EAAQ,YAAcH,EAAW,SAAWE,EAAQ,QAAUvuB,UAAUkK,IAAM,kCAClFskB,GAAQvxB,KAAKwxB,WAAWjnB,EAAAA,WAAIC,KAAKD,EAAAA,WAAIC,KAAK+mB,IAAS,GACnDD,EAAQtxB,KAAKwxB,WAAWF,EAAO,EAE/B,IAAI5qB,GAAM,uDAAyD3D,UAAU4M,EAAI,WAAa5M,UAAU+L,OACpG/N,EAAO,YAAc0wB,mBAAmBzxB,KAAKwxB,WAAWJ,EAAU,IAAM,QAAUK,mBAAmBzxB,KAAKwxB,WAAWzuB,UAAUkK,IAAK,IAClI,SAAWwkB,mBAAmBF,GAAS,SAAWE,mBAAmBH,EAC3E,OAAO1a,GAAI3K,QAAQvF,EAAK3F,4CAGJ,GAAAuY,GAAAtZ,KACd0xB,EAAS,WACX,GAA+B,IAA3BpY,EAAKqY,WAAWtwB,OAEhB,MADAkD,YAAWqtB,IAAgB,KACpBhwB,QAAQC,SAGnB,IAAI6E,GAAM,gEACN3F,EAAO,gBAAkBgC,UAAUwI,KAAO,aAAeK,KAAKC,UAAUyN,EAAKqY,WACjF,OAAO/a,GAAImB,QAAQrR,EAAM3F,EAAM,IAAImI,KAAK,WAGpC,MAFAoQ,GAAKqY,WAAW5S,OAAO,EAAGzF,EAAKqY,WAAWtwB,QAC1CkD,WAAWqtB,IAAgB,KACpBhwB,QAAQC,WAChB,WAEC,MADA0C,YAAWqtB,IAAgB,KACpBhwB,QAAQE,YAGjB8vB,EAAe,WACjB,MAAO,YACHF,KAGRntB,YAAWqtB,IAAgB,iDAGJle,EAAMnI,GAe7B,IAAK,GAdCsmB,GAAgB,QAAhBA,GAAiBC,GACnB,GAAIA,EAAQvmB,OAASA,EACjB,MAAOumB,EAGX,KAAK,GAAIrrB,GAAI,EAAGA,EAAIqrB,EAAQC,YAAY1wB,SAAUoF,EAAG,CACjD,GAAMwqB,GAASY,EAAcC,EAAQC,YAAYtrB,GACjD,IAAIwqB,EACA,MAAOA,KAKfA,EAAS,KACJxqB,EAAI,EAAGA,EAAIiN,EAAKse,SAAS3wB,SAAUoF,EAExC,GADAwqB,EAASY,EAAcne,EAAKse,SAASvrB,IAEjC,MAAOwqB,EAGf,OAAOA,yBAxgCMlP,EAirCrBA,EAAMwK,aACNxK,EAAM0K,WAAa,EACnB1K,EAAMmP,kBACNnP,EAAM4P,cACN5P,EAAMkQ,YAAc,EACpBlQ,EAAMmQ,YAAc,EACpBnQ,EAAM6K,gBAEAuF,cACF,QAAAA,KAAaC,EAAApyB,KAAAmyB,GACTnyB,KAAKqyB,WACLryB,KAAKsyB,sDAIL,GAAMltB,GAAQpF,KAAKqyB,QAAQE,UAAU,SAAA1rB,GAAA,MAAiD,KAA5C2rB,EAAiBC,SAAS,MAAO5rB,EAAE6H,MAC7E,KAAKtJ,EAAO,CAAA,GACAsJ,GAAQ1O,KAAKqyB,QAAQjtB,GAArBsJ,GACR1O,MAAKqyB,QAAQtT,OAAO3Z,EAAO,GAC3BotB,EAAiBvU,gBAAgB,MAAOvP,GAAK,qCAKjD,GAAMtJ,GAAQpF,KAAKsyB,QAAQC,UAAU,SAAA1rB,GAAA,MAAiD,KAA5C2rB,EAAiBC,SAAS,MAAO5rB,EAAE6H,MAC7E,KAAKtJ,EAAO,CAAA,GACAsJ,GAAQ1O,KAAKsyB,QAAQltB,GAArBsJ,GACR1O,MAAKsyB,QAAQvT,OAAO3Z,EAAO,GAC3BotB,EAAiBvU,gBAAgB,MAAOvP,GAAK,iCAIhDA,EAAKwI,GACFA,GACAlX,KAAKqyB,QAAQ9O,MAAO7U,IAAAA,EAAKie,UAAWI,KAAK2F,QACzCF,EAAiBG,YAAY,MAAOjkB,EAAK,SACrC1O,KAAKqyB,QAAQhxB,OAAS,IACtBrB,KAAK4yB,WAGT5yB,KAAKsyB,QAAQ/O,MAAO7U,IAAAA,EAAKie,UAAWI,KAAK2F,QACzCF,EAAiBG,YAAY,MAAOjkB,EAAK,SACrC1O,KAAKsyB,QAAQjxB,OAAS,KACtBrB,KAAK6yB,mBAORL,IAAAA,uGACW9rB,EAAK1F,EAAM0N,EAAKokB,GAAQ,GAAA3Y,GAAAna,KAClC+yB,EAAOrkB,GAAOhI,CACpB,SAAK,QAAU1F,GAAQhB,KAAKwZ,MAAM6E,cAAc0U,IACxC,UAAY/xB,GAAQhB,KAAKwZ,MAAM2E,cAAc4U,KAC/C,QAAUhwB,UAAU+L,QAAU,UAAY9N,GAAQ+B,UAAUstB,aAAe,QAG1EtO,EAAMiR,qCAAqCtsB,GAAKwC,KAAK,SAAAxC,GACxD,IAAKA,EACD,OAAO,CAEX,IAAMusB,IAAa9Y,EAAK7I,KAAKwM,SAAS,QAAU9c,EAAO,QAAU,QAAS+xB,EAC1E,IAAI,QAAU/xB,EACViyB,GAAa9Y,EAAK7I,KAAK4hB,MAAMH,EAAMrsB,IAClCosB,GAAU3Y,EAAKwY,YAAY,MAAOI,EAAM,cACtC,IAAI,UAAY/xB,EAAM,CACzB,GAAImyB,GAAchZ,EAAKiZ,YAAYC,QAAUN,GAAQ5Y,EAAKiZ,YAAYE,OAAOriB,KAAK,SAAAC,GAAA,MAAKA,KAAM6hB,GAC7F,IAAI,QAAUhwB,UAAU+L,QAAU/L,UAAUstB,aAAe,QAAS,CAChE,GAAMkD,IAAWC,EAAAA,WAAWC,eAAeV,KAAUS,EAAAA,WAAWE,eAAeX,EAI/E,OAHIQ,IACAC,EAAAA,WAAWrkB,aAAa4jB,EAAMrsB,EAAK3D,UAAUmM,SAE1CqkB,EAEPN,GAAa9Y,EAAK7I,KAAKwJ,MAAMiY,EAAMrsB,EAAKysB,IAE3CL,GAAU3Y,EAAKwY,YAAY,QAASI,EAAM,UAE/C,MAAOE,IACR,SAAA/kB,GAAA,MAAK7B,SAAQyf,MAAM,gBAAkB5d,KAxB7BtM,QAAQC,SAAQ,0CA2BT8xB,GAAK,GAAAzW,GAAAld,IACvBmd,QAAOC,KAAKpd,KAAK4zB,SAAS9Y,OAAOuC,QAAQ,SAAA3O,GAAA,MAAOilB,IAAOA,EAAI,QAASjlB,EAAKwO,EAAKuV,SAAS,QAAS/jB,MAChGyO,OAAOC,KAAKpd,KAAK4zB,SAAS7rB,KAAKsV,QAAQ,SAAA3O,GAAA,MAAOilB,IAAOA,EAAI,MAAOjlB,EAAKwO,EAAKuV,SAAS,MAAO/jB,6CAG3D,GAAfmlB,GAAezyB,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,OAC9BpB,KAAK4zB,SAAS7rB,IAAK/H,KAAK4zB,SAAS9Y,OAAOuC,QAAQ,SAACtP,EAAKtH,GACnD0W,OAAOC,KAAKrP,GAAKsP,QAAQ,SAAA3O,GACrB,GAAMolB,GAAU/lB,EAAIW,GADQqlB,EAEED,EAAtBE,OAAAA,EAFoB1yB,SAAAyyB,EAEb,EAFaA,EAAAE,EAEEH,EAAZta,MAAAA,EAFUlY,SAAA2yB,EAEJ,EAFIA,EAGtBC,GAAYF,OAAAA,EAAQxa,MAAAA,GACpB4D,EAAOD,OAAOC,KAAKrP,EAAIW,GAC7BmlB,GAAWxW,QAAQ,SAAA3O,GAAA,MAAO0O,GAAKC,QAAQ,SAAAnM,GAAA,OAAMA,EAAEkJ,QAAQ1L,GAAOwlB,EAAQhjB,GAAK4iB,EAAQ5iB,GAAK,WACxFnD,EAAIW,GAAOwlB,kDAKIC,GAAoC,GAAAvW,GAAA5d,KAA5B+kB,IAA4B3jB,UAAAC,OAAA,GAAAC,SAAAF,UAAA,KAAAA,UAAA,GAAfyd,IAAezd,UAAAC,OAAA,GAAAC,SAAAF,UAAA,KAAAA,UAAA,IAC1DpB,KAAK4zB,SAAS7rB,IAAK/H,KAAK4zB,SAAS9Y,OAAOuC,QAAQ,SAACtP,EAAKtH,GACnD0W,OAAOC,KAAKrP,GAAKsP,QAAQ,SAAA3O,GACjBX,EAAIuP,eAAe5O,IAGvByO,OAAOC,KAAKrP,EAAIW,IAAM2O,QAAQ,SAAAnM,GAC1B,GAAIA,EAAEkjB,WAAWD,GAAS,CACtB,GAAMP,GAAW1iB,EAAEuF,QAAQ0d,EAAQ,GACnCpP,IAAQ6O,IAAa7lB,EAAIW,GAAKklB,IAAa7lB,EAAIW,GAAKklB,IAAa,IAAI7lB,EAAIW,GAAKwC,IAAM,UAC7EnD,GAAIW,GAAKwC,GAChB2N,GAAUjB,EAAKK,gBAAgBxX,EAAI,QAAU,MAAOiI,mDAOhD1N,EAAMqzB,EAAMC,EAAUC,EAAMC,GAChDx0B,KAAK4zB,SAAS5yB,GAAMuzB,GAAQv0B,KAAK4zB,SAAS5yB,GAAMuzB,OAChDv0B,KAAK4zB,SAAS5yB,GAAMuzB,GAAMC,GAAYx0B,KAAK4zB,SAAS5yB,GAAMuzB,GAAMC,IAAa,EACxEx0B,KAAK4zB,SAAS5yB,GAAMqzB,KAGzBr0B,KAAK4zB,SAAS5yB,GAAMuzB,GAAMC,IAAax0B,KAAK4zB,SAAS5yB,GAAMqzB,GAAMC,GACjEt0B,KAAK4zB,SAAS5yB,GAAMqzB,GAAMC,GAAY,EACtCt0B,KAAKie,gBAAgBjd,EAAMqzB,+CAGLC,EAAUE,IAC/Bx0B,KAAK4zB,SAAS7rB,IAAK/H,KAAK4zB,SAAS9Y,OAAOuC,QAAQ,SAAAtP,GAC7CoP,OAAOC,KAAKrP,GAAKsP,QAAQ,SAAA3O,GACrB,GAAMklB,GAAW7lB,EAAIW,EACrBklB,GAASY,IAAaZ,EAASY,IAAa,IAAIZ,EAASU,IAAa,SAC/DV,GAASU,0DAKMH,EAAQM,IACrCz0B,KAAK4zB,SAAS7rB,IAAK/H,KAAK4zB,SAAS9Y,OAAOuC,QAAQ,SAAAtP,GAC7CoP,OAAOC,KAAKrP,GAAKsP,QAAQ,SAAA3O,GACrB,GAAMklB,GAAW7lB,EAAIW,GACjBgmB,EAAQ,CACZvX,QAAOC,KAAKwW,GAAUvW,QAAQ,SAAAnM,GACtBA,EAAEkjB,WAAWD,KACbO,GAASd,EAAS1iB,SACX0iB,GAAS1iB,MAGxB0iB,EAASa,IAAYb,EAASa,IAAY,GAAKC,0CAKxC1zB,EAAM0N,GAA8B,GAAzB+lB,GAAyBrzB,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAjB,OAAQszB,EAAStzB,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAH,CAC3CJ,IAAS0N,IAGd1O,KAAKsR,KAAK0N,sBAAsBhe,EAAM0N,GACtC1O,KAAK4zB,SAAS5yB,GAAM0N,GAAO1O,KAAK4zB,SAAS5yB,GAAM0N,OAC/C1O,KAAK4zB,SAAS5yB,GAAM0N,GAAK+lB,IAAYz0B,KAAK4zB,SAAS5yB,GAAM0N,GAAK+lB,IAAY,GAAKC,uCAGhE1zB,EAAM0N,GAAqB,GAAhB+lB,GAAgBrzB,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAR,MAClC,IAAIpB,KAAK4zB,SAAS5yB,GAAM0N,GAAM,CAE1B,IAAK,GADC0O,GAAOD,OAAOC,KAAKpd,KAAK4zB,SAAS5yB,GAAM0N,IACpCjI,EAAI,EAAGA,EAAI2W,EAAK/b,OAAQoF,IAC7B,GAAI,yCAAyC6B,KAAK8U,EAAK3W,IACnD,MAGR,IAAMmtB,GAAW5zB,KAAK4zB,SAAS5yB,GAAM0N,EACrCklB,GAASa,IAAYb,EAASa,IAAY,GAAK,EAC/Cb,EAASa,GAAWb,EAASa,GAAW,EAAI,EAAIb,EAASa,GACzDz0B,KAAKie,gBAAgBjd,EAAM0N,OAEtB,UAAY1N,GAAQ,QAAU+B,UAAU+L,QAAU,SAAW/L,UAAUstB,eAC1E3hB,GAAO8kB,EAAAA,WAAWpiB,eAAe1C,2CAIpB1N,EAAM0N,EAAK+lB,GAC9B,GAAIz0B,KAAK4zB,SAAS5yB,GAAM0N,GAAM,CAC1B,GAAMklB,GAAW5zB,KAAK4zB,SAAS5yB,GAAM0N,EACrCklB,GAASa,GAAW,EACpBz0B,KAAKie,gBAAgBjd,EAAM0N,yCAIf+lB,GAAQ,GAAAE,GAAA30B,MACvBA,KAAK4zB,SAAS7rB,IAAK/H,KAAK4zB,SAAS9Y,OAAOuC,QAAQ,SAACtP,EAAKtH,GACnD0W,OAAOC,KAAKrP,GAAKsP,QAAQ,SAAA3O,SACdX,GAAIW,GACXimB,EAAK1W,gBAAgBxX,EAAI,QAAU,MAAOiI,wCAKtC1N,EAAM0N,GAAmB,GAAAkmB,GAAA50B,KAAdy0B,EAAcrzB,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAJ,EACjC,OAAOpB,MAAK4zB,SAAS5yB,GAAM0N,GACpB+lB,EAAWz0B,KAAK4zB,SAAS5yB,GAAM0N,GAAK+lB,IAAY,EAAKtX,OAAOC,KAAKpd,KAAK4zB,SAAS5yB,GAAM0N,IAAM0U,OAAO,SAACyR,EAAKC,GAAN,MAAcD,GAAMD,EAAKhB,SAAS5yB,GAAM0N,GAAKomB,IAAM,GACtJ,mCAGM9zB,EAAM0N,GAClB,MAAO1O,MAAK4zB,SAAS5yB,GAAM0N,GAApB,OAAqC,0CAGzB1N,EAAM0N,GAAoB,GAAfqmB,GAAe3zB,UAAAC,OAAA,GAAAC,SAAAF,UAAA,IAAAA,UAAA,EAC7C,IAAKpB,KAAK4zB,SAAS5yB,GAAM0N,MAIrB1O,KAAKyyB,SAASzxB,EAAM0N,IAASqmB,GAAjC,CAL6C,GAAAC,GASQh1B,KAAKi1B,YAAlD/wB,EATqC8wB,EASrC9wB,WAAYmvB,EATyB2B,EASzB3B,MAAOC,EATkB0B,EASlB1B,OAAQ4B,EATUF,EASVE,aACnC,IAAIhxB,IAAewK,GAAOwmB,IAAkBxmB,GAAO2kB,IAAU3kB,EAEzD,WADA1O,MAAK2yB,YAAY3xB,EAAM0N,EAG3B,KAAK,GAAIjI,GAAI,EAAGA,EAAI6sB,EAAOjyB,OAAQoF,IAC/B,GAAI6sB,EAAO7sB,KAAOiI,EAEd,WADA1O,MAAK2yB,YAAY3xB,EAAM0N,EAK/B,IAAa,UAAT1N,GAAoBhB,KAAKwZ,MAAO,CAChC,GAAI,QAAUzW,UAAU+L,QAAU/L,UAAUstB,aAAe,QACvDmD,EAAAA,WAAWpiB,eAAe1C,OAEzB,CACD,GAAM2K,GAAQrZ,KAAKwZ,MAAM+F,SAAS7Q,EAC9B2K,IAASA,EAAM8b,UAAY9b,EAAMtY,OACjCsY,EAAMtY,KAAKq0B,MAAO,GAElB/b,GAAS,SAAS/Q,KAAK+Q,EAAM3S,MAC7BkB,IAAI2P,gBAAgB8B,EAAM3S,KAE9B1G,KAAKwZ,MAAM2E,cAAczP,IAAQ1O,KAAKwZ,MAAM4E,YAAY1P,GACxD1O,KAAKsR,KAAKqM,gBAAgB3c,EAAM0N,GAEpC1O,KAAKq1B,aAAavvB,MAAQ,IAG9B,GAAa,QAAT9E,GAAkBhB,KAAKwZ,MAAO,CAC1B9K,EAAI0L,QAAQ,MAAQ,IACpB1L,EAAMA,EAAI4H,OAAO,EAAG5H,EAAI0L,QAAQ,MAEpC,IAAMC,GAAY3L,EAAI4H,QAAQpP,KAAK2M,IAAI,EAAGnF,EAAI4L,YAAY,OAASC,EAAAA,GAAY,GAAGE,aAClF,KAAKsa,EAID,MAHA/0B,MAAKs1B,mBAAmB/R,KAAK7U,EAAmB,QAAd2L,GAClCra,KAAKq1B,aAAavvB,MAAQ,QAC1B9F,MAAKu1B,uBAGT,IAAMrC,GAAQlzB,KAAKwZ,MAAMgc,SAAS9mB,GAAK,EACvC,IAAGwkB,EAAM,CAAA,GACGxb,GAAWwb,EAAMnyB,KAAjB2W,MACRA,IAAUA,EAAO2F,QAAQ,SAACuF,GACtBhb,IAAI2P,gBAAgBqL,EAAMjb,SAC1Bib,EAAMjb,QAAU,OAEpB,SAASW,KAAK4qB,EAAMxsB,MAAQkB,IAAI2P,gBAAgB2b,EAAMxsB,KACtD1G,KAAKwZ,MAAM6E,cAAc3P,IAAQ1O,KAAKwZ,MAAM8E,YAAY5P,GACxD1O,KAAKsR,KAAKqM,gBAAgB,QAASjP,GAEvC1O,KAAKq1B,aAAavvB,MAAQ,UAEvB9F,MAAK4zB,SAAS5yB,GAAM0N,GAC3B1O,KAAKu1B,yEAGsB,GAAAE,GAAAz1B,IAC3B,MAAIA,KAAKq1B,aAAatX,SAAW/d,KAAKq1B,aAAavvB,MAAQ,GAA3D,CAGA9F,KAAKq1B,aAAatX,SAAU,CAE5B,IAAM2X,GAAc,SAAAC,GAAsF,GAAnFxrB,GAAmFwrB,EAAnFxrB,QAAS2nB,EAA0E6D,EAA1E7D,QAAS8D,EAAiED,EAAjEC,OAAQC,EAAyDF,EAAzDE,QAASC,EAAgDH,EAAhDG,OAAQC,EAAwCJ,EAAxCI,YAAaC,EAA2BL,EAA3BK,eAAgBC,EAAWN,EAAXM,KAChFpvB,EAD2FqvB,EACrF/rB,KAGjB,OAFAtD,GAAEsvB,SAAFlL,OAAAC,EAAerkB,EAAEsvB,YACjBtvB,EAAEuvB,YAAFnL,OAAAC,EAAkBrkB,EAAEuvB,gBACXjsB,QAAStD,EAAGirB,QAAAA,EAAS8D,OAAAA,EAAQC,QAAAA,EAASC,OAAAA,EAAQC,YAAAA,EAAaC,eAAAA,EAAgBC,KAAAA,IAGlFI,EAAiB,SAACC,EAAMt1B,EAAMu1B,GAIhC,IAAI,GAHazE,IAA0DyE,EAAnEpsB,QAAmEosB,EAA1DzE,SAA0CiE,GAAgBQ,EAAjDX,OAAiDW,EAArCV,QAAqCU,EAA5BT,OAA4BS,EAAhBR,aACvDS,KACEC,EAAUH,EAAKt1B,OACbyF,EAAE,EAAGA,EAAGgwB,EAAQp1B,OAAQoF,IAAI,CAChC,GAAMiwB,GAASD,EAAQhwB,EACvB,IAAIiwB,EAAOC,MAAMt1B,OAAjB,CAGA,GAAIu1B,GAAOlB,EAAYa,EACvBK,GAAK9E,SAAW6E,MAAOD,EAAOC,MAAOprB,KAAMumB,EAAQvmB,MACnDqrB,EAAKhB,OAAS,CACd,IAAMiB,GAAa,YAAT71B,EAAqB,IAAuB,WAAhB01B,EAAO11B,MAAqBy0B,EAAKqB,yBAAyBJ,IAAW,GAAK,IAAM,GACtHE,GAAKb,aAA+B,SAAdA,EAAqB,GAAGA,GAA9C,IAA6DO,EAAK/qB,KAAOsrB,EAAIpwB,EAA7E,IACGiwB,EAAOC,MAAM,GAAGI,WACfH,EAAKf,SAAYkB,SAAUL,EAAOC,MAAM,GAAGI,UAC3CH,EAAKd,OAAS,GAElBU,EAAMjT,KAAKqT,IAEf,MAAOJ,IAGLQ,EAAoB,SAACC,EAAKV,GAI5B,IAAI,GAHkCV,IAAqCU,EAAnEpsB,QAAmEosB,EAA1DzE,QAA0DyE,EAAjDX,OAAiDW,EAArCV,SADDqB,EACsCX,EAA5BT,OAAAA,EADVx0B,SAAA41B,EACmB,EADnBA,EACsBnB,EAAgBQ,EAAhBR,YACvDS,KACEC,EAAUQ,EAAIE,KACZ1wB,EAAE,EAAGA,EAAGgwB,EAAQp1B,OAAQoF,IAAI,CAChC,GAAMiwB,GAASD,EAAQhwB,EACvB,IAAIiwB,EAAOK,SAAS11B,OAApB,CAGA,GAAIu1B,GAAOlB,EAAYa,EACvBK,GAAKf,SAAYkB,SAAUL,EAAOK,SAAUK,WAAYvB,EAASwB,eAAgBvB,GACjFc,EAAKd,OAAS,CACd,IAAIe,GAAiB,YAAbI,EAAIj2B,KAAqB,IAAuB,WAAhB01B,EAAO11B,MAAqBy0B,EAAKqB,yBAAyBJ,EAAQ,YAAc,GAAK,IAAM,GACnIE,GAAKb,aAA+B,SAAdA,EAAqB,GAAGA,GAA9C,IAA6DkB,EAAI1rB,KAAOsrB,EAAIpwB,EAA5E,IACA+vB,EAAMjT,KAAKqT,IAEf,MAAOJ,IAGLc,EAAoB,SAACf,IAClBA,EAAKV,SAAWU,EAAKzE,QAAQ6E,MAAMt1B,OAASk1B,EAAKX,QAAUW,EAAKzE,QAAQ6E,MAAMJ,EAAKX,QAAQmB,WAC5FR,EAAKV,SAAYkB,SAAUR,EAAKzE,QAAQ6E,MAAMJ,EAAKX,QAAQmB,UAC3DR,EAAKT,OAAS,IAIhByB,EAAa,SAAChB,EAAMv1B,EAAMD,GAC5Bw1B,EAAOb,EAAYa,EADkB,IAAAiB,GAEgCjB,EAA/DpsB,EAF+BqtB,EAE/BrtB,QAAS2nB,EAFsB0F,EAEtB1F,QAAS+D,EAFa2B,EAEb3B,QAASE,EAFIyB,EAEJzB,YAFI0B,EAAAD,EAES5B,OAAAA,EAFTt0B,SAAAm2B,EAEgB,EAFhBA,EAAAC,EAAAF,EAEmB1B,OAAAA,EAFnBx0B,SAAAo2B,EAE0B,EAF1BA,EAIjCd,EAAO,IACX,QAAO51B,GACH,IAAK,MACD41B,EAAOzsB,EAAQgsB,MAAM,GACrBhsB,EAAQgsB,MAAQhsB,EAAQgsB,MAAM9f,MAAM,GACpCkgB,EAAKzE,QAAUA,EAAQjyB,OAAO83B,SAC9BpB,EAAKX,OAAS9D,EAAQjyB,OAAO+3B,OAAS,EACtCrB,EAAKR,YAAc,OACnBQ,EAAKV,QAAU,KACZe,GAAsB,WAAdA,EAAK51B,OACZmJ,EAAQisB,SAAWjsB,EAAQisB,SAAS/f,MAAM,GAC1CkgB,EAAKV,QAAUe,EAAKf,QACpBU,EAAKT,OAASc,EAAKiB,SAAW,EAC9BtB,EAAKR,YAAca,EAAKb,aAAe,OACvCQ,EAAKX,UAET0B,EAAkBf,EAClB,MACJ,KAAK,OACL,IAAK,eACDpsB,EAAQ2tB,UAAa3B,SAAUC,YAAatE,QAAAA,EAAS+D,QAAAA,EAASD,OAAAA,EAAQE,OAAAA,EAAQC,YAAAA,GAC9E5rB,EAAQgsB,SACRhsB,EAAQisB,YACRG,EAAKV,QAAU,KACfU,EAAKzE,QAAU/P,EAAMgW,oBAAoBtC,EAAKuC,SAAUj3B,GACxDw1B,EAAKX,OAAS,EACdW,EAAKR,aAA+B,SAAdA,EAAqB,GAAGA,GAA9C,IAA6DQ,EAAKzE,QAAQvmB,KAA1E,IACA+rB,EAAkBf,EAClB,MACJ,KAAK,SACL,IAAK,iBACDpsB,EAAQ2tB,UAAa3B,MAAMhsB,EAAQgsB,MAAOC,SAASjsB,EAAQisB,SAAUtE,QAAAA,EAAS+D,QAAAA,EAASD,OAAAA,EAAQE,OAAAA,EAAQC,YAAAA,GACvG5rB,EAAQgsB,SACRhsB,EAAQisB,YACRG,EAAKV,QAAU,KACfU,EAAKzE,QAAU/P,EAAMgW,oBAAoBtC,EAAKuC,SAAUj3B,GACxDw1B,EAAKX,OAAS,EACdW,EAAKR,aAA+B,SAAdA,EAAqB,GAAGA,GAA9C,IAA6DQ,EAAKzE,QAAQvmB,KAA1E,IACA+rB,EAAkBf,EAClB,MACJ,KAAK,cACDA,EAAKV,QAAUA,GAAWA,EAAQuB,YAAc,KAChDb,EAAKT,QAAUD,GAAWA,EAAQwB,gBAAkB,GAAK,EACrDxB,EAAQuB,YACRb,EAAKR,YAAc,OACnB5rB,EAAQisB,SAAWjsB,EAAQisB,SAAS/f,MAAM,KAE1CkgB,EAAKV,QAAU,KACfU,EAAKX,SACL0B,EAAkBf,GAEtB,MACJ,KAAK,gBACDA,EAAKV,QAAU,KACfU,EAAKX,SACL0B,EAAkBf,GAG1B,MAAOA,IAGL0B,EAAoB,WAEtB,IAAK,GADCC,IAAgB,OAAQ,SAAU,OAAQ,UAAW,mBAAoB,WAAY,aAAc,YAAa,YAAa,WAC1H5kB,EAAI,EAAGtM,EAAMyuB,EAAK0C,WAAW92B,OAAQo0B,EAAK0C,YAAc7kB,EAAItM,EAAKsM,IACtE,IAAK,GAAI7M,GAAI,EAAGgvB,EAAK0C,WAAW7kB,IAAM7M,EAAIgvB,EAAK0C,WAAW7kB,GAAGjS,OAAQoF,IAAK,CACtE,GAAI8vB,GAAOd,EAAK0C,WAAW7kB,GAAG7M,GADwC2xB,EAEG7B,EAAnEpsB,EAFgEiuB,EAEhEjuB,QAAS2nB,EAFuDsG,EAEvDtG,QAFuDuG,EAAAD,EAE9CxC,OAAAA,EAF8Ct0B,SAAA+2B,EAErC,EAFqCA,EAElCxC,EAFkCuC,EAElCvC,QAFkCyC,EAAAF,EAEzBtC,OAAAA,EAFyBx0B,SAAAg3B,EAEhB,EAFgBA,EAIhEC,GAJgEH,EAEbrC,YAE1CyC,EAAiBjC,GAChC,IAAGgC,EAAO,CACN,GAAIE,GAAc,CAClB,IAAI5C,EAAS,CACT,GAAMoB,GAAMpB,EAAQkB,SAASjB,OACrB90B,EAAei2B,EAAfj2B,KAAMm2B,EAASF,EAATE,IACdsB,GAAuB,YAATz3B,GAA+B,qBAATA,EAA8Bm2B,EAAK91B,OAAS,MAC7E,CACH,GAAMi1B,GAAOxE,EAAQ6E,MAAMf,OADxB8C,EAE0CpC,EAArCG,QAAAA,EAFLn1B,SAAAo3B,KAAAA,EAAAC,EAE0CrC,EAAzBsC,kBAAAA,EAFjBt3B,SAAAq3B,KAAAA,CAGHF,GAAcvxB,KAAK2M,IAAI4iB,EAAQp1B,OAAQu3B,EAAkBv3B,QAO7D,GADAk1B,EAAKP,eAAiBO,EAAKP,gBAAkB,EACzCO,EAAKP,eAAiB,IAAkB,IAAXuC,GAAgBhC,EAAKP,eAAiB,GAAMyC,EAAc,EAAG,CAC1FlC,EAAKN,MAAO,CACZ,UAEAM,EAAKP,iBAIb,GAAIO,EAAKN,KACLM,EAAKN,MAAO,EACZM,EAAKP,eAAiB,MAI1B,IAAIH,EACA,GAAIA,EAAQkB,SAAS11B,QAAUy0B,EAC3BL,EAAK0C,WAAW7kB,GAAGyL,OAAOtY,IAAK,IAC1B0D,EAAQgsB,MAAM90B,QAAU8I,EAAQisB,SAAS/0B,SAAWw0B,EAAQuB,WAC7D3B,EAAKoD,eAAetB,EAAWhB,EAAM,iBAC7BV,EAAQuB,YAChB3B,EAAKoD,eAAetB,EAAWhB,EAAM,uBAEtC,CACH,GAAMn2B,GAAUy1B,EAAQkB,SAASjB,OACzB90B,EAAeZ,EAAfY,KAAMm2B,EAAS/2B,EAAT+2B,IACd,IAAa,YAATn2B,GAA+B,qBAATA,EAA6B,CACnD,GAAMw1B,GAAQQ,EAAkB52B,EAASm2B,EACzCA,GAAKT,SACLU,EAAMn1B,QAAUo0B,EAAKoD,cAAcrC,OACnB,SAATx1B,GAA4B,SAATA,GAA4B,WAATA,GAChC,WAATA,GACAy0B,EAAK0C,WAAW7kB,GAAGyL,OAAOtY,IAAK,GAE1B,SAATzF,GAAmBy0B,EAAKoD,eAAetB,EAAWhB,EAAX,eAAiCY,EAAK,MACpE,WAATn2B,GAAqBy0B,EAAKoD,eAAetB,EAAWhB,EAAX,iBAAmCY,EAAK,MACjFZ,EAAKT,WACF,WAEH,IAFG,GAAAgD,GACYjD,EAAQkB,WAAWR,EAAKT,YAAjC90B,EADH83B,EACG93B,KACCA,IAASk3B,EAAajnB,KAAK,SAAA4lB,GAAA,MAAKA,KAAM71B,KAAO,CAAA,GAAA+3B,GACpClD,EAAQkB,WAAWR,EAAKT,WAAjC90B,GAD6C+3B,EAC7C/3B,aAIZ,IAAI8wB,EAAQ6E,MAAMt1B,QAAUu0B,EAC/BH,EAAK0C,WAAW7kB,GAAGyL,OAAOtY,IAAK,GAC3B0D,EAAQgsB,MAAM90B,SACdk1B,EAAOgB,EAAWhB,EAAM,OACxBd,EAAKoD,eAAetC,SAErB,CACH,GAAMD,GAAOxE,EAAQ6E,MAAMf,OADxBoD,EAE0C1C,EAArCG,QAAAA,EAFLn1B,SAAA03B,KAAAA,EAAAC,EAE0C3C,EAAzBsC,kBAAAA,EAFjBt3B,SAAA23B,KAAAA,CAGH,IAAIxC,EAAQp1B,QAAUu3B,EAAkBv3B,OAAQ,CAC5C,GAAM63B,GAAS7C,EAAeC,EAAM,UAAWC,GACzC4C,EAAS9C,EAAeC,EAAM,oBAAqBC;AAEzDA,EAAKX,SACL0B,EAAkBf,GAElB2C,EAAO73B,QAAUo0B,EAAKoD,cAAcK,GACpCC,EAAO93B,QAAUo0B,EAAKoD,cAAcM,OAC9B7C,GAAKpV,MAAQoV,EAAK8C,MAAQ9C,EAAK+C,QAChC/C,EAAK+C,QACN5D,EAAK0C,WAAW7kB,GAAGyL,OAAOtY,IAAK,GAEnC6vB,EAAK8C,MAAQ3D,EAAKoD,eAAetB,EAAWhB,EAAM,OAAQD,EAAK8C,QAC/D9C,EAAK+C,QAAU5D,EAAKoD,eAAetB,EAAWhB,EAAM,SAAUD,EAAK+C,UACnE9C,EAAKX,SACL0B,EAAkBf,KAElBA,EAAKX,SACL0B,EAAkBf,KAKlC,IAAK,GAAI9vB,GAAI,EAAGgvB,EAAK0C,YAAc1xB,EAAIgvB,EAAK0C,WAAW92B,OAAQoF,IACxDgvB,EAAK0C,WAAW1xB,KAAOgvB,EAAK0C,WAAW1xB,GAAGpF,QACzCo0B,EAAK0C,WAAWpZ,OAAOtY,IAAK,IAKlC6yB,EAAa,SAAA/C,GACf,GAAGA,EAAKpsB,QAAQ2tB,SAAS,CAAA,GAAAyB,GACchD,EAAKpsB,QAAQ2tB,SAA1C3B,EADeoD,EACfpD,MAAOC,EADQmD,EACRnD,SAAUtE,EADFyH,EACEzH,OACvByE,GAAKpsB,QAAQgsB,MAAQA,EACrBI,EAAKpsB,QAAQisB,SAAWA,EACxBG,EAAKzE,QAAUA,EACfyE,EAAKX,OAAS,EACd0B,EAAkBf,SACXA,GAAKpsB,QAAQ2tB,WAItB0B,EAAc,SAAAjD,GAAQ,GAChBzE,GAAYyE,EAAZzE,OACR,IAAIA,EAAQ2H,KAAgC,IAAzB3H,EAAQ6E,MAAMt1B,QAAsC,MAAtB0B,UAAUmM,UAAoB4iB,EAAQA,QAAS,CAC5F,GAAM4H,GAAc5H,EAAQ6H,aAAe7H,EAAQ6H,aAAe7H,EAAQvmB,KACtEquB,EAAqB,KACnBvN,EAAS,SAAAwN,GAAwB,GAArB74B,GAAqB64B,EAArB74B,KAAqB84B,EAAAD,EAAflD,MAAAA,EAAer1B,SAAAw4B,KAAAA,CACnC,IAAa,WAAT94B,EACAs4B,EAAW/C,OACR,IAAa,WAATv1B,EAAmB,CAAA,GAAA+4B,EACD,KAAzBjI,EAAQ6E,MAAMt1B,SAAgB04B,EAAAjI,EAAQ6E,OAAMpT,KAAd3G,MAAAmd,EAAA7O,EAAsByL,IACpDlB,EAAKJ,aAAa2E,kBAAkBN,GAAe,KAEvD,MAAOnD,GAEX,OAAGd,GAAKJ,aAAa2E,kBAAkBN,GAC5BjE,EAAKJ,aAAa2E,kBAAkBN,GAAaxwB,KAAKmjB,IAEjEuN,EAAqBnE,EAAKwE,WAAWC,mBAAmBR,EAAa5H,EAAQ2H,KAAK,GAAOvwB,KACrF,WAAc,GAAbytB,GAAav1B,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,KACV,QAAQJ,KAAK,SAAU21B,MAAAA,IACxB,SAACxtB,GACAkD,QAAQyN,KAAK3Q,KAErBssB,EAAKJ,aAAa2E,kBAAkBN,GAAeE,EAC5CA,EAAmB1wB,KAAKmjB,IAEnC,MAAOzqB,SAAQC,QAAQ00B,IAGrBiC,EAAmB,SAAAjC,GAkBrB,IAAK,GAlBwB4D,GACA5D,EAAvBR,YAAAA,EADuBz0B,SAAA64B,EACX,OADWA,EAEvBC,EAAQrE,EAAY1jB,MAAM,KAAKgE,MAAM,GAAGgkB,IAAI,SAAAt1B,GAC9C,GAAM8xB,GAAI9xB,EAAEsR,MAAM,GAClB,OAAI,KAAK/N,KAAKuuB,GACH,OACA,KAAKvuB,KAAKuuB,GACV,SACA,QAAQvuB,KAAKuuB,GACb,SACA,YAAYvuB,KAAKuuB,GACjB,aADJ,SAIPyD,KACAC,KACAC,KACAvJ,EAAS,EACJxqB,EAAI,EAAGA,EAAI2zB,EAAM/4B,OAAQoF,IAAK,CACnC,OAAQ2zB,EAAM3zB,IACV,IAAK,SAED,GADA6zB,EAAa/W,KAAK9c,GACd+zB,EAAWn5B,OACX,MAAO,EAEX,IAAIi5B,EAAaj5B,OAAS,EACtB,MAAO,EACwB,KAAxBi5B,EAAaj5B,SACpB4vB,EAAS,EAEb,MACJ,KAAK,aAED,GADAsJ,EAAiBhX,KAAK9c,GAClB8zB,EAAiBl5B,OAAS,GAAKm5B,EAAWn5B,QAAU,EACpD,MAAO,EAERk5B,GAAiBl5B,OAAS,IACzB4vB,EAAS,EAEb,MACJ,KAAK,OACL,IAAK,SAGD,GAFAuJ,EAAWjX,KAAK9c,GAChBwqB,EAAS,EACLqJ,EAAaj5B,OAAS,EACtB,MAAO,EAEX,IAAIm5B,EAAWn5B,OAAS,EACpB,MAAO,GAInB,GAAIm5B,EAAWn5B,QAAUk5B,EAAiBl5B,OAASi5B,EAAaj5B,OAAS,EACrE,MAAO,EAEX,IAAU,IAANoF,EACA,MAAO,EACJ,IAAIA,EAAI,EACX,MAAO,GAGf,MAAOwqB,IAGLwJ,EAAmB,QAAnBA,KACFxC,GAGA,KAAK,GAFCyC,MACFC,EAAc,EAHSC,EAAA,SAIlBn0B,GAEL,IAAK,GADCo0B,MALiBC,EAAA,SAMdxnB,GACL,GAAMijB,GAAOd,EAAK0C,WAAW1xB,GAAG6M,EAChC,IAAGijB,EAAKN,KACJ,MAAA,UAEJ,IAAM3J,GAAUvK,EAAMxV,QAAQ,GACzBrD,KAAK,WAAA,MAAMusB,GAAK0C,WAAW1xB,IAAMgvB,EAAK0C,WAAW1xB,GAAG6M,IAAMijB,IAASd,EAAK0C,WAAW1xB,GAAG6M,GAAKkmB,EAAY/D,EAAK0C,WAAW1xB,GAAG6M,IAAM1R,QAAQE,WACxIoH,KAAK,SAAAqtB,GAAA,MAAQd,GAAKgF,iBAAiBlE,KACnCrtB,KAAK,SAAAgD,GAAA,MAAMtK,SAAQm5B,IAAI7uB,EAAGnL,KAAKs5B,IAAI,SAAAruB,GAAA,MAAKypB,GAAKuF,aAAahvB,EAAE0C,IAAK1C,EAAEhL,KAAMgL,EAAE0C,KAAK,GAAMxF,KAAK,SAAAgM,GAAA,MAAKiI,QAAO8d,OAAOjvB,GAAIkvB,OAAQhmB,WAC1HhM,KAAK,SAAAgD,GACF,GAAMivB,GAAajvB,EAAGkvB,OAAO,SAAAlmB,GAAA,MAAKA,GAAEgmB,SAC9Bp1B,EAAOq1B,EAAW/X,OAAO,SAACyR,EAAKC,GAAN,MAAcD,IAAoB,QAAbC,EAAI9zB,KAAiB,IAAS,MAAU,EAC5Fy0B,GAAKJ,aAAavvB,MAAQA,EACtBq1B,EAAW95B,QAAUyE,GACrB60B,IAEJQ,EAAW95B,QAAUo0B,EAAKnkB,KAAK+pB,UAChCnyB,KAAK,WAAA,MAAM6Y,GAAMxV,QAAQ,KAChCsuB,GAAatX,KAAK+I,IAlBbhZ,EAAI,EAAGmiB,EAAK0C,WAAW1xB,IAAM6M,EAAImiB,EAAK0C,WAAW1xB,GAAGpF,OAAQiS,IAAK,CAAAwnB,EAAjExnB,GAqBTunB,EAAax5B,QAAUq5B,EAASnX,KAAK3hB,QAAQm5B,IAAIF,GAAc3xB,KAAK,KAAM,SAAAgM,GAAA,MAAK7I,SAAQyN,KAAK5E,OAvBvFzO,EAAI,EAAGgvB,EAAK0C,YAAc1xB,EAAIgvB,EAAK0C,WAAW92B,QAAUo0B,EAAKJ,aAAaiG,UAAY,IAAK70B,IAAKm0B,EAAhGn0B,EAyBT,IAAM80B,GAAS,WACXZ,GAAelF,EAAKJ,aAAaiG,YAC7B7F,EAAKJ,aAAavvB,MAAQ,IAAM2vB,EAAK0C,WAAW92B,QAAUo0B,EAAKJ,aAAaiG,WAAa,IACzF7F,EAAKJ,aAAatX,SAAU,EAE5BxZ,WAAWk2B,EAAkB,GAGrCC,GAASr5B,OAASO,QAAQm5B,IAAIL,GAAUxxB,KAAKqyB,EAAQA,GAAW9F,EAAKJ,aAAatX,SAAU,EAGjGxZ,YAAWk2B,EAAkB,+CAGN3I,GACtB,GAAMiE,GAAAA,IAAkBjE,EAAQvmB,KAA1B,GACNvL,MAAKw7B,mBAAmBzF,EAAa,QACrC/1B,KAAKy7B,oBAAoB1F,GACzB/1B,KAAK07B,uBAAuB3F,GAC5B/1B,KAAKu1B,gEAGcprB,EAAS2nB,GAAqC,GAAA6J,GAAA37B,KAA5B41B,EAA4Bx0B,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAArB,EAAGw6B,EAAkBx6B,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,MACzDy0B,EAAwB+F,EAAxB/F,QADyDgG,EACjCD,EAAf/D,SAAAA,EADgDv2B,SAAAu6B,EACvC,EADuCA,CAEjErJ,GAAiB2F,cACjBn4B,KAAK87B,cACL,IAAM7G,GAAcj1B,KAAKi6B,WAAW8B,uBACpC/7B,MAAKg8B,eAAe,SAACh7B,EAAM0N,EAAKgmB,GACzBO,EAAYvmB,IACXitB,EAAKhJ,YAAY3xB,EAAM0N,EAAKumB,EAAYvmB,MAGhD1O,KAAKi8B,sBAAsB9xB,EAAS2nB,EAAS8D,EAAQC,EAASgC,GAAU3uB,KAAK,WAAA,MAAMyyB,GAAKpG,mEAGpEzD,GAAS,GAAAoK,GAAAl8B,KACvB+1B,EAAAA,IAAkBjE,EAAQvmB,KAA1B,GACNvL,MAAK87B,cAAc/F,IACnB/1B,KAAKw7B,mBAAmBzF,EAAa,QACrC/1B,KAAKy7B,oBAAoB1F,GAAa,GAAM,EAC5C,IAAMd,GAAcj1B,KAAKi6B,WAAW8B,uBACpC/7B,MAAKg8B,eAAe,SAACh7B,EAAM0N,EAAKgmB,GACzBO,EAAYvmB,GACXwtB,EAAKvJ,YAAY3xB,EAAM0N,EAAKumB,EAAYvmB,IACzB,IAAVgmB,GACLwH,EAAKje,gBAAgBjd,EAAM0N,KAGnC1O,KAAK07B,uBAAuB3F,GAAa,GACzC/1B,KAAKu1B,uEAGqBwB,EAAU3xB,EAAO+2B,GAAS,GAAAC,GAAAp8B,KAC9Ci3B,EAAMF,EAAS3xB,EACrB,IAAI6xB,EAAJ,CAOA,IAAK,GAJCJ,GAAiB,YAAbI,EAAIj2B,KAAqB,IAAM,IACnC+0B,EAAAA,IAAkBkB,EAAI1rB,KAAOsrB,EAAIsF,EAAjC,IAEAE,KACG51B,EAAI,EAAGA,EAAIzG,KAAKm4B,WAAW92B,OAAQoF,IACxC,IAAK,GAAI6M,GAAI,EAAGA,EAAItT,KAAKm4B,WAAW1xB,GAAGpF,OAAQiS,IAAK,CAChD,GAAMijB,GAAOv2B,KAAKm4B,WAAW1xB,GAAG6M,EAC5BijB,GAAKR,YAAY3B,WAAW2B,IAC5BsG,EAAY9Y,KAAKgT,GAI7B,GAAM+F,GAAWD,EAAYh7B,QAAUg7B,EAAYE,MAAM,SAAAhG,GAAA,MAAQ,YAAYjuB,KAAKiuB,EAAKR,YAAYvf,UAAUuf,EAAY10B,UACzHrB,MAAKw7B,mBAAmBzF,EAAa,QACrCkB,EAAIE,KAAK9Z,QAAQ,SAACoZ,EAAShwB,GACvB,GAAM0tB,GAAAA,IAAa8C,EAAI1rB,KAAOsrB,EAAIpwB,EAA5B,IACA+1B,EAAS/1B,IAAM01B,GACpBK,GAAUJ,EAAKX,oBAAoBtH,IACnCqI,GAAUJ,EAAKK,sBAAsBtI,KAE1Cn0B,KAAK07B,uBAAuB3F,GAAcuG,GAAU,GACpDt8B,KAAKy7B,oBAAoB1F,GAAa,GACtC/1B,KAAKu1B,sEAGmBwB,EAAU3xB,GAAO,GAAAs3B,GAAA18B,IACzCA,MAAKu1B,uBACL,IAAM0B,GAAMF,EAAS3xB,EAAM,GACrB8yB,GAAgB,OAAQ,SAAU,OAAQ,UAAW,mBAAoB,WAAY,aAAc,YAAa,YAAa,UAChIjB,IAAOiB,EAAajnB,KAAK,SAAA4lB,GAAA,MAAKA,KAAMI,EAAIj2B,QACvChB,KAAKq1B,aAAaiG,YAElBrE,GAAmB,qBAAZA,EAAIj2B,MAGfi2B,EAAIE,KAAK9Z,QAAQ,SAACoZ,EAAShwB,GAAV,MAAgBi2B,GAAKjB,oBAAL,IAA6BxE,EAAI1rB,KAAjC,IAAyC9E,EAAzC,KAA+C,oDAGtD6vB,GAAiC,GAAAqG,GAAA38B,KAA3B48B,EAA2Bx7B,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAhB,GAAIgE,EAAYhE,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,MACrDJ,EAAsB,YAAf47B,EAA2B,IAAsB,sBAAfA,EAAqC,IAAM,GAD/BC,EAEdvG,EAArCG,QAAAA,EAFmDn1B,SAAAu7B,KAAAA,EAAAC,EAEdxG,EAAzBsC,kBAAAA,EAFuCt3B,SAAAw7B,KAAAA,CAG3D,IAAKrG,EAAQp1B,QAAWu3B,EAAkBv3B,OAA1C,CAKA,IAAK,GAFC00B,GAAAA,IAAkBO,EAAK/qB,KAAOvK,EAAOoE,EAArC,IACAi3B,KACG51B,EAAI,EAAGA,EAAIzG,KAAKm4B,WAAW92B,OAAQoF,IACxC,IAAK,GAAI6M,GAAI,EAAGA,EAAItT,KAAKm4B,WAAW1xB,GAAGpF,OAAQiS,IAAK,CAChD,GAAMijB,GAAOv2B,KAAKm4B,WAAW1xB,GAAG6M,EAC5BijB,GAAKR,YAAY3B,WAAW2B,IAC5BsG,EAAY9Y,KAAKgT,GAI7Bv2B,KAAKw7B,mBAAmBzF,EAAa,OACrC,IAAMuG,GAAWD,EAAYh7B,QAAUg7B,EAAYE,MAAM,SAAAhG,GAAA,MAAQ,YAAYjuB,KAAKiuB,EAAKR,YAAYvf,UAAUuf,EAAY10B,UACzHo1B,GAAQpZ,QAAQ,SAACoZ,EAAShwB,GACtB,GAAM0tB,GAAAA,IAAamC,EAAK/qB,KAAlB,IAA0B9E,EAA1B,IACAs2B,EAAYt2B,IAAMrB,GAAwB,YAAfw3B,GAChCG,GAAaJ,EAAKlB,oBAAoBtH,EAAQ4I,IAC9CA,GAAaJ,EAAKF,sBAAsBtI,KAE7CyE,EAAkBvb,QAAQ,SAACoZ,EAAShwB,GAChC,GAAM0tB,GAAAA,IAAamC,EAAK/qB,KAAlB,IAA0B9E,EAA1B,IACAs2B,EAAYt2B,IAAMrB,GAAwB,sBAAfw3B,GAChCG,GAAaJ,EAAKlB,oBAAoBtH,EAAQ4I,IAC9CA,GAAaJ,EAAKF,sBAAsBtI,KAE7Cn0B,KAAK07B,uBAAuB3F,GAAcuG,GAAU,GACpDt8B,KAAKy7B,oBAAoB1F,GAAa,GAEtC/1B,KAAKu1B,uEAGoBoB,EAAOvxB,GAAO,GAAA43B,GAAAh9B,IACvCA,MAAKu1B,wBACLv1B,KAAKq1B,aAAaiG,WAClB,IAAMhF,GAAOK,EAAMvxB,EAAQ,EAC3B,IAAKkxB,IAAQA,EAAKS,WAAcT,EAAKsC,mBAAsBtC,EAAKsC,kBAAkBv3B,QAAlF,CAJuC,GAAA47B,GAON3G,EAAzBsC,kBAAAA,EAP+Bt3B,SAAA27B,KAAAA,CAQvCrE,GAAkBvb,QAAQ,SAACoZ,EAAShwB,GAAV,MAAgBu2B,GAAKvB,oBAAL,IAA6BnF,EAAK/qB,KAAlC,IAA0C9E,EAA1C,KAAgD,+CAGtEy2B,GAAW,GAAAC,GAAAn9B,KACjB8xB,GAAwDoL,EAAjE/yB,QAAiE+yB,EAAxDpL,SADiBsL,EACuCF,EAA/CtH,OAAAA,EADQt0B,SAAA87B,EACC,EADDA,EACIvH,EAAmCqH,EAAnCrH,QADJwH,EACuCH,EAA1BpH,OAAAA,EADbx0B,SAAA+7B,EACqB,EADrBA,EACwBtH,EAAemH,EAAfnH,YACjDuH,GAAcv8B,QAAU+E,KAAM,EACpC,KAAKgsB,IAAYA,EAAQ6E,QAAU7E,EAAQ6E,MAAMf,IAAWC,IAAYA,EAAQkB,SAASjB,GACrF,MAAOl0B,SAAQC,QAAQy7B,EAG3B,IAAM3K,GAAc,SAAC3xB,EAAM0F,EAAKqvB,GAAZ,MAA4BoH,GAAKxK,YAAY3xB,EAAM0F,EAAKqvB,IAEtEwH,EAAc,SAAC72B,EAAK1F,EAAM+0B,GAE5B,MADApD,GAAY3xB,EAAM0F,EAAKqvB,GAClBuH,EAAUv8B,KAAKkQ,KAAK,SAAAjF,GAAA,MAAKA,GAAE0C,MAAQhI,IAOjC9E,QAAQC,SAAQ,GANZ+U,EAAI4mB,gBAAgB92B,EAAK1F,GAAMkI,KAAK,SAAApD,GAGvC,MAFAw3B,GAAUv8B,KAAKwiB,MAAO7U,IAAKhI,EAAK1F,KAAAA,EAAM8E,KAAAA,IACtCw3B,EAAUx3B,MAAQA,GACX,KAKb23B,EAAe,SAAC5H,EAASC,EAAQC,GACnC,MAAID,IAAUD,EAAQkB,SAAS11B,OACpBO,QAAQC,UAEZD,QAAQm5B,IAAIoC,EAAKO,oBAAoB7H,EAAQkB,SAASjB,IAASuE,IAAI,SAAAnlB,GAAA,MAAKqoB,GAAYroB,EAAExO,IAAKwO,EAAElU,KAAM+0B,OAGxG4H,EAAe,SAAC7L,EAAS8D,EAAQG,GACnC,GACMO,GAAOxE,EAAQ6E,MAAMf,EAE3B,QAAKU,GAAQA,EAAKS,WAAaT,EAAKS,SAAS11B,OAClCO,QAAQC,UAGhBy0B,EAAKS,UACJmG,EAAWrH,SAAYkB,SAAUT,EAAKS,UACtCmG,EAAWpH,OAAS,EACb2H,EAAanH,EAAM,EAAGP,IAG1Bn0B,QAAQm5B,IAAIoC,EAAKS,iBAAiBtH,GAAM+D,IAAI,SAAAnlB,GAAA,MAAKqoB,GAAYroB,EAAExO,IAAKwO,EAAElU,KAAM+0B,MAGvF,OAAOF,GACD4H,EAAa5H,EAASC,EAAQC,GAAa7sB,KAAK,WAAA,MAAMo0B,KACtDK,EAAa7L,EAAS8D,EAAQG,GAAa7sB,KAAK,WAAA,MAAMo0B,2CAG3C9G,GACjB,GAAKA,EAAMn1B,OAAX,CA+DArB,KAAKm4B,WAAW5U,KAAKiT,mDAIKrC,GAC1B,IAAK,GAD6BpP,KAAyB3jB,UAAAC,OAAA,GAAAC,SAAAF,UAAA,KAAAA,UAAA,GAAdy8B,IAAcz8B,UAAAC,OAAA,GAAAC,SAAAF,UAAA,KAAAA,UAAA,GAClDqF,EAAI,EAAGA,EAAIzG,KAAKm4B,WAAW92B,OAAQoF,IAAK,CAC7C,IAAK,GAAI6M,GAAI,EAAGA,EAAItT,KAAKm4B,WAAW1xB,GAAGpF,OAAQiS,IAAK,CAChD,GAAMijB,GAAOv2B,KAAKm4B,WAAW1xB,GAAG6M,GAC1ByiB,EAAyBQ,EAAzBR,YAAa5rB,EAAYosB,EAAZpsB,OACnB,IAAI4rB,EAAY3B,WAAWD,IAGvB,GAFA4B,EAAcA,EAAYvf,UAAU2d,EAAO9yB,QAC3Ck1B,EAAKR,YAAcA,EAAcA,EAAc,OAC3C8H,EAAS,CACT,GAAMjb,GAAQzY,EAAQgsB,MAAM2H,KACxBlb,IAAwB,WAAfA,EAAM5hB,MACfmJ,EAAQisB,SAAS0H,WAGlB/Y,KACP/kB,KAAKy7B,oBAAoB1F,GAAa,GACtC/1B,KAAKm4B,WAAW1xB,GAAGsY,OAAOzL,IAAK,IAGlCtT,KAAKm4B,WAAW1xB,GAAGpF,QACpBrB,KAAKm4B,WAAWpZ,OAAOtY,IAAK,kDAKX0tB,GACzB,IAAK,GAAI1tB,GAAI,EAAGA,EAAIzG,KAAKm4B,WAAW92B,OAAQoF,IAAK,CAC7C,IAAK,GAAI6M,GAAI,EAAGA,EAAItT,KAAKm4B,WAAW1xB,GAAGpF,OAAQiS,IAAK,CAChD,GAAMijB,GAAOv2B,KAAKm4B,WAAW1xB,GAAG6M,GAC1ByiB,EAAgBQ,EAAhBR,WACFA,GAAY3B,WAAWD,IACvBn0B,KAAKm4B,WAAW1xB,GAAGsY,OAAOzL,IAAK,GAGlCtT,KAAKm4B,WAAW1xB,GAAGpF,QACpBrB,KAAKm4B,WAAWpZ,OAAOtY,IAAK,gDAKbzF,GACvB,GAAMs8B,KACN,IAAa,UAATt8B,EACA,IAAK,GAAIyF,GAAE,EAAGA,EAAE,IAAKA,IACjB62B,EAAU/Z,MAAM7c,IAAAA,IAASqb,EAAMgc,4BAAf,IAA8Chc,EAAMic,uBAAuB,QAA3E,WAA6Fjc,EAAMkc,UAAUx3B,GAA7G,OAAuHzF,KAAK,YAG/I,IAAY,UAATA,GACJ,GAAG+B,UAAUC,SACT,IAAI,GAAIyD,GAAG,EAAEA,EAAI,GAAGA,IAChB62B,EAAU/Z,MAAM7c,IAAAA,IAASqb,EAAMgc,4BAAf,IAA8Chc,EAAMic,uBAAuB,QAA3E,SAA2Fjc,EAAMkc,UAAUx3B,GAA3G,OAAqHzF,KAAK,YAIjJ,IAAa,UAATA,EACL,IAAK,GAAIyF,GAAE,EAAGA,EAAE,GAAIA,IAChB62B,EAAU/Z,MAAM7c,IAAAA,IAASqb,EAAMgc,4BAAf,IAA8Chc,EAAMic,uBAAuB,QAA3E,UAA4Fjc,EAAMkc,UAAUx3B,GAA5G,OAAsHzF,KAAK,YAG9I,IAAa,gBAATA,EACL,IAAK,GAAIyF,GAAE,EAAGA,EAAE,GAAIA,IAChB62B,EAAU/Z,MAAM7c,IAAAA,IAASqb,EAAMgc,4BAAf,IAA8Chc,EAAMic,uBAAuB,eAA3E,WAAoGjc,EAAMkc,UAAUx3B,GAApH,OAA8HzF,KAAK,YAGtJ,IAAa,iBAATA,EACL,IAAK,GAAIyF,GAAE,EAAGA,EAAE,GAAIA,IAChB62B,EAAU/Z,MAAM7c,IAAAA,IAASqb,EAAMgc,4BAAf,IAA8Chc,EAAMic,uBAAuB,gBAA3E,WAAqGjc,EAAMkc,UAAUx3B,GAArH,OAA+HzF,KAAK,YAGvJ,IAAa,kBAATA,EACL,IAAK,GAAIyF,GAAE,EAAGA,EAAE,GAAIA,IAChB62B,EAAU/Z,MAAM7c,IAAAA,IAASqb,EAAMgc,4BAAf,IAA8Chc,EAAMic,uBAAuB,WAA3E,YAAiGjc,EAAMkc,UAAUx3B,GAAjH,OAA2HzF,KAAK,YAGnJ,IAAa,cAATA,EACL,IAAK,GAAIyF,GAAE,EAAGA,EAAE,GAAIA,IAChB62B,EAAU/Z,MAAM7c,IAAAA,IAASqb,EAAMgc,4BAAf,IAA8Chc,EAAMic,uBAAuB,aAA3E,aAAoGjc,EAAMkc,UAAUx3B,GAApH,OAA8HzF,KAAK,OAG3J,OAAOs8B,+CAGgBl9B,GACvB,GAAMk9B,KACN,QAAQl9B,EAAQY,MACZ,IAAK,WACEZ,EAAQ+2B,KAAK,GAAGzwB,KAAO,YAActG,EAAQ+2B,KAAK,GAAGzwB,KACpD42B,EAAU/Z,MAAMviB,KAAK,MAAO0F,IAAItG,EAAQ+2B,KAAK,GAAGzwB,IAAKw3B,aAAwC,IAA1B99B,EAAQ+2B,KAAK,GAAG/xB,OAEvF,MACJ,KAAK,aACDk4B,EAAU/Z,MAAMviB,KAAK,MAAO0F,IAAItG,EAAQ+2B,KAAK,GAAGgH,OAAOz3B,KACvD,MACJ,KAAK,YACEtG,EAAQ+2B,KAAK,GAAGzwB,KAAO,YAAatG,EAAQ+2B,KAAK,GAAGzwB,KACnD42B,EAAU/Z,MAAMviB,KAAK,QAAS0F,IAAItG,EAAQ+2B,KAAK,GAAGzwB,IAAK03B,SAAQ,GAEnE,MACJ,KAAK,YACEh+B,EAAQ+2B,KAAK,GAAGzwB,KAAO,YAAatG,EAAQ+2B,KAAK,GAAGzwB,KACnD42B,EAAU/Z,MAAMviB,KAAK,QAAS0F,IAAItG,EAAQ+2B,KAAK,GAAGzwB,IAAK23B,SAAQ,EAAMj5B,MAAMhF,EAAQ+2B,KAAK,GAAG/xB,OAE/F,MACJ,KAAK,UAAL,GAAAk5B,IAAA,EAAAC,GAAA,EAAAC,EAAAl9B,MAAA,KACI,IAAA,GAAAm9B,GAAAC,EAAmBt+B,EAAQ+2B,KAA3BwH,OAAAC,cAAAN,GAAAG,EAAAC,EAAAG,QAAAC,MAAAR,GAAA,EAAiC,CAAA,GAAxB5H,GAAwB+H,EAAAje,MACrBtc,EAAsBwyB,EAAtBxyB,WAAYmV,EAAUqd,EAAVrd,KACpB,IAAInV,EAAY,CAAA,GACJ66B,GAA4B76B,EAA5B66B,OAAQC,EAAoB96B,EAApB86B,OAAQC,EAAY/6B,EAAZ+6B,OACxBF,IAAUA,EAAOr4B,KAAO42B,EAAU/Z,MAAOviB,KAAM,MAAO0F,IAAKq4B,EAAOr4B,MAClEs4B,GAAUA,EAAOt4B,KAAO42B,EAAU/Z,MAAOviB,KAAM,MAAO0F,IAAKs4B,EAAOt4B,MAClEu4B,GAAWA,EAAQv4B,KAAO42B,EAAU/Z,MAAOviB,KAAM,MAAO0F,IAAKu4B,EAAQv4B,MAErE2S,GAASA,EAAM3S,KACf42B,EAAU/Z,MAAOviB,KAAM,QAAS0F,IAAK2S,EAAM3S,OAVvD,MAAAmlB,GAAA0S,GAAA,EAAAC,EAAA3S,EAAA,QAAA,KAAAyS,GAAAI,EAAAA,WAAAA,EAAAA,YAAA,QAAA,GAAAH,EAAA,KAAAC,IAaI,KACJ,KAAK,UACwB,MAAtBz7B,UAAUmM,SAAiBouB,EAAU/Z,KAAV3G,MAAA0gB,EAAApS,EAAkBlrB,KAAKk/B,oBAAoB9+B,EAAQ+2B,KAAK,KACtF,MACJ,KAAK,aACE/2B,EAAQ+2B,KAAK,GAAGzwB,KACf42B,EAAU/Z,MAAMviB,KAAK,MAAO0F,IAAItG,EAAQ+2B,KAAK,GAAGzwB,KAEpD,MACJ,KAAK,aAAL,GAAAy4B,GAC6B/+B,EAAQ+2B,KAAK,GAA/BgH,EADXgB,EACWhB,OAAO36B,EADlB27B,EACkB37B,OACX26B,GAAOz3B,KACN42B,EAAU/Z,MAAMviB,KAAK,MAAO0F,IAAIy3B,EAAOz3B,MAExClD,EAAQkD,KACP42B,EAAU/Z,MAAMviB,KAAK,MAAO0F,IAAIlD,EAAQkD,MAMpD,MAAO42B,4CAGahH,GACpB,GAAMgH,KAEN,IAAuD,kBAAnDngB,OAAOb,UAAU7R,SAASumB,KAAKsF,EAAK8I,YACpC,IAAK,GAAI34B,KAAK6vB,GAAK8I,WAAY,CAC3B,GAAIp2B,GAAOstB,EAAK8I,WAAW34B,EACvBuC,IAAQ,YAAcA,EAAKtC,KAC3B42B,EAAU/Z,MAAO7c,IAAKsC,EAAKtC,IAAK1F,KAAM,QAASq9B,SAAQ,EAAMj5B,MAAOqB,QAGrE6vB,GAAK8I,WAAW14B,KAAO,YAAc4vB,EAAK8I,WAAW14B,KAC5D42B,EAAU/Z,MAAO7c,IAAKsC,KAAKtC,IAAK1F,KAAM,QAASq9B,SAAQ,EAAMj5B,MAAO,GAGpEkxB,GAAKpyB,WAAWwC,KAA+B,YAAxB4vB,EAAKpyB,WAAWwC,KACvC42B,EAAU/Z,MAAO7c,IAAK4vB,EAAKpyB,WAAWwC,IAAK1F,KAAM,MAAOk9B,cAAa,IAIrE5H,EAAK6H,OAAOz3B,KACZ42B,EAAU/Z,MAAO7c,IAAK4vB,EAAK6H,OAAOz3B,IAAK1F,KAAM,QAG7Cs1B,EAAKjD,MAAM3sB,KAA0B,YAAnB4vB,EAAKjD,MAAM3sB,KAC7B42B,EAAU/Z,MAAO7c,IAAK4vB,EAAKjD,MAAM3sB,IAAK1F,KAAK,QAASo9B,SAAQ,GAxBvC,IAAAiB,IAAA,EAAAC,GAAA,EAAAC,EAAAj+B,MAAA,KA4BzB,IAAA,GAAAk+B,GAAAC,EAAsBnJ,EAAKoJ,WAA3Bf,OAAAC,cAAAS,GAAAG,EAAAC,EAAAZ,QAAAC,MAAAO,GAAA,EAAuC,CAAA,GAA9BM,GAA8BH,EAAAhf,KACnCmf,GAAUj5B,KAAO42B,EAAU/Z,MAAO7c,IAAKi5B,EAAUj5B,IAAK1F,KAAM,SA7BvC,MAAA6qB,GAAAyT,GAAA,EAAAC,EAAA1T,EAAA,QAAA,KAAAwT,GAAAI,EAAAA,WAAAA,EAAAA,YAAA,QAAA,GAAAH,EAAA,KAAAC,IAAA,GAAAK,IAAA,EAAAC,GAAA,EAAAC,EAAAx+B,MAAA,KAiCzB,IAAA,GAAAy+B,GAAAC,EAAiB1J,EAAK2J,MAAtBtB,OAAAC,cAAAgB,GAAAG,EAAAC,EAAAnB,QAAAC,MAAAc,GAAA,EAA6B,CAAA,GAApBM,GAAoBH,EAAAvf,KACzB0f,GAAKx5B,KAAO42B,EAAU/Z,MAAO7c,IAAKw5B,EAAKx5B,IAAK1F,KAAM,SAlC7B,MAAA6qB,GAAAgU,GAAA,EAAAC,EAAAjU,EAAA,QAAA,KAAA+T,GAAAI,EAAAA,WAAAA,EAAAA,YAAA,QAAA,GAAAH,EAAA,KAAAC,IAAA,GAAAK,IAAA,EAAAC,GAAA,EAAAC,EAAA/+B,MAAA,KAqCzB,IAAA,GAAAg/B,GAAAC,EAAmBjK,EAAKG,QAAxBkI,OAAAC,cAAAuB,GAAAG,EAAAC,EAAA1B,QAAAC,MAAAqB,GAAA,EAAiC,CAAA,GAAxBzJ,GAAwB4J,EAAA9f,MACrBtc,EAAsBwyB,EAAtBxyB,WAAYmV,EAAUqd,EAAVrd,KACpB,IAAInV,EAAY,CAAA,GACJ66B,GAA4B76B,EAA5B66B,OAAQC,EAAoB96B,EAApB86B,OAAQC,EAAY/6B,EAAZ+6B,OACxBF,IAAUA,EAAOr4B,KAAO42B,EAAU/Z,MAAOviB,KAAM,MAAO0F,IAAKq4B,EAAOr4B,MAClEs4B,GAAUA,EAAOt4B,KAAO42B,EAAU/Z,MAAOviB,KAAM,MAAO0F,IAAKs4B,EAAOt4B,MAClEu4B,GAAWA,EAAQv4B,KAAO42B,EAAU/Z,MAAOviB,KAAM,MAAO0F,IAAKu4B,EAAQv4B,MAErE2S,GAASA,EAAM3S,KACf42B,EAAU/Z,MAAOviB,KAAM,QAAS0F,IAAK2S,EAAM3S,OA9C1B,MAAAmlB,GAAAuU,GAAA,EAAAC,EAAAxU,EAAA,QAAA,KAAAsU,GAAAI,EAAAA,WAAAA,EAAAA,YAAA,QAAA,GAAAH,EAAA,KAAAC,IAsDzB,MAJI/J,GAAKkK,QAAQhgB,OACY,MAAtBzd,UAAUmM,SAAiBouB,EAAU/Z,KAAV3G,MAAA0gB,EAAApS,EAAkBlrB,KAAKk/B,oBAAoB5I,EAAKkK,QAAQhgB,SAGnF8c,mDAGqB5G,GAAyB,GAAA+J,GAAAzgC,KAAjBgB,EAAiBI,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAV,UACvCszB,EAAQ10B,KAAK0gC,wBAAwB7lB,IAAI6b,IAAW,CACxD,IAAIhC,EACA,MAAOA,EAEX,IAAMiM,MAEApD,EAAc,SAAAroB,GACXyrB,EAAazrB,EAAExO,OAChBguB,IACAiM,EAAazrB,EAAExO,MAAO,IAIxBk6B,EAAmB,SAAClK,GACtB,IAAK,GAAIjwB,GAAI,EAAGA,EAAIiwB,EAAOC,MAAMt1B,QAAUqzB,GAAS,GAAIjuB,IAAK,CACzD,GAAM6vB,GAAOI,EAAOC,MAAMlwB,GACtByF,IACAoqB,GAAKS,SACL7qB,EAAKoqB,EAAKS,SAASsD,IAAI,SAAAxzB,GAInB,MAHe,YAAXA,EAAE7F,MAAiC,qBAAX6F,EAAE7F,MAC1B6/B,EAAqBh6B,EAAEswB,MAEpBsJ,EAAK/C,oBAAoB72B,KACjCuc,OAAO,SAACyR,EAAKC,GAAN,SAAA7J,OAAAC,EAAkB4J,IAAKD,UAE7ByB,EAAKG,QAAQp1B,QACby/B,EAAkBxK,EAAKG,SAEvBH,EAAKsC,kBAAkBv3B,QACvBy/B,EAAkBxK,EAAKsC,mBAE3B1sB,EAAKu0B,EAAK7C,iBAAiBtH,IAE/BpqB,EAAGmR,QAAQ,SAAAnI,GAAA,MAAKqoB,GAAYroB,OAG9B4rB,EAAoB,SAACrK,GAAD,MAAaA,GAAQpZ,QAAQ,SAAAtJ,GAAA,MAAK6sB,GAAiB7sB,MAEvEgtB,EAAsB,SAACrK,GACzB,IAAK,GAAIjwB,GAAI,EAAGA,EAAIiwB,EAAOK,SAAS11B,QAAUqzB,GAAS,GAAIjuB,IAAK,CAC5D,GAAMwwB,GAAMP,EAAOK,SAAStwB,EAC5Bg6B,GAAK/C,oBAAoBzG,GAAK5Z,QAAQ,SAAAnI,GAAA,MAAKqoB,GAAYroB,KACtC,YAAb+hB,EAAIj2B,MAAmC,qBAAbi2B,EAAIj2B,MAC9B6/B,EAAqB5J,EAAIE,QAI/B0J,EAAuB,SAACpK,GAAD,MAAaA,GAAQpZ,QAAQ,SAAAtJ,GAAA,MAAKgtB,GAAoBhtB,KAQnF,OANa,YAAT/S,EACA4/B,EAAiBlK,GAEjBqK,EAAoBrK,GAGjBhC,gDAGkBvqB,EAAS2nB,GAAgE,GAAvD8D,GAAuDx0B,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAA9C,EAAGy0B,EAA2Cz0B,UAAA,GAAA4/B,EAAAhhC,KAAlC81B,EAAkC10B,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAA1B,EAAG6/B,IAAuB7/B,UAAAC,OAAA,GAAAC,SAAAF,UAAA,KAAAA,UAAA,GAC5Fk8B,GAAcv8B,QAAU+E,KAAM,EAKpC,IAJAqE,EAAAA,KAAeA,GACfA,EAAQgsB,SAARlL,OAAAC,EAAqB/gB,EAAQgsB,YAC7BhsB,EAAQisB,YAARnL,OAAAC,EAAwB/gB,EAAQisB,gBAE3BtE,IAAYA,EAAQ6E,QAAU7E,EAAQ6E,MAAMf,IAAWC,IAAYA,EAAQkB,SAASjB,GACrF,MAAOl0B,SAAQC,QAAQy7B,EAG3B,IAAM4D,GAAY,WAAA,MAAM5D,GAAUx3B,KAAOk7B,EAAKG,QAAQ,GAAK7D,EAAUv8B,KAAKM,OAAS,IAE7EsxB,EAAc,SAAC3xB,EAAM0F,EAAKqvB,GAAZ,MAA4BkL,IAAkBD,EAAKrO,YAAY3xB,EAAM0F,EAAKqvB,IAExFwH,EAAc,SAAC72B,EAAK1F,EAAM+0B,GAE5B,MADApD,GAAY3xB,EAAM0F,EAAKqvB,GAClBuH,EAAUv8B,KAAKkQ,KAAK,SAAAjF,GAAA,MAAKA,GAAE0C,MAAQhI,IAMjC9E,QAAQC,UALJ+U,EAAI4mB,gBAAgB92B,EAAK1F,GAAMkI,KAAK,SAAApD,GACvCw3B,EAAUv8B,KAAKwiB,MAAO7U,IAAKhI,EAAK1F,KAAAA,EAAM8E,KAAAA,IACtCw3B,EAAUx3B,MAAQA,KAMxBs7B,EAAa,SAAAC,GAA8D,GAA5Dl3B,GAA4Dk3B,EAA5Dl3B,QAAS2nB,EAAmDuP,EAAnDvP,QAAS8D,EAA0CyL,EAA1CzL,OAAQC,EAAkCwL,EAAlCxL,QAASC,EAAyBuL,EAAzBvL,OAAQC,EAAiBsL,EAAjBtL,YACtDlvB,EAAAA,KAASsD,GAASgsB,SAAUC,cAC5BO,EAAQ7E,EAAQ6E,SAKtB,QAJKd,GAAWc,EAAMt1B,OAASu0B,GAAUe,EAAMf,IAAWe,EAAMf,GAAQmB,WACpElB,GAAYkB,SAAUJ,EAAMf,GAAQmB,UACpCjB,OAEK3rB,QAAStD,EAAGirB,QAAAA,EAAS8D,OAAAA,EAAQC,QAAAA,EAASC,OAAAA,EAAQC,YAAAA,IAGrDuL,EAAiB,SAAC99B,EAASk2B,GAAgB,GAAA6H,GACd/9B,EAAzB2G,EADuCo3B,EACvCp3B,QAAS4rB,EAD8BwL,EAC9BxL,YACTyL,EAAazf,EAAMgW,oBAAoBiJ,EAAKhJ,SAAU0B,EAC5D,IAAI8H,EAKJ,MAFAzL,IAA+B,SAAdA,EAAqB,GAAGA,GAAzC,IAAwDyL,EAAWj2B,KAAnE,IACA/H,GAAY2G,QAAAA,EAAS0rB,QAAQ,KAAM/D,QAAS0P,EAAY5L,UAAaG,YAAAA,GAC9DqL,EAAW59B,IAGhBi+B,EAAmB,SAACj+B,EAASk2B,GAAgB,GAAAgI,GAChBl+B,EAAzB2G,EADyCu3B,EACzCv3B,QAAS4rB,EADgC2L,EAChC3L,YACTyL,EAAazf,EAAMgW,oBAAoBiJ,EAAKhJ,SAAU0B,EAC5D,IAAI8H,EAKJ,MAFAzL,IAA+B,SAAdA,EAAqB,GAAGA,GAAzC,IAAwDyL,EAAWj2B,KAAnE,IACA/H,GAAY2G,QAAAA,EAAS0rB,QAAQ,KAAM/D,QAAQ0P,EAAY5L,UAAaG,YAAAA,GAC7DqL,EAAW59B,IAGhBm+B,EAAe,SAACvhC,EAAS21B,GAC3B,GAAMuH,GAAY0D,EAAKtD,oBAAoBt9B,EAW3C,OAVAk9B,GAAUjgB,QAAQ,SAAAnI,GAAK,GACNxO,IAAgCwO,EAAtClU,KAAsCkU,EAAhCxO,KAAK03B,EAA2BlpB,EAA3BkpB,QAASC,EAAkBnpB,EAAlBmpB,QAASj5B,EAAS8P,EAAT9P,KAChCg5B,IAAW4C,EAAK5N,YAAYwO,OAAOvgC,OAAS2/B,EAAKa,qBACjDb,EAAK5N,YAAYwO,OAAOre,KAAK7c,GAE7B23B,IAAY2C,EAAK5N,YAAYE,OAAOluB,KACpC47B,EAAK5N,YAAYE,OAAOluB,GAASsB,KAIlC9E,QAAQm5B,IAAIuC,EAAUjD,IAAI,SAAAnlB,GAAA,MAAKqoB,GAAYroB,EAAExO,IAAKwO,EAAElU,KAAM+0B,OAG/D+L,EAAoB,QAApBA,GAAqBt+B,GAMvB,IAAK,GALG2G,GAA2D3G,EAA3D2G,QAAS4rB,EAAkDvyB,EAAlDuyB,YAA8BF,GAAoBryB,EAArCsuB,QAAqCtuB,EAA5BoyB,OAA4BpyB,EAApBqyB,SAASC,EAAWtyB,EAAXsyB,OAClDmB,EAAMpB,EAAQkB,SAASjB,GACvBW,EAAUQ,EAAIE,KACd4K,KACAvL,KAL6BwL,EAAA,SAM1B7F,GAWL,IAAK,GAVCzF,GAASD,EAAQ0F,GACnBS,EAA0B,YAAb3F,EAAIj2B,KAAqB,IAAuB,WAAhB01B,EAAO11B,MAAqBggC,EAAKlK,yBAAyBJ,EAAQ,YAAc,GAAK,IAAM,IACtIuL,GAAelL,SAAUL,EAAOK,UAChCmL,GAAkC,SAAdnM,EAAqB,GAAGA,GAA5C,IAA2DkB,EAAI1rB,KAAOqxB,EAAaT,EAAnF,IACAgG,EAAW,SAACrM,GACd,GAAMS,GAAO6K,EAAAA,KAAe59B,GAASqyB,QAAQoM,EAAYnM,OAAAA,EAAQC,YAAYmM,IAC7E1L,GAAMjT,KAAKgT,IAETK,EAAAA,KAAYpzB,GAASqyB,QAAQoM,EAAYnM,OAAO,EAAGC,YAAYmM,IACjE5V,EAAU1qB,QAAQC,UAhBSugC,EAAA,SAiBtBC,GACL,GAAMpL,GAAMP,EAAOK,SAASsL,GACrBrhC,EAAci2B,EAAdj2B,KAAMm2B,EAAQF,EAARE,IAqBb,IApBA7K,EAAUA,EAAQpjB,KAAK,WACnB,MAAOy4B,GAAa1K,EAAKiL,GAAgBh5B,KAAK,WAC1C,GAAIg4B,GAAU,GACV,MAAOt/B,SAAQE,OAAOugC,EACnB,IAAa,YAATrhC,GAA+B,qBAATA,EAA6B,CAC1D,GAAMwC,GAAAA,KAAeozB,GAAMd,OAAOuM,GAElC,OADA7+B,GAAQ2G,QAARm4B,KAAuBn4B,GAASisB,cACzB0L,EAAkBt+B,GACvB,MAAY,SAATxC,GACLggC,EAAKnI,eAAeyI,EAAAA,KAAoB1K,GAAMd,OAAOuM,IAAelL,EAAK,MAClEv1B,QAAQE,YACA,WAATd,GACNggC,EAAKnI,eAAe4I,EAAAA,KAAsB7K,GAAMd,OAAOuM,IAAelL,EAAK,MACpEv1B,QAAQE,YACC,SAATd,EACAY,QAAQE,WAEZF,QAAQC,cAGV,YAATb,GAA+B,qBAATA,EAItB,MAHGqhC,GAAc,EAAI3L,EAAOK,SAAS11B,SACjCirB,EAAUA,EAAQpjB,KAAK,WAAA,MAAMtH,SAAQE,OAAOugC,MAEhD,SA3BCA,EAAc,EAAGA,EAAc3L,EAAOK,SAAS11B,QAAUghC,EAAc,GAAIA,IAAe,CAAA,GAAAE,GAAAH,EAA1FC,EAA0F,IAAA,UAAAE,EA2B3F,MAGRjW,EAAUA,EAAQpjB,KAAK,WACfwtB,EAAOK,SAAS11B,OAAS,IACzB8gC,EAAS,IAEd,SAAA/8B,GACKA,GAAS,GAAKsxB,EAAOK,SAAS11B,OAAS+D,GACvC+8B,EAAS/8B,KAGjB28B,EAAexe,KAAK+I,IAlDf6P,EAAU,EAAG1F,GAAW0F,EAAU1F,EAAQp1B,OAAQ86B,IAAW6F,EAA7D7F,EAoDT,OAAOv6B,SAAQm5B,IAAIgH,GAAgB74B,KAAK,WAEpC,MADAstB,GAAMn1B,QAAU2/B,EAAKnI,cAAcrC,GAC5B50B,QAAQC,aAIjB2gC,EAAmB,SAACh/B,GAA6B,GAApBi/B,KAAoBrhC,UAAAC,OAAA,GAAAC,SAAAF,UAAA,KAAAA,UAAA,GAC7C+I,EAA2D3G,EAA3D2G,QAAS2nB,EAAkDtuB,EAAlDsuB,QAAS8D,EAAyCpyB,EAAzCoyB,OAAQC,EAAiCryB,EAAjCqyB,QAASC,EAAwBtyB,EAAxBsyB,MAAwBtyB,GAAhBuyB,WACjD,IAAImL,GAAU,GAEV,MADAF,GAAKnI,eAAeuI,EAAW59B,KACxB5B,QAAQC,SAJgC,IAAA6gC,GAM7B7M,EAAQkB,SAASjB,OAA/B90B,EAN2C0hC,EAM3C1hC,KAAMm2B,EANqCuL,EAMrCvL,IACd,IAAY,SAATn2B,EAEC,MADAggC,GAAKnI,eAAeyI,EAAe99B,EAAS2zB,EAAK,MAC1Cv1B,QAAQC,SACZ,IAAY,WAATb,EAEN,MADAggC,GAAKnI,eAAe4I,EAAiBj+B,EAAS2zB,EAAK,MAC5CsG,EAAAA,KAAiBj6B,GAASsyB,OAAQA,EAAO,IAC7C,IAAa,SAAT90B,EACP,MAAOY,SAAQC,SACZ,IAAa,YAATb,GAA+B,qBAATA,EAC7B,MAAO8gC,GAAkBt+B,EAASi/B,GAAUv5B,KAAK,WAAA,MAAMu0B,GAAAA,KAAiBj6B,GAASsyB,OAAQA,EAAO,IAAK2M,IAClG,IAAI5M,EAAQkB,SAAS11B,OAASy0B,EAAS,EAC1C,MAAO2H,GAAAA,KAAiBj6B,GAASsyB,OAAQA,EAAO,IAAK2M,EAClD,IAAIA,GAAYt4B,EAAQisB,SAAS/0B,QAIpC,GAHA8I,EAAQisB,SAAWjsB,EAAQisB,SAASrX,OAAO,GAC3C+W,EAASD,EAAQwB,eAAiB,EAClCxB,EAAUA,EAAQuB,WACdvB,GAAW8M,OAAOC,UAAU9M,GAC5B,MAAO2H,GAAAA,KAAkBj6B,GAASqyB,QAAAA,EAASC,OAAAA,IAAU2M,OAEtD,IAAIA,GAAYt4B,EAAQgsB,MAAM90B,SAEjC8I,EAAQgsB,MAAQhsB,EAAQgsB,MAAM9f,MAAM,GACjCyb,EAAQjyB,SACP+1B,EAAS9D,EAAQjyB,OAAO+3B,OAAS,EACjC9F,EAAUA,EAAQjyB,OAAO83B,UAEzB7F,GAAW6Q,OAAOC,UAAUhN,IAC5B,MAAO+H,GAAAA,KAAkBn6B,GAASsuB,QAAAA,EAAS8D,OAAAA,IAGnD,OAAO6M,GAAW9E,EAAAA,KAAiBn6B,GAASoyB,OAAQA,EAAS,KAAMh0B,QAAQC,WAGzE47B,EAAe,SAACj6B,GAA2B,GAAlBi/B,KAAkBrhC,UAAAC,OAAA,GAAAC,SAAAF,UAAA,KAAAA,UAAA,GACrBy0B,GAAiCryB,EAAlDsuB,QAAkDtuB,EAAzCoyB,OAAyCpyB,EAAjCqyB,SAASC,EAAwBtyB,EAAxBsyB,OAAQC,EAAgBvyB,EAAhBuyB,WACzC,OAAID,IAAUD,EAAQkB,SAAS11B,OACpBmhC,EAAiBh/B,EAASi/B,GAG9Bd,EAAa9L,EAAQkB,SAASjB,GAASC,GAAa7sB,KAAK,WAAA,MAAMs5B,GAAiBh/B,EAASi/B,MAG9FI,EAAqB,SAAAvM,GAEvB,IAAK,GADD5B,GAAQ,EACHyH,EAAU,EAAG7F,EAAKG,SAAW0F,EAAU7F,EAAKG,QAAQp1B,OAAQ86B,IACjEzH,GAAS4B,EAAKG,QAAQ0F,GAASxF,MAAMt1B,MAGzC,KAAK,GAAI86B,GAAU,EAAG7F,EAAKsC,mBAAqBuD,EAAU7F,EAAKsC,kBAAkBv3B,OAAQ86B,IACrFzH,GAAS4B,EAAKsC,kBAAkBuD,GAASxF,MAAMt1B,MAEnD,OAAOqzB,IAGLiJ,EAAe,QAAfA,GAAgBn6B,GAAY,GACtBsuB,GAAiCtuB,EAAjCsuB,QAAS8D,EAAwBpyB,EAAxBoyB,OAAQG,EAAgBvyB,EAAhBuyB,YACnBO,EAAOxE,EAAQ6E,MAAMf,EAE3B,KAAKU,GAAQA,EAAKS,WAAaT,EAAKS,SAAS11B,OACzC,MAAOO,SAAQC,SAGnB,IAAGy0B,EAAKS,SACJ,MAAO0G,GAAAA,KAAiBj6B,GAASqyB,QAAQS,EAAMR,OAAO,IAG1D,IAAMgN,GAAY,SAACxM,EAAMP,GACrB,GAAMuH,GAAY0D,EAAKpD,iBAAiBtH,EAUxC,OATAgH,GAAUjgB,QAAQ,SAAAnI,GAAK,GACNxO,IAAgCwO,EAAtClU,KAAsCkU,EAAhCxO,KAAK03B,EAA2BlpB,EAA3BkpB,QAASC,EAAkBnpB,EAAlBmpB,QAASj5B,EAAS8P,EAAT9P,KAChCg5B,IAAW4C,EAAK5N,YAAYwO,OAAOvgC,OAAS2/B,EAAKa,qBACjDb,EAAK5N,YAAYwO,OAAOre,KAAK7c,GAE7B23B,IAAY2C,EAAK5N,YAAYE,OAAOluB,KACpC47B,EAAK5N,YAAYE,OAAOluB,GAASsB,KAGlC9E,QAAQm5B,IAAIuC,EAAUjD,IAAI,SAAAnlB,GAAA,MAAKqoB,GAAYroB,EAAExO,IAAKwO,EAAElU,KAAM+0B,OAG/DgN,EAAqB,QAArBA,GAAsBv/B,GAqCxB,IAAK,GApCGsuB,GAA0CtuB,EAA1CsuB,QAAS8D,EAAiCpyB,EAAjCoyB,OAAQG,EAAyBvyB,EAAzBuyB,YAAa5rB,EAAY3G,EAAZ2G,QAChCmsB,EAAOxE,EAAQ6E,MAAMf,GACrBoN,KACAC,KACAlB,KACAmB,KAEAf,EAAW,SAAC3+B,EAASgzB,GAAV,MAAoBA,GAAMjT,KAAK6d,EAAW59B,KACrD2/B,EAAsB,SAAC7W,EAASgK,EAAM9yB,GAyBxC,MAxBA8oB,GAAUA,EAAQpjB,KAAK,WACnB,MAAIotB,GAAKS,UACLvzB,EAAQqyB,SAAYkB,SAAUT,EAAKS,UACnCvzB,EAAQsyB,OAAS,EACV2H,EAAaj6B,GAAS,IAEtBs/B,EAAUxM,EAAM9yB,EAAQuyB,eAEpC7sB,KAAK,WACJ,MAAIg4B,IAAU,GACHt/B,QAAQE,OAAO0B,EAAQoyB,QACvBiN,EAAmBvM,GACnByM,EAAmBv/B,GACrB8yB,EAAK8C,MACV4H,EAAKnI,eAAeyI,EAAe99B,EAAS8yB,EAAK8C,QAC1Cx3B,QAAQE,YACTw0B,EAAK+C,QACX2H,EAAKnI,eAAe4I,EAAiBj+B,EAAS8yB,EAAK+C,UAC5Cz3B,QAAQE,YACRw0B,EAAKpV,KACLtf,QAAQE,WAEZF,QAAQC,aAhCauhC,EAAA,SAqC3BjH,GAML,IAAK,GALCzF,GAASJ,EAAKG,QAAQ0F,GACtBkH,GAAkC,SAAdtN,EAAqB,GAAGA,GAA5C,IAA2DO,EAAK/qB,KAAhE,IAAwE4wB,EAAxE,IACAmH,GAAc3M,MAAOD,EAAOC,MAAOprB,KAAMumB,EAAQvmB,MACjDqrB,EAAAA,KAAYpzB,GAASsuB,QAAQwR,EAAY1N,OAAQ,EAAGG,YAAYsN,IAClE/W,EAAU1qB,QAAQC,UACbwgC,EAAc,EAAGA,EAAc3L,EAAOC,MAAMt1B,QAAUghC,EAAc,EAAGA,IAAe,CAC3F,GAAM7+B,GAAAA,KAAeozB,GAAMhB,OAAOyM,GAClC7+B,GAAQ2G,QAARm4B,KAAuBn4B,GACvBmiB,EAAU6W,EAAoB7W,EAASoK,EAAOC,MAAM0L,GAAc7+B,GAEtE8oB,EAAUA,EAAQpjB,KAAK,WACfwtB,EAAOC,MAAMt1B,OAAS,GACtB8gC,EAAAA,KAAcvL,GAAMhB,OAAO,IAAKoN,IAErC,SAAA59B,GAIC,MAHIA,IAAS,GAAKsxB,EAAOC,MAAMt1B,OAAS+D,IAAUsxB,EAAOC,MAAMvxB,GAAO2xB,UAClEoL,EAAAA,KAAcvL,GAAMhB,OAAQxwB,IAAS49B,GAElCphC,QAAQC,YAEnBkgC,EAAexe,KAAK+I,IArBf6P,EAAU,EAAG7F,EAAKG,SAAW0F,EAAU7F,EAAKG,QAAQp1B,OAAQ86B,IAAWiH,EAAvEjH,EAwBT,KAAK,GA7D+BoH,GAAA,SA6D3BpH,GAOL,IAAK,GANDzF,GAASJ,EAAKsC,kBAAkBuD,GAC9BmH,GAAc3M,MAAOD,EAAOC,MAAO92B,QAAS83B,SAAU7F,EAAS8F,OAAQhC,GAASrqB,KAAMumB,EAAQvmB,MAC9FvK,EAAuB,WAAhB01B,EAAO11B,MAAqBggC,EAAKlK,yBAAyBJ,IAAW,GAAK,IAAM,IACvF2M,GAAkC,SAAdtN,EAAqB,GAAGA,GAA5C,IAA2DO,EAAK/qB,KAAOvK,EAAOm7B,EAA9E,IACAvF,EAAAA,KAAYpzB,GAASsuB,QAAQwR,EAAY1N,OAAQ,EAAGG,YAAYsN,IAClE/W,EAAU1qB,QAAQC,UACbwgC,EAAc,EAAGA,EAAc3L,EAAOC,MAAMt1B,QAAUghC,EAAc,EAAGA,IAAe,CAC3F,GAAM7+B,GAAAA,KAAeozB,GAAMhB,OAAOyM,GAClC7+B,GAAQ2G,QAARm4B,KAAuBn4B,GACvBmiB,EAAU6W,EAAoB7W,EAASoK,EAAOC,MAAM0L,GAAc7+B,GAEtE8oB,EAAUA,EAAQpjB,KAAK,WACfwtB,EAAOC,MAAMt1B,OAAS,GACtB8gC,EAAAA,KAAcvL,GAAMhB,OAAO,IAAKqN,IAErC,SAAA79B,GAIC,MAHIA,IAAS,GAAKsxB,EAAOC,MAAMt1B,OAAS+D,IAAUsxB,EAAOC,MAAMvxB,GAAO2xB,UAClEoL,EAAAA,KAAcvL,GAAMhB,OAAQxwB,IAAS69B,GAElCrhC,QAAQC,YAEnBqhC,EAAmB3f,KAAK+I,IAtBnB6P,EAAU,EAAG7F,EAAKsC,mBAAqBuD,EAAU7F,EAAKsC,kBAAkBv3B,OAAQ86B,IAAWoH,EAA3FpH,EAyBT,IAAMqH,GAAgB5hC,QAAQm5B,IAAIgH,GAAgB74B,KAAK,WAAA,MAAM85B,GAAQ3hC,QAAU2/B,EAAKnI,cAAcmK,KAC5FS,EAAoB7hC,QAAQm5B,IAAImI,GAAoBh6B,KAAK,WAAA,MAAM+5B,GAAS5hC,QAAU2/B,EAAKnI,cAAcoK,IAC3G,OAAOrhC,SAAQm5B,KAAKyI,EAAeC,KAGjCC,EAAgB,SAAClgC,GAAY,GACzB2G,GAA6B3G,EAA7B2G,QAAS2nB,EAAoBtuB,EAApBsuB,QAAS8D,EAAWpyB,EAAXoyB,OAClBU,EAAOxE,EAAQ6E,MAAMf,EAC3B,IAAGsL,IAAY,CACX,GAAM3K,GAAO6K,EAAW59B,EAExB,OADAw9B,GAAKnI,eAAetC,IACb30B,QAAQC,UACb,MAAGy0B,GAAKpV,KACHtf,QAAQC,UACVy0B,EAAK8C,MACV4H,EAAKnI,eAAeyI,EAAe99B,EAAS8yB,EAAK8C,QAC1Cx3B,QAAQC,WACTy0B,EAAK+C,QACX2H,EAAKnI,eAAe4I,EAAiBj+B,EAAS8yB,EAAK+C,UAC5CsE,EAAAA,KAAkBn6B,GAASoyB,OAAQA,EAAS,MAC5CiN,EAAmBvM,GACnByM,EAAmBv/B,GAAS0F,KAAK,WAAA,MAAMy0B,GAAAA,KAAkBn6B,GAASoyB,OAAQA,EAAS,OACnF9D,EAAQ6E,MAAMt1B,OAASu0B,EAAS,EAChC+H,EAAAA,KAAkBn6B,GAASoyB,OAAQA,EAAS,KAC5CzrB,EAAQgsB,MAAM90B,SACrB8I,EAAQgsB,MAAQhsB,EAAQgsB,MAAM9f,MAAM,GACjCyb,EAAQjyB,SACP+1B,EAAS9D,EAAQjyB,OAAO+3B,OAAS,EACjC9F,EAAUA,EAAQjyB,OAAO83B,UAEzB7F,GAAW6Q,OAAOC,UAAUhN,IACrB+H,EAAAA,KAAkBn6B,GAASsuB,QAAAA,EAAS8D,OAAAA,KAG5Ch0B,QAAQC,UAGnB,OAAOihC,GAAUxM,EAAMP,GAAa7sB,KAAK,WAAA,MAAMw6B,GAAclgC,MAG3DmgC,EAAiB,SAACrG,GAQpB,MAPGA,GAAUx3B,KAAOk7B,EAAKG,UACrBH,EAAK3L,aAAavvB,KAAOk7B,EAAKG,QAAU7D,EAAUx3B,MAGnDk7B,EAAK3L,aAAavvB,KAAO,GACxBk7B,EAAKzL,wBAEF+H,GAGL95B,GAAY2G,QAAAA,EAAS2nB,QAAAA,EAAS8D,OAAAA,EAAQC,QAAAA,EAASC,OAAAA,EAAQC,YAAY,OACzE,OAAOF,GACD4H,EAAaj6B,GAAS0F,KAAK,WAAA,MAAMy6B,GAAerG,KAChDK,EAAan6B,GAAS0F,KAAK,WAAA,MAAMy6B,GAAerG,8CAGlCA,GACpB,GAAM5C,KAIN,OAHA4C,GAAUjgB,QAAQ,SAAAnI,GACdwlB,EAASnX,KAAK3M,EAAI4mB,gBAAgBtoB,EAAExG,IAAKwG,EAAElU,SAExCY,QAAQm5B,IAAIL,GAAUxxB,KAAK,SAAA06B,GAAA,MAASA,GAAMxgB,OAAO,SAACrR,EAAEK,GAAH,MAASL,GAAIK,GAAG,+CAGnC,GAAlBpR,GAAkB6iC,EAAlB7iC,KAAM0N,EAAYm1B,EAAZn1B,IAAKtJ,EAAOy+B,EAAPz+B,MAC1B0+B,EAAS,EACb,QAAO9iC,GACH,IAAK,aACDhB,KAAKi1B,YAAY/wB,WAAawK,CAC9B,MACJ,KAAK,gBACD1O,KAAKi1B,YAAYC,cAAgBxmB,CACjC,MACJ,KAAK,QACDo1B,EAAS9jC,KAAKi1B,YAAY5B,MAC1BrzB,KAAKi1B,YAAY5B,MAAQ3kB,EACzBo1B,GAAU9jC,KAAK+jC,YAAY,QAASD,EACpC,MACJ,KAAK,QACDA,EAAS9jC,KAAKi1B,YAAY3B,OAAOluB,GACjCpF,KAAKi1B,YAAY3B,OAAOluB,GAASsJ,EACjCo1B,GAAU9jC,KAAK+jC,YAAY,QAASD,uCAK9Bp1B,GAAI,GAAAs1B,GACmChkC,KAAKi1B,YAAlD/wB,EADU8/B,EACV9/B,WAAYmvB,EADF2Q,EACE3Q,MAAOC,EADT0Q,EACS1Q,OAAQ4B,EADjB8O,EACiB9O,aACnC,OAAOhxB,KAAewK,GAAOwmB,IAAkBxmB,GAAO2kB,IAAU3kB,GAAO4kB,EAAOriB,KAAK,SAAAlM,GAAA,MAAKA,KAAM2J,YAItG8jB,GAAiB8C,mBAAqB,GAAInD,GAC1CK,EAAiBkO,wBAA0B,GAAIuD,KAC/CzR,EAAiB6C,cAAiBvvB,KAAK,EAAGiY,SAAS,EAAOud,UAAU,EAAGtB,sBACvExH,EAAiB2F,cACjB3F,EAAiB2O,QAAU,IAC3B3O,EAAiBqP,oBAAsB,EACvCrP,EAAiBoB,UAAa9Y,SAAW/S,QACzCyqB,EAAiByC,aAAgB/wB,WAAY,GAAIovB,OAAQ,GAAI/f,OAAM,IAAIoB,KAAK,IAAK0e,MAAO,GAAI6B,cAAe,IAC3G1C,EAAiBY,aAAgBwO,UAAYtO,OAAQ,GAAI/f,OAAM,IAAIoB,KAAK,QAE3DiG,KAAAA,4FAEL,GAAIspB,GAAYtpB,EAAaupB,KAAKC,KAAK,SAAAryB,GAAA,MAAKA,GAAEqjB,MAQ9C,OAPI8O,IACAA,EAAUtrB,QACVsrB,EAAU9O,MAAO,IAEjB8O,EAAYliC,SAASM,cAAc,SACnC4hC,EAAU/sB,YAAc,aAErB+sB,gCAGEppB,GACT,MAAOF,GAAaupB,KAAKlzB,KAAK,SAAAc,GAAA,MAAKA,KAAM+I,mCAIzC,GAAMupB,GAAW,SAAAr9B,GACb,IAAK,GAAIP,GAAI,EAAGA,EAAIO,EAAKP,IAAK,CAC1B,GAAIqU,GAAQ9Y,SAASM,cAAc,QACnCwY,GAAM3D,YAAc,YACpB2D,EAAMsa,MAAO,EACbta,EAAMtL,MAAO,EACbsL,EAAMwpB,OACN1pB,EAAaupB,KAAK5gB,KAAKzI,IAG/B,IAAIF,EAAaupB,KAAK9iC,OAAQ,CAC1B,GAAMkjC,GAAY3pB,EAAaupB,KAAK/gB,OAAO,SAACyR,EAAKC,GAAN,MAAcD,IAAOC,GAAOA,EAAIM,KAAO,EAAI,IAAI,EACtFmP,GAAY,IACZF,EAAS,QAGbA,GAAS,aAIrBzpB,GAAaupB,+HClwFb,IAAMK,GAAS,wDACAA,CAEf,IAAMC,GAAU,UACRA,QAAAA,qICER,QAASC,GAAeC,GAEpB,MADAA,GAAA,EAAc5X,KAAK2F,MACZ,IAAMvV,OAAOC,KAAKunB,GAAQtK,IAAI,SAAA3rB,GAC7B,GAAMk2B,GAAMD,EAAOj2B,EACnB,OAAIk2B,GACOnT,mBAAmB/iB,GAAO,IAAM+iB,mBAAmBmT,GAGnD,KAEZxiB,KAAK,KAGT,QAASsK,GAAiBhmB,GAC7B,MAAO,IAAI9E,SAAQ,SAACC,EAASC,GACzB,GAAM8U,GAAM,GAAIiuB,eAChBjuB,GAAIkuB,KAAK,MAAOp+B,GAAK,GAErBkQ,EAAIzO,OAAS,WACT,IACI,MAAuB,KAAnByO,EAAImuB,YAAoBnuB,EAAI7J,QAAU,KAAO6J,EAAI7J,QAAU,IACpDjL,EAAAA,qBAA4B8U,EAAImuB,WAAhC,aAAuDnuB,EAAI7J,QAG3DlL,EAAQ+U,GAErB,MAAO1I,GACLpM,EAAOoM,KAIf0I,EAAIS,QAAUvV,EACd8U,EAAI7K,SAIL,QAASE,GAAQvF,EAAK3F,EAAMikC,EAAYz4B,GAC3C,MAAO,IAAI3K,SAAQ,SAACC,EAASC,GACzB,GAAM8U,GAAM,GAAIiuB,eAChBjuB,GAAIquB,UAAY,WACZ54B,QAAQC,IAAI5F,EAAM,cAEtBkQ,EAAIsuB,mBAAqB,WACrB,OAAOtuB,EAAImuB,YACP,IAAK,GACD,MAAInuB,GAAI7J,QAAU,KAAO6J,EAAI7J,OAAS,KAAsB,KAAd6J,EAAI7J,OACvClL,EAAQ+U,GAGR9U,EAAAA,qBAA4B8U,EAAImuB,WAAhC,aAAuDnuB,EAAI7J,UAKlF6J,EAAIkuB,KAAK,OAAQp+B,GAAK,GACtBkQ,EAAIuuB,iBAAkB,EACtB54B,IAAYqK,EAAIrK,QAAUA,GAC1By4B,GAAcpuB,EAAIwE,iBAAiB,WAAY4pB,GAAY,GAC3DpuB,EAAIwuB,iBAAiB,eAAgB,qCACrCxuB,EAAI7K,KAAKhL,GACT6V,EAAIS,QAAUvV,IAIf,QAASiW,GAAQrR,EAAK1F,EAAMgkC,GAA6B,GAAlBK,KAAkBjkC,UAAAC,OAAA,GAAAC,SAAAF,UAAA,KAAAA,UAAA,EAC5D,OAAO,IAAIQ,SAAQ,SAACC,EAASC,GAEzB,GAAM8U,GAAM,GAAIiuB,eAChBjuB,GAAIquB,UAAY,WAEZ,GADA54B,QAAQC,IAAI5F,EAAM,aACf2+B,EAAW,MAAOvjC,GAAO,iBAEhC8U,EAAIzO,OAAS,WACT,IACI,MAAuB,KAAnByO,EAAImuB,YAAoBnuB,EAAI7J,QAAU,KAAO6J,EAAI7J,QAAU,IACpDjL,EAAAA,qBAA4B8U,EAAImuB,WAAhC,aAAuDnuB,EAAI7J,QAG3DlL,EAAQ+U,GAErB,MAAO1I,GACL,MAAOpM,GAAOoM,KAGtB0I,EAAIkuB,KAAK,MAAOp+B,GAAK,GACrBkQ,EAAI0uB,aAAetkC,EACnBgkC,GAAcpuB,EAAIwE,iBAAiB,WAAY4pB,GAAY,GAC3DK,IAAczuB,EAAIrK,QAAU,KAC5BqK,EAAIS,QAAUvV,EACd8U,EAAI7K,SAIL,QAASw5B,GAAQ7+B,EAAKs+B,GACzB,MAAOjtB,GAAQrR,EAAK,GAAIs+B,GAAW,GAAO97B,KAAK,SAAA0N,GAC3C,MAAOhL,MAAKkB,MAAM8J,EAAIG,YAIvB,QAASyuB,GAAoB9+B,GAChC,MAAO6+B,GAAQE,EAAKC,iBAAmBhB,GAAgBh+B,IAAAA,KAClDwC,KAAK,SAAAy8B,GACF,MAAiB,OAAbA,EAAK33B,KACE23B,EAAK1U,OAGLrvB,QAAQE,OAAO6jC,EAAK13B,WAKpC,QAAS23B,GAAQr6B,EAAMy5B,GAC1B,GAAIt+B,GAAM++B,EAAKG,QAAU,SAAWr6B,CAOpC,OANyB,MAAtBxI,UAAUmM,SAAmBnM,UAAUuf,QAEb,MAAtBvf,UAAUmM,SAAmBnM,UAAUuf,SACtC5b,EAAMe,EAAAA,WAAMo+B,sBAAsBt6B,IAGnCg6B,EAAQ7+B,EAAKs+B,GACf97B,KAAK,SAAAy8B,GACF,MAAiB,OAAbA,EAAK33B,KACE23B,EAAK1U,OAEe,MAAtBluB,UAAUmM,QACRy2B,EAGA/jC,QAAQE,OAAO6jC,EAAK13B,WAKpC,QAAS63B,GAAYv6B,EAAMy5B,GAC9B,GAAIt+B,GAA4D++B,EAAKK,YAAc,SAAWv6B,CAI9F,OAHyB,MAAtBxI,UAAUmM,SAAmBnM,UAAUuf,SACtC5b,EAAMe,EAAAA,WAAMo+B,sBAAsBt6B,IAE/Bg6B,EAAQ7+B,EAAKs+B,GACf97B,KAAK,SAAAy8B,GACF,MAAiB,OAAbA,EAAK33B,KACE23B,EAAK1U,OAEe,MAAtBluB,UAAUmM,QACRy2B,EAGA/jC,QAAQE,OAAO6jC,EAAK13B,WAKpC,QAAS83B,GAAax6B,EAAMy5B,GAC/B,GAAIt+B,GAA4D++B,EAAKM,aAAe,SAAWx6B,CAI/F,OAHyB,MAAtBxI,UAAUmM,SAAmBnM,UAAUuf,SACtC5b,EAAMe,EAAAA,WAAMo+B,sBAAsBt6B,IAE/Bg6B,EAAQ7+B,EAAKs+B,GACf97B,KAAK,SAAAy8B,GACF,MAAiB,OAAbA,EAAK33B,KACE23B,EAAK1U,OAEe,MAAtBluB,UAAUmM,QACRy2B,EAGA/jC,QAAQE,OAAO6jC,EAAK13B,WAKpC,QAASuvB,GAAgB92B,EAAK1F,GACjC,MAAa,QAATA,EACOY,QAAQC,QAAQ,KACP,UAATb,EACAY,QAAQC,QAAQ,KADpB,0DAjKK6qB,iBAAAA,IAuBAzgB,QAAAA,IA4BA8L,QAAAA,IA6BAwtB,QAAAA,IAMAC,oBAAAA,IAYAI,QAAAA,IAsBAE,YAAAA,IAmBAC,aAAAA,IAmBAvI,gBAAAA,CApLhB,IAAA94B,GAAAjF,EAAA,kBAEMgmC,GACFG,QAAU,yDACVE,YAAa,yDACbC,aAAc,6DACdL,iBAAiB,mNCHrB,GAAAlmC,GAAAC,EAAA,iBACAC,GAAAA,WAAQC,QAINC,KAAM,4DACNC,OAAQH,EAAAA,WAAQsmC,gBAMhBC,QAAS,SAAUC,2JCZrB,GAAA1mC,GAAAC,EAAA,iBACAC,GAAAA,WAAQC,QAINC,KAAM,uDACNC,OAAQH,EAAAA,WAAQsmC,gBAMhBC,QAAS,SAAUC,GAGlBlmC,KAAKmmC,OAAOC,cAAe,GAAI3qC,eAAc4qC,MAAMC,MAAMC,kKCd5D,GAAA/mC,GAAAC,EAAA,iBACAC,GAAAA,WAAQC,QAINC,KAAM,sDACNC,OAAQH,EAAAA,WAAQsmC,gBAMhBC,QAAS,SAAUC,GAGlBlmC,KAAKmmC,OAAOK,iBAAkB,GAAI/qC,eAAcgrC,KAAKC,SAASC,iKCfjE,GAAAnnC,GAAAC,EAAA,iBACAC,GAAAA,WAAQC,QAINC,KAAM,kDACNC,OAAQH,EAAAA,WAAQknC,eAMhBC,uBAAwB,WAGvB7mC,KAAK8mC,cAAerrC,cAAc0E,WAAWC,QAAQ2mC,0BAGrD/mC,KAAK8mC,cAAerrC,cAAc0E,WAAWC,QAAQ4mC,qBAGrDhnC,KAAK8mC,cAAerrC,cAAc0E,WAAWC,QAAQ6mC,mFChBxDxnC,GAAA,kBACAA,EAAA,qBACAA,EAAA,0BACAA,EAAA,oDACAA,EAAA,+CACAA,EAAA,8CACAA,EAAA,0CACAA,EAAA,+BACAA,EAAA,6BACAA,EAAA,oCACAuC,SAASoZ,iBAAiB,mBAAoB,WAE1C4Y,EAAOhuB,MAAQxK,OAAO0rC,YAAcllC,SAASmlC,gBAAgBzkC,aAAeV,SAASC,KAAKS,YAC1FsxB,EAAO7tB,OAAS3K,OAAO4rC,aAAeplC,SAASmlC,gBAAgBxkC,cAAgBX,SAASC,KAAKU,aAE7FlH,cAAckF,kBAAkBJ,YAAY9E,cAAckF,kBAAkBC,MAAMb,UAClFsM,QAAQC,IAAI,48BCrBhB9M,EAAAC,EAAA,kBACAiF,EAAAjF,EAAA,gCACA+I,EAAA/I,EAAA,oBACAkJ,EAAAlJ,EAAA,mCACA4nC,EAAA5nC,EAAA,uCACAgJ,EAAAhJ,EAAA,oCAAYiJ,OACZoZ,EAAAriB,EAAA,qCACA6nC,EAAA7nC,EAAA,oCACA8nC,EAAA9nC,EAAA,gCACA+nC,EAAA/nC,EAAA,4BACAgoC,EAAAhoC,EAAA,eAEAC,GAAAA,WAAQC,QAINC,KAAM,uCACNC,OAAQH,EAAAA,WAAQgoC,QAKVC,iBAAkB,SAASC,GAC1B,GAA6B,eAAzBA,EAAGC,cAAcn5B,IAArB,CACG,GAAIT,GAAUrC,KAAKkB,MAAM86B,EAAGC,cAAcC,SACrC75B,IAIkB,QAAnBA,EAAQ7N,SAAmBsY,MAAMzK,EAAQlN,QAEjDgnC,YAAa,WAClB/nC,KAAKgoC,UAAYhoC,KAAKgoC,SAAS1D,OACtBtkC,KAAKioC,YAAcjoC,KAAKioC,WAAW5qB,QAAQ,SAAAtY,GAAA,MAAKA,IAAKA,EAAEgc,WAEnD/gB,KAAKkoC,cAAe,EACpBloC,KAAKmoC,WAAY,EACdnoC,KAAKooC,iBAAgBpoC,KAAKooC,eAAeC,MAAQ,IAGlEC,WAAY,WACFtoC,KAAKgoC,UAAYhoC,KAAKgoC,SAASpvB,QAC/B5Y,KAAKioC,YAAcjoC,KAAKioC,WAAW5qB,QAAQ,SAAAtY,GAAA,MAAKA,IAAKA,EAAE6T,UAEnD5Y,KAAKkoC,cAAe,EACpBloC,KAAKmoC,WAAY,EACdnoC,KAAKooC,iBAAgBpoC,KAAKooC,eAAeC,MAAQ,IAYlEE,gBAAiB,WAChBvoC,KAAKwoC,aACLxoC,KAAKwoC,UAAUC,SAAW,KAC1BzoC,KAAKwoC,UAAUE,SAAW,KAC1B1oC,KAAKwoC,UAAUG,aAAe,KAC9B3oC,KAAKwoC,UAAUI,UAAY,KAC3B5oC,KAAKwoC,UAAUK,KAAO,KACtB7oC,KAAKwoC,UAAUM,SAAW,KAC1B9oC,KAAKwoC,UAAUO,KAAO,OACtB/oC,KAAKwoC,UAAUl3B,KAAO,OACtBtR,KAAKwoC,UAAUQ,SAAW,OAC1BhpC,KAAKwoC,UAAUS,SAAW,OAC1BjpC,KAAKwoC,UAAUU,WAAa,OAC5BlpC,KAAKwoC,UAAUW,SAAW,KAC1BnpC,KAAKwoC,UAAUY,cAAgB,OAC/BppC,KAAKwoC,UAAUa,eAAiB,OAChCrpC,KAAKwoC,UAAUc,aAAe,KAC9BtpC,KAAKwoC,UAAUe,aAAe,OAC9BvpC,KAAKwoC,UAAUgB,aAAe,OAC9BxpC,KAAKwoC,UAAUiB,WAAa,OAC5BzpC,KAAKwoC,UAAUkB,YAAc,OAC7B1pC,KAAKwoC,UAAUmB,OAAS,IACxB3pC,KAAKwoC,UAAUoB,QAAU,IACzB5pC,KAAKwoC,UAAUqB,WAAa,OAC5B7pC,KAAKwoC,UAAUsB,SAAW,OAC1B9pC,KAAKwoC,UAAUtnB,KAAO,KACtBlhB,KAAK+pC,cAAgB,2BAClB,kBACS,mBACA,mBACG,qBACZ,+BACS,6BACG,sBACZ,cACH/pC,KAAKgqC,eAAiB,EACtBhqC,KAAKiqC,aAAc;AACnBjqC,KAAKioC,cACLjoC,KAAKkqC,gBACLlqC,KAAKmqC,aACLnqC,KAAKoqC,aACIpqC,KAAKqqC,gBACdrqC,KAAKsqC,aAAc,EACVtqC,KAAKuqC,WAAY,EACjBvqC,KAAKwqC,WAAY,EAC1BxqC,KAAKyqC,iBACLzqC,KAAK0qC,iBAAmBC,UAAW,EAAGC,gBAAkBC,aACxD7qC,KAAK8qC,iBACL9qC,KAAK+qC,YACL/qC,KAAKmoC,WAAY,EACjBnoC,KAAKkoC,cAAe,EACpBloC,KAAKgrC,cAAe,EACpBhrC,KAAKirC,eAAgB,EACrBjrC,KAAKkrC,cAAgB,EACrBlrC,KAAKmrC,cAAgB,EACrBnrC,KAAKorC,iBACLprC,KAAKqrC,aAAe,KACpBrrC,KAAKsrC,iBACLtrC,KAAKurC,eACLvrC,KAAKwrC,aACLxrC,KAAKyrC,eAAiB1oC,UAAUkK,IAChCjN,KAAK0rC,gBAAkB3oC,UAAUkK,IACjCjN,KAAK2rC,kBAAmB,EACxB3rC,KAAK4rC,YAAc7oC,UAAUkK,IAC7BjN,KAAK6rC,sBAAwB,KAC7B7rC,KAAK8rC,gBAAkB,KACvB9rC,KAAK+rC,UAAW,EAChB/rC,KAAKgsC,eAAgB,EACrBhsC,KAAKisC,wBAAyB,EAC9BjsC,KAAKksC,sBACLlsC,KAAKmsC,aAAc,EACnBnsC,KAAKosC,cAAe,EACpBpsC,KAAKqsC,eAAgB,EACrBrsC,KAAKssC,cAAgBC,MAAM,EAAEj8B,SAAS,EAAEC,MAAM,EAAEf,MAAK,EAAMunB,SAAS,MACpE/2B,KAAKwsC,aAAe,KACpBxsC,KAAKysC,aAAc,EACnBzsC,KAAK0sC,cAAe,EACpB1sC,KAAK2sC,oBACL3sC,KAAK4sC,wBACI5sC,KAAK6sC,uBACL7sC,KAAK8sC,WAAa,KAClB9sC,KAAK+sC,kBAAmB,EACxB/sC,KAAKgtC,cAAe,EACpBhtC,KAAKitC,MAAQ,KACbjtC,KAAKktC,wBAAyB,EAC9BltC,KAAKmtC,eAAiB,KACtBntC,KAAKotC,gBAAkB,EACvBptC,KAAKqtC,WAAY,EACvBrtC,KAAKstC,eACKC,EAAAA,WAASC,aACTD,EAAAA,WAASE,YAAYvkC,KAAK,SAACC,GAAOkD,QAAQC,IAAI,YAAcnD,MAEzEukC,SAAS90B,MAAQ5Y,KAAKsoC,WAAWqF,KAAK3tC,MACtC0tC,SAAS3sB,OAAS/gB,KAAK+nC,YAAY4F,KAAK3tC,MACxC0tC,SAASE,qBAAuBpa,EAAAA,WAAWoa,qBAAqBD,KAAhCna,EAAAA,YAChCka,SAASG,mBAAqBra,EAAAA,WAAWqa,mBAAmBF,KAA9Bna,EAAAA,YACrBnS,aAAaysB,cAAgB9tC,KAAK8tC,cAAcH,KAAK3tC,MACrDqhB,aAAa0sB,sBAAwB/tC,KAAK+tC,sBAAsBJ,KAAK3tC,MACrEqhB,aAAa2sB,QAAUhuC,KAAKguC,QAAQL,KAAK3tC,MACzCqhB,aAAa4sB,qBAAuBjuC,KAAKiuC,qBAAqBN,KAAK3tC,MACnEqhB,aAAa6sB,SAAWluC,KAAKmuC,kBAAkBR,KAAK3tC,MACpDqhB,aAAa+sB,WAAapuC,KAAKquC,oBAAoBV,KAAK3tC,MAEjEyH,EAAAA,WAAM6mC,gBAAgBplC,KAAK,WAAKzB,EAAAA,WAAM8mC,mBAAoB,WAAK9mC,EAAAA,WAAM8mC,oBACrE9mC,EAAAA,WAAM+mC,iBACNxuC,KAAKM,iBAAiB7E,cAAcC,aAAaiB,yBAM5C0xC,oBAAoB,SAAUI,GACC,OAAxBzuC,KAAKmtC,gBACJntC,KAAKmtC,eAAesB,IAI5BN,kBAAkB,WACXnuC,KAAK0uC,YAAYC,UAChB3uC,KAAK0uC,YAAYC,SAAU,GAE/B3uC,KAAKmK,QAAQykC,YAAc5uC,KAAK6uC,iCAChC7uC,KAAK8uC,UAAUH,SAAU,EAClC3uC,KAAK+uC,UACI/uC,KAAK8uC,UAAUH,SAAU,EAClC3uC,KAAKkuC,YAIND,qBAAqB,SAAUhd,GAC9B,GAAM+d,GAAehvC,KAAKivC,aAAejvC,KAAKivC,WAAWtV,aAAe35B,KAAKivC,WAAWtV,aAAe35B,KAAKivC,WAAW1jC,KACvHvL,MAAKksC,mBAAmB3oB,KAAM0N,EAAO1lB,KAAO0lB,EAAO1lB,KAAO0lB,GAC9C+d,KAAkB/d,EAAO1lB,KAAO0lB,EAAO1lB,KAAO0lB,KAE7CjxB,KAAKisC,wBAAyB,IAI5C8B,sBAAuB,SAAU9c,EAAQie,GAC/BlvC,KAAK6rC,uBAAyB7rC,KAAK6rC,sBAAsB5a,EAAQie,IAGrEC,wBAAwB,SAAU5jC,GAC9B,IAAI,GAAI9E,GAAG,EAAEA,EAAIzG,KAAKksC,mBAAmB7qC,OAAOoF,IACzC8E,IAASvL,KAAKksC,mBAAmBzlC,IACnCzG,KAAKksC,mBAAmBntB,OAAOtY,EAAE,IAK1CunC,QAAS,SAAU/c,GACxBjxB,KAAK8rC,iBAAmB9rC,KAAK8rC,gBAAgB7a,GAC7CjxB,KAAK8rC,gBAAkB,MAGxBsD,sBAAuB,SAAUnlC,GAAiB,GAARjJ,GAAQI,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAH,EAC/BiuC,EAAU,SAAC3oC,EAAKsF,GAClB,MAAOtD,GAAIuD,QAAQvF,EAAKsF,GAAG9C,KAAK,SAAAgD,GAC5B,GAA+B,IAA3BA,EAAGU,aAAavL,OAChB,MAAOO,SAAQC,SAAQ,EAG3B,IAAIgL,GAAUjB,KAAKkB,MAAMZ,EAAGU,aAC5B,OAAwB,QAArB7J,UAAU+L,OACc,MAAnBjC,EAAQE,OACDnL,QAAQC,QAAQgL,EAAQ9L,KAAKuuC,aAAerlC,GAAqC,KAAzB4C,EAAQ9L,KAAKwuC,UACpD,MAAnB1iC,EAAQE,OACNnL,QAAQC,SAAQ,GACjB,MAAnBgL,EAAQE,OACYnL,QAAQC,SAAQ,GACjB,MAAnBgL,EAAQE,OACYnL,QAAQC,SAAQ,GAEhBD,QAAQC,SAAQ,GAGJ,IAAnBgL,EAAQE,OACDnL,QAAQC,QAAQgL,EAAQ9L,KAAKuuC,aAAerlC,GAAqC,KAAzB4C,EAAQ9L,KAAKwuC,UAEpD,MAAnB1iC,EAAQE,OACNnL,QAAQC,SAAQ,GAGhBD,QAAQC,SAAQ,IAIhC,SAAAsK,GACC,MAAOvK,SAAQC,SAAQ,MAG3B6E,EAAM,0EAA4E3D,UAAU+L,OAAS,MAAQ/L,UAAU4M,EAAG,gBAAkB5M,UAAUstB,YACtJtvB,EAAO,KAAO0wB,mBAAmBhqB,EAAAA,WAAM+pB,WAAWzuB,UAAUoK,EAAG,IACzE,UAAYskB,mBAAmBhqB,EAAAA,WAAM+pB,WAAWzuB,UAAUmK,MAAO,IACjE,eAAiBukB,mBAAmBhqB,EAAAA,WAAM+pB,WAAWvnB,EAAU,GACzD,OAAwB,QAArBlH,UAAU+L,OACS,KAAlB/L,UAAUkK,IACCjN,KAAKwvC,qBAAqBtmC,KAAK,WACpD,MAAqB,KAAlBnG,UAAUkK,IAEgBrL,QAAQC,SAAQ,IAEvB6E,EAAM,sDACN3F,EAAO,QAAU0wB,mBAAmBhqB,EAAAA,WAAM+pB,WAAWxwB,EAAM,IACrD,eAAiBywB,mBAAmBhqB,EAAAA,WAAM+pB,WAAWvnB,EAAU,IAC9DolC,EAAQ3oC,EAAK3F,OAI5B2F,EAAM,sDACN3F,EAAO,QAAU0wB,mBAAmBhqB,EAAAA,WAAM+pB,WAAWxwB,EAAM,IACrD,eAAiBywB,mBAAmBhqB,EAAAA,WAAM+pB,WAAWvnB,EAAU,IAC9DolC,EAAQ3oC,EAAK3F,IAGjBsuC,EAAQ3oC,EAAK3F,IAIlC0uC,UAAW,SAAU/oC,EAAK1F,EAAM0N,EAAKokB,GACpC,MAAOpuB,GAAA8tB,iBAAiBwI,aAAat0B,EAAK1F,EAAM0N,EAAKokB,IAGtD4c,SAAU,SAAUhhC,EAAKhI,EAAKwsB,GAC7BlzB,KAAK2vC,cAAcj8B,KAAK8F,MAAMk2B,SAAShhC,EAAKhI,GAAO,KAAMwsB,IAG1D0c,YAAa,SAAUlpC,EAAK+yB,GAAK,GAAA7zB,GAAA5F,IAChC,OAAO,IAAI4B,SAAQ,SAACC,EAAUC,GAC7B,GAAMf,GAAO,GAAIiH,MACjBjH,GAAKmH,IAAMxB,EACX3F,EAAKoH,OAAS,SAAA+F,GACRtI,EAAK+pC,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAcob,KACrD7zB,EAAK+pC,cAAcj8B,KAAK8F,MAAMk2B,SAASjW,EAAK/yB,EAAKwH,EAAEnI,QACnDlE,MAGFd,EAAKsW,QAAUtW,EAAKoa,QAAU,SAAAjN,GAAA,MAAKpM,GAAOoM,OAK5C2hC,cAAe,SAAUn8B,GAAM,GAAA9C,GAAA5Q,IAC9BA,MAAK8vC,UAAYp8B,CAEjB,IAAMgnB,KAaN,OAZI16B,MAAK8vC,UAAUC,UAAY/vC,KAAK8vC,UAAUC,SAASpK,OACtDjL,EAASnX,KAAKvjB,KAAKgwC,4BACnBtV,EAASnX,KAAKvjB,KAAKiwC,6BACnBvV,EAASnX,KAAKvjB,KAAKkwC,2BACnBxV,EAASnX,KAAKvjB,KAAKmwC,6BACnBzV,EAASnX,KAAKvjB,KAAKowC,+BACnB1V,EAASnX,KAAKvjB,KAAKqwC,+BACnB3V,EAASnX,KAAKvjB,KAAKswC,6BACnB5V,EAASnX,KAAKvjB,KAAKuwC,+BACnB7V,EAASnX,KAAKvjB,KAAKwwC,6BACnB9V,EAASnX,KAAKvjB,KAAKywC,6BAEb7uC,QAAQm5B,IAAIL,GAAUxxB,KAAK,WAKhC,MAAOtH,SAAQC,YAEdqH,KAAK,WAgBP,GAdAwxB,EAASr5B,OAAS,EAGNqvC,EAAAA,WAAU5oC,WAAa8I,EAAK++B,cAAcj8B,KAAKpC,KAAK4hB,MAAMwd,EAAAA,WAAUrrC,WAAYqrC,EAAAA,WAAU5oC,WAGlG8I,EAAKk/B,UAAUa,MAAQ//B,EAAKk/B,UAAUa,KAAKzsC,YAAc0M,EAAKk/B,UAAUa,KAAKzsC,WAAWwC,KAC3Fg0B,EAASnX,KAAK3S,EAAK6+B,UAAU7+B,EAAKk/B,UAAUa,KAAKzsC,WAAWwC,IAAK,QAI9DkK,EAAKk/B,UAAUc,MAAM1sC,YAAc0M,EAAKk/B,UAAUc,MAAM1sC,WAAWwC,KACtEg0B,EAASnX,KAAK3S,EAAK6+B,UAAU7+B,EAAKk/B,UAAUc,MAAM1sC,WAAWwC,IAAK,QAE/DkK,EAAKk/B,UAAUc,MAAMvd,OAASziB,EAAKk/B,UAAUc,MAAMvd,MAAM3sB,IAAK,CAClD,GAAIA,GAAMkK,EAAKk/B,UAAUc,MAAMvd,MAAM3sB,GACpDg0B,GAASnX,KAAK3S,EAAK6+B,UAAU/oC,EAAK,UAInC,GAAMmqC,GAAiB,SAACC,GACuB,kBAA1C3zB,OAAOb,UAAU7R,SAASumB,KAAK8f,IAClCA,EAAOzzB,QAAQ,SAAAnP,GACdA,EAAE4iC,OAAOzzB,QAAQ,SAAA0zB,GACM,cAAlBA,EAAS/vC,MAAwB+vC,EAAS1kB,OAAOgH,MAAM3sB,IAC1Dg0B,EAASnX,KAAK3S,EAAK6+B,UAAUsB,EAAS1kB,OAAOgH,MAAM3sB,IAAK,UAE9B,cAAlBqqC,EAAS/vC,MACjB+vC,EAAS1kB,OAAOiH,OAAOjW,QAAQ,SAAAhE,GAAUA,GAAsB,WAAbA,EAAM3S,KAAoBg0B,EAASnX,KAAK3S,EAAK6+B,UAAUp2B,EAAM3S,IAAK,gBAMzH,KAAK,GAAIuN,KAAKrD,GAAKk/B,UAAUkB,QACb,GAAuC,UAAnCpgC,EAAKk/B,UAAUkB,QAAQ/8B,GAAGjT,KAA9B,CAIA,GAAMkD,GAAa0M,EAAKk/B,UAAUkB,QAAQ/8B,GAAGzQ,QAAQU,WAC9DmV,EAAQzI,EAAKk/B,UAAUkB,QAAQ/8B,GAAGzQ,QAAQ6V,KAC3CnV,KAGDA,EAAWwC,KACdg0B,EAASnX,KAAK3S,EAAK6+B,UAAUvrC,EAAWwC,IAAK,QAE1CxC,EAAW66B,QAAU76B,EAAW66B,OAAOr4B,KAC1Cg0B,EAASnX,KAAK3S,EAAK6+B,UAAUvrC,EAAW66B,OAAOr4B,IAAK,QAGjDxC,EAAW86B,QAAU96B,EAAW86B,OAAOt4B,KAC1Cg0B,EAASnX,KAAK3S,EAAK6+B,UAAUvrC,EAAW86B,OAAOt4B,IAAK,QAEjDxC,EAAWsa,UAAYta,EAAWsa,SAAS9X,KAC9Cg0B,EAASnX,KAAK3S,EAAK6+B,UAAUvrC,EAAWsa,SAAS9X,IAAK,QAGnD2S,GAASA,EAAM3S,KAClBg0B,EAASnX,KAAK3S,EAAK6+B,UAAUp2B,EAAM3S,IAAK,UAEzCmqC,EAAejgC,EAAKk/B,UAAUkB,QAAQ/8B,GAAG68B,QACzClgC,EAAKk/B,UAAUkB,QAAQ/8B,GAAGg9B,SAAS5zB,QAAQ,SAAA6zB,GAAUL,EAAeK,EAAMJ,eA1BvDD,GAAejgC,EAAKk/B,UAAUkB,QAAQ/8B,GAAG68B,OA4B7D,OAAOlvC,SAAQm5B,IAAIL,GAAUxxB,KAAK,WAClB,MAAOtH,SAAQC,WAE5B,SAAAqM,GAAA,MAAKtM,SAAQE,OAAOoM,QAIzB8hC,yBAAyB,WACxB,GAAMtV,MAD8ByW,EAEkCnxC,KAAK8vC,UAAUC,SAASpK,KAAKiL,MAA5FQ,EAF6BD,EAE7BC,eAAgBxI,EAFauI,EAEbvI,UAAWH,EAFE0I,EAEF1I,SAAUE,EAFRwI,EAEQxI,aAAcD,EAFtByI,EAEsBzI,QA6B1D,OA3BI0I,GAAeltC,WAAWwC,KAAO0qC,EAAeltC,WAAWwC,KAC9Dg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU2B,EAAeltC,WAAWwC,IAAK,QAEzDkiC,EAAU7J,OAAO76B,WAAWwC,KAAOkiC,EAAU7J,OAAO76B,WAAWwC,KAClEg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU7G,EAAU7J,OAAO76B,WAAWwC,IAAK,QAE3DkiC,EAAU5J,OAAO96B,WAAWwC,KAAOkiC,EAAU5J,OAAO96B,WAAWwC,KAClEg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU7G,EAAU5J,OAAO96B,WAAWwC,IAAK,QAE3D+hC,EAAS1J,OAAO76B,WAAWwC,KAAO+hC,EAAS1J,OAAO76B,WAAWwC,KAChEg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUhH,EAAS1J,OAAO76B,WAAWwC,IAAK,QAE1D+hC,EAASzJ,OAAO96B,WAAWwC,KAAO+hC,EAASzJ,OAAO96B,WAAWwC,KAChEg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUhH,EAASzJ,OAAO96B,WAAWwC,IAAK,QAE1DiiC,EAAa5J,OAAO76B,WAAWwC,KAAOiiC,EAAa5J,OAAO76B,WAAWwC,KACxEg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU9G,EAAa5J,OAAO76B,WAAWwC,IAAK,QAE9DiiC,EAAa3J,OAAO96B,WAAWwC,KAAOiiC,EAAa3J,OAAO96B,WAAWwC,KACxEg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU9G,EAAa3J,OAAO96B,WAAWwC,IAAK,QAE9DgiC,EAAS3J,OAAO76B,WAAWwC,KAAOgiC,EAAS3J,OAAO76B,WAAWwC,KAChEg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU/G,EAAS3J,OAAO76B,WAAWwC,IAAK,QAE1DgiC,EAAS1J,OAAO96B,WAAWwC,KAAOgiC,EAAS1J,OAAO96B,WAAWwC,KAChEg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU/G,EAAS1J,OAAO96B,WAAWwC,IAAK,QAEvD9E,QAAQm5B,IAAIL,IAGpBuV,0BAA0B,WACzB,GAAMvV,MAD+B2W,EAEiBrxC,KAAK8vC,UAAUC,SAASpK,KAAK2L,OAA5EptC,EAF8BmtC,EAE9BntC,WAAYqtC,EAFkBF,EAElBE,gBAAiBH,EAFCC,EAEDD,cAWpC,OATIltC,IAAcA,EAAWwC,KAC5Bg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUvrC,EAAWwC,IAAK,QAE1C6qC,EAAgBrtC,WAAWwC,KAAO6qC,EAAgBrtC,WAAWwC,KAChEg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU8B,EAAgBrtC,WAAWwC,IAAK,QAE1D0qC,EAAeltC,WAAWwC,KAAO0qC,EAAeltC,WAAWwC,KAC9Dg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU2B,EAAeltC,WAAWwC,IAAK,QAEtD9E,QAAQm5B,IAAIL,IAGpBwV,wBAAwB,WACvB,GAAMxV,MAD6B8W,EAEVxxC,KAAK8vC,UAAUC,SAASpK,KAAKkD,KAA/C9J,EAF4ByS,EAE5BzS,OAAQC,EAFoBwS,EAEpBxS,MAOf,OANID,GAAO76B,YAAc66B,EAAO76B,WAAWwC,KAC1Cg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU1Q,EAAO76B,WAAWwC,IAAK,QAEjDs4B,EAAO96B,YAAc86B,EAAO96B,WAAWwC,KAC1Cg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUzQ,EAAO96B,WAAWwC,IAAK,QAE9C9E,QAAQm5B,IAAIL,IAGpByV,0BAA2B,WAC1B,GAAKnwC,KAAK8vC,UAAUC,SAASpK,KAAK8L,WAAlC,CAES,GAAM/W,MAHuBgX,EAIJ1xC,KAAK8vC,UAAUC,SAASpK,KAAK8L,WAA/C1S,EAJsB2S,EAItB3S,OAAQC,EAJc0S,EAId1S,MAOf,OANID,GAAO76B,YAAc66B,EAAO76B,WAAWwC,KACvCg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU1Q,EAAO76B,WAAWwC,IAAK,QAEpDs4B,EAAO96B,YAAc86B,EAAO96B,WAAWwC,KACvCg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUzQ,EAAO96B,WAAWwC,IAAK,QAEjD9E,QAAQm5B,IAAIL,KAG7B0V,4BAA4B,WAC3B,GAAM1V,MADiCiX,EAEsC3xC,KAAK8vC,UAAUC,SAASpK,KAAKmD,SAAnG5kC,EAFgCytC,EAEhCztC,WAAY0tC,EAFoBD,EAEpBC,OAAQ7I,EAFY4I,EAEZ5I,KAAMz3B,EAFMqgC,EAENrgC,KAAM03B,EAFA2I,EAEA3I,SAAUC,EAFV0I,EAEU1I,SAAUE,EAFpBwI,EAEoBxI,SAAUjoB,EAF9BywB,EAE8BzwB,IA4CrE,OA1CIhd,GAAWwC,KAAOxC,EAAWwC,KAChCg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUvrC,EAAWwC,IAAK,QAE1CkrC,EAAO1tC,YAAc0tC,EAAO1tC,WAAWwC,KAC1Cg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUmC,EAAO1tC,WAAWwC,IAAK,QAEjDqiC,EAAKhK,OAAO76B,YAAc6kC,EAAKhK,OAAO76B,WAAWwC,KACpDg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU1G,EAAKhK,OAAO76B,WAAWwC,IAAK,QAEtDqiC,EAAK/J,OAAO96B,YAAc6kC,EAAK/J,OAAO96B,WAAWwC,KACpDg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU1G,EAAK/J,OAAO96B,WAAWwC,IAAK,QAEtD4K,EAAKytB,OAAO76B,YAAcoN,EAAKytB,OAAO76B,WAAWwC,KACpDg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUn+B,EAAKytB,OAAO76B,WAAWwC,IAAK,QAEtD4K,EAAK0tB,OAAO96B,YAAcoN,EAAK0tB,OAAO96B,WAAWwC,KACpDg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUn+B,EAAK0tB,OAAO96B,WAAWwC,IAAK,QAEtDsiC,EAASjK,OAAO76B,YAAc8kC,EAASjK,OAAO76B,WAAWwC,KAC5Dg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUzG,EAASjK,OAAO76B,WAAWwC,IAAK,QAE1DsiC,EAAShK,OAAO96B,YAAc8kC,EAAShK,OAAO96B,WAAWwC,KAC5Dg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUzG,EAAShK,OAAO96B,WAAWwC,IAAK,QAE1DuiC,EAASlK,OAAO76B,YAAc+kC,EAASlK,OAAO76B,WAAWwC,KAC5Dg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUxG,EAASlK,OAAO76B,WAAWwC,IAAK,QAE1DuiC,EAASjK,OAAO96B,YAAc+kC,EAASjK,OAAO96B,WAAWwC,KAC5Dg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUxG,EAASjK,OAAO96B,WAAWwC,IAAK,QAE1DyiC,EAASpK,OAAO76B,YAAcilC,EAASpK,OAAO76B,WAAWwC,KAC5Dg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUtG,EAASpK,OAAO76B,WAAWwC,IAAK,QAE1DyiC,EAASnK,OAAO96B,YAAcilC,EAASnK,OAAO96B,WAAWwC,KAC5Dg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUtG,EAASnK,OAAO96B,WAAWwC,IAAK,QAE1Dwa,EAAK6d,OAAO76B,YAAcgd,EAAK6d,OAAO76B,WAAWwC,KACpDg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUvuB,EAAK6d,OAAO76B,WAAWwC,IAAK,QAEtDwa,EAAK8d,OAAO96B,YAAcgd,EAAK8d,OAAO96B,WAAWwC,KACpDg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUvuB,EAAK8d,OAAO96B,WAAWwC,IAAK,QAEnD9E,QAAQm5B,IAAIL,IAGpB2V,4BAA4B,WAC3B,GAAM3V,MADiCmX,EAE2F7xC,KAAK8vC,UAAUC,SAASpK,KAAKwD,SAAxJjlC,EAFgC2tC,EAEhC3tC,WAAY0tC,EAFoBC,EAEpBD,OAAQxI,EAFYyI,EAEZzI,cAAeK,EAFHoI,EAEGpI,WAAYJ,EAFfwI,EAEexI,eAAgBK,EAF/BmI,EAE+BnI,YAAaI,EAF5C+H,EAE4C/H,SAAUD,EAFtDgI,EAEsDhI,WAAYF,EAFlEkI,EAEkElI,OAAQC,EAF1EiI,EAE0EjI,QAAS1oB,EAFnF2wB,EAEmF3wB,IAC1H,IAAGlhB,KAAK8vC,UAAUC,SAASpK,KAAKwD,SAASI,aAAa,CACrD,GAAMA,GAAevpC,KAAK8vC,UAAUC,SAASpK,KAAKwD,SAASI,YAC3CA,GAAarlC,YAAcqlC,EAAarlC,WAAWwC,KACnDg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUlG,EAAarlC,WAAWwC,IAAK,QAG3E,GAAG1G,KAAK8vC,UAAUC,SAASpK,KAAKwD,SAASjX,YAAY,CACxC,GAAMA,GAAclyB,KAAK8vC,UAAUC,SAASpK,KAAKwD,SAASjX,WACvDA,GAAY6M,QAAU7M,EAAY6M,OAAO76B,YAAcguB,EAAY6M,OAAO76B,WAAWwC,KACpFg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUvd,EAAY6M,OAAO76B,WAAWwC,IAAK,QAEjEwrB,EAAY1T,UAAY0T,EAAY1T,SAASta,YAAcguB,EAAY1T,SAASta,WAAWwC,KAC1Fg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUvd,EAAY1T,SAASta,WAAWwC,IAAK,QAGnF,GAAG1G,KAAK8vC,UAAUC,SAASpK,KAAKwD,SAASK,aAAa,CACzC,GAAMA,GAAexpC,KAAK8vC,UAAUC,SAASpK,KAAKwD,SAASK,YACvDA,GAAatlC,YAAcslC,EAAatlC,WAAWwC,KACnDg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUjG,EAAatlC,WAAWwC,IAAK,QAG3E,GAAG1G,KAAK8vC,UAAUC,SAASpK,KAAKwD,SAASlX,YAAY,CACxC,GAAMA,GAAcjyB,KAAK8vC,UAAUC,SAASpK,KAAKwD,SAASlX,WACvDA,GAAY8M,QAAU9M,EAAY8M,OAAO76B,YAAc+tB,EAAY8M,OAAO76B,WAAWwC,KACpFg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUxd,EAAY8M,OAAO76B,WAAWwC,IAAK,QAEjEurB,EAAYzT,UAAYyT,EAAYzT,SAASta,YAAc+tB,EAAYzT,SAASta,WAAWwC,KAC1Fg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUxd,EAAYzT,SAASta,WAAWwC,IAAK,QAG1E,GAAG1G,KAAK8vC,UAAUC,SAASpK,KAAKwD,SAASG,aAAa,CAClD,GAAMA,GAAetpC,KAAK8vC,UAAUC,SAASpK,KAAKwD,SAASG,YACvDA,GAAaplC,YAAcolC,EAAaplC,WAAWwC,KACnDg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUnG,EAAaplC,WAAWwC,IAAK,QAmD3E,MAhDIxC,IAAcA,EAAWwC,KAC5Bg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUvrC,EAAWwC,IAAK,QAE1CkrC,EAAO1tC,YAAc0tC,EAAO1tC,WAAWwC,KAC1Cg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUmC,EAAO1tC,WAAWwC,IAAK,QAEjD0iC,EAAcllC,YAAcklC,EAAcllC,WAAWwC,KACxDg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUrG,EAAcllC,WAAWwC,IAAK,QAExD+iC,EAAWvlC,YAAculC,EAAWvlC,WAAWwC,KAClDg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUhG,EAAWvlC,WAAWwC,IAAK,QAErD2iC,EAAenlC,YAAcmlC,EAAenlC,WAAWwC,KAC1Dg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUpG,EAAenlC,WAAWwC,IAAK,QAEzDgjC,EAAYxlC,WAAWwC,KAAOgjC,EAAYxlC,WAAWwC,KACxDg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU/F,EAAYxlC,WAAWwC,IAAK,QAEtDojC,EAASgI,UAAU5tC,YAAc4lC,EAASgI,UAAU5tC,WAAWwC,KAClEg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU3F,EAASgI,UAAU5tC,WAAWwC,IAAK,QAE7DojC,EAASiI,QAAQ7tC,YAAc4lC,EAASiI,QAAQ7tC,WAAWwC,KAC9Dg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU3F,EAASiI,QAAQ7tC,WAAWwC,IAAK,QAE3DmjC,EAAWiI,UAAU5tC,YAAc2lC,EAAWiI,UAAU5tC,WAAWwC,KACtEg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU5F,EAAWiI,UAAU5tC,WAAWwC,IAAK,QAE/DmjC,EAAWkI,QAAQ7tC,YAAc2lC,EAAWkI,QAAQ7tC,WAAWwC,KAClEg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU5F,EAAWkI,QAAQ7tC,WAAWwC,IAAK,QAE7DijC,EAAOmI,UAAU5tC,YAAcylC,EAAOmI,UAAU5tC,WAAWwC,KAC9Dg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU9F,EAAOmI,UAAU5tC,WAAWwC,IAAK,QAE3DijC,EAAOoI,QAAQ7tC,YAAcylC,EAAOoI,QAAQ7tC,WAAWwC,KAC1Dg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU9F,EAAOoI,QAAQ7tC,WAAWwC,IAAK,QAEzDkjC,EAAQkI,UAAU5tC,YAAc0lC,EAAQkI,UAAU5tC,WAAWwC,KAChEg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU7F,EAAQkI,UAAU5tC,WAAWwC,IAAK,QAE5DkjC,EAAQmI,QAAQ7tC,YAAc0lC,EAAQmI,QAAQ7tC,WAAWwC,KAC5Dg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU7F,EAAQmI,QAAQ7tC,WAAWwC,IAAK,QAE1Dwa,EAAK6d,OAAO76B,YAAcgd,EAAK6d,OAAO76B,WAAWwC,KACpDg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUvuB,EAAK6d,OAAO76B,WAAWwC,IAAK,QAEtDwa,EAAK8d,OAAO96B,YAAcgd,EAAK8d,OAAO96B,WAAWwC,KACpDg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUvuB,EAAK8d,OAAO96B,WAAWwC,IAAK,QAEnD9E,QAAQm5B,IAAIL,IAGpB4V,0BAA0B,WACzB,GAAM5V,MAD+BsX,EAEZhyC,KAAK8vC,UAAUC,SAASpK,KAAKjP,OAA/CqI,EAF8BiT,EAE9BjT,OAAQC,EAFsBgT,EAEtBhT,MAOf,OANID,GAAO76B,YAAc66B,EAAO76B,WAAWwC,KAC1Cg0B,EAASnX,KAAKvjB,KAAKyvC,UAAU1Q,EAAO76B,WAAWwC,IAAK,QAEjDs4B,EAAO96B,YAAc86B,EAAO96B,WAAWwC,KAC1Cg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUzQ,EAAO96B,WAAWwC,IAAK,QAE9C9E,QAAQm5B,IAAIL,IAGpB6V,4BAA4B,WAC3B,GAAM7V,MADiCuX,EAEDjyC,KAAK8vC,UAAUC,SAASpK,KAAKqD,SAA5D9kC,EAFgC+tC,EAEhC/tC,WAAYguC,EAFoBD,EAEpBC,UAAWhxB,EAFS+wB,EAET/wB,IAmB9B,OAlBIhd,IAAcA,EAAWwC,KAC5Bg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUvrC,EAAWwC,IAAK,QAE1CwrC,EAAUhuC,YAAcguC,EAAUhuC,WAAWwC,KAChDg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUyC,EAAUhuC,WAAWwC,IAAK,QAEpDwrC,EAAUlpC,KAAK9E,YAAcguC,EAAUlpC,KAAK9E,WAAWwC,KAC1Dg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUyC,EAAUlpC,KAAK9E,WAAWwC,IAAK,QAEzDwrC,EAAUlpC,KAAKxF,QAAQU,YAAcguC,EAAUlpC,KAAKxF,QAAQU,WAAWwC,KAC1Eg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUyC,EAAUlpC,KAAKxF,QAAQU,WAAWwC,IAAK,QAEjEwa,EAAK6d,OAAO76B,YAAcgd,EAAK6d,OAAO76B,WAAWwC,KACpDg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUvuB,EAAK6d,OAAO76B,WAAWwC,IAAK,QAEtDwa,EAAK8d,OAAO96B,WAAWwC,KAAOwa,EAAK8d,OAAO96B,WAAWwC,KACxDg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUvuB,EAAK8d,OAAO96B,WAAWwC,IAAK,QAEnD9E,QAAQm5B,IAAIL,IAGpB8V,0BAA0B,WACzB,GAAM9V,MAD+ByX,EAECnyC,KAAK8vC,UAAUC,SAASpK,KAAKyM,OAA5DluC,EAF8BiuC,EAE9BjuC,WAAYguC,EAFkBC,EAElBD,UAAWhxB,EAFOixB,EAEPjxB,IAoB9B,OAlBIhd,IAAcA,EAAWwC,KAC5Bg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUvrC,EAAWwC,IAAK,QAE1CwrC,EAAUhuC,YAAcguC,EAAUhuC,WAAWwC,KAChDg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUyC,EAAUhuC,WAAWwC,IAAK,QAEpDwrC,EAAUlpC,KAAK9E,YAAcguC,EAAUlpC,KAAK9E,WAAWwC,KAC1Dg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUyC,EAAUlpC,KAAK9E,WAAWwC,IAAK,QAEzDwrC,EAAUlpC,KAAKxF,QAAQU,YAAcguC,EAAUlpC,KAAKxF,QAAQU,WAAWwC,KAC1Eg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUyC,EAAUlpC,KAAKxF,QAAQU,WAAWwC,IAAK,QAEjEwa,EAAK6d,OAAO76B,YAAcgd,EAAK6d,OAAO76B,WAAWwC,KACpDg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUvuB,EAAK6d,OAAO76B,WAAWwC,IAAK,QAEtDwa,EAAK8d,OAAO96B,WAAWwC,KAAOwa,EAAK8d,OAAO96B,WAAWwC,KACxDg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUvuB,EAAK8d,OAAO96B,WAAWwC,IAAK,QAEnD9E,QAAQm5B,IAAIL,IAGpB+V,yBAAyB,WACxB,GAAM/V,KAIN,OAHI16B,MAAK8vC,UAAUC,SAASpK,KAAKtsB,OAASrZ,KAAK8vC,UAAUC,SAASpK,KAAKtsB,MAAM3S,KAC5Eg0B,EAASnX,KAAKvjB,KAAKyvC,UAAUzvC,KAAK8vC,UAAUC,SAASpK,KAAKtsB,MAAM3S,IAAK,UAE/D9E,QAAQm5B,IAAIL,IAMpB8U,mBAAmB,WAiBT,MAAO,IAAI5tC,SAAQ,SAACC,EAAQC,IACxB,EAAAuwC,EAAAA,YAAM,sDAAsD,SAACxmB,EAAI9qB,GAChE,MAAG8qB,IACI9oB,UAAUkK,IAAM,GACTpL,MAGXd,IACIgC,UAAUkK,IAAMlM,EAAKA,KAAKkM,IAAMlM,EAAKA,KAAKkM,IAAM,IAE7CpL,UAuBzBywC,SAAU,WACTtyC,KAAKM,iBAAkB7E,cAAcC,aAAawB,kBAEnDq1C,UAAW,WACQvyC,KAAK8vC,UAAUc,MAAzBvd,KACRrzB,MAAKM,iBAAiB7E,cAAcC,aAAayB,uBAElDq1C,aAAc,SAAUroC,GACvBnK,KAAKyyC,UACLzyC,KAAKM,iBAAiB7E,cAAcC,aAAa0B,oBAAqB+M,IAEvEuoC,aAAc,SAAUvoC,EAASwoC,GAAc,GAAA9hC,GAAA7Q,IACrCA,MAAKyyC,UACLhrC,EAAAA,WAAM8E,QAAQ,KAAKrD,KAAK,WAC5B2H,EAAK+hC,cAAcjE,UACtB99B,EAAK+hC,cAAcjE,SAAU,EAC7B99B,EAAK45B,eAAiB55B,EAAK+hC,eAA3B3nB,OAAAC,EAA6Cra,EAAK45B,mBAGpDzqC,KAAKM,iBAAiB7E,cAAcC,aAAa2B,qBAAsB8M,QAAQA,EAASwoC,aAAcA,KAEvGE,aAAc,SAAUF,GAAc,GAAAr5B,GAAAtZ,IAC5BA,MAAKyyC,UACLhrC,EAAAA,WAAM8E,QAAQ,KAAKrD,KAAK,WAChBoQ,EAAKs5B,cAAcjE,UACnBr1B,EAAKs5B,cAAcjE,SAAU,EAC7Br1B,EAAKmxB,eAAiBnxB,EAAKs5B,eAA3B3nB,OAAAC,EAA6C5R,EAAKmxB,mBAGnEzqC,KAAKM,iBAAiB7E,cAAcC,aAAa4B,oBAAqBq1C,IAGvEzE,SAAU,SAAU4E,EAAmBH,GAEtC3yC,KAAK8uC,UAAUH,SAAU,EAChB3uC,KAAK+yC,aAAc,EACnB/yC,KAAKgzC,SAASF,GACd9yC,KAAKizC,WAAWN,IAI1BO,SAAU,SAAUJ,EAAmBH,GAAc,GAAAx4B,GAAAna,IAE3CA,MAAK8uC,UAAUH,SAAU,EACP,KAAd5rC,UAAUoK,GAA4B,KAAlBpK,UAAUmK,OAAiC,KAAnBnK,UAAU+L,SACtD/L,UAAUkK,IAAMxF,EAAAA,WAAM0rC,kBAEF,QAArBpwC,UAAU+L,QAAsC,KAAlB/L,UAAUkK,IAC1CjN,KAAKwvC,qBAAqBtmC,KAAK,WACxBiR,EAAKi5B,aAAalqC,KAAK,WACnBiR,EAAK44B,aAAc,EACnB54B,EAAK64B,SAASF,GACd34B,EAAK84B,WAAWN,OAIxB3yC,KAAKozC,aAAalqC,KAAK,WACnBiR,EAAK44B,aAAc,EACnB54B,EAAK64B,SAASF,GACd34B,EAAK84B,WAAWN,MAMlCM,WAAY,SAAUN,GAAc,GAAAz1B,GAAAld,IAC1BA,MAAKyyC,UACLhrC,EAAAA,WAAM8E,QAAQ,KAAKrD,KAAK,WAChBgU,EAAK01B,cAAcjE,UACnBzxB,EAAK01B,cAAcjE,SAAU,EAC7BzxB,EAAKutB,eAAiBvtB,EAAK01B,eAA3B3nB,OAAAC,EAA6ChO,EAAKutB,mBAInEzqC,KAAKM,iBAAiB7E,cAAcC,aAAa6B,kBAAmBo1C,IAGrEU,QAAS,WAE0B,QAArBtwC,UAAU+L,OACe,IAAtB/L,UAAUmM,QACEokC,aAAa,KAExB93C,OAAO4T,QAAU5T,OAAO4T,OAAOC,gBAAgBikC,aAAahkC,YAAY,KAGlD,YAArBvM,UAAU+L,QACftT,OAAOssB,KAAOtsB,OAAOssB,IAAIwrB,aAAa,KAE1CtzC,KAAKM,iBAAiB7E,cAAcC,aAAa6D,uBAAuB,GACjFS,KAAKM,iBAAiB7E,cAAcC,aAAa8B,iBAGlD+1C,oBAAqB,SAAUC,GACrB,GAAMC,GAAe,QAAU1wC,UAAU+L,QAAU,SAAW/L,UAAU2wC,aAElEC,EAAgB3zC,KAAK+7B,wBACvB6X,EAAgB,EACdC,EAAa,SAAC7yC,EAAM0N,GACtB,GAAMgmB,GAAQhwB,EAAA8tB,iBAAiBC,SAASzxB,EAAM0N,EAC9C,QAAKgmB,GAAUA,GAASif,EAAcjlC,KAAShK,EAAA8tB,iBAAiBshB,SAAS9yC,EAAM0N,KAAShK,EAAA8tB,iBAAiBuhB,WAAWrlC,KAGpHklC,KACO,IAGLI,EAAW,SAAA5zC,GACb,GAAI,aAAeA,EAAQY,KAAM,CAAA,GAAAm+B,GACL/+B,EAAQ+2B,KAAK,GAArBzwB,GADay4B,EACrB/5B,MADqB+5B,EACbz4B,IAChB,OAAI,YAAcA,IAGVmtC,EAAW,MAAOntC,GACvB,GAAK,cAAgBtG,EAAQY,MAAQ,cAAgBZ,EAAQY,KAChE,MAAG,YAAcZ,EAAQ+2B,KAAK,GAAGzwB,MAGzBmtC,EAAW,QAASzzC,EAAQ+2B,KAAK,GAAGzwB,IAC9C,IAAI,eAAiBtG,EAAQY,KAC3B,OAAQ6yC,EAAW,MAAOzzC,EAAQ+2B,KAAK,GAAGgH,OAAOz3B,IAC9C,IAAI,YAActG,EAAQY,MAAQ,qBAAuBZ,EAAQY,KAAM,CAAA,GAAAs9B,IAAA,EAAAC,GAAA,EAAAC,EAAAl9B,MAAA,KAC1E,IAAA,GAAAm9B,GAAAC,EAAiBt+B,EAAQ+2B,KAAzBwH,OAAAC,cAAAN,GAAAG,EAAAC,EAAAG,QAAAC,MAAAR,GAAA,EAA+B,CAAA,GAAtBt1B,GAAsBy1B,EAAAje,KAC3B,IAAIxX,EAAK9E,YAAc8E,EAAK9E,WAAW66B,QAAU/1B,EAAK9E,WAAW66B,OAAOr4B,KAAOmtC,EAAW,MAAO7qC,EAAK9E,WAAW66B,OAAOr4B,KACpH,OAAO,CAEX,IAAIsC,EAAK9E,YAAc8E,EAAK9E,WAAW86B,QAAUh2B,EAAK9E,WAAW86B,OAAOt4B,KAAOmtC,EAAW,MAAO7qC,EAAK9E,WAAW86B,OAAOt4B,KACpH,OAAO,CAEX,IAAIsC,EAAK9E,YAAc8E,EAAK9E,WAAW+6B,SAAWj2B,EAAK9E,WAAW+6B,QAAQv4B,KAAOmtC,EAAW,MAAO7qC,EAAK9E,WAAW+6B,QAAQv4B,KACvH,OAAO,CAEX,IAAIsC,EAAKqQ,OAASrQ,EAAKqQ,MAAM3S,KAAOmtC,EAAW,QAAS7qC,EAAKqQ,MAAM3S,KAC/D,OAAO,GAZ2D,MAAAmlB,GAAA0S,GAAA,EAAAC,EAAA3S,EAAA,QAAA,KAAAyS,GAAAI,EAAAA,WAAAA,EAAAA,YAAA,QAAA,GAAAH,EAAA,KAAAC,SAevE,IAAI,YAAcp+B,EAAQY,MAAQ,MAAQ+B,UAAUmM,UAAY+kC,EAAwB7zC,EAAQ+2B,KAAK,GAAG3W,OAC3G,OAAO,CAEX,QAAO,GAGL0zB,GAAaC,UAAU,EAAO3vC,YAAY,EAAO4vC,WAAW,GAC5DC,EAAe,WACjB,SAAIH,EAASE,WAAaR,EAAgB,SAGtCM,EAAS1vC,aAAe0vC,EAASC,UAAYP,EAAgB,KAG1DA,EAAgB,KAGrBU,EAAY,QAAZA,GAAYvd,GACd,IAAK,GAAItwB,GAAI,EAAGA,EAAIswB,EAAS11B,SAAWgzC,IAAe5tC,IAAK,CACxD,GAAMwwB,GAAMF,EAAStwB,EACrB,KAAKutC,EAAS/c,GACV,OAAO,CAYX,IAVgB,YAAbA,EAAIj2B,OACHkzC,EAASE,WAAY,GAET,eAAbnd,EAAIj2B,OACHkzC,EAAS1vC,YAAa,GAEV,aAAbyyB,EAAIj2B,OACHkzC,EAASC,UAAW,GAGN,YAAbld,EAAIj2B,MAAmC,qBAAbi2B,EAAIj2B,KAC/B,IAAK,GAAIsS,GAAI,EAAGA,EAAI2jB,EAAIE,KAAK91B,SAAWgzC,IAAe/gC,IACnD,IAAKghC,EAAUrd,EAAIE,KAAK7jB,GAAGyjB,UACvB,OAAO,EAKvB,OAAO,GAGLkd,EAA0B,SAAAzT,GAC5B,OAAgB,UAAZA,IAAuBqT,EAAW,MAAX,IAAsBpsC,EAAAA,WAAMs2B,4BAA5B,IAA2Dt2B,EAAAA,WAAMu2B,uBAAuB,QAAxF,yBAGN,UAAZwC,IAAuBqT,EAAW,MAAX,IAAsBpsC,EAAAA,WAAMs2B,4BAA5B,IAA2Dt2B,EAAAA,WAAMu2B,uBAAuB,QAAxF,wBAGX,gBAAZwC,IAA6BqT,EAAW,MAAX,IAAsBpsC,EAAAA,WAAMs2B,4BAA5B,IAA2Dt2B,EAAAA,WAAMu2B,uBAAuB,eAAxF,yBAGjB,iBAAZwC,IAA8BqT,EAAW,MAAX,IAAsBpsC,EAAAA,WAAMs2B,4BAA5B,IAA2Dt2B,EAAAA,WAAMu2B,uBAAuB,gBAAxF,yBAGlB,kBAAZwC,IAA+BqT,EAAW,MAAX,IAAsBpsC,EAAAA,WAAMs2B,4BAA5B,IAA2Dt2B,EAAAA,WAAMu2B,uBAAuB,WAAxF,0BAGnB,cAAZwC,IAA2BqT,EAAW,MAAX,IAAsBpsC,EAAAA,WAAMs2B,4BAA5B,IAA2Dt2B,EAAAA,WAAMu2B,uBAAuB,aAAxF,2BAG5Bj7B,UAAUC,UAAwB,UAAZw9B,IAAuBqT,EAAW,MAAX,IAAqBpsC,EAAAA,WAAMs2B,4BAA3B,IAA0Dt2B,EAAAA,WAAMu2B,uBAAuB,QAAvF,yBAMzD,IAAIwV,EAASzc,SACT,MAAOud,GAAUd,EAASzc,SAG9B,IAAIyc,EAAStvC,WAAWwC,KAAmC,YAA5B8sC,EAAStvC,WAAWwC,KAAqBmtC,EAAW,MAAOL,EAAStvC,WAAWwC,KAC1G,OAAO,CAEX,IAAI8sC,EAASrV,OAAOz3B,KAAOmtC,EAAW,MAAOL,EAASrV,OAAOz3B,KACzD,OAAO,CAEX,IAAI8sC,EAASngB,MAAM3sB,KAA+B,YAAvB8sC,EAASngB,MAAM3sB,KAAsBmtC,EAAW,QAASL,EAASngB,MAAM3sB,OAAS+sC,EACxG,OAAO,CAEX,IAAID,EAAS/c,QAAQp1B,OAAQ,CAAA,GAAAg+B,IAAA,EAAAC,GAAA,EAAAC,EAAAj+B,MAAA,KACzB,IAAA,GAAAk+B,GAAAC,EAAiB+T,EAAS/c,QAA1BkI,OAAAC,cAAAS,GAAAG,EAAAC,EAAAZ,QAAAC,MAAAO,GAAA,EAAmC,CAAA,GAA1Br2B,GAA0Bw2B,EAAAhf,KAC/B,IAAIxX,EAAK9E,YAAc8E,EAAK9E,WAAW66B,QAAU/1B,EAAK9E,WAAW66B,OAAOr4B,KAAOmtC,EAAW,MAAO7qC,EAAK9E,WAAW66B,OAAOr4B,KACpH,OAAO,CAEX,IAAIsC,EAAK9E,YAAc8E,EAAK9E,WAAW86B,QAAUh2B,EAAK9E,WAAW86B,OAAOt4B,KAAOmtC,EAAW,MAAO7qC,EAAK9E,WAAW86B,OAAOt4B,KACpH,OAAO,CAEX,IAAIsC,EAAK9E,YAAc8E,EAAK9E,WAAW+6B,SAAWj2B,EAAK9E,WAAW+6B,QAAQv4B,KAAOmtC,EAAW,MAAO7qC,EAAK9E,WAAW+6B,QAAQv4B,KACvH,OAAO,CAEX,IAAIsC,EAAKqQ,OAASrQ,EAAKqQ,MAAM3S,KAAOmtC,EAAW,QAAS7qC,EAAKqQ,MAAM3S,KAC/D,OAAO,GAZU,MAAAmlB,GAAAyT,GAAA,EAAAC,EAAA1T,EAAA,QAAA,KAAAwT,GAAAI,EAAAA,WAAAA,EAAAA,YAAA,QAAA,GAAAH,EAAA,KAAAC,KAgB7B,GAAIiU,EAAS9T,WAAWr+B,QAAUmyC,EAASvT,MAAM5+B,OAC7C,IAAA,GADqDkzC,MAAAtpB,OAAAC,EAChCsoB,EAAS9T,YADuBxU,EACRsoB,EAASvT,QAAtDuU,EAAA,EAAAA,EAAAD,EAAAlzC,OAAAmzC,IAA8D,CAAzD,GAAIxrC,GAAAA,EAAAA,EACL,IAAI6qC,EAAW,MAAO7qC,EAAKtC,KACvB,OAAO,EAInB,GAAI8sC,EAAShT,SAAkC,MAAvBz9B,UAAUmM,UAAqB+kC,EAAwBT,EAAShT,QAAQhgB,OAC5F,OAAO,CAEX,KAAK,GAAIxX,KAAQwqC,GAASpU,WACtB,GAAIoU,EAASpU,WAAWp2B,GAAO,CAC3B,GAAMtC,GAAM8sC,EAASpU,WAAWp2B,GAAMtC,GACtC,IAAIA,GAAa,YAANA,IAAoB+sC,GAAeI,EAAW,QAASL,EAASpU,WAAWp2B,GAAMtC,KACxF,OAAO,EAInB,OAAO,GAGjB+tC,uBAAwB,SAAUjB,GACxB,GAAMlW,KACN,IAAKkW,EAASzc,SAEP,CACH,GAAI2d,GAAW,EACTpX,KACAqX,EAAgB,QAAhBA,GAAgB5d,GAClB,IAAK,GAAItwB,GAAI,EAAGA,EAAIswB,EAAS11B,QAAUqzC,EAAW,GAAIjuC,IAAK,CACvD,GAAMwwB,GAAMF,EAAStwB,GACfmuC,EAAMlwC,EAAA8tB,iBAAiBkL,oBAAoBzG,EAMjD,IALI2d,EAAIvzC,SACJi8B,EAAU/Z,KAAV3G,MAAAi4B,EAAA3pB,EAAkB0pB,IAClBF,KAGc,YAAbzd,EAAIj2B,MAAmC,qBAAbi2B,EAAIj2B,KAC/B,IAAK,GAAIsS,GAAI,EAAGA,EAAI2jB,EAAIE,KAAK91B,QAAUqzC,EAAW,GAAIphC,IAClDqhC,EAAc1d,EAAIE,KAAK7jB,GAAGyjB,WAM1C4d,GAAcnB,EAASzc,cArBvBuG,GAAU/Z,KAAV3G,MAAA0gB,EAAApS,EAAkBxmB,EAAA8tB,iBAAiBoL,iBAAiB4V,IAHtB,IA2B1BliC,GAAStR,KAAK2vC,cAAcj8B,KAA5BpC,IACR,OAAOgsB,GAAUlC,OAAO,SAAArQ,GAAA,GAAG/pB,GAAH+pB,EAAG/pB,KAAM0F,EAATqkB,EAASrkB,GAAT,OAAmB4K,GAAKwM,SAAS,QAAU9c,EAAO,QAAU,QAAS0F,KAAM2zB,IAAI,SAAAtoB,GAAA,MAAKoL,QAAO8d,OAAOlpB,GAAKrD,IAAKqD,EAAErL,SAGhJq1B,sBAAuB,SAAUrtB,GAAK,GAAAkP,GAAA5d,KAC/B80C,KACAC,EAAW,QAAXA,KAAW,GAACtiC,GAADrR,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAKwc,EAAK+xB,cAAcj8B,KAAKshC,KAA7B,OAAuCviC,GAAEw+B,SAAS5zB,QAAQ,SAAAnI,GAC1E4/B,EAAO5/B,EAAExG,MAAQomC,EAAO5/B,EAAExG,MAAQ,GAAK,EACvCqmC,EAAS7/B,MAEJ+/B,EAAa,WAAA,MAAMr3B,GAAK+xB,cAAcj8B,KAAK2F,MAAMoH,QAAQpD,QAAQ,SAAAtY,GAAA,MAAK+vC,GAAO/vC,EAAE2J,MAAQomC,EAAO/vC,EAAE2J,MAAQ,GAAK,IAGnH,OAFAqmC,KACAE,IACOH,GAGFI,eAAgB,WAA0B,GAAhB5X,GAAgBl8B,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,MAChCuyC,EAAgB3zC,KAAK+7B,uBACpCr3B,GAAA8tB,iBAAiBwJ,eAAe,SAACh7B,EAAM0N,EAAKgmB,GAC3C,GAAMygB,GAAaxB,EAAcjlC,EAC7BymC,GAAa,GAChBzwC,EAAA8tB,iBAAiBG,YAAY3xB,EAAM0N,EAAK,OAAOymC,GAE3C7X,EAAUrsB,KAAK,SAAAjF,GAAA,MAAKA,GAAE0C,MAAQA,KAG9BA,IAAQhK,EAAA8tB,iBAAiByC,YAAY5B,OACxC3uB,EAAA8tB,iBAAiBG,YAAY3xB,EAAM0N,GAEhCA,IAAQhK,EAAA8tB,iBAAiByC,YAAY/wB,YACxCQ,EAAA8tB,iBAAiBG,YAAY3xB,EAAM0N,GAEhChK,EAAA8tB,iBAAiByC,YAAY3B,OAAOriB,KAAK,SAAAC,GAAA,MAAKA,KAAMxC,KACvDhK,EAAA8tB,iBAAiBG,YAAY3xB,EAAM0N,KATnCgmB,GAAShwB,EAAA8tB,iBAAiBvU,gBAAgBjd,EAAM0N,MAcpD0mC,aAAc,SAAUjrC,EAAS2nB,EAAS6Y,GAAqC,GAAAhW,GAAA30B,KAA1B47B,EAA0Bx6B,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,MAAV4xC,EAAU5xC,UAAA,GACtEy0B,EAAqC+F,EAArC/F,QAASgC,EAA4B+D,EAA5B/D,SAAUwd,EAAkBzZ,EAAlByZ,cACrB1e,EAAQ7E,EAAQ6E,MAFwD2e,EAG1C5wC,EAAA8tB,iBAAiByC,YAA/C5B,EAHwEiiB,EAGxEjiB,MAAOC,EAHiEgiB,EAGjEhiB,OAAQpvB,EAHyDoxC,EAGzDpxC,UAarB,OAZG8uC,KACF3f,EAAQ2f,EAAS3f,MAAM3sB,IACvB4sB,EAAS0f,EAAS1f,OAAO+G,IAAI,SAAAt1B,GAAA,MAAKA,IAAKA,EAAE2B,MACzCxC,EAAa8uC,EAAS9uC,YAEdQ,EAAA8tB,iBAAiBY,aAAgBwO,UAAYtO,OAAQ,GAAI/f,OAAM,IAAIoB,KAAK,KACnEmd,EAAQjyB,QAAW8qC,GACpBjmC,EAAA8tB,iBAAiBsJ,eAErBp3B,EAAA8tB,iBAAiB2F,cACjBzzB,EAAA8tB,iBAAiBwF,SAAWh4B,KAAK8vC,UACjCprC,EAAA8tB,iBAAiByH,WAAaj6B,KAChC0E,EAAA8tB,iBAAiByJ,sBAAsB9xB,EAAS2nB,EAAS6Y,EAAW9U,EAASgC,GAAU3uB,KAAK,SAAAo0B,GAClG,GAAMiY,GAAe,SAACx0C,GAChBu8B,EAAUv8B,KAAKkQ,KAAK,SAAAjF,GAAA,MAAKA,GAAE0C,MAAQ3N,EAAK2N,OAC5C4uB,EAAUv8B,KAAKwiB,KAAKxiB,GAErB2D,EAAA8tB,iBAAiBG,YAAY5xB,EAAKC,KAAMD,EAAK2N,KAG9C,IAAkBpN,SAAdqpC,GAA2BhU,EAAMgU,KAAehU,EAAMgU,GAAW5T,UAA2C,YAA/BJ,EAAMgU,GAAWtX,MAAM3sB,IAAmB,CAC1H,GAAM2sB,GAAQsB,EAAK6gB,SAAS1jB,EAAS6Y,EACjCtX,IACHkiB,GAAe7mC,IAAK2kB,EAAOryB,KAAM,UAGnC,GAAIgyC,EAAU,CAAA,GACL3f,GAA4D2f,EAA5D3f,MAAOC,EAAqD0f,EAArD1f,OAAQmiB,EAA6CzC,EAA7CyC,cAAevxC,EAA8B8uC,EAA9B9uC,WAAY2B,EAAkBmtC,EAAlBntC,OAAO6vC,EAAW1C,EAAX0C,MAwB1C,IAvBXxxC,IAAeo5B,EAAUv8B,KAAKkQ,KAAK,SAAAjF,GAAA,MAAKA,GAAE0C,MAAQxK,KACrDqxC,GAAe7mC,IAAKxK,EAAYlD,KAAM,QAEnCqyB,IAAUiK,EAAUv8B,KAAKkQ,KAAK,SAAAjF,GAAA,MAAKA,GAAE0C,MAAQ2kB,EAAM3sB,QACtDhC,EAAA8tB,iBAAiBY,YAAYwO,OAAOre,KAAK8P,EAAM3sB,KAC/C6uC,GAAe7mC,IAAK2kB,EAAM3sB,IAAK1F,KAAM,WAEtCsyB,GAAUA,EAAOjW,QAAQ,SAACtY,EAAG0B,GACxB1B,IAAMu4B,EAAUv8B,KAAKkQ,KAAK,SAAAjF,GAAA,MAAKA,GAAE0C,MAAQ3J,EAAE2B,QAC9ChC,EAAA8tB,iBAAiBY,YAAYE,OAAO7sB,GAAK1B,EAAE2B,IAC3C6uC,GAAe7mC,IAAK3J,EAAE2B,IAAK1F,KAAM,aAGnCy0C,GAAiBA,EAAcp4B,QAAQ,SAAAs4B,GACjCrY,EAAUv8B,KAAKkQ,KAAK,SAAAjF,GAAA,MAAKA,GAAE0C,MAAQinC,EAAGjvC,OAC1C6uC,GAAe7mC,IAAKinC,EAAGjvC,IAAK1F,KAAM,UAGpC6E,GAAUA,EAAOwX,QAAQ,SAAAtV,GACnBu1B,EAAUv8B,KAAKkQ,KAAK,SAAAjF,GAAA,MAAKA,GAAE0C,MAAQ3G,EAAIrB,OAC3C6uC,GAAe7mC,IAAK3G,EAAIrB,IAAK1F,KAAM,UAGnB00C,EAAO,CACN,GAAME,GAAe,SAACC,GAClBA,EAAIx4B,QAAQ,SAACy4B,EAAK1wC,GAAS,GAAA2wC,GACED,EAAK3e,KAAK,GAA5BgH,EADgB4X,EAChB5X,OAAO36B,EADSuyC,EACTvyC,OACX26B,GAAOz3B,KACN6uC,GAAcv0C,KAAK,MAAO0N,IAAIyvB,EAAOz3B,MAEtClD,EAAQkD,KACP6uC,GAAcv0C,KAAK,MAAO0N,IAAIlL,EAAQkD,QAIlDgvC,GAAOr4B,QAAQ,SAACjL,EAAE3L,GACX2L,EAAE4jC,WAAW7e,KAAK,GAAGzwB,KACpB42B,EAAU/Z,MAAMviB,KAAK,MAAO0N,IAAI0D,EAAE4jC,WAAW7e,KAAK,GAAGzwB,MAEzDkvC,EAAaxjC,EAAEsjC,WAMvC,GAAIL,EAAe,CAAA,GAAAY,GACuCra,EAAYyZ,cAA7DhiB,EADU4iB,EACV5iB,MAAOC,EADG2iB,EACH3iB,OAAQmiB,EADLQ,EACKR,cAAeS,EADpBD,EACoBC,WAAYC,EADhCF,EACgCE,EAC9CD,IAAcA,EAAW,IAAMA,EAAW,GAAG/X,OAAOz3B,KACvD6uC,GAAe7mC,IAAKwnC,EAAW,GAAG/X,OAAOz3B,IAAK1F,KAAM,QAEjDm1C,GAAMA,EAAGzvC,KACZ6uC,GAAe7mC,IAAKynC,EAAGzvC,IAAK1F,KAAM,QAE/BqyB,GAASA,EAAM3sB,KAClB6uC,GAAe7mC,IAAK2kB,EAAM3sB,IAAK1F,KAAM,UAEtCsyB,GAAUA,EAAOjW,QAAQ,SAACtY,EAAG0B,GAAJ,MAAU1B,IAAKA,EAAE2B,KAAO6uC,GAAe7mC,IAAK3J,EAAE2B,IAAK1F,KAAM,YAClFy0C,GAAiBA,EAAcp4B,QAAQ,SAAAs4B,GAAA,MAAMA,IAAMA,EAAGjvC,KAAO6uC,GAAe7mC,IAAKinC,EAAGjvC,IAAK1F,KAAM,UAC9D,KAA9Bq0C,EAAce,aACE1xC,EAAA8tB,iBAAiB0M,oBAAoBmW,EAAce,aAAa/4B,QAAQ,SAACxB,GAC1FA,GAAK05B,GAAe7mC,IAAKmN,EAAEnV,IAAK1F,KAAM6a,EAAE7a,SAI3C,MAAOs8B,MAGT+Y,sBAAuB,SAAUlsC,EAAS2nB,EAAS6Y,EAAW9U,EAASgC,EAAUmb,GAAS,GAAApe,GAAA50B,IACzF,OAAOA,MAAKo1C,aAAajrC,EAAS2nB,EAAS6Y,GAAa9U,QAAAA,EAASgC,SAAAA,GAAYmb,GAAU9pC,KAAK,SAAAo0B,GAC/E54B,EAAA8tB,iBAAiB6C,aAAaiG,UAAY,CACtD,IAAMZ,KAKN,OAJAsY,IAAYpe,EAAKsgB,eAAe5X,EAAUv8B,MAC1Cu8B,EAAUv8B,KAAKsc,QAAQ,SAAArR,GACtB0uB,EAASnX,KAAKqR,EAAK6a,UAAUzjC,EAAE0C,IAAK1C,EAAEhL,KAAMgL,EAAE0C,KAAK,GAAMxF,KAAK,SAAAotC,GAAA,MAAYn5B,QAAO8d,QAAQqb,SAAAA,GAAUtqC,QAE7FpK,QAAQm5B,IAAIL,GAAUxxB,KAAK,SAAAo0B,GAAA,MAAaA,GAAUlC,OAAO,SAAAlmB,GAAA,MAAKA,GAAEohC,gBAGzEC,qBAAsB,SAAUpsC,EAAS2nB,EAAS6Y,EAAW/O,EAAaoX,EAASwD,GAAS,GAAA/gB,GAAAz1B,IAI3F,OAHAA,MAAKivC,WAAand,EAClB9xB,KAAKy2C,aAAe9L,GAAa,EACxB3qC,KAAK47B,YAAcA,EACrB57B,KAAKo1C,aAAajrC,EAAS2nB,EAAS6Y,EAAW/O,EAAaoX,GAAU9pC,KAAK,SAAAo0B,GACrE54B,EAAA8tB,iBAAiB6C,aAAaiG,UAAY,CACtD,IAAMZ,KAKN,QAJCsY,GAAYwD,IAAY/gB,EAAKyf,eAAe5X,EAAUv8B,MACvDu8B,EAAUv8B,KAAKsc,QAAQ,SAAArR,GACtB0uB,EAASnX,KAAKkS,EAAKga,UAAUzjC,EAAE0C,IAAK1C,EAAEhL,KAAMgL,EAAE0C,KAAK,GAAMxF,KAAK,SAAAotC,GAAA,MAAYn5B,QAAO8d,QAAQqb,SAAAA,GAAUtqC,QAE7FpK,QAAQm5B,IAAIL,GAAUxxB,KAAK,SAAAo0B,GAClB,GAAMoZ,GAAepZ,EAAUlC,OAAO,SAAAlmB,GAAA,MAAKA,GAAEohC,UAC5D7gB,GAAKn1B,iBAAiB7E,cAAcC,aAAaoC,8BAA+BqM,QAAAA,EAAS6oC,SAAAA,EAAU0D,aAAAA,SAKtGC,iBAAkB,SAAUC,EAAOC,GAClC,GAAMC,GAAc,QAAdA,GAAwB5F,EAAO9+B,GAIpC,GAHI8+B,EAAM6F,eAAiB3kC,GAAM8+B,EAAMl/B,OACtCk/B,EAAM6F,aAAe3kC,GAElB8+B,EAAMD,SAAS5vC,OAAS,EAC3B,IAAK,GAAIoF,KAAKyqC,GAAMD,SACnB6F,EAAY5F,EAAMD,SAASxqC,GAAI2L,GAKlC,IAAI,gBAAkBwkC,EAAMh3C,KAE3B,YADAg3C,EAAMjI,QAAUkI,EAGZ,IAAI,cAAgBD,EAAMh3C,KAC9Bg3C,EAAM3F,SAAS,GAAG8F,aAAeF,MAGjC,KAAK,GAAIpwC,KAAKmwC,GAAM3F,SACnB6F,EAAYF,EAAM3F,SAASxqC,GAAIowC,IAKlCG,eAAgB,WACN,GAAIh3C,KAAKi3C,oBAAsBj3C,KAAKi3C,mBAAmBC,OACnD,IAAK,GAAIzwC,GAAE,EAAGA,EAAEzG,KAAKi3C,mBAAmBhG,SAAS5vC,OAAQoF,IAAK,CAC1D,GAAI0wC,GAAWn3C,KAAKi3C,mBAAmBhG,SAASxqC,GAC5CsB,EAAMovC,EAASlG,SAAS,EACxBlpC,IAAOA,EAAIqvC,aACXrvC,EAAIsgC,MAAQtgC,EAAIqvC,WAAW/O,MAC3BtgC,EAAIsvC,MAAQtvC,EAAIqvC,WAAWC,MAC3BtvC,EAAIgL,EAAIhL,EAAIqvC,WAAWrkC,EACvBhL,EAAIiM,EAAIjM,EAAIqvC,WAAWpjC,EACvBmjC,EAASpkC,EAAI,EACbokC,EAASnjC,EAAI,EACbmjC,EAAS9iC,MAAMtB,EAAIokC,EAASC,WAAW/iC,MAAMtB,EAC7CokC,EAAS9iC,MAAML,EAAImjC,EAASC,WAAW/iC,MAAML,KAMnEsjC,iBAAkB,WAGR,IADAt3C,KAAKqrC,cAAgBrrC,KAAKqrC,aAAajpC,WAAapC,KAAKqrC,aAAa,MAC/DrrC,KAAKorC,cAAc/pC,QAAQ,CAC9B,GAAIk2C,GAAQv3C,KAAKorC,cAAcrsB,OAAO,EAAG,EACzCw4B,GAAM,GAAG/+B,MAAK,GACV++B,EAAM,GAAGxxC,QAAmC,YAAzBwxC,EAAM,GAAGxxC,OAAOnG,MACnC23C,EAAM,GAAGxxC,OAAO4W,UAGxB3c,KAAKg3C,kBAGfvE,QAAS,WAECzyC,KAAKqtC,WAAY,CAIjB,KAAK,GAAI5mC,GAAIzG,KAAK2vC,cAAcj8B,KAAK8jC,OAAOC,QAAQp2C,OAAS,EAAGoF,GAAK,EAAGA,IACxE,CACC,GAAIowB,GAAI72B,KAAK2vC,cAAcj8B,KAAK8jC,OAAOC,QAAQhxC,EACxCowB,GAAEj3B,MAAiB,UAATi3B,EAAEj3B,MAChBi3B,EAAEje,QAEN5Y,KAAKM,iBAAiB7E,cAAcC,aAAa6D,uBAAuB,IAGlFm4C,SAAU,WACA13C,KAAKysC,aAAc,EACnBzsC,KAAKqtC,WAAY,EACjBrtC,KAAK2vC,cAAcj8B,KAAK8jC,OAAOG,YAC/B33C,KAAK0sC,cAAgB1sC,KAAK2vC,cAAcj8B,KAAK0Y,KAAK0kB,OAAOzV,QAClEr7B,KAAKM,iBAAiB7E,cAAcC,aAAa6D,uBAAuB,IAGzEq4C,uBAAwB,WAAY,GAAAjc,GAAA37B,KACpB8xB,EAAU9xB,KAAK63C,mBACfne,EAAc5H,EAAQ6H,aAAe7H,EAAQ6H,aAAe7H,EAAQvmB,IAC1E,IAAIumB,EAAQ2H,KAAgC,IAAzB3H,EAAQ6E,MAAMt1B,OAAc,CAE3C,GAAGrB,KAAKstC,aAAa,CACjB,GAAMwK,GAAY,SAACnhB,GACF,OAAVA,EACCnqB,EAAAA,WAAOsf,MAAM,cACE,SAAV6K,EAELnqB,EAAAA,WAAOC,OAAO,QAAQ,kDAAkD,KAAK,OAAO,MAAK,GAAOvD,KAAK,YACjG,EAAA6uC,EAAAA,YAAK,aACDC,OAAO,EACP/pC,QAAS,UAEf,eAGF6jB,EAAQ6E,MAAQA,EAAQA,KACxBgF,EAAK4a,qBAAqB5a,EAAKxxB,QAAS2nB,IAIhD,YADA9xB,MAAKi4C,wBAAwBve,EAAY5H,EAAQomB,OAAOpmB,EAAQ2H,IAAIqe,GAIxE,IAAIhmB,EAAQomB,QAAW,YAAcn1C,UAAU+L,QAAU,QAAU/L,UAAU+L,QAA+B,QAArB/L,UAAU+L,OAuB7F9O,KAAKk6B,mBAAmBR,EAAa5H,EAAQ2H,KAAKvwB,KAAK,SAACytB,GAAQ,GAAAwhB,IAC5DA,EAAArmB,EAAQ6E,OAAMpT,KAAd3G,MAAAu7B,EAAAjtB,EAAsByL,IACtBgF,EAAK4a,qBAAqB5a,EAAKxxB,QAAS2nB,IACzC,SAAC3oB,QACWA,EAAIiR,QAAQ,WACnB5N,EAAAA,WAAOsf,MAAM3iB,GAEQ,WAAlBpG,UAAUye,IACThV,EAAAA,WAAO4rC,KAAK,uBAAuBlvC,KAAK,WACpC1N,OAAOkR,SAAS2rC,KAAO,uDAAwDt1C,UAAUwG,MAG7FiD,EAAAA,WAAO4rC,KAAK,4BAGpBzc,EAAK2c,WAAW3J,SAAU,QAtCkF,CAChH,GAAM4J,GAAe,SAACC,EAAUtJ,GACxBsJ,EACA7c,EAAKzB,mBAAmBR,EAAa5H,EAAQ2H,KAAKvwB,KAAK,SAACytB,GAAQ,GAAAoD,EAC5D4B,GAAKkQ,sBAAwB,MAC7B9R,EAAAjI,EAAQ6E,OAAMpT,KAAd3G,MAAAmd,EAAA7O,EAAsByL,IACtBgF,EAAK4a,qBAAqB5a,EAAKxxB,QAAS2nB,IACzC,WACyB,QAArB/uB,UAAU+L,OACTtT,OAAOqE,QAAUrE,OAAOqE,OAAO44C,YAE/BjsC,EAAAA,WAAOsf,MAAM,cAEjB6P,EAAK2c,WAAW3J,SAAU,IAGzBO,IACLvT,EAAK2c,WAAW3J,SAAU,GAIlC3uC,MAAK04C,cAAchf,EAAa5H,EAAQomB,OAAQpmB,EAAQ2H,IAAK8e,QAqBjEv4C,MAAKu2C,qBAAqBv2C,KAAKmK,QAAS2nB,EAE5C9xB,MAAKs4C,WAAW3J,SAAU,GAEpCgK,sBAAuB,WACtB34C,KAAKkzC,YAEN0F,yBAA0B,WACzB54C,KAAK0yC,aAAa1yC,KAAKmK,UAExB0uC,sBAAuB,aACnB91C,UAAUstB,aAAqC,QAArBttB,UAAU+L,QAAyC,YAArB/L,UAAU+L,UAIxDwF,UAAU+G,UAAUjB,QAAQ,QAAU,EAClC9F,UAAU+G,UAAUjB,QAAQ,YAAc,GAC1C5e,OAAOs9C,OAAS,KAChBt9C,OAAO8H,UAEP9H,OAAOspC,KAAK,GAAI,QAChBtpC,OAAOu9C,IAAIz1C,SAGVgR,UAAU+G,UAAUjB,QAAQ,WAAa,EAC9C5e,OAAOkR,SAAS2rC,KAAO,gBAGvB78C,OAAOs9C,OAAS,KAChBt9C,OAAOspC,KAAK,GAAI,SAChBtpC,OAAO8H,WAIrB01C,iBAAkB,WACjBh5C,KAAK+uC,UAEL/uC,KAAKwyC,aAAaxyC,KAAKmK,UAGlB8uC,qBAAqB,WACvBl2C,UAAUuf,UAAW,GAA8B,MAAtBvf,UAAUmM,UAC7BlP,KAAKmK,QAAQykC,YAAc5uC,KAAK6uC,iCAChCrzC,OAAOssB,KAAOtsB,OAAOssB,IAAIoxB,cAGvCC,mBAAoB,WACnB,GAAwB,QAArBp2C,UAAU+L,OAGZ,MAFY9O,MAAKmK,QAAQykC,YAAc5uC,KAAK6uC,sCAChCrzC,OAAOqE,QAAUrE,OAAOqE,OAAOu5C,WAG5C,IAAyB,QAArBr2C,UAAU+L,QAAyC,YAArB/L,UAAU+L,OAAsB,CACjE,GAAG9O,KAAKstC,aASP,MARettC,MAAKmK,QAAQykC,YAAc5uC,KAAK6uC,qCAChCwK,GAAAA,WAAWC,aAAapwC,KAAK,SAAAyG,GACrB,IAAMA,GACW,gBAANA,SAAyBA,EAAEyK,QAAQ,UAC1C5e,OAAOkR,SAAS2rC,KAAO1oC,IAM/C5M,WAAUstB,YAAc,QAC3B7jB,EAAAA,WAAO4rC,KAAK,eAEG58C,OAAOkR,SAAS2rC,KAAO,qBAG3Br4C,MAAKmK,QAAQykC,YAAc5uC,KAAK6uC,iCAChCwK,EAAAA,WAAWC,aAAapwC,KAAK,SAAAyG,GACxB,IAAMA,GACgB,gBAANA,SAAyBA,EAAEyK,QAAQ,UAC5C5e,OAAOkR,SAAS2rC,KAAO1oC,MAOjD4pC,yBAA0B,WACXv5C,KAAKmK,QAAQqvC,mBAAsBx5C,KAAKmK,QAAQqvC,kBAAkBzQ,KAGnE/oC,KAAKy5C,UAAU,EAAG,kBAFlBz5C,KAAKkuC,YAKnBwL,yBAA0B,WACpB15C,KAAKmK,QAAQqvC,mBAAsBx5C,KAAKmK,QAAQqvC,kBAAkBloC,KAGtEtR,KAAKy5C,UAAU,EAAG,kBAFNz5C,KAAKkzC,YAKnByG,6BAA8B,WAC7B35C,KAAK6yC,gBAEN+G,6BAA8B,WAC7B55C,KAAKmK,QAAQ0vC,MAAQ75C,KAAKmK,QAAQ0vC,KAClC75C,KAAK85C,4BAENC,6BAA8B,WAC7B/5C,KAAK0yC,aAAa1yC,KAAKmK,UAExB2vC,yBAA0B,WACzB95C,KAAK4yC,cAAcjE,SAAU,EAC7B3uC,KAAK03C;AACD13C,KAAKmK,QAAQ0vC,MAChB75C,KAAKg6C,aAAaC,iBAAiBzoC,SAAS,SAI9C0oC,6BAA8B,WAC7Bl6C,KAAK2vC,cAAcj8B,KAAKW,MAAM8lC,iBAAgB,GAC9Cn6C,KAAKmK,QAAQykC,YAAa,GAE3BC,+BAAgC,WAC/B7uC,KAAK2vC,cAAcj8B,KAAKW,MAAM+lC,iBAC9Bp6C,KAAKmK,QAAQykC,YAAa,GAE3ByL,2BAA4B,WAC3Br6C,KAAKmK,QAAQ0vC,MAAO,GAErBS,4BAA6B,WAC5Bt6C,KAAKmK,QAAQ0vC,MAAO,GAErBU,yBAA0B,WACzBv6C,KAAKyqC,cAAc,KAAOzqC,KAAKyqC,cAAc,GAAGkE,SAAU,GAC7C3uC,KAAKyqC,cAAc,KAAOzqC,KAAK4yC,eAC/B5yC,KAAK03C,WAElB13C,KAAKyqC,cAAgBzqC,KAAKyqC,cAAcp0B,MAAM,GAC9CrW,KAAKw6C,cAAc7L,SAAU,GAG9B8L,uBAAwB,WACvBz6C,KAAKyqC,cAAc,KAAOzqC,KAAKyqC,cAAc,GAAGkE,SAAU,GAC7C3uC,KAAKyqC,cAAc,KAAOzqC,KAAK4yC,eAC/B5yC,KAAK03C,WAElB13C,KAAKyqC,cAAgBzqC,KAAKyqC,cAAcp0B,MAAM,GAC9CrW,KAAK0uC,YAAYC,SAAU,EAE3B3uC,KAAK06C,YAENC,wBAAyB,WACxB36C,KAAKwqC,WAAY,EACjBxqC,KAAK+yC,YAAc/yC,KAAKkuC,UAAS,GAAQluC,KAAKkzC,UAAS,IAExD0H,wBAAyB,WACxB56C,KAAKwqC,WAAY,EACRxqC,KAAK+yC,YAAc/yC,KAAKkuC,UAAS,GAAQluC,KAAKkzC,UAAS,IAGjEwH,SAAU,WAEA16C,KAAK8uC,UAAUH,SAAU,EACrB3uC,KAAK66C,aAAe76C,KAAK66C,YAAYhS,OACrC7oC,KAAK8uC,UAAUH,SAAW3uC,KAAK66C,YAAYhS,KAAKiS,SAI9DC,aAAa,SAAU31C,GACtBpF,KAAKM,iBAAiB7E,cAAcC,aAAa0D,kBAAkB47C,GAAG51C,KAGvE61C,WAAY,WAAY,GAAA/e,GAAAl8B,IACvB,OAAOA,MAAKk7C,gBAAgB,IAAIhyC,KAAK,SAAAgD,GACpC,GAAMivC,GAAmB,SAACp6C,GAIzB,IAAK,GAHDq6C,GAAQxvC,KAAKkB,MAAM/L,GACnBs6C,EAAQ9nC,MAAM,IAET9M,EAAE,EAAGA,EAAE20C,EAAM/5C,OAAQoF,IACX,GAAK20C,EAAM30C,GAAG60C,SAAd,CAKC,GAAIC,GAAQ,GAAKH,EAAM30C,GAAG+0C,UAC1BH,GAAM50C,MACN40C,EAAM50C,GAAG60C,SAAWF,EAAM30C,GAAG60C,SAC7BD,EAAM50C,GAAGkmB,UAAY4uB,EAAMl6C,OAAS,GAAK+5C,EAAM30C,GAAG+0C,WAAmC,IAAtBJ,EAAM30C,GAAG+0C,WACxEH,EAAM50C,GAAGg1C,SAAW,0BAA4BL,EAAM30C,GAAGi1C,cARzDL,GAAM50C,KAW1B,OAAO40C,GAKR,OAFAnf,GAAKqO,WAAY,EACjBrO,EAAKyf,eAAwB,KAAPzvC,EAAWqH,MAAM,IAAIoB,SAAWwmC,EAAiBjvC,GAChEgwB,EAAKkX,aAAalqC,KAAK,WAAA,MAAMgzB,GAAK0f,mBAAkB1yC,KAAK,WAAO,MAAOtH,SAAQC,aAErF,SAAAsK,GAED,MADA+vB,GAAKqO,WAAY,EACV3oC,QAAQE,OAAOqK,MAIxB0rC,iBAAkB,WAejB,IAAK,GAdCgE,GAAe,QAAfA,GAAe/pB,GACpB,GAAIA,EAAQ6E,MAAMt1B,OAAS,GAAKywB,EAAQ2H,IAEvC,MADA3H,GAAQgqB,SAAU,EACXhqB,CAER,KAAK,GAAIrrB,GAAE,EAAGA,EAAEqrB,EAAQC,YAAY1wB,OAAQoF,IAAK,CAChD,GAAMwqB,GAAS4qB,EAAa/pB,EAAQC,YAAYtrB,GAChD,IAAIwqB,EACH,MAAOA,GAGT,MAAO,OAGCxqB,EAAE,EAAGA,EAAEzG,KAAK8vC,UAAU9d,SAAS3wB,OAAQoF,IAAK,CACpD,GAAMwqB,GAAS4qB,EAAa77C,KAAK8vC,UAAU9d,SAASvrB,GACpD,IAAIwqB,EAAQ,MAAOA,GAGpB,MAAOjxB,MAAK8vC,UAAU9d,SAAS,IAGhC+pB,kBAAmB,WAClB,MAAIh5C,WAAUstB,aAAettB,UAAUstB,YAAc,aACxCrwB,KAAKirC,eAAgB,IAGlCjrC,KAAKirC,eAAgB,OACa,QAArBloC,UAAU+L,OACc,GAArB/L,UAAUmM,QACE8sC,UAAU,KAErBxgD,OAAO4T,QAAU5T,OAAO4T,OAAOC,gBAAgB2sC,UAAU1sC,YAAY,KAG/C,YAArBvM,UAAU+L,OACftT,OAAOssB,KAAOtsB,OAAOssB,IAAIk0B,UAAU,KAE9Bh8C,KAAKi8C,aACVvzC,EAAIqP,QAAQ,4DAA8DhV,UAAUwG,IAAM,YAAa,GAAI,SAInHukC,cAAe,SAAUoO,EAASC,GAAW,GAAA/f,GAAAp8B,IAClD,IAAG+C,UAAUuf,QAAgC,MAAtBvf,UAAUmM,QAWpB,MAVKlP,MAAKmK,UACNnK,KAAKmK,gBAETnK,MAAKozC,aAAalqC,KAAK,SAACgD,GACpBkwB,EAAKwf,iBAAiB1yC,KAAK,WACnBizC,GACA/f,EAAK97B,iBAAkB7E,cAAcC,aAAakB,8BAMlE,IAAIs/C,EAKA,MAJAn5C,WAAUoK,EAAI,GACdpK,UAAUmK,MAAQ,GAClBlN,KAAKmK,QAAQ8iB,aAAa,GAAGzM,MAAQ,MACrCxgB,MAAKozC,YAIJpzC,MAAKmK,UACNnK,KAAKmK,WAGT,IAAMiyC,GAAS,WACXhgB,EAAKigB,0BAAyB,EAE9B,IAAMC,GAAW,QAAXA,KACFlgB,EAAKgX,aAAalqC,KAAK,SAACgD,GACpB,GAA4C,oBAAxCiR,OAAOb,UAAU7R,SAASmS,MAAM1Q,IAAoC,KAAPA,GAAaiwC,EAAW,CACxF,GAAU,KAAPjwC,GAAanJ,UAAUkK,KAAOmvB,EAAK0T,UAAU3kC,UAAU,CACnDixB,EAAKwP,YAAc7oC,UAAUkK,GAE7B,IAAMsvC,GAAO,SAACxuC,GACV,MAAKA,GAGEnC,KAAKkB,MAAMlB,KAAKC,UAAUkC,IAFtBA,EAIfquB,GAAKjyB,QAAQgB,UAAYoxC,EAAKngB,EAAK0T,UAAU3kC,WAC7CixB,EAAKjyB,QAAQgB,UAAUkS,QAAQ,SAAA1N,GAAKA,EAAE6Q,MAAQ7Q,EAAE7F,KAAK0W,QAC7E4b,EAAKogB,cAEHL,GACsB/f,EAAKwf,iBAAiB1yC,KAAK,WACvBkzB,EAAKqgB,cAAcvzC,KAAK,WAChBizC,GACA/f,EAAK97B,iBAAkB7E,cAAcC,aAAakB,mCAOlE2H,YAAW,WAAY,MAAO+3C,MAAc,KAIxDA,KAECv5C,WAAUkK,KAAQlK,UAAU+L,SAChC/L,UAAUkK,IAAMxF,EAAAA,WAAM0rC,kBAER,QAArBpwC,UAAU+L,QAAsC,KAAlB/L,UAAUkK,IACjCjN,KAAKwvC,qBAAqBtmC,KAAK,WACvCkzC,MAGWA,KAMdC,yBAA0B,SAAUvJ,GAC1B,GAAM4J,GAAQ35C,UAAUwI,KAAOxI,UAAUkK,IACnC0vC,EAAWl1C,EAAAA,WAAMm1C,oBAAoBF,GACrCG,EAAYp1C,EAAAA,WAAMm1C,oBAAoB75C,UAAUwI,OACjDoxC,GAAYE,IACbp1C,EAAAA,WAAMq1C,oBAAoBJ,EAAOG,GACjCp1C,EAAAA,WAAMs1C,uBAAuBh6C,UAAUwI,OAEtCunC,IACG9yC,KAAK0uC,aAAe1uC,KAAK0uC,YAAYC,QACrC3uC,KAAK2rC,kBAAmB,EAExB3rC,KAAK2rC,kBAAmB,GAGH,KAAzB3rC,KAAK0rC,iBAA4C,KAAlB3oC,UAAUkK,MACzCjN,KAAK0rC,gBAAkB3oC,UAAUkK,MAI/CwvC,YAAa,WAAY,GAAA/f,GAAA18B,IACpB,SAAU+C,UAAU+L,QAAU,YAAc/L,UAAU+L,QAA+B,QAArB/L,UAAU+L,SAC7E/L,UAAUkK,IAAMxF,EAAAA,WAAM0rC,iBAEd,IAAM9D,GAAU,SAAC3oC,GACb,MAAOgC,GAAIqP,QAAQrR,EAAK,GAAG,MAAK,GAAOwC,KAAK,SAAAgD,GACxC,GAA+B,IAA3BA,EAAGU,aAAavL,OAChB,MAAOO,SAAQC,QAAQ,0CAE3B,IAAMd,GAAO6K,KAAKkB,MAAMZ,EAAGU,aAE3B,OADA8vB,GAAKvyB,QAAQ8iB,aAAa,GAAGzM,MAAQzf,EAAKA,KAAKi8C,WACxCp7C,QAAQC,QAAQ66B,EAAKvyB,QAAQ8iB,eACrC,SAAA9gB,GACC,MAAOvK,SAAQC,QAAQ,OAAOsK,EAAG,QAGrCzF,EAAM,wEAA0E3D,UAAUwG,IAAM,QAAUxG,UAAUkK,GACxH,OAAwB,QAArBlK,UAAU+L,OACF9O,KAAKwvC,qBAAqBtmC,KAAK,WAEjD,MADexC,GAAM,wEAA0E3D,UAAUwG,IAAM,QAAUxG,UAAUkK,IAC5HoiC,EAAQ3oC,KAGG2oC,EAAQ3oC,IAIvBu2C,gBAAgB,WACZ,GAAMC,GAAW,SAACC,GAEd,MAAO,IAAIv7C,SAAQ,SAACC,EAAQC,GAGxB,MAFAtG,QAAOssB,KAAOtsB,OAAOssB,IAAIs1B,cAAcr6C,UAAUwI,KAAO,aAAa4xC,GACrE11C,EAAAA,WAAMq1C,oBAAoB/5C,UAAUwI,KAAO,aAAc4xC,GAClDt7C,OAGTw7C,EAAiBzxC,KAAKC,UAAU7L,KAAKmK,QAAQ8iB,cAC7CqwB,EAAoB71C,EAAAA,WAAMkE,aAAa0xC,EAC7C,OAAOH,GAASI,IAGpB1B,eAAgB,WAAY,GAAAjf,GAAA38B,IACxB,IAAG+C,UAAUuf,QAAgC,MAAtBvf,UAAUmM,QAC7B,MAAO,IAAItN,SAAQ,SAACC,EAAQC,GACxB,GAAIy7C,GAAa,IAOjB,IANG/hD,OAAOssB,MACNy1B,EAAa/hD,OAAOssB,IAAI01B,cAAcz6C,UAAUwI,KAAO,eAEzC,OAAfgyC,IACCA,EAAa91C,EAAAA,WAAMm1C,oBAAoB75C,UAAUwI,KAAO,eAEzDgyC,EAAW,CACV,GAAIE,GAAS7xC,KAAKkB,MAAMrF,EAAAA,WAAMi2C,cAAcH,GAC5C,KAAI5gB,EAAKxyB,QAAQ8iB,aAEb,MADA0P,GAAKxyB,QAAQ8iB,aAAewwB,EACrB57C,EAAQ86B,EAAKxyB,QAAQ8iB,aAEhC,KAAI,GAAIxmB,GAAI,EAAEA,EAAIg3C,EAAOp8C,OAAOoF,IAC5B,IAAI,GAAI6M,GAAI,EAAEA,EAAIqpB,EAAKxyB,QAAQ8iB,aAAa5rB,OAAOiS,IAC/C,GAAIqpB,EAAKxyB,QAAQ8iB,aAAa3Z,GAAG/H,OAASkyC,EAAOh3C,GAAG8E,KAAM,CACtDoxB,EAAKxyB,QAAQ8iB,aAAa3Z,GAAGkN,MAA6Blf,SAApBm8C,EAAOh3C,GAAG+Z,MAAsBmc,EAAKxyB,QAAQ8iB,aAAa3Z,GAAGxJ,KAAK0W,MAAQi9B,EAAOh3C,GAAG+Z,KAC1H,OAIZ,MAAO3e,GAAQ86B,EAAKxyB,QAAQ8iB,cAE3B0P,EAAKxyB,QAAQ8iB,eACV0P,EAAKxyB,QAAQ8iB,eAAiBrtB,KAAM,OAAQ2L,KAAM,GAAImD,IAAI,YAAa5E,MAAQ9I,KAAM,SAAUwf,MAAO,KAC/F5gB,KAAM,OAAQ2L,KAAM,GAAImD,IAAI,YAAa5E,MAAQ9I,KAAM,SAAUwf,MAAO,KACvE5gB,KAAM,MAAO2L,KAAM,GAAImD,IAAI,YAAa5E,MAAQ9I,KAAM,SAAUwf,YAChE5gB,KAAM,MAAO2L,KAAM,GAAImD,IAAI,OAAQ5E,MAAQ9I,KAAM,SAAUwf,YAC3D5gB,KAAM,MAAO2L,KAAM,GAAImD,IAAI,QAAS5E,MAAQ9I,KAAM,SAAUwf,YAC5D5gB,KAAM,MAAO2L,KAAM,GAAImD,IAAI,MAAO5E,MAAQ9I,KAAM,SAAUwf,YAC1D5gB,KAAM,OAAQ2L,KAAM,GAAImD,IAAI,OAAQ5E,MAAQ9I,KAAM,SAAUwf,YAC5D5gB,KAAM,OAAQ2L,KAAM,GAAImD,IAAI,SAAU5E,MAAQ9I,KAAM,SAAUwf,YAC9D5gB,KAAM,MAAO2L,KAAM,GAAImD,IAAI,SAAU5E,MAAQ9I,KAAM,SAAUwf,YAC7D5gB,KAAM,MAAO2L,KAAM,GAAImD,IAAI,eAAgB5E,MAAQ9I,KAAM,SAAUwf,MAAO,KAC1E5gB,KAAM,KAAM2L,KAAM,GAAImD,IAAI,UAAW5E,MAAO9I,KAAM,SAAUwf,MAAO,KAE/E,KAAI,GAAI/Z,GAAI,EAAEA,EAAIk2B,EAAKxyB,QAAQ8iB,aAAa5rB,OAAOoF,IAC/Ck2B,EAAKxyB,QAAQ8iB,aAAaxmB,GAAG+Z,MAAQmc,EAAKxyB,QAAQ8iB,aAAaxmB,GAAGqD,KAAK0W,KAE3E,OAAO3e,GAAQ,OAI3B,IAAMwtC,GAAU,SAAC3oC,EAAKsF,GAAqB5K,UAAAC,OAAA,GAAAC,SAAAF,UAAA,IAAAA,UAAA,EACnC,OAAOsH,GAAIuD,QAAQvF,EAAKsF,EAAG,KAAM,KAAM9C,KAAK,SAAAgD,GACxC,GAA+B,IAA3BA,EAAGU,aAAavL,OAChB,MAAOO,SAAQC,QAAQ,2CAE3B,IAAIgL,KACJ,KACIA,EAAUjB,KAAKkB,MAAMZ,EAAGU,cAC3B,MAAOif,GACJ,MAAOjqB,SAAQC,QAAQ,4CAE3B,MAAuB,KAAnBgL,EAAQE,QACR4vB,EAAKxyB,QAAQ8iB,aAAa,GAAGzM,MAAQ3T,EAAQ9L,KAAK48C,kBAClDhhB,EAAKxyB,QAAQ8iB,aAAa,GAAGzM,MAAQ3T,EAAQ9L,KAAK68C,oBAAsB/wC,EAAQ9L,KAAK68C,oBAAsB,EAC3GjhB,EAAKuO,cAAgBr+B,EAAQ9L,KAAK88C,qBAAuBhxC,EAAQ9L,KAAK88C,qBAAuB,EAC7FlhB,EAAKwO,cAAgBt+B,EAAQ9L,KAAK+8C,iBAAmBjxC,EAAQ9L,KAAK+8C,iBAAmB,EAC9El8C,QAAQC,QAAQ86B,EAAKxyB,QAAQ8iB,gBAGpC0P,EAAKxyB,QAAQ8iB,aAAa,GAAGzM,MAAQ,EACrCmc,EAAKxyB,QAAQ8iB,aAAa,GAAGzM,MAAQ,EACrCmc,EAAKuO,cAAgB,EACrBvO,EAAKwO,cAAgB,EACdvpC,QAAQC,QAAQgL,KAE5B,SAAAV,GAGC,MAFAwwB,GAAKxyB,QAAQ8iB,aAAa,GAAGzM,MAAQ,EACrCmc,EAAKxyB,QAAQ8iB,aAAa,GAAGzM,MAAQ,EAC9B5e,QAAQC,QAAQ,cAAgBsK,EAAK,QAGlD0O,EAAM,WACR,GAAInU,GAAM,wDACN3F,EAAO,OAASgC,UAAUwG,GAO9B,OANyB,QAArBxG,UAAU+L,QAAyC,YAArB/L,UAAU+L,SACxCpI,EAAM,8DAAgE3D,UAAU+L,OAAQ,MAAQ/L,UAAU4M,EAAI,gBAAkB5M,UAAUstB,YAC1ItvB,EAAO,KAAO0wB,mBAAmBhqB,EAAAA,WAAM+pB,WAAWzuB,UAAUoK,EAAG,IAAM,UAAYskB,mBAAmBhqB,EAAAA,WAAM+pB,WAAWzuB,UAAUmK,MAAO,IAChI,YAAcukB,mBAAmBhqB,EAAAA,WAAM+pB,WAAWzuB,UAAUwG,IAAK,KAGxEozB,EAAK4N,aAAc,GAA6B,QAArBxnC,UAAU+L,QAAyC,YAArB/L,UAAU+L,QAA6C,QAArB/L,UAAU+L,OAE7F6tB,EAAKue,gBAAgB,IAAIhyC,KAAK,SAAAgD,GAE7B,MAAOmjC,GAAQ3oC,EAAK3F,IAEtB,SAAAoL,GAIE,MAFAwwB,GAAKxyB,QAAQ8iB,aAAa,GAAGzM,MAAQ,EACrCmc,EAAKxyB,QAAQ8iB,aAAa,GAAGzM,MAAQ,EAC9B5e,QAAQC,QAAQ,sBAG5BwtC,EAAQ3oC,EAAK3F,GAexB,OAbKf,MAAKmK,QAAQ8iB,eACdjtB,KAAKmK,QAAQ8iB,eAAiBrtB,KAAM,OAAQ2L,KAAM,GAAImD,IAAI,YAAa5E,MAAQ9I,KAAM,SAAUwf,MAAO,KAC/F5gB,KAAM,OAAQ2L,KAAM,GAAImD,IAAI,YAAa5E,MAAQ9I,KAAM,SAAUwf,MAAO,KACvE5gB,KAAM,MAAO2L,KAAM,GAAImD,IAAI,YAAa5E,MAAQ9I,KAAM,SAAUwf,YAChE5gB,KAAM,MAAO2L,KAAM,GAAImD,IAAI,OAAQ5E,MAAQ9I,KAAM,SAAUwf,YAC3D5gB,KAAM,MAAO2L,KAAM,GAAImD,IAAI,QAAS5E,MAAQ9I,KAAM,SAAUwf,YAC5D5gB,KAAM,MAAO2L,KAAM,GAAImD,IAAI,MAAO5E,MAAQ9I,KAAM,SAAUwf,YAC1D5gB,KAAM,OAAQ2L,KAAM,GAAImD,IAAI,OAAQ5E,MAAQ9I,KAAM,SAAUwf,YAC5D5gB,KAAM,OAAQ2L,KAAM,GAAImD,IAAI,SAAU5E,MAAQ9I,KAAM,SAAUwf,YAC9D5gB,KAAM,MAAO2L,KAAM,GAAImD,IAAI,SAAU5E,MAAQ9I,KAAM,SAAUwf,YAC7D5gB,KAAM,MAAO2L,KAAM,GAAImD,IAAI,eAAgB5E,MAAQ9I,KAAM,SAAUwf,MAAO,KAC1E5gB,KAAM,KAAM2L,KAAM,GAAImD,IAAI,UAAW5E,MAAO9I,KAAM,SAAUwf,MAAO,MAEvD,QAArBzd,UAAU+L,QACY,KAAlB/L,UAAUkK,IACFjN,KAAKwvC,qBAAqBtmC,KAAK,WACpD,MAAqB,KAAlBnG,UAAUkK,KACS0vB,EAAKxyB,QAAQ8iB,aAAa,GAAGzM,MAAQ,EACrCmc,EAAKxyB,QAAQ8iB,aAAa,GAAGzM,MAAQ,EACrCmc,EAAKuO,cAAgB,EACrBvO,EAAKwO,cAAgB,EACdvpC,QAAQC,SAASkL,OAAO,EAAEkB,QAAQ,aAClD4M,MAIIA,KAOfu4B,WAAY,SAAU2K,GAAU,GAAA/gB,GAAAh9B,IAQ/B,IAPQA,KAAKmK,QAAQgB,YACdnL,KAAKmK,QAAQgB,YAAcvL,KAAM,QAC7B2L,KAAM,GACNzB,MAAQ9I,KAAM,QAASwf,MAAO,GAC9BA,MAAO,KAGfzd,UAAUuf,QAAgC,MAAtBvf,UAAUmM,QAC1B,MAAO,IAAItN,SAAQ,SAACC,EAAQC,GACxB,GAAIk8C,GAAc,IAOlB,IANGxiD,OAAOssB,KAAOtsB,OAAOssB,IAAI01B,gBACxBQ,EAAcxiD,OAAOssB,IAAI01B,cAAcz6C,UAAUwI,KAAO,YAEzC,OAAhByyC,IACCA,EAAcv2C,EAAAA,WAAMm1C,oBAAoB75C,UAAUwI,KAAO,YAE1DyyC,EAAY,CAEX,IAAK,GADDP,GAAS7xC,KAAKkB,MAAMrF,EAAAA,WAAMi2C,cAAcM,IACnCv3C,EAAE,EAAGA,EAAEg3C,EAAOp8C,OAAQoF,IAC3B,IAAK,GAAI6M,GAAE,EAAGA,EAAE0pB,EAAK8S,UAAU3kC,UAAU9J,OAAQiS,IAC7C,GAAI0pB,EAAK8S,UAAU3kC,UAAUmI,GAAG/H,OAASkyC,EAAOh3C,GAAG8E,KAAM,CAC9BjK,SAApBm8C,EAAOh3C,GAAG+Z,QACTi9B,EAAOh3C,GAAG+Z,MAAQi9B,EAAOh3C,GAAGqD,KAAK0W,OAAS,GAE9Cwc,EAAK7yB,QAAQgB,UAAUmI,GAAKmqC,EAAOh3C,EACnC,OAIZ,MAAO5E,GAAQm7B,EAAK7yB,QAAQgB,WAE5B,MAAOtJ,GAAQ,OAK3B,IAAMwtC,GAAU,SAAC3oC,EAAKsF,GAClB,MAAOtD,GAAIuD,QAAQvF,EAAKsF,EAAG,KAAM,KAAM9C,KAAK,SAAAgD,GACxC,GAA+B,IAA3BA,EAAGU,aAAavL,OAChB,MAAOO,SAAQC,QAAQ,2CAE3B,IAAIgL,GAAUjB,KAAKkB,MAAMZ,EAAGU,aAC5B,IAAuB,IAAnBC,EAAQE,QAAgBF,EAAQE,YAAe,CAClD,GAAIF,EAAQE,YAAe,CAEpB,GAAIixC,GAAcv2C,EAAAA,WAAMm1C,oBAAoB75C,UAAUwI,KAAO,UAE7D,IADAsB,EAAQ9L,KAAKyC,QAA0B,OAAhBw6C,EAAuB,GAAKA,EAChDD,GAAYlxC,EAAQ1D,KAAO0D,EAAQ1D,IAAIiR,QAAQ,eAEjD,MADArX,WAAUkK,IAAM,GACTrL,QAAQC,QAAQgL,EAAQ1D,SAGjD,IAAuB,IAAnB0D,EAAQE,SAAiBF,EAAQ9L,KAAKyC,QAAS,CAElC,GAAIw6C,GAAcv2C,EAAAA,WAAMm1C,oBAAoB75C,UAAUwI,KAAO,UAAYxI,UAAUkK,IACnFxF,GAAAA,WAAMs1C,uBAAuBh6C,UAAUwI,KAAO,UAAYxI,UAAUkK,KAC/D+wC,IACDA,EAAcv2C,EAAAA,WAAMm1C,oBAAoB75C,UAAUwI,KAAO,WACzD9D,EAAAA,WAAMs1C,uBAAuBh6C,UAAUwI,KAAO,YAElDsB,EAAQ9L,KAAKyC,QAA0B,OAAhBw6C,EAAuB,GAAKA,EAEvD,GAA6B,KAAzBnxC,EAAQ9L,KAAKyC,SAAkBw5B,EAAK8S,UAAU3kC,UAAW,CACzD6xB,EAAK4O,YAAc7oC,UAAUkK,GAEhC,KAAK,GADDwwC,GAAS7xC,KAAKkB,MAAMrF,EAAAA,WAAMi2C,cAAc7wC,EAAQ9L,KAAKyC,UAChDiD,EAAE,EAAGA,EAAEg3C,EAAOp8C,OAAQoF,IACxB,IAAK,GAAI6M,GAAE,EAAGA,EAAE0pB,EAAK8S,UAAU3kC,UAAU9J,OAAQiS,IAC7C,GAAI0pB,EAAK8S,UAAU3kC,UAAUmI,GAAG/H,OAASkyC,EAAOh3C,GAAG8E,KAAM,CAC9BjK,SAApBm8C,EAAOh3C,GAAG+Z,QACTi9B,EAAOh3C,GAAG+Z,MAAQi9B,EAAOh3C,GAAGqD,KAAK0W,OAAS,GAE9Cwc,EAAK7yB,QAAQgB,UAAUmI,GAAKmqC,EAAOh3C,EACnC,OAIZ,MAAI,KAAMoG,EAAQE,aAAiBb,EAAGU,aAAawN,QAAQ,kBACtD4iB,EAAKwf,cAEH56C,QAAQC,QAAQm7B,EAAK7yB,QAAQgB,WAMzD,MAHmB6xB,GAAK4O,cAAgB7oC,UAAUkK,KAClC+vB,EAAK7yB,QAAQgB,UAAUkS,QAAQ,SAAA1N,GAAMA,EAAE6Q,MAAQ,IAExD5e,QAAQC,QAAQ,IAIV,MAAOD,SAAQC,QAAQ,YAAcgL,EAAQ1D,IAAM,IAAM0D,EAAQE,OAAS,MAC3E,SAAAZ,GACC,MAAOvK,SAAQC,QAAQ,cAAgBsK,EAAK,QAGhD8xC,EAAal7C,UAAUoK,GAAKpK,UAAUmK,MAAQ,EAAI,EAElDokB,EAAQ7pB,EAAAA,WAAMmlB,UAAYnlB,EAAAA,WAAMglB,WAChCljB,EAAwB,KAAlBxG,UAAUwG,IAAa,EAAI+E,SAASvL,UAAUwG,KACpDgoB,EAAQ,EAGRA,GADA0sB,EACQ,aAAsC,KAAvBl7C,UAAUm7C,SAAkB,SAAWn7C,UAAUm7C,UAClE,iBAA6C,KAA1Bn7C,UAAUo7C,YAAqB,iBAAmBp7C,UAAUo7C,aAC/E,2BAAuD,KAA1Bp7C,UAAUq7C,YAAqB,QAAUr7C,UAAUq7C,aAChF,QAAU70C,EAAM,SAAW+nB,EAAQ,UAAYvuB,UAAUmK,MAAQ,MAAQnK,UAAUoK,EACnF,mCAGE,OAAS5D,EAAM,SAAW+nB,EAAQ,kCAG9C/nB,EAAM9B,EAAAA,WAAM+pB,WAAWjoB,EAAK00C,GAC5B1sB,EAAQ9pB,EAAAA,WAAM+pB,WAAWjnB,EAAAA,WAAIC,KAAKD,EAAAA,WAAIC,KAAK+mB,IAAS0sB,GACpD3sB,EAAQ7pB,EAAAA,WAAM+pB,WAAWF,EAAO2sB,EAEhC,IAAIv3C,GAAM,+EACN3F,EAAO,OAAS0wB,mBAAmBloB,GAAO,SAAWkoB,mBAAmBF,GAAS,SAAWE,mBAAmBH,EAMnH,OAJoB,KAAhBvuB,UAAUoK,GAAgC,KAApBpK,UAAUmK,QAChCxG,EAAM,6DAA+D3D,UAAU+L,OAAQ,MAAQ/L,UAAU4M,EAAI,gBAAkB5M,UAAUstB,YACzItvB,GAAQf,KAAKq+C,gBAEVhP,EAAQ3oC,EAAK3F,IAGxBy7C,YAAa,WAAY,GAAArf,GAAAn9B,IACrB,IAAG+C,UAAUuf,QAAgC,MAAtBvf,UAAUmM,QAAgB,CAC7C,GAAMovC,GAAK,SAACC,GAER,MAAO,IAAI38C,SAAQ,SAACC,EAAQC,GAKxB,MAJAtG,QAAOssB,KAAOtsB,OAAOssB,IAAIs1B,eACrB5hD,OAAOssB,IAAIs1B,cAAcr6C,UAAUwI,KAAO,UAAUgzC,GAExD92C,EAAAA,WAAMq1C,oBAAoB/5C,UAAUwI,KAAO,UAAWgzC,GAC/C18C,OAGT28C,EAAc5yC,KAAKC,UAAU7L,KAAKmK,QAAQgB,WAC1CszC,EAAkBh3C,EAAAA,WAAMkE,aAAa6yC,EAC3C,OAAOF,GAAGG,GAGd,GAAMvB,GAAW,SAACx2C,EAAKsF,EAAG0yC,GAMtB,MAAOh2C,GAAIuD,QAAQvF,EAAKsF,EAAG,KAAM,KAAM9C,KAAK,SAAAgD,GAExC,GAA+B,IAA3BA,EAAGU,aAAavL,OAEhB,MADH87B,GAAKsc,UAAU,EAAG,wBACR73C,QAAQE,OAAO,qCAE1B,IAAI+K,GAAUjB,KAAKkB,MAAMZ,EAAGU,aAC5B,OAAuB,KAAnBC,EAAQE,OACDnL,QAAQC,UAGXgL,EAAQE,aACRtF,EAAAA,WAAMq1C,oBAAoB/5C,UAAUwI,KAAO,UAAYxI,UAAUkK,IAAKyxC,GACtEvhB,EAAKsc,UAAU,EAAG,uBACd73C,QAAQC,WAEY,IAAnBgL,EAAQE,QACbowB,EAAKsc,UAAU,EAAG,uBACX73C,QAAQE,OAAO+K,EAAQ1D,IAAM,KAAO0D,EAAQE,UAEvDowB,EAAKsc,UAAU,EAAG,wBACX73C,QAAQE,OAAO+K,EAAQ1D,IAAM,KAAO0D,EAAQE,UAExD,SAAAZ,GAIC,MAFA1E,GAAAA,WAAMq1C,oBAAoB/5C,UAAUwI,KAAO,UAAWmzC,GACtDvhB,EAAKsc,UAAU,EAAG,wBACX73C,QAAQE,OAAOqK,MAG1B8xC,EAAal7C,UAAUoK,GAAKpK,UAAUmK,MAAQ,EAAI,EAChDyxC,EAAM/yC,KAAKC,UAAU7L,KAAKmK,QAAQgB,WAClCyzC,EAAYn3C,EAAAA,WAAMkE,aAAagzC,GAE/BrtB,EAAQ7pB,EAAAA,WAAMmlB,UAAYnlB,EAAAA,WAAMglB,WAChCljB,EAAwB,KAAlBxG,UAAUwG,IAAa,EAAI+E,SAASvL,UAAUwG,KACtDgoB,EAAQ,EAGRA,GADA0sB,EACQ,aAAsC,KAAvBl7C,UAAUm7C,SAAkB,SAAWn7C,UAAUm7C,UAClE,YAAcU,EACd,iBAA6C,KAA1B77C,UAAUo7C,YAAqB,iBAAmBp7C,UAAUo7C,aAC/E,2BAAuD,KAA1Bp7C,UAAUq7C,YAAqB,QAAUr7C,UAAUq7C,aAChF,QAAU70C,EAAM,oBAAsB+nB,EAAQ,UAAYvuB,UAAUmK,MAAQ,MAAQnK,UAAUoK,EAC9F,mCAGE,WAAayxC,EAAY,QAAUr1C,EAAM,oBAAsB+nB,EAAQ,iCAGnF,IAAI5qB,GAAM,+EACN3F,EAAO,WAAa0wB,mBAAmBhqB,EAAAA,WAAM+pB,WAAWotB,EAAWX,IACjE,QAAUxsB,mBAAmBhqB,EAAAA,WAAM+pB,WAAWjoB,EAAK00C,IACnD,aAAexsB,mBAAmBhqB,EAAAA,WAAM+pB,WAAW,EAAGysB,IACtD,SAAWxsB,mBAAmBhqB,EAAAA,WAAM+pB,WAAWjnB,EAAAA,WAAIC,KAAKD,EAAAA,WAAIC,KAAK+mB,IAAS0sB,IAC1E,SAAWxsB,mBAAmBhqB,EAAAA,WAAM+pB,WAAWF,EAAO2sB,GAO5D,OALoB,KAAhBl7C,UAAUoK,GAAgC,KAApBpK,UAAUmK,QAChCxG,EAAM,6DAA+D3D,UAAU+L,OAAQ,MAAQ/L,UAAU4M,EAAI,gBAAkB5M,UAAUstB,YACzItvB,GAAQf,KAAKq+C,gBAGVnB,EAASx2C,EAAK3F,EAAM69C,IAG/BC,gBAAgB,SAAUC,GAAS,GAAAre,GAAAzgC,IAC/B,OAAOA,MAAKk7C,gBAAgB,IAAIhyC,KAAK,SAAAgD,GAEjC,GAAMmjC,GAAU,SAAC3oC,EAAIsF,GACjB,MAAOtD,GAAIuD,QAAQvF,EAAIsF,EAAE,KAAK,KAAM9C,KAAK,SAACgD,GACtC,GAA8B,IAA3BA,EAAGU,aAAavL,OACf,MAAOO,SAAQC,SAASkL,OAAO,QAAQ5D,IAAI,aAAaurB,MAAM,GAElE,IAAI7nB,GAAUjB,KAAKkB,MAAMZ,EAAGU,aAC5B,OAAsB,KAAnBC,EAAQE,QACJF,EAAQG,SAAWH,EAAQ9L,KAEnBa,QAAQC,SAASkL,OAAO,UAAU5D,IAAI0D,EAAQ1D,IAAIurB,MAAM7nB,EAAQ9L,KAAK2zB,QAO7E9yB,QAAQC,SAASkL,OAAO,OAAO5D,IAAI0D,EAAQ1D,IAAIurB,MAAM,KAC9D,SAACvoB,GACC,MAAOvK,SAAQC,SAASkL,OAAO,QAAQ5D,IAAI,aAAaurB,MAAM,OAIhEqqB,EAAa,SAAC/yC,GAChB,GAAI6pC,MACApvC,EAAI,CACR,KAAI,GAAIu4C,KAAMhzC,GACV6pC,EAAIpvC,GAAKgrB,mBAAmButB,GAAM,IAAMvtB,mBAAmBzlB,EAAEgzC,IAC7Dv4C,GAEJ,OAAOovC,GAAIzzB,KAAK,MAEhB1b,EAAM,6DACN3F,GACA+K,SAASrE,EAAAA,WAAM+pB,WAAWstB,EAAQ,GACjCxzC,QAAQ7D,EAAAA,WAAM+pB,WAAWzuB,UAAUwG,IAAI,GAY5C,OAVyB,QAArBxG,UAAU+L,QAAyC,YAArB/L,UAAU+L,SACxCpI,EAAM,+EAAiF3D,UAAU+L,OAAQ,MAAQ/L,UAAU4M,EAAI,gBAAkB5M,UAAUstB,YAC3JtvB,GACIoM,EAAE1F,EAAAA,WAAM+pB,WAAWzuB,UAAUoK,EAAG,GACjDD,MAAMzF,EAAAA,WAAM+pB,WAAWzuB,UAAUmK,MAAO,GACtBpB,SAASrE,EAAAA,WAAM+pB,WAAWstB,EAAQ,GAClCxzC,QAAQ7D,EAAAA,WAAM+pB,WAAWzuB,UAAUwG,IAAI,KAIzC8lC,EAAQ3oC,EAAIq4C,EAAWh+C,KAChC,SAAAoL,GAEE,GAAI9E,GAAI8E,EAAGiO,QAAQ,cAEnB,OADA/S,GAAIA,GAAK,EAAIA,EAAI8E,EAAGiO,QAAQ,cACxB/S,GAAK,EACoB,QAArBtE,UAAU+L,QAAyC,YAArB/L,UAAU+L,QAA6C,QAArB/L,UAAU+L,OAEnElN,QAAQC,SAASkL,OAAO,UAAU5D,IAAI,kBAAkBurB,YAEhEvoB,EAAGiO,QAAQ,iBAAmB,EAC7B5N,EAAAA,WAAOsf,MAAM3f,EAAGmK,OAAO,EAAGjP,IAAI6B,KAAK,WAE/B,MADHu3B,GAAKsL,UAAW,EACNnqC,QAAQE,UACnC,WAEoB,MADH2+B,GAAKsL,UAAW,EACNnqC,QAAQE,YAIfiB,UAAUstB,aAAe,UACzB70B,OAAOkR,SAAS2rC,KAAO,oBAEH,QAArBt1C,UAAU+L,QACT2xB,EAAKsL,UAAW,EAChBvwC,OAAOqE,QAAUrE,OAAOqE,OAAO44C,aAE/BjsC,EAAAA,WAAOsf,MAAM3f,EAAGmK,OAAO,EAAGjP,IAAI6B,KAAK,WAC/Bu3B,EAAKsL,UAAW,EAChBvwC,OAAOkR,SAAS2rC,KAAO,mBACzB,WACE5X,EAAKsL,UAAW,KAIrBnqC,QAAQE,eACR,GAAKqK,EAAGiO,QAAQ,UACvB5N,EAAAA,WAAOsf,MAAM,iBAAiB5iB,KAAK,WAE/B,MADHu3B,GAAKsL,UAAW,EACNnqC,QAAQE,UAChC,WAEiB,MADH2+B,GAAKsL,UAAW,EACNnqC,QAAQE,eAMrCm9C,aAAc,SAAUC,EAAQxlB,EAAaylB,EAAWC,GACvD,GAAM/P,GAAU,SAAC3oC,GACJ,MAAOgC,GAAIqP,QAAQrR,EAAK,IAAIwC,KAAK,SAAAgD,GAC7B,GAA+B,IAA3BA,EAAGU,aAAavL,OAChB,MAAOO,SAAQC,QAAQ,yCAE3B,IAAMd,GAAO6K,KAAKkB,MAAMZ,EAAGU,aAC3B,OAAOhL,SAAQC,QAAQd,EAAKkwB,SAC7B,SAAA9kB,GACC,MAAOvK,SAAQC,QAAQ,gBAGpCd,EAAO,QAAUm+C,GAAUxlB,EAAc,iBAAmBA,EAAc,eAAiBylB,GAAa,aAAeC,CAC/Gp/C,MAAKstC,eACJvsC,GAAQ,gBAErB,IAAI2F,GAAM,+DAAiE3F,CAE3E,OAAOsuC,GAAQ3oC,IAGV24C,aAAc,SAAUt1C,EAAOC,EAASC,EAAUI,EAASF,GAAS,GAAA62B,GAAAhhC,IACzEA,MAAKosC,cAAe,CACpB,IAAIkT,MACEC,EAAY,WACL,GAAIC,IAAUj2C,IAAKxG,UAAUwG,IAAKk2C,IAAKz1C,EAASkuC,OAAQnuC,EACjE21C,cAAeJ,EACAK,QAASx1C,EAAQ8iB,aAAa,GAAGzM,MACjCo/B,UAAmB,IAAR71C,EACX81C,MAAO11C,EAAQ8iB,aAAa,GAAGzM,MAC/Bs/B,UAAW9e,EAAKkK,cAChB6U,aAAc/e,EAAKmK,cACnBhgC,UAAW1D,EAAAA,WAAMkE,aAAaC,KAAKC,UAAU1B,EAAQgB,YACrDlB,SAAUA,EAES,SAArBlH,UAAU+L,QACVkyB,EAAK8K,gBAAkBzhC,EACE,MAAtBtH,UAAUmM,QACE8wC,UAAUp0C,KAAKC,UAAU2zC,IAEpChkD,OAAO4T,QAAU5T,OAAO4T,OAAOC,gBAAgB2wC,UAAU1wC,YAAY1D,KAAKC,UAAU2zC,KAG9D,YAArBz8C,UAAU+L,QACfkyB,EAAK8K,gBAAkBzhC,EACvB7O,OAAOssB,KAAOtsB,OAAOssB,IAAIk4B,UAAUp0C,KAAKC,UAAU2zC,KAEzB,QAArBz8C,UAAU+L,SACdkyB,EAAK8K,gBAAkBzhC,EACvBm1C,EAAOS,aAAe,OACrCT,EAAOj0C,KAAOxI,UAAUwI,KACT/P,OAAOqE,QAAUrE,OAAOqE,OAAOqgD,iBAAiBt0C,KAAKC,UAAU2zC,KAIvE,OAAyB,YAArBz8C,UAAU+L,QAA6C,QAArB/L,UAAU+L,QAAyC,QAArB/L,UAAU+L,OACtE/L,UAAUstB,YAAc,SAAgC,QAArBttB,UAAU+L,QAChDtC,EAAAA,WAAO4rC,KAAK,sBAAsBlvC,KAAK,KAAK,MACzClJ,KAAK+rC,UAAW,EAChB1hC,EAAS,GACLzI,QAAQC,QAAQy9C,IAEpBt/C,KAAK47C,iBAAiB1yC,KAAK,SAAAkvC,GACjC,GAAoB,gBAATA,GACV5rC,EAAAA,WAAOsf,MAAM,iBACbzhB,EAAS,OAEd,IAAI+tC,EAAKrrC,QAAUqrC,EAAKrrC,OAAO,GAAKqrC,EAAKrrC,OAAO,EACvChK,UAAUstB,aAAe,UAChB70B,OAAOkR,SAAS2rC,KAAO,oBAEH,QAArBt1C,UAAU+L,OACTtT,OAAOqE,QAAUrE,OAAOqE,OAAO44C,YAE/BjsC,EAAAA,WAAO4rC,KAAKA,EAAKjvC,KAAKD,KAAK,WACvB1N,OAAOkR,SAAS2rC,KAAO,oBAGjDhuC,EAAS,OAEL,CAAA,GAAI,MAAQ+tC,EAAKrrC,QAAWqrC,EAAKprC,QAInB,MAAOg0B,GAAKie,aAAal8C,UAAUwI,KAAM,KAAMvB,EAAS,OAAOd,KAAK,SAAAkvC,GAUhE,MAToB,gBAATA,IACP5rC,EAAAA,WAAOsf,MAAMssB,GACb/tC,EAAS,KAGZN,EAAQquC,EAAKF,OACboH,EAAYlH,EAAKsH,cACdH,KAEG39C,QAAQC,QAAQy9C,IAb3Bj1C,GAAS,GAgBb,MAAOzI,SAAQC,QAAQy9C,MAI3B9yC,EAAAA,WAAO4rC,KAAK,iBAAiBlvC,KAAK,KAAK,MACvClJ,KAAK+rC,UAAW,EAChB1hC,EAAS,GACFzI,QAAQC,QAAQy9C,KAIrCa,oBAAqB,SAAUC,GACrB,GAAIC,GAAQrgD,KAAK2vC,cAAcj8B,KAAKshC,MAAMsL,UAAU,sBACpD,KAAKD,EAAO,CACRA,EAAQrgD,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QACpCA,EAAMzgD,KAAO,qBAEb,IAAIsE,GAAalE,KAAK2vC,cAAcj8B,KAAKlR,IAAI+9C,SAAS,EAAG,EAAGF,EAC5Dn8C,GAAWs8C,UAAU,EAAK,IAC1Bt8C,EAAWu8C,SAAS,EAAG,EAAGzgD,KAAK2vC,cAAcj8B,KAAKshC,MAAMhvC,MAAOhG,KAAK2vC,cAAcj8B,KAAKshC,MAAM7uC,QAC7FjC,EAAWw8C,UACXx8C,EAAWtE,KAAO,aAClBsE,EAAW6yC,cAAe,CAE1B,IAAIn0C,IAAU8C,KAAM,UAAWiP,KAAM,OAAQgsC,aAAc,SAAUC,aAAc,UAC3F5uC,EAAOhS,KAAK2vC,cAAcj8B,KAAKlR,IAAIwP,KAAK,EAAG,EAAG,GAAIpP,EAAOy9C,EAC7DruC,GAAK6uC,cAAc,EAAG,EAAG7gD,KAAK2vC,cAAcj8B,KAAKshC,MAAMhvC,MAAOhG,KAAK2vC,cAAcj8B,KAAKshC,MAAM7uC,QAC5F6L,EAAKpS,KAAO,0BAEJ,GAAIoE,GAAMq8C,EAAMC,UAAU,0BACtBt8C,KACHA,EAAIgO,KAAO,aAAeouC,IAIrClmB,mBAAoB,SAAUR,EAAaonB,GAAiC,GAAAC,GAAA/gD,KAArBghD,IAAqB5/C,UAAAC,OAAA,GAAAC,SAAAF,UAAA,KAAAA,UAAA,EAClE,IAAyB,MAAtB2B,UAAUmM,SAAmBnM,UAAUuf,OAAO,CAC7C,GAAM5b,GAAMe,EAAAA,WAAMo+B,sBAAsBnM,GAClClb,EAAW,SAAAyiC,GACbD,GAAgBD,EAAKZ,oBAAoBc,EAAI5vC,QAEjD,OAAO3I,GAAI68B,QAAQ7+B,EAAI8X,GAAUtV,KAAK,SAACgD,GACnC,GAAIm0C,GAAQU,EAAKpR,cAAcj8B,KAAKshC,MAAMsL,UAAU,sBAIpD,OAHID,IACAA,EAAM1jC,UAEM,QAAZzQ,EAAG8B,KACIpM,QAAQC,QAAQqK,EAAG+kB,OAAO0F,OAEN,MAAtB5zB,UAAUmM,QACRtN,QAAQC,QAAQqK,EAAGyqB,OAGnB/0B,QAAQE,OAAOoK,EAAG+B,QAAU,SAAW/B,EAAG8B,QAIzD,GAAMqhC,GAAU,SAAC3oC,EAAKsF,GAClB,GAAMwS,GAAW,SAAAyiC,GACbD,GAAgBD,EAAKZ,oBAAoBc,EAAI5vC,QAEjD,OAAO3I,GAAIuD,QAAQvF,EAAKsF,EAAGwS,GAAUtV,KAAK,SAAAgD,GACtC,GAAIm0C,GAAQU,EAAKpR,cAAcj8B,KAAKshC,MAAMsL,UAAU,sBAIpD,IAHID,GACAA,EAAM1jC,UAEqB,IAA3BzQ,EAAGU,aAAavL,OAChB,MAAOO,SAAQE,OAAO,2CAE1B,IAAI+K,GAAUjB,KAAKkB,MAAMZ,EAAGU,aAC5B,OAAqB,QAAjBC,EAAQmB,KACDpM,QAAQC,QAAQgL,EAAQokB,OAAO0F,OAEZ,GAArB5zB,UAAUmM,QACRtN,QAAQC,QAAQgL,EAAQ8pB,OAGxB/0B,QAAQE,OAAO+K,EAAQoB,QAAU,SAAWpB,EAAQmB,OAEhE,SAAA7B,GACC,GAAIk0C,GAAQU,EAAKpR,cAAcj8B,KAAKshC,MAAMsL,UAAU,sBAIpD,OAHID,IACAA,EAAM1jC,UAEH/a,QAAQE,OAAOqK,MAGxB0O,EAAK,WACF9X,UAAUoK,GAAMpK,UAAUmK,OAA8B,QAArBnK,UAAU+L,SAC9C/L,UAAUkK,IAAMxF,EAAAA,WAAM0rC,iBAE1B,IAAIpyC,GAAO,QAAUgC,UAAUwI,KAAO,QAAUxI,UAAUkK,IAAM,iBAAmBysB,EAAc,QAAUonB,EAAa,cAAgB/9C,UAAU+L,OAAS,MAAQ,KAChKiyC,GAAKzT,eACJvsC,GAAQ,gBAEZ,IAAI2F,GAAM,oEAAsE3F,CAChF,OAAOsuC,GAAQ3oC,EAAK3F,GAGxB,OAAwB,QAArBgC,UAAU+L,QACY,KAAlB/L,UAAUkK,IACFjN,KAAKwvC,qBAAqBtmC,KAAK,WAClC,MAAO2R,OAMRA,KAKzBo9B,wBAAwB,SAAU1sC,EAAM2sC,EAAQze,EAAKynB,GAAU,GAAAC,GAAAnhD,IACrD,IAAGA,KAAKstC,aAAa,CACpB,GAAI8T,GAAW,EAENh1C,EAAM,SAACi1C,EAAU71C,EAAa0sC,EAAOoJ,GACvC,GAAIC,KACJJ,GAAKlC,aAAaoC,EAAW71C,EAAc,KAAM,OAAOtC,KAAK,SAAAkvC,GACrC,gBAATA,KACPF,EAASE,EAAKF,OACdqJ,EAAYnJ,EAAKsH,cAErB,IAAM8B,GAAe/5C,EAAAA,WAAMg6C,cAC3Bh6C,GAAAA,WAAM8E,QAAQ,KAAKrD,KAAK,WACpBsD,EAAAA,WAAOC,OAAO,OAAO,cAAeyrC,EAAQ,QAAQ,SAAS,KAAK,MAAK,GAAOhvC,KAAK,SAACC,GAChFokC,EAAAA,WAASnhC,IAAI8rC,EAAO1sC,EAAag2C,EAAah2C,EAAa,KAAK,EAAE,SAACrC,GAC5Dm4C,GAASA,EAAQn4C,MAE1B,SAACu4C,GACIJ,GAASA,EAAQ,iBAM9BA,EAAU,SAACn4C,GACjB,YAARA,EAEgBw4C,EAAep2C,EAAKkuB,EAAIye,GAC1B,WAAR/uC,EACa+3C,GAASA,EAAS,MACvB,SAAR/3C,GAERqD,EAAAA,WAAOC,OAAO,OAAO,wCAAwC,KAAK,KAAK,MAAK,EAAM,EAAE,GAAGvD,KAAK,WAClEy4C,EAAep2C,EAAKkuB,EAAIye,IAC1B,WACKgJ,GAASA,EAAS,SAK3CS,EAAiB,SAACn2C,EAAco2C,EAAYC,GAClCT,IACfD,EAAKjnB,mBAAmB1uB,EAAao2C,GAAa14C,KAAK,SAACkvC,GAElC8I,GAASA,EAAS9I,IACtC,SAACjvC,QAE2BA,EAAIiR,QAAQ,WACnB5N,EAAAA,WAAOsf,MAAM3iB,GAAKD,KAAK,WAASg4C,GAASA,EAAS,OAAO,WAASA,GAASA,EAAS,QAEtGE,GAAW,EACWh1C,EAAIrJ,UAAUwI,KAAKC,EAAaq2C,EAAcP,GAE3CF,EAAU,EACZE,EAAQ,QAEFJ,GAASA,EAAS,UAOzCS,GAAep2C,EAAKkuB,EAAIye,EAAOgJ,KAsBvCxI,cAAe,SAAUntC,EAAM2sC,EAAQze,EAAKynB,GAA6B,GAAAY,GAAA9hD,KAAnBwE,IAAmBpD,UAAAC,OAAA,GAAAC,SAAAF,UAAA,KAAAA,UAAA,EACrE,IAAI2B,UAAUstB,YAAc,SAAgC,QAArBttB,UAAU+L,OAG7C,MAFAtK,IAAcgI,EAAAA,WAAO4rC,KAAK,8BAC1B8I,IAAS,GAAO,EAGpB,IAAIK,KACJvhD,MAAKi/C,aAAal8C,UAAUwI,KAAMA,EAAM,KAAM,OAAOrC,KAAK,SAAAkvC,GAKtD,GAJiB,gBAATA,KACVF,EAASE,EAAKF,OACRqJ,EAAYnJ,EAAKsH,eAEI,QAArB38C,UAAU+L,OAAkB,CAC5B,GAAIizC,IAAax4C,IAAKxG,UAAUwG,IAAKgC,KAAMA,EAAM2sC,OAAQA,EAAQze,IAAKA,EAAKimB,cAAe6B,EAC1FO,GAAKjW,sBAAwBqV,EACL,GAArBn+C,UAAUmM,QACE8yC,OAAOp2C,KAAKC,UAAUk2C,IAEjCvmD,OAAO4T,QAAU5T,OAAO4T,OAAOC,gBAAgB2yC,OAAO1yC,YAAY1D,KAAKC,UAAUk2C,QAGpF,IAAyB,YAArBh/C,UAAU+L,OACftT,OAAOssB,KAAOtsB,OAAOssB,IAAIk6B,OAAOj/C,UAAUwG,IAAKgC,EAAM2sC,EAAQze,GAC7DqoB,EAAKjW,sBAAwBqV,MAC3B,IAAwB,QAArBn+C,UAAU+L,OAAiB,CAChCgzC,EAAKjW,sBAAwBqV,CAC7B,IAAM90C,GAAI,WACN,GAAI61C,IAAgB12C,KAAKxI,UAAUwI,KAC/BhC,IAAKxG,UAAUwG,IACfiC,aAAcD,EACd2sC,OAAQA,EACRze,IAAKA,EACLimB,cAAe6B,EACfW,UAAUn/C,UAAUkK,IACpBgzC,aAAa,UACjBzkD,QAAOqE,QAAUrE,OAAOqE,OAAOqgD,iBAAiBt0C,KAAKC,UAAUo2C,IAEpD,MAAlBl/C,UAAUkK,IACrB60C,EAAKtS,qBAAqBtmC,KAAK,WACT,KAAlBnG,UAAUkK,IAEZT,EAAAA,WAAO4rC,KAAK,oBAAoBlvC,KAAK,WACTg4C,GAAS,GAAO,GAAK,GACrB1lD,OAAOqE,QAAUrE,OAAOqE,OAAO44C,aACzD,WAC0ByI,GAAS,GAAO,GAAK,KAGzB90C,MAIjBA,QAMbiyC,aAAc,WACJ,GAAIlxC,GAAIskB,mBAAmBhqB,EAAAA,WAAM+pB,WAAWzuB,UAAUoK,EAAG,IACrDD,EAAQukB,mBAAmBhqB,EAAAA,WAAM+pB,WAAWzuB,UAAUmK,MAAO,IAC7DgxC,EAAWzsB,mBAAmBhqB,EAAAA,WAAM+pB,WAAkC,KAAvBzuB,UAAUm7C,SAAkB,SAAWn7C,UAAUm7C,SAAU,IAC1GC,EAAc1sB,mBAAmBhqB,EAAAA,WAAM+pB,WAAqC,KAA1BzuB,UAAUo7C,YAAqB,iBAAmBp7C,UAAUo7C,YAAa,IAC3HC,EAAc3sB,mBAAmBhqB,EAAAA,WAAM+pB,WAAqC,KAA1BzuB,UAAUq7C,YAAqB,QAAUr7C,UAAUq7C,YAAa,GAEtH,OAAO,MAAQjxC,EAAI,UAAYD,EAAQ,aAAegxC,EAChD,gBAAkBC,EAAc,0BAA4BC,GAG5ElD,gBAAiB,SAAU91C,GAC1B,GAAMiqC,GAAU,SAAC3oC,EAAKsF,GACrB,MAAOtD,GAAIuD,QAAQvF,EAAKsF,GAAG9C,KAAK,SAAAgD,GAC/B,GAA+B,IAA3BA,EAAGU,aAAavL,OACnB,MAAOO,SAAQE,OAAO,oCAEvB,IAAI+K,GAAUjB,KAAKkB,MAAMZ,EAAGU,aAC5B,IAAuB,IAAnBC,EAAQE,OAAc,CACP,GAAIsiB,GAAYxiB,EAAQ9L,KAAKyC,SAAW,GACpCssB,EAAYroB,EAAAA,WAAMi2C,cAAcruB,EACpC,OAAOztB,SAAQC,QAAQiuB,GAGzC,MAAOluB,SAAQE,OAAO+K,EAAQ1D,IAAM,aAAe0D,EAAQE,SAE1D,SAAAZ,GACF,MAAOvK,SAAQE,OAAOqK,MAIX8xC,EAAal7C,UAAUoK,GAAKpK,UAAUmK,MAAQ,EAAI,EAE3DokB,EAAQ7pB,EAAAA,WAAMmlB,UAAYnlB,EAAAA,WAAMglB,WAChCljB,EAAwB,KAAlBxG,UAAUwG,IAAa,EAAI+E,SAASvL,UAAUwG,KAC3CgoB,EAAQ,GACRvwB,EAAOoE,EAAQ,EAGfmsB,GADA0sB,EACQ,aAAsC,KAAvBl7C,UAAUm7C,SAAkB,SAAWn7C,UAAUm7C,UAChF,iBAA6C,KAA1Bn7C,UAAUo7C,YAAqB,iBAAmBp7C,UAAUo7C,aAC/E,2BAAuD,KAA1Bp7C,UAAUq7C,YAAqB,QAAUr7C,UAAUq7C,aAChF,QAAU70C,EAAM,SAAW+nB,EAAQ,UAAYvuB,UAAUmK,MAAQ,SAAWlM,EAAO,MAAQ+B,UAAUoK,EACrG,mCAGgB,OAAS5D,EAAM,SAAW+nB,EAAQ,SAAWtwB,EAAO,kCAGzEuI,EAAM9B,EAAAA,WAAM+pB,WAAWjoB,EAAK00C,GAC5B1sB,EAAQ9pB,EAAAA,WAAM+pB,WAAWjnB,EAAAA,WAAIC,KAAKD,EAAAA,WAAIC,KAAK+mB,IAAS0sB,GACpD3sB,EAAQ7pB,EAAAA,WAAM+pB,WAAWF,EAAO2sB,GAChCj9C,EAAOyG,EAAAA,WAAM+pB,WAAWxwB,EAAMi9C,EAErB,IAAIv3C,GAAM,8FACN3F,EAAO,OAAS0wB,mBAAmBloB,GAAO,SAAWkoB,mBAAmBF,GAAS,SAAWE,mBAAmBH,GAAS,SAAWG,mBAAmBzwB,EAOnK,OALoB,KAAhB+B,UAAUoK,GAAgC,KAApBpK,UAAUmK,QACvBxG,EAAM,8DAAgE3D,UAAU+L,OAAQ,MAAQ/L,UAAU4M,EAAI,gBAAkB5M,UAAUstB,YAC1ItvB,GAAQf,KAAKq+C,gBAGnBhP,EAAQ3oC,EAAK3F,IAGrBohD,gBAAiB,SAAU/8C,GACjB,GAAM83C,GAAW,SAACx2C,EAAKsF,GACnB,MAAOtD,GAAIuD,QAAQvF,EAAKsF,GAAG9C,KAAK,SAAAgD,GAC5B,GAA+B,IAA3BA,EAAGU,aAAavL,OAChB,MAAOO,SAAQE,OAAO,qCAE1B,IAAI+K,GAAUjB,KAAKkB,MAAMZ,EAAGU,aAC5B,OAAuB,KAAnBC,EAAQE,OACDnL,QAAQC,UAGRD,QAAQE,OAAO+K,EAAQ1D,IAAM,KAAO0D,EAAQE,SAExD,SAAAZ,GACC,MAAOvK,SAAQE,OAAOqK,MAI1B8xC,EAAal7C,UAAUoK,GAAKpK,UAAUmK,MAAQ,EAAI,EAChDyxC,EAAM/yC,KAAKC,UAAU7L,KAAKoiD,eAAeh9C,IACzCw5C,EAAYn3C,EAAAA,WAAMkE,aAAagzC,GAE/BrtB,EAAQ7pB,EAAAA,WAAMmlB,UAAYnlB,EAAAA,WAAMglB,WAChCljB,EAAwB,KAAlBxG,UAAUwG,IAAa,EAAI+E,SAASvL,UAAUwG,KACtDgoB,EAAQ,EAGRA,GADA0sB,EACQ,aAAsC,KAAvBl7C,UAAUm7C,SAAkB,SAAWn7C,UAAUm7C,UACjF,YAAcU,EACC,iBAA6C,KAA1B77C,UAAUo7C,YAAqB,iBAAmBp7C,UAAUo7C,aAC/E,2BAAuD,KAA1Bp7C,UAAUq7C,YAAqB,QAAUr7C,UAAUq7C,aAC/F,QAAU70C,EAAM,oBAAsB+nB,EAAQ,UAAYvuB,UAAUmK,MAAQ,SAAW9H,EAAQ,MAAQrC,UAAUoK,EACjH,mCAGiB,WAAayxC,EAAY,QAAUr1C,EAAM,oBAAsB+nB,EAAQ,SAAWlsB,EAAQ,iCAGtG,IAAIsB,GAAM,8FACN3F,EAAO,WAAa0wB,mBAAmBhqB,EAAAA,WAAM+pB,WAAWotB,EAAWX,IACjE,QAAUxsB,mBAAmBhqB,EAAAA,WAAM+pB,WAAWjoB,EAAK00C,IACnD,aAAexsB,mBAAmBhqB,EAAAA,WAAM+pB,WAAW,EAAGysB,IACtD,SAAWxsB,mBAAmBhqB,EAAAA,WAAM+pB,WAAWjnB,EAAAA,WAAIC,KAAKD,EAAAA,WAAIC,KAAK+mB,IAAS0sB,IAC1E,SAAWxsB,mBAAmBhqB,EAAAA,WAAM+pB,WAAWF,EAAO2sB,IACtD,SAAWxsB,mBAAmBhqB,EAAAA,WAAM+pB,WAAWpsB,EAAM,GAAI64C,GAO/D,OALoB,KAAhBl7C,UAAUoK,GAAgC,KAApBpK,UAAUmK,QAChCxG,EAAM,8DAAgE3D,UAAU+L,OAAQ,MAAQ/L,UAAU4M,EAAI,gBAAkB5M,UAAUstB,YAC1ItvB,GAAQf,KAAKq+C,gBAGVnB,EAASx2C,EAAK3F,IAGzBshD,YAAa,SAASC,EAAOC,GAiBzB,IAAK,GAhBD9b,MACE+b,EAAa,QAAbA,GAAcvR,EAAUpxC,GAC1B,IAAK,GAAI4G,GAAE,EAAGA,EAAEwqC,EAAS5vC,OAAQoF,IAC7B,GAAKwqC,EAASxqC,GAAGg8C,OAAUxR,EAASxqC,GAAGi8C,MAAvC,CAGA,GAAIxR,IAAStxC,KAAKqxC,EAASxqC,GAAG7G,KAAM+iD,aAAa1R,EAASxqC,GAAGk8C,aAAcF,MAAMxR,EAASxqC,GAAGg8C,MAAOC,MAAMzR,EAASxqC,GAAGi8C,MAClIE,WAAY3R,EAASxqC,GAAGm8C,WAAYvuC,MAAM48B,EAASxqC,GAAG4N,MAAOs6B,QAAQsC,EAASxqC,GAAGkoC,QACrEuC,GAAMD,YACuB,UAAzBA,EAASxqC,GAAGo8C,WACZpc,EAAKqc,aAAe7R,EAASxqC,GAAGq8C,cAEpCN,EAAWvR,EAASxqC,GAAGwqC,SAAUC,GACjCrxC,EAAOoxC,SAAS1tB,KAAK2tB,KAGpBzqC,EAAE,EAAG67C,GAAS77C,EAAE67C,EAAMjhD,OAAQoF,IAC9B67C,EAAM77C,GAAG5G,SAGd4mC,GAAQ7mC,KAAK0iD,EAAM77C,GAAG7G,KAAM+iD,aAAaL,EAAM77C,GAAGk8C,aAAcF,MAAMH,EAAM77C,GAAGg8C,MAAOC,MAAMJ,EAAM77C,GAAGi8C,MAAOE,WAAWN,EAAM77C,GAAGm8C,WACzIvuC,MAAMiuC,EAAM77C,GAAG4N,MAAOxU,OAAOyiD,EAAM77C,GAAG5G,OAAOD,KAAMmT,EAAGuvC,EAAM77C,GAAGsM,EAAGiB,EAAGsuC,EAAM77C,GAAGuN,EAAG26B,QAAQ2T,EAAM77C,GAAGkoC,SACzFlI,EAAKwK,YACqB,UAAtBqR,EAAM77C,GAAGo8C,WACZpc,EAAKqc,aAAeR,EAAM77C,GAAGq8C,cAEtCR,EAAM77C,GAAGs8C,eACAtc,EAAKsc,aAAeT,EAAM77C,GAAGs8C,cAE9BP,EAAWF,EAAM77C,GAAGwqC,SAAUxK,GAC9B8b,EAAQh/B,KAAKkjB,KAIrBuc,oBAAqB,SAASC,GAC1B,GAAMjS,GAAUhxC,KAAK8vC,UAAUkB,OAC/B,KAAK,GAAIvqC,KAAKuqC,GAAS,CACnB,GAAIvqC,IAAMw8C,EACN,MAAOjS,GAAQvqC,GAAGqqC,OAAO7lB,QAGzB,KAAK,GAAI3X,KAAK09B,GAAQC,SAClB,GAAID,EAAQC,SAAS39B,GAAG2vC,MAAQA,EAC5B,MAAOjS,GAAQC,SAAS39B,GAAGw9B,OAAO7lB,WAOtDi4B,kBAAmB,SAASh7C,EAAKi7C,GAC7B,GAAIC,IAAW,CACf,IAAID,GAAcA,EAAWE,gBAAkBF,EAAWE,eAAeC,gBACrE,IAAK,GAAI3zC,GAAE,EAAGA,EAAEwzC,EAAWE,eAAeC,gBAAgBjiD,OAAQsO,IAC9D,GAAIzH,EAAIy6C,eAAiBQ,EAAWE,eAAeC,gBAAgB3zC,GAAI,CACnEyzC,GAAW,CACX,OAIZ,GAAIG,IAAQ3jD,KAAMsI,EAAI+6C,IAChBN,aAAcz6C,EAAIy6C,aAClBF,MAAkD,oBAA3CtlC,OAAOb,UAAU7R,SAASmS,MAAM1U,EAAI6K,GAA2B7K,EAAI6K,GAAK/R,KAAM,UAAWwf,MAAOtY,EAAI6K,GAC3G2vC,MAAkD,oBAA3CvlC,OAAOb,UAAU7R,SAASmS,MAAM1U,EAAI8L,GAA2B9L,EAAI8L,GAAKhT,KAAM,UAAWwf,MAAOtY,EAAI8L,GAC3GK,OAAQtB,EAAG7K,EAAImM,MAAOL,EAAG9L,EAAImM,MAAOrT,KAAM,IAC1C2tC,QAASyU,EACfl7C,GAAI46C,eAAiBS,EAAKT,aAAe56C,EAAI46C,cAC7CS,EAAKtS,WACL,KAAK,GAAI5pC,GAAE,EAAGA,EAAEa,EAAI+oC,SAAS5vC,OAAQgG,IACjCk8C,EAAKtS,SAAS5pC,GAAKrH,KAAKkjD,kBAAkBh7C,EAAI+oC,SAAS5pC,GAAI87C,GAC3DI,EAAKtS,SAAS5pC,GAAGu7C,WAAa5iD,KAAKgjD,oBAAoB96C,EAAI+6C,IAE/D,OAAOM,IAGjBC,eAAgB,WAEN,IAAKxjD,KAAKyjD,aAAa9U,QACnB,MAAO,EAEX,IAAI9yB,GAAI7b,KAAKyjD,aAAanD,UAAU,OACpC,OAAIzkC,IAAKA,EAAE8yB,QACA,SAEX9yB,EAAI7b,KAAKyjD,aAAanD,UAAU,QAC5BzkC,GAAKA,EAAE8yB,QACA,SAEX9yB,EAAI7b,KAAKyjD,aAAanD,UAAU,QAC5BzkC,GAAKA,EAAE8yB,QACA,SAGX9yB,EAAI7b,KAAKyjD,aAAanD,UAAU,gBAC5BzkC,GAAKA,EAAE8yB,QACA,gBAGX9yB,EAAI7b,KAAKyjD,aAAanD,UAAU,WAC5BzkC,GAAKA,EAAE8yB,QACA,iBAGX9yB,EAAI7b,KAAKyjD,aAAanD,UAAU,aAC5BzkC,GAAKA,EAAE8yB,QACA,aAGX9yB,EAAI7b,KAAKyjD,aAAanD,UAAU,iBAC5BzkC,GAAKA,EAAE8yB,QACA,cAEJ,UAIjB+U,eAAe,WACd,MAAG1jD,MAAKssC,aAAa98B,QAAS,EAEtB5D,KAAKkB,MAAMlB,KAAKC,UAAU7L,KAAKssC,gBAE/BC,MAAM,EAAEj8B,SAAS,EAAEC,MAAM,EAAEf,MAAK,EAAMunB,SAAS,OAMxD4sB,cAAc,SAAUxzC,GACvB,GAAI0lC,KACK,IAAG71C,KAAK2sC,iBAAiBtrC,OAAS,EAC9B,IAAI,GAAIoF,GAAI,EAAGA,EAAIzG,KAAK2sC,iBAAiBtrC,OAAOoF,IAAI,CAChD,GAAIrC,GAASpE,KAAK2sC,iBAAiBlmC,EAChC0J,IACjBnQ,KAAK4jD,gBAAgBn9C,EAGP,KAAI,GADAivC,MACIpiC,EAAI,EAAEA,EAAIlP,EAAOy/C,WAAWxiD,OAAOiS,IAEvCoiC,EAAOnyB,KAAKnf,EAAOy/C,WAAWvwC,GAGlC,KAAI,GADAwwC,MACI5yC,EAAI,EAAEA,EAAI9M,EAAO0/C,UAAUziD,OAAO6P,IAEtC4yC,EAAUvgC,KAAKnf,EAAO0/C,UAAU5yC,GAEpC2kC,GAAItyB,MAAMyyB,WAAW5xC,EAAO2yB,SAAS2e,OAAOA,EAAOoO,UAAUA,EAAUC,OAAO3/C,EAAO2/C,OAAOC,UAAU5/C,EAAO4/C,YAGrH,MAAOnO,IAKjBoO,YAAY,WACX,IADuB,GAAAC,GAAAlkD,KAAA46B,EAAA,WAEV,GAAIupB,GAAQD,EAAKrX,oBAAoB1qB,QAC/BiiC,EAAY,SAACvO,EAAItqC,GACnB,IAAI,GAAI9E,GAAI,EAAEA,EAAIovC,EAAIx0C,OAAOoF,IAC5B,GAAGovC,EAAIpvC,GAAG8E,OAASA,EAAK,CACjBsqC,EAAI92B,OAAOtY,EAAE,EACnB,QAINy9C,GAAKvX,iBAAiBtvB,QAAQ,SAACjL,EAAEhN,GAChCg/C,EAAUhyC,EAAEyxC,WAAWM,GACvBC,EAAUhyC,EAAE0xC,UAAUK,MAZ7BnkD,KAAK6sC,oBAAoBxrC,OAAS,KAAKu5B,KAoB/CgpB,gBAAgB,SAAU5I,GAAI,GAAAqJ,GAAArkD,KAEvBskD,EAAa,SAAC/4C,GACnB,GAAMg5C,GAAgB,SAACh5C,GACtB,IAAI,GAAI9E,GAAI,EAAEA,EAAE49C,EAAKxX,oBAAoBxrC,OAAOoF,IAC7B,GAAG49C,EAAKxX,oBAAoBpmC,KAAO8E,EAAM,MAAO9E,EAEnE,WAEG+9C,EAASD,EAAch5C,EAC3Bi5C,SAAiBH,EAAKxX,oBAAoB9tB,OAAOylC,EAAO,GAEhD,IAAGxJ,OAEC,GAAwC,IAArCh7C,KAAK2sC,iBAAiBqO,GAAIn8B,OAAa,CAGtC,IAAI,GADE4lC,GAAezkD,KAAK2sC,iBAAiBqO,GACnCv0C,EAAI,EAAEA,EAAIg+C,EAAaZ,WAAWxiD,OAAOoF,IAC7C69C,EAAWG,EAAaZ,WAAWp9C,GAAG8E,KAE1CvL,MAAK0kD,YAAYxiD,YAAYuiD,GAC7BzkD,KAAK2sC,iBAAiB5tB,OAAOi8B,EAAG,GAChCyJ,EAAa9nC,cACX,IAAwC,IAArC3c,KAAK2sC,iBAAiBqO,GAAIn8B,OAAa,CAE5C,GAAM8lC,GAAW,SAACC,GACd,IAAI,GAAIn+C,GAAG,EAAEA,EAAI49C,EAAK1X,iBAAiBqO,GAAI6I,WAAWxiD,OAAOoF,IACzD,GAAG49C,EAAK1X,iBAAiBqO,GAAI6I,WAAWp9C,GAAG8E,OAASq5C,EAAGr5C,KACtD,MAAO9E,EAGZ,UAEJzG,MAAK2sC,iBAAiBqO,GAAI8I,UAAUzmC,QAAQ,SAACunC,EAAGC,GAC9D,GAAIz/C,GAAQu/C,EAASC,EACrBN,GAAWM,EAAGr5C,MACInG,QAAgBi/C,EAAK1X,iBAAiBqO,GAAI6I,WAAW9kC,OAAO3Z,EAAM;AAEtEpF,KAAK2sC,iBAAiBqO,GAAI8I,eAK5CgB,WAAY,SAAU1/C,EAAOy0C,GAAM,GAAAkL,GAAA/kD,IAElC,IAAc,IAAVoF,GAAepF,KAAK8vC,UAAUkV,iBAAiBC,iBAAmBpL,EACrE,MAAOj4C,SAAQC,QAAQ,KAEf,IAAMknC,GAAO,YACRgc,EAAK3C,gBAAkB2C,EAAK/R,UAC7B,IAAMrmB,GAAYI,KAAK2F,MAEnBwyB,KACA/a,KACAgb,IACJJ,GAAK1C,YAAY0C,EAAKG,YAAaA,GACnCH,EAAK1C,YAAY0C,EAAK5a,UAAWA,GACjC4a,EAAKd,aAEL,IAAMmB,KA4CN,IA3CAA,EAAS9J,SAAWyJ,EAAK9V,WAAWtY,MAAMouB,EAAKtO,cAAclrC,KAC7D65C,EAAS1rB,YAAcqrB,EAAK9V,WAAW1jC,KACvC65C,EAASC,MAAQN,EAAKO,aACtBF,EAASG,UAAYR,EAAKS,iBAC1BJ,EAASK,OAASV,EAAKW,cACvBN,EAASO,QAAUZ,EAAKa,WACxBR,EAASpa,aAAe+Z,EAAK/Z,aAC7Boa,EAASz4B,UAAYA,EACrBy4B,EAASj7C,QAAUyB,KAAKkB,MAAMlB,KAAKC,UAAUk5C,EAAK56C,UAClDi7C,EAAS3J,SAAWsJ,EAAKtJ,SACzB2J,EAAShP,YAAc2O,EAAKvB,iBAC5B4B,EAASF,YAAcA,EAAYj6B,SACnCm6B,EAASjb,UAAYA,EAAUlf,SAC/Bm6B,EAASlb,aAAe6a,EAAK7a,aAAajf,SAC1Cm6B,EAASS,cAAgBC,MAAM,MAC/BV,EAASS,aAAaC,MAAQf,EAAKrB,iBAAiB3sB,SACpDquB,EAAS1P,UACT0P,EAAS1P,OAASqP,EAAKpB,gBAAgB14B,SACvCm6B,EAASW,eACTX,EAASW,YAAchB,EAAKlY,qBAAuBkY,EAAKlY,oBAAoB5hB,SACxE,QAAUloB,UAAU+L,QAAU,SAAW/L,UAAUstB,aACnD+0B,EAAS/xB,OAAS3sB,IAAK8sB,EAAAA,WAAW3jB,UAAUnB,IAAKa,OAAQikB,EAAAA,WAAW3jB,UAAUC,WAAa0jB,EAAAA,WAAW3jB,UAAUN,OAAOQ,cAAcyjB,EAAAA,WAAW3jB,UAAUE,eAC1Jq1C,EAAS9xB,OAASE,EAAAA,WAAW1iB,WAAWupB,IAAI,SAAAt1B,GACxC,MAAIA,GAAE2J,KACMhI,IAAK3B,EAAE2J,IAAKa,OAAQxK,EAAE+K,WAAa/K,EAAEwK,OAAQ6c,KAAMrnB,EAAEyK,KAAO,EAAI,EAAEO,cAAchL,EAAEgL,eAEvF,SAGXq1C,EAAS/xB,OAAS3sB,IAAKq+C,EAAK/c,UAAY+c,EAAK/c,SAASt5B,IAAKa,OAAQw1C,EAAK/c,WAAa+c,EAAK/c,SAASl4B,WAAai1C,EAAK/c,SAASz4B,QAAQQ,cAAeg1C,EAAK/c,UAAY+c,EAAK/c,SAASj4B,eACpLq1C,EAAS9xB,OAASyxB,EAAK9c,WAAW5N,IAAI,SAAAt1B,GAClC,MAAIA,IAEI2B,IAAK3B,EAAE2J,IACPa,OAAQxK,EAAE+K,WAAa/K,EAAEwK,OACzB6c,KAAMrnB,EAAEyK,KAAO,EAAI,EAC3CO,cAAchL,EAAEgL,eAGO,QAIS,KAApBg1C,EAAKa,WAAmB,CACxBb,EAAK9N,oBAAsB8N,EAAK9N,mBAAmBhG,SAAS5zB,QAAQ,SAAA5K,GAChE,GAAI5L,GAAI4L,EAAEw+B,SAAS,GACfjoC,GAAQtC,IAAIG,EAAE6H,IAAKqE,EAAElM,EAAEkM,EAAGiB,EAAEnN,EAAEmN,EAAGhO,MAAMa,EAAEb,MAAOG,OAAOU,EAAEV,OAAQ6/C,QAASn/C,EAAEwhC,MAAO4d,OAAQp/C,EAAEq/C,MAAMnzC,EAAGozC,OAAQt/C,EAAEq/C,MAAMlyC,EACpHoyC,OAAOv/C,EAAEwN,MAAMtB,EAAGszC,OAAOx/C,EAAEwN,MAAML,EAAGsyC,OAAOz/C,EAAEwwC,MAAOsO,QAAQ9+C,EAAE8+C,QAASvgD,MAAMqN,EAAE8zC,OAAQC,YAAa/zC,EAAE4B,MAAMtB,EAAE0zC,UAAS5/C,EAAE4/C,SAAU5/C,EAAE4/C,QAAiBC,UAAS7/C,EAAE6/C,SAAU7/C,EAAE6/C,QAE/K7/C,GAAEuwC,aACFpuC,EAAK+J,EAAIlM,EAAEuwC,WAAWrkC,EACtB/J,EAAKgL,EAAInN,EAAEuwC,WAAWpjC,EACtBhL,EAAKg9C,QAAUn/C,EAAEuwC,WAAW/O,MAC5Br/B,EAAKs9C,OAASz/C,EAAEuwC,WAAWC,OAE3B5kC,EAAE2kC,aACFpuC,EAAKw9C,YAAc/zC,EAAE2kC,WAAW/iC,MAAMtB,GAE1CoyC,EAAW5hC,KAAKva,IAGpB,IAAImtC,GAAK4O,EAAK/K,aAAa/I,SAAS,EACpCmU,GAASjP,MACLA,IACAiP,EAASjP,IAAMzvC,IAAKyvC,EAAGznC,IAAKs3C,QAAS7P,EAAG9N,OACxC8N,EAAGiB,aAAegO,EAASjP,GAAG6P,QAAU7P,EAAGiB,WAAW/O,QAS9D,MALA+c,GAAS3P,cAAgB0P,EAAWl6B,SACpCm6B,EAASlP,WAAa6O,EAAKja,cAAc7f,SACzCm6B,EAASra,SAAWga,EAAKha,SAAS9f,SAClC85B,EAAK3C,eAAeh9C,GAASwG,KAAKkB,MAAMlB,KAAKC,UAAUu5C,IACvDL,EAAKxa,WAAawa,EAAKva,YAAcua,EAAKpJ,eAAev2C,GAASwG,KAAKkB,MAAMlB,KAAKC,UAAUu5C,KACrFL,EAAKK,SAAShgD,EAAOy0C,GAAM3wC,KAAK,SAAAgD,GAAO,MAAOtK,SAAQC,QAAQujD,IAAY,SAAAj5C,GAAO,MAAOvK,SAAQC,QAAQ,QAG5H,OAAGg4C,MAAS,GAAQ75C,KAAKuqC,aAAc,EAWnBxB,QATP/oC,MAAKi7C,aAAa/xC,KAAK,WAGlC,MADe67C,GAAKva,WAAY,EACzBzB,KACM,WAEE,MAAOA,QAOzB4d,WAAY,SAAUvhD,GAAO,GAAAwhD,GAAA5mD,MAC3BA,KAAKoiD,gBAAkBpiD,KAAKgzC,UADD,IAAA6T,GAEoC7mD,KAAKoiD,eAAeh9C,GAApEk2C,EAFYuL,EAEZvL,SAAU5hB,EAFEmtB,EAEFntB,YAAavvB,EAFX08C,EAEW18C,QAAS+/B,EAFpB2c,EAEoB3c,aACjC4c,EAAW,SAACC,EAAUC,GACxBJ,EAAKK,aACLL,EAAKha,wBACLga,EAAKtB,aAAesB,EAAKxE,eAAeh9C,GAAOigD,MAC/CuB,EAAKpB,iBAAmBoB,EAAKxE,eAAeh9C,GAAOmgD,UACnDqB,EAAKlB,cAAgBkB,EAAKxE,eAAeh9C,GAAOqgD,OAChDmB,EAAK1B,YAAc0B,EAAKxE,eAAeh9C,GAAO8/C,YAAYj6B,SAC1D27B,EAAKzc,UAAYyc,EAAKxE,eAAeh9C,GAAO+kC,UAAUlf,SACtD27B,EAAKM,kBAAoBN,EAAKxE,eAAeh9C,GAAOqwC,cAAcxqB,SAClE27B,EAAK9b,cAAgB8b,EAAKxE,eAAeh9C,GAAO8wC,WAAa0Q,EAAKxE,eAAeh9C,GAAO8wC,WAAWjrB,YACnG27B,EAAK7b,SAAW6b,EAAKxE,eAAeh9C,GAAO2lC,SAAW6b,EAAKxE,eAAeh9C,GAAO2lC,SAAS9f,YAC1F27B,EAAKhB,WAAagB,EAAKxE,eAAeh9C,GAAOugD,QAC7CiB,EAAK5b,aAAe4b,EAAKxE,eAAeh9C,GAAO4lC,aAC/C4b,EAAKha,qBAAuBga,EAAKxE,eAAeh9C,GAAOswC,OAASkR,EAAKxE,eAAeh9C,GAAOswC,OAAOzqB,YAClG27B,EAAK/Z,oBAAsB+Z,EAAKxE,eAAeh9C,GAAO2gD,YAAca,EAAKxE,eAAeh9C,GAAO2gD,YAAY96B,YAG3G27B,EAAKnc,cAAc,KAAOmc,EAAKnc,cAAc,GAAGkE,SAAU,GAC1DiY,EAAKnc,cAAgBmc,EAAKnc,cAAcp0B,MAAM,GAC9CuwC,EAAKlY,YAAYC,SAAU,EAC3BiY,EAAKhU,cAAcjE,SAAU,EAC7BiY,EAAKO,SAASxY,SAAU,EACxBiY,EAAKlP,WACLkP,EAAKtP,mBACLsP,EAAK1c,gBACLA,EAAa7sB,QAAQ,SAAArR,GAAA,MAAK46C,GAAKQ,mBAAmBp7C,IAClD,IAAI4vB,KACAgrB,GAAKhB,aACyC,KAA3CgB,EAAKxE,eAAeh9C,GAAOgxC,cACoB,SAA3CwQ,EAAKxE,eAAeh9C,GAAOgxC,aAAqE,SAA3CwQ,EAAKxE,eAAeh9C,GAAOgxC,aAAqE,SAA3CwQ,EAAKxE,eAAeh9C,GAAOgxC,cACpIwQ,EAAKxE,eAAeh9C,GAAOgxC,aAAe,MAGlDxa,EAAcgrB,EAAKS,wBAAwBv1B,EAAQ6E,MAAMqwB,GAAQJ,EAAKhB,YACtEhqB,EAAYyZ,eAAiBI,cAAe7pC,KAAKkB,MAAMlB,KAAKC,UAAU+6C,EAAKxE,eAAeh9C,GAAOqwC,gBAC3FniB,OAAQszB,EAAKxE,eAAeh9C,GAAOkuB,OACnCD,MAAOuzB,EAAKxE,eAAeh9C,GAAOiuB,MAClC8W,UAAWyc,EAAKzc,UAChB+L,WAAY0Q,EAAK9b,cACjBC,SAAU6b,EAAK7b,SACfoL,GAAIyQ,EAAKxE,eAAeh9C,GAAO+wC,GAC/BC,YAAawQ,EAAKxE,eAAeh9C,GAAOgxC,YAC1DkR,SAASV,EAAK5b,cAGFpP,EAAYiqB,cAAgBC,MAAM,MAC/Bc,EAAKxE,eAAeh9C,GAAOygD,cAAgBe,EAAKxE,eAAeh9C,GAAOygD,aAAaC,QAClFlqB,EAAYiqB,aAAaC,MAAQ3oC,OAAO8d,OAAO2rB,EAAKxE,eAAeh9C,GAAOygD,aAAaC,YAI/Fc,EAAKW,YAAYp9C,GAAS,GAC1BA,EAAQq9C,iBAAmBZ,EAAKz8C,QAAQq9C,eAAiBr9C,EAAQq9C,eAAev8B,UAChF9gB,EAAQs9C,UAAYb,EAAKz8C,QAAQs9C,QAAUt9C,EAAQs9C,QAAQx8B,SACvE,IAAM+nB,IACL3f,MAAOuzB,EAAKxE,eAAeh9C,GAAOiuB,MAClCC,OAAQszB,EAAKxE,eAAeh9C,GAAOkuB,OACnCmiB,cAAemR,EAAKM,kBACpBhjD,WAAY0iD,EAAKtB,aACjBz/C,QAAS+gD,EAAK9b,eAAiB8b,EAAK9b,cAAc,IAAOpkC,IAAKkgD,EAAK9b,cAAc,GAAG3M,OAAOz3B,SAC1FgvC,OAAOkR,EAAKha,qBAEFga,GAAKrQ,qBAAqBqQ,EAAKz8C,QAAS48C,EAAUC,EAAOprB,EAAaoX,GACtE4T,EAAKtO,WAAW3J,SAAU,GACzBiY,EAAK3b,eAAiB2b,EAAK7K,qBAE1B2L,EAAiB,SAAC51B,EAAS1sB,GAChC,GAAIA,EAAQ,EAAG,CAAA,GAAAuiD,GACef,EAAKgB,qBAAqBhB,EAAK9W,UAAWwL,EAAU5hB,GAAlE7yB,EADD8gD,EACP71B,QAAiBrrB,EADVkhD,EACIviD,KAClB0hD,GAASjgD,EAAGJ,OAENqgD,GAASh1B,EAAS1sB,GAG1B,KAAKk2C,EACD,OAAO,CA9EQ,IAAAuM,GAiFA7nD,KAAK4nD,qBAAqB5nD,KAAK8vC,UAAWwL,EAAU5hB,GAAzE5H,EAjFqB+1B,EAiFrB/1B,QAAgBzqB,EAjFKwgD,EAiFZziD,MACD4pC,EAAeld,EAAQ6H,aAAe7H,EAAQ6H,aAAe7H,EAAQvmB,KACrEu8C,EAAmB,WACrB,GAAMvP,GAAe,SAACC,GACdA,GACAoO,EAAK1sB,mBAAmB8U,EAAcld,EAAQ2H,KAAKvwB,KAAK,SAACytB,GAAQ,GAAAoxB,EAC7DnB,GAAK3a,wBAAyB,EAC9B2a,EAAK/a,sBAAwB,MAC7Bkc,EAAAj2B,EAAQ6E,OAAMpT,KAAd3G,MAAAmrC,EAAA78B,EAAsByL,IACtB+wB,EAAe51B,EAASzqB,IACzB,WACyB,QAArBtE,UAAU+L,OACTtT,OAAOqE,QAAUrE,OAAOqE,OAAO44C,YAE/BjsC,EAAAA,WAAOsf,MAAM,gBAK7B86B,GAAKlO,cAAc1J,EAAcld,EAAQomB,OAAQpmB,EAAQ2H,IAAK8e,GAgBlE,IAdGv4C,KAAKisC,0BAA2B,GAAU,YAAclpC,UAAU+L,QAAU,QAAU/L,UAAU+L,QAC/F9O,KAAKk6B,mBAAmB8U,EAAcld,EAAQ2H,KAAKvwB,KAAK,SAACytB,GAClDA,EAAMt1B,QAAS,EAEdymD,IAEAlB,EAAK3a,wBAAyB,GAEnC,SAAC9iC,GAEA2+C,MAIJh2B,GAAWA,EAAQ2H,KAAiC,IAAzB3H,EAAQ6E,MAAMt1B,OAAe,CAGxD,GAAGrB,KAAKstC,aAAa,CACjB,GAAMwK,GAAY,SAACnhB,GACf,GAAa,OAAVA,EACCnqB,EAAAA,WAAOsf,MAAM,kBACX,IAAa,SAAV6K,EAELnqB,EAAAA,WAAOC,OAAO,QAAQ,kDAAkD,KAAK,OAAO,MAAK,GAAOvD,KAAK,YACjG,EAAA6uC,EAAAA,YAAK,aACDC,OAAO,EACP/pC,QAAS,UAEf,kBAED,CAAA,GAAA+5C,IACDA,EAAAl2B,EAAQ6E,OAAMpT,KAAd3G,MAAAorC,EAAA98B,EAAsByL,EAAQA,OAC9B+wB,EAAe51B,EAASzqB,IAIhC,YADArH,MAAKi4C,wBAAwBjJ,EAAald,EAAQomB,OAAOpmB,EAAQ2H,IAAIqe,IAGrEhmB,EAAQomB,QAAW,YAAcn1C,UAAU+L,QAAU,QAAU/L,UAAU+L,QAA+B,QAArB/L,UAAU+L,OAa7F9O,KAAKk6B,mBAAmB8U,EAAcld,EAAQ2H,KAAKvwB,KAAK,SAACytB,GAAQ,GAAAsxB,IAC7DA,EAAAn2B,EAAQ6E,OAAMpT,KAAd3G,MAAAqrC,EAAA/8B,EAAsByL,IACtB+wB,EAAe51B,EAASzqB,IACzB,SAAC8B,QACWA,EAAIiR,QAAQ,WACnB5N,EAAAA,WAAOsf,MAAM3iB,GAEQ,WAAlBpG,UAAUye,IACThV,EAAAA,WAAO4rC,KAAK,uBAAuBlvC,KAAK,WACpC1N,OAAOkR,SAAS2rC,KAAO,uDAAwDt1C,UAAUwG,MAG7FiD,EAAAA,WAAO4rC,KAAK,8BAxBN,KAAlBr1C,UAAUkK,KAAmC,QAArBlK,UAAU+L,OAE9B9O,KAAKk6B,mBAAmB8U,EAAcld,EAAQ2H,KAAKvwB,KAAK,SAACytB,GAAQ,GAAAuxB,IAC7DA,EAAAp2B,EAAQ6E,OAAMpT,KAAd3G,MAAAsrC,EAAAh9B,EAAsByL,IACtB+wB,EAAe51B,EAASzqB,IAC1B,WACEygD,MAGJA,QAoBDh2B,SAAkBzqB,GACzBy/C,EAASh1B,EAASzqB,EAEtB,QAAO,GAQjB8gD,oBAAqB,SAAUC,EAAMC,EAAKC,GAAM,GAAAC,GAAAvoD,KACzCoF,EAAQijD,EAAOC,EAAOF,EACtBvtC,EAAM,WAsOC,MArOI0tC,GAAKxV,YACAwV,EAAK7c,kBAAoB6c,EAAK9c,gBAA2C,KAAzB8c,EAAK7c,iBAA2B6c,EAAK9c,iBAAmB1oC,UAAUkK,IAiCnHT,EAAAA,WAAO4rC,KAAK,sBAhCZmQ,EAAKzD,WAAW1/C,GAAO8D,KAAK,SAAAk8C,GACxB,IAAKA,EACD,OAAO,CAEX,IAAMp8C,GAAOu/C,EAAK7Z,YAAY4R,UAAU,cAAcrP,SAAS7M,KAAK,SAAAv9B,GAAA,MAAKA,GAAEjH,OAAF,cAAyBwF,IAC5FojD,EAAcx/C,EAAKs3C,UAAU,WAC7BmI,EAAWz/C,EAAKs3C,UAAU,YAE1BoI,EAAkB,SAAAh6C,GAAO,GACpB1I,GAAiBwiD,EAAjBxiD,MAAOG,EAAUqiD,EAAVriD,MACdqiD,GAAYG,YAAYj6C,GACxB85C,EAAYxiD,MAAQA,EACpBwiD,EAAYriD,OAASA,GAEnByiD,EAAUr+C,EAAAA,WAAIC,KAAK46C,EAAS3J,SAC7B8M,GAAK5Y,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAcuqC,GAGlDF,EAAgBE,GAFhBL,EAAK3Y,YAAYwV,EAAS3J,SAAUmN,GAAS1/C,KAAK,WAAA,MAAMw/C,GAAgBE,IAI5E,IAAMC,GAAUphD,EAAAA,WAAMqhD,mBAAmB1D,EAASz4B,UAClD,IAAI+jB,EAAAA,WAAUrrC,WAAY,CACtB,GAAM0jD,GAAKR,EAAKzY,UAAUpqC,KAAKI,KAAOyiD,EAAKS,sBAAsBP,EAASzjD,UAAYyjD,EAASzjD,SACzFikD,EAAKV,EAAKzY,UAAUpqC,KAAKI,KAAOyiD,EAAKW,qBAAqBT,EAASzjD,UAAYyjD,EAASzjD,QAC9FujD,GAAKY,mBAAmBpoD,KAAK8nD,IAAWI,EAAIF,EAAIN,EAAUF,EAAKp+C,SAC/Ds+C,EAASz2C,KAAO,QAGhBy2C,GAASz2C,KAAO62C,IAQxBN,EAAK9c,iBAAmB1oC,UAAUkK,KAClCs7C,EAAK7c,gBAAkB6c,EAAK9c,eACxB8c,EAAKnG,gBAAkBmG,EAAKnG,eAAeh9C,GAAOk2C,WAAaiN,EAAKnG,eAAeh9C,GAAO+E,QAE1Fo+C,EAAKrN,gBAAgB91C,GAAO8D,KAAK,SAAAgD,GAC7B,GAAMivC,GAAmB,SAACp6C,GACtB,GAAIq6C,GAAQxvC,KAAKkB,MAAM/L,EAEvB,IAAIq6C,EAAMjxC,QACNo+C,EAAKnG,eAAeh9C,GAASg2C,MAE5B,CAEDmN,EAAKnG,eAAeh9C,GAAOk2C,SAAWF,EAAME,SAC5CiN,EAAKnG,eAAeh9C,GAAOs0B,YAAc0hB,EAAM1hB,YAAc0hB,EAAM1hB,YAAcp4B,OACjFinD,EAAKnG,eAAeh9C,GAAOigD,MAAQjK,EAAMgO,iBAAmBhO,EAAMgO,iBAAiB1iD,IAAM,KAMzF6hD,EAAKnG,eAAeh9C,GAAO+E,WAC3Bo+C,EAAKnG,eAAeh9C,GAAO+E,QAAQ0vC,MAAO,EAC1C0O,EAAKnG,eAAeh9C,GAAO+E,QAAQykC,YAAa,EAChD2Z,EAAKnG,eAAeh9C,GAAO+E,QAAQszC,UACnC8K,EAAKnG,eAAeh9C,GAAO+E,QAAQk/C,eACnCd,EAAKnG,eAAeh9C,GAAO+E,QAAQm/C,gBACnCf,EAAKnG,eAAeh9C,GAAO+E,QAAQo/C,cACnC,KAAK,GAAIj2C,GAAE,EAAGA,EAAE8nC,EAAMqC,OAAOp8C,OAAQiS,IACjC,GAAI8nC,EAAMqC,OAAOnqC,GAAGk2C,MAAO,CAEvB,IAAK,GADDC,GAAKlB,EAAKnG,eAAeh9C,GAAO+E,QAAQk/C,YAAYhoD,OAC/CgG,EAAE,EAAGA,EAAEkhD,EAAKzY,UAAUuZ,YAAYhoD,OAAQgG,IAC/C,GAAIkhD,EAAKzY,UAAUuZ,YAAYhiD,GAAGkE,OAAS6vC,EAAMqC,OAAOnqC,GAAG5E,IAAK,CAC5D+6C,EAAKpiD,CACL,OAGRkhD,EAAKnG,eAAeh9C,GAAO+E,QAAQk/C,YAAYI,IAAOl+C,KAAM6vC,EAAMqC,OAAOnqC,GAAG5E,IACtE9O,KAAMw7C,EAAMqC,OAAOnqC,GAAG1T,KACtBkK,KAAMsxC,EAAMqC,OAAOnqC,GAAGxJ,KACtB0W,MAAO46B,EAAMqC,OAAOnqC,GAAGkN,WAE5B,IAAI46B,EAAMqC,OAAOnqC,GAAGlO,MAAO,CAE5B,IAAK,GADDqkD,GAAKlB,EAAKnG,eAAeh9C,GAAO+E,QAAQo/C,YAAYloD,OAC/CgG,EAAE,EAAGA,EAAEkhD,EAAKzY,UAAUyZ,YAAYloD,OAAQgG,IAC/C,GAAIkhD,EAAKzY,UAAUyZ,YAAYliD,GAAGkE,OAAS6vC,EAAMqC,OAAOnqC,GAAG5E,IAAK,CAC5D+6C,EAAKpiD,CACL,OAGRkhD,EAAKnG,eAAeh9C,GAAO+E,QAAQo/C,YAAYE,IAAOl+C,KAAM6vC,EAAMqC,OAAOnqC,GAAG5E,IACtE9O,KAAMw7C,EAAMqC,OAAOnqC,GAAG1T,KACtBkK,KAAMsxC,EAAMqC,OAAOnqC,GAAGxJ,KACtB0W,MAAO46B,EAAMqC,OAAOnqC,GAAGkN,WAE5B,IAAI46B,EAAMqC,OAAOnqC,GAAGxJ,MAAsC,WAA9BsxC,EAAMqC,OAAOnqC,GAAGxJ,KAAK9I,KAAmB,CAErE,IAAK,GADDyoD,GAAKlB,EAAKnG,eAAeh9C,GAAO+E,QAAQm/C,aAAajoD,OAChDgG,EAAE,EAAGA,EAAEkhD,EAAKzY,UAAUwZ,aAAajoD,OAAQgG,IAChD,GAAIkhD,EAAKzY,UAAUwZ,aAAajiD,GAAGkE,OAAS6vC,EAAMqC,OAAOnqC,GAAG5E,IAAK,CAC7D+6C,EAAKpiD,CACL,OAGRkhD,EAAKnG,eAAeh9C,GAAO+E,QAAQm/C,aAAaG,IAAOl+C,KAAM6vC,EAAMqC,OAAOnqC,GAAG5E,IACvE9O,KAAMw7C,EAAMqC,OAAOnqC,GAAG1T,KACtBkK,KAAMsxC,EAAMqC,OAAOnqC,GAAGxJ,KACtB0W,MAAO46B,EAAMqC,OAAOnqC,GAAGkN,WAE5B,IAAI46B,EAAMqC,OAAOnqC,GAAG5E,KAAkC,MAA3B0sC,EAAMqC,OAAOnqC,GAAG5E,IAAI,KAAe0sC,EAAMqC,OAAOnqC,GAAGlH,IAAI,CAEnF,IAAK,GADDq9C,GAAKlB,EAAKnG,eAAeh9C,GAAO+E,QAAQszC,OAAOp8C,OAC1CgG,EAAE,EAAGA,EAAEkhD,EAAKzY,UAAU2N,OAAOp8C,OAAQgG,IAC1C,GAAIkhD,EAAKzY,UAAU2N,OAAOp2C,GAAGkE,OAAS6vC,EAAMqC,OAAOnqC,GAAG5E,IAAK,CACvD+6C,EAAKpiD,CACL,OAGRkhD,EAAKnG,eAAeh9C,GAAO+E,QAAQszC,OAAOgM,IAAOl+C,KAAM6vC,EAAMqC,OAAOnqC,GAAG5E,IACjE9O,KAAMw7C,EAAMqC,OAAOnqC,GAAG1T,KACtBkK,KAAMsxC,EAAMqC,OAAOnqC,GAAGxJ,KACtB0W,MAAO46B,EAAMqC,OAAOnqC,GAAGkN,OAGrC+nC,EAAKnG,eAAeh9C,GAAO+E,QAAQgsB,OAASilB,EAAMjlB,WAAalL,SAC/Ds9B,EAAKnG,eAAeh9C,GAAO+E,QAAQisB,UAAYglB,EAAMhlB,cAAgBnL,SACrEs9B,EAAKnG,eAAeh9C,GAAO8/C,eAC3BqD,EAAKnG,eAAeh9C,GAAO+kC,YAC3B,KAAK,GAAI72B,GAAE,EAAGA,EAAE8nC,EAAMsO,gBAAgBroD,OAAQiS,IAC1Ci1C,EAAKnG,eAAeh9C,GAAO8/C,YAAY5xC,GAAKi1C,EAAKrF,kBAAkB9H,EAAMsO,gBAAgBp2C,GAAI8nC,EAAM+H,YACnGoF,EAAKnG,eAAeh9C,GAAO8/C,YAAY5xC,GAAGP,EAAIw1C,EAAKoB,WAAWC,SAASxO,EAAMsO,gBAAgBp2C,GAAGP,EAAGw1C,EAAKnG,eAAeh9C,GAAO+E,UAAY,EAAIixC,EAAMsO,gBAAgBp2C,GAAGe,OACvKk0C,EAAKnG,eAAeh9C,GAAO8/C,YAAY5xC,GAAGU,EAAIu0C,EAAKoB,WAAWC,SAASxO,EAAMsO,gBAAgBp2C,GAAGU,EAAGu0C,EAAKnG,eAAeh9C,GAAO+E,UAAY,EAAIixC,EAAMsO,gBAAgBp2C,GAAGe,OACvKk0C,EAAKnG,eAAeh9C,GAAO8/C,YAAY5xC,GAAGzT,OAAS,SAEvD,KAAK,GAAIyT,GAAE,EAAGA,EAAE8nC,EAAMyO,UAAUxoD,OAAQiS,IACpCi1C,EAAKnG,eAAeh9C,GAAO+kC,UAAU72B,GAAKi1C,EAAKrF,kBAAkB9H,EAAMyO,UAAUv2C,GAAI8nC,EAAM+H,YAC3FoF,EAAKnG,eAAeh9C,GAAO+kC,UAAU72B,GAAGP,EAAIw1C,EAAKoB,WAAWC,SAASxO,EAAMyO,UAAUv2C,GAAGP,EAAGw1C,EAAKnG,eAAeh9C,GAAO+E,UAAY,EAAIixC,EAAMyO,UAAUv2C,GAAGe,OACzJk0C,EAAKnG,eAAeh9C,GAAO+kC,UAAU72B,GAAGU,EAAIu0C,EAAKoB,WAAWC,SAASxO,EAAMyO,UAAUv2C,GAAGU,EAAGu0C,EAAKnG,eAAeh9C,GAAO+E,UAAY,EAAIixC,EAAMyO,UAAUv2C,GAAGe,OACzJk0C,EAAKnG,eAAeh9C,GAAO+kC,UAAU72B,GAAGzT,OAAS,gBAErD0oD,GAAKnG,eAAeh9C,GAAOiuB,MAAQ+nB,EAAMxZ,OAAO,IAAMl7B,IAAK00C,EAAMxZ,OAAO,GAAGl7B,IAAK6I,OAAQ6rC,EAAMxZ,OAAO,GAAGryB,WACxGg5C,EAAKnG,eAAeh9C,GAAOkuB,OAAS8nB,EAAM9nB,OAAOrI,SACjDs9B,EAAKnG,eAAeh9C,GAAO8kC,aAAekR,EAAM0O,UAAU7+B,SAC1Ds9B,EAAKnG,eAAeh9C,GAAO+wC,MAC3BoS,EAAKnG,eAAeh9C,GAAOqwC,iBAC3B8S,EAAKnG,eAAeh9C,GAAO8wC,cAC3BqS,EAAKnG,eAAeh9C,GAAOugD,QAAU,GACrC4C,EAAKnG,eAAeh9C,GAAOgxC,YAAc,GACzCmS,EAAKnG,eAAeh9C,GAAO4lC,cAAe,CAC1C,IAAM+e,GAAc,SAACC,GACjB,IAAI,GAAIvjD,GAAG,EAAEA,EAAIujD,EAAM3oD,OAAOoF,IAAI,CAC9B,GAAIwjD,GAAaD,EAAMvjD,GACnByjD,GACA/yB,KAAK8yB,EAAW9yB,KACfn2B,KAAKipD,EAAWjpD,KAChBuK,KAAK0+C,EAAW1+C,MAEjB4+C,KACAC,KACArG,GAAUkG,EAAWI,KACrBrG,EAAav9C,IAAMujD,EAAM3oD,OAAQ,CACrC,IAAG4oD,EAAWvU,QAAUuU,EAAWvU,OAAOr0C,OAAS,EAAE,CACjD,IAAI,GAAIiS,GAAI,EAAEA,EAAI22C,EAAWvU,OAAOr0C,OAAOiS,IACvC62C,EAAU5mC,KAAK0mC,EAAWvU,OAAOpiC,GAErC82C,GAAeH,EAAWvU,OAAOr/B,MAAM4zC,EAAWvU,OAAOr0C,OAAS4oD,EAAWnH,cAEjFyF,EAAKnG,eAAeh9C,GAAOswC,OAAOnyB,MAAMyyB,WAAWkU,EAAaxU,OAAOyU,EAAUrG,UAAUsG,EAAarG,OAAOA,EAAOC,UAAUA,KAGxI,IAAI5I,EAAM+H,YAAc/H,EAAM+H,WAAWE,eAAgB,CAAA,GAAAiH,GACXlP,EAAM+H,WAAWE,eAAtDx9C,EADgDykD,EAChDzkD,OAAQyrC,EADwCgZ,EACxChZ,OAAQ6C,EADgCmW,EAChCnW,SAAU3T,EADsB8pB,EACtB9pB,OAW/B,IATA+nB,EAAKnG,eAAeh9C,GAAOugD,QAAUvK,EAAM+H,WAAWoH,YACtDhC,EAAKnG,eAAeh9C,GAAO4lC,eAAemJ,GAAWA,EAAShd,KAAK,GACnEoxB,EAAKnG,eAAeh9C,GAAO8wC,WAAa5E,GAAUA,EAAOlxC,QAAUkxC,EAAOlxC,QAAQ+2B,QAClFoxB,EAAKnG,eAAeh9C,GAAOgxC,YAAc5V,GAAWA,EAAQrJ,KAAK,GAC9DikB,EAAM+H,WAAWE,eAAewC,aAC/B0C,EAAKnG,eAAeh9C,GAAOygD,aAAezK,EAAM+H,WAAWE,eAAewC,aAE1E0C,EAAKnG,eAAeh9C,GAAOygD,aAAe,KAE1ChgD,EACA,IAAK,GAAI8J,GAAE,EAAGA,EAAE9J,EAAOxE,OAAQsO,IAC3B,GAAI9J,EAAO8J,GAAGvK,MAAQ,EAAG,CACrB,GAAI4D,IAAQtC,IAAIb,EAAO8J,GAAGjJ,IAAKqM,EAAElN,EAAO8J,GAAGoD,EAAGiB,EAAEnO,EAAO8J,GAAGqE,EAAGhO,MAAMH,EAAO8J,GAAG3J,MAAOG,OAAON,EAAO8J,GAAGxJ,OAAQ6/C,QAASngD,EAAO8J,GAAGq2C,QAC1HM,OAAOzgD,EAAO8J,GAAG22C,OAAQlhD,MAAMS,EAAO8J,GAAGvK,MAAMqhD,UAAS5gD,EAAO8J,GAAG82C,SAAU5gD,EAAO8J,GAAG82C,QAAiBC,UAAS7gD,EAAO8J,GAAG+2C,SAAU7gD,EAAO8J,GAAG+2C,QACpJ6B,GAAKnG,eAAeh9C,GAAOqwC,cAAclyB,KAAKva,OAErB,KAApBnD,EAAO8J,GAAGvK,QACfmjD,EAAKnG,eAAeh9C,GAAO+wC,IAAMzvC,IAAIb,EAAO8J,GAAGjJ,IAAKs/C,QAAQngD,EAAO8J,GAAGq2C,SAIlFuC,GAAKnG,eAAeh9C,GAAOswC,UAC3B0F,EAAM+H,WAAWE,eAAerN,YAAc+T,EAAY3O,EAAM+H,WAAWE,eAAerN,YAC1FuS,EAAKnG,eAAeh9C,GAAO2gD,eACzD3K,EAAM+H,WAAWE,eAAe0C,cACEwC,EAAKnG,eAAeh9C,GAAO2gD,YAAc3K,EAAM+H,WAAWE,eAAe0C,YAAY96B,cAIzFs9B,GAAKnG,eAAeh9C,GAAOswC,UAC3B0F,EAAMpF,YAAc+T,EAAY3O,EAAMpF,YACtCuS,EAAKnG,eAAeh9C,GAAO2gD,eAC3BwC,EAAKnG,eAAeh9C,GAAO2gD,YAAc3K,EAAM2K,aAAe3K,EAAM2K,YAAY96B,QAEhFmwB,GAAMoM,gBAAkBpM,EAAMoM,eAAenmD,SAE7CknD,EAAKnG,eAAeh9C,GAAO+E,QAAQq9C,eAAiBpM,EAAMoM,eAAev8B,UAE1EmwB,EAAMqM,SAAWrM,EAAMqM,QAAQpmD,SAE9BknD,EAAKnG,eAAeh9C,GAAO+E,QAAQs9C,QAAUrM,EAAMqM,QAAQx8B,UAE/Ds9B,EAAK5M,eAAev2C,GAASwG,KAAKkB,MAAMlB,KAAKC,UAAU08C,EAAKnG,eAAeh9C,MAGnF+1C,GAAiBjvC,GACjBq8C,EAAK5B,WAAWvhD,GAChBmjD,EAAK7N,YACN,WACCluC,EAAAA,WAAOsf,MAAM,eAIjBy8B,EAAK5B,WAAWvhD,GAChBmjD,EAAK7N,aAGTluC,EAAAA,WAAO4rC,KAAK,uBAGb,EAEX,IAAkB,KAAdr1C,UAAUoK,GAA4B,KAAlBpK,UAAUmK,OAAiC,KAAnBnK,UAAU+L,OAAa,CACnE,GAAI7B,GAAMxF,EAAAA,WAAM0rC,gBAChBpwC,WAAUkK,IAAMA,EAEpB,MAAwB,QAArBlK,UAAU+L,QAAsC,KAAlB/L,UAAUkK,IACnCjN,KAAKwvC,qBAAqBtmC,KAAK,WAC9C,MAAO2R,OAGQA,KAIlB2vC,yBAA0B,WACzBxqD,KAAKyqC,cAAc,KAAOzqC,KAAKyqC,cAAc,GAAGkE,SAAU,GAC7C3uC,KAAKyqC,cAAc,KAAOzqC,KAAK4yC,eAC/B5yC,KAAK03C,WAET13C,KAAKyqD,cAAcC,WAAU,GACtC1qD,KAAKyqC,cAAgBzqC,KAAKyqC,cAAcp0B,MAAM,GAC9CrW,KAAKyqD,cAAc9b,SAAU,GAG9ByY,mBAAoB,SAAUrmD,GAC7Bf,KAAKM,iBAAiB7E,cAAcC,aAAa2D,qBAAsB0B,IAGxE4pD,iBAAkB,SAAU3pD,GACvB,IAAMA,GACThB,KAAK4qD,kBAAkBjc,SAAU,EACrB3uC,KAAK2vC,cAAcj8B,KAAKshC,MAAM6V,WAAW7qD,KAAK4qD,oBAElD,IAAM5pD,IACFhB,KAAK4qD,kBAAkBjc,SAAU,IAIzC8K,UAAW,SAAUz4C,EAAMgR,GACvB,GAAI84C,GAAK9qD,KAAK+qD,WAAWzK,UAAU,eAC/B0K,EAAKhrD,KAAK+qD,WAAWzK,UAAU,YAC/BwK,KACI,IAAM9pD,GACN8pD,EAAGnc,SAAU,EACbmc,EAAG7Z,SAAS,GAAGj/B,KAAOA,EACtB84C,EAAG7Z,SAAS,GAAGjrC,MAAQ8kD,EAAG7Z,SAAS,GAAGjrC,MAAQ,GAC9C8kD,EAAG/3C,GAAK/S,KAAK2vC,cAAcj8B,KAAKshC,MAAMhvC,MAAQ8kD,EAAG7Z,SAAS,GAAGjrC,OAAS,EACtE8kD,EAAG92C,EAAIjR,UAAUC,SAAW,IAAM,KAElC8nD,EAAGnc,SAAU,GAGjBqc,IACI,IAAMhqD,GACNgqD,EAAGrc,SAAU,EACbqc,EAAG/Z,SAAS,GAAGj/B,KAAOA,EACtBg5C,EAAG/Z,SAAS,GAAGjrC,MAAQglD,EAAG/Z,SAAS,GAAGjrC,MAAQ,GAC9CglD,EAAG/Z,SAAS,GAAGtC,SAAU,EACzBqc,EAAG/Z,SAAS,GAAGl+B,EAAI,GACnBi4C,EAAGj4C,GAAK/S,KAAK2vC,cAAcj8B,KAAKshC,MAAMhvC,MAAQglD,EAAG/Z,SAAS,GAAGjrC,OAAS,EACtEglD,EAAGh3C,EAAIjR,UAAUC,SAAW,IAAM,KAC3B,IAAMhC,GACbgqD,EAAGrc,SAAU,EACbqc,EAAG/Z,SAAS,GAAGj/B,KAAOA,EACtBg5C,EAAG/Z,SAAS,GAAGjrC,MAAQglD,EAAG/Z,SAAS,GAAGjrC,MAAQ,GAC9CglD,EAAG/Z,SAAS,GAAGtC,SAAU,EACzBqc,EAAG/Z,SAAS,GAAGl+B,EAAI,GACnBi4C,EAAGj4C,GAAK/S,KAAK2vC,cAAcj8B,KAAKshC,MAAMhvC,MAAQglD,EAAG/Z,SAAS,GAAGjrC,OAAS,EACtEglD,EAAGh3C,EAAIjR,UAAUC,SAAW,IAAM,KAElCgoD,EAAGrc,SAAU,GAGrB3uC,KAAK+qD,WAAW1iB,MAAQ,EACxBroC,KAAK2vC,cAAcj8B,KAAKshC,MAAM6V,WAAW7qD,KAAK+qD,YAC9C/qD,KAAK2vC,cAAcj8B,KAAKlR,IAAI+0C,MAAMv3C,KAAK+qD,YAAYE,MAAM5iB,MAAO,GAAI,KAAM,MAAM,GAAMzoC,KAAO,SAGjGsrD,aAAc,SAAUn4C,EAAGiB,EAAG6H,EAAGjJ,EAAGu4C,GAChC,GAAIzlD,GAAO1F,KAAK2vC,cAAcj8B,KAAKlR,IAAI4oD,UAAU1a,EAAAA,WAAUrrC,WAAYqrC,EAAAA,WAAUzqC,UAAWyqC,EAAAA,WAAUxqC,WAAYwqC,EAAAA,WAAU/pC,UAAW+pC,EAAAA,WAAUrqC,aAC7IglD,EAASrrD,KAAK2vC,cAAcj8B,KAAKlR,IAAI0wB,MAAMngB,EAAIA,EAAI,EAAGiB,EAAIA,EAAI,EAAGtO,EAerE,OAdA2lD,GAAOC,QAAU5lD,EACb1D,SAASC,KAAKS,YAAcV,SAASC,KAAKU,eAC1C+C,EAAK6lD,MAAMlU,WAEX8T,IACAzlD,EAAK8lD,QAAQL,GAAS,EAAM,EAAG,EAAG,UAAU,GACxCtvC,IACAwvC,EAAOrlD,MAAQ6V,GAEfjJ,IACAy4C,EAAOllD,OAASyM,IAIjBy4C,GAGXI,uBAAwB,SAAU1qD,EAAM2qD,EAAQvhD,GAE5CuhD,EAAO14C,OAAO+L,OAAO,EAAG2sC,EAAO14C,OAAO3R,OAEtC,IAAIsqD,GAAO,EACPtnD,EAAQrE,KAAK8vC,UAAUkV,iBAAiB3gD,KAC5CqnD,GAAO/2C,KAAOtQ,CACd,KAAK,GAAIoC,GAAE,EAAGA,EAAE1F,EAAKM,OAAQoF,IAAK,CAC9B,GAAImlD,GAAW,EACf,KAAI7qD,EAAK0F,GAAGolD,UAAZ,CAQA,GANID,EADK7qD,EAAK0F,GAAGqlD,aAAe,OAAS/qD,EAAK0F,GAAG1F,KAAK,GACvCf,KAAK2pD,WAAWoC,cAAchrD,EAAK0F,GAAG1F,MAGtCf,KAAK2pD,WAAWqC,WAAWjrD,EAAK0F,GAAG1F,KAAMoJ,GAExD9F,EAAQtD,EAAK0F,GAAGpC,MAAQtD,EAAK0F,GAAGpC,MAAQrE,KAAK8vC,UAAUkV,iBAAiB3gD,MACvD,MAAbA,EAAM,IAA+B,IAAjBA,EAAMhD,OAAc,CAC3C,GAAI4qD,GAAM,IAAM5nD,EAAM,GAAKA,EAAM,GAAKA,EAAM,GAAKA,EAAM,GAAKA,EAAM,GAAKA,EAAM,EAC7EA,GAAQ4nD,EAETP,EAAOQ,SAAS7nD,EAAOsnD,GACvBA,GAAQC,EAASvqD,UAIzB8nD,iBAAkB,SAAUpoD,EAAMorD,EAAYC,EAAaV,EAAQvhD,EAASkiD,EAAWC,GAAc,GAAAC,GAAAvsD,KAC1F2pD,EAAc3pD,KAAd2pD,UAEhB,IAAI+B,EAAOza,SAAS5vC,OAAQ,CAGf,IAAK,GAFDmrD,GAAYd,EAAOza,SAAS,GAC5Bwb,EAAOf,EAAOza,SAAS,GAClBxqC,EAAE,EAAGA,EAAE+lD,EAAUvb,SAAS5vC,OAAQoF,IAAK,CAC5C,GAAI4kD,GAASmB,EAAUE,WAAWjmD,GAC9B6kD,EAAUD,EAAOC,OACrBA,GAAQ3uC,UACR0uC,EAAO1uC,UAEX6vC,EAAU7vC,UACV8vC,GAAQA,EAAK9vC,UACb+uC,EAAOiB,iBAGX,GAAIC,GAAO,EACPC,EAAO,EACPC,EAAK,UACLC,EAAU,EACVC,EAAc,EACdC,EAAaC,WAAWd,GACxBe,EAAYD,WAAWf,GACvBiB,EAAMptD,KAAK8vC,UAAUpqC,KAAKI,KAAQ9F,KAAK8vC,UAAUpqC,KAAKI,KAAKC,OAAOI,OAASnG,KAAK8vC,UAAUpqC,KAAKI,KAAKC,OAAOI,OAASnG,KAAK8vC,UAAUpqC,KAAKI,KAAKC,OAAU/F,KAAK8vC,UAAUkV,iBAAiBqI,UACvLC,EAAUttD,KAAK8vC,UAAUpqC,KAAKI,KAAQmnD,EAAajtD,KAAK8vC,UAAUpqC,KAAKI,KAAKiW,OAASqxC,EAAOH,EAC5FM,EAAavtD,KAAK8vC,UAAUpqC,KAAKI,KAAQ,IAAMwnD,EAAUL,EAAe,GAAMK,EAC9E3mD,KACA6mD,GAAYhqD,QAAQ,GAAIa,MAAM,UAAW0O,EAAE,EAAGiB,EAAE,EAAG3Q,MAAM,GACzDoqD,EAAY,EACZC,IACJb,IAAQ,GAAMU,CAEd,KAAK,GAAI9mD,GAAE,EAAGA,EAAE1F,EAAKM,OAAQoF,IAAK,CAC9B,GAAImlD,GAAW,EACf,IAAI7qD,EAAK0F,GAAGolD,UAAZ,CACI,GAAIplD,IAAM1F,EAAKM,OAAO,EAClB,KAEJwrD,IAAQI,EAAaM,EACrBX,EAAO,MALX,CASIhB,EADK7qD,EAAK0F,GAAGqlD,aAAe,OAAS/qD,EAAK0F,GAAG1F,KAAK,GACvC4oD,EAAWoC,cAAchrD,EAAK0F,GAAG1F,MAGjC4oD,EAAWqC,WAAWjrD,EAAK0F,GAAG1F,KAAMoJ,EAGnD,KAAK,GAAImJ,GAAE,EAAGA,EAAEs4C,EAASvqD,OAAQiS,IAAK,CAC9Bo4C,EAAO14C,OAAOy6C,KACdX,EAAKpB,EAAO14C,OAAOy6C,GACR,YAAPX,IAAkBA,EAAK,WAG/B,IAAMr5C,GAAIi9B,EAAAA,WAAUid,cAAc/B,EAASt4C,GAAI65C,GACzCpoD,EAAI2rC,EAAAA,WAAUkd,aAAahC,EAASt4C,GAAI65C,GAE1Cp6C,EAAI65C,EAAOn5C,CACXV,GAAIhO,EAAI2mD,EAAO9oD,MAAMmT,gBACjBg3C,EAAUh6C,EAAEhO,IACZgoD,EAAUh6C,EAAEhO,GAEhB6nD,EAAO,EACP75C,EAAI65C,EAAOn5C,EACXo5C,GAAQI,EAAaM,EACrBP,EAAcv5C,GAGK,IAAnB+5C,EAASnqD,QACZmqD,EAASnqD,MAAQ0B,EACjByoD,EAASnpD,MAAQyoD,EACjBU,EAASz6C,EAAIA,EACby6C,EAASx5C,EAAI64C,EACO,IAAhBG,IACHA,EAAcv5C,IAI3B,KAAOm4C,EAASt4C,GAAG/K,WAAW,IAAM,MAAQqjD,EAASt4C,GAAG/K,WAAW,IAAM,MAAaqjD,EAASt4C,IAC/F,MAAas4C,EAASt4C,IAAM,OAASs4C,EAASt4C,GAAG/K,WAAW,IAC7CilD,EAAShqD,SAAWmD,EAAU4c,KAAKiqC,GACnC7mD,EAAU4c,MAAM/f,QAASooD,EAASt4C,GAAIjP,MAAMyoD,EAAI/5C,EAAEA,EAAGiB,EAAE64C,EAAMxpD,MAAM0B,IACnEyoD,GAAYhqD,QAAQ,GAAIa,MAAM,UAAW0O,EAAE,EAAGiB,EAAE,EAAG3Q,MAAM,IAEnEmqD,EAASnqD,QAAU0B,GAAKyoD,EAASnpD,QAAUyoD,GAAMU,EAASx5C,IAAM64C,GAAQM,IAAcpoD,GAC5EyoD,EAAShqD,SAAWmD,EAAU4c,KAAKiqC,GACtCA,GAAYhqD,QAAQooD,EAASt4C,GAAIjP,MAAMyoD,EAAI/5C,EAAEA,EAAGiB,EAAE64C,EAAMxpD,MAAM0B,IAG9DyoD,EAAShqD,SAAWooD,EAASt4C,GAG7Co6C,EAAQnqC,MAAMxQ,EAAGA,EAAGiB,EAAG64C,EAAMxpD,MAAO0B,EAAG8oD,aAAchB,EAAOI,IAE5DQ,IACeb,GAAQ7nD,IAGhB,GAAIhE,EAAKM,OAAQ,CACZmsD,EAAShqD,UACNmD,EAAUA,EAAUtF,OAAS,KAAOmsD,GAAY7mD,EAAU4c,KAAKiqC,GAC3DT,EAAUH,IACbG,EAAUH,GAI3B,IAAIkB,GAAU9tD,KAAK2vC,cAAcj8B,KAAKlR,IAAIurD,OAAO,EAAG,EAiBxC,IAhBApnD,EAAU0W,QAAQ,SAAArU,GACjB,GAAI,KAAOA,EAAKxF,QAAQ+E,WAAW,IAAM,MAAQS,EAAKxF,QAAQ+E,WAAW,IAAM,MAAaS,EAAKxF,SACzG,MAAawF,EAAKxF,SAAW,OAASwF,EAAKxF,QAAQ+E,WAAW,GADtD,CAKG,GAAIylD,GAASzB,EAAKrB,aAAaliD,EAAK+J,EAAG/J,EAAKgL,EAAGm5C,EAAYnkD,EAAKxF,QAAQnC,OAAQ4rD,EAAYjkD,EAAKxF,QACjGwqD,GAAOC,KAAO3/C,SAAStF,EAAK3E,MAAMoS,QAAQ,IAAK,OAC/Cq3C,EAAQI,SAASF,MAErBF,EAAQK,SAAWpB,EACnBe,EAAQM,UAAYpB,EACpBtB,EAAOwC,SAASJ,GAChBpC,EAAOgC,QAAUA,EACjB/mD,EAAUtF,SAAWqqD,EAAO2C,WAAa1nD,EAAUA,EAAUtF,OAAO,GAAG2S,EAAIi5C,GAEvEZ,EAAW,CACX,GAAII,GAAOzsD,KAAK2vC,cAAcj8B,KAAKlR,IAAI+9C,SAAS,EAAG,GAC/C+N,EAAY5C,EAAO9oD,MAAMmT,cACzBw4C,EAAajC,EAAe,IAAMtsD,KAAK8vC,UAAUC,SAASpK,KAAK2L,OAAOkd,KAAKroD,MAC/EsmD,GAAKjM,UAAU,UACfiM,EAAKhM,UAAU6N,GAAYC,EAAY,EAAID,EAAWC,GACtD9B,EAAKhM,UAAU6N,EAAW,EAAGA,EAAWrB,GACxCR,EAAK/L,UACLoN,EAAQrB,KAAOA,EACff,EAAOwC,SAASzB,MAK5BrH,SAAU,SAAUhgD,EAAOy0C,GAAM,GAAA4U,GAAAzuD,IAC7B,OAAO,IAAI4B,SAAQ,SAACC,EAASC,GACrBiB,UAAUwI,OAASkjD,EAAKjkB,WACxB/iC,EAAAA,WAAMq1C,oBAAoB/5C,UAAUwI,KAAOxI,UAAUkK,IAAKrB,KAAKC,UAAU4iD,EAAKrM,kBAC7EvI,GAAQ4U,EAAKhV,UAAU,EAAG,sBAC3B53C,KAEKkB,UAAUwG,KAAOklD,EAAKjkB,YAC9BikB,EAAK9D,iBAAiB,GACnB8D,EAAKtM,gBAAgB/8C,GAAO8D,KAAK,SAAAgD,GAChCuiD,EAAK9D,iBAAiB,IAClB9Q,GAAQ4U,EAAKhV,UAAU,EAAG,sBAC3B53C,KACD,SAAAsK,GAECsiD,EAAK9D,iBAAiB,IACrB9Q,GAAQ4U,EAAKhV,UAAU,EAAG,kBAC3B33C,UAMtBkxC,SAAU,SAAUF,GAAmB,GAAA4b,GAAA1uD,KAC1BsR,EAAO,WAQN,GAPKo9C,EAAKlkB,UAGuB,KAAxBkkB,EAAKjjB,iBACVijB,EAAKjjB,eAAiB1oC,UAAUkK,KAHhCyhD,EAAKjjB,eAAiB1oC,UAAUkK,IAMhClK,UAAUwI,KACV,GAAImjD,EAAKnkB,WAAamkB,EAAKlkB,UACvBkkB,EAAKtM,eAAiBx2C,KAAKkB,MAAMlB,KAAKC,UAAU6iD,EAAK/S,qBAEpD,CACD,GAAIkB,GAAYp1C,EAAAA,WAAMm1C,oBAAoB75C,UAAUwI,KAAOxI,UAAUkK,IACjE4vC,IAAa,QAAU95C,UAAU+L,SACjC+tC,EAAYA,EAAUpmC,QAAQ,MAAO,IACrComC,EAAYA,EAAUpmC,QAAQ,MAAO,KAEzCi4C,EAAKtM,eAAiBx2C,KAAKkB,MAAM+vC,GAGpC6R,EAAKtM,iBACNsM,EAAKtM,eAAiB7uC,MAAM,IAAIoB,UAGxC,IAAkB,KAAd5R,UAAUoK,GAA4B,KAAlBpK,UAAUmK,OAAiC,KAAnBnK,UAAU+L,OAAa,CACnE,GAAI7B,GAAMxF,EAAAA,WAAM0rC,gBACZ,MAAOlmC,GAAOlK,UAAUkK,MAAQA,GAChClK,UAAUkK,IAAMA,EAChBjN,KAAKq8C,yBAAyBvJ,IAEjC/vC,UAAUkK,IAAMA,EAGG,QAArBlK,UAAU+L,QAAsC,KAAlB/L,UAAUkK,IAC1CjN,KAAKwvC,qBAAqBtmC,KAAK,WACvCoI,MAGQA,KAKXy9B,QAAS,WACC,GAAMj7B,GAAS9R,SAASM,cAAc,SACtCwR,GAAO9N,MAAShG,KAAK2vC,cAAcj8B,KAAKshC,MAAMhvC,MAAQ,EACtD8N,EAAO3N,OAAUnG,KAAK2vC,cAAcj8B,KAAKshC,MAAM7uC,OAAS,EACxDnG,KAAK2vC,cAAcj8B,KAAKi7C,aAAa,EACrC,IAAM7nD,GAAMgN,EAAO/M,WAAW,MACjC8U,EAAKrgB,OAAO0rC,YAAcllC,SAASmlC,gBAAgBzkC,aAAeV,SAASC,KAAKS,YAChFkQ,EAAKpX,OAAO4rC,aAAeplC,SAASmlC,gBAAgBxkC,cAAgBX,SAASC,KAAKU,YACpFkZ,GAAIjJ,GACJ7P,UAAUC,UACG8D,EAAIiiC,OACJjiC,EAAI8nD,UAAU,EAAG96C,EAAO3N,QACxBW,EAAIw/C,WAAap/C,KAAK2nD,GAAK,KAC3B/nD,EAAIsB,UAAUpI,KAAK2vC,cAAcj8B,KAAKI,OAAQ,EAAG,GACjDhN,EAAIgoD,WAEJhoD,EAAIsB,UAAUpI,KAAK2vC,cAAcj8B,KAAKI,OAAQ,EAAG,EAAG9T,KAAK2vC,cAAcj8B,KAAKshC,MAAMhvC,MAAOhG,KAAK2vC,cAAcj8B,KAAKshC,MAAM7uC,OAAQ,EAAG,EAAG2N,EAAO9N,MAAO8N,EAAO3N,QAE9JnG,KAAKy7C,SAAW3nC,EAAOvM,UAAU,aAAc,MAG5CxE,UAAUC,SACT8D,EAAIsB,UAAUpI,KAAK2vC,cAAcj8B,KAAKI,OAAQ,EAAG,EAAG9T,KAAK2vC,cAAcj8B,KAAKshC,MAAMhvC,MAAOhG,KAAK2vC,cAAcj8B,KAAKshC,MAAM7uC,OAAQ,EAAG,EAAG2N,EAAO9N,MAAO8N,EAAO3N,SAE1JW,EAAIiiC,OACJjiC,EAAI8nD,UAAU,EAAG96C,EAAO3N,QACxBW,EAAIw/C,WAAap/C,KAAK2nD,GAAK,KAC3B/nD,EAAIsB,UAAUpI,KAAK2vC,cAAcj8B,KAAKI,OAAQ,EAAG,GACjDhN,EAAIgoD,WAGR9uD,KAAKy7C,SAAW3nC,EAAOvM,UAAU,aAAc,MAI7DqgD,qBAAsB,SAAUl0C,EAAMnI,EAAMmuB,GAC3C,GAAMq1B,GAAa,SAACp4B,EAAO7E,EAASvmB,EAAMmuB,GACzC,GAAIzI,GAAS,IACb,OAAIyI,IAAe5H,EAAQvmB,OAASmuB,EAC5BzI,GAECyI,GAAe5H,EAAQvmB,OAASmuB,GAAwC,IAAzB5H,EAAQ6E,MAAMt1B,SACrE4vB,GAAUa,QAASA,EAAS1sB,WAE7BuxB,EAAMyN,KAAK,SAAC9N,EAAM7vB,GAOjB,MANI6vB,GAAK/qB,OAASA,EACjB0lB,GAAUa,QAASA,EAAS1sB,MAAOqB,GACzBqrB,EAAQ6E,MAAMlwB,GAAGgwB,UAC3BxF,EAAS+9B,EAAmBl9B,EAASrrB,EAAG8E,IAGvB,OAAX0lB,IAGDA,IAGF+9B,EAAqB,SAACl9B,EAASm9B,EAAQ1jD,GAC5C,GAAI0lB,GAAS,KACPqF,EAAOxE,EAAQ6E,MAAMs4B,EAM3B,OALA34B,GAAKG,QAAQ2N,KAAK,SAAC1N,EAAQjwB,GAE1B,MADAwqB,GAAS89B,EAAWr4B,EAAOC,OAAQA,MAAOD,EAAOC,MAAO92B,QAAS83B,SAAU7F,EAAS8F,OAAQq3B,GAAS1jD,KAAMumB,EAAQvmB,KAAMkuB,IAAI3H,EAAQ2H,IAAKE,aAAa7H,EAAQ6H,cAAepuB,GAC5J,OAAX0lB,IAGJA,EACIA,GAGRqF,EAAKsC,mBAAqBtC,EAAKsC,kBAAkBwL,KAAK,SAAC1N,EAAQjwB,GAE9D,MADAwqB,GAAS89B,EAAWr4B,EAAOC,OAAQA,MAAOD,EAAOC,MAAO92B,QAAS83B,SAAU7F,EAAS8F,OAAQq3B,GAAS1jD,KAAMumB,EAAQvmB,KAAMkuB,IAAI3H,EAAQ2H,IAAKE,aAAa7H,EAAQ6H,cAAepuB,GAC5J,OAAX0lB,IAGDA,IAGFi+B,EAAsB,QAAtBA,GAAuBp9B,EAASvmB,EAAMmuB,GAC3C,GAAIzI,GAAS,IAEb,QADAA,EAAS89B,EAAWj9B,EAAQ6E,MAAO7E,EAASvmB,EAAMmuB,IAE1CzI,GAERa,EAAQC,YAAYqS,KAAK,SAAC+qB,EAAY1oD,GAErC,MADAwqB,GAASi+B,EAAoBp9B,EAAQC,YAAYtrB,GAAI8E,EAAMmuB,GACzC,OAAXzI,IAGDA,IAGJA,EAAS,IAQb,OAPAvd,GAAKse,SAASoS,KAAK,SAACtS,EAASrrB,GAEhB,MADAwqB,GAASi+B,EAAoBx7C,EAAKse,SAASvrB,GAAI8E,EAAMmuB,GACnC,OAAXzI,IAEfA,SAAiBA,EAAO7rB,OAAU6rB,EAAOa,QAAQ2H,MACrDjtB,EAAAA,WAAOsf,MAAM,6BAEPmF,GAGRo2B,wBAAyB,SAAU/wB,EAAM/qB,GAC/B,GAAM6jD,GAAwB,SAACC,EAAKC,EAAU15B,GAC7C,IAAK,GAAInvB,GAAE,EAAGA,EAAE4oD,EAAIhuD,OAAQoF,IAAK,CAC1B,GAAIwqB,GAAS,IAEnB,IADMA,EAASs+B,GAAex4B,SAAUs4B,EAAI5oD,GAAGswB,SAAUK,WAAYk4B,EAAUj4B,eAAgBzB,IACxE,OAAnB3E,EAAO4E,QAAkB,MAAO5E,GAE9C,MAAO,OAGOs+B,EAAgB,SAAC15B,GACtB,GAAI5E,GAAS,IAWb,OAVA4E,GAAQkB,SAASqN,KAAK,SAAChkC,EAASqG,GAQzB,MAPFrG,GAAQmL,OAASA,EACpB0lB,GAAU4G,SAAUpxB,EAAG8E,KAAMA,EAAMsqB,SAAUkB,SAAUlB,EAAQkB,SAAUK,WAAYvB,EAAQuB,WAAYC,eAAgBxB,EAAQwB,iBAExG,YAAjBj3B,EAAQY,MAAuC,qBAAjBZ,EAAQY,OAC9CiwB,EAASm+B,EAAsBhvD,EAAQ+2B,KAAMtB,EAASpvB,IAG1C,OAASwqB,IAEnB,OAASA,GACJ4G,YAAchC,QAAS,MAEtB5E,GAGP4E,GAAWkB,SAAUT,EAAKS,SAAUK,WAAY,KAAMC,kBAC1D,OAAOk4B,GAAc15B,IAG/B2f,SAAU,SAAU1jB,EAASk1B,GAE5B,IAAK,GADDtgD,GAAM,KACDD,EAAIugD,EAAOvgD,GAAK,EAAGA,IAAK,CAChC,GAAM6vB,GAAOxE,EAAQ6E,MAAMlwB,EACvB6vB,GAAKjD,OAA4B,YAAnBiD,EAAKjD,MAAM3sB,MAC5BA,EAAM4vB,EAAKjD,MAAM3sB,KAGnB,OAAKA,GAAOorB,EAAQjyB,OACZG,KAAKw1C,SAAS1jB,EAAQjyB,OAAO83B,SAAU7F,EAAQjyB,OAAO+3B,SAEzDlxB,GAAOorB,EAAQgqB,SACf97C,KAAK8vC,UAAUc,MAAMvd,OAA4C,YAAnCrzB,KAAK8vC,UAAUc,MAAMvd,MAAM3sB,IACtC1G,KAAK8vC,UAAUc,MAAMvd,MAAM3sB,IAG5CA,GAGR8oD,iBAAkB,WAAY,GACxBxnB,GAAsChoC,KAAtCgoC,SAAUC,EAA4BjoC,KAA5BioC,WAAY+R,EAAgBh6C,KAAhBg6C,aACvByV,EAASzV,EAAa/I,SAAS,GAC/BkU,KACShb,KACA+L,EAAal2C,KAAK8qC,cAAc7f,SAChC8f,EAAW/qC,KAAK+qC,SAAS9f,SACzBoI,EAAQ2U,GAAYthC,IAAKshC,EAASt5B,IAAKa,OAAQy4B,EAASz4B,QAAU,KAClE+jB,EAAS2U,EAAW5N,IAAI,SAAAt1B,GACxB,MAAIA,IAEI2B,IAAK3B,EAAE2J,IACPa,OAAQxK,EAAEwK,OACV6c,KAAMrnB,EAAEyK,KAAO,EAAI,GAGpB,OAEP2mC,EAAKsZ,GAAU/oD,IAAK+oD,EAAO/gD,IAAKs3C,QAASyJ,EAAOpnB,MAAOriC,MAAOypD,EAAOzpD,MAAOG,OAAQspD,EAAOtpD,QAAU,IAEzGnG,MAAK4sC,uBACL,IAAI8I,GAAU11C,KAAK2jD,gBAAgB14B,QASnC,OARAjrB,MAAKg3C,iBACLh3C,KAAKi3C,oBAAsBj3C,KAAKi3C,mBAAmBhG,SAAS5zB,QAAQ,SAAA5K,GACnE,GAAI5L,GAAI4L,EAAEw+B,SAAS,GACxBjoC,GAAQtC,IAAIG,EAAE6H,IAAKqE,EAAElM,EAAEkM,EAAGiB,EAAEnN,EAAEmN,EAAGhO,MAAMa,EAAEb,MAAOG,OAAOU,EAAEV,OAAQ6/C,QAASn/C,EAAEwhC,MAAO4d,OAAQp/C,EAAEq/C,MAAMnzC,EAAGozC,OAAQt/C,EAAEq/C,MAAMlyC,EACvHoyC,OAAOv/C,EAAEwN,MAAMtB,EAAGszC,OAAOx/C,EAAEwN,MAAML,EAAGsyC,OAAOz/C,EAAEwwC,MAAOsO,QAAQ9+C,EAAE8+C,QAASvgD,MAAMqN,EAAE8zC,OAAQC,YAAa/zC,EAAE4B,MAAMtB,EAC/GoyC,GAAW5hC,KAAKva,KAERhJ,KAAKqiD,YAAYriD,KAAKmqC,UAAWA,IACzBgM,GAAIA,EAAIV,cAAe0P,EAAY7xB,OAAQA,EAAQD,MAAOA,EAAO8W,UAAWA,EAAW+L,WAAYA,EAAYnL,SAAUA,EAAUuc,SAAUtnD,KAAKgrC,aAAcoL,YAAap2C,KAAKwjD,iBAAiB9N,OAAOA,IAG5Nga,YAAa,SAAUvlD,EAAS2nB,EAASk1B,EAAOhmD,EAAM2uD,GAAqB,GAAhBC,GAAgBxuD,UAAAC,OAAA,GAAAC,SAAAF,UAAA,IAAAA,UAAA,GAC3D22B,EAAsBtwB,EAAAA,WAAMswB,oBACtC+X,EAAyB9vC,KAAzB8vC,UAAW6Z,EAAc3pD,KAAd2pD,WACVj2C,EAAOo8B,EACTlU,GAAe/D,SAAU,EAAGhC,QAAS,KAAMwf,cAAe,KAAKwQ,cAAcC,MAAM,OACnFmJ,EAASjI,EACTD,EAAWj1B,EACX+9B,EAAgBvuD,OAChBwuD,EAAmBxuD,OACjBg1B,EAAOxE,EAAQ6E,MAAMqwB,EAG3B,IAFAiI,IAEa,WAATjuD,GACH,GAAIs1B,EAAKG,QAAQk5B,GAAO,CACR,GAAM/sC,KACNA,GAAM5hB,KAAO,UACb4hB,EAAMxd,MAAQuqD,EACd/sC,EAAMmtC,cAAgB,KACtBntC,EAAMjL,UAAY,EAClBxN,EAAQgsB,OAASvT,GAAjBqI,OAAAC,EAA2B/gB,EAAQgsB,QACnC4wB,GAAYpwB,MAAOL,EAAKG,QAAQk5B,GAAMh5B,MAAO92B,QAAS83B,SAAUovB,EAAUnvB,OAAQovB,GAAQz7C,KAAMumB,EAAQvmB,MACxG0jD,EAAS,OAEnB,IAAI34B,IAASA,EAAK+C,SAAW/C,EAAK8C,OAAS9C,EAAKpV,OAASlgB,EAAM,CACzD,GAAMgvD,IAAgB15B,EAAKsC,uBAAyBrG,UAAU,SAAAmE,GAC1D,MAAOizB,GAAWC,SAASlzB,EAAOu5B,WAAY9lD,MACtCusB,EAAOhC,OAAQpmB,SAASq7C,EAAWC,SAASlzB,EAAOhC,MAAOvqB,IAAY,KAE5E+lD,EAAUF,EAAe,EAAI,KAAO15B,EAAKsC,kBAAkBo3B,EACjE,IAAIE,EAAS,CACT,GAAMttC,KACNA,GAAM5hB,KAAO,oBACb4hB,EAAMxd,MAAQ4qD,EACdptC,EAAMmtC,cAAgB,SAAWG,EAAQlvD,MAAQ,cAAgBkvD,EAAQlvD,KAAOkvD,EAAQD,WAAa,KACrGrtC,EAAMjL,UAAY,EAClBiL,EAAMutC,cAAgBD,EAAQx7B,MAC9BvqB,EAAQgsB,OAASvT,GAAjBqI,OAAAC,EAA2B/gB,EAAQgsB,QACnC84B,EAAS,EACTlI,GAAYpwB,MAAOu5B,EAAQv5B,MAAO92B,QAAS83B,SAAU7F,EAAS8F,OAAQovB,GAAQz7C,KAAMumB,EAAQvmB,OAQ7G,IALa+qB,GAASA,EAAKpV,QAAS,GAAkB,SAATlgB,IAA+BM,SAATN,GAA+B,eAATA,IAAmCM,SAATN,IACtGiuD,KACA9kD,EAAQgsB,UAGjBG,IAAUA,EAAK8C,OAASp4B,GAAUs1B,EAAK8C,MAAQ,aAAep4B,GAAkB,SAATA,GAAkB,CAC5F,GAAIovD,GAAoB,SAATpvD,EAAkB2uD,EAAOr5B,EAAK8C,KACvCi3B,EAAct4B,EAAoBrkB,EAAM08C,EAC1CC,KACHtJ,EAAWsJ,EACXpB,EAAS,EACT9kD,EAAQgsB,SACRhsB,EAAQisB,aAID,GAAIE,GAAiB,eAATt1B,EAAuB,CAC/BmJ,EAAUyB,KAAKkB,MAAMlB,KAAKC,UAAU7L,KAAKmK,SAEzC,KAAK,GAAI0sB,GAAI,EAAGA,EAAI84B,GACX5I,EAASlnD,SAGVsK,EAAQgsB,MAAM,IAAgC,WAA1BhsB,EAAQgsB,MAAM,GAAGn1B,MAJnB61B,IAKlB1sB,EAAQgsB,MAAQhsB,EAAQgsB,MAAMpX,OAAO,GACrCkwC,EAASlI,EAASlnD,OAAO+3B,OACzBmvB,EAAWA,EAASlnD,OAAO83B,cAKxBs3B,IACPjvD,KAAKmK,QAAUA,EACf8kD,KAIR,GAAI34B,GAAiB,eAATt1B,EAAuB,CAC/BmJ,EAAUyB,KAAKkB,MAAMlB,KAAKC,UAAU7L,KAAKmK,SACzC,KAAK,GAAI0sB,GAAI,EAAGA,EAAI84B,GACX5I,EAASlnD,SAGVsK,EAAQgsB,MAAM,IAAgC,WAA1BhsB,EAAQgsB,MAAM,GAAGn1B,MAJnB61B,IAKlB1sB,EAAQgsB,MAAQhsB,EAAQgsB,MAAMpX,OAAO,GACrCkwC,EAASlI,EAASlnD,OAAO+3B,OACzBmvB,EAAWA,EAASlnD,OAAO83B,QAKnC,OAASs3B,EAEL,MADAjvD,MAAKmK,QAAUA,GACP2nB,QAASi1B,EAAUkI,OAAQA,EAAQ9kD,QAASA,GAIrE,GAAImsB,IAASA,EAAK+C,SAAWr4B,GAAiB,eAATA,GAAyB2uD,GAAO,CACpE,GAAMj2B,GAAci2B,GAAQr5B,EAAK+C,OAC3BxyB,EAAIkxB,EAAoBrkB,EAAMgmB,EACpC,IAAI7yB,EAAG,CACN,GAAM+b,KACNA,GAAM5hB,KAAO,SACb4hB,EAAM0tC,YAAYx+B,EAAQ6E,MAAMqwB,GAAOjwB,SACvCnU,EAAMiT,QAAUjT,EAAM0tC,UAAYtwD,KAAKuwD,WAAa,KACpD3tC,EAAMiV,SAAWjV,EAAM0tC,UAAYtwD,KAAKwwD,YAAc,KACtD5tC,EAAM6tC,OAASb,EACfhtC,EAAMyyB,cAAgBzyB,EAAM0tC,UAAYtwD,KAAKwvD,mBAAqB,KACnD5sC,EAAM0tC,YAAcnmD,EAAQisB,WAAap1B,KAAK,WAA1BiqB,OAAAC,EAAwC/gB,EAAQisB,YACnFxT,EAAMmtC,cAAgB,KACtBntC,EAAMjL,UAAY,EAClBiL,EAAM8tC,UAAY3J,EAASpwB,MAAMs4B,EAAO,GAAG1jD,KAC3CqX,EAAM8W,YAAcqtB,EAASx7C,KACdqX,EAAMijC,cAAgBC,MAAM,MAC3CljC,EAAMijC,aAAaC,MAAQ9lD,KAAK0jD,iBAAiB3sB,SACjD5sB,EAAQgsB,OAASvT,GAAjBqI,OAAAC,EAA2B/gB,EAAQgsB,QACnC4wB,GAAYpwB,MAAM9vB,EAAE8vB,MAAO8C,IAAI5yB,EAAE4yB,IAAKluB,KAAK1E,EAAE0E,KAAMouB,aAAc9yB,EAAE8yB,aAAcue,OAAQrxC,EAAEqxC,OAAQr4C,QAAQ83B,SAASovB,EAAUnvB,OAAOq3B,EAAS,IAC9IA,EAAS,EAELjvD,KAAK4yC,cAAcjE,UAEN3uC,KAAK4yC,cAAc3B,SAAS,IAAMjxC,KAAK4yC,cAAc3B,SAAS,GAAG0f,QACpE3wD,KAAKM,iBAAiB7E,cAAcC,aAAa4D,oBAAqBM,KAAKI,KAAK4yC,cAAc3B,SAAS,GAAGrxC,KAAMgxD,YAAY,IAE1H5wD,KAAK85C,6BAKvB,MAASiN,EAASpwB,MAAMs4B,IAAsB,IAAXA,GAAgBlI,EAASpwB,MAAMt1B,QAAU8I,EAAQgsB,OAAS,EAAIhsB,EAAQgsB,MAAM90B,SACxG0lD,EAASpwB,MAAMs4B,IAAsB,IAAXA,IAAiBlI,EAASpwB,MAAMt1B,SAAW0lD,EAASttB,KAAOtvB,EAAQgsB,OAAS,EAAIhsB,EAAQgsB,MAAM90B,QAAS,CAE3H,GAAMuhB,GAAQzY,EAAQgsB,MAAM,EAE5B,IAAIvT,EAAMmtC,eAAiBpG,EAAWC,SAAShnC,EAAMmtC,cAAe5lD,GAAU,CAM1E,GAJA8kD,EAAS,EACLrsC,EAAMjL,WACNiL,EAAMjL,aAENiL,EAAMutC,cAON,KANA,IAAMz7B,GAAQpmB,SAASq7C,EAAWC,SAAShnC,EAAMutC,cAAehmD,GAChE,IAAIyY,EAAMjL,WAAa+c,EAEnB,MAOZ,GADAvqB,EAAQgsB,MAAQhsB,EAAQgsB,MAAMpX,OAAO,GAClB,WAAf6D,EAAM5hB,MAAqBmJ,EAAQisB,SAAS/0B,QAAU8I,EAAQisB,SAAS,GAAGp1B,MAAqC,WAA7BmJ,EAAQisB,SAAS,GAAGp1B,OACtG8uD,EAAmB3lD,EAAQisB,SAAS,GACpCjsB,EAAQisB,SAAWjsB,EAAQisB,SAASrX,OAAO,GAC3C/e,KAAK4sC,qBAAuB5sC,KAAK2jD,eAAc,GAAM14B,SAEjD9gB,EAAQq9C,gBACR,IAAK,GAAI/gD,GAAE,EAAGA,EAAE0D,EAAQq9C,eAAenmD,OAAQoF,IAC3C,GAAImc,EAAM8tC,YAAcvmD,EAAQq9C,eAAe/gD,GAAG8E,KAAlD,CAGA,GAAM0lB,GAASjxB,KAAK4nD,qBAAqB5nD,KAAK8vC,UAAWltB,EAAM8tC,UAAW9tC,EAAM8W,YAChF,IAAI,OAASzI,GAAUA,EAAOa,SAAWb,EAAO7rB,WAC5C,KAEJ,IAAMyrD,GAAY7wD,KAAKqnD,wBAAwBp2B,EAAOa,QAAQ6E,MAAM1F,EAAO7rB,OAAQ+E,EAAQq9C,eAAe/gD,GAAG1F,KAAKwpD,YAIlH,IAHA3nC,EAAMiT,QAAUg7B,EAAUh7B,QAC1BjT,EAAMiV,SAAWg5B,EAAUh5B,SAEvB1tB,EAAQq9C,eAAe/gD,GAAG1F,KAAKsiD,eAAgB,CAC/C,GAAIyN,IAAQrb,iBAAkBniB,OAAQ/f,MAAM,IAAK8f,MAAO,KAAM8W,aAAeY,aAD9BgmB,EAEM5mD,EAAQq9C,eAAe/gD,GAAG1F,KAAKsiD,eAA/Ex9C,EAF0CkrD,EAE1ClrD,OAAQyrC,EAFkCyf,EAElCzf,OAAQgW,EAF0ByJ,EAE1BzJ,SAAU9mB,EAFgBuwB,EAEhBvwB,QAASqpB,EAFOkH,EAEPlH,SAIxC,IAHAiH,EAAKxJ,WAAWA,GAAWA,EAASnwB,KAAK,GACzC25B,EAAK5a,WAAa5E,GAAUA,EAAOlxC,QAAUkxC,EAAOlxC,QAAQ+2B,QAC5D25B,EAAK1a,YAAc5V,EAAUA,EAAQrJ,KAAK,GAAK,GAC3CtxB,EACA,IAAK,GAAI8J,GAAE,EAAGA,EAAE9J,EAAOxE,OAAQsO,IAC3B,GAAI9J,EAAO8J,GAAGvK,MAAQ,EAAG,CACrB,GAAI4D,IAAQtC,IAAIb,EAAO8J,GAAGjJ,IAAKqM,EAAElN,EAAO8J,GAAGoD,EAAGiB,EAAEnO,EAAO8J,GAAGqE,EAAGhO,MAAMH,EAAO8J,GAAG3J,MAAOG,OAAON,EAAO8J,GAAGxJ,OAAQ6/C,QAASngD,EAAO8J,GAAGq2C,QAC1HM,OAAOzgD,EAAO8J,GAAG22C,OAAQlhD,MAAMS,EAAO8J,GAAGvK,MAC/C0rD,GAAKrb,cAAclyB,KAAKva,OAEC,KAApBnD,EAAO8J,GAAGvK,QACf0rD,EAAK3a,IAAMzvC,IAAIb,EAAO8J,GAAGjJ,IAAKs/C,QAAQngD,EAAO8J,GAAGq2C,SAI5D,IAAI6D,GAAaA,EAAUxoD,OACvB,IAAK,GAAIiS,GAAE,EAAGA,EAAEu2C,EAAUxoD,OAAQiS,IAC9Bw9C,EAAK3mB,UAAU72B,GAAKtT,KAAKkjD,kBAAkB2G,EAAUv2C,IACrDw9C,EAAK3mB,UAAU72B,GAAGP,EAAI,EACtB+9C,EAAK3mB,UAAU72B,GAAGU,EAAI,EACtB88C,EAAK3mB,UAAU72B,GAAGzT,OAAS,gBAGnC+iB,GAAMyyB,cAAgByb,EAE1B,MAKZ,GAAI/J,EAASlnD,QAAU,WAAa+iB,EAAM5hB,KAAM,CAO5C,GANA46B,EAAY/D,SAAWjV,EAAM0tC,UAAY1tC,EAAMiV,SAAS,KACxD+D,EAAY/F,QAAUjT,EAAMiT,QAC5B+F,EAAYyZ,cAAgBzyB,EAAMyyB,cAClC4Z,EAASrsC,EAAM0tC,UAAYvJ,EAASlnD,OAAO+3B,OAASmvB,EAASlnD,OAAO+3B,OAAS,EAC7EmvB,EAAWA,EAASlnD,OAAO83B,SAExBxtB,EAAQs9C,SAAWt9C,EAAQs9C,QAAQpmD,SAAW0lD,EAASpwB,MAAMs4B,IAAW9kD,EAAQgsB,MAAM90B,QAAU,EAAE,CAAA,GAAA2vD,GACpF7mD,EAAQs9C,QAAQ3pB,MAAxCpE,EAD4Gs3B,EAC5Gt3B,YAAY4hB,EADgG0V,EAChG1V,SACK2V,EAAel5B,EAAoBrkB,EAAKgmB,EAC9C,KAAIu3B,EAAc,KAClBlK,GAAWkK,EACXhC,EAAS3T,EAEbt7C,KAAK4sC,qBAAuB5sC,KAAK2jD,eAAc,GAAM14B,aAClD,IAAIrI,EAAM8tC,WAA4B,WAAf9tC,EAAM5hB,KAAmB,CACnD46B,EAAY/D,SAAWjV,EAAM0tC,UAAY1tC,EAAMiV,SAAS,KACxD+D,EAAY/F,QAAUjT,EAAMiT,QAC5B+F,EAAYyZ,cAAgBzyB,EAAMyyB,cAClCzZ,EAAY8Z,OAAS9yB,EAAM8yB,OAAS9yB,EAAM8yB,OAAOzqB,YAC9CrI,EAAMijC,cAA6C,OAA7BjjC,EAAMijC,aAAaC,QACxClqB,EAAYiqB,aAAaC,MAAQ3oC,OAAO8d,OAAOrY,EAAMijC,aAAaC,UANnB,IAAAoL,GAQpBlxD,KAAK4nD,qBAAqB5nD,KAAK8vC,UAAWltB,EAAM8tC,UAAW9tC,EAAM8W,aAAhF7yB,EARmCqqD,EAQ5Cp/B,QAAmBzqB,EARyB6pD,EAQhC9rD,KACnB6pD,GAASrsC,EAAM0tC,UAAYjpD,EAAIA,EAAE,EAC9Bub,EAAM6tC,SAAW7tC,EAAM0tC,WAAarB,EAASpoD,EAAE8vB,MAAMt1B,SAAQ4tD,EAAS5nD,GACzE0/C,EAAWlgD,EACXgpD,EAAgBjtC,EAChB5iB,KAAK4sC,qBAAuB5sC,KAAK2jD,eAAc,GAAM14B,UAGtE,OAAQ6G,QAASi1B,EAAUkI,OAAQA,EAAQrzB,YAAAA,EAAazxB,QAAAA,EAAS0lD,cAAAA,EAAeC,iBAAAA,IAGjFqB,eAAgB,SAAUhnD,EAAS0rB,EAASzwB,EAAOgsD,GAAQ,GAC5CzH,GAAc3pD,KAAd2pD,WACD0H,EAAWx7B,EACXy7B,EAASlsD,CAGb,IAFAksD,IAEI,YAAcF,EAAOpwD,KAAM,CAC3B,GAAMm2B,GAAOtB,EAAQkB,SAAS3xB,GAAO+xB,IACrC,IAAIi6B,EAAOhsD,OAAS,GAAK+xB,EAAKi6B,EAAOhsD,OAAO2xB,SAAS11B,OAAS,EAAG,CAC7D,GAAMuhB,KACNA,GAAMmtC,cAAgB,KACtBntC,EAAMjL,UAAY,EAClBxN,EAAQisB,UAAYxT,GAApBqI,OAAAC,EAA8B/gB,EAAQisB,WAEtCk7B,EAAS,EACTD,GAAYt6B,SAAUI,EAAKi6B,EAAOhsD,OAAO2xB,SAAUK,WAAYvB,EAASwB,eAAgBjyB,OAGxFpF,MAAKuxD,YAAY50C,cAGpB,IAAI,eAAiBy0C,EAAOpwD,KAAM,CACnC,GAAMm2B,GAAOtB,EAAQkB,SAAS3xB,GAAO+xB,KAC/B64B,EAAgB74B,EAAM5E,UAAU,SAAAmE,GAClC,MAAOizB,GAAWC,SAASlzB,EAAOu5B,WAAY9lD,MACtCusB,EAAOhC,OAAQpmB,SAASq7C,EAAWC,SAASlzB,EAAOhC,MAAOvqB,IAAY,KAE5E+lD,EAAUF,EAAe,EAAI,KAAO74B,EAAK64B,EAC/C,IAAIE,EAAS,CACT,GAAMttC,KACNA,GAAMmtC,cAAgB,SAAWG,EAAQlvD,MAAQ,cAAgBkvD,EAAQlvD,KAAOkvD,EAAQD,WAAa,KACrGrtC,EAAMjL,UAAY,EAClBiL,EAAMutC,cAAgBD,EAAQx7B,MAC9BvqB,EAAQisB,UAAYxT,GAApBqI,OAAAC,EAA8B/gB,EAAQisB,WACtCk7B,EAAS,EACTD,GAAYt6B,SAAUm5B,EAAQn5B,SAAUK,WAAYvB,EAASwB,eAAgBjyB,QAGhF,IAAI,eAAiBgsD,EAAOpwD,KAAM,CACnC,IAAK,GAAIyF,GAAE,EAAGA,EAAE2qD,EAAOzB,MACjB0B,EAASj6B,aAGPjtB,EAAQisB,SAAS,IAAmC,WAA7BjsB,EAAQisB,SAAS,GAAGp1B,MAJtByF,IAKrB0D,EAAQisB,SAAWjsB,EAAQisB,SAASrX,OAAO,GAC3CuyC,EAASD,EAASh6B,eAClBg6B,EAAWA,EAASj6B,UAK5B,IAAIk6B,MAAeD,EAASt6B,SAC3B,OAAQqhB,KAAMiZ,EAAUjsD,MAAOksD,OAG/B,IAAI,eAAiBF,EAAOpwD,KAAM,CACnC,IAAK,GAAIyF,GAAE,EAAGA,EAAE2qD,EAAOzB,MACjB0B,EAASj6B,aAGPjtB,EAAQisB,SAAS,IAAmC,WAA7BjsB,EAAQisB,SAAS,GAAGp1B,MAJtByF,IAKrB0D,EAAQisB,SAAWjsB,EAAQisB,SAASrX,OAAO,GAC3CuyC,EAASD,EAASh6B,eAClBg6B,EAAWA,EAASj6B,UAM5Bk6B,KAGJ,KAAOD,IAAaA,EAASt6B,SAASu6B,IAAWnnD,EAAQisB,UAAY,EAAIjsB,EAAQisB,SAAS/0B,QAAQ,CAC9F,GAAMuhB,GAAQzY,EAAQisB,SAAS,EAC/B,IAAIxT,EAAMmtC,eAAiBpG,EAAWC,SAAShnC,EAAMmtC,cAAe5lD,GAAU,CAM1E,GAJAmnD,EAAS,EACL1uC,EAAMjL,WACNiL,EAAMjL,aAENiL,EAAMutC,cAON,KANA,IAAMz7B,GAAQpmB,SAASq7C,EAAWC,SAAShnC,EAAMutC,cAAehmD,GAChE,IAAIyY,EAAMjL,WAAa+c,EAEnB,MAOP9R,EAAM5hB,MAAuB,WAAf4hB,EAAM5hB,OACrBmJ,EAAQisB,SAAWjsB,EAAQisB,SAASrX,OAAO,IAG3C6D,EAAM5hB,MAAuB,WAAf4hB,EAAM5hB,MACpBswD,KACAD,EAAW,MAENA,EAASj6B,aACdk6B,EAASD,EAASh6B,eAAiB,EACnCg6B,EAAWA,EAASj6B,YAI5B,OAAQghB,KAAMiZ,EAAUjsD,MAAOksD,IAGzCE,gBAAiB,SAAU5a,GACjB,GAAIA,EAAM6a,aACN7a,EAAM6a,aAAa90C,cAElB,IAAIi6B,EAAM3F,UAAY2F,EAAM3F,SAAS5vC,OACtC,IAAK,GAAIoF,GAAI,EAAGA,EAAImwC,EAAM3F,SAAS5vC,OAAQoF,IACvCzG,KAAKwxD,gBAAgB5a,EAAM3F,SAASxqC,KAKhDirD,gBAAiB,SAAUjrB,GAAM,GAAAkrB,GAAA3xD,IAC7B,OAAsB,UAAlBymC,EAAKoc,cACkB,YAAnBpc,EAAKmrB,UACL32C,aAAawrB,EAAK7U,cAElBigC,cAAcprB,EAAK7U,mBAKvB6U,GAAKwK,SAAS5zB,QAAQ,SAAA1N,GAAA,MAAKgiD,GAAKD,gBAAgB/hD,MAI9DmiD,0BAA2B,SAAUC,EAAOve,GAE3C,GAAKA,EAASzc,UAAY,IAAMyc,EAASzc,SAAS11B,OAmBlD,IAAK,GAfC2wD,GAAc,QAAdA,GAAezmD,EAAMsqB,GAC1B,IAAK,GAAIpvB,GAAE,EAAGA,EAAEovB,EAAQx0B,OAAQoF,IAAK,CACpC,GAAIovB,EAAQpvB,GAAG8E,OAASA,EACvB,OAAO,CAEH,IAAI,YAAcsqB,EAAQpvB,GAAGzF,MAAQ,qBAAuB60B,EAAQpvB,GAAGzF,KAC3E,IAAK,GAAIsS,GAAE,EAAGA,EAAEuiB,EAAQpvB,GAAG0wB,KAAK91B,OAAQiS,IACvC,GAAI0+C,EAAYzmD,EAAMsqB,EAAQpvB,GAAG0wB,KAAK7jB,GAAGyjB,UACxC,OAAO,EAKX,OAAO,GAECtwB,EAAE,EAAGA,EAAEsrD,EAAM1wD,OAAQoF,IAC7B,GAAKsrD,EAAMtrD,GAAGs8C,aAAd,CAGA,GAAM4C,GAAUoM,EAAMtrD,GAAGs8C,YACrBiP,GAAYrM,EAASnS,EAASzc,YAGlCg7B,EAAMhzC,OAAOtY,EAAG,GAChBA,OAIFwgD,WAAY,WAAY,GAAAgL,GAAAjyD,IAYd,IAXAA,KAAKyqD,cAAcC,WAAU,GAC7B1qD,KAAKklD,aAAellD,KAAKklD,YAAY7nC,QAAQ,SAAAtY,GACzCktD,EAAKT,gBAAgBzsD,GACrBA,EAAE4X,SAAW5X,EAAE4X,YAEnB3c,KAAKklD,YAAc,KACnBllD,KAAKkyD,eAAejhB,SAAS5zB,QAAQ,SAAAxW,GAC7CorD,EAAKP,gBAAgB7qD,GACZorD,EAAKT,gBAAgB3qD,KAEtB7G,KAAKkyD,eAAexH,WAAU,GAC1B,QAAU3nD,UAAU+L,QAAU,SAAW/L,UAAUstB,YAAa,CACnEmD,EAAAA,WAAW2+B,YACX3+B,EAAAA,WAAWpiB,eAAeoiB,EAAAA,WAAW3jB,UAAUnB,IAE/C,KAAK,GAAIjI,GAAE,EAAGA,EAAE,GAAIA,IACf+sB,EAAAA,WAAW1iB,WAAWrK,GAAGiI,MAC5B8kB,EAAAA,WAAW4+B,UAAU3rD;AACrB+sB,EAAAA,WAAWpiB,eAAeoiB,EAAAA,WAAW1iB,WAAWrK,GAAGiI,UAKlD1O,MAAKgoC,UAAYhoC,KAAKgoC,SAASrrB,UAC/B3c,KAAKgoC,SAAW,KAChBhoC,KAAKioC,YAAcjoC,KAAKioC,WAAW5qB,QAAQ,SAAAtY,GAAA,MAAKA,IAAKA,EAAE4X,YACvD3c,KAAKioC,aAGLjoC,MAAKqyD,eACLryD,KAAKqyD,aAAa11C,UAClB3c,KAAKqyD,aAAe,OAIlCC,QAAS,WAA4B,GAAAC,GAAAvyD,KAAlBwyD,EAAkBpxD,UAAAC,OAAA,GAAAC,SAAAF,UAAA,IAAAA,UAAA,EAY3BpB,MAAKyyD,YAAY9jB,SAAU,EACpC3uC,KAAK6rC,sBAAwB,KAC7B7rC,KAAK8rC,gBAAkB,KACvB9rC,KAAKinD,aACQjnD,KAAK0kD,YAAYzT,SAAS5vC,OAAS,GACnCrB,KAAK0kD,YAAYgG,WAAU,GAE/B1qD,KAAK2sC,oBACL3sC,KAAK6sC,uBACd7sC,KAAKunD,YAAYvnD,KAAKmK,QACb,IAAM+W,GAAO,WACT,IAAKqxC,EAAKziB,UAAUc,MAAMkK,OACtB,MAAOyX,GAAKhgB,WAEZ,IAAMzgB,GAAUygC,EAAK1a,mBACfne,EAAc5H,EAAQ6H,aAAe7H,EAAQ6H,aAAe7H,EAAQvmB,IAG1E,IAAGgnD,EAAKjlB,aAYJ,WAXAilB,GAAKr4B,mBAAmBR,EAAa5H,EAAQ2H,KAAKvwB,KAAK,SAACytB,GAAQ,GAAA+7B,IAC5DA,EAAA5gC,EAAQ6E,OAAMpT,KAAd3G,MAAA81C,EAAAxnC,EAAsByL,IACtB47B,EAAKhc,qBAAqBgc,EAAKpoD,QAAS2nB,EAAQxwB,OAAUA,OAAUA,QAAU,IAChF,SAAC6H,QAEYA,EAAIiR,QAAQ,WACnB5N,EAAAA,WAAOsf,MAAM3iB,GAEbopD,EAAKta,wBAAwBve,EAAa5H,EAAQomB,OAAQpmB,EAAQ2H,IAAK,OAMnF,IAAI3H,EAAQ2H,KAAgC,IAAzB3H,EAAQ6E,MAAMt1B,OAC7B,IAAIywB,EAAQomB,QAAW,YAAcn1C,UAAU+L,QAAU,QAAU/L,UAAU+L,QAA+B,QAArB/L,UAAU+L,OAmB7FyjD,EAAKr4B,mBAAmBR,EAAa5H,EAAQ2H,KAAKvwB,KAAK,SAACytB,GACpD7E,EAAQ6E,MAAQA,EAChB47B,EAAKhc,qBAAqBgc,EAAKpoD,QAAS2nB,EAAQxwB,OAAUA,OAAUA,QAAU,IAC/E,SAAC6H,QACWA,EAAIiR,QAAQ,WACnB5N,EAAAA,WAAOsf,MAAM3iB,GAEQ,WAAlBpG,UAAUye,IACThV,EAAAA,WAAO4rC,KAAK,uBAAuBlvC,KAAK,WACpC1N,OAAOkR,SAAS2rC,KAAO,uDAAwDt1C,UAAUwG,MAG7FiD,EAAAA,WAAO4rC,KAAK,kCA/BwF,CAChH,GAAMG,GAAe,SAACC,GACdA,GACA+Z,EAAKr4B,mBAAmBR,EAAa5H,EAAQ2H,KAAKvwB,KAAK,SAACytB,GACpD47B,EAAK1mB,sBAAwB,KAC7B/Z,EAAQ6E,MAAQA,EAChB47B,EAAKhc,qBAAqBgc,EAAKpoD,QAAS2nB,EAAQxwB,OAAUA,OAAUA,QAAU,IAC/E,WACyB,QAArByB,UAAU+L,OACTtT,OAAOqE,QAAUrE,OAAOqE,OAAO44C,YAE/BjsC,EAAAA,WAAOsf,MAAM,gBAM7BymC,GAAK7Z,cAAchf,EAAa5H,EAAQomB,OAAQpmB,EAAQ2H,IAAK8e,OAoBjEga,GAAKhc,qBAAqBgc,EAAKpoD,QAAS2nB,EAAQxwB,OAAUA,OAAUA,QAAU,GAIhGkxD,MAAa,EAEfhmD,EAAAA,WAAOC,OAAO,OAAO,oBAAoB,KAAK,OAAO,MAAMvD,KAAK,WAChD1N,OAAOkR,SAAS2rC,KAAO,wBACrC,SAAClsC,GACF+U,MAGDA,KAMIyxC,eAAe,SAAUxoD,EAAQszC,GAA0C,GAAAmV,GAAA5yD,KAAnC6yD,EAAmCzxD,UAAAC,OAAA,GAAAC,SAAAF,UAAA,IAAAA,UAAA,GAApB0xD,EAAoB1xD,UAAAC,OAAA,GAAAC,SAAAF,UAAA,IAAAA,UAAA,EAC1E,IAAGyxD,KAAW,GAAQC,KAAe,EACpC,MAAOlxD,SAAQC,SAAQ,EAGrB,IAAMkxD,GAAc,WAChB,GAAGtV,GAAUA,EAAOp8C,OAAS,EACzB,IAAI,GADuBy5B,GAAA,SACnBr0B,GACJ,GAAIusD,KACJ,OAAG7oD,GAAQgB,UAAUonB,UAAU,SAAA5iB,GAAA,MAAKA,GAAEpE,OAASkyC,EAAOh3C,GAAG8E,aACrDoE,GAAO,GAERxF,EAAQo/C,cAAgByJ,EAAS7oD,EAAQo/C,YAAYh3B,UAAU,SAAA5iB,GAAA,MAAKA,GAAEpE,OAASkyC,EAAOh3C,GAAG8E,cAC3C,aAA1CpB,EAAQo/C,YAAYyJ,GAAQlpD,KAAK9I,MAChC2O,GAAO,GAFf,QALIlJ,EAAI,EAAGA,EAAGg3C,EAAOp8C,OAAOoF,IAAI,CAAA,GAAAwsD,GAAAn4B,EAA5Br0B,EAA4B,IAAA,YAAA,mBAAAwsD,GAAA,YAAAC,EAAAD,IAAA,MAAAA,GAAAtjD,EAYxC,OAAO,EAEX,OAAO,IAAI/N,SAAQ,SAACC,EAAQC,GACxB,MAAGixD,SACCH,GAAKxf,aAAalqC,KAAK,SAACgD,GACpB,MAA4C,oBAAxCiR,OAAOb,UAAU7R,SAASmS,MAAM1Q,IAA+C,KAAlBnJ,UAAUkK,KACvE2lD,EAAK1lB,wBAAyB,EAC9B/iC,EAAQgB,UAAYS,KAAKkB,MAAMlB,KAAKC,UAAU+mD,EAAKzoD,QAAQgB,YACpDtJ,GAAQ,KAEf+wD,EAAK1lB,wBAAyB,EAC3BhhC,EAAGkO,QAAQ,oBAEV5N,EAAAA,WAAO4rC,KAAK,4CAA4ClvC,KAAK,KAAK,MAC3DrH,GAAQ,IAGRA,GAAQ,MAKpBA,GAAQ,MAWjCsxD,eAAgB,SAAUhpD,EAASszC,EAAQ2V,GAAyC,GAAAC,GAAArzD,KAA3BqK,EAA2BjJ,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAlB,KAAKkyD,EAAalyD,UAAAC,OAAA,GAAAC,SAAAF,UAAA,IAAAA,UAAA,EACnFpB,MAAKmsC,aAAc,CACV,IAAIonB,IAAW,EACXC,KAAkBC,KAAiBC,KAAkBC,KAEnDC,EAAgB,WAClB,IAAK,GAAItgD,GAAE,EAAGA,EAAEnJ,EAAQszC,OAAOp8C,OAAQiS,IAAOkgD,EAAYlgD,GAAKnJ,EAAQszC,OAAOnqC,GAAGkN,KACjF,KAAK,GAAIlN,GAAE,EAAGA,EAAEnJ,EAAQk/C,YAAYhoD,OAAQiS,IAAOmgD,EAAWngD,GAAKnJ,EAAQk/C,YAAY/1C,GAAGkN,KAC1F,KAAK,GAAIlN,GAAE,EAAGA,EAAEnJ,EAAQm/C,aAAajoD,OAAQiS,IAAOogD,EAAYpgD,GAAKnJ,EAAQm/C,aAAah2C,GAAGkN,KAC7F,KAAK,GAAIlN,GAAE,EAAGA,EAAEnJ,EAAQgB,UAAU9J,OAAQiS,IAAOqgD,EAASrgD,GAAKnJ,EAAQgB,UAAUmI,GAAGkN,OAGlFqzC,EAAgB,WAClB,IAAK,GAAIvgD,GAAE,EAAGA,EAAEkgD,EAAYnyD,OAAQiS,IAAOnJ,EAAQszC,OAAOnqC,GAAGkN,MAAQgzC,EAAYlgD,EACjF,KAAK,GAAIA,GAAE,EAAGA,EAAEmgD,EAAWpyD,OAAQiS,IAAOnJ,EAAQk/C,YAAY/1C,GAAGkN,MAAQizC,EAAWngD,EACpF,KAAK,GAAIA,GAAE,EAAGA,EAAEogD,EAAYryD,OAAQiS,IAAOnJ,EAAQm/C,aAAah2C,GAAGkN,MAAQkzC,EAAYpgD,EACvF,KAAK,GAAIA,GAAE,EAAGA,EAAEqgD,EAAStyD,OAAQiS,IAAOnJ,EAAQgB,UAAUmI,GAAGkN,MAAQmzC,EAASrgD,IAGrFwgD,EAAiB,WACb,GAAG/wD,UAAUuf,QAAgC,MAAtBvf,UAAUmM,QAC1B,MAAOmkD,GAAK7W,cAActzC,KAAK,WAAM,MAAOmqD,GAAKpW,mBAGjD,KAAIsW,EAAU,MAAO3xD,SAAQE,QAC7B,IAAmB,KAAhBiB,UAAUoK,GAAgC,KAApBpK,UAAUmK,OAAqC,KAArBnK,UAAU+L,OAAc,CACvE,GAAI7B,GAAMxF,EAAAA,WAAM0rC,gBAChB,OAAIlmC,KAAQlK,UAAUkK,KAAe,KAARA,GAEzBlK,UAAUkK,IAAMA,EAChBomD,EAAKhX,0BAAyB,GAC9BgX,EAAKjgB,aAAalqC,KAAK,WACnBmqD,EAAKzX,mBAEFh6C,QAAQE,UAEXsxD,EAAqDxxD,QAAQE,SAAvCuxD,EAAK7W,cAGnC,MAAwB,QAArBz5C,UAAU+L,QAAsC,KAAlB/L,UAAUkK,IAChComD,EAAK7jB,qBAAqBtmC,KAAK,WAClC,MAAIkqD,GACOxxD,QAAQE,SADOuxD,EAAK7W,gBAKnC4W,EACOxxD,QAAQE,SADOuxD,EAAK7W,eAO9CuX,EAAqB,SAAC3uD,EAAOuK,EAAGqkD,GACrC,IAAKA,EAiBJ,MAhBIrkD,GAAI,EACWnD,EAAAA,WAAO4rC,KAAK,sBAEkC,UAAzCjuC,EAAQo/C,YAAYnkD,GAAO0E,KAAK9I,MAAoB2O,EAAExF,EAAQszC,OAAOp8C,OAC1EmL,EAAAA,WAAO4rC,KAAK,sBAEmB,eAAzCjuC,EAAQo/C,YAAYnkD,GAAO0E,KAAK9I,MAAyB2O,EAAExF,EAAQk/C,YAAYhoD,OACrEmL,EAAAA,WAAO4rC,KAAK,sBAEmB,gBAAzCjuC,EAAQo/C,YAAYnkD,GAAO0E,KAAK9I,MAA0B2O,EAAExF,EAAQm/C,aAAajoD,OACvEmL,EAAAA,WAAO4rC,KAAK,sBAEmB,aAAzCjuC,EAAQo/C,YAAYnkD,GAAO0E,KAAK9I,MAAuB2O,EAAExF,EAAQgB,UAAU9J,QACjEmL,EAAAA,WAAO4rC,KAAK,2BAE/BjuC,EAAQo/C,YAAYnkD,GAAOob,MAAQ7Q,EAIxB,IAAMlJ,GAAyCnF,SAArC6I,EAAQo/C,YAAYnkD,GAAOob,MAAsBrW,EAAQo/C,YAAYnkD,GAAO0E,KAAK0W,MAAM,EAAIrW,EAAQo/C,YAAYnkD,GAAOob,MAAM,CAClJ,IAA6C,UAAzCrW,EAAQo/C,YAAYnkD,GAAO0E,KAAK9I,KAAkB,CACrD,GAAIyF,EAAE,GAAKA,GAAG0D,EAAQszC,OAAOp8C,OAE5B,WADAmL,GAAAA,WAAO4rC,KAAK,qBAGEjuC,GAAQszC,OAAOh3C,GAAG+Z,MAAQ7Q,MAEzB,IAA6C,eAAzCxF,EAAQo/C,YAAYnkD,GAAO0E,KAAK9I,KAAuB,CAC5D,GAAIyF,EAAE,GAAKA,GAAG0D,EAAQk/C,YAAYhoD,OAE9B,WADAmL,GAAAA,WAAO4rC,KAAK,qBAGhBjuC,GAAQk/C,YAAY5iD,GAAG+Z,MAAQ7Q,MAE9B,IAA6C,gBAAzCxF,EAAQo/C,YAAYnkD,GAAO0E,KAAK9I,KAAwB,CAC7D,GAAIyF,EAAE,GAAKA,GAAG0D,EAAQm/C,aAAajoD,OAE/B,WADAmL,GAAAA,WAAO4rC,KAAK,qBAGhBjuC,GAAQm/C,aAAa7iD,GAAG+Z,MAAQ7Q,MAE/B,IAA6C,aAAzCxF,EAAQo/C,YAAYnkD,GAAO0E,KAAK9I,KAAqB,CAC1D,GAAIyF,EAAE,GAAKA,GAAG0D,EAAQgB,UAAU9J,OAE5B,WADAmL,GAAAA,WAAO4rC,KAAK,qBAGhBmb,IAAW,EACXppD,EAAQgB,UAAU1E,GAAG+Z,MAAQ7Q,IAKxCojD,EAAc,WACP,GAAGtV,GAAUA,EAAOp8C,OAAS,EAC5B,IAAI,GAD0B2gC,GAAA,SACtBv7B,GACP,GAAIusD,KACJ,OAAG7oD,GAAQgB,UAAUonB,UAAU,SAAA5iB,GAAA,MAAKA,GAAEpE,OAASkyC,EAAOh3C,GAAG8E,aACxDoE,GAAO,GAECxF,EAAQo/C,cAAgByJ,EAAS7oD,EAAQo/C,YAAYh3B,UAAU,SAAA5iB,GAAA,MAAKA,GAAEpE,OAASkyC,EAAOh3C,GAAG8E,cAC3C,aAA1CpB,EAAQo/C,YAAYyJ,GAAQlpD,KAAK9I,MACnC2O,GAAO,GAFZ,QALClJ,EAAI,EAAGA,EAAGg3C,EAAOp8C,OAAOoF,IAAI,CAAA,GAAAwtD,GAAAjyB,EAA5Bv7B,EAA4B,IAAA,YAAA,mBAAAwtD,GAAA,YAAAf,EAAAe,IAAA,MAAAA,GAAAtkD,EAYjD,OAAO,EAGR,IAAI8tC,GAAUA,EAAOp8C,OAAS,EAAG,CAChC,GAAIoF,GAAI,EACFytD,EAAS,SAACztD,GAiBf,MAhBGA,IAAKg3C,EAAOp8C,OAAS,GAEvByyD,IAAiB5qD,KAAK,WAErBmqD,EAAKlnB,aAAc,EACE9hC,GAAYA,EAASF,IACzC,YAEEopD,GAAaD,GAAUF,GAEDS,IAEJR,EAAKlnB,aAAc,EACnB9hC,GAAYA,EAASF,KAGrC1D,EAAIg3C,EAAOp8C,OAAS,GAEtB8yD,EAAY,QAAZA,GAAa1tD,GACH,GAAI+Z,GAAQi9B,EAAOh3C,GACbkJ,EAAI0jD,EAAK1J,WAAWC,SAASppC,EAAMyvC,WAAYoD,EAAKlpD,SACpDoB,EAAOiV,EAAMjV,KACfnG,EAAAA,QACCA,EAAQiuD,EAAKlpD,QAAQszC,OAAOlrB,UAAU,SAAA5iB,GAAA,MAAKA,GAAEpE,OAASA,WACvDpB,EAAQszC,OAAOr4C,GAAOob,MAAQ7Q,EAC9BukD,EAAOztD,IAAM0tD,EAAU1tD,GAAG,KAEpBrB,EAAQiuD,EAAKlpD,QAAQk/C,YAAY92B,UAAU,SAAA5iB,GAAA,MAAKA,GAAEpE,OAASA,WACjEpB,EAAQk/C,YAAYjkD,GAAOob,MAAQ7Q,EACnClI,EAAAA,WAAMq1C,oBAAoB/5C,UAAUwI,KAAO,cAAgBxI,UAAUkK,IAAKrB,KAAKC,UAAU1B,EAAQk/C,cACjG6K,EAAOztD,IAAM0tD,EAAU1tD,GAAG,KAEpBrB,EAAQiuD,EAAKlpD,QAAQm/C,aAAa/2B,UAAU,SAAA5iB,GAAA,MAAKA,GAAEpE,OAASA,WAClEpB,EAAQm/C,aAAalkD,GAAOob,MAAQ7Q,EACpCukD,EAAOztD,IAAM0tD,EAAU1tD,GAAG,KAEpBrB,EAAQiuD,EAAKlpD,QAAQgB,UAAUonB,UAAU,SAAA5iB,GAAA,MAAKA,GAAEpE,OAASA,WAC/DpB,EAAQgB,UAAU/F,GAAOob,MAAQ7Q,EACjC4jD,GAAW,EACXW,EAAOztD,IAAM0tD,EAAU1tD,GAAG,KAGpBrB,EAAQiuD,EAAKlpD,QAAQo/C,YAAYh3B,UAAU,SAAA5iB,GAAA,MAAKA,GAAEpE,OAASA,WACjEwoD,EAAmB3uD,EAAOuK,EAAG6Q,EAAMwzC,WACnCE,EAAOztD,IAAM0tD,EAAU1tD,GAAG,KAG1B4F,QAAQyf,MAAM,4CAA6CvgB,GAC3D2oD,EAAOztD,IAAM0tD,EAAU1tD,GAAG,IAG3C1D,WAAUuf,QAAgC,MAAtBvf,UAAUmM,QACjBilD,EAAU1tD,GAEPssD,IAEIK,GAAiBE,GACbF,IACCjpD,EAAUyB,KAAKkB,MAAMlB,KAAKC,UAAU1B,KAGrCmpD,GAAOM,IACVO,EAAU1tD,KAEVmtD,IACAO,EAAU1tD,IAGd0tD,EAAU1tD,OAIF,QAAb4D,IAAoBrK,KAAKmsC,aAAc,EAAM9hC,EAASF,KAIvEiqD,aAAc,SAAUC,GAEvB,IAAK,GADDC,GAAa1oD,KAAKkB,MAAMlB,KAAKC,UAAU7L,KAAK8vC,UAAU2N,SACjDh3C,EAAE,EAAGA,EAAE4tD,EAAW5W,OAAOp8C,OAAQoF,IACzC,IAAK,GAAI6M,GAAE,EAAGA,EAAEghD,EAAWjzD,OAAQiS,IAClC,GAAIghD,EAAWhhD,GAAG/H,OAAS8oD,EAAW5W,OAAOh3C,GAAG8E,KAAM,CACrD+oD,EAAWhhD,GAAGkN,MAAQ6zC,EAAW5W,OAAOh3C,GAAG+Z,KAC3C,OAIH6zC,EAAW5W,OAAS6W,EAAWrpC,SAE/BqpC,EAAa1oD,KAAKkB,MAAMlB,KAAKC,UAAU7L,KAAK8vC,UAAUuZ,aAC7C,KAAK,GAAI5iD,GAAE,EAAGA,EAAE4tD,EAAWhL,YAAYhoD,OAAQoF,IAC3C,IAAK,GAAI6M,GAAE,EAAGA,EAAEghD,EAAWjzD,OAAQiS,IAC/B,GAAIghD,EAAWhhD,GAAG/H,OAAS8oD,EAAWhL,YAAY5iD,GAAG8E,KAAM,CACvD+oD,EAAWhhD,GAAGkN,MAAQ6zC,EAAWhL,YAAY5iD,GAAG+Z,KAChD,OAIZ6zC,EAAWhL,YAAciL,EAAWrpC,SAEpCqpC,EAAa1oD,KAAKkB,MAAMlB,KAAKC,UAAU7L,KAAK8vC,UAAUwZ,cACtD,KAAK,GAAI7iD,GAAE,EAAGA,EAAE4tD,EAAW/K,aAAajoD,OAAQoF,IAC5C,IAAK,GAAI6M,GAAE,EAAGA,EAAEghD,EAAWjzD,OAAQiS,IAC/B,GAAIghD,EAAWhhD,GAAG/H,OAAS8oD,EAAW/K,aAAa7iD,GAAG8E,KAAM,CACxD+oD,EAAWhhD,GAAGkN,MAAQ6zC,EAAW/K,aAAa7iD,GAAG+Z,KACjD,OAMZ,GAFA6zC,EAAW/K,aAAegL,EAAWrpC,SAEjCjrB,KAAK8vC,UAAU3kC,UAAW,CAE1B,GADAmpD,EAAa1oD,KAAKkB,MAAMlB,KAAKC,UAAU7L,KAAK8vC,UAAU3kC,YAClDkpD,EAAWlpD,UACX,IAAK,GAAI1E,GAAE,EAAGA,EAAE4tD,EAAWlpD,UAAU9J,OAAQoF,IACzC,IAAK,GAAI6M,GAAE,EAAGA,EAAEghD,EAAWjzD,OAAQiS,IAC/B,GAAIghD,EAAWhhD,GAAG/H,OAAS8oD,EAAWlpD,UAAU1E,GAAG8E,KAAM,CACrD+oD,EAAWhhD,GAAGkN,MAAQ6zC,EAAWlpD,UAAU1E,GAAG+Z,KAC9C,OAKhB6zC,EAAWlpD,UAAYmpD,EAAWrpC,SAGtC,GAAIjrB,KAAK8vC,UAAUyZ,YAAa,CAE5B,GADA+K,EAAa1oD,KAAKkB,MAAMlB,KAAKC,UAAU7L,KAAK8vC,UAAUyZ,cAClD8K,EAAW9K,YACX,IAAK,GAAI9iD,GAAE,EAAGA,EAAE4tD,EAAW9K,YAAYloD,OAAQoF,IAC3C,IAAK,GAAI6M,GAAE,EAAGA,EAAEghD,EAAWjzD,OAAQiS,IAC/B,GAAIghD,EAAWhhD,GAAG/H,OAAS8oD,EAAW9K,YAAY9iD,GAAG8E,KAAM,CACvD+oD,EAAWhhD,GAAGkN,MAAQ6zC,EAAW9K,YAAY9iD,GAAG+Z,KAChD,OAKhB6zC,EAAW9K,YAAc+K,EAAWrpC,WAKlDs8B,YAAa,SAAU8M,EAAYE,GAClC,GAAMhY,GAAO,SAACxuC,GACb,MAAKA,GAGEnC,KAAKkB,MAAMlB,KAAKC,UAAUkC,IAFzBA,GAIH5D,IAKG,IAJToqD,GAAUv0D,KAAKo0D,aAAaC,GAC5BlqD,EAAQ0vC,KAAO75C,KAAKmK,SAAWnK,KAAKmK,QAAQ0vC,OAAQ,EACpD1vC,EAAQykC,WAAa5uC,KAAKmK,SAAWnK,KAAKmK,QAAQykC,aAAc,EACvDzkC,EAAQk/C,YAAc9M,EAAK8X,GAAcA,EAAWhL,aAAerpD,KAAK8vC,UAAUuZ,cAC7EgL,IAAeE,EAAQ,CACxB,GAAMC,GAAiB/sD,EAAAA,WAAMm1C,oBAAoB75C,UAAUwI,KAAO,cAAgBxI,UAAUkK,IAC5F,IAAIunD,EAEA,IAAK,GADCC,GAAiB7oD,KAAKkB,MAAM0nD,GACzB/tD,EAAE,EAAGA,EAAEguD,EAAepzD,OAAQoF,IACtC,IAAK,GAAI6M,GAAE,EAAGA,EAAEnJ,EAAQk/C,YAAYhoD,OAAQiS,IAC3C,GAAInJ,EAAQk/C,YAAY/1C,GAAG/H,OAASkpD,EAAehuD,GAAG8E,KAAM,CAC3DpB,EAAQk/C,YAAY/1C,GAAGkN,MAAQi0C,EAAehuD,GAAG+Z,KACjD,QAMX,GAAI+zC,EACApqD,EAAQszC,OAASlB,EAAK8X,EAAW5W,QACjCtzC,EAAQm/C,aAAe/M,EAAK8X,EAAW/K,cACvCn/C,EAAQgB,UAAYoxC,EAAKv8C,KAAKmK,QAAQgB,WACtChB,EAAQo/C,YAAchN,EAAK8X,EAAW9K,iBAErC,CACDp/C,EAAQszC,OAASlB,EAAKv8C,KAAK8vC,UAAU2N,QACrCtzC,EAAQm/C,aAAe/M,EAAKv8C,KAAK8vC,UAAUwZ,cAC3Cn/C,EAAQgB,UAAYoxC,EAAKv8C,KAAK8vC,UAAU3kC,UAAYnL,KAAK8vC,UAAU3kC,UAAYnL,KAAKmK,QAAQgB,WAC5FhB,EAAQo/C,YAAchN,EAAKv8C,KAAK8vC,UAAUyZ,YAAcvpD,KAAK8vC,UAAUyZ,YAAcvpD,KAAKmK,QAAQo/C,YAClG,KAAK,GAAI9iD,GAAE,EAAGA,EAAE0D,EAAQgB,UAAU9J,OAAQoF,IACzC,IAAK,GAAI6M,GAAE,EAAGA,EAAEtT,KAAKmK,QAAQgB,UAAU9J,OAAQiS,IACxC,GAAInJ,EAAQgB,UAAU1E,GAAG8E,OAASvL,KAAKmK,QAAQgB,UAAUmI,GAAG/H,KAAM,CAC9DpB,EAAQgB,UAAU1E,GAAG+Z,MAAQxgB,KAAKmK,QAAQgB,UAAUmI,GAAGkN,KACvD,QAuBzB,GAjBaxgB,KAAK8vC,UAAU7iB,cACf9iB,EAAQ8iB,aAAesvB,EAAKv8C,KAAK8vC,UAAU7iB,cACT,IAA9B9iB,EAAQ8iB,aAAa5rB,OACrB8I,EAAQ8iB,aAAe9iB,EAAQ8iB,aAAahC,wCACnB,IAA9B9gB,EAAQ8iB,aAAa5rB,OAChB8I,EAAQ8iB,aAAe9iB,EAAQ8iB,aAAahC,gBACnB,KAA9B9gB,EAAQ8iB,aAAa5rB,SACnB8I,EAAQ8iB,aAAe9iB,EAAQ8iB,aAAahC,cAE7C9gB,EAAQ8iB,aAAa,GAAGzM,MAAQxgB,KAAKmK,QAAQ8iB,aAAa,GAAGzM,MAC7DrW,EAAQ8iB,aAAa,GAAGzM,MAAQxgB,KAAKmK,QAAQ8iB,aAAa,GAAGzM,MAC7DrW,EAAQ8iB,aAAa,GAAGzM,MAAQxgB,KAAKmK,QAAQ8iB,aAAa,GAAGzM,OAG7DrW,EAAQ8iB,aAAesvB,EAAKv8C,KAAKmK,QAAQ8iB,mBAG3CxlB,EAAAA,WAAM8kB,UACJ9kB,EAAAA,WAAM6mC,gBAAgBplC,KAAK,WAAOzB,EAAAA,WAAMitD,wBAAwBvqD,IAAW,UAE1E,CACD,GAAI+iB,GAAO,GAAIH,MAAuB,IAAlBtlB,EAAAA,WAAM8kB,UAC1BpiB,GAAQ8iB,aAAa,GAAGzM,MAAQ/Y,EAAAA,WAAM8kB,UACtCpiB,EAAQ8iB,aAAa,GAAGzM,MAAQ0M,EAAKC,cACrChjB,EAAQ8iB,aAAa,GAAGzM,MAAQ0M,EAAKE,WAAa,EAClDjjB,EAAQ8iB,aAAa,GAAGzM,MAAQ0M,EAAKG,UACrCljB,EAAQ8iB,aAAa,GAAGzM,MAAQ0M,EAAKI,WACrCnjB,EAAQ8iB,aAAa,GAAGzM,MAAQ0M,EAAKK,aACrCpjB,EAAQ8iB,aAAa,GAAGzM,MAAQ0M,EAAKM,aACrCrjB,EAAQ8iB,aAAa,IAAIzM,MAAQ0M,EAAKO,SAGtC8mC,GAAUF,GAAcA,EAAWl+B,OACnChsB,EAAQgsB,MAAQomB,EAAK8X,EAAWl+B,OAC5ChsB,EAAQisB,SAAWmmB,EAAK8X,EAAWj+B,YAEvBjsB,EAAQgsB,SACRhsB,EAAQisB,aAErBp2B,KAAKmK,QAAUA,GAGhBwqD,OAAQ,SAAUxqD,EAASyqD,GAC1B,MAAIzqD,KAAYnK,KAAKmK,QACbvI,QAAQE,OAAO,oBAGf8yD,KAIHC,aAAc,SAAU7vD,GACpB,GAAI3B,GAAQ,CASZ,OARkEA,GAApD,IAAV2B,GAA0B,IAAVA,GAA0B,IAAVA,GAA0B,IAAVA,KAA2BA,EAAW,EACjFA,EAAW,MAAiBA,EAAW,EACvCA,EAAW,MAAiBA,EAAW,EACvCA,EAAW,MAAiBA,EAAW,EACvCA,EAAW,MAAiBA,EAAW,EACvCA,EAAW,OAAkBA,EAAW,GAClCkC,KAAKC,KAAKnC,EAAW,GAAMA,EAAW,GACpDhF,KAAK2vC,cAAcj8B,KAAK8H,OAAOs5C,UAAYzxD,GAAS,GAC9CA,GAIjB0xD,kBAAkB,SAAUxlD,GAElB,GADT9H,EAAAA,WAAMyqB,YAAc3iB,EACP,QAAUxM,UAAU+L,QAAU,SAAW/L,UAAUstB,YACnDmD,EAAAA,WAAWuhC,kBAAkB,QAAQxlD,OAErC,IAAGvP,KAAKgoC,SAAS,CACe,IAA5BhoC,KAAKgoC,SAASl4B,WAA4C,IAAzB9P,KAAKgoC,SAASz4B,SAE3CvP,KAAKgoC,SAASl4B,UAAY9P,KAAKgoC,SAASz4B,OAG3D,IAAIiR,GAAyClf,SAAhCtB,KAAKgoC,SAASj4B,eAA+B/P,KAAKgoC,SAASj4B,mBAAyB/P,KAAKgoC,SAASj4B,cAAgBR,EAASvP,KAAKgoC,SAASl4B,UAAYP,CACnJvP,MAAKgoC,SAASz4B,OAAUiR,CACxB,KAAI,GAAI/Z,GAAI,EAAGA,EAAEzG,KAAKorC,cAAc/pC,OAAOoF,IAAK,CAC5C,GAAI8wC,GAAQv3C,KAAKorC,cAAc3kC,EAC5B8wC,GAAMxxC,QAAyC,UAA9BwxC,EAAMxxC,OAAOivD,eAC7Bzd,EAAM3+B,QACN2+B,EAAM/+B,MAAK,OAQrCy8C,kBAAkB,SAAU1lD,GAElB,GADT9H,EAAAA,WAAMwqB,YAAc1iB,EACR,QAAUxM,UAAU+L,QAAU,SAAW/L,UAAUstB,YAClDmD,EAAAA,WAAWyhC,kBAAkB,QAAQ1lD,OACpC,CACD,GAAGvP,KAAKioC,YAAcjoC,KAAKioC,WAAW5mC,OAAS,EAC3C,IAAI,GAAIoF,GAAG,EAAGA,EAAGzG,KAAKioC,WAAW5mC,OAAOoF,IAAI,CACxC,GAAI1B,GAAI/E,KAAKioC,WAAWxhC,EACxB,IAAG1B,EAAE,CACkB,IAAhBA,EAAE+K,WAAgC,IAAb/K,EAAEwK,SAEtBxK,EAAE+K,UAAY/K,EAAEwK,OAEpB,IAAIiR,GAA6Blf,SAApByD,EAAEgL,eAA+BhL,EAAEgL,mBAAwBhL,EAAEgL,cAAgBR,EAASxK,EAAE+K,UAAYP,CACtIxK,GAAEwK,OAASiR,GAIF,IAAI,GAAI/Z,GAAI,EAAGA,EAAEzG,KAAKorC,cAAc/pC,OAAOoF,IAAK,CAC5C,GAAI8wC,GAAQv3C,KAAKorC,cAAc3kC,EAC5B8wC,GAAMxxC,QAAyC,UAA9BwxC,EAAMxxC,OAAOivD,eAC7Bzd,EAAM3+B,QACN2+B,EAAM/+B,MAAK,OAOjC25C,UAAW,SAAU+C,GAAiC,GAArBC,GAAqB/zD,UAAAC,OAAA,GAAAC,SAAAF,UAAA,IAAAA,UAAA,EACxC,SAAU2B,UAAU+L,QAAU,SAAW/L,UAAUstB,YACtDmD,EAAAA,WAAW2+B,WAAWgD,GAEfD,GAAcl1D,KAAKgoC,UAAYktB,IAAel1D,KAAKgoC,SAASt5B,IAC5D1O,KAAKgoC,SAASxvB,OACPxY,KAAKgoC,WACZhoC,KAAKgoC,SAASrrB,UACd3c,KAAKgoC,SAAW,KAChBhoC,KAAKo1D,iBAAiBF,KAI7BC,GAAezwD,EAAA8tB,iBAAiB6iC,gBAAgBr0D,KAAK,QAAS0N,IAAK,MAG9E4mD,UAAW,SAAU5mD,EAAKa,EAAQC,GAA2BpO,UAAAC,OAAA,GAAAC,SAAAF,UAAA,IAAAA,UAAA,EACnDsD,GAAA8tB,iBAAiB6iC,gBAAgBr0D,KAAK,QAAS0N,IAAAA,IACpD,QAAU3L,UAAU+L,QAAU,SAAW/L,UAAUstB,YACtDmD,EAAAA,WAAW8hC,UAAU5mD,EAAKa,EAAQC,EAAK/H,EAAAA,WAAMyqB,cAE5BlyB,KAAKgoC,UAAYt5B,IAAQ1O,KAAKgoC,SAASt5B,MACxC1O,KAAKgoC,SAAWhoC,KAAK2vC,cAAcj8B,KAAKlR,IAAI6W,MAAM3K,EAAKa,EAAQC,GAC/DxP,KAAKgoC,SAASl4B,UAAYP,EAC1BvP,KAAKgoC,SAASj4B,kBAElB/P,KAAKgoC,SAAS1D,OACdtkC,KAAKgoC,SAASz4B,OAASvP,KAAKgoC,SAASl4B,UAAYrI,EAAAA,WAAMyqB,cAIrEqjC,iBAAkB,SAAUhmD,GACd,QAAUxM,UAAU+L,QAAU,SAAW/L,UAAUstB,YACtDmD,EAAAA,WAAW+hC,iBAAiBhmD,EAAO9H,EAAAA,WAAMyqB,aAElClyB,KAAKgoC,UAAuB1mC,SAAXiO,IACpBvP,KAAKgoC,SAASj4B,cAAgBR,EAC3BvP,KAAKgoC,SAASz4B,OAASA,EAAS9H,EAAAA,WAAMyqB,cAKxDkgC,UAAW,SAAUhtD,EAAO8vD,GAAiC,GAArBC,GAAqB/zD,UAAAC,OAAA,GAAAC,SAAAF,UAAA,IAAAA,UAAA,EAC5D,IAAI,OAASgE,GAAS9D,SAAc8D,EAApC,CACS,GAAI,QAAUrC,UAAU+L,QAAU,SAAW/L,UAAUstB,YACtDmD,EAAAA,WAAW4+B,UAAUhtD,OAErB,IAAGA,OAEX,IAAI,GAAIqB,GAAI,EAAEA,EAAIzG,KAAKioC,WAAW5mC,OAAOoF,IAAI,CAC5C,GAAI1B,GAAI/E,KAAKioC,WAAWxhC,EACrB1B,IACmBA,EAAEyT,WAIN08C,IAAcl1D,KAAKioC,WAAW7iC,IAAU8vD,IAAel1D,KAAKioC,WAAW7iC,GAAOsJ,IAC9E1O,KAAKioC,WAAW7iC,GAAOoT,OAChBxY,KAAKioC,WAAW7iC,KACvBpF,KAAKioC,WAAW7iC,GAAOuX,UACvB3c,KAAKioC,WAAW7iC,GAAS,KACzBpF,KAAKo1D,iBAAiBF,KAMjCC,GAAezwD,EAAA8tB,iBAAiB6iC,gBAAgBr0D,KAAK,QAAS0N,IAAK,GAAItJ,MAAAA,MAGlFowD,UAAW,SAAUpwD,EAAOsJ,EAAKa,EAAQC,GAA2BpO,UAAAC,OAAA,GAAAC,SAAAF,UAAA,IAAAA,UAAA,EAC1DsD,GAAA8tB,iBAAiB6iC,gBAAgBr0D,KAAK,QAAS0N,IAAAA,EAAKtJ,MAAAA,IACzD,QAAUrC,UAAU+L,QAAU,SAAW/L,UAAUstB,YACtDmD,EAAAA,WAAWgiC,UAAUpwD,EAAOsJ,EAAKa,EAAQC,EAAK/H,EAAAA,WAAMwqB,cAEnCjyB,KAAKioC,WAAW7iC,IAAUpF,KAAKioC,WAAW7iC,GAAOsJ,MAAQA,IAC1D1O,KAAKioC,WAAW7iC,GAASpF,KAAK2vC,cAAcj8B,KAAKlR,IAAI6W,MAAM3K,EAAKa,EAAQC,GACxExP,KAAKioC,WAAW7iC,GAAO0K,UAAYP,EACnCvP,KAAKioC,WAAW7iC,GAAO2K,iBACvB/P,KAAKioC,WAAW7iC,GAAOmK,QAAU9H,EAAAA,WAAMwqB,aAE3CjyB,KAAKioC,WAAW7iC,GAAOk/B,SAIrCmxB,iBAAkB,SAAUrwD,EAAOmK,GAC9B,QAAUxM,UAAU+L,QAAU,SAAW/L,UAAUstB,YACtDmD,EAAAA,WAAWiiC,iBAAiBrwD,EAAOmK,EAAO9H,EAAAA,WAAMwqB,aAEhCjyB,KAAKioC,WAAW7iC,IAAqB9D,SAAXiO,IAC1BvP,KAAKioC,WAAW7iC,GAAO2K,cAAgBR,EACvCvP,KAAKioC,WAAW7iC,GAAOmK,QAAU9H,EAAAA,WAAMwqB,cAKzDmjC,iBAAkB,SAAUF,GAAY,GAAAQ,GAAA11D,IACvC,IAAIk1D,EAAY,CACf,GAAI77C,GAAQrZ,KAAK2vC,cAAcj8B,KAAKpC,KAAKkI,MAAM+F,SAAS21C,EAIxD,cAHI77C,GAAUA,EAAMs8C,SAAYt8C,EAAMu8C,YACrC51D,KAAK2vC,cAAcj8B,KAAK2F,MAAMyV,OAAOomC,IAKvC,GAAIW,GAAe,EACNC,EAAY91D,KAAK2vC,cAAcj8B,KAAKpC,KAAKkI,MAAMu8C,QAAQ35C,OAAOiD,MAAM22C,MACjF,KAAK,GAAIvvD,KAAKqvD,GAAW,CACxB,GAAIz8C,GAAQrZ,KAAK2vC,cAAcj8B,KAAKpC,KAAKkI,MAAM+F,SAASu2C,EAAUrvD,GAElE,KADI4S,EAAMs8C,SAAWt8C,EAAMu8C,aAAYC,IACnCA,EAAe,EAAG,OAEdC,EAAU7kD,KAAK,SAAAC,GACX,GAAImI,GAAQq8C,EAAK/lB,cAAcj8B,KAAKpC,KAAKkI,MAAM+F,SAASrO,EACxD,QAAKmI,EAAMs8C,UAAYt8C,EAAMu8C,aAC5BF,EAAK/lB,cAAcj8B,KAAK2F,MAAMyV,OAAO5d,IAC9B,MAOtB83C,sBAAuB,SAASljD,GACtB,GAAM+wB,GAAI72B,KAAK8vC,UAAUpqC,KAAKI,KAAKC,OAAOI,OAASnG,KAAK8vC,UAAUpqC,KAAKI,KAAKC,OAAOI,OAASnG,KAAK8vC,UAAUpqC,KAAKI,KAAKC,MACrH,OAAQmnD,YAAWpnD,GAAQ+wB,EAAI72B,KAAK8vC,UAAUpqC,KAAKI,KAAKiW,QAGlEmtC,qBAAsB,SAAUpjD,GACtB,GAAM+wB,GAAI72B,KAAK8vC,UAAUpqC,KAAKI,KAAKC,OAAOC,MAAQhG,KAAK8vC,UAAUpqC,KAAKI,KAAKC,OAAOC,MAAQhG,KAAK8vC,UAAUpqC,KAAKI,KAAKC,MACnH,OAAQmnD,YAAWpnD,GAAQ+wB,EAAI72B,KAAK8vC,UAAUpqC,KAAKI,KAAKiW,QAG5DkgC,UAAW,WACP,MAAqB,SAAlBl5C,UAAUye,KAOvB8rB,WAAW,WACV,MAAsB,SAAlBvqC,UAAUye,KAAoC,WAAlBze,UAAUye,KAAsC,SAAlBze,UAAUye,KAAoC,KAAlBze,UAAUye,KAOrGy0C,SAAS,WACR,MAAwB,KAArBlzD,UAAUmzD,QAOdC,eAAe,WACd,OAAGn2D,KAAKstC,cAMT8oB,eAAe,WACd,QAAGp2D,KAAKi2D,YACc,WAAlBlzD,UAAUye,KACVxhB,KAAKstC,cACJvqC,UAAUuf,SAMhBqnC,WAAAA,WAAA,QAAAA,KAAAv3B,EAAApyB,KAAA2pD,GAAA,MAAA0M,GAAA1M,EAAA,OAAAj7C,IAAA,WAAA8R,MAAA,SAEiBzf,GACf,MAAiD,oBAA1Coc,OAAOb,UAAU7R,SAASmS,MAAM7b,MAHzC2N,IAAA,UAAA8R,MAAA,SAMgBzf,GACd,MAAiD,mBAA1Coc,OAAOb,UAAU7R,SAASmS,MAAM7b,MAPzC2N,IAAA,MAAA8R,MAAA,SAUYzN,GACV,GAAM1L,GAAIs7B,OAAO5vB,EACjB,OAAIoZ,OAAM9kB,IACTgF,QAAQyN,KAAQ/G,EAAhB,oBACO,GAGA1L,KAjBVqH,IAAA,QAAA8R,MAAA,SAqBczN,GAAe,GAAZujD,GAAYl1D,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAJ,GACjBiG,EAAIiH,SAASyE,EAAGujD,EACtB,OAAInqC,OAAM9kB,IACTgF,QAAQyN,KAAQ/G,EAAhB,iBACO,GAGA1L,KA5BVqH,IAAA,SAAA8R,MAAA,SAgCezN,GACb,OAAQA,GAEP,IAAK,GAAG,MAAO,EACf,SAAS,MAAOA,OApCnBrE,IAAA,WAAA8R,MAAA,SAwCiB+1C,EAAMpsD,GAAS,GAAAqsD,GAAAx2D,KAExBy2D,EAAW,QAAXA,GAAYF,EAAMpsD,GACvB,GAAIusD,GAAAA,OACAC,EAAAA,OACAn2C,EAAAA,MACJ,QAAQ+1C,EAAKv1D,MACZ,IAAK,OACJ,MAAOy1D,GAASF,EAAKG,KAAMvsD,EAC5B,KAAK,IAGJ,MAFAusD,GAAOD,EAASF,EAAKG,KAAMvsD,GAC3BwsD,EAAOF,EAASF,EAAKI,KAAMxsD,GACvBqsD,EAAKI,SAASF,IAASF,EAAKI,SAASD,IAChC,IAAMD,EAAOC,GAAMtgD,MAAM,GAE3BmgD,EAAKh0D,IAAIi0D,EAASF,EAAKG,KAAMvsD,GAAUssD,EAASF,EAAKI,KAAMxsD,GACnE,KAAK,IAGJ,MAFAusD,GAAOD,EAASF,EAAKG,KAAMvsD,GAC3BwsD,EAAOF,EAASF,EAAKI,KAAMxsD,GACvBqsD,EAAKI,SAASF,IAASF,EAAKI,SAASD,IAChCD,EAAO,IAAIrkD,MAAMskD,EAAO,IAAIv0C,KAAK,IAEnCo0C,EAAKK,IAAIJ,EAASF,EAAKG,KAAMvsD,GAAUssD,EAASF,EAAKI,KAAMxsD,GACnE,KAAK,IACJ,MAAOqsD,GAAKM,IAAIL,EAASF,EAAKG,KAAMvsD,GAAUssD,EAASF,EAAKI,KAAMxsD,GACnE,KAAK,IACJ,MAAOqsD,GAAKO,IAAIN,EAASF,EAAKG,KAAMvsD,GAAUssD,EAASF,EAAKI,KAAMxsD,GACnE,KAAK,IAGiB,MAFAusD,GAAOpoD,SAASmoD,EAASF,EAAKG,KAAMvsD,IACpCwsD,EAAOroD,SAASmoD,EAASF,EAAKI,KAAMxsD,IACvB,IAATwsD,GACAnqD,EAAAA,WAAOsf,MAAM,aACN,GAGJ0qC,EAAKQ,IAAIN,EAAMC,EAC5C,KAAK,KACJ,MAAOF,GAASF,EAAKG,KAAMvsD,KAAassD,EAASF,EAAKI,KAAMxsD,EAC7D,KAAK,KACJ,MAAOssD,GAASF,EAAKG,KAAMvsD,KAAassD,EAASF,EAAKI,KAAMxsD,EAC7D,KAAK,IACJ,MAAOssD,GAASF,EAAKG,KAAMvsD,GAAWssD,EAASF,EAAKI,KAAMxsD,EAC3D,KAAK,IACJ,MAAOssD,GAASF,EAAKG,KAAMvsD,GAAWssD,EAASF,EAAKI,KAAMxsD,EAC3D,KAAK,KACJ,MAAOssD,GAASF,EAAKG,KAAMvsD,IAAYssD,EAASF,EAAKI,KAAMxsD,EAC5D,KAAK,KACJ,MAAOssD,GAASF,EAAKG,KAAMvsD,IAAYssD,EAASF,EAAKI,KAAMxsD,EAC5D,KAAK,MACJ,MAAOjD,MAAK2mB,IAAIjR,MAAM,KACrB25C,EAAKp/B,KAAKkD,IAAI,SAAAxJ,GAAA,MAAO4lC,GAAS5lC,EAAK1mB,KAErC,KAAK,MACJ,MAAOjD,MAAK2M,IAAI+I,MAAM,KACrB25C,EAAKp/B,KAAKkD,IAAI,SAAAxJ,GAAA,MAAO4lC,GAAS5lC,EAAK1mB,KAErC,KAAK,MACJ,MAAOosD,GAAKp/B,KAAKkD,IAAI,SAAAxJ,GAAA,MAAO4lC,GAAS5lC,EAAK1mB,KAAUoyB,MAAM,SAAA5sB,GAAA,MAAKA,IAChE,KAAK,MACJ,MAAO4mD,GAAKp/B,KAAKkD,IAAI,SAAAxJ,GAAA,MAAO4lC,GAAS5lC,EAAK1mB,KAAU8G,KAAK,SAAAtB,GAAA,MAAKA,IAC/D,KAAK,UACJ,MAAOgzB,QAAO4zB,EAAK/1C,MACF,KAAK,MACD,MAAOlS,UAASkoD,EAAKS,IAAIR,EAASF,EAAKG,KAAMvsD,IACjD,KAAK,SACtB,GAAMkxB,GAAQm7B,EAAKU,MAAMX,EAAKY,MAAM,IAC9BC,EAAMZ,EAAKU,MAAMX,EAAKY,MAAM,GAClC,UAAUjwD,KAAK+I,UAAYmnD,EAAM/7B,EAAQ,GAAKA,EAC/C,KAAK,QACL,IAAK,aACa,IAAK,WAGtB,MAFqB7a,MAAQyK,OAAAC,EAAI/gB,EAAQszC,QAAZvyB,EAAuB/gB,EAAQk/C,aAA/Bn+B,EAA+C/gB,EAAQgB,YAClFi5B,KAAK,SAAAz0B,GAAA,MAAKA,GAAEpE,OAASgrD,EAAKG,OACLp1D,SAAhBkf,EAAMA,MAAsBg2C,EAAKS,IAAIz2C,EAAMA,OAASg2C,EAAKa,cAAc72C,EAC7D,KAAK,cAED,MADAA,GAAQrW,EAAQ8iB,aAAamX,KAAK,SAAAz0B,GAAA,MAAKA,GAAEpE,OAASgrD,EAAKG,OACnCp1D,SAAhBkf,EAAMA,OACLA,EAAMjV,OAASpB,EAAQ8iB,aAAa,GAAG1hB,MAAQiV,EAAMjV,OAASpB,EAAQ8iB,aAAa,GAAG1hB,MAC3GiV,EAAMjV,OAASpB,EAAQ8iB,aAAa,GAAG1hB,MACf9D,EAAAA,WAAMitD,wBAAwBvqD,GAGtDqW,EAAMjV,OAASpB,EAAQ8iB,aAAa,IAAI1hB,KACfirD,EAAKc,OAAO92C,EAAMA,OAEZg2C,EAAKS,IAAIz2C,EAAMA,QAGtBg2C,EAAKa,cAAc72C,EAE/B,KAAK,aAED,MADHA,GAAQrW,EAAQo/C,YAAYnlB,KAAK,SAAAz0B,GAAA,MAAKA,GAAEpE,OAASgrD,EAAKG,OAC5Bp1D,SAAhBkf,EAAMA,MAAsBg2C,EAAKS,IAAIz2C,EAAMA,OAASg2C,EAAKa,cAAc72C,EAClF,KAAK,SACtB,MAAQ+1C,GAAK/1C,MAAQ,EACtB,KAAK,cAEJ,MADAA,GAAQrW,EAAQm/C,aAAallB,KAAK,SAAAz0B,GAAA,MAAKA,GAAEpE,OAASgrD,EAAKG,OAChCp1D,SAAhBkf,EAAMA,MAAuBA,EAAMA,MAAQ,GAAMg2C,EAAKa,cAAc72C,EAC5E,KAAK,YAEJ,GADAA,EAAQrW,EAAQo/C,YAAYnlB,KAAK,SAAAz0B,GAAA,MAAKA,GAAEpE,MAAQgrD,EAAKG,OAC1C,CACV,GAAMjwD,IAAqBnF,SAAhBkf,EAAMA,MAAsBg2C,EAAKa,cAAc72C,GAASg2C,EAAKS,IAAIz2C,EAAMA,QAAU,CAC5F,IAAwB,UAApBA,EAAM1W,KAAK9I,KACd,MAAIyF,GAAE,GAAKA,GAAG0D,EAAQszC,OAAOp8C,QAC5BmL,EAAAA,WAAO4rC,KAAK,sBACL,UAE2B92C,SAA5B6I,EAAQszC,OAAOh3C,GAAG+Z,MAAsBg2C,EAAKS,IAAI9sD,EAAQszC,OAAOh3C,GAAG+Z,OAASg2C,EAAKa,cAAcltD,EAAQszC,OAAOh3C,GAEzF,IAAwB,eAApB+Z,EAAM1W,KAAK9I,KAChB,MAAIyF,GAAE,GAAKA,GAAG0D,EAAQk/C,YAAYhoD,QAC9BmL,EAAAA,WAAO4rC,KAAK,sBACL,UAEE92C,SAAjC6I,EAAQk/C,YAAY5iD,GAAG+Z,MAAsBg2C,EAAKS,IAAI9sD,EAAQk/C,YAAY5iD,GAAG+Z,OAASg2C,EAAKa,cAAcltD,EAAQk/C,YAAY5iD,GAEhI,IAAwB,aAApB+Z,EAAM1W,KAAK9I,KACQ,MAAIyF,GAAE,GAAKA,GAAG0D,EAAQgB,UAAU9J,QAC5BmL,EAAAA,WAAO4rC,KAAK,sBACL,UAE2B92C,SAA/B6I,EAAQgB,UAAU1E,GAAG+Z,MAAsBg2C,EAAKS,IAAI9sD,EAAQgB,UAAU1E,GAAG+Z,OAASg2C,EAAKa,cAAcltD,EAAQgB,UAAU1E,GAErJ,IAAwB,gBAApB+Z,EAAM1W,KAAK9I,KACQ,MAAIyF,GAAE,GAAKA,GAAG0D,EAAQm/C,aAAajoD,QAC/BmL,EAAAA,WAAO4rC,KAAK,sBACL,UAE8B92C,SAAlC6I,EAAQm/C,aAAa7iD,GAAG+Z,MAAuBrW,EAAQm/C,aAAa7iD,GAAG+Z,MAAQ,GAAMg2C,EAAKa,cAAcltD,EAAQm/C,aAAa7iD,IAGlK,IAAK,UAGJ,MAFAiwD,GAAOD,EAASF,EAAKG,KAAMvsD,GAC3BwsD,EAAOF,EAASF,EAAKI,KAAMxsD,IACnBusD,EAAO,IAAIt8C,QAAQu8C,EAAO,MACnC,KAAK,eAEJ,MADAD,GAAOD,EAASF,EAAKG,KAAMvsD,GACpBusD,EAAOA,EAAKr1D,OAAS,CAC7B,SACC,KAAM,IAAIyqB,OAAM,yBAKnB,KACC,MAAO2qC,GAASF,EAAMpsD,GAEvB,MAAO+D,GAEN,MADA7B,SAAQyf,MAAM5d,GACPqpD,QA7LV7oD,IAAA,gBAAA8R,MAAA,SAiMsBA,GACpB,QAASg3C,GAAUh3C,GAClB,GAAwB,UAApBA,EAAM1W,KAAK9I,MAAwC,WAApBwf,EAAM1W,KAAK9I,KAE7C,MADAwf,GAAMA,MAASA,EAAM1W,KAAK0W,MACnBA,EAAMA,KAET,IAAwB,WAApBA,EAAM1W,KAAK9I,KAAmB,CACtC,GAAMq6B,GAAQsH,OAAOniB,EAAM1W,KAAKqtD,MAAM,IAChCC,EAAMz0B,OAAOniB,EAAM1W,KAAKqtD,MAAM,GAEpC,OADA32C,GAAMA,SAAWtZ,KAAK+I,UAAYmnD,EAAM/7B,EAAQ,GAAKA,GAC9C7a,EAAMA,MAET,MAAwB,WAApBA,EAAM1W,KAAK9I,MACnBwf,EAAMA,MAASA,EAAM1W,KAAK0W,MAAQ,GAC3BA,EAAMA,OAELA,EAAM1W,KAAK2tD,UACnBj3C,EAAMA,MAAQA,EAAM1W,KAAK0W,MAClBA,EAAMA,QAGbnU,QAAQyf,MAAM,qBACP,GAIT,IACC,MAAO0rC,GAAUh3C,GAElB,MAAOtS,GAEN,MADA7B,SAAQyf,MAAM5d,GACP,MAhOVQ,IAAA,MAAA8R,MAAA,SAoOY+1C,EAAMpsD,GAAS,GAAAutD,GAAA13D,KAClBgB,EAA0Cu1D,EAA1Cv1D,KAAM01D,EAAoCH,EAApCG,KAAMC,EAA8BJ,EAA9BI,KAAMx/B,EAAwBo/B,EAAxBp/B,KAAYwgC,EAAYpB,EAAlB/1C,MACzBo3C,GAAW52D,KAAAA,GACbwf,EAAAA,MACJ,QAAQxf,GACP,IAAK,OACL,IAAK,eACJ,GAAM62D,GAAU73D,KAAK83D,IAAIpB,EAAMvsD,EAC/B,OAAK0tD,IAGLD,EAAQlB,KAAOmB,EACRD,GAHC,IAIT,KAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,KACL,IAAK,KACL,IAAK,IACL,IAAK,IACL,IAAK,KACL,IAAK,KACL,IAAK,UAGJ,MAFAA,GAAQlB,KAAO12D,KAAK83D,IAAIpB,EAAMvsD,GAC9BytD,EAAQjB,KAAO32D,KAAK83D,IAAInB,EAAMxsD,GACzBytD,EAAQlB,MAASkB,EAAQjB,KAGvBiB,EAFC,IAGT,KAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,MACJ,GAAMG,GAAU5gC,EAAKkD,IAAI,SAAAxJ,GAAA,MAAO6mC,GAAKI,IAAIjnC,EAAK1mB,IAE9C,OADAytD,GAAQzgC,KAAO4gC,EAAQ38B,OAAO,SAAAvK,GAAA,MAAe,QAARA,IAC9B+mC,CACR,KAAK,UAEJ,MADAA,GAAQp3C,MAAQmiB,OAAOg1B,GAChBC,CACR,KAAK,SAGJ,MAFAA,GAAQT,OAASZ,EAAKY,QAAU,EAAG,MAAM98B,IAAI,SAAA7Z,GAAA,MAASk3C,GAAKR,MAAM12C,KACjEo3C,EAAQT,MAAMa,OACPJ,CACR,KAAK,QACL,IAAK,aACU,IAAK,WACL,IAAK,eACpB,IAAK,aAGJ,MAFAp3C,MAAQyK,OAAAC,EAAI/gB,EAAQszC,QAAZvyB,EAAuB/gB,EAAQk/C,aAA/Bn+B,EAA+C/gB,EAAQgB,WAAvD+f,EAAqE/gB,EAAQ8iB,cAA7E/B,EAA8F/gB,EAAQo/C,cAC5GnlB,KAAK,SAAAz0B,GAAA,MAAKA,GAAEpE,OAASgrD,EAAKG,OACdp1D,SAAVkf,EACI,MAERo3C,EAAQlB,KAAOA,EACRkB,EACR,KAAK,SAEJ,MADAA,GAAQp3C,MAASm3C,EAAW,IAAM,GAC3BC,CACR,KAAK,cAEJ,MADAp3C,GAAQrW,EAAQm/C,aAAallB,KAAK,SAAAz0B,GAAA,MAAKA,GAAEpE,OAASgrD,EAAKG,OACzCp1D,SAAVkf,EACI,MAERo3C,EAAQlB,KAAOA,EACRkB,EACR,SACC,MAAO,UAxSXlpD,IAAA,aAAA8R,MAAA,SA4SmBy3C,EAAQ9tD,EAAS+tD,GAIlC,IAHA,GAAMC,GAAmB,gDACrB33C,EAAQ23C,EAAiBC,KAAKH,GAASI,EAAAA,OACvC1Z,EAAMsZ,EACHz3C,GAAO,CACb,GAAMxf,GAAOwf,EAAM,GACbpb,EAAQkJ,SAASkS,EAAM,IACzBoW,EAAO,QACX,IAAa,MAAT51B,GAAgBmJ,EAAQk/C,YAAYjkD,GACvCizD,EAAU,MAAajzD,EAAQ,GAAK,IAAM+E,EAAQk/C,YAAYjkD,GAAOxF,KAAO,IAC5Eg3B,EAA4Ct1B,SAArC6I,EAAQk/C,YAAYjkD,GAAOob,MAC/BxgB,KAAKq3D,cAAcltD,EAAQk/C,YAAYjkD,IACvC+E,EAAQk/C,YAAYjkD,GAAOob,MAE7BoW,EADGshC,EACIG,EAGqBr4D,KAAKs4D,QAAQ1hC,EAAK,OAG3C,IAAa,MAAT51B,GAAgBmJ,EAAQszC,OAAOr4C,GACvCizD,EAAU,MAAajzD,EAAQ,GAAK,IAAM+E,EAAQszC,OAAOr4C,GAAOxF,KAAO,IACvEg3B,EAAuCt1B,SAAhC6I,EAAQszC,OAAOr4C,GAAOob,MAC1BxgB,KAAKq3D,cAAcltD,EAAQszC,OAAOr4C,IAClC+E,EAAQszC,OAAOr4C,GAAOob,MAExBoW,EADGshC,EACIG,EAGqBr4D,KAAKs4D,QAAQ1hC,EAAK,OAG3C,IAAa,OAAT51B,GAAiBmJ,EAAQm/C,aAAalkD,GAC9CizD,EAAU,MAAajzD,EAAQ,GAAK,IAAM+E,EAAQm/C,aAAalkD,GAAOxF,KAAO,IAC7Eg3B,EAA6Ct1B,SAAtC6I,EAAQm/C,aAAalkD,GAAOob,MAChCxgB,KAAKq3D,cAAcltD,EAAQm/C,aAAalkD,IACxC+E,EAAQm/C,aAAalkD,GAAOob,MAC3B03C,IACHthC,EAAOyhC,OAGW,IAAa,MAATr3D,GAAgBmJ,EAAQgB,UAAU/F,GACvCizD,EAAU,MAAajzD,EAAQ,GAAK,IAAM+E,EAAQgB,UAAU/F,GAAOxF,KAAO,IAC1Eg3B,EAA0Ct1B,SAAnC6I,EAAQgB,UAAU/F,GAAOob,MAC1BxgB,KAAKq3D,cAAcltD,EAAQgB,UAAU/F,IACrC+E,EAAQgB,UAAU/F,GAAOob,MAE3BoW,EADAshC,EACOG,EAGAr4D,KAAKs4D,QAAQ1hC,EAAK,OAG5B,IAAa,MAAT51B,GAAgBmJ,EAAQ8iB,aAAa7nB,QACjDqC,EAAAA,WAAM8kB,UAChB9kB,EAAAA,WAAM6mC,gBAAgBplC,KAAK,WAC1BzB,EAAAA,WAAMitD,wBAAwBvqD,IAC5B,WACsBqC,EAAAA,WAAO4rC,KAAK,qBAIrC3wC,EAAAA,WAAMitD,wBAAwBvqD,GAGbkuD,EAAU,MAAajzD,EAAQ,GAAK,IAAM+E,EAAQ8iB,aAAa7nB,GAAOxF,KAAO,IAC7Eg3B,EAA6Ct1B,SAAtC6I,EAAQ8iB,aAAa7nB,GAAOob,MAC7BxgB,KAAKq3D,cAAcltD,EAAQ8iB,aAAa7nB,IAC9B,KAAVA,EAAepF,KAAKs3D,OAAOntD,EAAQ8iB,aAAa,IAAIzM,OAASrW,EAAQ8iB,aAAa7nB,GAAOob,MAE3FoW,EADAshC,EACOG,EAGAr4D,KAAKs4D,QAAQ1hC,EAAK,OAG5B,IAAa,MAAT51B,GAAgBmJ,EAAQo/C,YAAYnkD,GACzCizD,EAAU,MAAajzD,EAAQ,GAAK,IAAM+E,EAAQo/C,YAAYnkD,GAAOxF,KAAO,IAC5Eg3B,EAA4Ct1B,SAArC6I,EAAQo/C,YAAYnkD,GAAOob,MAAsBxgB,KAAKq3D,cAAcltD,EAAQo/C,YAAYnkD,IAAU+E,EAAQo/C,YAAYnkD,GAAOob,MAEhIoW,EADAshC,EACOG,EAGHr4D,KAAKs4D,QAAQ1hC,EAAM,OAGzC,IAAa,OAAT51B,EACR,GAAIoE,GAAS+E,EAAQo/C,YAAYloD,OAChCu1B,EAAO,aAEH,CACiByhC,EAAU,OAAcjzD,EAAQ,GAAK,IAAM+E,EAAQo/C,YAAYnkD,GAAOxF,KAAO,GAC7E,IAAM6G,IAA0CnF,SAArC6I,EAAQo/C,YAAYnkD,GAAOob,MAAsBxgB,KAAKq3D,cAAcltD,EAAQo/C,YAAYnkD,IAAU+E,EAAQo/C,YAAYnkD,GAAOob,OAAS,CACjJ,IAAI03C,EACAthC,EAAOyhC,MAEN,CACD,GAAMxT,GAAK7kD,KAAKs4D,QAAQ7xD,EAAG,EACkB,WAAzC0D,EAAQo/C,YAAYnkD,GAAO0E,KAAK9I,KAC5ByF,EAAE,GAAKA,GAAG0D,EAAQszC,OAAOp8C,OACzBu1B,EAAO,UAGPA,EAAoCt1B,SAA7B6I,EAAQszC,OAAOoH,GAAIrkC,MAAsBxgB,KAAKq3D,cAAcltD,EAAQszC,OAAOoH,IAAO16C,EAAQszC,OAAOoH,GAAIrkC,MAC5GoW,EAAO52B,KAAKs4D,QAAQ1hC,EAAM,IAGgB,eAAzCzsB,EAAQo/C,YAAYnkD,GAAO0E,KAAK9I,KACjCyF,EAAE,GAAKA,GAAG0D,EAAQk/C,YAAYhoD,OAC9Bu1B,EAAO,UAGPA,EAAyCt1B,SAAlC6I,EAAQk/C,YAAYxE,GAAIrkC,MAAsBxgB,KAAKq3D,cAAcltD,EAAQk/C,YAAYxE,IAAO16C,EAAQk/C,YAAYxE,GAAIrkC,MAC3HoW,EAAO52B,KAAKs4D,QAAQ1hC,EAAM,IAGgB,aAAzCzsB,EAAQo/C,YAAYnkD,GAAO0E,KAAK9I,KACjCyF,EAAE,GAAKA,GAAG0D,EAAQgB,UAAU9J,OAC5Bu1B,EAAO,UAGPA,EAAuCt1B,SAAhC6I,EAAQgB,UAAU05C,GAAIrkC,MAAsBxgB,KAAKq3D,cAAcltD,EAAQgB,UAAU05C,IAAO16C,EAAQgB,UAAU05C,GAAIrkC,MACrHoW,EAAO52B,KAAKs4D,QAAQ1hC,EAAM,IAGgB,gBAAzCzsB,EAAQo/C,YAAYnkD,GAAO0E,KAAK9I,OAEjC41B,EADAnwB,EAAE,GAAKA,GAAG0D,EAAQm/C,aAAajoD,OACxB,SAGmCC,SAAnC6I,EAAQm/C,aAAazE,GAAIrkC,MAAsBxgB,KAAKq3D,cAAcltD,EAAQm/C,aAAazE,IAAO16C,EAAQm/C,aAAazE,GAAIrkC,QAMjKm+B,EAAMn+B,EAAM,GAAKoW,EAAOpW,EAAM,GAC9BA,EAAQ23C,EAAiBC,KAAKzZ,GAE/B,MAAOA,MAvbTjwC,IAAA,gBAAA8R,MAAA,SA0bsBzf,EAAMspD,GAG1B,IAFA,GAAMkO,GAAmB,8BACrB/3C,EAAQ+3C,EAAiBH,KAAKr3D,GAC3Byf,GAELzf,EADGspD,EACI7pC,EAAM,IAAN,OAAkBA,EAAM,GAAxB,OAAkCA,EAAM,GAExCA,EAAM,GAAKA,EAAM,GAEzBA,EAAQ+3C,EAAiBH,KAAKr3D,EAE/B,OAAOA,MArcT2N,IAAA,sBAAA8R,MAAA,SAwc4Bg4C,EAAOruD,GACjC,GAAIqW,KACJ,KAAKg4C,EACJ,QAHyC,IAAAC,GAKnBD,EAAMpsC,KAArBprB,EALkCy3D,EAKlCz3D,KAAM01D,EAL4B+B,EAK5B/B,IAEd,IAAa,UAAT11D,EACHwf,EAAQrW,EAAQszC,OAAOrZ,KAAK,SAAAz0B,GAAA,MAAKA,GAAEpE,OAASmrD,QACtC,IAAa,eAAT11D,EACVwf,EAAQrW,EAAQk/C,YAAYjlB,KAAK,SAAAz0B,GAAA,MAAKA,GAAEpE,OAASmrD,QAC3C,CAAA,GAAa,YAAT11D,EAGV,QAFAwf,GAAMA,MAAQg4C,EAAMpsC,KAAK5L,MAI1B,GAAMk4C,GAAYl4C,GAAyBlf,SAAhBkf,EAAMA,MAC9BxgB,KAAKq3D,cAAc72C,GACnBA,EAAMA,KACT,OAAOtZ,MAAK2M,IAAI6kD,EAAW,MA3d7BhqD,IAAA,MAAA8R,MAAA,SA8dqBm4C,EAAMC,GACb,GAAIC,GAAO,EAAGC,EAAO,EAAGrlD,EAAI,CAC5B,KACIolD,EAAOF,EAAKluD,WAAW4H,MAAM,KAAK,GAAGhR,OACvC,MAAO6M,IAET,IACI4qD,EAAOF,EAAKnuD,WAAW4H,MAAM,KAAK,GAAGhR,OACvC,MAAO6M,IAKT,MAHAuF,GAAIvM,KAAK2M,IAAIglD,EAAMC,GACnBH,EAAOrqD,SAASqqD,EAAKluD,WAAWgM,QAAQ,IAAK,KAAOvP,KAAK6xD,IAAI,GAAItlD,EAAIolD,GACrED,EAAOtqD,SAASsqD,EAAKnuD,WAAWgM,QAAQ,IAAK,KAAOvP,KAAK6xD,IAAI,GAAItlD,EAAIqlD,IAC7DH,EAAOC,GAAQ1xD,KAAK6xD,IAAI,GAAItlD,MA3elD/E,IAAA,MAAA8R,MAAA,SA8eqBm4C,EAAMC,GACb,GAAIC,GAAO,EAAGC,EAAO,EAAGrlD,EAAI,CAC5B,KACIolD,EAAOF,EAAKluD,WAAW4H,MAAM,KAAK,GAAGhR,OACvC,MAAO6M,IAET,IACI4qD,EAAOF,EAAKnuD,WAAW4H,MAAM,KAAK,GAAGhR,OACvC,MAAO6M,IAKT,MAHAuF,GAAIvM,KAAK2M,IAAIglD,EAAMC,GACnBH,EAAOrqD,SAASqqD,EAAKluD,WAAWgM,QAAQ,IAAK,KAAOvP,KAAK6xD,IAAI,GAAItlD,EAAIolD,GACrED,EAAOtqD,SAASsqD,EAAKnuD,WAAWgM,QAAQ,IAAK,KAAOvP,KAAK6xD,IAAI,GAAItlD,EAAIqlD,IAC7DH,EAAOC,GAAQ1xD,KAAK6xD,IAAI,GAAItlD,MA3flD/E,IAAA,MAAA8R,MAAA,SA8fqBm4C,EAAMC,GACb,IAAKA,EAED,MADHpsD,GAAAA,WAAOsf,MAAM,WACH,CAEX,IAAI+sC,GAAO,EAAGC,EAAO,EAAGliC,EAAAA,MACxB,KACIiiC,EAAOF,EAAKluD,WAAW4H,MAAM,KAAK,GAAGhR,OACvC,MAAO6M,IAET,IACI4qD,EAAOF,EAAKnuD,WAAW4H,MAAM,KAAK,GAAGhR,OACvC,MAAO6M,IAGT,MADA0oB,GAAOtoB,SAASqqD,EAAKluD,WAAWgM,QAAQ,IAAK,KAAOnI,SAASsqD,EAAKnuD,WAAWgM,QAAQ,IAAK,KACtFqiD,EAAOD,EAAO,GAAKjiC,IAAStoB,SAASsoB,GAC9B52B,KAAK82D,IAAIlgC,EAAM1vB,KAAK6xD,IAAI,GAAID,EAAOD,IAEvCjiC,EAAO1vB,KAAK6xD,IAAI,GAAID,EAAOD,MAhhBhDnqD,IAAA,MAAA8R,MAAA,SAmhBqBm4C,EAAMC,GACb,GAAInlD,GAAI,EAAGulD,EAAOL,EAAKluD,WAAYwuD,EAAOL,EAAKnuD,UAC/C,KACIgJ,GAAKulD,EAAKE,SAAS,OAAS5qD,SAAS0qD,EAAK3mD,MAAM,OAAO,IAAM2mD,EAAK3mD,MAAM,KAAK,GAAGhR,OAClF,MAAO6M,IAET,IACIuF,GAAKwlD,EAAKC,SAAS,OAAS5qD,SAAS2qD,EAAK5mD,MAAM,OAAO,IAAM4mD,EAAK5mD,MAAM,KAAK,GAAGhR,OAClF,MAAO6M,IAET,MAAOI,UAAS0qD,EAAKviD,QAAQ,IAAK,KAAOnI,SAAS2qD,EAAKxiD,QAAQ,IAAK,KAAOvP,KAAK6xD,IAAI,GAAItlD,MA7hBtG/E,IAAA,MAAA8R,MAAA,SAgiBqBm4C,EAAMC,GACb,GAAIC,GAAO,EAAGC,EAAO,EAAGrlD,EAAI,CAC5B,KACIolD,EAAOF,EAAKluD,WAAW4H,MAAM,KAAK,GAAGhR,OACvC,MAAO6M,IAET,IACI4qD,EAAOF,EAAKnuD,WAAW4H,MAAM,KAAK,GAAGhR,OACvC,MAAO6M,IAGT,MADAuF,GAAIvM,KAAK6xD,IAAI,GAAI7xD,KAAK2M,IAAIglD,EAAMC,IACvBH,EAAOllD,GAAMmlD,EAAOnlD,GAAMA,KA3iBjD/E,IAAA,UAAA8R,MAAA,WA8iB+C,GAAtBA,GAAsBpf,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAd,EAAG+3D,EAAW/3D,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAH,EAC1B4F,EAAM,CACV,KACIA,EAAMwZ,EAAM/V,WAAW4H,MAAM,KAAK,GAAGhR,OACvC,MAAO6M,IAET,GAAIywC,GAAMn+B,EAAM/V,UAMhB,OALIzD,GAAMmyD,GAASA,GAAS,IACxBxa,EAAMA,EAAInoC,UAAU,EAAGmoC,EAAIvkC,QAAQ,KAAO++C,EAAQ,GAClDnyD,EAAMmyD,GAEV34C,EAAQlS,SAASqwC,EAAIloC,QAAQ,IAAK,KAC3B+J,EAAQtZ,KAAK6xD,IAAI,GAAI/xD,OA1jB1C2iD,OAukBA/oD,KAAM,aACJw4D,WAAW,KACXzoB,KAAM,KACN2H,WAAY,KACZ+gB,cAAe,KACf5G,YAAa,KACb3jB,UAAW,KACX8D,cAAe,KACf4H,cAAe,KACf9L,YAAa,KACb+b,cAAe,KACfhH,aAAc,KACdxM,mBAAoB,KACpBsa,YAAa,KACbW,eAAgB,KAChBhN,YAAa,KACb/a,UAAW,KACXC,UAAW,KACX+c,SAAU,KACV4D,WAAY,KACZH,kBAAmB,KACnBxiB,eAAgB,KAChBsc,YAAa,KAEb1c,SAAU,KACVC,WAAY,KACZqxB,UAAW,KACXC,kBAAmB,EAEnBjU,aAAc,KACd9Y,aAAc,KACdgZ,iBAAkB,EAClBE,cAAe,EACf8T,UAAW,KACXxf,aAAc,KACdqY,aAAc,KAEd1iB,cAAe,KAGfG,aACA2pB,YACAjxB,aACAuB,gBACA8B,sBAAuB,KACvBC,gBAAiB,KAEjB3hC,WACAsxC,SAAU,KACV2G,eAAgB,KAChBzG,eAAgB,KAChBlQ,eAAgB,GAChBC,gBAAiB,GACjBC,kBAAkB,EAClBC,YAAa,GACbyB,WAAW,EACX/C,aAAa,EACbC,WAAW,EACXC,WAAW,EAEXyE,WAAY,KACZ4L,YAAa,KACbpE,aAAc,EACd7a,YAAa,KACbgqB,WAAY,GACZ5a,cAAc,EACdF,cAAe,KACfC,SAAU,KACVmc,qBACAnU,aAAa,EAEb2mB,UAAW,KACXzsB,MAAM,KACA0sB,eAAgB,KAChBtvB,aAAc,KACpBlC,WAAW,EACXD,cAAc,EACduE,aAAa,EACbxC,aAAY,EACZD,eAAe,EACfS,iBACAC,mBACAU,iBACAC,aAAc,KACdC,iBACAC,eACAC,aAEAouB,mBAAoB,KACpBC,kBAAmB,KACnBtJ,WAAY,KACZC,YAAa,EACbsJ,eAAgB,GAEhB7uB,eAAe,EACfC,cAAe,EACfC,cAAe,EACTY,UAAU,EAChBC,eAAe,EACfC,wBAAyB,EACzBC,sBACAC,aAAc,EACdC,cAAe,EACfC,eAAe,EACfC,aAAc,KACdI,aAAc,KACdC,oBACAC,wBACAC,uBACAC,WAAW,KACXC,kBAAiB,EACjBC,cAAa,EACbE,wBAAuB,EACvBC,eAAe,KACfC,gBAAgB,kSClpLpB,GAAA5tC,GAAAC,EAAA,kBACAgJ,EAAAhJ,EAAA,kCAAYiJ,OACZqxD,EAAAt6D,EAAA,mCACAiF,EAAAjF,EAAA,gCACAkiB,EAAAliB,EAAA,kCACAqiB,EAAAriB,EAAA,qCACA6nC,EAAA7nC,EAAA,oCACA8nC,EAAA9nC,EAAA,2BAEAC,GAAAA,WAAQC,QAIAC,KAAM,qCAGNo6D,YAAa,WAAY,GAAAp0D,GAAA5F,KACfi6D,EAAa,WACf,GAAIC,GAAAA,EACEC,EAAKp3D,UAAUC,SAAW,IAAM,IAChCo3D,EAAKr3D,UAAUC,SAAW,IAAM,IAClCq3D,GACAvwD,KAAM,QAAAA,MAEDowD,EAAMxmD,KAAK8H,OAAOs5C,UAAYoF,EAAMxmD,KAAKW,MAAMimD,UAAYl+C,OAAOm+C,aAAaC,WAC7Ez3D,UAAUye,KAAyB,OAAjBze,UAAUye,KAAiC,SAAlBze,UAAUye,MACpD04C,EAAMxmD,KAAKW,MAAMimD,UAAYl+C,OAAOm+C,aAAaC,UAErDN,EAAMxmD,KAAKW,MAAMomD,oBAAsBr+C,OAAOm+C,aAAaC,SAC3DN,EAAMxmD,KAAKW,MAAMqmD,qBAAsB,EACvCR,EAAMxmD,KAAKW,MAAMsmD,uBAAwB,EACzCT,EAAMxmD,KAAKknD,MAAMC,yBAA0B,CAC3C,IAAMC,GAAW,WACb,MAAQxmD,WAAU+G,UAAUjB,QAAQ,cAAmB5e,OAAOu/D,aAAsC,IAAvBv/D,OAAOu/D,YAExFb,GAAMxmD,KAAKW,MAAM2mD,kBAAkB,SAACC,EAAcC,GAC9C,GAAMxnD,GAAO1R,SAASm5D,eAAe,QACjCt/C,EAAIi/C,IAAc9mC,EAAOhuB,MAASxK,OAAO0rC,YAAcllC,SAASmlC,gBAAgBzkC,aAAeV,SAASC,KAAKS,YAC7GkQ,EAAIkoD,IAAc9mC,EAAO7tB,OAAU3K,OAAO4rC,aAAeplC,SAASmlC,gBAAgBxkC,cAAgBX,SAASC,KAAKU,YACjHm4D,MACIj/C,EAAIjJ,IACHiJ,EAAImY,EAAO7tB,OACXyM,EAAIohB,EAAOhuB,OAGnB0N,EAAK9Q,MAAMoD,MAAQ6V,EAAI,KACvBnI,EAAK9Q,MAAMuD,OAASyM,EAAI,KACpBiJ,EAAIjJ,EACD7P,UAAUC,SACsB,KAA3Bk3D,EAAMxmD,KAAKshC,MAAMqC,QACjB6iB,EAAMxmD,KAAKW,MAAM+mD,YAAY,IAAK,KAClClB,EAAMxmD,KAAKshC,MAAMqC,MAAQ,GACzB6iB,EAAMxmD,KAAKshC,MAAMqmB,eAAgB,EAAG,IAAK,KACzCnB,EAAMxmD,KAAKW,MAAMinD,WAGU,IAA3BpB,EAAMxmD,KAAKshC,MAAMqC,QACjB6iB,EAAMxmD,KAAKW,MAAM+mD,YAAY,IAAK,KAClClB,EAAMxmD,KAAKshC,MAAMqC,MAAQ,EACzB6iB,EAAMxmD,KAAKshC,MAAMqmB,UAAU,EAAG,EAAG,IAAK,KACtCnB,EAAMxmD,KAAKW,MAAMinD,WAItBv4D,UAAUC,SACsB,IAA3Bk3D,EAAMxmD,KAAKshC,MAAMqC,QACjB6iB,EAAMxmD,KAAKW,MAAM+mD,YAAY,IAAK,KAClClB,EAAMxmD,KAAKshC,MAAMqC,MAAQ,EACzB6iB,EAAMxmD,KAAKshC,MAAMqmB,UAAU,EAAG,EAAG,IAAK,KACtCnB,EAAMxmD,KAAKW,MAAMinD,WAGU,KAA3BpB,EAAMxmD,KAAKshC,MAAMqC,QACjB6iB,EAAMxmD,KAAKW,MAAM+mD,YAAY,IAAK,KAClClB,EAAMxmD,KAAKshC,MAAMqC,MAAQ,GACzB6iB,EAAMxmD,KAAKshC,MAAMqmB,eAAgB,EAAG,IAAK,KACzCnB,EAAMxmD,KAAKW,MAAMinD,aAMjCpB,EAAMxmD,KAAKpC,KAAKiqD,aAAeC,EAAAA,WAASD,aACxCrB,EAAMxmD,KAAKpC,KAAKC,kBAAoB,GAAI6K,QAAOI,OAC/C09C,EAAMxmD,KAAKpC,KAAKG,uBAAyB,GAAI2K,QAAOI,OACpDgX,EAAAA,WAAWliB,KAAO4oD,EAAMxmD,KAAKpC,KAC7B4oD,EAAMxmD,KAAK+nD,SAASC,cAAcC,aAAc,EAChDzB,EAAMxmD,KAAK2F,MAAMyV,OAAS0sC,EAAAA,WAASI,YACnC1B,EAAMxmD,KAAK2F,MAAMQ,mBAAqB,GAAIuC,QAAOI,MAIjD,IAAM1S,GAAO,WACTowD,EAAMxmD,KAAK2F,MAAMsB,aAAc,EAC/BjW,EAAAkW,aAAajG,MACb,IAAMyI,GAAO88C,EAAMxmD,KAAK8F,MAAMu8C,QAAQ35C,OAAOiD,MAAM22C,MACnD54C,GAAKC,QAAQ,SAAA3O,GACT,GAAI2K,GAAQ6gD,EAAMxmD,KAAK8F,MAAM+F,SAAS7Q,EAClC2K,KAAU3U,EAAAkW,aAAaG,MAAM1B,EAAMtY,OACnCm5D,EAAMxmD,KAAK8F,MAAM8F,YAAY5Q,KAKrCwrD,GAAMxmD,KAAK8H,OAAOkF,IACdw5C,EAAMxmD,KAAK8H,OAAOqgD,WAAa,EAC/B3B,EAAMxmD,KAAKooD,MAAMC,MAAMC,qBAAqBlyD,EAAMowD,EAAMxmD,MAAM,GAE9DwmD,EAAMxmD,KAAKooD,MAAMC,MAAMC,qBAAqBlyD,EAAMowD,EAAMxmD,MAGpC,QAArB3Q,UAAU+L,SAAoBorD,EAAMxmD,KAAK8H,OAAOC,SAAYnH,UAAU+G,UAAUjB,QAAQ,kBAChF9F,UAAU+G,UAAUjB,QAAQ,iBAGnCtQ,IAFAowD,EAAMxmD,KAAKooD,MAAMC,MAAMC,qBAAqBlyD,EAAMowD,EAAMxmD,MAAK,GAMrEhP,EAAA8tB,iBAAiBhZ,MAAQ0gD,EAAMxmD,KAAK8F,MACpC9U,EAAA8tB,iBAAiBlhB,KAAO4oD,EAAMxmD,KAAKpC,KACnC4oD,EAAMxmD,KAAK6I,iBAAiB/Z,IAAI,SAAAkM,GAC5BhK,EAAA8tB,iBAAiBuR,YAAY,MAAOr1B,EAAK,UAE7ClT,OAAOg3B,iBAAP9tB,EAAA8tB,kBAEJlX,QAAS,aAET2gD,OAAQ,WACJj8D,KAAK0T,KAAKI,OAAOooD,cAAgB,SAAAhuD,GAAA,MAAKA,GAAEiuD,iBAGxC,IAAIC,GAAUlC,EAAMxmD,KAAKlR,IAAI+9C,SAAS,EAAG,EACzC6b,GAAQx8D,KAAO,UACfw8D,EAAQ5b,UAAU,SAClB4b,EAAQ3b,SAAS,EAAG,EAAG0Z,EAAIC,GAC3BgC,EAAQ1b,UAEJwZ,EAAMmC,YACNnC,EAAMmC,cAGdjgB,OAAQ,cAKRkgB,EAAelgD,OAAOmgD,OACtBC,EAASloD,UAAU+G,UAAU2Q,MAAM,wCACnCwwC,KACiB,uBAAbA,EAAO,IAA4C,uBAAbA,EAAO,QAClCloD,UAAU+G,UAAUjB,QAAQ,gCACzB9F,UAAU+G,UAAUjB,QAAQ,cACtCkiD,EAAelgD,OAAOqgD,MAGR,uBAAbD,EAAO,SAAsCloD,UAAU+G,UAAUjB,QAAQ,cAC9EkiD,EAAelgD,OAAOqgD;AAG9BvC,EAAMxmD,KAAO,GAAI0I,QAAOC,KACpB89C,EACAC,EACAkC,EACA,OACAjC,GAEJH,EAAMxmD,KAAKgpD,uBAAwB,EACnClhE,OAAOkY,KAAOwmD,EAAMxmD,KACpBlY,OAAA,aAAyB,KACzBA,OAAA,mBAA+B,KAC/B6Q,QAAQC,IAAI,kBAAZqwD,EAAAA,YAEJj0D,GAAI68B,QAAQ,cAAc,GAAG,MAAMr8B,KAAK,SAACgD,GACrCnJ,UAAUwI,KAAOW,EAAGX,KACpBxI,UAAU/B,KAAO,EACjB+B,UAAUmM,QAAUhD,EAAGgD,QACvBnM,UAAUwG,IAAM2C,EAAG3C,IACnBxG,UAAUC,SAA2B,MAAhBkJ,EAAGlJ,SACxBD,UAAUnD,KAAOsM,EAAGtM,KACpBmD,UAAUye,IAAMtV,EAAGsV,IACnBze,UAAUuf,OAAuB,MAAdpW,EAAGoW,OACtB23C,KACF,SAAC9tD,GAAM8tD,SAMb3nB,SAAU,WACN,GAAIsqB,GAAiB58D,KAAK0T,KAAKshC,MAAMsL,UAAU,iBAC1Csc,KACDA,EAAiB58D,KAAK0T,KAAKlR,IAAI0wB,MAAMlzB,KAAK0T,KAAKshC,MAAMhvC,MAAQ,EAAGhG,KAAK0T,KAAKshC,MAAM7uC,OAAS,EAAG,kBAC5Fy2D,EAAeh9D,KAAO,iBACtBg9D,EAAeC,OAAOC,MAAM,GAAK,KAErCF,EAAejuB,SAAU,GAG7BouB,YAAa,WACT,GAAIH,GAAiB58D,KAAK0T,KAAKshC,MAAMsL,UAAU,kBAC3C0c,EAAch9D,KAAK0T,KAAKshC,MAAMsL,UAAU,cAe5C,OAdK0c,KACDA,EAAch9D,KAAK0T,KAAKlR,IAAI0wB,MAAMlzB,KAAK0T,KAAKshC,MAAMhvC,MAAQ,EAAGjD,UAAUC,SAAYhD,KAAK0T,KAAKshC,MAAM7uC,OAAS,EAAI,IAAOnG,KAAK0T,KAAKshC,MAAM7uC,OAAQ,eAC/I62D,EAAYH,OAAO13C,IAAI,GAAI,IAC3B63C,EAAYjqD,EAAI/S,KAAK0T,KAAKshC,MAAMhvC,MAAQ,EACxCg3D,EAAYhpD,EAAIjR,UAAUC,SAAYhD,KAAK0T,KAAKshC,MAAM7uC,OAAS,EAAI62D,EAAY72D,OAAS,EAAMnG,KAAK0T,KAAKshC,MAAM7uC,OAAS,EAAI,GAC3H62D,EAAYp9D,KAAO,cACnBI,KAAKi9D,gBAAgBD,IAErBJ,IACAA,EAAevoD,MAAMyoD,MAAM,IAAM,KACjCF,EAAe7pD,EAAI/S,KAAK0T,KAAKshC,MAAMhvC,MAAQ42D,EAAe52D,MAAQ,GAClE42D,EAAe5oD,EAAIhU,KAAK0T,KAAKshC,MAAM7uC,OAASy2D,EAAez2D,OAAS,IAExE62D,EAAYruB,SAAU,GACf,GAGXuuB,cAAc,WACV,GAAIC,GAAYn9D,KAAK0T,KAAKshC,MAAMsL,UAAU,YACrC6c,KACDA,EAAYn9D,KAAK0T,KAAKlR,IAAI0wB,MAAMlzB,KAAK0T,KAAKshC,MAAMhvC,MAAQ,EAAGhG,KAAK0T,KAAKshC,MAAM7uC,OAAS,EAAG,aACvFg3D,EAAUv9D,KAAO,YACjBu9D,EAAUpmB,cAAe,EACzBomB,EAAUN,OAAOC,MAAM,GAAK,IAC5B98D,KAAK0T,KAAKshC,MAAMooB,cAAcD,EAAU,IAE5CA,EAAUxuB,SAAU,GAGxB0uB,YAAa,WACT,GAAMjB,GAAUp8D,KAAK0T,KAAKshC,MAAMsL,UAAU,WACpCsc,EAAiB58D,KAAK0T,KAAKshC,MAAMsL,UAAU,kBAC3C0c,EAAch9D,KAAK0T,KAAKshC,MAAMsL,UAAU,eACxCgd,EAAUt9D,KAAK0T,KAAKshC,MAAMsL,UAAU,WACpC6c,EAAYn9D,KAAK0T,KAAKshC,MAAMsL,UAAU,aACtCid,EAAcv9D,KAAK0T,KAAKshC,MAAMsL,UAAU,WAC9C6c,IAAaA,EAAUxgD,UACvB4gD,GAAeA,EAAY5gD,UAC3By/C,GAAWA,EAAQz/C,UACnBigD,GAAkBA,EAAejgD,UACjCqgD,GAAeA,EAAYrgD,UAC3B2gD,GAAWA,EAAQ3gD,WAGvB6gD,qBAAsB,WACdz6D,UAAUC,UAAShD,KAAK0T,KAAKpC,KAAKmsD,YAAY,OAAQ,iBAAkB,IAAK,KACjFz9D,KAAK0T,KAAKpC,KAAK4hB,MAAM,YAAa,uBAClClzB,KAAK0T,KAAKpC,KAAK4hB,MAAM,yBAA0B,oCAC/ClzB,KAAK0T,KAAKpC,KAAK4hB,MAAM,aAAc,wBACnClzB,KAAK0T,KAAKpC,KAAK4hB,MAAM,0BAA2B,qCAChDlzB,KAAK0T,KAAKpC,KAAK4hB,MAAM,WAAY,sBACjClzB,KAAK0T,KAAKpC,KAAK4hB,MAAM,yBAA0B,oCAC/ClzB,KAAK0T,KAAKpC,KAAK4hB,MAAM,YAAa,uBAClClzB,KAAK0T,KAAKpC,KAAK4hB,MAAM,yBAA0B,oCAC/ClzB,KAAK0T,KAAKpC,KAAK4hB,MAAM,QAAS,mBAC9BlzB,KAAK0T,KAAKpC,KAAK4hB,MAAM,cAAe,yBACpClzB,KAAK0T,KAAKpC,KAAK4hB,MAAM,QAAS,mBAC9BlzB,KAAK0T,KAAKpC,KAAK4hB,MAAM,cAAe,yBACpClzB,KAAK0T,KAAKpC,KAAK4hB,MAAM,eAAgB,0BACrClzB,KAAK0T,KAAKpC,KAAK4hB,MAAM,aAAc,wBACnClzB,KAAK0T,KAAKpC,KAAK4hB,MAAM,QAAS,mBAC9BlzB,KAAK0T,KAAKpC,KAAK4hB,MAAM,gBAAiB,2BACtClzB,KAAK0T,KAAKpC,KAAK4hB,MAAM,mBAAoB,8BACzClzB,KAAK0T,KAAKpC,KAAK4hB,MAAM,iBAAkB,4BACf,QAArBnwB,UAAU+L,QAAkB9O,KAAK0T,KAAKpC,KAAK4hB,MAAM,UAAW,qBAE5DnwB,UAAUuf,QAAgC,MAAtBvf,UAAUmM,SAC7BlP,KAAK0T,KAAKpC,KAAK4hB,MAAM,YAAYnwB,UAAUC,SAAW,wBAA0B,uBAChFhD,KAAK0T,KAAKpC,KAAK4hB,MAAM,WAAY,sBACjClzB,KAAK0T,KAAKpC,KAAK4hB,MAAM,WAAY,kBACjClzB,KAAK0T,KAAKpC,KAAK4hB,MAAM,gBAAiB,0BAEtClzB,KAAK0T,KAAKpC,KAAK4hB,MAAM,gBAAiBnwB,UAAUC,SAAW,4BAA8B,2BACzFhD,KAAK0T,KAAKpC,KAAK4hB,MAAM,mBAAoBnwB,UAAUC,SAAW,+BAAiC,8BAC/FhD,KAAK0T,KAAKpC,KAAK4hB,MAAM,iBAAkB,4BACvClzB,KAAK0T,KAAKpC,KAAK4hB,MAAM,cAAe,2BAO5CwqC,qBAhGJ,WAiGQ,GAA0B,MAAtB36D,UAAUmM,QAAiB,CAC3B,GAAGnM,UAAUC,SACT,IAAI,GAAIyD,GAAE,EAAEA,EAAI,GAAGA,IACfzG,KAAK0T,KAAKpC,KAAK4hB,MAAM,YAAazrB,EAAAA,WAAMu2B,uBAAuB,QAAS,SAAWv2B,EAAAA,WAAMw2B,UAAUx3B,GAAK,OAAQ,SAAUgB,EAAAA,WAAMu2B,uBAAuB,QAAU,SAAWv2B,EAAAA,WAAMw2B,UAAUx3B,GAAK,OAGzM,KAAK,GAAIA,GAAE,EAAGA,EAAE,GAAIA,IAChBzG,KAAK0T,KAAKpC,KAAK4hB,MAAM,YAAazrB,EAAAA,WAAMu2B,uBAAuB,QAAS,UAAYv2B,EAAAA,WAAMw2B,UAAUx3B,GAAK,OAAQ,SAAUgB,EAAAA,WAAMu2B,uBAAuB,QAAU,UAAYv2B,EAAAA,WAAMw2B,UAAUx3B,GAAK,OAEvM,KAAK,GAAIA,GAAE,EAAGA,EAAE,IAAKA,IACjBzG,KAAK0T,KAAKpC,KAAK4hB,MAAM,YAAczrB,EAAAA,WAAMu2B,uBAAuB,QAAU,WAAav2B,EAAAA,WAAMw2B,UAAUx3B,GAAK,OAAQ,SAAWgB,EAAAA,WAAMu2B,uBAAuB,QAAU,WAAav2B,EAAAA,WAAMw2B,UAAUx3B,GAAK,OAE5M,KAAK,GAAIA,GAAE,EAAGA,EAAE,GAAIA,IAChBzG,KAAK0T,KAAKpC,KAAK4hB,MAAM,YAAYzrB,EAAAA,WAAMu2B,uBAAuB,eAAgB,WAAav2B,EAAAA,WAAMw2B,UAAUx3B,GAAK,OAAQ,SAASgB,EAAAA,WAAMu2B,uBAAuB,eAAgB,WAAav2B,EAAAA,WAAMw2B,UAAUx3B,GAAK,OAEpN,KAAK,GAAIA,GAAE,EAAGA,EAAE,GAAIA,IAChBzG,KAAK0T,KAAKpC,KAAK4hB,MAAM,YAAczrB,EAAAA,WAAMu2B,uBAAuB,gBAAgB,WAAav2B,EAAAA,WAAMw2B,UAAUx3B,GAAK,OAAQ,SAAWgB,EAAAA,WAAMu2B,uBAAuB,gBAAgB,WAAav2B,EAAAA,WAAMw2B,UAAUx3B,GAAK,OAExN,KAAK,GAAIA,GAAE,EAAGA,EAAE,GAAIA,IAChBzG,KAAK0T,KAAKpC,KAAK4hB,MAAM,YAAczrB,EAAAA,WAAMu2B,uBAAuB,WAAY,YAAcv2B,EAAAA,WAAMw2B,UAAUx3B,GAAK,OAAQ,SAAWgB,EAAAA,WAAMu2B,uBAAuB,WAAY,YAAcv2B,EAAAA,WAAMw2B,UAAUx3B,GAAK,OAElN,KAAK,GAAIA,GAAE,EAAGA,EAAE,GAAIA,IAChBzG,KAAK0T,KAAKpC,KAAK4hB,MAAM,YAAazrB,EAAAA,WAAMu2B,uBAAuB,aAAe,aAAev2B,EAAAA,WAAMw2B,UAAUx3B,GAAK,OAAQ,SAAWgB,EAAAA,WAAMu2B,uBAAuB,aAAe,aAAev2B,EAAAA,WAAMw2B,UAAUx3B,GAAK,UAKjOk3D,QAAS,WAAY,GAAA/sD,GAAA5Q,KACX49D,EAAO,WACT,MAAO,IAAIh8D,SAAQ,SAACC,EAASC,GACzB8O,EAAK4sD,uBACL5sD,EAAK8C,KAAKpC,KAAKusD,YAAYC,QAAQ,WAC/BltD,EAAKmtD,OAAO,cAEhBntD,EAAK8C,KAAKpC,KAAKsN,eAAepc,IAAI,SAACgc,EAAUC,EAAUzR,EAAS0R,EAAaC,GACtE5b,UAAUuf,QAAgC,MAAtBvf,UAAUmM,QAC1B,cAAgBuP,GAAU7N,EAAKssD,gBAE9B,mBAAqBz+C,GAAU7N,EAAK0hC,WAE5C1hC,EAAKmtD,OAAO,YAAcv/C,EAAW,KAAK,KAE9C5N,EAAK8C,KAAKpC,KAAK0sD,eAAeF,QAAQ,WAGlC,MAFAltD,GAAK8C,KAAKpC,KAAKsN,eAAe8rC,YAC9B95C,EAAKmtD,OAAO,gBAAgB,GACrBl8D,MAEX+O,EAAK8C,KAAKpC,KAAK+pB,UAGvB,OAAGt4B,WAAUuf,QAAgC,MAAtBvf,UAAUmM,SAAqC,SAAlBnM,UAAUye,IAEnD+lB,EAAA55B,UAAUswD,cAAc/0D,KAAK,SAACC,GAEjC,MADAkD,SAAQC,IAAI,UAAUnD,GACfy0D,MAGJA,KAKfM,YAAa,SAAUC,GAAY,GAAAttD,GAAA7Q,IAC/B+C,WAAUwI,KAAOxI,UAAUwI,MAAQ,sCACnC,IAAMA,GAAOxI,UAAUwI,IAEvBvJ,UAASlB,MAAQiC,UAAUnD,MAAQuwB,UAAUptB,UAAUnD,OAAS,IAEhE,IAAMolC,GAAa,SAAAic,GACf,GAAIA,EAAImd,iBAAkB,CACtB,GAAMC,GAAkBpd,EAAI5vC,OAAS4vC,EAAIhyC,KACzC4B,GAAKktD,OAAO,cAAgBM,EAAkB,KAAK,OAEnDxtD,GAAKktD,OAAO,YAAc9c,EAAI5vC,QAAQ,GAI9CrR,MAAK+9D,OAAO,WACZ,IAAMn4B,GAAUu4B,EAAaz1D,EAAIq9B,aAAkC,GAAlBhjC,UAAU/B,KAAY0H,EAAIo9B,YAAcp9B,EAAIk9B,OAC7F,OAAOA,GAAQr6B,EAAMy5B,GAAY97B,KAAK,SAAAwK,GAElC,MADA7C,GAAKktD,OAAO,gBAAgB,GACrBrqD,GACR,SAAAxF,GAEC,MADA2C,GAAKktD,OAAO,QAAU7vD,GACftM,QAAQE,OAAOoM,MAI9B6vD,OAAQ,SAAU3lB,EAAM3hC,GACpB,GAAK2hC,EAAL,CAGA,GAAIklB,GAAUt9D,KAAK0T,KAAKshC,MAAMsL,UAAU,UACxC,KAAKgd,EAAS,CACV,GAAM16D,IAAS8C,KAAM,UAAWiP,KAAM,OAEtC2oD,GAAUt9D,KAAK0T,KAAKlR,IAAIwP,KAAK,GAAIhS,KAAK0T,KAAKshC,MAAM7uC,OAAS,GAAI,GAAIvD,GAClE06D,EAAQ19D,KAAO,UAEnB,GAAIoS,GAAOsrD,EAAQtrD,KACbssD,EAAYtsD,EAAKK,MAAM,WAAW+oB,OAAO,SAAAvE,GAAA,QAAOA,GAClDpgB,GACA6nD,EAAUA,EAAUj9D,OAAS,GAAK+2C,EAElCkmB,EAAU/6C,KAAK60B,GAEnBklB,EAAQtrD,KAAO,GACfssD,EAAUjoD,UAAUgkB,IAAI,SAAAskB,GAAA,MAAO2e,GAAQtrD,MAAQ2sC,EAAM,OAErD2e,EAAQtpD,EAAIhU,KAAK0T,KAAKshC,MAAM7uC,OAA4B,GAAnBm4D,EAAUj9D,SAGnDk9D,UAAW,SAAUxrD,EAAGiB,EAAGhO,EAAOG,EAAQq4D,EAAYC,EAAYC,EAAS1sD,EAAM8I,EAAOlb,EAAMC,EAAQ8+D,GAAY,GAAArlD,GAAAtZ,KACxG4+D,EAAkB,SAACC,EAAUr7D,EAASwC,EAAOG,EAAQ24D,GACvD,GAAMC,GAAYD,EAAQ7tB,SAAS,GAC7B+tB,EAAax7D,EAAUA,EAAUu7D,EAAYA,EAAU/sD,KAAO,EAEpE,IAAKgtD,EAAL,CAIA,GAAMh6D,GAAW65D,EAAS75D,SAAWsJ,SAASuwD,EAAS75D,UAAY,GAC7DX,EAAQw6D,EAASx6D,MAAQw6D,EAASx6D,MAAQ,UAC1C0kD,EAAKzvC,EAAK2gB,WAAW6V,UAAUpqC,KAAKI,KAAOwT,EAAK2gB,WAAW+uB,sBAAsBhkD,GAAYA,EAC7FikD,EAAK3vC,EAAK2gB,WAAW6V,UAAUpqC,KAAKI,KAAOwT,EAAK2gB,WAAWivB,qBAAqBlkD,GAAYA,CAClG,IAAIX,EAAM+V,QAAQ,YAAe,CAC7B,GAAM6kD,GAAM56D,EAAMoS,QAAQ,OAAQ,IAAIA,QAAQ,IAAK,IAAIpE,MAAM,IAC7DysD,GAAQ5S,SAAS,KAAO,SAAW59C,SAAS2wD,EAAI,KAAO,GAAK3wD,SAAS2wD,EAAI,KAAO,EAAI3wD,SAAS2wD,EAAI,KAAKx0D,SAAS,KAAK6L,WAAY,OAGhIwoD,GAAQ5S,SAAmB,YAAV7nD,EAAsB,UAAYA,EAAO,EAE9Dy6D,GAAQ/oD,cAAgB,IACxBuD,EAAK2gB,WAAWkvB,mBAAmBpoD,KAAKi+D,IAAc/V,EAAIF,EAAI+V,EAASxlD,EAAK2gB,WAAW9vB,QACvF,IAAM0R,GAAIijD,EAAQ7tB,SAAS,GAAGkd,SAAW2Q,EAAQ7tB,SAAS,GAAGkd,SAAWlF,EAAK+V,EAAW39D,OAClF0R,GAAK/M,EAAQ6V,GAAK,GAAKijD,EAAQ7tB,SAAS,GAAGmd,UAAY0Q,EAAQ7tB,SAAS,GAAGmd,UAAY,GACvFp6C,GAAK7N,EAAS4iD,GAAM,CAC1B+V,GAAQ7tB,SAAS,GAAGl+B,EAAIA,EACxB+rD,EAAQ7tB,SAAS,GAAGj9B,EAAIA,EACxB8qD,EAAQ7tB,SAAS,GAAGj/B,KAAOgtD,EAEvBD,IACAA,EAAU9tB,SAAS5zB,QAAQ,SAAArU,GAAA,MAAQA,GAAKsiD,QAAQ3uC,YAChDoiD,EAAUpiD,WAGdmiD,EAAQ9sD,KAAO,MAEbktD,EAAmB,SAACC,EAAazwD,EAAKsD,EAAM8S,GAC9C,GAAM5gB,GAAai7D,EAAY7e,UAAU,cACnC8e,EAASD,EAAY7e,UAAU,UAC/BoL,EAASyT,EAAY7e,UAAU,QAC/B+e,EAAS/lD,EAAK5F,KAAKpC,KAAKkI,MAAM6E,cAAc3P,GAAOA,EAAM,IAE/D,IAAK0wD,EAiBL,GAbI1T,GAAU15C,IACN0+B,EAAAA,WAAUrrC,WACVu5D,EAAgB5sD,EAAM,GAAIhM,EAAOG,EAAQulD,IAGzCA,EAAOhmD,KAAOsM,EAAK3M,YAAcqmD,EAAOhmD,KACxCgmD,EAAO1mD,SAAWgN,EAAKhN,UAAY0mD,EAAO1mD,SAC1C0mD,EAAO4T,WAAattD,EAAKstD,YAAc5T,EAAO4T,WAC9C5T,EAAO/2C,KAAO3C,EAAK3N,OAASqnD,EAAO/2C,MAGvC+2C,EAAO/c,SAAW38B,EAAK8oC,QAEvBukB,EAAQ,CACR,GAAIhrD,GAAQ,EACLrO,EAAiBo5D,EAAjBp5D,MAAOG,EAAUi5D,EAAVj5D,OACR+sB,EAAQ5Z,EAAK5F,KAAK8F,MAAMgc,SAAS6pC,EAElCnsC,GAAM3iB,MAOFrM,EAAWwK,MAAQ2wD,GACxB/lD,EAAK2jD,gBAAgB/4D,EAAYm7D,IAPjChrD,EAAQnN,KAAK2mB,IAAI7nB,EAAQktB,EAAMltB,MAAOG,EAAS+sB,EAAM/sB,QACrDjC,EAAWykD,YAAY0W,GACvBn7D,EAAWmQ,MAAMyoD,MAAMzoD,EAAOA,GAC9BnQ,EAAW6O,GAAK/M,EAAQ9B,EAAW8B,OAAS,EAC5C9B,EAAW8P,GAAK7N,EAASjC,EAAWiC,QAAU,OAK1C2e,IACR5gB,EAAWykD,YAAY,OAIzB4W,EAAUv/D,KAAK0T,KAAKlR,IAAI69C,OAC9Bkf,GAAS3/D,KAAOA,EAChBC,GAAUA,EAAO2C,IAAI+8D,GACrBA,EAASxsD,EAAIA,EACbwsD,EAASvrD,EAAIA,CAEb,IAAMwrD,GAAgBx/D,KAAK0T,KAAKpC,KAAKkI,MAAM6E,cAAcmgD,GAAcA,EAAa,KAC9EiB,EAAgBz/D,KAAK0T,KAAKpC,KAAKkI,MAAM6E,cAAcogD,GAAcA,EAAa,KAC9EtoB,EAAKn2C,KAAK0T,KAAKlR,IAAI0wB,MAAM,EAAG,EAAGssC,EAAe,KAAMD,EAC1DppB,GAAGv2C,KAAO,YACV,IAAMyU,GAAQnN,KAAK2mB,IAAI7nB,EAAQmwC,EAAGnwC,MAAOG,EAASgwC,EAAGhwC,OACrDgwC,GAAG9hC,MAAMyoD,MAAMzoD,EAAOA,GACtB8hC,EAAGpjC,GAAK/M,EAAQmwC,EAAGnwC,OAAS,EAC5BmwC,EAAGniC,GAAK7N,EAASgwC,EAAGhwC,QAAU,EAC9BnG,KAAKi9D,gBAAgB9mB,EAAIqpB,EACzB,IAAIE,IAAS,EACTC,EAAS,KACTC,EAAa,KACXC,EAAW,SAAC9xD,EAAK+xD,GACnBH,EAAS5xD,EACT6xD,EAAaE,GAEXh8D,EAAM9D,KAAK0T,KAAKlR,IAAIu9D,OAAO,EAAG,EAAG,KAAMpB,EAAaD,EAAUmB,EAAU7/D,KAAM,EAAG,EAAG,EAAG,EAAGu/D,EAChGz7D,GAAIkC,MAAQA,EACZlC,EAAIqC,OAASA,EACbrC,EAAIlE,KAAO,SACPkb,IACAA,EAAMhL,UAAgCxO,SAApBwZ,EAAMhL,UAA0BgL,EAAMhL,UAAYgL,EAAMvL,OAC1EvP,KAAK0T,KAAK8H,OAAOs5C,QAAUhxD,EAAIk8D,aAAallD,GAAShX,EAAIm8D,aAAanlD,GACtE9a,KAAK0T,KAAK8H,OAAOs5C,QAAUhxD,EAAIo8D,WAAW19D,IAAI,WAAA,MAAMsY,GAAMtC,SAAU1U,EAAIq8D,UAAU39D,IAAI,cAG1F,IAAIs8D,GAAU,IACd,IAAI9sD,EAAM,CACN,GAAMouD,MACFC,EAAK,EACTA,IAAMruD,EAAK+sB,OAAOugC,WAAattD,EAAK+sB,OAAOugC,WAAa,IAAM,UAC9De,GAAMruD,EAAK+sB,OAAO/5B,SAAWsJ,SAAS0D,EAAK+sB,OAAO/5B,UAAY,MAAQ,GACtEq7D,GAAMruD,EAAK+sB,OAAO15B,WAAa2M,EAAK+sB,OAAO15B,WAAarF,KAAKi6B,WAAW6V,UAAUpqC,KAAO1F,KAAKi6B,WAAW6V,UAAUpqC,KAAKL,WAAa,GAErI+6D,EAAU16D,KAAO26D,EACjBD,EAAUzrD,KAAO3C,EAAK+sB,OAAO16B,MAC7B+7D,EAAUvrD,OAAS7C,EAAK+sB,OAAOlqB,OAC/BurD,EAAUvtD,gBAAkBb,EAAK+sB,OAAOlqB,OAAS,EAAI,EAErDurD,EAAUzf,aAAe,SACzByf,EAAUxf,aAAe,SACzBke,EAAU9+D,KAAK0T,KAAKlR,IAAIwP,KAAK,EAAG,EAAGA,EAAKA,KAAMouD,EAAWb,GACzDT,EAAQl/D,KAAO,OACX8wC,EAAAA,WAAUrrC,WACVu5D,EAAgB5sD,EAAK+sB,OAAQ/sB,EAAKA,KAAMhM,EAAOG,EAAQ24D,GAGvDA,EAAQje,cAAc,GAAIie,EAAQ34D,OAASmI,SAAS0D,EAAK+sB,OAAO/5B,UAAY,KAAO,EAAGgB,EAAOG,GAEjG6L,EAAK+sB,OAAO+b,SAAWgkB,EAAQnwB,SAAU,GAkD7C,MAhDA7qC,GAAIg4D,MAAMwE,SAAW,WACjB,GAAoB,OAAhBtgE,KAAK+tD,QAAoB/tD,KAAK+tD,OAAOhX,aAAzC,CAKA,GAAIh2C,GAAOf,KAAKugE,aAAa,EAE7Bx/D,GAAKy/D,QAAS,EACdz/D,EAAK0/D,OAAQ,EACb1/D,EAAK2/D,QAAU1gE,KAAK0T,KAAK0Y,KAAKA,KAE1BpsB,KAAK2gE,eAAiB5/D,EAAK6/D,aAAc,IAEzC5gE,KAAK0T,KAAKI,OAAOlR,MAAMi+D,OAAS,UAChC7gE,KAAK8gE,gBAAiB,GAGtB9gE,KAAK+tD,QAAU/tD,KAAK+tD,OAAOjd,SAE3B9wC,KAAK+tD,OAAOjd,OAAOiwB,oBAAoB/gE,KAAK+tD,OAAQ,MAEhD/tD,KAAK+tD,QAAU/tD,KAAK+tD,OAAOluD,QAAUG,KAAK+tD,OAAOluD,OAAOmB,OAASob,OAAO4kD,OAExEhhE,KAAK+tD,OAAOluD,OAAOohE,gBAAgBzvD,SAASxR,KAAK+tD,OAAQ,UAIpE4Q,GAAc76D,EAAIo9D,YAAY1+D,IAAI,WAC/BsB,EAAIq9D,cAAgBr9D,EAAIq9D,YAAY5xD,QAAwCjO,SAA9BwC,EAAIq9D,YAAYrxD,UAA0BhM,EAAIq9D,YAAYrxD,UAAYhM,EAAIq9D,YAAY5xD,QAAU9H,EAAAA,WAAMwqB,aACpJitC,EAAiBK,EAAUE,EAAeztD,GAAQA,EAAK+sB,WAK1D4/B,GAAc76D,EAAIo8D,WAAW19D,IAAI,WAAOk9D,GAAS,EAAMR,EAAiBK,EAAUC,EAAextD,GAAQA,EAAK+sB,WAC9G4/B,GAAc76D,EAAIs9D,YAAY5+D,IAAI,WAC/Bk9D,GAAS,EACT57D,EAAIu9D,cAAgBv9D,EAAIu9D,YAAY9xD,QAAwC,OAA9BzL,EAAIu9D,YAAYvxD,UAAsBhM,EAAIu9D,YAAYvxD,UAAWhM,EAAIu9D,YAAY9xD,QAAU9H,EAAAA,WAAMwqB,aAC/IitC,EAAiBK,EAAUE,EAAeztD,GAAQA,EAAKgtB,WAE1D2/B,GAAc76D,EAAIq8D,UAAU39D,IAAI,WAAOk9D,GAAS,EAAMR,EAAiBK,EAAUC,EAAextD,GAAQA,EAAK+sB,QAAQ2/B,GAAWA,EAAQiB,EAAOC,KAEhJL,EAASL,iBAAmB,SAAUxwD,EAAKsD,EAAMhR,GAC7Ck+D,EAAiBl/D,KAAM0O,EAAKsD,EAAMhR,IAEtCu+D,EAASQ,OAASj8D,EAClBy7D,EAASvtD,KAAO8sD,EACTS,GAGXtC,gBAAiB,SAASlvD,EAAKW,GAC3B,GAAMwkB,GAAQlzB,KAAK0T,KAAK8F,MAAMgc,SAASznB,EAAIW,KAAK,GADhB4yD,EAEJpuC,EAAMnyB,KAA3B2W,EAFyB4pD,EAEzB5pD,OAAQC,EAFiB2pD,EAEjB3pD,SACf,IAAID,EAAQ,CACR,GAAI6pD,GAAS,EACPC,EAAW,SAAAp8D,GACb,GAAKsS,EAAOtS,IAAWsS,EAAOtS,GAAOuC,QAArC,CAGA,GAAMI,GAAM,GAAIC,MAChBD,GAAII,OAAS,SAAA+F,GACT,GAAMuzD,GAAO,GAAIxlD,MAAKylD,YAAYxzD,EAAEnI,QAC9B4L,EAAU,GAAIsK,MAAK0lD,QAAQF,EACjC1zD,IAAOA,EAAIlO,QAAUkO,EAAI6zD,WAAWjwD,IAGxC5J,EAAIG,IAAMwP,EAAOtS,GAAOuC,UAGtBy0C,EAAS,QAATA,GAASh3C,GACXqC,EAAAA,WAAM8E,QAA8B,GAAtBmL,EAAOtS,GAAOmL,OAAYrH,KAAK,WAGzC,GAFAs4D,EAASp8D,GACTA,IACIA,GAASsS,EAAOrW,OAAQ,CACxB,GAAIsW,GAAa4pD,GAAU5pD,IAAc5J,IAAQA,EAAIlO,OACjD,MAEA0hE,KACAnlB,EAAO,OAGXA,GAAOh3C,KAInBg3C,GAAO,KAIfylB,kBAAmB,SAAU9uD,EAAGiB,EAAGhO,EAAOG,EAAQuI,EAAK7O,EAAQuF,GAC3D,GAAM2tB,GAAO/yB,KAAK0T,KAAKpC,KAAKkI,MAAM6E,cAAc3P,GAAOA,EAAM,KACvDq/C,EAAS/tD,KAAK0T,KAAKlR,IAAIurD,OAAOh7C,EAAGiB,EAAG+e,EAC1C,IAAIA,EAAM,CACN,GAAM1e,GAAQnN,KAAK2mB,IAAI7nB,EAAQ+nD,EAAO/nD,MAAOG,EAAS4nD,EAAO5nD,OAC7D4nD,GAAO7H,MAAMnzC,EAAIg7C,EAAO/nD,MAAQ,EAChC+nD,EAAO7H,MAAMlyC,EAAI+5C,EAAO5nD,OAAS,EACjC4nD,EAAO15C,MAAMyoD,MAAMzoD,EAAOA,GAC1B05C,EAAOh7C,GAAKg7C,EAAO/nD,MAAQ,EAC3B+nD,EAAO/5C,GAAK+5C,EAAO5nD,OAAS,EAEhC,GAAIf,EAAQ,EAAG,CACX,GAAIqB,GAAI,CACR,KAAKA,EAAE,EAAGA,EAAE5G,EAAOoxC,SAAS5vC,OAAQoF,IAAK,CACrC,GAAIyF,GAAKrM,EAAOiiE,MAAMr7D,EACtB,SAAWyF,EAAI,KACf,IAAIA,EAAGq6C,SAAWnhD,EAAO,CACrBvF,EAAOkiE,cAAct7D,GACrByF,EAAGyQ,SACH,OAEC,GAAIzQ,EAAGq6C,OAASnhD,EACjB,MAGR,GAAI48D,GAAahiE,KAAK0T,KAAKlR,IAAI69C,OAC/B2hB,GAAWx/D,IAAIurD,GACfiU,EAAWzb,OAASnhD,EACpBvF,EAAO2C,IAAIw/D,GAAY,EAAOv7D,OAG9B5G,GAAO2C,IAAIurD,EAGf,OAAOA,IAGXr6C,KAAM,KACN2oD,WAAY,KACZpiC,WAAY,OASZgoC,aAAc,yJCvqBtB,GAAAziE,GAAAC,EAAA,kBACA6nC,EAAA7nC,EAAA,oCACAqiB,EAAAriB,EAAA,oCAEAC,GAAAA,WAAQC,QAGAC,KAAM,4CACNC,OAAQH,EAAAA,WAAQwiE,WAGhBC,0BAA2B,WACvB,OACI1mE,cAAcC,aAAayB,uBAInCilE,mBAAoB,SAAUl8B,GAC1B,OAAQA,EAAKm8B,WACT,IAAK5mE,eAAcC,aAAayB,qBAC5B6C,KAAKsiE,mBAOjBC,WAAY,WACRviE,KAAKi6B,WAAaj6B,KAAKmmC,OAAOq8B,cAAc/mE,cAAc4qC,MAAMC,MAAMC,WAAW3lC,KACjF,IAAM6hE,GAAgBziE,KAAKmmC,OAAOu8B,iBAAiBjnE,cAAcgrC,KAAKC,SAASC,cAAc/lC,KAC7FZ,MAAK0T,KAAO+uD,EAAc9yB,eAAiB8yB,EAAc9yB,cAAcj8B,KACvE1T,KAAK2vC,cAAgB8yB,EAAc9yB,eAGvCgzB,SAAU,WAAY,GAAA/8D,GAAA5F,KAAA4iE,EACQ5iE,KAAKi6B,WAAW6V,UAAnCC,EADW6yB,EACX7yB,SAAUa,EADCgyB,EACDhyB,MADCiyB,EAEoD9yB,EAASpK,KAAKiL,MAA7EQ,EAFWyxB,EAEXzxB,eAAgBxI,EAFLi6B,EAEKj6B,UAAWH,EAFhBo6B,EAEgBp6B,SAAUE,EAF1Bk6B,EAE0Bl6B,aAAcD,EAFxCm6B,EAEwCn6B,SACpDo6B,EAAa9iE,KAAK0T,KAAKshC,MAAMhvC,MAC7B+8D,EAAa/iE,KAAK0T,KAAKshC,MAAM7uC,OAE7B68D,EAAiB,SAACjwD,EAAGiB,EAAGhO,EAAOG,EAAQ3C,EAASy/D,EAASrjE,EAAMsjE,GACjE,GAAM9C,MACFC,EAAK,EACTA,IAAM4C,EAAQ3D,WAAa2D,EAAQ3D,WAAa,IAAM,UACtDe,GAAM4C,EAAQj+D,SAAWsJ,SAAS20D,EAAQj+D,UAAY,MAAQ,GAC9Dq7D,GAAM4C,EAAQ59D,WAAa49D,EAAQ59D,WAAa,GAEhD+6D,EAAU16D,KAAO26D,EACjBD,EAAUzrD,KAAOsuD,EAAQ5+D,MACzB+7D,EAAUvrD,OAASouD,EAAQpuD,OAC3BurD,EAAUvtD,gBAAkBowD,EAAQpuD,OAAS,EAAI,EAEjDurD,EAAUzf,aAAe,SACzByf,EAAUxf,aAAesiB,EAAU,SAAW,QAC9C,IAAMl/D,GAAM4B,EAAK8N,KAAKlR,IAAIwP,KAAK,EAAG,EAAGxO,EAAS48D,EAAWx6D,EAAKq0B,WAAWqe,WAEzE,IADAt0C,EAAIpE,KAAOA,EACP8wC,EAAAA,WAAUrrC,WAAY,CACtB,GAAMhB,IAA2B,YAAlB4+D,EAAQ5+D,MAAsB,UAAY4+D,EAAQ5+D,OAAOoS,QAAQ,IAAK,MAC/EzR,EAAWi+D,EAAQj+D,SAAWsJ,SAAS20D,EAAQj+D,UAAY,EACjEhB,GAAIgP,OAAO+L,OAAO,EAAG/a,EAAIgP,OAAO3R,QAChC2C,EAAIgO,KAAO,IACXhO,EAAI2Q,KAAOtQ,EACXL,EAAIkoD,SAAS7nD,EAAO,GACpBL,EAAI+O,GAAK+vD,EAAa99D,EAAWxB,EAAQnC,QAAU,EACnD2C,EAAIgQ,EAAIA,EACRhQ,EAAI+R,cAAgB+sD,CAEpB,IAAM/Z,GAAKnjD,EAAKq0B,WAAW6V,UAAUpqC,KAAKI,KAAOF,EAAKq0B,WAAW+uB,sBAAsBhkD,GAAYA,EAC7FikD,EAAKrjD,EAAKq0B,WAAW6V,UAAUpqC,KAAKI,KAAOF,EAAKq0B,WAAWivB,qBAAqBlkD,GAAYA,CAClGY,GAAKq0B,WAAWkvB,mBAAmBpoD,KAAKyC,IAAWylD,EAAIF,EAAI/kD,EAAK4B,EAAKq0B,WAAW9vB,aAGhFnG,GAAI68C,cAAc9tC,EAAGiB,GAAKhQ,EAAImC,OAASmI,SAAS20D,EAAQj+D,WAAa,EAAGgB,EAAOG,EAGnF,OADA88D,GAAQnoB,SAAW92C,EAAI2qC,SAAU,GAC1B3qC,GAGLu6D,EAAY,SAACxwD,EAAKnO,EAAMoS,GAC1B,GAAM6kB,KACNA,GAAEkI,OAAShxB,EAAIgxB,OAAO/sB,KACtB6kB,EAAEmI,OAASjxB,EAAIixB,OAAOhtB,KACtB6kB,EAAE7kB,KAAOA,CACT,IAAMutD,GAAW35D,EAAK+pC,cAAc4uB,UAAUxwD,EAAIygD,KAAKz7C,EACnDhF,EAAIygD,KAAKx6C,EACTjG,EAAIygD,KAAKxoD,MACT+H,EAAIygD,KAAKroD,OACT4H,EAAIgxB,OAAO76B,WAAWwC,IACtBqH,EAAIixB,OAAO96B,WAAWwC,IACtBy8D,EACAtsC,EACAjxB,EAAKq0B,WAAWq/B,UAChB15D,EACAgG,EAAKq0B,WAAWqe,WAEpBinB,GAASQ,OAAOI,UAAU39D,IAAI,WAAA,MAAMoD,GAAKq0B,WAAWq/B,WAAa1zD,EAAKq0B,WAAWq/B,UAAU9gD,UAGzF2qD,EAAe,SAACp1D,EAAK+xD,GACnBA,EAAQsD,cAAgBhnD,OAAOinD,YAAYC,QAA6B,IAAnBxD,EAAQC,SAGzC,uBAApBhyD,EAAIlO,OAAOD,KAEXgG,EAAKq0B,WAAW2d,yBAES,sBAApB7pC,EAAIlO,OAAOD,KAEhBgG,EAAKq0B,WAAW0e,wBAES,0BAApB5qC,EAAIlO,OAAOD,KAEhBgG,EAAKq0B,WAAW2e,2BAES,sBAApB7qC,EAAIlO,OAAOD,MAEhBgG,EAAKq0B,WAAW4e,0BAIpB1C,EAAKn2C,KAAK2vC,cAAcj8B,KAAKlR,IAAI+9C,SAAS,EAAG,EAAGvgD,KAAKi6B,WAAWqe,WACpEnC,GAAGqK,UAAU,GACbrK,EAAGsK,SAAS,EAAE,EAAEqiB,EAAWC,GAC3B5sB,EAAGuK,SAUH,IAAM6iB,GAAgB3yB,EAAM1sC,WAAWwC,GAUvC,IATG1G,KAAK0T,KAAKpC,KAAKkI,MAAM6E,cAAcklD,KAClCptB,EAAKn2C,KAAKi6B,WAAWqe,WAAW2jB,OAAO,EAAG,EAAEsH,IAEhDvjE,KAAKi6B,WAAWuS,aAAexsC,KAAKi6B,WAAWqrB,aAC/CtlD,KAAKi6B,WAAWqrB,aAAe1U,EAAM1sC,WAAWwC,IAChD1G,KAAKi6B,WAAWyrB,cAAgB9U,EAAM1sC,WAAWs/D,KACjDxjE,KAAKi6B,WAAWurB,iBAAmB5U,EAAM1sC,WAAW8hD,QACpDhmD,KAAKi6B,WAAWu/B,UAAYx5D,KAAK2vC,cAAcj8B,KAAKlR,IAAIurD,OAAO,EAAG,EAAG/tD,KAAK0T,KAAKpC,KAAKkI,MAAM6E,cAAcklD,IAAkBA,GAC1HptB,EAAGY,cAAe,EACY,IAA1BnG,EAAM1sC,WAAWs/D,KAAY,CAC7B,GAAIC,GAAOttB,EAAGnwC,MAAQmwC,EAAGhwC,OAAS28D,EAAaC,EAAaD,EAAa3sB,EAAGnwC,MAAQ+8D,EAAa5sB,EAAGhwC,MACpGgwC,GAAGnwC,OAASy9D,EACZttB,EAAGhwC,QAAUs9D,EACbttB,EAAGpjC,IAAMojC,EAAGnwC,MAAQ88D,GAAc,EAClC3sB,EAAGniC,IAAMmiC,EAAGhwC,OAAS48D,GAAc,MAElC,IAA8B,IAA1BnyB,EAAM1sC,WAAWs/D,KAAY,CAClC,GAAIC,GAAO,CACPttB,GAAGnwC,MAAQmwC,EAAGhwC,OAAS28D,EAAaC,GACpCU,EAAOX,EAAa3sB,EAAGnwC,MACvBmwC,EAAGnwC,OAASy9D,EACZttB,EAAGhwC,QAAUs9D,EACbttB,EAAGniC,GAAK+uD,EAAa5sB,EAAGhwC,QAAU,IAGlCs9D,EAAOV,EAAa5sB,EAAGhwC,OACvBgwC,EAAGnwC,OAASy9D,EACZttB,EAAGhwC,QAAUs9D,EACbttB,EAAGpjC,GAAK+vD,EAAa3sB,EAAGnwC,OAAS,OAIrCmwC,GAAGnwC,MAAQ88D,EACX3sB,EAAGhwC,OAAS48D,CAEhB/iE,MAAKi6B,WAAWu/B,UAAUzmD,EAAIojC,EAAGpjC,EACjC/S,KAAKi6B,WAAWu/B,UAAUxlD,EAAImiC,EAAGniC,EACjChU,KAAKi6B,WAAWu/B,UAAUxzD,MAAQmwC,EAAGnwC,MACrChG,KAAKi6B,WAAWu/B,UAAUrzD,OAASgwC,EAAGhwC,OAElCyqC,EAAM9vC,MAAMC,OAASqwC,EAAetwC,MAAMkR,KAAK8oC,QAC/C96C,KAAK2vC,cAAckyB,kBAAkBzwB,EAAeod,KAAKz7C,EACrDq+B,EAAeod,KAAKx6C,EACpBo9B,EAAeod,KAAKxoD,MACpBorC,EAAeod,KAAKroD,OACpBirC,EAAeltC,WAAWwC,IAC1B1G,KAAKi6B,WAAWqe,WAlJN,IAAAorB,GAsJmC9yB,EAAM9vC,MAApDusD,EAtJWqW,EAsJXrW,UAAWhpD,EAtJAq/D,EAsJAr/D,MAAOs/D,EAtJPD,EAsJOC,KAAMt+D,EAtJbq+D,EAsJar+D,WAAYy1C,EAtJzB4oB,EAsJyB5oB,OACrC8oB,EAAYxyB,EAAetwC,MAAMkR,IACvCq7C,KAAcuW,EAAU5+D,SAAWqoD,GACnChpD,IAAUu/D,EAAUv/D,MAAQA,GACnB/C,SAATqiE,IAAuBC,EAAUtE,WAAaqE,EAAO,OAAS,UAC9DC,EAAUv+D,WAAarF,KAAKi6B,WAAW6V,UAAUpqC,KAAO1F,KAAKi6B,WAAW6V,UAAUpqC,KAAKL,WAAaA,EAAaA,EAAa,GACnH/D,SAAXw5C,IAAyB8oB,EAAU9oB,OAASA,GAG5CkoB,EAAe5xB,EAAetwC,MAAM0tD,KAAKz7C,EAAIq+B,EAAeod,KAAKz7C,EAC3Dq+B,EAAetwC,MAAM0tD,KAAKx6C,EAAIo9B,EAAeod,KAAKx6C,EAClDo9B,EAAetwC,MAAM0tD,KAAKxoD,MAC1BorC,EAAetwC,MAAM0tD,KAAKroD,OAC1ByqC,EAAM9vC,MAAMC,KACZ6iE,EACA,oBACA,GAGDh7B,EAAUkS,QACXyjB,EAAU31B,EAAW,qBAAsB5oC,KAAKi6B,WAAWuO,UAAUI,WAIpEH,EAASqS,QACVyjB,EAAU91B,EAAU,oBAAqBzoC,KAAKi6B,WAAWuO,UAAUC,UAIlEE,EAAamS,QACdyjB,EAAU51B,EAAc,wBAAyB3oC,KAAKi6B,WAAWuO,UAAUG,cAI1ED,EAASoS,QACVyjB,EAAU71B,EAAU,oBAAqB1oC,KAAKi6B,WAAWuO,UAAUE,UAEvE1oC,KAAKi6B,WAAWqe,WAAW3J,SAAU,GAGzC2zB,eAAgB,WACZtiE,KAAKi6B,WAAWo4B,cAAgBryD,KAAKi6B,WAAWo4B,aAAa11C,UAC7D3c,KAAKi6B,WAAW+f,cAAgBh6C,KAAKi6B,WAAW+f,aAAar9B,UAC7D3c,KAAKi6B,WAAWw4B,YAAY9jB,SAAU,EACtC3uC,KAAKi6B,WAAW6U,UAAUH,SAAU,EACpC3uC,KAAKi6B,WAAWu/B,YAAcx5D,KAAKi6B,WAAWu/B,UAAU7qB,SAAU,GACf,IAA/C3uC,KAAKi6B,WAAWqe,WAAWrH,SAAS5vC,QACpCrB,KAAK2iE,UAPe,IAAAkB,GAWI7jE,KAAKi6B,WAAW6V,UAAUc,MAA/Cvd,EAXiBwwC,EAWjBxwC,MAAOnvB,EAXU2/D,EAWV3/D,UACVlE,MAAKi6B,WAAW+N,UAChBhoC,KAAKi6B,WAAWk4B,YAEhB9+B,IAAUrzB,KAAK0T,KAAKpC,KAAKkI,MAAM2E,cAAckV,EAAM3sB,MAAQ8sB,EAAAA,WAAWC,eAAeJ,EAAM3sB,MAA6B,QAArB3D,UAAU+L,QAAoB,SAAW/L,UAAUstB,cACtJrwB,KAAKi6B,WAAWq7B,UAAUjiC,EAAM3sB,IAAK2sB,EAAM9jB,QAAQ,GAEvDvP,KAAKi6B,WAAWqrB,aAAephD,EAAWwC,IAC1C1G,KAAKi6B,WAAWurB,iBAAmBthD,EAAW8hD,QAC9ChmD,KAAKi6B,WAAWyrB,cAAgBxhD,EAAWs/D,KAC3CxjE,KAAKi6B,WAAWqe,WAAW3J,SAAU,EACrC3uC,KAAK0T,KAAKshC,MAAM6V,WAAW7qD,KAAKi6B,WAAWqe,eAQ/C13C,KAAM,iRC3Pd,GAAApB,GAAAC,EAAA,iBACAC,GAAAA,WAAQC,QAGAC,KAAM,0CACNC,OAAQH,EAAAA,WAAQwiE,WAGhBC,0BAA2B,WACvB,OACI1mE,cAAcC,aAAa8B,iBAInC4kE,mBAAoB,SAAUl8B,GAC1B,OAAQA,EAAKm8B,WACT,IAAK5mE,eAAcC,aAAa8B,eAC5BwC,KAAK8jE,iBAMjBvB,WAAY,WACRviE,KAAKi6B,WAAaj6B,KAAKmmC,OAAOq8B,cAAc/mE,cAAc4qC,MAAMC,MAAMC,WAAW3lC,KACjF,IAAM6hE,GAAgBziE,KAAKmmC,OAAOu8B,iBAAiBjnE,cAAcgrC,KAAKC,SAASC,cAAc/lC,KAC7FZ,MAAK0T,KAAO+uD,EAAc9yB,eAAiB8yB,EAAc9yB,cAAcj8B,MAG3EqwD,iBAAkB,SAAU3xD,EAAG6B,EAAGmrD,EAAQ1T,EAAQsY,EAAOhyD,EAAM+kC,GACvD2U,IACAA,EAAOhmD,KAAOsM,EAAK3M,WACnBqmD,EAAO1mD,SAAWgN,EAAKhN,SACvB0mD,EAAO4T,WAAattD,EAAKstD,WACzB5T,EAAO/2C,KAAO3C,EAAK3N,MACnBqnD,EAAO/c,SAAW38B,EAAK8oC,OACFx5C,SAAjBy1C,IACA2U,EAAO3U,aAAeA,IAI9B/2C,KAAK2oD,YAAYyW,EAAQ4E,IAG7Brb,YAAa,SAAUoX,EAAQrxD,GAC3B,GAAKqxD,EAAL,CADgC,GAIzB/5D,GAAiB+5D,EAAjB/5D,MAAOG,EAAU45D,EAAV55D,OACR89D,EAAYjkE,KAAK0T,KAAK8F,MAAM6E,cAAc3P,GAAOA,EAAM,IAC7DqxD,GAAOpX,YAAYsb,GACnBlE,EAAO/5D,MAAQA,EACf+5D,EAAO55D,OAASA,IAGpB+9D,OAAQ,WAAY,GAAAt+D,GAAA5F,KAEVu+D,EAAY,SAACxrD,EAAGiB,EAAGtF,EAAK1I,EAAOG,EAAQvG,GACzC,GAAMy/D,GAASz5D,EAAK8N,KAAK8F,MAAM6E,cAAc3P,GAAOA,EAAM,KACpDqxD,EAASn6D,EAAK8N,KAAKlR,IAAIu9D,OAAOhtD,EAAGiB,EAAGqrD,EAAQ8D,EAAnCv9D,EAAuD,EAAG,EAAG,EAAG,EAAGA,EAAKq0B,WAAWktB,SAIlG,OAHA4Y,GAAO/5D,MAAQA,EACf+5D,EAAO55D,OAASA,EAChB45D,EAAOngE,KAAOA,EACPmgE,GAGLiD,EAAiB,SAACjwD,EAAGiB,EAAGhO,EAAOG,EAAQ3C,EAASy/D,EAASrjE,GAC3D,GAAMwgE,MACFC,EAAK,EACTA,IAAM4C,EAAQ3D,WAAa2D,EAAQ3D,WAAa,IAAM,UACtDe,GAAM4C,EAAQj+D,SAAWsJ,SAAS20D,EAAQj+D,UAAY,MAAQ,GAC9Dq7D,GAAM4C,EAAQ59D,WAAa49D,EAAQ59D,WAAa,GAEhD+6D,EAAU16D,KAAO26D,EACjBD,EAAUzrD,KAAOsuD,EAAQ5+D,MACzB+7D,EAAUzf,aAAe,SACzByf,EAAUxf,aAAe,QACzB,IAAM58C,GAAM4B,EAAK8N,KAAKlR,IAAIwP,KAAK,EAAG,EAAGxO,EAAS48D,EAAWx6D,EAAKq0B,WAAWktB,SAIzE,OAHAnjD,GAAIpE,KAAOA,EACXoE,EAAI68C,cAAc9tC,EAAGiB,GAAKhQ,EAAImC,OAASmI,SAAS20D,EAAQj+D,WAAa,EAAGgB,EAAOG,GAC/E88D,EAAQnoB,SAAW92C,EAAI2qC,SAAU,GAC1B3qC,GAwBLm/D,EAAe,SAACp1D,EAAK+xD,GACvB,GAAIA,EAAQsD,cAAgBhnD,OAAOinD,YAAYC,QAA6B,IAAnBxD,EAAQC,OAGjE,OAAQhyD,EAAInO,MAKR,IAAK,iBACDgG,EAAKm+D,iBAAiB,KAAM,KAAMh2D,EAAKnI,EAAKq0B,WAAWktB,SAAS7G,UAAU,gBAAiB,WAAY6jB,GACvGv+D,EAAKq0B,WAAWktB,SAASxY,SAAU,EACnC/oC,EAAKq0B,WAAWwQ,eAAiB7kC,EAAKq0B,WAAWktB,UAAjDl8B,OAAAC,EAA8DtlB,EAAKq0B,WAAWwQ,gBAC9E7kC,EAAKq0B,WAAWiZ,UAChB,MACJ,KAAK,kBACDttC,EAAKq0B,WAAWq4B,QAAQ1sD,EAAKq0B,WAAWg8B,YACxCrwD,EAAKm+D,iBAAiB,KAAM,KAAMh2D,EAAKnI,EAAKq0B,WAAWktB,SAAS7G,UAAU,iBAAkB,YAAa6jB,GACzGv+D,EAAKq0B,WAAWktB,SAASxY,SAAU,CACnC,MACJ,KAAK,kBACD/oC,EAAKm+D,iBAAiB,KAAM,KAAMh2D,EAAKnI,EAAKq0B,WAAWktB,SAAS7G,UAAU,iBAAkB,YAAa6jB,GACzGv+D,EAAKq0B,WAAWiU,aAOtBk2B,EAAcpkE,KAAK0T,KAAKlR,IAAI6hE,WAAWrkE,KAAK0T,KAAKshC,MAAMhvC,MAAOhG,KAAK0T,KAAKshC,MAAM7uC,OACpFi+D,GAAYzvD,KAAK,EAAG,EAAG,EAAG,GAC1B,IAAM2vD,GAAUtkE,KAAK0T,KAAKlR,IAAIurD,OAAO,EAAG,EAAGqW,EAC3CE,GAAQt+D,MAAQhG,KAAK0T,KAAKshC,MAAMhvC,MAChCs+D,EAAQn+D,OAASnG,KAAK0T,KAAKshC,MAAM7uC,OACjCm+D,EAAQvtB,cAAe,EACvB/2C,KAAKi6B,WAAWktB,SAAS3kD,IAAI8hE,EAE7B,IAAMH,IACF9+D,WAAY,GACZL,SAAU,OACVX,MAAO,WAGLkgE,GACFl/D,WAAY,GACZL,SAAU,OACVX,MAAO,WAULmgE,EAAWjG,EAAUx7D,UAAUC,SAAW,GAAK,IAAKD,UAAUC,SAAW,IAAM,IAAK,WAAY,GAAI,GAAI,kBACxGyhE,EAAWzB,EAAejgE,UAAUC,SAAW,GAAK,IAAKD,UAAUC,SAAW,IAAM,IAAK,GAAI,GAAI,OAAQmhE,EAAa,eAE5HK,GAAStD,YAAY1+D,IAAIxC,KAAK+jE,iBAAkB/jE,KAAM,EAAGwkE,EAAUC,EAAU,yBAA0BF,GACvGC,EAASpD,YAAY5+D,IAAIxC,KAAK+jE,iBAAkB/jE,KAAM,EAAGwkE,EAAUC,EAAU,yBAA0BF,GACvGC,EAAStE,WAAW19D,IAAIxC,KAAK+jE,iBAAkB/jE,KAAM,EAAGwkE,EAAUC,EAAU,WAAYN,EAExF,IAAMO,GAAWnG,EAAUx7D,UAAUC,SAAW,IAAM,IAAKD,UAAUC,SAAW,IAAM,IAAK,YAAa,GAAI,GAAI,mBAC1G2hE,EAAW3B,EAAejgE,UAAUC,SAAW,IAAM,IAAKD,UAAUC,SAAW,IAAM,IAAK,GAAI,GAAI,OAAQmhE,EAAa,gBAE7HO,GAASxD,YAAY1+D,IAAIxC,KAAK+jE,iBAAkB/jE,KAAM,EAAG0kE,EAAUC,EAAU,yBAA0BJ,GACvGG,EAAStD,YAAY5+D,IAAIxC,KAAK+jE,iBAAkB/jE,KAAM,EAAG0kE,EAAUC,EAAU,yBAA0BJ,GACvGG,EAASxE,WAAW19D,IAAIxC,KAAK+jE,iBAAkB/jE,KAAM,EAAG0kE,EAAUC,EAAU,YAAaR,EAEzF,IAAMS,GAAWrG,EAAUx7D,UAAUC,SAAW,IAAM,IAAKD,UAAUC,SAAW,IAAM,IAAK,YAAa,GAAI,GAAI,mBAC1G6hE,EAAW7B,EAAejgE,UAAUC,SAAW,IAAM,IAAKD,UAAUC,SAAW,IAAM,IAAK,GAAI,GAAI,UAAWmhE,EAAa,gBAEhIS,GAAS1D,YAAY1+D,IAAIxC,KAAK+jE,iBAAkB/jE,KAAM,EAAG4kE,EAAUC,EAAU,yBAA0BN,GACvGK,EAASxD,YAAY5+D,IAAIxC,KAAK+jE,iBAAkB/jE,KAAM,EAAG4kE,EAAUC,EAAU,yBAA0BN,GACvGK,EAAS1E,WAAW19D,IAAIxC,KAAK+jE,iBAAkB/jE,KAAM,EAAG4kE,EAAUC,EAAU,YAAaV,GAEzFnkE,KAAKi6B,WAAWktB,SAASxY,SAAU,GAGvCm1B,aAAc,WACV9jE,KAAKi6B,WAAW8U,UACiC,IAA7C/uC,KAAKi6B,WAAWktB,SAASlW,SAAS5vC,QAClCrB,KAAKkkE,SAGTlkE,KAAK0T,KAAKshC,MAAM6V,WAAW7qD,KAAKi6B,WAAWktB,UAC3CnnD,KAAKi6B,WAAWktB,SAASxY,SAAU,KAQvC/tC,KAAM,uJC5MP,QAASkkE,GAAYpxD,EAAKX,EAAEiB,EAAEhO,EAAMG,EAAO6L,EAAK3N,EAAMyB,EAAKi/D,EAAOpB,GAErEvnD,OAAO4oD,MAAMh0C,KAAKhxB,KAAK0T,GAEvB1T,KAAK0T,KAAOA,EACZ1T,KAAKJ,KAAO,QACZI,KAAKilE,cAAgBvxD,EAAKI,OAAOoxD,WAGjCllE,KAAKmlE,eAAiBnjE,SAASM,cAAc,SAC7CtC,KAAKmlE,eAAeviE,MAAMwiE,SAAW,WACrCplE,KAAKmlE,eAAeviE,MAAMyiE,OAAS,IACnCrlE,KAAKmlE,eAAeviE,MAAMwB,OAAS,IACnCpE,KAAKmlE,eAAeviE,MAAMkQ,QAAU,IACpC9S,KAAKmlE,eAAeviE,MAAM0iE,KAAOvyD,EAAE,KACnC/S,KAAKmlE,eAAeviE,MAAMm2C,IAAM/kC,EAAE,KAClChU,KAAKmlE,eAAeviE,MAAMoD,MAAQA,EAAM,KACxChG,KAAKmlE,eAAeviE,MAAMuD,OAASA,EAAO,KAC1CnG,KAAKmlE,eAAeviE,MAAMyB,MAAQA,EAClCrE,KAAKmlE,eAAeviE,MAAMuB,gBAAkB,cAC5CnE,KAAKmlE,eAAeviE,MAAM2iE,YAAc,kDACxCvlE,KAAKmlE,eAAeviE,MAAM4iE,QAAU,OACpCxlE,KAAKmlE,eAAeviE,MAAMoC,SAAWc,EAAO,KAC5C9F,KAAKmlE,eAAeviE,MAAMyC,WAAa0/D,EACvC/kE,KAAKmlE,eAAeviE,MAAM08D,WAAaqE,EAAO,OAAS,SACvD3jE,KAAKilE,cAAcQ,aAAazlE,KAAKmlE,eAAezxD,EAAKI,QAEzD9T,KAAK0lE,GAAK3yD,EACV/S,KAAK2lE,GAAK3xD,EACVhU,KAAK4lE,OAAS5/D,EACdhG,KAAK6lE,QAAU1/D,EACfnG,KAAK8lE,UAAYhgE,EACjB9F,KAAKgS,KAAOA,EACZhS,KAAK+lE,SAAU,EAEfryD,EAAKlR,IAAIwjE,SAAShmE,MAClBA,KAAKimE,UAAUzjE,IAAI,SAAS69C,GAGxBrgD,KAAKilE,cAAc/iE,YAAYlC,KAAKmlE,iBACtCnlE,yDAxCU8kE,YAAAA,CAFhB,IAAApgE,GAAAjF,EAAA,+BA8CAqlE,GAAYxoD,UAAYa,OAAO8+C,OAAO7/C,OAAO4oD,MAAM1oD,WACnDwoD,EAAYxoD,UAAU09C,YAAc8K,EAEpCA,EAAYxoD,UAAU8/B,OAAU,WAE5B,GAAItoC,GAAS9T,KAAK0T,KAAKI,OAEnBoyD,EAAUpyD,EAAOqyD,WACjBC,EAAWtyD,EAAOuyD,UAClBC,EAAcxyD,EAAOxO,YACrBihE,EAAezyD,EAAOvO,YAE1B,IAAIvF,KAAKwmE,gBAAkBF,GAAetmE,KAAKymE,iBAAmBF,GAC3DvmE,KAAK0mE,YAAcR,GAAWlmE,KAAK2mE,YAAcP,EADxD,CAKA,GAAIQ,GAAY5mE,KAAK0T,KAAKshC,MAAMhvC,MAC5B6gE,EAAa7mE,KAAK0T,KAAKshC,MAAM7uC,MAEjC,IAAI2N,EAAOxO,YAAcwO,EAAOvO,aAAc,CAC1C,GAAIuhE,IAAc/jE,UAAUC,SAAWujE,EAAeD,GAAaM,EAC/DG,GAAehkE,UAAUC,SAAWsjE,EAAcC,GAAcM,EAEhEG,EAAShnE,KAAK0lE,GAAGkB,EACjBK,EAASjnE,KAAK2lE,GAAGkB,EAEjBK,EAAOnkE,UAAUC,SAAYkjE,EAAUI,EAAcA,EAAcW,EAAWf,EAAUI,EAAcU,EACtGG,EAAOpkE,UAAUC,SAAYojE,EAAUG,EAAeS,EAAWZ,EAAUG,EAAeU,EAC1FG,EAAWpnE,KAAK4lE,OAASkB,EACzBO,EAAYrnE,KAAK6lE,QAAUkB,EAC3B/hE,EAAWhF,KAAK8lE,UAAYiB,CAGhC/mE,MAAKsnE,QAAQvkE,UAAUC,SAAYkkE,EAAOE,EAAS,EAAIC,EAAU,EAAKH,GACtElnE,KAAKunE,OAAOxkE,UAAUC,SAAYmkE,EAAOC,EAAW,EAAIC,EAAY,EAAKF,GACzEnnE,KAAKwnE,SAASJ,GACdpnE,KAAKynE,UAAUJ,GACfrnE,KAAK0nE,YAAY1iE,GACjBhF,KAAKmlE,eAAeviE,MAAMC,UAAYE,UAAUC,SAAW,gBAAkB,mBAE5E,CACD,GAAI8jE,IAAc/jE,UAAUC,SAAWsjE,EAAcC,GAAcK,EAC/DG,GAAehkE,UAAUC,SAAWujE,EAAeD,GAAaO,EAEhEG,EAAShnE,KAAK0lE,GAAGkB,EACjBK,EAASjnE,KAAK2lE,GAAGkB,EAEjBK,EAAOnkE,UAAUC,SAAYkjE,EAAUI,EAAcU,EAAWd,EAAUI,EAAcA,EAAcW,EACtGE,EAAOpkE,UAAUC,SAAYojE,EAAUG,EAAeU,EAAWb,EAAUG,EAAeS,EAC1FI,EAAWpnE,KAAK4lE,OAASkB,EACzBO,EAAYrnE,KAAK6lE,QAAUkB,EAC3B/hE,EAAWhF,KAAK8lE,UAAYiB,CAEhC/mE,MAAKsnE,QAAQvkE,UAAUC,SAAWkkE,EAAQA,EAAOE,EAAS,EAAIC,EAAU,GACxErnE,KAAKunE,OAAOxkE,UAAUC,SAAWmkE,EAAQA,EAAOC,EAAW,EAAIC,EAAY,GAC3ErnE,KAAKwnE,SAASJ,GACdpnE,KAAKynE,UAAUJ,GACfrnE,KAAK0nE,YAAY1iE,GAEjBhF,KAAKmlE,eAAeviE,MAAMC,UAAYE,UAAUC,SAAW,eAAiB,gBAGhFhD,KAAKwmE,eAAiBF,EACtBtmE,KAAKymE,gBAAkBF,EACvBvmE,KAAK0mE,WAAaR,EAClBlmE,KAAK2mE,WAAaP,IAGtBtB,EAAYxoD,UAAUK,QAAU,WAC5B3c,KAAKilE,cAAc/iE,YAAYlC,KAAKmlE,iBAGxCL,EAAYxoD,UAAU+tC,KAAO,SAAUsd,GACnC3nE,KAAKmlE,eAAeviE,MAAMglE,WAAaD,EAAQ,UAAY,UAG/D7C,EAAYxoD,UAAUurD,iBAAmB,SAAUx9D,GAAU,GAAAzE,GAAA5F,KACnD8nE,EAAc,WAChBliE,EAAKmiE,MAAQniE,EAAKu/D,eAAe3kD,MACjC/Y,EAAAA,WAAMypB,eAAe7T,QAAQ,SAAA2qD,GACzB,GAAoB,IAAhBA,EAAK3mE,OAAT,CAEA,GAAI+D,GAAQQ,EAAKmiE,MAAM3tD,QAAQ4tD,EAC/B,IAAI5iE,OAAc,CACd,GAAI6iE,GAAK,IAAIC,OAAOF,EAAK3mE,OACzBuE,GAAKmiE,MAAQniE,EAAKmiE,MAAMtxD,QAAQ,GAAIN,QAAO6xD,EAAM,MAAOC,GACxDriE,EAAKu/D,eAAe3kD,MAAQ5a,EAAKmiE,UAGzC19D,EAASzE,EAAKmiE,OAElB,IAAyB,QAArBhlE,UAAU+L,QAAoBwF,UAAU+G,UAAUjB,QAAQ,aAAgB,CAO1E,GAAIoiD,GAASloD,UAAU+G,UAAU2Q,MAAM,gDACnCwwC,KAAWA,EAAO,IAAM,wBAAwC,yBAAdA,EAAO,IACzDx8D,KAAKmlE,eAAe/pD,iBAAiB,QAAS0sD,GAAa,GAE3D9nE,KAAKmlE,eAAe/pD,iBAAiB,iBAAkB,WACnDxV,EAAKu/D,eAAejqD,oBAAoB,QAAS4sD,GAAa,GAC9DliE,EAAKu/D,eAAe/pD,iBAAiB,QAAS0sD,GAAa,KAC5D,OAGP9nE,MAAKmlE,eAAe/pD,iBAAiB,QAAS0sD,GAAa,EAG/D9nE,MAAKmlE,eAAegD,OAAS,WACzB,GAAIviE,EAAKmgE,QAAS,CACd,GAAIp2D,GAAIu9C,WAAWtnD,EAAKmiE,MACxBp4D,GAAI/J,EAAKoM,KAAOrC,EAAI,GAAK/J,EAAKoM,KAAO,OAKjD8yD,EAAYxoD,UAAU8rD,iBAAmB,SAAU/9D,GAAU,GAAAuG,GAAA5Q,IACzDA,MAAKmlE,eAAe/pD,iBAAiB,QAAS,WAAO/Q,EAAAA,KAAkB,IAI3Ey6D,EAAYxoD,UAAUgrD,QAAU,SAAUhC,GACtCtlE,KAAKmlE,eAAeviE,MAAM0iE,KAAOA,EAAK,MAG1CR,EAAYxoD,UAAUirD,OAAS,SAAUxuB,GACrC/4C,KAAKmlE,eAAeviE,MAAMm2C,IAAMA,EAAI,MAIxC+rB,EAAYxoD,UAAUkrD,SAAW,SAASxhE,GACtChG,KAAKmlE,eAAeviE,MAAMoD,MAAQA,EAAM,MAI5C8+D,EAAYxoD,UAAUmrD,UAAY,SAASthE,GACvCnG,KAAKmlE,eAAeviE,MAAMuD,OAASA,EAAO,MAI9C2+D,EAAYxoD,UAAUorD,YAAc,SAAU1iE,GAC1ChF,KAAKmlE,eAAeviE,MAAMoC,SAAWA,EAAW,MAIpD8/D,EAAYxoD,UAAU+rD,UAAY,SAAUxxB,GACxC72C,KAAKmlE,eAAemD,YAAczxB,GAAUpsC,YAIhD0S,OAAOorD,eAAezD,EAAYxoD,UAAU,KAEpCzB,IAAI,WAEA,MAAO7a,MAAK0lE,IAEhBvgD,IAAI,SAAS3E,GAETxgB,KAAKsnE,QAAQ9mD,GACbxgB,KAAK0lE,GAAKllD,KAItBrD,OAAOorD,eAAezD,EAAYxoD,UAAU,KAEpCzB,IAAI,WAEA,MAAO7a,MAAK2lE,IAEhBxgD,IAAI,SAAS3E,GAETxgB,KAAKunE,OAAO/mD,GACZxgB,KAAK2lE,GAAKnlD,KAKtBrD,OAAOorD,eAAezD,EAAYxoD,UAAU,SAEpCzB,IAAI,WAEA,MAAO7a,MAAK4lE,QAEhBzgD,IAAI,SAAS3E,GAETxgB,KAAKwnE,SAAShnD,GACdxgB,KAAK4lE,OAASplD,KAK1BrD,OAAOorD,eAAezD,EAAYxoD,UAAU,UAEpCzB,IAAI,WAEA,MAAO7a,MAAK6lE,SAEhB1gD,IAAI,SAAS3E,GAETxgB,KAAKynE,UAAUjnD,GACfxgB,KAAK6lE,QAAUrlD,KAK3BrD,OAAOorD,eAAezD,EAAYxoD,UAAU,YAEpCzB,IAAI,WACA,MAAO7a,MAAK8lE,WAEhB3gD,IAAI,SAAU3E,GACVxgB,KAAK0nE,YAAYlnD,GACjBxgB,KAAK8lE,UAAYtlD,KAK7BrD,OAAOorD,eAAezD,EAAYxoD,UAAU,SAEpCzB,IAAI,WAEA,MAAO7a,MAAKwoE,QAEhBrjD,IAAI,SAAS3E,GAET,IAAI,GAAI9R,KAAO8R,GAEXxgB,KAAKmlE,eAAeviE,MAAM8L,GAAO8R,EAAM9R,EAE3C1O,MAAKwoE,OAAShoD,KAK1BrD,OAAOorD,eAAezD,EAAYxoD,UAAU,QAEpCzB,IAAI,WAEA,MAAO7a,MAAK+nE,OAEhB5iD,IAAI,SAAS3E,GAETxgB,KAAKmlE,eAAe3kD,MAAQA,EAC5BxgB,KAAK+nE,MAAQvnD,KAKzBrD,OAAOorD,eAAezD,EAAYxoD,UAAU,YAEpCzB,IAAI,WAEA,MAAO7a,MAAKsoE,UAEhBnjD,IAAI,SAAS3E,GAETxgB,KAAKqoE,UAAU7nD,GACfxgB,KAAKmlE,eAAemD,YAAc9nD,GAAO/V,0JChTrD,GAAAjL,GAAAC,EAAA,kBACA6nC,EAAA7nC,EAAA,mCACAC,GAAAA,WAAQC,QAGAC,KAAM,+CACNC,OAAQH,EAAAA,WAAQwiE,WAGhBC,0BAA2B,WACvB,OACI1mE,cAAcC,aAAa0B,sBAInCglE,mBAAoB,SAAUl8B,GAC1B,GAAMjkC,GAAOikC,EAAKuiC,SAClB,QAAQviC,EAAKm8B,WACT,IAAK5mE,eAAcC,aAAa0B,oBAC5B4C,KAAK0oE,kBAAkBzmE,KAMnCsgE,WAAY,WACRviE,KAAKi6B,WAAaj6B,KAAKmmC,OAAOq8B,cAAc/mE,cAAc4qC,MAAMC,MAAMC,WAAW3lC,MACjFZ,KAAKyiE,cAAgBziE,KAAKmmC,OAAOu8B,iBAAiBjnE,cAAcgrC,KAAKC,SAASC,cAAc/lC,MAC5FZ,KAAK0T,KAAO1T,KAAKyiE,cAAc9yB,eAAiB3vC,KAAKyiE,cAAc9yB,cAAcj8B,KACjF1T,KAAK2vC,cAAgB3vC,KAAKyiE,cAAc9yB,cACxC3vC,KAAK2oE,WAAY,GAKrBC,YAAa,WAAY,GAAAhjE,GAAA5F,KAAA4iE,EACwD5iE,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKmD,SAA9G5kC,EADc0+D,EACd1+D,WAAY0tC,EADEgxB,EACFhxB,OAAQ7I,EADN65B,EACM75B,KAAMz3B,EADZsxD,EACYtxD,KAAM03B,EADlB45B,EACkB55B,SAAUG,EAD5By5B,EAC4Bz5B,SAAUF,EADtC25B,EACsC35B,SAAU/nB,EADhD0hD,EACgD1hD,KAE/D2nD,EAAiB,SAAChK,EAAU9rD,EAAGiB,EAAGhO,EAAOG,EAAQ3C,EAASs7D,GAC5D,GAAM95D,GAAW65D,EAAS75D,SAAWsJ,SAASuwD,EAAS75D,UAAY,GAC7DX,EAAQw6D,EAASx6D,MAAQw6D,EAASx6D,MAAQ,UAE1C0kD,EAAKnjD,EAAKq0B,WAAW6V,UAAUpqC,KAAKI,KAAOF,EAAKq0B,WAAW+uB,sBAAsBhkD,GAAYA,EAC7FikD,EAAKrjD,EAAKq0B,WAAW6V,UAAUpqC,KAAKI,KAAOF,EAAKq0B,WAAWivB,qBAAqBlkD,GAAYA,EAC5F6W,EAAIotC,EAAKzlD,EAAQnC,OACjBuO,EAAImD,GAAK/M,EAAQ6V,GAAK,EACtBgb,EAAI7iB,GAAK7N,EAAS4iD,GAAM,EACxBsC,EAASzlD,EAAKq0B,WAAWixB,aAAat7C,EAAGinB,EAAGhb,EAAGktC,EAAIvlD,EACzD6nD,GAAO4C,MAAkB,YAAV5pD,EAAsB,UAAYA,GAAOoS,QAAQ,IAAK,MAErEqoD,EAAQ5Q,SAAS7C,GACjByT,EAAQ9sD,KAAO,KAEbgxD,EAAiB,SAACjwD,EAAGiB,EAAGhO,EAAOG,EAAQ3C,EAASy/D,EAASrjE,GAC3D,GAAMwgE,MACFC,EAAK,EACTA,IAAM4C,EAAQ3D,WAAa2D,EAAQ3D,WAAa,IAAM,UACtDe,GAAM4C,EAAQj+D,SAAWsJ,SAAS20D,EAAQj+D,UAAY,MAAQ,GAC9Dq7D,GAAMz6D,EAAKq0B,WAAW6V,UAAUpqC,KAAOE,EAAKq0B,WAAW6V,UAAUpqC,KAAKL,WAAa49D,EAAQ59D,WAAa49D,EAAQ59D,WAAa,GAE7H+6D,EAAU16D,KAAO26D,EACjBD,EAAUzrD,KAAOsuD,EAAQ5+D,MACzB+7D,EAAUzf,aAAe,SACzByf,EAAUxf,aAAe,SACzBwf,EAAUvrD,OAASouD,EAAQpuD,OAC3BurD,EAAUvtD,gBAAkBowD,EAAQpuD,OAAS,EAAI,CAEjD,IAAM7Q,GAAM4B,EAAK+pC,cAAcj8B,KAAKlR,IAAIwP,KAAK,EAAG,EAAGxO,EAAS48D,EAAWx6D,EAAKq0B,WAAW2Y,cAUvF,OATA5uC,GAAIpE,KAAOA,EACP8wC,EAAAA,WAAUrrC,WACVwjE,EAAe5F,EAASlwD,EAAGiB,EAAGhO,EAAOG,EAAQ3C,EAASQ,GAGtDA,EAAI68C,cAAc9tC,EAAGiB,GAAKhQ,EAAImC,OAASmI,SAAS20D,EAAQj+D,WAAa,EAAGgB,EAAOG,GAGnF88D,EAAQnoB,SAAW92C,EAAI2qC,SAAU,GAC1B3qC,GAELu6D,EAAY,SAACxwD,EAAKnO,EAAMoS,GAC1B,GAAM6kB,KACNA,GAAEkI,OAAShxB,EAAIgxB,OAAO/sB,KACtB6kB,EAAEmI,OAASjxB,EAAIixB,OAAOhtB,KACtB6kB,EAAE7kB,KAAOA,CACT,IAAMutD,GAAW35D,EAAK+pC,cAAc4uB,UAAUxwD,EAAIygD,KAAKz7C,EACnDhF,EAAIygD,KAAKx6C,EACTjG,EAAIygD,KAAKxoD,MACT+H,EAAIygD,KAAKroD,OACT4H,EAAIgxB,OAAO76B,WAAWwC,IACtBqH,EAAIixB,OAAO96B,WAAWwC,IACtBy8D,EACAtsC,EACAjxB,EAAKq0B,WAAWq/B,UAChB15D,EACAgG,EAAKq0B,WAAW2Y,cAEpB2sB,GAASQ,OAAOI,UAAU39D,IAAI,WAAA,MAAMoD,GAAKq0B,WAAWq/B,WAAa1zD,EAAKq0B,WAAWq/B,UAAU9gD,UAGzF2qD,EAAe,SAACp1D,EAAK+xD,GACnBA,EAAQsD,cAAgBhnD,OAAOinD,YAAYC,QAA6B,IAAnBxD,EAAQC,SAGzC,yBAApBhyD,EAAIlO,OAAOD,KAEXgG,EAAKq0B,WAAWsf,2BAES,yBAApBxrC,EAAIlO,OAAOD,KAEhBgG,EAAKq0B,WAAWyf,2BAES,6BAApB3rC,EAAIlO,OAAOD,KAEhBgG,EAAKq0B,WAAW0f,+BAES,6BAApB5rC,EAAIlO,OAAOD,KAEhBgG,EAAKq0B,WAAW2f,+BAES,6BAApB7rC,EAAIlO,OAAOD,KAEhBgG,EAAKq0B,WAAW8f,+BAES,yBAApBhsC,EAAIlO,OAAOD,MAEhBgG,EAAKq0B,WAAW6f,6BAIlB3D,EAAKn2C,KAAK2vC,cAAcj8B,KAAKlR,IAAI0wB,MAAM,EAAG,EAAGlzB,KAAK2vC,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAcna,EAAWwC,MAAQxC,EAAWwC,IAOlI,IANAyvC,EAAGnwC,MAAQhG,KAAK2vC,cAAcj8B,KAAKshC,MAAMhvC,MACzCmwC,EAAGhwC,OAASnG,KAAK2vC,cAAcj8B,KAAKshC,MAAM7uC,OAC1CgwC,EAAGY,cAAe,EAClB/2C,KAAKi6B,WAAW2Y,cAAcpwC,IAAI2zC,GAG9Bn2C,KAAK2vC,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAcuzB,EAAO1tC,WAAWwC,KAAM,CACzE,GAAMoiE,GAAO9oE,KAAKi6B,WAAW2Y,cAAcqpB,OAAOrqB,EAAO4c,KAAKz7C,EACxD6+B,EAAO4c,KAAKx6C,EACZ49B,EAAO1tC,WAAWwC,IACxBoiE,GAAK9iE,MAAQ4rC,EAAO4c,KAAKxoD,MACzB8iE,EAAK3iE,OAASyrC,EAAO4c,KAAKroD,OAEzByrC,EAAO9wC,MAAMkR,KAAK8oC,QACnBkoB,EAAepxB,EAAO9wC,MAAM0tD,KAAKz7C,EAAI6+B,EAAO4c,KAAKz7C,EAC3C6+B,EAAO9wC,MAAM0tD,KAAKx6C,EAAI49B,EAAO4c,KAAKx6C,EAClC49B,EAAO9wC,MAAM0tD,KAAKxoD,MAClB4rC,EAAO9wC,MAAM0tD,KAAKroD,OAClBnG,KAAKi6B,WAAWuO,UAAUM,SAC1B8I,EAAO9wC,MAAMkR,KACb,wBAIL+2B,EAAK+R,QACNyjB,EAAUx1B,EAAM,uBAAwB/oC,KAAKi6B,WAAWuO,UAAUO,MAIjEz3B,EAAKwpC,QACNyjB,EAAUjtD,EAAM,uBAAwBtR,KAAKi6B,WAAWuO,UAAUl3B,MAIjE03B,EAAS8R,QACVyjB,EAAUv1B,EAAU,2BAA4BhpC,KAAKi6B,WAAWuO,UAAUQ,UAIzEC,EAAS6R,QACVyjB,EAAUt1B,EAAU,2BAA4BjpC,KAAKi6B,WAAWuO,UAAUS,UAIzEE,EAAS2R,QACVyjB,EAAUp1B,EAAU,2BAA4BnpC,KAAKi6B,WAAWuO,UAAUW,UAIzEjoB,EAAK45B,QACNyjB,EAAUr9C,EAAM,uBAAwBlhB,KAAKi6B,WAAWuO,UAAUtnB,MAEtElhB,KAAKi6B,WAAW2Y,cAAcjE,SAAU,EACrC5F,EAAK+R,QAAUxpC,EAAKwpC,QAAU9R,EAAS8R,QAAU3R,EAAS2R,QAAU55B,EAAK45B,SAExE96C,KAAK2oE,WAAY,IAMzBI,kBAAkB,WAAY,GAAAn4D,GAAA5Q,KACTgpE,EAAgBhpE,KAAKi6B,WAAW6V,UAAUkV,iBAApDlc,SACHqN,EAAKn2C,KAAK2vC,cAAcj8B,KAAKlR,IAAI+9C,SAAS,EAAG,EAAGvgD,KAAKi6B,WAAW2Y,cACpEuD,GAAGqK,UAAU,EAAK,GAClBrK,EAAGsK,SAAS,EAAG,EAAGzgD,KAAK2vC,cAAcj8B,KAAKshC,MAAMhvC,MAAOhG,KAAK2vC,cAAcj8B,KAAKshC,MAAM7uC,QACrFgwC,EAAGuK,UACHvK,EAAGY,cAAe,EAClB/2C,KAAKyiE,cAAcwG,gBAAgBD,EAAa/lB,IAAK+lB,EAAal4B,OAAQ9wC,KAAKi6B,WAAWoQ;AAC1F,GAAI6+B,GAAWlpE,KAAKyiE,cAAc0G,QAAQnpE,KAAKi6B,WAAW2Y,cAAeo2B,EAAa/lB,IAAK+lB,EAAarmB,aAClGqmB,EAAaj2D,EAAGi2D,EAAah1D,EAAGg1D,EAAal4B,QAAO,GAAM,GAAM,EACtEo4B,GAASvY,QAAS,CAElB,IAAMyY,GAAiB,WACnB,GAAMC,GAAe,QAAfA,GAAe5iC,GACK,UAAlBA,EAAKoc,WACLjyC,EAAKqpB,WAAWuR,UAAU56B,EAAKqpB,WAAWuR,UAAUnqC,QAAUolC,EAAK7mC,MAEvE6mC,EAAKwK,SAAS5zB,QAAQ,SAAA1N,GAAM05D,EAAa15D,KAE7Cu5D,GAASj4B,SAAS5zB,QAAQ,SAAA1N,GAAM05D,EAAa15D,KAEjDy5D,KACAppE,KAAKyiE,cAAc6G,mBAGvBZ,kBAAmB,SAAUv+D,GACrBnK,KAAKi6B,WAAW2Y,cAAc3B,SAAS5vC,OAAS,GAAKrB,KAAKi6B,WAAW6V,UAAUkV,iBAAiBlc,UAEhG9oC,KAAKi6B,WAAW2Y,cAAc8X,WAAU,GAEU,IAAlD1qD,KAAKi6B,WAAW2Y,cAAc3B,SAAS5vC,SACnCrB,KAAKi6B,WAAW6V,UAAUkV,iBAAiBlc,SAC3C9oC,KAAK+oE,oBAEL/oE,KAAK4oE,cAGb,IAAMW,GAAavpE,KAAKi6B,WAAW2Y,cAAc0N,UAAU,4BACrDgH,EAAWiiB,EAAaA,EAAWjpB,UAAU,QAAUh/C,MAC7D,IAAI6I,EAAQ0vC,MACR,GAAIyN,EACA,GAAI5W,EAAAA,WAAUrrC,WAAY,CACtB,GAAM05D,GAAYzX,EAASrW,SAAS,EACpC,IAAI8tB,EAAW,CAAA,GAGJ91B,GAAYjpC,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKmD,SAApDG,SACD8f,EAAK/oD,KAAKi6B,WAAW6V,UAAUpqC,KAAKI,KAAO9F,KAAKi6B,WAAW+uB,sBAAsB/f,EAASlK,OAAO/sB,KAAKhN,UAAYikC,EAASlK,OAAO/sB,KAAKhN,SACvIikD,EAAKjpD,KAAKi6B,WAAW6V,UAAUpqC,KAAKI,KAAO9F,KAAKi6B,WAAWivB,qBAAqBjgB,EAASlK,OAAO/sB,KAAKhN,UAAYikC,EAASlK,OAAO/sB,KAAKhN,SACtI6W,EAAIotC,EAAKjpD,KAAKi6B,WAAWuO,UAAUU,WAAW7nC,OAC9C0R,GAAKk2B,EAASulB,KAAKxoD,MAAQ6V,GAAK,EAChC7H,GAAKi1B,EAASulB,KAAKroD,OAAS4iD,GAAM,CACxC/oD,MAAKi6B,WAAWkvB,mBAAmBpoD,KAAMf,KAAKi6B,WAAWuO,UAAUU,aAAc+f,EAAIF,EAAIzB,EAAUn9C,GACnGm9C,EAASrW,SAAS,GAAGl+B,EAAIA,EACzBu0C,EAASrW,SAAS,GAAGj9B,EAAIA,EACzB+qD,EAAU9tB,SAAS5zB,QAAQ,SAAArU,GAAA,MAAQA,GAAKsiD,QAAQ3uC,YAChDoiD,EAAUpiD,UACV2qC,EAASt1C,KAAO,SAIpBs1C,GAASt1C,KAAOhS,KAAKi6B,WAAWuO,UAAUU,eAKlD,IAAIoe,EACA,GAAI5W,EAAAA,WAAUrrC,WAAY,CACtB,GAAM05D,GAAYzX,EAASrW,SAAS,EACpC,IAAI8tB,EAAW,CAAA,GAGJ91B,GAAYjpC,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKmD,SAApDG,SACD8f,EAAK/oD,KAAKi6B,WAAW6V,UAAUpqC,KAAKI,KAAO9F,KAAKi6B,WAAW+uB,sBAAsB/f,EAASlK,OAAO/sB,KAAKhN,UAAYikC,EAASlK,OAAO/sB,KAAKhN,SACvIikD,EAAKjpD,KAAKi6B,WAAW6V,UAAUpqC,KAAKI,KAAO9F,KAAKi6B,WAAWivB,qBAAqBjgB,EAASlK,OAAO/sB,KAAKhN,UAAYikC,EAASlK,OAAO/sB,KAAKhN,SACtI6W,EAAIotC,EAAKjpD,KAAKi6B,WAAWuO,UAAUS,SAAS5nC,OAC5C0R,GAAKk2B,EAASulB,KAAKxoD,MAAQ6V,GAAK,EAChC7H,GAAKi1B,EAASulB,KAAKroD,OAAS4iD,GAAM,CACxC/oD,MAAKi6B,WAAWkvB,mBAAmBpoD,KAAMf,KAAKi6B,WAAWuO,UAAUS,WAAYggB,EAAIF,EAAIzB,EAAUn9C,GACjGm9C,EAASrW,SAAS,GAAGl+B,EAAIA,EACzBu0C,EAASrW,SAAS,GAAGj9B,EAAIA,EACzB+qD,EAAU9tB,SAAS5zB,QAAQ,SAAArU,GAAA,MAAQA,GAAKsiD,QAAQ3uC,YAChDoiD,EAAUpiD,UACV2qC,EAASt1C,KAAO,SAIpBs1C,GAASt1C,KAAOhS,KAAKi6B,WAAWuO,UAAUS,QAItDjpC,MAAK2vC,cAAcj8B,KAAKshC,MAAM6V,WAAW7qD,KAAKi6B,WAAW2Y,eACzD5yC,KAAKi6B,WAAW2Y,cAAcjE,SAAU,EACrC3uC,KAAK2oE,aAAc,GAClB3oE,KAAKi6B,WAAW6f,8BASxBl5C,KAAM,mBACL+nE,WAAY,gJCvSrB,GAAAnpE,GAAAC,EAAA,kBACAs6D,EAAAt6D,EAAA,mCACA6nC,EAAA7nC,EAAA,iCAEAC,GAAAA,WAAQC,QAGAC,KAAM,+CACNC,OAAQH,EAAAA,WAAQwiE,WAGhBC,0BAA2B,WACvB,OACI1mE,cAAcC,aAAa4B,oBAC3B7B,cAAcC,aAAa2D,uBAInC+iE,mBAAoB,SAAUl8B,GAC1B,OAAQA,EAAKm8B,WACT,IAAK5mE,eAAcC,aAAa4B,oBAC5B0C,KAAK2yC,aAAezM,EAAKuiC,UACzBzoE,KAAKwpE,mBACL,MACJ,KAAK/tE,eAAcC,aAAa2D,qBAC5B,GAAM4C,GAAOikC,EAAKuiC,SAClBzoE,MAAKypE,mBAAmBxnE,KAOpCsgE,WAAY,WACRviE,KAAKi6B,WAAaj6B,KAAKmmC,OAAOq8B,cAAc/mE,cAAc4qC,MAAMC,MAAMC,WAAW3lC,KACjF,IAAM6hE,GAAgBziE,KAAKmmC,OAAOu8B,iBAAiBjnE,cAAcgrC,KAAKC,SAASC,cAAc/lC,KAC7FZ,MAAK0T,KAAO+uD,EAAc9yB,eAAiB8yB,EAAc9yB,cAAcj8B,KACvE1T,KAAK2vC,cAAgB8yB,EAAc9yB,eAGvCqzB,eAAgB,SAAUjwD,EAAGiB,EAAGhO,EAAOG,EAAQ3C,EAASy/D,GACpD,GAAM7C,IAAazf,aAAc,SAAUC,aAAc,SAAU3uC,UAAU,GACzEouD,EAAK,EACTA,IAAM4C,EAAQ3D,WAAa2D,EAAQ3D,WAAa,IAAM,UACtDe,GAAM4C,EAAQj+D,SAAWsJ,SAAS20D,EAAQj+D,UAAY,MAAQ,GAC9Dq7D,GAAM4C,EAAQ59D,WAAa49D,EAAQ59D,WAAa,KAEhD+6D,EAAU16D,KAAO26D,EACjBD,EAAUzrD,KAAOsuD,EAAQ5+D,MACzB+7D,EAAUrqD,cAAgB/P,EACtBhG,KAAKi6B,WAAWuO,UAAUtnB,OAAS1d,GACnC48D,EAAUzf,aAAe,SACzByf,EAAUxf,aAAe,WAEzBwf,EAAUzf,aAAe,OACzByf,EAAUxf,aAAe,MAE7B,IAAM58C,GAAMhE,KAAK0T,KAAKlR,IAAIwP,KAAK,EAAG,EAAGxO,EAAS48D,EAAWpgE,KAAKi6B,WAAWwwB,cAEzE,OADAzmD,GAAI68C,cAAc9tC,EAAGiB,GAAKhQ,EAAImC,OAASmI,SAAS20D,EAAQj+D,UAAY,KAAO,EAAGgB,EAAOG,GAC9EnC,GAGX0lE,YAAa,WAAY,GAAA9jE,GAAA5F,KAAA4iE,EACiB5iE,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKqD,SAAvEkJ,EADc0wB,EACd1wB,UAAWhxB,EADG0hD,EACH1hD,KAAMhd,EADH0+D,EACG1+D,WAGlBiyC,EAAKn2C,KAAKi6B,WAAWwwB,cAAcwR,OAAO,EAAG,EAAGj8D,KAAK0T,KAAKpC,KAAKkI,MAAM6E,cAAcna,EAAWwC,MAAQxC,EAAWwC,IACvHyvC,GAAGnwC,MAAQhG,KAAK0T,KAAKshC,MAAMhvC,MAC3BmwC,EAAGhwC,OAASnG,KAAK0T,KAAKshC,MAAM7uC,OAC5BgwC,EAAGY,cAAe,CAElB,IAAM4yB,GAAOz3B,EAAUsc,KAAKz7C,EACtB62D,EAAO13B,EAAUsc,KAAKx6C,EACtB61D,EAAW33B,EAAUsc,KAAKxoD,MAC1B8jE,EAAY53B,EAAUsc,KAAKroD,OAC3B4jE,EAAiB5sD,OAAO8d,QAAQloB,EAAG,EAAGiB,EAAG,EAAGhO,MAAO6jE,EAAU1jE,OAAQ2jE,GAAY53B,EAAUhuC,WAAWsqD,MAEtGwb,EAAWhqE,KAAKi6B,WAAWwwB,cAAcwR,OAAO0N,EAAOI,EAAeh3D,EACxE62D,EAAOG,EAAe/1D,EACtBhU,KAAK0T,KAAKpC,KAAKkI,MAAM6E,cAAc6zB,EAAUhuC,WAAWwC,MAAQwrC,EAAUhuC,WAAWwC,IACzFsjE,GAAShkE,MAAQ+jE,EAAe/jE,MAChCgkE,EAAS7jE,OAAS4jE,EAAe5jE,MAEjC,IAAM8jE,GAAajqE,KAAK0T,KAAKlR,IAAIurD,OAAO,EAAG,GACrCmc,EAAUP,EACVQ,EAAUP,CAChBK,GAAWl3D,EAAIm3D,EACfD,EAAWj2D,EAAIm2D,EACfF,EAAWrqE,KAAO,aAClBI,KAAKi6B,WAAWwwB,cAAcjoD,IAAIynE,EAGlC,IACMG,IADYl4B,EAAUlpC,KAAKwlD,KAAKxoD,MACnBksC,EAAUlpC,KAAKwlD,KAAKroD,QACjCkkE,EAASnjE,KAAK2M,IAAIu2D,EAAal4B,EAAUlpC,KAAKxF,QAAQgrD,KAAKroD,OAAQ,GACrEmkE,EAAkB,EAClBC,EAAa,KACbC,GAAa,EACXC,EAAS,SAAC3K,EAAS/sD,EAAGiB,GACxB,GAAM02D,GAAQC,EAAS7K,GACjB8K,EAAiB,WAAWtiE,KAAKgM,UAAU+G,WAAc,iBAAmB,YAC7EqvD,GAOIF,IACDxoE,SAASoZ,iBAAiBwvD,EAAeC,GACzCL,GAAa,GARbA,IACAxoE,SAASkZ,oBAAoB0vD,EAAeC,GAC5CL,GAAa,IAUnBM,EAAW,SAAC/3D,EAAGiB,GACjB,GAAM7N,GAAS8jE,EAAWh5B,SAAS5vC,OAAS+oE,EAAaC,CACzD,OAAIlkE,GAAS2jE,OACTG,EAAWj2D,EAAI41D,IAGf72D,IAAM42D,IACNM,EAAWl3D,EAAI42D,QAEf31D,EAAI41D,EACJK,EAAWj2D,EAAI41D,EAEV51D,EAAI7N,EAASyjE,EAAOE,EACzBG,EAAWj2D,EAAI41D,EAAOE,EAAY3jE,EAGlC8jE,EAAWj2D,EAAIA,KAGjB+2D,EAAe,SAAChd,EAAQ+R,EAAS/sD,EAAGiB,EAAGg3D,EAAIC,GAC7C,GAAIC,GAAKn4D,EACLo4D,EAAKn3D,CACTi3D,KAAeX,EAAkBv3D,GACjCw3D,EAAaN,EAAWj2D,EACpBhS,SAASC,KAAKS,YAAcV,SAASC,KAAKU,cAA+B,OAAf4nE,IAC1DY,EAAKZ,EAAax3D,EAAIu3D,GAE1BQ,EAASI,EAAIC,IAEXR,EAAW,SAAC7K,GACd,GAAI/sD,GAAAA,OAAGiB,EAAAA,OACH6H,EAAKrgB,OAAO0rC,YAAcllC,SAASmlC,gBAAgBzkC,aAAeV,SAASC,KAAKS,YAChFkQ,EAAKpX,OAAO4rC,aAAeplC,SAASmlC,gBAAgBxkC,cAAgBX,SAASC,KAAKU,YAmBtF,OAlBIkZ,GAAIjJ,EACD7P,UAAUC,UACT+P,EAAI+sD,EAAQsL,OACZp3D,GAAK8rD,EAAQuL,SAEbt4D,EAAI+sD,EAAQuL,OACZr3D,EAAI8rD,EAAQsL,QAIbroE,UAAUC,UACT+P,EAAI+sD,EAAQuL,OACZr3D,EAAI8rD,EAAQsL,SAEZr4D,EAAI+sD,EAAQsL,OACZp3D,GAAK8rD,EAAQuL,QAGjBr3D,EAAIm2D,GAAWn2D,EAAYm2D,EAAUL,GACrC/2D,EAAIm3D,GAAWn3D,EAAYm3D,EAAUL,EAC9B,MAEH92D,EAAAA,EAAGiB,EAAAA,IAETotD,EAAc,SAACrT,EAAQ+R,EAAS/sD,EAAGiB,GACrC,MAAK22D,GAAS7K,GAGP/R,EAAO+N,MAAMwP,aAFTvd,EAAO+N,MAAMyP,eAItBV,EAAe,SAAA38D,GACjB,GAAMs9D,GAAQt9D,EAAEu9D,WAAav9D,EAAEu9D,WAAa,KAAOv9D,EAAEw9D,OAAS,CAC9DZ,GAAS,EAAGb,EAAWj2D,EAAY,IAARw3D,GAG/BvB,GAAWlzB,cAAe,EAC1BkzB,EAAWnO,MAAMwP,aACjBrB,EAAWnO,MAAM6P,qBAAsB,EACvC1B,EAAWn5B,OAAOi6B,aAAavoE,IAAIuoE,EAAc/qE,MACjDiqE,EAAWn5B,OAAOswB,YAAY5+D,IAAI4+D,EAAaphE,MAC/CA,KAAK0T,KAAKooD,MAAM8P,gBAAgBnB,EAAQzqE,KAExC,IAAMysD,GAAOzsD,KAAK0T,KAAKlR,IAAI+9C,SAAS,EAAG,EACvCkM,GAAKjM,UAAU,UACfiM,EAAKhM,SAASkpB,EAAMC,EAAMC,EAAUC,GACpC9pE,KAAKi6B,WAAWwwB,cAAcjoD,IAAIiqD,GAClCwd,EAAWxd,KAAOA,CAElB,IAAM0W,GAAe,SAACp1D,EAAK+xD,GACnBA,EAAQsD,cAAgBhnD,OAAOinD,YAAYC,QAA6B,IAAnBxD,EAAQC,SAGjEn6D,EAAKq0B,WAAWuwB,2BACZ5kD,EAAK+sC,eACL/sC,EAAK+sC,aAAak5B,YAAYjmE,EAAK+sC,aAAam5B,cAChDlmE,EAAK+sC,aAAe,OAG5B,KAAKzxB,EAAK45B,OAAQ,CACd,GAAMjkB,KACNA,GAAEkI,OAAS7d,EAAK6d,OAAO/sB,KACvB6kB,EAAEmI,OAAS9d,EAAK8d,OAAOhtB,KACvB6kB,EAAE7kB,KAAOhS,KAAKi6B,WAAWuO,UAAUtnB,IACnC,IAAIo4C,GAAY,IAChB,IAAGt5D,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKtsB,MAAM,CAAA,GACtCA,GAASrZ,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAA5CtsB,KACJrZ,MAAKi6B,WAAW0V,cAAcj8B,KAAKpC,KAAKkI,MAAM2E,cAAc9E,EAAM3S,OACjE4yD,EAAYt5D,KAAKi6B,WAAW0V,cAAcj8B,KAAKlR,IAAI6W,MAAMA,EAAM3S,IAAK2S,EAAM9J,SAGlF,GAAMgwD,GAAWv/D,KAAK2vC,cAAc4uB,UAAUr9C,EAAKstC,KAAKz7C,EACpDmO,EAAKstC,KAAKx6C,EACVkN,EAAKstC,KAAKxoD,MACVkb,EAAKstC,KAAKroD,OACV+a,EAAK6d,OAAO76B,WAAWwC,IACvBwa,EAAK8d,OAAO96B,WAAWwC,IACvBy8D,EACAtsC,EACAyiC,EACA,uBACAt5D,KAAKi6B,WAAWwwB,cAEpB8U,GAASQ,OAAOI,UAAU39D,IAAI,WAAA,MAAM82D,IAAaA,EAAU9gD,SAE/DxY,KAAKi6B,WAAWwwB,cAAc9b,SAAU,GAG5C86B,mBAAoB,SAAU1oE,GAC1Bf,KAAKi6B,WAAWiQ,aAAa3mB,KAAKxiB,GAC9Bf,KAAKi6B,WAAWiQ,aAAa7oC,OAAS,KACtCrB,KAAKi6B,WAAWiQ,aAAanrB,OAAO,EAAG,IAI/CgtD,gBAAiB,SAAUhrE,GACvB,GAAMkpE,GAAajqE,KAAKi6B,WAAWwwB,cAAcnK,UAAU,cACpDpO,EAAalyC,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKqD,SAArDkJ,UAED85B,EAAYhsE,KAAK0T,KAAKpC,KAAKkI,MAAM6E,cAAc6zB,EAAUlpC,KAAK9E,WAAWwC,KAAOwrC,EAAUlpC,KAAK9E,WAAWwC,IAAM,KAChHulE,EAAejsE,KAAK0T,KAAKpC,KAAKkI,MAAM6E,cAAc6zB,EAAUlpC,KAAKxF,QAAQU,WAAWwC,KAAOwrC,EAAUlpC,KAAKxF,QAAQU,WAAWwC,IAAM,KACnIwlE,EAAWh6B,EAAUlpC,KAAKwlD,KAAKz7C,EAAIm/B,EAAUlpC,KAAKxF,QAAQgrD,KAAKz7C,EAC/Do5D,EAAWj6B,EAAUlpC,KAAKwlD,KAAKx6C,EAAIk+B,EAAUlpC,KAAKxF,QAAQgrD,KAAKx6C,EAE/Do4D,EAAYpsE,KAAK0T,KAAKlR,IAAI69C,OAChC+rB,GAAUr5D,EAAIm/B,EAAUlpC,KAAKwlD,KAAKz7C,EAClCq5D,EAAUp4D,EAAIk+B,EAAUlpC,KAAKwlD,KAAKx6C,EAAIk+B,EAAUlpC,KAAKwlD,KAAKroD,OAAS8jE,EAAWh5B,SAAS5vC,MAEvF,IAAMgrE,GAAiBrsE,KAAK0T,KAAKlR,IAAIurD,OAAO,EAAG,EAAGie,EAClDK,GAAermE,MAAQksC,EAAUlpC,KAAKwlD,KAAKxoD,MAC3CqmE,EAAelmE,OAAS+rC,EAAUlpC,KAAKwlD,KAAKroD,MAC5C,IAAMqiD,GAAcxoD,KAAK0T,KAAKlR,IAAIurD,OAAOme,EAAUC,EAAUF,EAC7DzjB,GAAYxiD,MAAQksC,EAAUlpC,KAAKxF,QAAQgrD,KAAKxoD,MAChDwiD,EAAYriD,OAAS+rC,EAAUlpC,KAAKxF,QAAQgrD,KAAKroD,MAEjD,IAAMmmE,GAAWtsE,KAAKgjE,eAAekJ,EAAW,GAC5CC,EACAj6B,EAAUlpC,KAAKxF,QAAQgrD,KAAKxoD,MAAQ,GACpCksC,EAAUlpC,KAAKxF,QAAQgrD,KAAKroD,OAC5B,GACA+rC,EAAUlpC,KAAKxF,QAAQwO,KAC3Bs6D,GAASC,iBAAkB,EAC3BD,EAASE,WAAahR,EAAAA,WAASgR,WAC/BF,EAASG,iBAAmBjR,EAAAA,WAASiR,iBACrCH,EAASI,aAAep+D,SAAS4jC,EAAUlpC,KAAKxF,QAAQwO,KAAKhN,UAAY,IAAM,EAC/EsnE,EAASt6D,KAAOjR,EAChBurE,EAAS1sE,KAAO,MAEhB,IAAM6sD,GAAOzsD,KAAK0T,KAAKlR,IAAI+9C,SAAS,EAAG,EACvCkM,GAAKjM,UAAU,UACfiM,EAAKhM,SAASyrB,EAAUC,EAAU3jB,EAAYxiD,MAAOwiD,EAAYriD,QACjEmmE,EAAS7f,KAAOA,EAChB2f,EAAUle,SAASzB,GAEnB2f,EAAU5pE,IAAI6pE,GACdD,EAAU5pE,IAAIgmD,GACd4jB,EAAU5pE,IAAI8pE,GACdrC,EAAW/b,SAASke,IAOxB5C,kBAAmB,WAAY,GAAA54D,GAAA5Q,IAI3BA,MAAKi6B,WAAWwwB,cAAcC,WAAU,GACxC1qD,KAAK0pE,cACL1pE,KAAKi6B,WAAWiQ,aAAa7sB,QAAQ,SAAArR,GAAM4E,EAAKm7D,gBAAgB//D,KAChEhM,KAAK0T,KAAKshC,MAAM6V,WAAW7qD,KAAKi6B,WAAWwwB,eAC3CzqD,KAAKi6B,WAAWwwB,cAAc9b,SAAU,CARb,IAAAk1B,GAUN7jE,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKqD,SAASkJ,UAA/Dsc,EAVoBqV,EAUpBrV,KAAMxlD,EAVc66D,EAUd76D,KACPihE,EAAajqE,KAAKi6B,WAAWwwB,cAAcnK,UAAU,cACrD+pB,EAASnjE,KAAK2M,IAAI7K,EAAKwlD,KAAKroD,OAAS6C,EAAKxF,QAAQgrD,KAAKroD,OAAQ,GAC/DA,EAAS8jE,EAAWh5B,SAAS5vC,OAAS2H,EAAKwlD,KAAKroD,OAASkkE,EACzDr2D,EAAIw6C,EAAKx6C,EAAIhL,EAAKwlD,KAAKx6C,CACzB7N,GAASqoD,EAAKroD,OACd8jE,EAAWj2D,EAAIA,EAEfi2D,EAAWj2D,EAAIA,EAAI7N,EAASqoD,EAAKroD,UASzCvF,KAAM,+JC7Td,GAAApB,GAAAC,EAAA,kBACA+I,EAAA/I,EAAA,oBACAkJ,EAAAlJ,EAAA,mCACAiF,EAAAjF,EAAA,kCACA6nC,EAAA7nC,EAAA,mCAEAC,GAAAA,WAAQC,QAGAC,KAAM,6CACNC,OAAQH,EAAAA,WAAQwiE,WAGhBC,0BAA2B,WACvB,OACI1mE,cAAcC,aAAa6B,oBAInC6kE,mBAAoB,SAAUl8B,GAC1B,GAAMjkC,GAAOikC,EAAKuiC,SAElB,QADAzoE,KAAK2yC,aAAiB1wC,EAAOA,EAAQjC,KAAKi6B,WAAWyU,YAAc1uC,KAAK2yC,aAAe,KAC/EzM,EAAKm8B,WACT,IAAK5mE,eAAcC,aAAa6B,kBAC5ByC,KAAK2sE,oBAOjBpK,WAAY,WACRviE,KAAKi6B,WAAaj6B,KAAKmmC,OAAOq8B,cAAc/mE,cAAc4qC,MAAMC,MAAMC,WAAW3lC,KACjF,IAAM6hE,GAAgBziE,KAAKmmC,OAAOu8B,iBAAiBjnE,cAAcgrC,KAAKC,SAASC,cAAc/lC,KAC7FZ,MAAK0T,KAAO+uD,EAAc9yB,eAAiB8yB,EAAc9yB,cAAcj8B,KACvE1T,KAAK2vC,cAAgB8yB,EAAc9yB,cACnC3vC,KAAK4sE,WAAY,EACjB5sE,KAAK6sE,eAAgB,EACrB7sE,KAAK8sE,UAAY,EACjB9sE,KAAK+sE,gBAAkB,GAG3BC,kBAAmB,WACf,GAAGhtE,KAAKitE,cAAc,QAAS,IAC1BjtE,KAAK4sE,UAAW,CACjB5sE,KAAK4sE,WAAY,EACjB5sE,KAAK6sE,eAAgB,CACrB,IAAMK,GAAWltE,KAAKi6B,WAAWyU,YAAY4R,UAAU,aACjD6sB,EAAWntE,KAAKi6B,WAAWyU,YAAY4R,UAAU,YACvD4sB,IAAYA,EAAShO,iBAAiB,eACtCiO,GAAYA,EAASjO,iBAAiB,SACtCl/D,KAAKi6B,WAAW0gB,4BAIxByyB,kBAAmB,WAAW,GAAAxnE,GAAA5F,IACvBA,MAAKitE,cAAc,QAAS,GAC3BjtE,KAAK4sE,WACL5sE,KAAKi6B,WAAWghB,aAAa/xC,KAAK,WAC9BtD,EAAKgnE,WAAY,EACjBhnE,EAAKinE,eAAgB,CACrB,IAAMK,GAAWtnE,EAAKq0B,WAAWyU,YAAY4R,UAAU,aACjD6sB,EAAWvnE,EAAKq0B,WAAWyU,YAAY4R,UAAU,YACvD4sB,IAAYA,EAAShO,iBAAiB,SACtCiO,GAAYA,EAASjO,iBAAiB,eACtCt5D,EAAKq0B,WAAW2gB,2BACjB,SAAAzuC,GACC,GAAI9E,GAAI8E,EAAGiO,QAAQ,cAEnB,IADA/S,EAAIA,GAAK,EAAIA,EAAI8E,EAAGiO,QAAQ,cACxB/S,GAAK,EAAG,CAGR,GAFAzB,EAAKq0B,WAAW9vB,QAAQykC,YAAchpC,EAAKq0B,WAAW4U,iCAEnD1iC,EAAGiO,QAAQ,iBAAmB,EAAE,CAC/B,GAAM8yD,GAAWtnE,EAAKq0B,WAAWyU,YAAY4R,UAAU,aACjD6sB,EAAWvnE,EAAKq0B,WAAWyU,YAAY4R,UAAU,YAMvD,OALA4sB,IAAYA,EAAShO,iBAAiB,cAAc,aACpDiO,GAAYA,EAASjO,iBAAiB,QAAQ,aAC9Ct5D,EAAKq0B,WAAW0gB,0BAChB/0C,EAAKgnE,WAAY,MACjBpgE,GAAAA,WAAOsf,MAAM3f,EAAGmK,OAAO,EAAGjP,IAAI6B,KAAK,aAAO,cAG1CnG,UAAUstB,aAAe,UACzB70B,OAAOkR,SAAS2rC,KAAO,oBAEH,QAArBt1C,UAAU+L,OACTtT,OAAOqE,QAAUrE,OAAOqE,OAAO44C,YAE/BjsC,EAAAA,WAAOsf,MAAM3f,EAAGmK,OAAO,EAAGjP,IAAI6B,KAAK,WAC/B1N,OAAOkR,SAAS2rC,KAAO,wBAGxB,IAAKlsC,EAAGiO,QAAQ,WACvBxU,EAAKq0B,WAAW9vB,QAAQykC,YAAchpC,EAAKq0B,WAAW4U,iCACtDriC,EAAAA,WAAOsf,MAAM,qBAM7BuhD,UAAW,WAAY,GAAAz8D,GAAA5Q,KAAA4iE,EACmB5iE,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKyM,OAAvEluC,EADY0+D,EACZ1+D,WAAYguC,EADA0wB,EACA1wB,UAAWhxB,EADX0hD,EACW1hD,KACnBosD,EAA8Fp7B,EAApGsc,KAAqB+e,EAA+Er7B,EAArFlpC,KAAewkE,EAAsEt7B,EAAtEs7B,aAAcC,EAAwDv7B,EAAxDu7B,aAA0BpD,EAA8Bn4B,EAA1Cw7B,WAAgCC,EAAUz7B,EAAtB07B,WACtEC,EAA2BN,EAAjC/e,KAAgBsf,EAAiBP,EAAjBO,KAAMtqE,EAAW+pE,EAAX/pE,QAChBuqE,EAA4BD,EAAlCtf,KAAsBwf,EAAYF,EAAlB97D,KACVi8D,EAAezqE,EAArBgrD,KACGmb,EAAqD2D,EAAxDv6D,EAAY62D,EAA4C0D,EAA/Ct5D,EAAgB61D,EAA+ByD,EAAtCtnE,MAAyB8jE,EAAawD,EAArBnnE,OAChC+nE,EAAyDL,EAA5D96D,EAAao7D,EAA+CN,EAAlD75D,EAAiBo6D,EAAiCP,EAAxC7nE,MAA0BokE,EAAcyD,EAAtB1nE,OACnCkoE,EAAyDN,EAA5Dh7D,EAAau7D,EAA+CP,EAAlD/5D,EAAiBu6D,EAAiCR,EAAxC/nE,MAA0BwoE,EAAcT,EAAtB5nE,OACnC+lE,EAAqE+B,EAAxEl7D,EAAgBo5D,EAAwD8B,EAA3Dj6D,EAAoBy6D,EAAuCR,EAA9CjoE,MAA6B0oE,EAAiBT,EAAzB9nE,MACtDkkE,GAAoB/oE,SAAX+oE,EAAuB,GAAKA,EACrCsD,EAAoBrsE,SAAXqsE,EAAuB,GAAKA,EACrCH,EAAgClsE,SAAjBksE,EAA6B,EAAIA,EAChDC,EAAgCnsE,SAAjBmsE,EAA6B,EAAIA,CAEhD,IAAMrN,IAAazf,aAAc,SAAUC,aAAc,UACnDoiB,EAAiB,SAACjwD,EAAGiB,EAAGhO,EAAOG,EAAQ3C,EAASy/D,GAClD,GAAIj/D,GAAAA,OACAq8D,EAAK,EAST,IARAA,GAAM4C,EAAQ3D,WAAa2D,EAAQ3D,WAAa,IAAM,UACtDe,GAAM4C,EAAQj+D,SAAWsJ,SAAS20D,EAAQj+D,UAAY,MAAQ,GAC9Dq7D,GAAMzvD,EAAKqpB,WAAW6V,UAAUpqC,KAAOkL,EAAKqpB,WAAW6V,UAAUpqC,KAAKL,WAAa49D,EAAQ59D,WAAa49D,EAAQ59D,WAAa,GAE7H+6D,EAAU16D,KAAO26D,EACjBD,EAAUzrD,KAAOsuD,EAAQ5+D,MACzBL,EAAM4M,EAAK8C,KAAKlR,IAAIwP,KAAK,EAAG,EAAGxO,EAAS48D,EAAWxvD,EAAKqpB,WAAWyU,aAE/DgC,EAAAA,WAAUrrC,WAAY,CACtB,GAAMhB,IAAS4+D,EAAQ5+D,MAAQ4+D,EAAQ5+D,MAAQuM,EAAKk/B,UAAUkV,iBAAiB3gD,OAAOoS,QAAQ,IAAK,KACnG,IAAIpS,EAAM+V,QAAQ,YAAe,CAC7B,GAAM6kD,GAAM56D,EAAMoS,QAAQ,OAAQ,IAAIA,QAAQ,IAAK,IAAIpE,MAAM,IAC7DrO,GAAIkoD,SAAS,KAAO,SAAW59C,SAAS2wD,EAAI,KAAO,GAAK3wD,SAAS2wD,EAAI,KAAO,EAAI3wD,SAAS2wD,EAAI,KAAKx0D,SAAS,KAAK6L,WAAY,OAG5HtS,GAAIkoD,SAAS7nD,EAAO,EAGxB,IAAM4kD,GAAKr4C,EAAKqpB,WAAW6V,UAAUpqC,KAAKI,KAAO8K,EAAKqpB,WAAWivB,qBAAqBllD,EAAIgB,UAAYhB,EAAIgB,QAC1GhB,GAAI+O,EAAIA,GAAK/M,EAAQ,IAAUijD,EAAK,GAAK,GAAK,GAAKA,EAAK,IAAM,EAC9DjlD,EAAIgQ,EAAIA,GAAKhQ,EAAImC,OAASmI,SAAStK,EAAIgB,WAAa,EACpDhB,EAAI+R,cAAgB,IAAUkzC,EAAK,OAGnCjlD,GAAI68C,cAAc9tC,EAAGiB,GAAKhQ,EAAImC,OAASmI,SAAS20D,EAAQj+D,WAAa,EAAGgB,EAAOG,EAGnF,OAAOnC,IAILmyC,EAAKn2C,KAAKi6B,WAAWyU,YAAYutB,OAAO,EAAG,EAAGj8D,KAAK0T,KAAKpC,KAAKkI,MAAM6E,cAAcna,EAAWwC,MAAQxC,EAAWwC,IACrHyvC,GAAGnwC,MAAQhG,KAAK0T,KAAKshC,MAAMhvC,MAC3BmwC,EAAGhwC,OAASnG,KAAK0T,KAAKshC,MAAM7uC,OAC5BgwC,EAAGY,cAAe,CAGlB,IAAMkzB,GAAajqE,KAAK0T,KAAKlR,IAAIurD,OAAO,EAAE,GAEpCgc,EAAiB5sD,OAAO8d,QAAQloB,EAAG,EAAGiB,EAAG,EAAGhO,MAAO6jE,EAAU1jE,OAAQ2jE,GAAY5lE,EAAWsqD,MAC5Fwb,EAAWhqE,KAAKi6B,WAAWyU,YAAYutB,OAAO0N,EAAOI,EAAeh3D,EACtE62D,EAAOG,EAAe/1D,EACtBhU,KAAK0T,KAAKpC,KAAKkI,MAAM6E,cAAc6zB,EAAUhuC,WAAWwC,MAAQwrC,EAAUhuC,WAAWwC,IACzFsjE,GAAShkE,MAAQ+jE,EAAe/jE,MAChCgkE,EAAS7jE,OAAS4jE,EAAe5jE,MAEjC,IAAM+jE,GAAUP,EAAO6D,EACjBrD,EAAUP,EAAO6D,CACvBxD,GAAWl3D,EAAIm3D,EACfD,EAAWj2D,EAAIm2D,EACfF,EAAWrqE,KAAO,aAClBI,KAAKi6B,WAAWyU,YAAYlsC,IAAIynE,EAEhC,IAAIhjE,GAAOlE,UAAUC,SAAW,GAAK,EACjCslD,EAAOvlD,UAAUC,SAAW,EAAI,CAChCD,WAAUC,WACVslD,EAAOphD,KAAK2mB,IAAIy6B,EAAKphD,KAAK4lB,MAAM+8C,EAAWuE,IAC/B,IAAT9lB,EACCrhD,EAAO,EACO,IAATqhD,EACLrhD,EAAO,EACO,IAATqhD,IACLrhD,EAAO,IAGf,IAAI0nE,GAAQ,EACRC,EAAO,EACP5C,EAAAA,OACA6C,GAAU97D,EAAG,EAAGiB,EAAG,GACjB86D,EAAS9uE,KAAK0T,KAAKlR,IAAIurD,OAAO,EAAG,EACvC+gB,GAAO9oE,OAASooE,EAAY/D,GAAU/hB,EACtCwmB,EAAO3oE,QAAUikE,EAAauD,GAAU1mE,EACxCgjE,EAAW/b,SAAS4gB,EAEpB,IAAIxE,GAAkB,EAClBC,EAAa,KACbwE,GAAc,EACZjE,EAAW,SAAC/3D,EAAGiB,IACb9M,KAAKkN,IAAI61D,EAAWj2D,EAAIu2D,GAAc,GAAKrjE,KAAKkN,IAAI61D,EAAWl3D,EAAIu3D,GAAmB,IAAOC,IAC7FwE,GAAc,EAElB,IAAMC,GAAe5E,EAAanjE,EAAO0mE,GAAU1mE,EAAO,EACtD+M,GAAIm2D,GAAW6E,GAAgBlF,EAC/BG,EAAWj2D,EAAIm2D,EAEVn2D,EAAIg7D,EAAepF,EAAOE,EAC/BG,EAAWj2D,EAAI41D,EAAOE,GAAaM,EAAanjE,EAAO0mE,GAAU1mE,EAAO,IAGxEgjE,EAAWj2D,EAAIA,GAIjB+2D,EAAe,SAAChd,EAAQ+R,EAAS/sD,EAAGiB,EAAGg3D,EAAIC,GAC7C,GAAIC,GAAKn4D,EACLo4D,EAAKn3D,EACL6H,EAAKrgB,OAAO0rC,YAAcllC,SAASmlC,gBAAgBzkC,aAAeV,SAASC,KAAKS,YAChFkQ,EAAKpX,OAAO4rC,aAAeplC,SAASmlC,gBAAgBxkC,cAAgBX,SAASC,KAAKU,YAClFkZ,GAAIjJ,GAAoB,OAAf23D,IAAwBxnE,UAAUC,WAC3CmoE,EAAKZ,EAAax3D,EAAIu3D,GAE1BQ,EAASI,EAAIC,IAGX8D,GAAc,SAAClhB,EAAQ+R,EAAS/sD,EAAGiB,EAAGg3D,EAAIC,GAC5CX,EAAkBv3D,EAClBw3D,EAAaN,EAAWj2D,GAGtBk7D,GAAa,SAACnhB,EAAQ+R,EAAS/sD,EAAGiB,EAAGg3D,EAAIC,GAC3CV,EAAaN,EAAWj2D,GAGtB22D,GAAW,SAAC7K,GACd,GAAI/sD,GAAAA,OAAGiB,EAAAA,OACH6H,EAAKrgB,OAAO0rC,YAAcllC,SAASmlC,gBAAgBzkC,aAAeV,SAASC,KAAKS,YAChFkQ,EAAKpX,OAAO4rC,aAAeplC,SAASmlC,gBAAgBxkC,cAAgBX,SAASC,KAAKU,YAmBtF,OAlBIkZ,GAAIjJ,EACD7P,UAAUC,UACT+P,EAAI+sD,EAAQsL,OACZp3D,GAAK8rD,EAAQuL,SAEbt4D,EAAI+sD,EAAQuL,OACZr3D,EAAI8rD,EAAQsL,QAIbroE,UAAUC,UACT+P,EAAI+sD,EAAQuL,OACZr3D,EAAI8rD,EAAQsL,SAEZr4D,EAAI+sD,EAAQsL,OACZp3D,GAAK8rD,EAAQuL,QAGjBr3D,EAAIm2D,GAAWn2D,EAAYm2D,EAAUL,GACrC/2D,EAAIm3D,GAAWn3D,EAAYm3D,EAAUL,EAC9B,MAEH92D,EAAAA,EAAGiB,EAAAA,IAGTotD,GAAc,SAACrT,EAAQ+R,EAAS/sD,EAAGiB,GAErC,MADA+6D,IAAc,EACTpE,GAAS7K,GAGP/R,EAAO+N,MAAMwP,aAFTvd,EAAO+N,MAAMyP,eAKtB4D,GAAW,SAAC17D,EAAGu3D,GACjB,GAAG+D,KAAgB,EAAnB,CACA,GAAMrE,GAAQC,GAASK,EACvB,IAAKN,IAASM,EAAG5H,cAAgBhnD,OAAOinD,YAAYC,QAAwB,IAAd0H,EAAGjL,QAAjE,CAIA,GAAsB,IAAnBnvD,EAAKk8D,UACJl8D,EAAKk8D,UAAYl8D,EAAK8C,KAAK0Y,KAAKsG,QAC/B,CACD,KAAI9hB,EAAK8C,KAAK0Y,KAAKsG,IAAM9hB,EAAKk8D,WAAc,KAGxC,MAFAl8D,GAAKk8D,UAAY,EAMzB+B,EAAO97D,EAAI,EACX87D,EAAO76D,EAAI,CACX,IAAMjB,GAAI23D,EAAM33D,EAAIk3D,EAAWl3D,EACzBiB,EAAI02D,EAAM12D,EAAIi2D,EAAWj2D,EACzB6H,EAAIuyD,EAAY/D,EAChBz3D,EAAIw3D,EAAauD,CACvB,IAAI56D,EAAI8I,EAAIuyD,GAAap6D,EAAIpB,EAAIw3D,EAAY,CACzC,GAAMhiB,GAAOlhD,KAAK4lB,MAAM/Z,EAAI8I,GACtBwsC,EAAOnhD,KAAK4lB,MAAM9Y,EAAIpB,EAC5B7P,WAAUC,SAAW4N,EAAKqpB,WAAWkuB,oBAAoBE,EAAKD,EAAKE,GAAQ13C,EAAKqpB,WAAWkuB,oBAAoBC,EAAKC,EAAKC,GACpH13C,EAAKqpB,WAAW8Y,cACjBniC,EAAK+hC,aAAe,UAK1Bk4B,GAAe,SAAA38D,GACjB,GAAMs9D,GAAQt9D,EAAEu9D,WAAav9D,EAAEu9D,WAAa,KAAOv9D,EAAEw9D,OAAS,CAC9DZ,GAAS,EAAGb,EAAWj2D,EAAY,IAARw3D,IAG3BhB,IAAa,EACXC,GAAS,SAAC3K,EAAS/sD,EAAGiB,GACxB,GAAM02D,GAAQC,GAAS7K,GACjB8K,EAAiB,WAAWtiE,KAAKgM,UAAU+G,WAAc,iBAAmB,YAC7EqvD,GAOIF,KACDxoE,SAASoZ,iBAAiBwvD,EAAeC,IACzCL,IAAa,GARbA,KACAxoE,SAASkZ,oBAAoB0vD,EAAeC,IAC5CL,IAAa,GAWzBwB,GAAYhsE,KAAK0T,KAAKpC,KAAKkI,MAAM6E,cAAckvD,EAAQrpE,WAAWwC,KAAO6mE,EAAQrpE,WAAWwC,IAAM,IAElG,KAAK,GAAIwO,IAAI,EAAGA,GAAIjO,EAAMiO,KACtB,IAAK,GAAIrO,IAAI,EAAGA,GAAIyhD,EAAMzhD,KAAK,CAC3B,GAAMulE,IAAYpsE,KAAK0T,KAAKlR,IAAI69C,OAChC+rB,IAAUr5D,EAAIlM,IAAKunE,EAAY/D,GAAU6D,EACzC9B,GAAUp4D,EAAIkB,IAAKk1D,EAAauD,GAAUQ,EAC1C/B,GAAUxsE,KAAV,eAA+BsV,GAAIozC,EAAOzhD,GAC1C,IAAMy9D,IAAUtkE,KAAK0T,KAAKlR,IAAIurD,OAAO4gB,EAAOC,EAAM5C,EAClD1H,IAAQt+D,MAAQooE,EAChB9J,GAAQn+D,OAASikE,CAEjB,IAAMgF,IAAUpvE,KAAKi6B,WAAWyU,YAAYutB,OAAOiQ,EAAUC,EAAUnsE,KAAK0T,KAAKpC,KAAKkI,MAAM6E,cAAc7a,EAAQU,WAAWwC,MAAQlD,EAAQU,WAAWwC,IACxJ0oE,IAAQxvE,KAAO,UACfwvE,GAAQppE,MAAQyoE,EAChBW,GAAQjpE,OAASuoE,CAEjB,IAAMW,IAAUrM,EAAeqL,EACzBC,EACAC,EACAC,EACA,GACAR,EACNqB,IAAQzvE,KAAO,UACf,IAAM0vE,IAAWtvE,KAAK0T,KAAKlR,IAAI+9C,SAAS,EAAG,EAU3C,IATA+uB,GAAS9uB,YACT8uB,GAAS7uB,SAAS,EAAG,EAAG2tB,EAAWhE,GACnCkF,GAAS5uB,UACT0rB,GAAUle,SAASohB,IACnBlD,GAAU3f,KAAO6iB,GACjBlD,GAAU5pE,IAAI8hE,IACd8H,GAAU5pE,IAAI4sE,IACdhD,GAAU5pE,IAAI6sE,IAEVrvE,KAAKi6B,WAAW6V,UAAUkV,iBAAiBC,gBAAwB,IAAN/vC,IAAiB,IAANrO,GAAS,CACjF,GAAM0oE,IAAgBvvE,KAAK0T,KAAKlR,IAAI6hE,WAAW+J,EAAWhE,EAC1DmF,IAAc56D,KAAK,EAAG,EAAG,EAAG,GAC5B,IAAM66D,IAAaxvE,KAAK0T,KAAKlR,IAAIurD,OAAO,EAAG,EAAGwhB,GAC9CC,IAAWxpE,MAAQooE,EACnBoB,GAAWrpE,OAASikE,CACpB,IAAMhK,KACF16D,KAAM,uBACNiP,KAAM,QACNgsC,aAAc,SACdC,aAAc,UAEZ6uB,GAAiBzvE,KAAK0T,KAAKlR,IAAIwP,KAAK,EAAG,EAAG,OAAQouD,GAAWpgE,KAAKi6B,WAAWqe,WACnFm3B,IAAe5uB,cAAc,GAAI4uB,GAAetpE,OAAS,IAAM,EAAGioE,EAAWhE,GAC7EgC,GAAU5pE,IAAIgtE,IACdpD,GAAU5pE,IAAIitE,IAGlBxF,EAAW/b,SAASke,IAG5BnC,EAAWlzB,cAAe,EAC1BkzB,EAAWnO,MAAMwP,aACjBrB,EAAWnO,MAAM6P,qBAAsB,EACvC1B,EAAWn5B,OAAOi6B,aAAavoE,IAAIuoE,EAAc/qE,MACjDiqE,EAAWn5B,OAAOm+B,YAAYzsE,IAAIysE,GAAajvE,MAC/CiqE,EAAWn5B,OAAOo+B,WAAW1sE,IAAI0sE,GAAYlvE,MAC7CiqE,EAAWn5B,OAAOqvB,UAAU39D,IAAI2sE,GAAUnvE,MAC1CiqE,EAAWn5B,OAAOswB,YAAY5+D,IAAI4+D,GAAaphE,MAC/CA,KAAK0T,KAAKooD,MAAM8P,gBAAgBnB,GAAQzqE,KAGxC,IAAMysD,IAAOzsD,KAAK0T,KAAKlR,IAAI+9C,SAAS,EAAG,EACvCkM,IAAKjM,YACLiM,GAAKhM,SAASwpB,EAAWl3D,EAAGk3D,EAAWj2D,EAAG61D,EAAW2D,EAAc1D,EAAY2D,GAC/EhhB,GAAK/L,UACL1gD,KAAKi6B,WAAWyU,YAAYlsC,IAAIiqD,IAChCwd,EAAWxd,KAAOA,EAGlB,IAAM51B,MACNA,IAAEkI,OAAS7d,EAAK6d,OAAO/sB,KACvB6kB,GAAEmI,OAAS9d,EAAK8d,OAAOhtB,KACvB6kB,GAAE7kB,KAAOhS,KAAKi6B,WAAWuO,UAAUtnB,IAEnC,IAAMiiD,IAAe,SAACp1D,EAAK+xD,GACnBA,EAAQsD,cAAgBhnD,OAAOinD,YAAYC,QAA6B,IAAnBxD,EAAQC,SAG7D,uBAAyBhyD,EAAIlO,OAAOD,MACpCgR,EAAKqpB,WAAWwgB,yBACZ7pC,EAAK+hC,eACL/hC,EAAK+hC,aAAak5B,YAAYj7D,EAAK+hC,aAAam5B,cAChDl7D,EAAK+hC,aAAe,OAGnB,cAAgB5kC,EAAIlO,OAAOD,KAChCgR,EAAKo8D,oBAEA,cAAgBj/D,EAAIlO,OAAOD,MAChCgR,EAAKw8D,qBAIb,KAAKlsD,EAAK45B,OAAQ,CACd,GAAMykB,IAAWv/D,KAAK2vC,cAAc4uB,UAAUr9C,EAAKstC,KAAKz7C,EACpDmO,EAAKstC,KAAKx6C,EACVkN,EAAKstC,KAAKxoD,MACVkb,EAAKstC,KAAKroD,OACV+a,EAAK6d,OAAO76B,WAAWwC,IACvBwa,EAAK8d,OAAO96B,WAAWwC,IACvBy8D,GACAtsC,GACA72B,KAAKi6B,WAAWq/B,UAChB,qBACAt5D,KAAKi6B,WAAWyU,YAEpB6wB,IAASQ,OAAOI,UAAU39D,IAAI,WAAA,MAAMoO,GAAKqpB,WAAWq/B,WAAa1oD,EAAKqpB,WAAWq/B,UAAU9gD,SAI/F,GADAqe,GAAE7kB,KAAO,GACNhS,KAAKi6B,WAAWk8B,iBAAiB,CAChC,GAAIuZ,IAAS1vE,KAAKi6B,WAAW0V,cAAcj8B,KAAKshC,MAAMhvC,MAAQ,GAC1D2pE,GAAS,EACb3vE,MAAK2vC,cAAc4uB,UAAUmR,GAAQC,GAAQ,GAAI,GAC3C,cAAe,KACfxM,GACAtsC,GAAG,KAAM,YACT72B,KAAKi6B,WAAWyU,aAChB,GAGV,GAAG1uC,KAAKi6B,WAAWm8B,iBAAiB,CAChC,GAAIwZ,IAAU5vE,KAAKi6B,WAAW0V,cAAcj8B,KAAKshC,MAAMhvC,MAAQ,GAC3D6pE,GAAU,GACd7vE,MAAK2vC,cAAc4uB,UAAUqR,GAASC,GAAS,GAAI,GAC7C,QAAS,KACT1M,GACAtsC,GAAG,KAAM,YACT72B,KAAKi6B,WAAWyU,aAChB,GAEV1uC,KAAKi6B,WAAWyU,YAAYC,SAAU,GAG1CmhC,YAAa,WAAY,GAAAj/D,GAAA7Q,IACrBA,MAAKi6B,WAAWmoB,eAAe/kC,QAAQ,SAACtc,EAAM0F,GAC1C,GAAMiiD,GAAkB,SAAAh6C,GACpB,GAAMqhE,GAAOl/D,EAAK6C,KAAKpC,KAAKkI,MAAM6E,cAAc3P,GAAOA,EAAM,KACvD85C,EAAcx/C,EAAKs3C,UAAU,WAC5Bt6C,EAAiBwiD,EAAjBxiD,MAAOG,EAAUqiD,EAAVriD,MACdqiD,GAAYG,YAAYonB,GACxBvnB,EAAYxiD,MAAQA,EACpBwiD,EAAYriD,OAASA,GAPuB4kB,EASlBhqB,EAAOA,KAA9B4rB,EATyC5B,EASzC4B,UAAW8uB,EAT8B1wB,EAS9B0wB,SACZzyC,EAAO6H,EAAKopB,WAAWyU,YAAY4R,UAAU,cAAcrP,SAAS7M,KAAK,SAAAv9B,GAAA,MAAKA,GAAEjH,OAAF,cAAyB6G,GAC7G,IAAKuC,EAAL,CAGA,IAAK2jB,EAGD,MAFA+7B,GAAgB73C,EAAKopB,WAAW6V,UAAUC,SAASpK,KAAKyM,OAAOF,UAAUlpC,KAAKxF,QAAQU,WAAWwC,UACjGsC,EAAKs3C,UAAU,YAAYtuC,KAAO,GAGtC,IAAMy2C,GAAWz/C,EAAKs3C,UAAU,YAC1BsI,EAAUr+C,EAAAA,WAAIC,KAAKixC,EAEzB,IAAK5qC,EAAK6C,KAAKpC,KAAKkI,MAAM6E,cAAcuqC,GAUpCF,EAAgBE,OAV8B,CAC9C,GAAM7nD,GAAO,GAAIiH,MACjBjH,GAAKmH,IAAMuzC,EACX16C,EAAKoH,OAAS,SAAA+F,GACL2C,EAAK6C,KAAKpC,KAAKkI,MAAM6E,cAAcuqC,IACpC/3C,EAAK6C,KAAK8F,MAAMk2B,SAASkZ,EAASnN,EAAUvtC,EAAEnI,QAElD2iD,EAAgBE,IAKxB,GAAMC,GAAUphD,EAAAA,WAAMqhD,mBAAmBn8B,EACzC,IAAI+jB,EAAAA,WAAUrrC,WAAY,CACtB,GAAM0jD,GAAKl4C,EAAKopB,WAAW6V,UAAUpqC,KAAKI,KAAO+K,EAAKopB,WAAW+uB,sBAAsBP,EAASzjD,UAAYyjD,EAASzjD,SAC/GikD,EAAKp4C,EAAKopB,WAAW6V,UAAUpqC,KAAKI,KAAO+K,EAAKopB,WAAWivB,qBAAqBT,EAASzjD,UAAYyjD,EAASzjD,QACpH6L,GAAKopB,WAAWkvB,mBAAmBpoD,KAAK8nD,IAAWI,EAAIF,EAAIN,EAAU53C,EAAKopB,WAAW9vB,SACrFs+C,EAASz2C,KAAO,QAGhBy2C,GAASz2C,KAAO62C,MAK5B8jB,gBAAiB,WAAY,GAAArzD,GAAAtZ,IAEzBA,MAAK8sE,UAAY,EACmC,IAAhD9sE,KAAKi6B,WAAWyU,YAAYuC,SAAS5vC,QACrCrB,KAAKqtE,YAGNrtE,KAAKi6B,WAAWm8B,kBAAoBp2D,KAAKi6B,WAAWk8B,kBAAoBn2D,KAAK6sE,iBAAkB,GAC3F7sE,KAAK6sE,iBAAkB,GAAQ7sE,KAAKi6B,WAAWqT,aAClDttC,KAAKi6B,WAAWghB,aAAa/xC,KAAK,WAE9BoQ,EAAKszD,WAAY,EACjBtzD,EAAKuzD,eAAgB,CACrB,IAAMK,GAAW5zD,EAAK2gB,WAAWyU,YAAY4R,UAAU,aACjD6sB,EAAW7zD,EAAK2gB,WAAWyU,YAAY4R,UAAU,YACvD4sB,IAAYA,EAAShO,iBAAiB,SACtCiO,GAAYA,EAASjO,iBAAiB,eACtC5lD,EAAK2gB,WAAW2gB,2BAElB,SAACzuC,GAECmN,EAAKw2D,cACLx2D,EAAK5F,KAAKshC,MAAM6V,WAAWvxC,EAAK2gB,WAAWyU,aAC3Cp1B,EAAK02D,YACL12D,EAAK2gB,WAAWyU,YAAYC,SAAU,KAI1C3uC,KAAK8vE,cACL9vE,KAAK0T,KAAKshC,MAAM6V,WAAW7qD,KAAKi6B,WAAWyU,aAC3C1uC,KAAKgwE,YACLhwE,KAAKi6B,WAAWyU,YAAYC,SAAU,IAI9CqhC,UAAU,WACHhwE,KAAKi6B,WAAWgQ,eAAgB,GAC5BjqC,KAAKi6B,WAAWyU,YAAYC,WAAY,GACvC3uC,KAAKi6B,WAAWg8B,YAChBga,QAAQltE,UAAUye,KAAyB,WAAlBze,UAAUye,MACnCxhB,KAAKi6B,WAAWqT,cACpBttC,KAAKi6B,WAAW8gB,aAAa,IAIrCkyB,cAAc,SAAUiD,GACpB,MAA4B,KAAzBlwE,KAAK+sE,iBACJ/sE,KAAK+sE,gBAAkB/sE,KAAK0T,KAAK0Y,KAAKsG,KAC/B,GAEH1yB,KAAK0T,KAAK0Y,KAAKsG,IAAM1yB,KAAK+sE,iBAAoBmD,IAC9ClwE,KAAK+sE,gBAAkB,GAChB,MAanBnsE,KAAM,iBACJgsE,WAAW,EACXC,eAAc,EACdC,UAAU,EACVC,gBAAgB,gnBCpkB1BttE,GAAA,sBACAA,EAAA,yBACAA,EAAA,yBACAA,EAAA,yBACAA,EAAA,uBACAA,EAAA,mBACA,IAAA0wE,GAAA1wE,EAAA,oBAAa2wE,OACbznE,EAAAlJ,EAAA,mCACAs6D,EAAAt6D,EAAA,mCACAiF,EAAAjF,EAAA,gCACAqiB,EAAAriB,EAAA,qCACA6nC,EAAA7nC,EAAA,oCACA8nC,EAAA9nC,EAAA,mCACA+nC,EAAA/nC,EAAA,4BAEAD,EAAAC,EAAA,iBAEAC,GAAAA,WAAQC,QAINC,KAAM,4CACNC,OAAQH,EAAAA,WAAQwiE,WAMhBC,0BAA2B,WAE1B,OACC1mE,cAAcC,aAAac,cAC3Bf,cAAcC,aAAaiB,uBAC3BlB,cAAcC,aAAakB,0BAC3BnB,cAAcC,aAAamB,0BAC3BpB,cAAcC,aAAaoB,oBAC3BrB,cAAcC,aAAaqB,uBAC3BtB,cAAcC,aAAasB,uBAC3BvB,cAAcC,aAAawB,gBACfzB,cAAcC,aAAaoC,6BAC3BrC,cAAcC,aAAaqC,8BACvCtC,cAAcC,aAAa4D,mBACf7D,cAAcC,aAAa0D,iBACvC3D,cAAcC,aAAa6D,wBAK7B6iE,mBAAoB,SAAUl8B,GAC9B,GAAAtgC,GAAA5F,KACOiC,EAAOikC,EAAKuiC,SAClB,QAASviC,EAAKm8B,WAEb,IAAK5mE,eAAcC,aAAac,cAC/B,KACD,KAAKf,eAAcC,aAAaiB,uBAC/BqD,KAAKi6B,WAAW0V,cAAgB3vC,KAAK2vC,cAEtB3vC,KAAKqwE,iBAEpBrwE,KAAKi6B,WAAWy/B,UAAY15D,KAAK2vC,cAAcj8B,KAAKooD,MAAMwU,SAASC,OAAOn0D,OAAOo0D,SAASC,UAC1FzwE,KAAK0wE,eAEL1wE,KAAK2vC,cAAcj8B,KAAKooD,MAAM6U,OAAOnuE,IAAI,WACxCoD,EAAKgrE,mBAEN5wE,KAAK2vC,cAAcj8B,KAAKooD,MAAM+U,KAAKruE,IAAI,WACtCoD,EAAKkrE,mBAIN9wE,KAAK2vC,cAAcj8B,KAAKpC,KAAK6F,YAAc,YAE3CnX,KAAK2vC,cAAcguB,UACjBz0D,KAAK,WAIgB,MAHrBzB,GAAAA,WAAMspE,oBACenrE,EAAKorE,gBACLprE,EAAKqrE,uBACErrE,EAAK+pC,cAAcuuB,YAAYt4D,EAAKq0B,WAAWqT,gBAE3EpkC,KAAK,SAAAwK,GACL,MAAiC,KAA7ByJ,OAAOC,KAAK1J,GAAMrS,OACdO,QAAQE,OAAO,UAEvB8D,EAAK+pC,cAAcouB,OAAO,aACvBh7D,UAAUuf,QAAgC,MAAtBvf,UAAUmM,QAC7BtJ,EAAK+pC,cAAcutB,gBAEEt3D,EAAK+pC,cAAcotB,cAErCn3D,EAAKq0B,WAAW4V,cAAcn8B,GAAMxK,KAAK,WAE/C,MADAtD,GAAK+pC,cAAcouB,OAAO,gBAAgB,GACnC,GAAIn8D,SAAQ,SAACC,EAAQC,GACA,IAAGiB,UAAUuf,QAAgC,MAAtBvf,UAAUmM,QAqB7B,MAAOrN,IApBP,IAAMqvE,GAAa,SAACnjE,EAAK+xD,GACrB,IAAIA,GAAWA,EAAQsD,cAAgBhnD,OAAOinD,YAAYC,QAA6B,IAAnBxD,EAAQC,OAA5E,CAIAn6D,EAAK+pC,cAAcj8B,KAAKooD,MAAMqV,OAAOC,SACrC,IAAM7T,GAAc33D,EAAK+pC,cAAcj8B,KAAKshC,MAAMsL,UAAU,WAE5D,OADAid,IAAeA,EAAY5gD,UACpB9a,KAEX,KAAG+D,EAAK+pC,cAAcj8B,KAAK8F,MAAM6E,cAAc,YAO3C,MAAOxc,IANP,IAAMwvE,GAAOzrE,EAAK+pC,cAAcj8B,KAAKlR,IAAI0wB,MAAM,EAAG,EAAG,WACrDm+C,GAAKzxE,KAAO,WACZyxE,EAAKt+D,GAAKnN,EAAK+pC,cAAcj8B,KAAKshC,MAAMhvC,MAAQqrE,EAAKrrE,OAAS,EAC9DqrE,EAAKr9D,EAAIjR,UAAUC,UAAa4C,EAAK+pC,cAAcj8B,KAAKshC,MAAM7uC,OAASkrE,EAAKlrE,QAAU,EAAMP,EAAK+pC,cAAcj8B,KAAKshC,MAAM7uC,OAAS,GACnIP,EAAK+pC,cAAcj8B,KAAKooD,MAAMqV,OAAOrT,QAAQoT,MAS/E,SAAAhjE,GAEF,MADAtI,GAAK+pC,cAAcouB,OAAO,YAAc7vD,GACjCtM,QAAQE,OAAOoM,GAAK,iBAGVhF,KAAK,WACtBtD,EAAKq0B,WAAW6T,eAAc,GAAO,GACbrmC,EAAAA,WAAM6pE,kBAEP,SAAApjE,GACvB,MAAOtM,SAAQE,OAAOoM,KAGvBhF,KAAK,WAAA,MAAM,OAAM,SAAAgF,GACbnL,UAAU+L,QAA+B,KAArB/L,UAAU+L,OACjCtC,EAAAA,WAAOsN,KAAK5L,EAAI,WAAWhF,KAAK,WAAM1N,OAAOkR,SAAS2rC,KAAO,kBAAmB,WAAA,MAAM,QAE9D7rC,EAAAA,WAAOsN,KAAK5L,EAAI,aAAahF,KAAK,WAAA,MAAM1N,QAAOkR,SAAS2rC,KAAO,yBAAyB,WAAA,MAAM,SAGzH,MACD,KAAK58C,eAAcC,aAAakB,0BAE/BoD,KAAKuxE,kBAAkB91E,cAAcC,aAAamB,0BAClD,MACD,KAAKpB,eAAcC,aAAamB,0BAC/BmD,KAAK2vC,cAAc0tB,aACnB,IAAM3pD,GAAO1T,KAAKi6B,WAAW6V,SAC7B9vC,MAAKi6B,WAAWstB,aAHjB,IAIQluC,GAASrZ,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAA5CtsB,KACHrZ,MAAK2vC,cAAcj8B,KAAKpC,KAAKkI,MAAM2E,cAAc9E,EAAM3S,OAC1D1G,KAAKi6B,WAAWq/B,UAAYt5D,KAAK2vC,cAAcj8B,KAAKlR,IAAI6W,MAAMA,EAAM3S,IAAK2S,EAAM9J,SAGjEvP,KAAK+6C,aAAa,GAAG7xC,KAAK,WACtB,GAAIwK,EAAKi9B,OAASj9B,EAAKi9B,KAAKzsC,WAAW42C,OACnCl1C,EAAKq0B,WAAWqY,eAEf,IAAK5+B,EAAKk9B,MAAMkK,OAGhB,CACD,GAAIhpB,GAAUlsB,EAAKq0B,WAAW4d,mBACxBne,EAAc5H,EAAQ6H,aAAe7H,EAAQ6H,aAAe7H,EAAQvmB,IAC1E,IAAIumB,EAAQ2H,KAAgC,IAAzB3H,EAAQ6E,MAAMt1B,OAAc,CAE3C,GAAGuE,EAAKq0B,WAAWqT,aAAa,CAC5B,GAAMwK,GAAY,SAACnhB,GACF,OAAVA,EACCnqB,EAAAA,WAAOsf,MAAM,cACE,SAAV6K,EAELnqB,EAAAA,WAAOC,OAAO,QAAQ,kDAAkD,KAAK,OAAO,MAAK,GAAOvD,KAAK,YACjG,EAAA6uC,EAAAA,YAAK,aACDC,OAAO,EACP/pC,QAAS,UAEf,eAGF6jB,EAAQ6E,MAAQA,EAAQA,KACxB/wB,EAAKq0B,WAAWsc,qBAAqB3wC,EAAKq0B,WAAW9vB,QAAS2nB,IAItE,YADAlsB,GAAKq0B,WAAWge,wBAAwBve,EAAY5H,EAAQomB,OAAOpmB,EAAQ2H,IAAIqe,GAGnF,IAAIhmB,EAAQomB,QAAW,YAAcn1C,UAAU+L,QAAU,QAAU/L,UAAU+L,QAA+B,QAArB/L,UAAU+L,OAqB7FlJ,EAAKq0B,WAAWC,mBAAmBR,EAAa5H,EAAQ2H,KAAKvwB,KAAK,SAACytB,GAAQ,GAAAwhB,IACvEA,EAAArmB,EAAQ6E,OAAMpT,KAAd3G,MAAAu7B,EAAAjtB,EAAsByL,IACtB/wB,EAAKq0B,WAAWsc,qBAAqB3wC,EAAKq0B,WAAW9vB,QAAS2nB,IAC/D,SAAC3oB,QACWA,EAAIiR,QAAQ,WACnB5N,EAAAA,WAAOsf,MAAM3iB,GAEQ,WAAlBpG,UAAUye,IACThV,EAAAA,WAAO4rC,KAAK,uBAAuBlvC,KAAK,WACpC1N,OAAOkR,SAAS2rC,KAAO,uDAAwDt1C,UAAUwG,MAG7FiD,EAAAA,WAAO4rC,KAAK,kCAjCwF,CAChH,GAAMG,GAAe,SAACC,GACdA,EACA5yC,EAAKq0B,WAAWC,mBAAmBR,EAAa5H,EAAQ2H,KAAKvwB,KAAK,SAACytB,GAAQ,GAAAoD,EACvEn0B,GAAKq0B,WAAW4R,sBAAwB,MACxC9R,EAAAjI,EAAQ6E,OAAMpT,KAAd3G,MAAAmd,EAAA7O,EAAsByL,IACtB/wB,EAAKq0B,WAAWsc,qBAAqB3wC,EAAKq0B,WAAW9vB,QAAS2nB,IAC/D,WACyB,QAArB/uB,UAAU+L,OACTtT,OAAOqE,QAAUrE,OAAOqE,OAAO44C,YAE/BjsC,EAAAA,WAAOsf,MAAM,gBAIrBtf,EAAAA,WAAOsf,MAAM,UAIrBlmB,GAAKq0B,WAAWye,cAAchf,EAAa5H,EAAQomB,OAAQpmB,EAAQ2H,IAAK8e,QAqB5E3yC,GAAKq0B,WAAWsc,qBAAqB3wC,EAAKq0B,WAAW9vB,QAAS2nB,OApElElsB,GAAKq0B,WAAWsY,aAyEvC,MACD,KAAK92C,eAAcC,aAAaoB,oBAC/B,KACD,KAAKrB,eAAcC,aAAaqB,uBAC/B,KACD,KAAKtB,eAAcC,aAAasB,uBAC/B,KACD,KAAKvB,eAAcC,aAAawB,gBAC/B8C,KAAKsyC,UACL,MACD,KAAK72C,eAAcC,aAAaoC,6BAC/BkC,KAAKuxE,kBAAkB91E,cAAcC,aAAaqC,8BAA+BkE,EACjF,MACD,KAAKxG,eAAcC,aAAaqC,8BAC/BiC,KAAKwxE,SAASvvE,EAAKkI,QAASnK,KAAKi6B,WAAWgV,WAAYjvC,KAAKi6B,WAAWwc,aAAcz2C,KAAKi6B,WAAW2B,YAAa35B,EAAK+wC,SACxH,MACD,KAAKv3C,eAAcC,aAAa4D,mBAC/BU,KAAKyxE,YAAYxvE,EAAKrC,KAAMqC,EAAK2uD,WACjC,MACD,KAAKn1D,eAAcC,aAAa0D,iBAC/BY,KAAK+6C,aAAa94C,EAAK+4C,GACvB,MACD,KAAKv/C,eAAcC,aAAa6D,sBAC/BS,KAAK0xE,cAAc1xE,KAAKi6B,WAAWi4B,iBAAkBjwD,KAOlDyuE,aAAa,WAAY,GAAA9/D,GAAA5Q,IACQ,QAA1BA,KAAKi6B,WAAWgT,QACnBjtC,KAAKi6B,WAAWgT,MAAQjtC,KAAK2vC,cAAcj8B,KAAKooD,MAAMwU,SAASC,OAAOn0D,OAAOo0D,SAASmB,GACtF3xE,KAAKi6B,WAAWgT,MAAMkkC,OAAO3uE,IAAI,WAC7BoO,EAAKqpB,WAAWkO,WAAY,IAEhCnoC,KAAKi6B,WAAWgT,MAAM4jC,KAAKruE,IAAI,WAC3BoO,EAAKqpB,WAAWkO,WAAY,MAMpCypC,gBAAgB,WACZ5xE,KAAK2vC,cAAcj8B,KAAKooD,MAAMwU,SAASuB,UAAUz1D,OAAOo0D,SAASmB,GACjE3xE,KAAKi6B,WAAWgT,MAAQ,MAElCojC,eAAgB,WACNrwE,KAAKi6B,WAAWqe,WAAat4C,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QACzDrgD,KAAKi6B,WAAWqe,WAAW14C,KAAO,aAClCI,KAAKi6B,WAAWo/B,cAAgBr5D,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QAC5DrgD,KAAKi6B,WAAWo/B,cAAcz5D,KAAO,gBACrCI,KAAKi6B,WAAWw4B,YAAczyD,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QAC1DrgD,KAAKi6B,WAAWw4B,YAAY7yD,KAAO,cACnCI,KAAKi6B,WAAWw4B,YAAYqf,iBAC5B9xE,KAAKi6B,WAAW6U,UAAY9uC,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QACxDrgD,KAAKi6B,WAAW6U,UAAUlvC,KAAO,YACjCI,KAAKi6B,WAAW2Y,cAAgB5yC,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QAC5DrgD,KAAKi6B,WAAW2Y,cAAchzC,KAAO,gBACrCI,KAAKi6B,WAAW2Y,cAAcjE,SAAU,EACxC3uC,KAAKi6B,WAAWugB,cAAgBx6C,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QAC5DrgD,KAAKi6B,WAAWugB,cAAc56C,KAAO,gBACrCI,KAAKi6B,WAAWugB,cAAc7L,SAAU,EACxC3uC,KAAKi6B,WAAWyU,YAAc1uC,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QAC1DrgD,KAAKi6B,WAAWyU,YAAY9uC,KAAO,cACnCI,KAAKi6B,WAAWyU,YAAYC,SAAU,EACtC3uC,KAAKi6B,WAAWwwB,cAAgBzqD,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QAC5DrgD,KAAKi6B,WAAWwwB,cAAc7qD,KAAO,gBACrCI,KAAKi6B,WAAWwwB,cAAc9b,SAAU,EACxC3uC,KAAKi6B,WAAWwpB,aAAezjD,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QAC3DrgD,KAAKi6B,WAAWwpB,aAAa7jD,KAAO,eACpCI,KAAKi6B,WAAWi4B,eAAiBlyD,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QAC7DrgD,KAAKi6B,WAAWi4B,eAAetyD,KAAO,iBACtCI,KAAKi6B,WAAWktB,SAAWnnD,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QACvDrgD,KAAKi6B,WAAWktB,SAASvnD,KAAO,WAChCI,KAAKi6B,WAAW8wB,WAAa/qD,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QACzDrgD,KAAKi6B,WAAW8wB,WAAWnrD,KAAO,aAClCI,KAAKi6B,WAAW2wB,kBAAoB5qD,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QAChErgD,KAAKi6B,WAAW2wB,kBAAkBhrD,KAAO,iBACzCI,KAAKi6B,WAAWmO,eAAiBpoC,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QAC7DrgD,KAAKi6B,WAAWmO,eAAexoC,KAAO,iBACtCI,KAAKi6B,WAAWm/B,WAAap5D,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QACzDrgD,KAAKi6B,WAAWm/B,WAAWx5D,KAAO,aAClCI,KAAKi6B,WAAWyqB,YAAc1kD,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QAC1DrgD,KAAKi6B,WAAWyqB,YAAY9kD,KAAO,cACnCI,KAAKi6B,WAAWyqB,YAAYotB,kBAGtClB,eAAgB,WAAY,GAAA//D,GAAA7Q,IAC3B,IAAKA,KAAKi6B,WAAWgR,eAAiBjrC,KAAKi6B,WAAWoT,aAAc,GAGxDrtC,KAAKi6B,WAAWwS,eAAgB,EAAnC,CAGA,GAAuD,IAAnDzsC,KAAKi6B,WAAWmO,eAAe6I,SAAS5vC,OAAc,CACtD,GAAM80C,GAAKn2C,KAAKi6B,WAAWmO,eAAe6zB,OAAO,EAAG,EAAG,oBACjD8V,EAAO/xE,KAAKi6B,WAAWmO,eAAe6zB,OAAO,EAAG,EAAG,kBACnD+V,GAAMtsE,KAAM,2BAA4BiP,KAAM,WAC9Cs9D,EAAKjyE,KAAK2vC,cAAcj8B,KAAKlR,IAAIwP,KAAK,EAAG,EAAG,SAAUggE,EAAIhyE,KAAKi6B,WAAWmO,gBAC1E8pC,GAAMxsE,KAAM,2BAA4BiP,KAAM,WAC9Cw9D,EAAKnyE,KAAK2vC,cAAcj8B,KAAKlR,IAAIwP,KAAK,EAAG,EAAG,WAAYkgE,EAAIlyE,KAAKi6B,WAAWmO,eAElF+N,GAAGpjC,GAAK/S,KAAK2vC,cAAcj8B,KAAKshC,MAAMhvC,MAAQmwC,EAAGnwC,OAAS,EAC1DmwC,EAAGniC,GAAKhU,KAAK2vC,cAAcj8B,KAAKshC,MAAM7uC,OAASgwC,EAAGhwC,QAAU,EAC5D4rE,EAAKh/D,EAAIojC,EAAGpjC,EAAI,GAChBg/D,EAAK/9D,EAAImiC,EAAGniC,EAAI,GAChBi+D,EAAGl/D,EAAIg/D,EAAKh/D,EAAI,GAChBk/D,EAAGj+D,EAAI+9D,EAAK/9D,EAAI+9D,EAAK5rE,OAAS,GAC9BgsE,EAAGp/D,EAAIojC,EAAGpjC,EAAI,GACdo/D,EAAGn+D,EAAIi+D,EAAGj+D,EAAI,GAGlBhU,KAAKi6B,WAAWiO,cAAe,EACxCloC,KAAKi6B,WAAWkO,WAAY,EAC5BnoC,KAAKi6B,WAAWqd,kBAEP,IAAM86B,GAAmB,QAAnBA,KACF,GAAMn4C,GAAappB,EAAKopB,WAClBvmB,EAAO7C,EAAK8+B,cAAcj8B,IAChC,OAAO,YACH,GAAM2+D,GAAUp4C,EAAWi4B,eAAejhB,SAAS5vC,OAAS,CAC5D,KAAKgxE,GAAWp4C,EAAWoT,aAAc,EAAM,CAC3C,GAAIyyB,GAAU,GAAI1jD,QAAOk2D,QAAQ5+D,EAAM,EAAG0I,OAAOinD,YAAYC,OAC7DxD,GAAQC,OAAS,EACjB9lC,EAAW+f,aAAaC,iBAAiBzoC,SAAS,mBAAoBsuD,GAGtE7lC,EAAWiO,cACX3jC,WAAW6tE,IAAoB,MAI3C7tE,YAAW6tE,IAAoB,IAE/BpyE,KAAKi6B,WAAWmO,eAAeC,MAAQ,EAChDroC,KAAK2vC,cAAcj8B,KAAKshC,MAAM6V,WAAW7qD,KAAKi6B,WAAWmO,kBAE1D0oC,eAAgB,WACX9wE,KAAKi6B,WAAWiO,eACnBloC,KAAKi6B,WAAWiO,cAAe,EAC/BloC,KAAKi6B,WAAWkO,WAAY,EAEhBnoC,KAAKi6B,WAAWmO,eAAeC,MAAQ,IAK/CkqC,qBAAsB,SAASpoE,EAAS2nB,EAASk1B,EAAOnxB,EAASzwB,GAAO,GAAAkU,GAAAtZ,KAC9DsR,EAAOtR,KAAK2vC,cAAcj8B,KAAKpC,KAC/BkI,EAAQlI,EAAKkI,MACbyd,EAAMpB,EAAQkB,SAAS3xB,GACvBk4B,EAAY54B,EAAA8tB,iBAAiBkL,oBAAoBzG,GACjDu7C,EAAgB,QAAUzvE,UAAU+L,QAAU/L,UAAUstB,aAAe,QACzEoiD,EAAc,EACdC,IAEJp1C,GAAUjgB,QAAQ,SAAA0N,GAAmB,GAAhB/pB,GAAgB+pB,EAAhB/pB,KAAM0F,EAAUqkB,EAAVrkB,GACvB,IAAKA,EAAL,CAGA,GAAa,UAAT1F,GAAoBwxE,EAEpB,aADCh/C,EAAAA,WAAWC,eAAe/sB,IAAS+rE;AAGxC,GAAI13D,GAAiB,QAAT/Z,EAAiBwY,EAAM6E,cAAc3X,GAAO8S,EAAM2E,cAAczX,EACvEqU,KACD03D,IACA13D,EAAQzJ,EAAKwM,SAAS,QAAU9c,EAAO,QAAU,QAAS0F,GACtDqU,GACA23D,EAAcnvD,MAAOviB,KAAAA,EAAM0N,IAAIhI,OAK3C,IAAIguC,GAAW,EACTi+B,KACAh+B,EAAgB,QAAhBA,GAAgB5d,GAClB,IAAK,GAAItwB,GAAI,EAAGA,EAAIswB,EAAS11B,QAAUqzC,EAAW,EAAGjuC,IAAK,CACtD,GAAMwwB,GAAMF,EAAStwB,GACfmuC,EAAMlwC,EAAA8tB,iBAAiBkL,oBAAoBzG,EAMjD,IALI2d,EAAIvzC,SACJsxE,EAAapvD,KAAb3G,MAAA+1D,EAAAznD,EAAqB0pB,IACrBF,KAGc,YAAbzd,EAAIj2B,MAAmC,qBAAbi2B,EAAIj2B,KAC/B,IAAK,GAAIsS,GAAI,EAAGA,EAAI2jB,EAAIE,KAAK91B,QAAUqzC,EAAW,EAAGphC,IACjDqhC,EAAc1d,EAAIE,KAAK7jB,GAAGyjB,WAM1C,OADAryB,GAAA8tB,iBAAiBogD,qBAAqB/8C,EAAQkB,SAAU3xB,GACpDqtE,IAAgBC,EAAcrxE,OACvBrB,KAAKi6B,WAAWoc,sBAAsBlsC,EAAS2nB,EAASk1B,EAAOnxB,EAASzwB,GAAO8D,KAAK,SAAAwtC,GAAA,MAAgBp9B,GAAKu5D,aAAan8B,GAAc,GAAM,KAC1I+7B,GACP99B,EAAc9e,EAAQkB,SAAS1gB,MAAMjR,IACrCstE,EAAgBC,EAAav3C,OAAO,SAAAzF,GAAA,GAAG30B,GAAH20B,EAAG30B,KAAM0F,EAATivB,EAASjvB,GAAT,OAAmB4K,GAAKwM,SAAS,QAAU9c,EAAO,QAAU,QAAS0F,KAAM2zB,IAAI,SAAAtoB,GAAA,MAAKoL,QAAO8d,OAAOlpB,GAAKrD,IAAKqD,EAAErL,QAC3I1G,KAAK6yE,aAAaH,GAAe,IAErC9wE,QAAQC,WAInBk5C,aAAa,SAAU+3B,GAAU,GAAA34D,GAAAna,IACnC,OAAG+C,WAAUuf,QAAgC,MAAtBvf,UAAUmM,QACtBtN,QAAQC,UAEf,GAAID,SAAQ,SAACC,EAAQC,GACf,GAAG,YAAciB,UAAU+L,QAAU,QAAU/L,UAAU+L,OAIrD,MAFAqL,GAAK8f,WAAWgQ,aAAc,EAC9B9vB,EAAK8f,WAAWm/B,WAAWzqB,SAAU,EAC9B9sC,GAEX,IAAMwoD,GAAK,SAACrpD,GACR,GAAGmZ,EAAK8f,WAAWgQ,eAAgB,EAAK,CACpC,GAAI8oC,GAAe54D,EAAK8f,WAAWm/B,WAAW9Y,UAAU,iBACpD0yB,EAAW74D,EAAK8f,WAAWm/B,WAAW9Y,UAAU,mBACpD,IAAGnmC,EAAK8f,WAAWm/B,WAAWnoB,SAAS5vC,QAAU,EAAE,CAG/C,GAFA8Y,EAAK8f,WAAWm/B,WAAW6Z,qBAAsB,EACjD94D,EAAK8f,WAAWm/B,WAAWriB,cAAe,GACrC58B,EAAKw1B,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAc,kBAA6B,IAATrd,IACjEmZ,EAAKw1B,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAc,qBAAgC,IAATrd,EAE7E,MAAOa,IAEXkxE,GAAe54D,EAAK8f,WAAWm/B,WAAW6C,OAAO9hD,EAAKw1B,cAAcj8B,KAAKshC,MAAMhvC,MAAQ,EAAGmU,EAAKw1B,cAAcj8B,KAAKshC,MAAM7uC,OAAS,EAAE,iBACnI4sE,EAAanzE,KAAO,gBACpBmzE,EAAalW,OAAOC,MAAM,GAAK,IAC/BiW,EAAapkC,SAAU,EAEvBqkC,EAAW74D,EAAK8f,WAAWm/B,WAAW6C,OAAO9hD,EAAKw1B,cAAcj8B,KAAKshC,MAAMhvC,MAAQ,EAAGmU,EAAKw1B,cAAcj8B,KAAKshC,MAAM7uC,OAAS,EAAE,oBAC/H6sE,EAASpzE,KAAO,mBAChBozE,EAASnW,OAAOC,MAAM,GAAK,IAC3BkW,EAASrkC,SAAS,EAGtBx0B,EAAK8f,WAAWm/B,WAAW/wB,MAAQ,EACnCluB,EAAK8f,WAAWm/B,WAAWzqB,SAAU,EACrCokC,EAAapkC,QAAmB,IAAT3tC,EACvBgyE,EAASrkC,QAAmB,IAAT3tC,EACnBmZ,EAAKw1B,cAAcj8B,KAAKshC,MAAM6V,WAAW1wC,EAAK8f,WAAWm/B,WACzD,IAAMsF,GAAU,QAAVA,GAAW3wD,EAAK+xD,GACdA,GAAWA,EAAQsD,cAAgBhnD,OAAOinD,YAAYC,QAA6B,IAAnBxD,EAAQC,SAG5E5lD,EAAK8f,WAAWm/B,WAAWnf,iBAAiBp7B,OAAO6/C,GACnDvkD,EAAK+4D,eACD/4D,EAAK8f,WAAWm/B,YACf/wB,MAAM,GACP,IAAM,MAAM,EAAM,EAAG,GAAG,GACvBn/B,KAAK,WAKF,MAJAiR,GAAK8f,WAAWm/B,WAAWzqB,SAAU,EACrCx0B,EAAK8f,WAAWm/B,WAAW/wB,MAAQ,EACxB,IAARrnC,IAAWmZ,EAAK8f,WAAWgQ,aAAc,GAC5CxiC,EAAAA,WAAMq1C,oBAAoBvxC,EAAKK,KAAKC,WAAW6oB,MAAMva,EAAK8f,WAAW+P,kBAC9DnoC,OAGnBsY,GAAK8f,WAAWm/B,WAAWnf,iBAAiBz3C,IAAIk8D,KAI9DnzD,EAAO,kBAEP4nE,EAAYvnE,KAAKkB,MAAMrF,EAAAA,WAAMm1C,oBAAoBrxC,GACvD,IAAiB,OAAd4nE,GAAoC7xE,SAAd6xE,GAGT,GADfh5D,EAAK8f,WAAW+P,eAAiBmpC,EAAUz+C,MACZ,IAAbo+C,EAAe,CAEhC,GAAG34D,EAAK8f,WAAW+P,gBAAiB,GAGnC,MAFA7vB,GAAK8f,WAAWgQ,aAAc,EACT9vB,EAAK8f,WAAWm/B,WAAWzqB,SAAU,EACnD9sC,GAERsY,GAAK8f,WAAW+P,iBAChB39B,QAAQC,IAAI,SAAW6N,EAAK8f,WAAW+P,gBACrBqgB,EAAKyoB,OAClB,IAAgB,IAAbA,EAEU,MADH34D,GAAK8f,WAAWm/B,WAAWzqB,SAAU,EAC3B9sC,QAIXsY,GAAK8f,WAAWgQ,aAAc,EAC9BogB,EAAKyoB,MAMvB7B,qBAAsB,WACrB,GAA0D,IAAtDjxE,KAAKi6B,WAAW2wB,kBAAkB3Z,SAAS5vC,OAAc,CAChD,GAAIoR,GAAIzS,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,OACpCrgD,MAAKi6B,WAAW2wB,kBAAkBpoD,IAAIiQ,EAEtC,IAAI0jC,GAAKn2C,KAAK2vC,cAAcj8B,KAAKlR,IAAI+9C,SAAgB,EAAU,EAAG9tC,EAClE0jC,GAAGqK,UAAU,SACbrK,EAAGsK,SAAS,EAAG,EAAG,IAAK,IACvBtK,EAAGuK,SAEH,IAAM0yB,GAAK3gE,EAAEwpD,OAAO,EAAG,EAAG,gBAC1Bj8D,MAAK2vC,cAAcstB,gBAAgBmW,EAAI,gBAEvC,IAAMhT,IAAa16D,KAAM,YAAaiP,KAAM,WACxC0+D,EAAYrzE,KAAK2vC,cAAcj8B,KAAKlR,IAAIwP,KAAY,GAAW,EAAG,SAAUouD,EAAW3tD,EAC3F4gE,GAAUzzE,KAAO,YACjB6S,EAAEM,GAAK/S,KAAK2vC,cAAcj8B,KAAKshC,MAAMhvC,MAAQqtE,EAAUrtE,OAAS,EAChEyM,EAAEuB,EAAIjR,UAAUC,SAAW,IAAM,IACjCyP,EAAE41B,MAAQ,GACVroC,KAAKi6B,WAAW2wB,kBAAkBjc,SAAU,IAI1DqiC,cAAe,WACd,GAAmD,IAA/ChxE,KAAKi6B,WAAW8wB,WAAW9Z,SAAS5vC,OAAc,CACrD,GAAIiyE,GAActzE,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QAC1CkzB,EAAYvzE,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,OAC5CizB,GAAY1zE,KAAO,cACnB2zE,EAAU3zE,KAAO,YACjBI,KAAKi6B,WAAW8wB,WAAWvoD,IAAI8wE,GAC/BtzE,KAAKi6B,WAAW8wB,WAAWvoD,IAAI+wE,EAE/B,IAAIC,GAAMxzE,KAAK2vC,cAAcj8B,KAAKlR,IAAI+9C,SAAgB,EAAU,EAAG+yB,GACnDG,EAAMzzE,KAAK2vC,cAAcj8B,KAAKlR,IAAI+9C,SAAgB,EAAU,EAAGgzB,EACnEC,GAAIhzB,UAAU,SACdgzB,EAAI/yB,SAAS,EAAG,EAAG,IAAK,IACxB+yB,EAAI9yB,UACJ+yB,EAAIjzB,UAAU,SACdizB,EAAIhzB,SAAS,EAAG,EAAG,IAAK,IACxBgzB,EAAI/yB,UAEhB4yB,EAAYrX,OAAc,GAAW,GAAI,gBACzCsX,EAAUtX,OAAc,GAAW,GAAI,aAE3B,IAAMmE,IAAa16D,KAAM,YAAaiP,KAAM,WACxC0+D,EAAYrzE,KAAK2vC,cAAcj8B,KAAKlR,IAAIwP,KAAY,GAAW,EAAG,qBAAsBouD,EAAWkT,EACvGD,GAAUzzE,KAAO,YAEjByzE,EAAYrzE,KAAK2vC,cAAcj8B,KAAKlR,IAAIwP,KAAY,GAAW,EAAG,iBAAkBouD,EAAWmT,GAC/FF,EAAUzzE,KAAO,YAEjB0zE,EAAY3kC,SAAU,EACtB4kC,EAAU5kC,SAAU,EACpB3uC,KAAKi6B,WAAW8wB,WAAW1iB,MAAQ,IAIjDkpC,kBAAmB,SAAUmC,EAAczxE,GAAM,GAAAib,GAAAld,KAAA84B,EACpB72B,MADoB0xE,EAAA76C,EACxC4d,aAAAA,EADwCp1C,SAAAqyE,KAAAA,CAMhD,OAJI1xE,IAEQjC,KAAK2vC,cAAc+tB,uBAExB19D,KAAK6yE,aAAan8B,IAAgBz0C,GAAMiH,KAAK,WAAA,MAAMgU,GAAK+c,WAAW35B,iBAAiBozE,EAAczxE,MAG1G4wE,aAAc,WAAkD,GAAxCe,GAAwCxyE,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,MAAAwc,EAAA5d,KAA3B6zE,IAA2BzyE,UAAAC,OAAA,GAAAC,SAAAF,UAAA,KAAAA,UAAA,GAAXipD,IAAWjpD,UAAAC,OAAA,GAAAC,SAAAF,UAAA,KAAAA,UAAA,GACzD+I,EAAUgT,OAAO8+C,OAAO,MACxB6X,KACEpgE,EAAS1T,KAAK2vC,cAAdj8B,KACKqgE,EAAkB,EACdziE,EAAuBoC,EAAvBpC,KAAM+H,EAAiB3F,EAAjB2F,MAAOG,EAAU9F,EAAV8F,MACfw6D,EAAuB,QAAUjxE,UAAU+L,QAAU,SAAW/L,UAAUstB,WAChFujD,GAASA,EAAOx4C,OAAO,SAAArC,GAAiB,GAAf/3B,GAAe+3B,EAAf/3B,KAAM0N,EAASqqB,EAATrqB,GAC3B,OAAI,QAAU1N,GACFwY,EAAM6E,cAAc3P,IAAQ4C,EAAKwM,SAAS,QAASpP,GACpD,UAAY1N,EACZgzE,GACAxgD,EAAAA,WAAWC,eAAe/kB,IAAQ8kB,EAAAA,WAAWE,eAAehlB,IAC5D8K,EAAM2E,cAAczP,IAAQ4C,EAAKwM,SAAS,QAASpP,GAHvD,QAMX,IAAIulE,GAAgB,IAChBJ,GAAa7zE,KAAKi6B,WAAW6V,UAAUc,MAAMvd,OAASrzB,KAAKi6B,WAAW6V,UAAUc,MAAMvd,MAAM3sB,KAAOstE,GAA8C,KAAtBjxE,UAAUmM,UACrI+kE,EAAgBj0E,KAAKi6B,WAAW6V,UAAUc,MAAMvd,MAAM3sB,IAClD8sB,EAAAA,WAAWC,eAAewgD,IAAmBzgD,EAAAA,WAAW0gD,aAAaD,GAGrEA,EAAgB,GAFhB3iE,EAAK6iE,iBAAkB,EAK/B,IAAIC,GAAiBP,EAAYD,EAAOvyE,OAASiQ,EAAK6iE,gBAC3DE,GAAiB,CACZ,OAAKD,GAIP,GAAIxyE,SAAQ,SAACC,EAASC,GAChB,GAAIwyE,GAAuC,KAAlBL,EACnBM,EAAoB,SAAC7lE,GACnBklE,EAAOvyE,OACPuyE,EAAOv2D,QAAQ,SAAAQ,GACRA,EAAMnP,MAAQA,GACTmP,IAAUA,EAAMxM,SAChBwM,EAAMxM,QAAS,EACf0iE,OAUZA,KAGdS,EAAgB,WACrB,GAAMC,GAAqBT,EACJ,KAAlBC,GAAwBJ,EAAkCD,EAAOr3C,MAAM,SAAAxqB,GAAA,MAAKA,GAAEV,SAAzCijE,EACvCR,EAAev3C,MAAM,SAAAljB,GAAA,MAASA,GAAMs8C,SACpB0e,IAAkBI,IACrBjhD,EAAAA,WAAWxkB,sBAAsBC,MAAQ,EACzCukB,EAAAA,WAAWxkB,sBAAsBqC,OAAS,EAC1CgI,EAAMa,cAAcwwC,UAAUvgD,GAC9BkP,EAAMQ,mBAAmB6wC,UAAUvgD,GAChCmH,EAAKC,kBAAkBm5C,UAAUvgD,GACjCmH,EAAKG,uBAAuBi5C,UAAUvgD,GACzCyT,EAAKqc,WAAWo/B,cAAc1qB,SAAU,EACxC9sC,KAEDyP,EAAKsN,eAAe8rC,UAAUvgD,IAE5BuqE,EAAwB,SAAChmE,GAC3B,GAAqB,KAAlBulE,IAAyBJ,EAAU,CAClC,GAAGnlE,IAAQulE,EAGP,MAFAK,IAAqB,EAK7B,IAAIV,EAAOr3C,MAAM,SAAAxqB,GAAA,MAAKA,GAAEV,UAAWgjE,KAAmB,GAA0B,KAAlBJ,EAA9D,CAGAM,EAAkB7lE,EAClB,IAAM8P,GAAWlQ,SAAS,IAAMylE,EAAkBK,EAClD/pB,IAAQzsC,EAAKojC,aAAaxiC,EAAUu1D,EAAiBK,EAAgBP,GACrED,EAAOr3C,MAAM,SAAAxqB,GAAA,MAAKA,GAAEV,WAAYgjE,GAAiB,IAASG,MAEpEG,EAAyB,SAACjmE,GAC/B,GAAItJ,MACEiU,EAAQG,EAAM+F,SAAS7Q,IACxBtJ,EAAQ0uE,EAAevhD,UAAU,SAAAxtB,GAAA,MAAKA,KAAMsU,YAChDy6D,EAAe/0D,OAAO3Z,EAAO,GAC7BoU,EAAM4E,YAAY1P,IAEnB8lE,IAEDn7D,GAAMa,cAAc1X,IAAI,WAAA,MAAMgyE,MAAiBrqE,GAC/CkP,EAAMQ,mBAAmBrX,IAAImyE,EAAwBxqE,GACzCmH,EAAKC,kBAAkB/O,IAAIkyE,EAAuBvqE,GAClDmH,EAAKG,uBAAuBjP,IAAIkyE,EAAuBvqE,GAEnEmH,EAAKsN,eAAepc,IAAI,SAACgc,EAAUC,EAAUzR,EAAS0R,EAAaC,GAMlE,GALA41D,EAAkB91D,GAElBD,EAAWlQ,SAAS,IAAMylE,EAAkBK,GAC5C/pB,GAAQzsC,EAAKojC,aAAaxiC,EAAUu1D,EAAiBK,EAAgBP,GAElEr6D,EAAMo7D,SAASx4D,OAAOiD,MAAM22C,MAAOv3C,GAAU,CAC/C,GAAMpF,GAAQG,EAAM+F,SAASd,EACzBpF,IAASA,EAAMw7D,YAAcx7D,EAAMu8C,aAAgBv8C,EAAMs8C,SAC5Dme,EAAevwD,KAAKlK,GAIlBu6D,EAAOvyE,QAAUuyE,EAAOr3C,MAAM,SAAAxqB,GAAA,MAAKA,GAAEV,WACxCgjE,GAAiB,EACjBG,MAECrqE,EAAS,GACZmH,EAAK0sD,eAAeF,QAAQ,WACvBuW,IACHA,GAAiB,EACjBG,MAECrqE,EAAS,GAEAiqE,GAAkBx2D,EAAKojC,aAAa,EAAG,EAAG,EAAG6yB,GACzDviE,EAAK+pB,UAhGcz5B,QAAQC,WAoG7BywC,SAAU,WAAY,GAAA3d,GAAA30B,KAAA80E,EACQ90E,KAAKi6B,WAA3B6V,EADcglC,EACdhlC,UAAW3lC,EADG2qE,EACH3qE,QACXwmC,EAAyBb,EAAzBa,KAAgBC,GAASd,EAAnB9d,SAAmB8d,EAATc,MACvB,IAAKD,GAASA,EAAKzsC,aAAcysC,EAAKzsC,WAAW42C,QAAW96C,KAAK2vC,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAcsyB,EAAKzsC,WAAWwC,KAA7H,CAHqB,GAAAquE,GAMGpkC,EAAKzsC,WAAtBs/D,EANcuR,EAMdvR,KAAMxd,EANQ+uB,EAMR/uB,OACJhmD,MAAKi6B,WAAWuS,aAAexsC,KAAKi6B,WAAWqrB,aAC/CtlD,KAAKi6B,WAAWqrB,aAAe3U,EAAKzsC,WAAWwC,IAC/C1G,KAAKi6B,WAAWurB,iBAAmB7U,EAAKzsC,WAAW8hD,QACnDhmD,KAAKi6B,WAAWyrB,cAAgB8d,CACzC,IAAMwR,GAAYh1E,KAAK2vC,cAAcj8B,KAAKlR,IAAI0wB,MAAM,EAAG,EAAGyd,EAAKzsC,WAAWwC,IAC1E1G,MAAKi1E,eAAeD,EAAWxR,GAC/BwR,EAAUnqB,aACVmqB,EAAU3sC,MAAQ,EAClBroC,KAAKkzE,eAAe8B,GAAY3sC,MAAO2d,GAAU,IAAM,MAAM,EAAM,GACjE98C,KAAK,WAAA,MAAMzB,GAAAA,WAAM8E,QAAQ,OACzBrD,KAAK,WAAA,MAAMyrB,GAAKu+C,eAAe8B,GAAY3sC,MAAO,GAAI,IAAM,MAAM,EAAM,GAAGn/B,KAAK,WAC/E,GAAK0nC,EAAMkK,OAEJ,CACN,GAAIhpB,GAAU6C,EAAKsF,WAAW4d,mBACxBne,EAAc5H,EAAQ6H,aAAe7H,EAAQ6H,aAAe7H,EAAQvmB,IACrD,IAAIumB,EAAQ2H,KAAgC,IAAzB3H,EAAQ6E,MAAMt1B,OAAc,CAE3C,GAAGszB,EAAKsF,WAAWqT,aAAa,CAC5B,GAAMwK,GAAY,SAACnhB,GACF,OAAVA,EACCnqB,EAAAA,WAAOsf,MAAM,cACE,SAAV6K,EAELnqB,EAAAA,WAAOC,OAAO,QAAQ,kDAAkD,KAAK,OAAO,MAAK,GAAOvD,KAAK,YACjG,EAAA6uC,EAAAA,YAAK,aACDC,OAAO,EACP/pC,QAAS,UAEf,eAGF6jB,EAAQ6E,MAAQA,EAAQA,KACxBhC,EAAKsF,WAAWsc,qBAAqB5hB,EAAKsF,WAAW9vB,QAAS2nB,IAItE,YADA6C,GAAKsF,WAAWge,wBAAwBve,EAAY5H,EAAQomB,OAAOpmB,EAAQ2H,IAAIqe,GAGnF,IAAIhmB,EAAQomB,QAAW,YAAcn1C,UAAU+L,QAAU,QAAU/L,UAAU+L,QAA+B,QAArB/L,UAAU+L,OAqB7F6lB,EAAKsF,WAAWC,mBAAmBR,EAAa5H,EAAQ2H,KAAKvwB,KAAK,SAACytB,GAAQ,GAAAqxB,IACvEA,EAAAl2B,EAAQ6E,OAAMpT,KAAd3G,MAAAorC,EAAA98B,EAAsByL,IACtBhC,EAAKsF,WAAWsc,qBAAqBpsC,EAAS2nB,IAC/C,SAAC3oB,QACWA,EAAIiR,QAAQ,WACnB5N,EAAAA,WAAOsf,MAAM3iB,GAEQ,WAAlBpG,UAAUye,IACThV,EAAAA,WAAO4rC,KAAK,uBAAuBlvC,KAAK,WACpC1N,OAAOkR,SAAS2rC,KAAO,uDAAwDt1C,UAAUwG,MAG7FiD,EAAAA,WAAO4rC,KAAK,kCAjCwF,CAChH,GAAMG,GAAe,SAACC,GACdA,EACA7jB,EAAKsF,WAAWC,mBAAmBR,EAAa5H,EAAQ2H,KAAKvwB,KAAK,SAACytB,GAAQ,GAAAoxB,EACvEpzB,GAAKsF,WAAW4R,sBAAwB,MACxCkc,EAAAj2B,EAAQ6E,OAAMpT,KAAd3G,MAAAmrC,EAAA78B,EAAsByL,IACtBhC,EAAKsF,WAAWsc,qBAAqBpsC,EAAS2nB,IAC/C,WACyB,QAArB/uB,UAAU+L,OACTtT,OAAOqE,QAAUrE,OAAOqE,OAAO44C,YAE/BjsC,EAAAA,WAAOsf,MAAM,gBAIrBtf,EAAAA,WAAOsf,MAAM,UAIrB6I,GAAKsF,WAAWye,cAAchf,EAAa5H,EAAQomB,OAAQpmB,EAAQ2H,IAAK8e,QAqB/E5jB,GAAKsF,WAAWsc,qBAAqBpsC,EAAS2nB,OAnEpE6C,GAAKsF,WAAWsY,kBA0ErByO,aAAc,SAAUxiC,EAAUE,EAAaC,EAAYk1D,GAC1D,GAAI3vE,GAAalE,KAAKi6B,WAAWo/B,cAAc/Y,UAAU,cACrD40B,EAAQl1E,KAAKi6B,WAAWo/B,cAAc/Y,UAAU,SAChD60B,EAAQn1E,KAAKi6B,WAAWo/B,cAAc/Y,UAAU,SAC9Ct6C,EAAQhG,KAAK2vC,cAAcj8B,KAAKshC,MAAMhvC,MACtCG,EAASnG,KAAK2vC,cAAcj8B,KAAKshC,MAAM7uC,MAW7C,IATKjC,IACJA,EAAalE,KAAK2vC,cAAcj8B,KAAKlR,IAAI+9C,SAAS,EAAG,EAAGvgD,KAAKi6B,WAAWo/B,eACxEn1D,EAAWs8C,UAAU,GACrBt8C,EAAWu8C,SAAS,EAAG,EAAGz6C,EAAOG,GACjCjC,EAAWw8C,UACXx8C,EAAWtE,KAAO,aAClBsE,EAAW6yC,cAAe,GAGvB88B,EAAW,CAGd3vE,EAAWmkC,MAAQ,GACd8sC,IACJA,EAAQn1E,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QACpC80B,EAAMv1E,KAAO,QACbI,KAAKi6B,WAAWo/B,cAAc72D,IAAI2yE,GAGvB,IAAIC,GAAeD,EAAM70B,UAAU,eACnC,KAAK80B,EAAc,CACf,GAAMC,IAAc3vE,KAAM,YAAaiP,KAAM,UAAWgsC,aAAc,SAAUC,aAAc,SAC9Fw0B,GAAep1E,KAAK2vC,cAAcj8B,KAAKlR,IAAIwP,KAAK,EAAG,EAAG,GAAIqjE,EAAWF,GACrEC,EAAax1E,KAAO,eACpBw1E,EAAav0B,cAAc76C,EAAQ,EAAI,GAAIG,EAAS,EAAI,GAAI,IAAK,IAErEivE,EAAapjE,KAAO,SAAWwM,EAAW,IAEtD02D,IAAUA,EAAMvmC,SAAU,GAC1BwmC,IAAUA,EAAMxmC,SAAU,GAC1B3uC,KAAKi6B,WAAWo/B,cAAcxO,WAAWsqB,OACnC,CAENjxE,EAAWmkC,MAAQ,EACd6sC,IACJA,EAAQl1E,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QACpC60B,EAAMt1E,KAAO,QACbI,KAAKi6B,WAAWo/B,cAAc72D,IAAI0yE,GAEnC,IAAIE,GAAeF,EAAM50B,UAAU,gBAC/Bg1B,EAAUJ,EAAM50B,UAAU,WAE1Bi1B,GADcL,EAAM50B,UAAU,eACnB40B,EAAM50B,UAAU,YAE/B,KAAK80B,EAAc,CAElB,GAAMC,IAAa3vE,KAAK,YAAaiP,KAAM,UAAWgsC,aAAc,SAAUC,aAAc,SAASxrC,MAAM,SAASnD,UAAS,EAC7HmjE,GAAep1E,KAAK2vC,cAAcj8B,KAAKlR,IAAIwP,KAAK,EAAG,EAAG,GAAIqjE,EAAWH,GACrEE,EAAax1E,KAAO,eAELw1E,EAAav0B,cAAc,GAAI99C,UAAUC,SAAYmD,EAAS,EAAI,GAAM,IAAKH,EAAM,GAAI,IAEvG,GAAIwvE,GAAa,OAAUx1E,KAAKi6B,WAAW8P,aAAa7iC,KAAK4lB,MAAM5lB,KAAK+I,SAASjQ,KAAKi6B,WAAW8P,aAAa1oC,QAC9G,IAAG0B,UAAUC,UACMwyE,EAAWn0E,OAAS,GAAG,CACtB,GAAMo0E,GAASD,EAAWnjE,MAAM,GAChCojE,GAAO12D,OAAO,GAAG,EAAE,MACnBy2D,EAAaC,EAAOrzD,KAAK,IAAI3X,WAGlC1H,UAAUuf,QAAgC,MAAtBvf,UAAUmM,UAAiBkmE,EAAazmC,SAAU,GACpD,IAArBymC,EAAapjE,OAAeojE,EAAapjE,KAAMwjE,GAGtDD,IAEJA,EAAWv1E,KAAK2vC,cAAcj8B,KAAKlR,IAAI0wB,OAAOltB,EAAQovE,EAAapvE,MAAQ,IAAM,EAAEjD,UAAUC,SAAYwyE,EAAWn0E,OAAS,GAAM8E,EAAS,EAAI,GAAOA,EAAS,EAAI,GAAO,IAAM,QAAS,EAAG+uE,GAC7LK,EAAS31E,KAAO,YAEFmD,UAAUuf,QAAgC,MAAtBvf,UAAUmM,UAAiBqmE,EAAS5mC,SAAU,GAC5E2mC,IACJA,EAAUt1E,KAAK2vC,cAAcj8B,KAAKlR,IAAIwP,KAAK,EAAG,EAAG,IAAKtM,KAAM,YAAaiP,KAAM,UAAWgsC,aAAc,SAAUC,aAAc,UAAWs0B,GAC5HI,EAAQzY,OAAO13C,IAAI,GAAI,IACtCmwD,EAAQ11E,KAAO,WAEhB01E,EAAQ3mC,QAAUnwB,EAAW,EAE7B82D,EAAQz0B,cAAc76C,EAAQ,EAAEjD,UAAUC,SAAYmD,EAAS,EAAI,GAAM,IAAI,GAAG,IAChFmvE,EAAQtjE,KAAOwM,EAAW,IAC1B02D,IAAUA,EAAMvmC,SAAU,GAC1BwmC,IAAUA,EAAMxmC,SAAU,GAC1B3uC,KAAKi6B,WAAWo/B,cAAcxO,WAAWqqB,GAE1Cl1E,KAAKi6B,WAAWo/B,cAAc1qB,SAAU,EACxC3uC,KAAK2vC,cAAcj8B,KAAKshC,MAAM6V,WAAW7qD,KAAKi6B,WAAWo/B,eAChDr5D,KAAKi6B,WAAWmO,eAAeC,OAASroC,KAAK2vC,cAAcj8B,KAAKshC,MAAM6V,WAAW7qD,KAAKi6B,WAAWmO,iBAG3GstC,eAAgB,WAAY,GAAA9S,GAC0C5iE,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAK2L,OAAtGptC,EADoB0+D,EACpB1+D,WAAYsqD,EADQoU,EACRpU,KAAMjd,EADEqxB,EACFrxB,gBAAiBH,EADfwxB,EACexxB,eAAgB5tC,EAD/Bo/D,EAC+Bp/D,OAE1D,IAAoD,IAAhDxD,KAAKi6B,WAAWw4B,YAAYxhB,SAAS5vC,OAAc,CAGtD,GAAI0R,GAAAA,OAAGiB,EAAAA,OAAGrC,EAAAA,MAGV,IAAI3R,KAAK2vC,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAcna,EAAWwC,KAAM,CACrE,GAAMivE,GAAY31E,KAAKi6B,WAAWw4B,YAAYwJ,OAAO,EAAG,EAAG/3D,EAAWwC,IACtEivE,GAAU3vE,MAAQwoD,EAAKxoD,MACvB2vE,EAAUxvE,OAASqoD,EAAKroD,OACxBwvE,EAAU/1E,KAAO,YAKlB,GAFAmT,EAAIq+B,EAAeod,KAAKz7C,EACxBiB,EAAIo9B,EAAeod,KAAKx6C,EACpBhU,KAAK2vC,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAc+yB,EAAeltC,WAAWwC,KAAM,CACpF,GAAMkvE,GAAkB51E,KAAKi6B,WAAWw4B,YAAYwJ,OAAOlpD,EAAGiB,EAAGo9B,EAAeltC,WAAWwC,IAC3FkvE,GAAgB5vE,MAAQorC,EAAeod,KAAKxoD,MAC5C4vE,EAAgBzvE,OAASirC,EAAeod,KAAKroD,OAC7CyvE,EAAgBh2E,KAAO,kBAGxB,GAAIoE,GAAAA,MACJ+O,GAAIq+B,EAAeod,KAAKz7C,EAAIq+B,EAAetwC,MAAM0tD,KAAKz7C,EACtDiB,EAAIo9B,EAAeod,KAAKx6C,EAAIo9B,EAAetwC,MAAM0tD,KAAKx6C,EAC1ChQ,EAAMhE,KAAK2vC,cAAcj8B,KAAKlR,IAAIwP,KAAK,EAAG,EAAG,IAAK2C,KAAK,QAAS3U,KAAKi6B,WAAWw4B,aAChFzuD,EAAIpE,KAAO,oBACXoE,EAAI68C,cAAc9tC,GAAKq+B,EAAetwC,MAAM0tD,KAAKxoD,MAAQorC,EAAeod,KAAKxoD,OAAS,EAAGgO,EAAGo9B,EAAeod,KAAKxoD,MAAOorC,EAAeod,KAAKroD,QAEnJnG,KAAK2vC,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAckzB,EAAgBrtC,WAAWwC,OAC/EqM,EAAIw+B,EAAgBid,KAAKz7C,EACzBiB,EAAIu9B,EAAgBid,KAAKx6C,EACzBrC,EAAU3R,KAAKi6B,WAAWw4B,YAAYwJ,OAAOlpD,EAAGiB,EAAGu9B,EAAgBrtC,WAAWwC,KAC9EiL,EAAQ3L,MAAQurC,EAAgBid,KAAKxoD,MACrC2L,EAAQxL,OAASorC,EAAgBid,KAAKroD,OACtCwL,EAAQ/R,KAAO,oBAGhBmT,EAAIw+B,EAAgBid,KAAKz7C,EAAIw+B,EAAgBpT,OAAOprB,EACpDiB,EAAIu9B,EAAgBid,KAAKx6C,EAAIu9B,EAAgBpT,OAAOnqB,CACpD,IAAMmqB,GAASn+B,KAAKi6B,WAAWw4B,YAAYwJ,OAAOlpD,EAAGiB,EACrDmqB,GAAOv+B,KAAO,gBACdu+B,EAAOn4B,MAAQurC,EAAgBpT,OAAOn4B,MACtCm4B,EAAOh4B,OAASorC,EAAgBpT,OAAOh4B,OAEvCnC,EAAMhE,KAAK2vC,cAAcj8B,KAAKlR,IAAIwP,KAAKxO,EAAQgrD,KAAKz7C,EACjDvP,EAAQgrD,KAAKx6C,EACb,IACCW,KAAK,OAAQgsC,aAAc,OAAQC,aAAc,MAAO3uC,UAAU,EAAM8D,cAAevS,EAAQgrD,KAAKxoD,OACrGhG,KAAKi6B,WAAWw4B,aACnBzuD,EAAIpE,KAAO,sBACXoE,EAAIuoE,iBAAkB,EACtBvoE,EAAIwoE,WAAahR,EAAAA,WAASgR,WAC1BxoE,EAAIyoE,iBAAmBjR,EAAAA,WAASiR,iBAGjCzsE,KAAKi6B,WAAWw4B,YAAY1/C,EAAIy7C,EAAKz7C,EACrC/S,KAAKi6B,WAAWw4B,YAAYz+C,EAAIw6C,EAAKx6C,EACrChU,KAAKi6B,WAAWw4B,YAAYpqB,MAAQ,EACpCroC,KAAKi6B,WAAWw4B,YAAY9jB,SAAU,EACtC3uC,KAAK2vC,cAAcj8B,KAAKshC,MAAM6V,WAAW7qD,KAAKi6B,WAAWw4B,aACzDzyD,KAAK2vC,cAAcj8B,KAAKshC,MAAM6V,WAAW7qD,KAAKi6B,WAAW6U,WAChD9uC,KAAKi6B,WAAWmO,eAAeC,OAASroC,KAAK2vC,cAAcj8B,KAAKshC,MAAM6V,WAAW7qD,KAAKi6B,WAAWmO,iBAG3GytC,aAAc,SAAUC,GAAW,GAAAlhD,GAAA50B,IAClC,IAAkD,IAA9CA,KAAKi6B,WAAW6U,UAAUmC,SAAS5vC,OAAc,CAAA,GAAAwiE,GACT7jE,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKkD,KAAhE2lB,EADiCqV,EACjCrV,KAAMzvB,EAD2B8kC,EAC3B9kC,OAAQC,EADmB6kC,EACnB7kC,OACf+2C,EAAe,SAAChoE,EAAK+xD,GAClCA,EAAQsD,cAAgBhnD,OAAOinD,YAAYC,QAA6B,IAAnBxD,EAAQC,SAGzC,gBAApBhyD,EAAIlO,OAAOD,KACIg1B,EAAKqF,WAAW+e,mBACJ,uBAApBjrC,EAAIlO,OAAOD,KACrBg1B,EAAKqF,WAAWkf,qBACa,qBAApBprC,EAAIlO,OAAOD,MACFg1B,EAAKqF,WAAWgf,yBAI9BpiB,IACNA,GAAEkI,OAASA,EAAO/sB,KAClB6kB,EAAEmI,OAASA,EAAOhtB,KAClB6kB,EAAE7kB,KAAO,IACT,IAAMgkE,GAAUh2E,KAAK2vC,cAAc4uB,UAAUuX,EAAYtnB,EAAKz7C,EAAI,EAAG+iE,EAAYtnB,EAAKx6C,EAAI,EAAGw6C,EAAKxoD,MAAOwoD,EAAKroD,OAAQ44B,EAAO76B,WAAWwC,IAAKs4B,EAAO96B,WAAWwC,IAC5JqvE,EAAcl/C,EAAG72B,KAAKi6B,WAAWq/B,UAAW,cAAet5D,KAAKi6B,WAAW6U,UAC9E,IAAG/rC,UAAUuf,QAAgC,MAAtBvf,UAAUmM,QACjB8mE,EAAQjjE,EAAIhQ,UAAUC,SAAW,IAAM,IACvCgzE,EAAQhiE,EAAI,GACY,YAArBjR,UAAU+L,QACT9O,KAAK2vC,cAAc4uB,UAAUx7D,UAAUC,SAAW,IAAM,IAAK,IAAK,GAAI,GAAI,WAAY,gBAChF+yE,EAAcl/C,EAAG72B,KAAKi6B,WAAWq/B,UAAW,mBAAoBt5D,KAAKi6B,WAAW6U,eAG1F,IAAI9uC,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAK8L,WAAY,CAAA,GAAAwkC,GACIj2E,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAK8L,WAApFykC,EADwCD,EAC7CznB,KAAoB2nB,EADyBF,EAChCl3C,OAAwBq3C,EADQH,EACfj3C,MACrCnI,GAAEkI,OAASo3C,EAASnkE,KACpB6kB,EAAEmI,OAASo3C,EAASpkE,KACpB6kB,EAAE7kB,KAAO,KACThS,KAAK2vC,cAAc4uB,UAAU2X,EAAOnjE,EAAGmjE,EAAOliE,EAAGkiE,EAAOlwE,MAAOkwE,EAAO/vE,OAA4B,QAApBpD,UAAU+L,OAAkB,UAAYqnE,EAASjyE,WAAWwC,IAAyB,QAApB3D,UAAU+L,OAAkB,UAAYsnE,EAASlyE,WAAWwC,IACrMqvE,EAAmC,QAArBhzE,UAAU+L,OAAmB,GAAK+nB,EAAG72B,KAAKi6B,WAAWq/B,UAAW,qBAAsBt5D,KAAKi6B,WAAW6U,eAElG,QAArB/rC,UAAU+L,QACT9O,KAAK2vC,cAAc4uB,UAAUx7D,UAAUC,SAAW,IAAM,IAAKD,UAAU+L,OAAS,GAAK,GAAI,GAAI,GAAI,UAAW,UACtGinE,EAAc,GAAI/1E,KAAKi6B,WAAWq/B,UAAW,qBAAsBt5D,KAAKi6B,WAAW6U,WAKlH9uC,KAAK2vC,cAAcj8B,KAAKshC,MAAM6V,WAAW7qD,KAAKi6B,WAAW6U,WACzD9uC,KAAKi6B,WAAW6U,UAAUH,SAAU,GAG/B0nC,mBAAoB,SAAUh2B,GAC1B,GAAMi2B,GAAc,QAAdA,GAAelxE,GACjBqC,EAAAA,WAAM8E,QAAQ,IAAIrD,KAAK,WACtB,GAA8B,IAA1Bm3C,EAAMpP,SAAS5vC,OAAnB,CAGZ,IAAKg/C,EAAM1R,QAEE,WADA2nC,GAAYlxE,EAGN,KAAMA,EACNi7C,EAAMpP,SAASoP,EAAMpP,SAAS5vC,OAAO,GAAGstC,SAAU,EAGlD0R,EAAMpP,SAAS7rC,EAAM,GAAGupC,SAAU,EAEtC0R,EAAMpP,SAAS7rC,GAAOupC,SAAU,EAChC2nC,IAAclxE,EAAQi7C,EAAMpP,SAAS5vC,WAI7Ci1E,GAAY,IAGtBC,cAAe,WACd,GAAIC,GAAOx2E,KAAKi6B,WAAWwpB,aAAanD,UAAU,OAClD,KAAKk2B,EAAM,CACVA,EAAOx2E,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QACnCm2B,EAAK52E,KAAO,OACZI,KAAKi6B,WAAWwpB,aAAajhD,IAAIg0E,EAEjC,KAAK,GADCC,MACGhwE,EAAE,EAAGA,EAAE,GAAIA,IACnBgwE,EAAMhwE,GAAKzG,KAAK2vC,cAAcj8B,KAAKlR,IAAIurD,OAAO,EAAG,EAAtC,IAA6CtmD,EAAAA,WAAMs2B,4BAAnD,IAAkFt2B,EAAAA,WAAMu2B,uBAAuB,QAA/G,UAAgIv2B,EAAAA,WAAMw2B,UAAUx3B,GAAhJ,QACI+vE,EAAKh0E,IAAIi0E,EAAMhwE,IACfgwE,EAAMhwE,GAAGkoC,SAAU,CAEvB3uC,MAAKq2E,mBAAmBG,GAErCx2E,KAAKi6B,WAAWwpB,aAAa9U,SAAU,EACvC6nC,EAAK7nC,SAAU,EACf3uC,KAAKi6B,WAAWwpB,aAAaoH,WAAW2rB,IAGzCE,cAAe,WACd,GAAIC,GAAO32E,KAAKi6B,WAAWwpB,aAAanD,UAAU,OAClD,KAAKq2B,EAAM,CACVA,EAAO32E,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QACnCs2B,EAAK/2E,KAAO,OACZI,KAAKi6B,WAAWwpB,aAAajhD,IAAIm0E,EAEjC,KAAK,GADCC,MACGnwE,EAAE,EAAGA,EAAE,IAAKA,IACpBmwE,EAAMnwE,GAAKzG,KAAK2vC,cAAcj8B,KAAKlR,IAAIurD,OAAO,EAAG,EAAtC,IAA6CtmD,EAAAA,WAAMs2B,4BAAnD,IAAkFt2B,EAAAA,WAAMu2B,uBAAuB,QAA/G,WAAkIv2B,EAAAA,WAAMw2B,UAAUx3B,GAAlJ,QACXkwE,EAAKn0E,IAAIo0E,EAAMnwE,IACfmwE,EAAMnwE,GAAGkoC,SAAU,CAEpB3uC,MAAKq2E,mBAAmBM,GAEzB32E,KAAKi6B,WAAWwpB,aAAa9U,SAAU,EACvCgoC,EAAKhoC,SAAU,EACf3uC,KAAKi6B,WAAWwpB,aAAaoH,WAAW8rB,IAGzCE,cAAe,WACd,GAAIC,GAAO92E,KAAKi6B,WAAWwpB,aAAanD,UAAU,OAClD,KAAKw2B,EAIJ,GAHAA,EAAO92E,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QACnCy2B,EAAKl3E,KAAO,OACZI,KAAKi6B,WAAWwpB,aAAajhD,IAAIs0E,GAC9B/zE,UAAUC,SAAS,CAEN,IAAK,GADC+zE,MACGtwE,EAAE,EAAGA,EAAE,GAAIA,IAChBswE,EAAMtwE,GAAKzG,KAAK2vC,cAAcj8B,KAAKlR,IAAIurD,OAAO,EAAG,EAAtC,IAA6CtmD,EAAAA,WAAMs2B,4BAAnD,IAAkFt2B,EAAAA,WAAMu2B,uBAAuB,QAA/G,SAA+Hv2B,EAAAA,WAAMw2B,UAAUx3B,GAA/I,QACXqwE,EAAKt0E,IAAIu0E,EAAMtwE,IACfswE,EAAMtwE,GAAGkoC,SAAU,CAEvB3uC,MAAKq2E,mBAAmBS,OAExB92E,MAAK2vC,cAAcj8B,KAAKlR,IAAIw0E,WAAW,EAAG,EAAG,IAAK,IAAK,OAAQ,EAAGF,GAAMG,gBAAiB,EAG1Gj3E,MAAKi6B,WAAWwpB,aAAa9U,SAAU,EACvCmoC,EAAKnoC,SAAU,EACf3uC,KAAKi6B,WAAWwpB,aAAaoH,WAAWisB,IAGnCI,uBAAwB,WACpB,GAAIC,GAAUn3E,KAAKi6B,WAAWwpB,aAAanD,UAAU,gBACrD,KAAK62B,EAAS,CACVA,EAAUn3E,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QACtC82B,EAAQv3E,KAAO,gBACfI,KAAKi6B,WAAWwpB,aAAajhD,IAAI20E,EAEjC,KAAK,GADCC,MACG3wE,EAAE,EAAGA,EAAE,GAAIA,IAChB2wE,EAAS3wE,GAAKzG,KAAK2vC,cAAcj8B,KAAKlR,IAAIurD,OAAO,EAAG,EAAtC,IAA6CtmD,EAAAA,WAAMs2B,4BAAnD,IAAkFt2B,EAAAA,WAAMu2B,uBAAuB,eAA/G,WAAwIv2B,EAAAA,WAAMw2B,UAAUx3B,GAAxJ,QACd0wE,EAAQ30E,IAAI40E,EAAS3wE,IACrB2wE,EAAS3wE,GAAGkoC,SAAU,CAE1B3uC,MAAKq2E,mBAAmBc,GAE5Bn3E,KAAKi6B,WAAWwpB,aAAa9U,SAAU,EACvCwoC,EAAQxoC,SAAU,EAClB3uC,KAAKi6B,WAAWwpB,aAAaoH,WAAWssB,IAG5CE,sBAAuB,WACnB,GAAIC,GAAet3E,KAAKi6B,WAAWwpB,aAAanD,UAAU,eAC1D,KAAKg3B,EAAc,CACfA,EAAet3E,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QAC3Ci3B,EAAa13E,KAAO,eACpBI,KAAKi6B,WAAWwpB,aAAajhD,IAAI80E,EAEjC,KAAK,GADCC,MACG9wE,EAAE,EAAGA,EAAE,GAAIA,IAChB8wE,EAAc9wE,GAAKzG,KAAK2vC,cAAcj8B,KAAKlR,IAAIurD,OAAO,EAAG,EAAtC,IAA6CtmD,EAAAA,WAAMs2B,4BAAnD,IAAkFt2B,EAAAA,WAAMu2B,uBAAuB,gBAA/G,WAAyIv2B,EAAAA,WAAMw2B,UAAUx3B,GAAzJ,QACnB6wE,EAAa90E,IAAI+0E,EAAc9wE,IAC/B8wE,EAAc9wE,GAAGkoC,SAAU,CAE/B3uC,MAAKq2E,mBAAmBiB,GAE5Bt3E,KAAKi6B,WAAWwpB,aAAa9U,SAAU,EACvC2oC,EAAa3oC,SAAU,EACvB3uC,KAAKi6B,WAAWwpB,aAAaoH,WAAWysB,IAG5CE,iBAAkB,WACd,GAAIC,GAAUz3E,KAAKi6B,WAAWwpB,aAAanD,UAAU,UACrD,KAAKm3B,EAAS,CACVA,EAAUz3E,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QACtCo3B,EAAQ73E,KAAO,UACfI,KAAKi6B,WAAWwpB,aAAajhD,IAAIi1E,EAEjC,KAAK,GADCC,MACGjxE,EAAE,EAAGA,EAAE,GAAIA,IAChBixE,EAASjxE,GAAKzG,KAAK2vC,cAAcj8B,KAAKlR,IAAIurD,OAAO,EAAG,EAAtC,IAA6CtmD,EAAAA,WAAMs2B,4BAAnD,IAAkFt2B,EAAAA,WAAMu2B,uBAAuB,WAA/G,YAAqIv2B,EAAAA,WAAMw2B,UAAUx3B,GAArJ,QACdgxE,EAAQj1E,IAAIk1E,EAASjxE,IACrBixE,EAASjxE,GAAGkoC,SAAU,CAEtC3uC,MAAKq2E,mBAAmBoB,GAEhBz3E,KAAKi6B,WAAWwpB,aAAa9U,SAAU,EACvC8oC,EAAQ9oC,SAAU,EAClB3uC,KAAKi6B,WAAWwpB,aAAaoH,WAAW4sB,IAG5CE,mBAAoB,WAChB,GAAIC,GAAY53E,KAAKi6B,WAAWwpB,aAAanD,UAAU,YACvD,KAAKs3B,EAAW,CACZA,EAAY53E,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,QACxCu3B,EAAUh4E,KAAO,YACjBI,KAAKi6B,WAAWwpB,aAAajhD,IAAIo1E,EAEjC,KAAK,GADCC,MACGpxE,EAAE,EAAGA,EAAE,GAAIA,IAChBoxE,EAAWpxE,GAAKzG,KAAK2vC,cAAcj8B,KAAKlR,IAAIurD,OAAO,EAAG,EAAtC,IAA6CtmD,EAAAA,WAAMs2B,4BAAnD,IAAkFt2B,EAAAA,WAAMu2B,uBAAuB,aAA/G,aAAwIv2B,EAAAA,WAAMw2B,UAAUx3B,GAAxJ,QAChBmxE,EAAUp1E,IAAIq1E,EAAWpxE,IACzBoxE,EAAWpxE,GAAGkoC,SAAU,CAExC3uC,MAAKq2E,mBAAmBuB,GAEhB53E,KAAKi6B,WAAWwpB,aAAa9U,SAAU,EACvCipC,EAAUjpC,SAAU,EACpB3uC,KAAKi6B,WAAWwpB,aAAaoH,WAAW+sB,IAGlD3O,gBAAiB,SAAU6O,EAASC,EAAcC,GAAS,GAAAviD,GAAAz1B,KACnDgxC,EAAWhxC,KAAKi6B,WAAW6V,UAA3BkB,QACD/6B,EAAM,SAAA66B,GACC,IAAK,GAAI5iC,KAAK4iC,GACa,YAAnBA,EAAO5iC,GAAGlN,OACVy0B,EAAKka,cAAcj8B,KAAKooD,MAAMwU,SAASuB,UAAU/gC,EAAO5iC,GAAG+pE,SAC3DD,EAAQlnC,EAAO5iC,GAAG+pE,SAAWxiD,EAAKka,cAAcj8B,KAAKooD,MAAMwU,SAASC,OAAOz/B,EAAO5iC,GAAG+pE,WAIpGC,EAAQ,QAARA,GAAS3sE,GACd0K,EAAI+6B,EAAQzlC,GAAMulC,OAEN,KAAK,GAAIrqC,KAAKuqC,GAAQzlC,GAAM0lC,SACxBinC,EAAMlnC,EAAQzlC,GAAM0lC,SAASxqC,GAAGw8C,KAChChtC,EAAI+6B,EAAQzlC,GAAM0lC,SAASxqC,GAAGqqC,QAI/ConC,GAAMJ,GACN7hE,EAAI8hE,IAGLI,cAAe,SAAUH,GACxB,IAAK,GAAI9mE,KAAK8mE,GACbh4E,KAAK2vC,cAAcj8B,KAAKooD,MAAMwU,SAASuB,UAAU3gE,GACjD8mE,EAAQj5D,OAAO7N,EAAG,IAIpBknE,wBAAyB,SAAU3xC,EAAMuxC,GAAS,GAAAr8C,GAAA37B,KACjCgxC,EAAWhxC,KAAKi6B,WAAW6V,UAA3BkB,QACDqnC,EAAQ,SAAAvnC,GACV,IAAK,GAAI5iC,KAAK4iC,GACa,YAAnBA,EAAO5iC,GAAGlN,OACV26B,EAAKgU,cAAcj8B,KAAKooD,MAAMwU,SAASuB,UAAU/gC,EAAO5iC,GAAG+pE,SAC3DD,EAAQj5D,OAAO+xB,EAAO5iC,GAAG+pE,QAAQ,KAIvCK,EAAU,QAAVA,GAAW3oE,GACbA,EAAE/P,MAAQoxC,EAAQrhC,EAAE/P,OAASy4E,EAAMrnC,EAAQrhC,EAAE/P,MAAMkxC,OAEnD,KAAK,GAAIrqC,KAAKkJ,GAAEshC,SACZqnC,EAAQ3oE,EAAEshC,SAASxqC,IAI3B6xE,GAAQ7xC,IAGlB8xC,cAAe,SAAUC,GACxB,IAAKx4E,KAAKi6B,WAAWirB,YAAa,CACjCllD,KAAKi6B,WAAWirB,eAChBllD,KAAKi6B,WAAW0/B,iBAChB,IAAM5H,GAAQ/xD,KAAKi6B,WAAW6V,UAAUiiB,KACxC,KAAK,GAAI99C,KAAK89C,GACb/xD,KAAKipE,gBAAgBlX,EAAM99C,GAAGgvC,IAAK8O,EAAM99C,GAAG68B,OAAQ9wC,KAAKi6B,WAAW0/B,gBACpE35D,KAAKi6B,WAAWirB,YAAYjxC,GAAKjU,KAAKmpE,QAAQ,KAAMpX,EAAM99C,GAAGgvC,IAAK8O,EAAM99C,GAAG0uC,aAAcoP,EAAM99C,GAAGlB,EAAGg/C,EAAM99C,GAAGD,EAAG+9C,EAAM99C,GAAG68B,QAC3G9wC,KAAKi6B,WAAWirB,YAAYjxC,GAAG6/B,UAAW,EACrDie,EAAM99C,GAAGI,QACZrU,KAAKi6B,WAAWirB,YAAYjxC,GAAGI,MAAM8Q,IAAI4sC,EAAM99C,GAAGI,MAAO09C,EAAM99C,GAAGI,OAClErU,KAAKi6B,WAAWirB,YAAYjxC,GAAGlB,GAAKg/C,EAAM99C,GAAGlB,EAAEyN,OAAS,EAAIuxC,EAAM99C,GAAGI,OACrErU,KAAKi6B,WAAWirB,YAAYjxC,GAAGD,GAAK+9C,EAAM99C,GAAGD,EAAEwM,OAAS,EAAIuxC,EAAM99C,GAAGI,OACrErU,KAAKy4E,eAAez4E,KAAKi6B,WAAWirB,YAAYjxC,GAAI89C,EAAM99C,GAAGI,OAGnDrU,MAAKspE,kBAElB,IAAK,GAAIr1D,KAAKjU,MAAKi6B,WAAWirB,YACzBszB,EAAcx4E,KAAKi6B,WAAWirB,YAAYjxC,GAAGrU,OAChDI,KAAKi6B,WAAWirB,YAAYjxC,GAAG06B,SAAU,EAC1B3uC,KAAK0xE,cAAc1xE,KAAKi6B,WAAWirB,YAAYjxC,IAAI,KAGlEjU,KAAKi6B,WAAWirB,YAAYjxC,GAAG06B,SAAU,EAC1B3uC,KAAK0xE,cAAc1xE,KAAKi6B,WAAWirB,YAAYjxC,IAAI,GAClEjU,KAAK2vC,cAAcj8B,KAAKshC,MAAM6V,WAAW7qD,KAAKi6B,WAAWirB,YAAYjxC,IAG9DjU,MAAK04E,qBAGfvP,QAAS,SAAUwP,EAAab,EAASn1B,EAAcF,EAAOC,EAAOE,GAA0D,GAA9Cg2B,GAA8Cx3E,UAAAC,OAAA,GAAAC,SAAAF,UAAA,IAAAA,UAAA,GAAA86B,EAAAl8B,KAA5B64E,EAA4Bz3E,UAAAC,OAAA,GAAAC,SAAAF,UAAA,IAAAA,UAAA,GAAf03E,EAAe13E,UAAAC,OAAA,GAAAC,SAAAF,UAAA,IAAAA,UAAA,EAC9H,KAAK02E,EACJ,OAAO,CAEC,IAAI7mD,IAAS,EACP8nD,EAAW/4E,KAAKi6B,WAAW6V,UAAUkB,QAAQ8mC,EACnD,KAAKiB,EACD,MAAO,KAEX,IAAMC,GAAiBh5E,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,OACnD24B,GAAep5E,KAAOk4E,EACtBkB,EAAer2B,aAAeA,EAC9Bq2B,EAAev2B,MAAQA,EACvBu2B,EAAet2B,MAAQA,EACvBs2B,EAAep2B,WAAaA,EAC5Bo2B,EAAe/F,qBAAsB,EACrC+F,EAAeC,aAAeF,EAASn5E,KACvC+4E,GAAeA,EAAYn2E,IAAIw2E,EAjBsF,IAAAE,GAmBrEl5E,KAAKi6B,WAA9C0vB,EAnB8GuvB,EAmB9GvvB,WAAY1a,EAnBkGiqC,EAmBlGjqC,WAAY3D,EAnBsF4tC,EAmBtF5tC,cAC1BnhC,EAAWnK,KAAKi6B,WAAhB9vB,QACCgvE,EAASxvB,EAAWC,SAASnH,EAAOt4C,GACpCivE,EAASzvB,EAAWC,SAASlH,EAAOv4C,GACpCkvE,EAAe,WACbP,IAEG58C,EAAKjC,WAAW2Y,cAAc3B,SAAS5vC,OAAS,GAAK66B,EAAKjC,WAAW6V,UAAUkV,iBAAiBlc,UAC/F5M,EAAKjC,WAAW2Y,cAAc8X,WAAU,GAE5CxuB,EAAKjC,WAAWyd,aAIlB4hC,EAAe,SAACvrE,EAAK+iC,EAAQ9vC,EAAMu4E,GAA0C,GAAnB1mB,IAAmBzxD,UAAAC,OAAA,GAAAC,SAAAF,UAAA,IAAAA,UAAA,GAAAA,UAAAC,OAAA,GAAAC,SAAAF,UAAA,IAAAA,UAAA,IAC3EqF,EAAI,EACFmhB,EAAU,SAAC4xD,GACb,MAAO,IAAI53E,SAAQ,SAACC,EAAQC,GACxB,GAAmB,SAAf03E,EAAMx4E,KAON,MANKk7B,GAAKjC,WAAW+R,gBACjB9P,EAAKjC,WAAWqR,iBAChBpP,EAAKjC,WAAW2Y,cAAcjE,SAAWzS,EAAKjC,WAAW6f,2BACzD5d,EAAKjC,WAAW9vB,QAAUyB,KAAKkB,MAAMlB,KAAKC,UAAU1B,IACpD+xB,EAAKu9C,aAAav9C,EAAKjC,WAAW9vB,QAAS+xB,EAAKjC,WAAWgV,WAAY/S,EAAKjC,WAAWwc,aAAc+iC,EAAMx4E,KAAMw4E,EAAMntD,OAAO9gB,OAE3H1J,GAAQ,EAEd,IAAmB,cAAf23E,EAAMx4E,KAMX,OALIk7B,EAAKyT,cAAcj8B,KAAKpC,KAAKkI,MAAM2E,cAAcq7D,EAAMntD,OAAOgH,MAAM3sB,MAChE,QAAU3D,UAAU+L,QAAU,SAAW/L,UAAUstB,eACvD6L,EAAKjC,WAAWk4B,UAAUqnB,EAAMntD,OAAOgH,MAAM3sB,KAAK,GAClDw1B,EAAKjC,WAAWq7B,UAAUkkB,EAAMntD,OAAOgH,MAAM3sB,IAAK8yE,EAAMntD,OAAOgH,MAAM9jB,QAAQ,GAAM,IAEhF1N,GAAQ,EAEd,IAAmB,cAAf23E,EAAMx4E,KAEX,MADAk7B,GAAKjC,WAAWk4B,UAAU,MAAM,GACzBtwD,GAAQ,EAEd,IAAmB,cAAf23E,EAAMx4E,KAAsB,CACjC,IAAK,GAAI+D,GAAE,EAAGA,EAAEy0E,EAAMntD,OAAOiH,OAAOjyB,OAAQ0D,IACxC,GAAGy0E,EAAMntD,OAAOiH,OAAOvuB,GAAI,CACvB,GAAI2B,GAAM8yE,EAAMntD,OAAOiH,OAAOvuB,GAAKy0E,EAAMntD,OAAOiH,OAAOvuB,GAAG2B,IAAM,EAChE,IAAY,YAARA,EACA,QAEC,IAAIw1B,EAAKyT,cAAcj8B,KAAKpC,KAAKkI,MAAM2E,cAAczX,GAAM,CAC5D,GAAI6I,GAA2C,YAAlCiqE,EAAMntD,OAAOiH,OAAOvuB,GAAGwK,OAAuB2sB,EAAKjC,WAAWgO,WAAWljC,GAAGwK,OAASiqE,EAAMntD,OAAOiH,OAAOvuB,GAAGwK,MACzH2sB,GAAKjC,WAAWm4B,UAAUrtD,EAAG2B,GAAK,GAClCw1B,EAAKjC,WAAWu7B,UAAUzwD,EAAG2B,EAAK6I,GAASiqE,EAAMntD,OAAOiH,OAAOvuB,GAAGqnB,MAAM,OAEvE,IAAI,QAAUrpB,UAAU+L,QAAU/L,UAAUstB,aAAe,QAAS,CACrE,GAAI9gB,GAA2C,YAAlCiqE,EAAMntD,OAAOiH,OAAOvuB,GAAGwK,OAAuBikB,EAAAA,WAAW1iB,WAAW/L,GAAGwK,OAASiqE,EAAMntD,OAAOiH,OAAOvuB,GAAGwK,MACpH2sB,GAAKjC,WAAWm4B,UAAUrtD,EAAG2B,GAAK,GAClCw1B,EAAKjC,WAAWu7B,UAAUzwD,EAAG2B,EAAK6I,GAASiqE,EAAMntD,OAAOiH,OAAOvuB,GAAGqnB,MAAM,OAGxE8P,GAAKjC,WAAWm4B,UAAUrtD,GAItC,MAAOlD,IAAQ,GAEd,GAAmB,cAAf23E,EAAMx4E,KAEX,MADAk7B,GAAKjC,WAAWm4B,aAAa,MAAK,GAC3BvwD,GAAQ,EAEd,IAAmB,WAAf23E,EAAMx4E,KAAmB,CAC9B,GAAwB,gBAApBw4E,EAAMntD,OAAO2uB,IAA8C,WAAtBw+B,EAAMntD,OAAOrrB,KAAmB,CACrE,GAAMw4C,GAAoBtd,EAAKjC,WAAW9vB,QAAQqvC,iBAClD,OAAIA,IAAqBA,EAAkBzQ,MACvC7M,EAAKjC,WAAWwf,UAAU,EAAG,kBACtB53C,GAAQ,MAElBq6B,EAAKjC,WAAW2Y,cAAcjE,SAAWzS,EAAKjC,WAAW8U,UAC1D7S,EAAKjC,WAAWiU,WACTrsC,GAAQ,IAEd,GAAwB,gBAApB23E,EAAMntD,OAAO2uB,IAA8C,WAAtBw+B,EAAMntD,OAAOrrB,KAAmB,CAC1E,GAAMw4C,GAAoBtd,EAAKjC,WAAW9vB,QAAQqvC,iBAClD,OAAIA,IAAqBA,EAAkBloC,MACvC4qB,EAAKjC,WAAWwf,UAAU,EAAG,kBACtB53C,GAAQ,KAEnBq6B,EAAKjC,WAAWiZ,WACTrxC,GAAQ,IAEd,GAAwB,aAApB23E,EAAMntD,OAAO2uB,IAA2C,WAAtBw+B,EAAMntD,OAAOrrB,KAEpD,MADAk7B,GAAKjC,WAAW4Y,eACThxC,GAAQ,EAEd,IAAwB,aAApB23E,EAAMntD,OAAO2uB,IAA2C,WAAtBw+B,EAAMntD,OAAOrrB,KAEpD,MADAk7B,GAAKjC,WAAWyY,aAAaxW,EAAKjC,WAAW9vB,SACtCtI,GAAQ,EAEd,IAAI23E,EAAMntD,OAAO9gB,KAAK,CAIvB,IAAK,GAHCk3C,GAAQtlC,OAAO8d,UAAWu+C,EAAMntD,OAAO+4C,SAASryD,GAChD2vC,EAAQvlC,OAAO8d,UAAWu+C,EAAMntD,OAAO+4C,SAASpxD,GAChDutD,EAASiY,EAAMntD,OAAOqI,MAAQi1B,EAAWC,SAAS4vB,EAAMntD,OAAOqI,MAAOwH,EAAKjC,WAAW9vB,SAAW,EAC9F9C,EAAE,EAAGA,EAAEk6D,EAAQl6D,IAAK,CACzB60B,EAAK+sC,gBAAgBuQ,EAAMntD,OAAO9gB,QAAU2wB,EAAKjC,WAAWoQ,aAC5D,IAAM5D,GAAOvK,EAAKitC,QAAQwP,EAAaa,EAAMntD,OAAO9gB,KAAM,GAAIk3C,EAAOC,MAAS,GAAM,EAAMo2B,EACrFryC,KAGAkyC,EAIyB,mBAArBA,EAAY/4E,KACjBs8B,EAAKjC,WAAWkQ,UAAU5mB,KAAKkjB,GAE1BkyC,EAAYl2B,OAASk2B,EAAYj2B,QACtCjc,EAAK1zB,GAAK42C,EAAWC,SAAS+uB,EAAYl2B,MAAOvmB,EAAKjC,WAAW9vB,SACjEs8B,EAAKzyB,GAAK21C,EAAWC,SAAS+uB,EAAYj2B,MAAOxmB,EAAKjC,WAAW9vB,WARjEs8B,EAAKqN,UAAW,EAChB5X,EAAKjC,WAAWirB,YAAY3hC,KAAKkjB,IAU/BkyC,GAAgBA,EAAY94E,QAAsC,kBAA5B84E,EAAY94E,OAAOD,MAA8Bs8B,EAAKjC,WAAW2Y,cAAcjE,SACvHzS,EAAKyT,cAAcj8B,KAAKshC,MAAM6V,WAAW3uB,EAAKjC,WAAW6U,WAI1D,WAAa9tC,GAAKk7B,EAAKotC,mBAG9B,MADAptC,GAAKw8C,oBACE72E,GAAQ,QAGlB,CAAA,GAAmB,cAAf23E,EAAMx4E,KAAsB,CACdk7B,EAAKw9C,YAAYF,EAAMntD,OAAO9gB,KACjD,OAAO1J,IAAQ,GAEd,GAAmB,WAAf23E,EAAMx4E,KAAmB,CAC9B,GAAI24E,GAAez9C,EAAKw9C,YAAYF,EAAMntD,OAAO9gB,MAAM,EACvD,IAAIiuE,EAAMntD,OAAO9gB,OAASotE,EAAY/4E,KAClC,IAAK,GAAIyH,GAAE,EAAGA,EAAEsyE,EAAat4E,OAAQgG,IACjC,GAAIsyE,EAAatyE,GAAGzH,OAAS+4E,EAAY/4E,KAAM,CAC3C+4E,EAAcgB,EAAatyE,EAC3B,OAKZ60B,EAAKotC,kBAAkBpgE,KAAK,WACxB,MAAOrH,IAAQ,SAGlB,CAAA,GAAmB,YAAf23E,EAAMx4E,KAAoB,CAC/B,GAAI44E,GAAcJ,EAAMntD,OAAO9gB,KAC3BsuE,EAAY9rE,EACZ+rE,GAAiB,EACfC,EAAe,SAACC,GAElB,IADAH,EAAYA,GAAaA,EAAUh6E,SACzB,CACN,IAAKg6E,EACD,KACG,IAAIA,EAAUh3B,SAIjB,MAHIm3B,KACAH,EAAUj6E,MAAQ,MAEfi6E,EAAUj6E,IAErBi6E,GAAYA,EAAUh6E,QAG9B,IAA0B,WAAtB25E,EAAMntD,OAAOrrB,MAAyC,gBAApBw4E,EAAMntD,OAAO2uB,IAC/C,GAAG9e,EAAKjC,WAAW6V,UAAUkV,iBAAiBlc,SAAS,CACnD,GAAImxC,GAAc/9C,EAAKjC,WAAW2Y,cAAc3B,SAAS,EACrDgpC,IACAL,EAAcK,EAAYr6E,KAC1Bk6E,GAAiB,IAGjBF,EAAc,KACd19C,EAAKjC,WAAW6f,2BAChB5d,EAAKjC,WAAW2Y,cAAc8X,WAAU,GAAM,GAAO,SAOxDkvB,KACG7rE,EAAI80C,SACJ+2B,EAAc7rE,EAAInO,MAElBg6E,EAAcG,EAAaF,GAAW,GACtCL,EAAMU,WAAaN,EAAcG,EAAaF,GAAW,KAIrE,IAAID,EAAa,CAEb,GAAMO,GAAYP,EAAYx/D,QAAQ,SAClCggE,EAAWR,EAAYpjE,UAAU,EAAG,GACxC,KAAI2jE,EACA,IAAK,GAAI9yE,GAAE,EAAGA,EAAEikC,EAAcjqC,OAAQgG,IAC9BikC,EAAcjkC,GAAGzH,OAASw6E,GAAY9uC,EAAcjkC,GAAGs7C,eAAiBy3B,GACxE9uC,EAAcvsB,OAAO1X,IAAK,EAKtC60B,GAAKu1C,YAAYmI,EAAaE,GAElC,MAAOj4E,IAAQ,GAEd,GAAmB,SAAf23E,EAAMx4E,KAMX,MALAq4E,KACAn9C,EAAKjC,WAAWqR,iBAChBpP,EAAKjC,WAAW2Y,cAAcjE,SAAWzS,EAAKjC,WAAWyd,WACzDxb,EAAKjC,WAAW9vB,QAAUyB,KAAKkB,MAAMlB,KAAKC,UAAU1B,IACpD+xB,EAAKu9C,aAAav9C,EAAKjC,WAAW9vB,QAAS8kC,EAAY/S,EAAKjC,WAAWwc,aAAc+iC,EAAMx4E,MACpFa,GAAQ,EAEd,IAAmB,aAAf23E,EAAMx4E,KAGX,MAFAq4E,KACAn9C,EAAKjC,WAAWqR,iBACZ2D,EAAWtY,MAAMuF,EAAKjC,WAAWwc,cAAc1f,UAC/CmF,EAAKjC,WAAWs3B,YAAY50C,UAC5Buf,EAAKjC,WAAW2/B,oBAAsB19B,EAAKjC,WAAW2/B,oBAAoB54D,KAAM,KACzEa,GAAQ,KAEnBq6B,EAAKjC,WAAW9vB,QAAUyB,KAAKkB,MAAMlB,KAAKC,UAAU1B,IAChD8kC,EAAWtY,MAAMuF,EAAKjC,WAAWwc,cAAc7d,kBAAkBv3B,OAAS,GAC1E66B,EAAKu9C,aAAav9C,EAAKjC,WAAW9vB,QAAS8kC,EAAY/S,EAAKjC,WAAWwc,cAChE50C,GAAQ,KAEnBq6B,EAAKu9C,aAAav9C,EAAKjC,WAAW9vB,QAAS8kC,EAAY/S,EAAKjC,WAAWwc,aAAc+iC,EAAMx4E,MACpFa,GAAQ,IAEd,IAAmB,eAAf23E,EAAMx4E,KAAuB,CAClCq4E,IACAn9C,EAAKjC,WAAWqR,gBAChB,IAAMjkC,GAAIsiD,EAAWC,SAAS4vB,EAAMntD,OAAO7L,MAAOrW,EAClD,IAAI8kC,EAAWtY,MAAMuF,EAAKjC,WAAWwc,cAAc1f,SAAU,CAAA,GAAAsjD,GACnCn+C,EAAKjC,WAAWk3B,eAAehnD,EAAS+xB,EAAKjC,WAAWs2B,eAAiBZ,KAAMtoD,EAAGrG,KAAM,eAAvGo3C,EADkDiiC,EAClDjiC,KAAMhzC,EAD4Ci1E,EAC5Cj1E,KAIb,OAHIA,SACA82B,EAAKjC,WAAW4/B,kBAAkBzhB,EAAMhzC,GAErCvD,GAAQ,GAInB,MADAq6B,GAAKu9C,aAAav9C,EAAKjC,WAAW9vB,QAAS8kC,EAAY/S,EAAKjC,WAAWwc,aAAc+iC,EAAMx4E,KAAMqG,GAC1FxF,GAAQ,GAEd,GAAmB,eAAf23E,EAAMx4E,KAAuB,CAClCq4E,IACAn9C,EAAKjC,WAAWqR,gBAChB,IAAMjkC,GAAIsiD,EAAWC,SAAS4vB,EAAMntD,OAAO7L,MAAOrW,EAClD,IAAI8kC,EAAWtY,MAAMuF,EAAKjC,WAAWwc,cAAc1f,SAAU,CAAA,GAAAujD,GACnCp+C,EAAKjC,WAAWk3B,eAAehnD,EAAS+xB,EAAKjC,WAAWs2B,eAAiBZ,KAAMtoD,EAAGrG,KAAM,eAAvGo3C,EADkDkiC,EAClDliC,KAAMhzC,EAD4Ck1E,EAC5Cl1E,KAIb,OAHIA,SACA82B,EAAKjC,WAAW4/B,kBAAkBzhB,EAAMhzC,GAErCvD,GAAQ,GAInB,MADAq6B,GAAKu9C,aAAav9C,EAAKjC,WAAW9vB,QAAS8kC,EAAY/S,EAAKjC,WAAWwc,aAAc+iC,EAAMx4E,KAAMqG,GAC1FxF,GAAQ,GAEd,GAAmB,eAAf23E,EAAMx4E,KAAuB,CAClCq4E,IACAn9C,EAAKjC,WAAWqR,gBAEhB,IAAIw0B,GAAU,GAAI1jD,QAAOk2D,QAAQp2C,EAAKyT,cAAcj8B,KAAM,EAAG0I,OAAOinD,YAAYC,OAUhF,OATAxD,GAAQC,OAAS,EACjB7jC,EAAKjC,WAAW+f,aAAaC,iBAAiBzoC,SAAS,aAAcsuD,GACrE5jC,EAAKjC,WAAWy3B,gBAAgBx1B,EAAKjC,WAAWi4B,gBAChDh2B,EAAKjC,WAAWu3B,gBAAgBt1B,EAAKjC,WAAWi4B,gBAChDh2B,EAAKjC,WAAWi4B,eAAexH,WAAU,GACzCxuB,EAAKjC,WAAWkQ,UAAUprB,OAAO,EAAGmd,EAAKjC,WAAWkQ,UAAU9oC,QAC9D66B,EAAKi8C,cAAcj8C,EAAKjC,WAAWoQ,cAEnCnO,EAAKu9C,aAAav9C,EAAKjC,WAAW9vB,QAAS+xB,EAAKjC,WAAWgV,WAAY/S,EAAKjC,WAAWwc,aAAc+iC,EAAMx4E,KAAMw4E,EAAMntD,OAAO9gB,MAAK,GAC5H1J,GAAQ,GAEd,GAAmB,aAAf23E,EAAMx4E,KACXu4E,IAAeA,EAAWxgE,QAAS,GACnCmjB,EAAKjC,WAAW04B,eAAexoD,EAAQqvE,EAAMntD,OAAOoxB,OAAOoV,EAAO32B,EAAKjC,WAAW8S,kBAAkB7jC,KAAK,SAACgD,GACtG,MAAGA,MAAO,EAOCrK,GAAQ,OALfq6B,GAAKjC,WAAWk5B,eAAehpD,EAASqvE,EAAMntD,OAAOoxB,QAAO,EAAM,SAAC52C,GAC/D,MAAOhF,IAAQ,IACjBq6B,EAAKjC,WAAW8S,wBAQzB,IAAmB,QAAfysC,EAAMx4E,KAAgB,CAC3B,GAAGk7B,EAAKjC,WAAW8R,YAAa,EAAO,MAAOlqC,IAAQ,EAEtD,IADAq6B,EAAKjC,WAAW8R,UAAW,EACxBhpC,UAAUuf,QAAgC,MAAtBvf,UAAUmM,QAAgB,CAE7C,GAAMnF,GAAQ4/C,EAAWC,SAAS9Y,EAAOrqC,GAAG4lB,OAAOtiB,MAAOI,EAC1D,IAAGA,EAAQ8iB,aAAa,GAAGzM,OAASzW,EAMhC,MAJAmyB,GAAKjC,WAAWmT,gBAAkB,EAClCjjC,EAAQ8iB,aAAa,GAAGzM,MAAQrW,EAAQ8iB,aAAa,GAAGzM,MAAQzW,EAChEmyB,EAAKjC,WAAWgjB,kBAChB/gB,EAAKjC,WAAW8R,UAAW,EACpBlqC,GAAQ,EAEfq6B,GAAKjC,WAAW9vB,QAAQykC,YAAc1S,EAAKjC,WAAW4U,gCACtD,IAAM0rC,GAAU,SAAClwB,GACb,MAAO,IAAIzoD,SAAQ,SAACC,EAAQC,GACxB,GAAM04E,GAAS,SAACC,GASZ,MARAv+C,GAAKjC,WAAWmT,mBAChBlR,EAAKjC,WAAWkT,eAAiB,KACjB,MAAbstC,GAAiC,IAAbA,IAAgBtwE,EAAQ8iB,aAAa,GAAGzM,OAAQ,GACvE0b,EAAKjC,WAAWgjB,kBACK,SAAlBl6C,UAAUye,KACT0a,EAAKw8C,oBAETx8C,EAAKjC,WAAW8R,UAAW,EACpBlqC,GAAQ,GAEhBwoD,MAAS,EACR5iD,EAAAA,WAAM8E,QAAQ,KAAKrD,KAAK,WACpBsD,EAAAA,WAAOC,OAAO,OAAO,yBAAyB,KAAK,OAAO,MAAK,GAAOvD,KAAK,WAEpE1N,OAAOssB,KAAOtsB,OAAOssB,IAAI4yD,aAAoC,YAArB33E,UAAU+L,SACjDotB,EAAKjC,WAAWkT,eAAiBqtC,EACjCjB,IAAeA,EAAWxgE,QAAS,GACnCvd,OAAOssB,IAAI4yD,gBAEjB,WAEE,MADAx+C,GAAKjC,WAAW8R,UAAW,EACpBlqC,GAAQ,OAIF,SAAlBkB,UAAUye,KACT+lB,EAAA55B,UAAUG,SAAS5E,KAAK,SAACgD,GAElBA,EAAGc,WAAY,EACdwtE,EAAO,IAEPhuE,EAAAA,WAAO4rC,KAAK,kBACZoiC,EAAO,QAOV,UAAlBz3E,UAAUye,IACT+lB,EAAA55B,UAAUQ,YAAYjF,KAAK,SAAAgD,GACpBA,EAAGsC,WAAY,EACdhC,EAAAA,WAAOC,OAAO,OAAO,uBAAuB,KAAK,MAAM,MAAK,GAAOvD,KAC/D,WAAMqxE,GAAQ,GAAOrxE,KAAK,SAAAgD,GACtB,MAAOrK,GAAQqK,MAEnB,WAAuC,MAAlCgwB,GAAKjC,WAAW8R,UAAW,EAAclqC,GAAQ,KAE1D2K,EAAAA,WAAOC,OAAO,OAAO,YAAY,KAAK,MAAM,MAAK,EAAM,EAAE,GAAE,GAAOvD,KAC9D,WAAuC,MAAlCgzB,GAAKjC,WAAW8R,UAAW,EAAclqC,GAAQ,IACtD,WAAuC,MAAlCq6B,GAAKjC,WAAW8R,UAAW,EAAclqC,GAAQ,OAIlE04E,GAAQ,GAAMrxE,KAAK,SAAAgD,GACf,MAAOrK,GAAQqK,SAI1B,CACD,GAAqB,WAAlBnJ,UAAUye,IAKT,MAJAhV,GAAAA,WAAO4rC,KAAK,wBAAwBlvC,KAAK,WACrC1N,OAAOkR,SAAS2rC,KAAO,uDAAwDt1C,UAAUwG,MAE7F2yB,EAAKjC,WAAW8R,UAAW,EACpBlqC,GAAQ,EAGnBq6B,GAAKjC,WAAWmZ,YAAW,GAAMlqC,KAAK,SAACgD,GACnC,GAA4C,oBAAxCiR,OAAOb,UAAU7R,SAASmS,MAAM1Q,IAA+C,KAAlBnJ,UAAUkK,IAItE,CAED,GAAIf,EAAGkO,QAAQ,gBAAuC,KAAlBrX,UAAUkK,KAAgBf,EAAGkO,QAAQ,iBAErE,GAAwB,QAArBrX,UAAU+L,OACTtT,OAAOqE,QAAUrE,OAAOqE,OAAO44C,gBAC9B,CACD,GAAIkiC,GAAKzuE,EAAGkO,QAAQ,UAAelO,EAAGkO,QAAQ,KAAQ,EAAI,EACtDwgE,EAAK1uE,EAAGkO,QAAQ,UAAelO,EAAGkO,QAAQ,KAAQlO,EAAG7K,MACzDmL,GAAAA,WAAOsf,MAAM5f,EAAGoK,OAAOqkE,EAAGzzE,KAAK4lB,MAAM8tD,EAAKD,KAAMzxE,KAAK,WAC9CgD,EAAGkO,QAAQ,iBAAkB5e,OAAOkR,SAAS2rC,KAAO,yBAI/D7rC,GAAAA,WAAO4rC,KAAK,2CAIhB,OAFAlc,GAAKjC,WAAWiT,wBAAyB,EACzChR,EAAKjC,WAAW8R,UAAW,EACpBlqC,GAAQ,GApBfq6B,EAAKjC,WAAWiT,wBAAyB,EACzC/iC,EAAQgB,UAAYS,KAAKkB,MAAMlB,KAAKC,UAAUqwB,EAAKjC,WAAW9vB,QAAQgB,WAsB1E,IAAMpB,GAAQ4/C,EAAWC,SAAS4vB,EAAMntD,OAAOtiB,MAAOI,GAChD6wC,EAAKlK,EAAOrqC,GAAG4lB,OAAO9gB,KACxBmpB,EAAQoc,EAAOrqC,GAAG4lB,OAAOqI,UACvB8sB,EAAe/5C,EAAAA,WAAMg6C,eACrBx3C,EAAWlH,UAAU+L,OAAS0yC,EAChClC,KACEgU,EAAQ,SAACxU,GACX,MAAwB,QAArB/7C,UAAU+L,QAAyC,YAArB/L,UAAU+L,QAA6C,QAArB/L,UAAU+L,OAElElN,QAAQC,UAEZq6B,EAAKjC,WAAW4kB,gBAAgBC,GAAS51C,KAAK,SAACgD,GAClD,GAAGA,GAAMA,EAAGa,OACR,MAAiB,YAAdb,EAAGa,OACC2nB,QAA2B,IAAVA,GAAexoB,EAAGwoB,MAAQ,EACnC9yB,QAAQC,UAEZD,QAAQE,UAEf0K,EAAAA,WAAOsf,MAAM,cACNlqB,QAAQC,QAAQ,WAIjC,SAACsK,GAEC,MAAOvK,SAAQC,QAAQ,WAG/ByxD,GAAMtY,GAAI9xC,KAAK,SAACgD,GACZ,GAAU,UAAPA,GAAwB,UAANA,EAEjB,MADAgwB,GAAKjC,WAAW8R,UAAW,EACpBlqC,GAAQ,EAEnB,IAAIg5E,GAAajvE,KAAKkB,MAAMlB,KAAKC,UAAU1B,IAErC2wE,EAAe,WAEjB,GAAI5pE,GAAI5C,SAAS7H,GAAG,EACds0E,EAAe,SAACnzC,GAClB,MAAO,IAAIhmC,SAAQ,SAACC,EAAQC,GACxB,MAAe,aAAZ8lC,EAAG5mC,KAMKa,QALPq6B,GAAKjC,WAAWk5B,eAAe0nB,EAAYjzC,EAAGvb,OAAOoxB,QAAQ,EAAK,SAAC52C;AAE/D,MADAg0E,GAAajvE,KAAKkB,MAAMlB,KAAKC,UAAUhF,IAChChF,SAQjBm5E,EAAiB,QAAjBA,KACF,MAAG9pE,IAAK4/B,EAAOzvC,OAEJO,QAAQC,UAEZk5E,EAAajqC,EAAO5/B,IAAIhI,KAAK,WAEhC,MADAgI,KACO8pE,MAGf,OAAOA,MAGLC,EAAiB,WACnB,MAAOr5E,SAAQC,WAGbq5E,EAAe,SAACl6E,GAClB,GAAMk3C,GAASoH,OAAmBv1C,EAAQu1C,CAQ1C,OAPI,KAAMt+C,GAAiB,MAATA,EACdk7B,EAAKjC,WAAW9vB,QAAQ8iB,aAAa,GAAGzM,OAAkB,IAAT03B,EAEjDhc,EAAKjC,WAAW9vB,QAAQ8iB,aAAa,GAAGzM,OAAS03B,EAErDhc,EAAKjC,WAAW2hB,iBAChB1f,EAAKjC,WAAW8R,UAAW,EACpBlqC,GAAQ,IAGbs5E,EAAoB,SAAClqD,GACvBiL,EAAKjC,WAAW6R,gBAAkB,KAClC5P,EAAKjC,WAAW8R,UAAW,EAC3BkvC,IAAiB/xE,KAAK,WAElB,GADAgzB,EAAKjC,WAAWmV,sBAAsBnlC,GACvB,IAAXgnB,GAA2B,MAAXA,EAChBiL,EAAKjC,WAAW8S,kBAAmB,EACnC7Q,EAAKjC,WAAWmS,cAAe,EAC/B8uC,EAAajqD,OACV,CAEHiL,EAAKjC,WAAWmS,cAAe,CAC/B,IAAMgvC,GAAgB,QAAhBA,GAAiBhvD,GACnB,MAAO3kB,GAAAA,WAAM8E,QAAQ6f,GAAMljB,KAAK,WAC5B,MAAOgzB,GAAKjC,WAAWmZ,aAAalqC,KAAK,SAAAgD,GACrC,MAA2C,oBAAvCiR,OAAOb,UAAU7R,SAASumB,KAAK9kB,GACxBtK,QAAQC,UAERu5E,EAAc,SAKrCA,GAAc,KAAKlyE,KAAK,WACpB,MAAOrH,IAAQ,QAM5Bq6B,GAAKjC,WAAWqT,aAEf7lC,EAAAA,WAAM8E,QAAQ,KAAKrD,KAAK,WACpBsD,EAAAA,WAAOC,OAAO,OAAO,4CAA4C,SAAS,MAAM,OAAM,GAAMvD,KAAK,SAACC,GAC9F2xE,IAAe5xE,KAAK,WAChBqkC,EAAAA,WAASnhC,IAAIrC,EAAMixC,EAAGwG,EAAatlB,EAAKjC,WAAWgV,WAAW1jC,KAAKsvE,EAAW,EAAE,WAC5EM,SAGV,SAACz5B,GAEC,MADY,WAATA,GAAmBxlB,EAAKjC,WAAWiU,WAC/BrsC,GAAQ,OAIvBi5E,IAAe5xE,KAAK,WAChBgzB,EAAKjC,WAAWolB,aAAat1C,EAAOixC,EAAI/wC,EAAUkxE,EAAkBN,GAAY3xE,KAAK,SAAAmyE,GAAA,MAAM/7B,GAAY+7B,OAGjH,SAAClvE,GAGC,MAFAK,GAAAA,WAAO4rC,KAAK,cACZlc,EAAKjC,WAAW8R,UAAW,EACpBlqC,GAAQ,YAK1B,IAAkB,WAAf23E,EAAMx4E,KAAkB,CAC5B,IAAG+B,UAAUuf,QAAgC,MAAtBvf,UAAUmM,QA2B7B,MAAOrN,IAAQ,EAzBf,IAAM24E,IAAS,SAACC,GAOZ,MANAv+C,GAAKjC,WAAWkT,eAAiB,KACjB,MAAbstC,GAAiC,IAAbA,IAAgBtwE,EAAQ8iB,aAAa,GAAGzM,OAAQ,GACvE0b,EAAKjC,WAAWgjB,kBACK,SAAlBl6C,UAAUye,KACT0a,EAAKw8C,oBAEF72E,GAAQ,GAEhBrG,QAAOssB,KAAOtsB,OAAOssB,IAAI4yD,aAAoC,YAArB33E,UAAU+L,QACjDotB,EAAKjC,WAAWkT,eAAiBqtC,GACjCjB,IAAeA,EAAWxgE,QAAS,GACnCvd,OAAOssB,IAAI4yD,eACY,SAAlB33E,UAAUye,KACf+lB,EAAA55B,UAAUG,SAAS5E,KAAK,SAACgD,GAElBA,EAAGc,WAAY,EACdwtE,GAAO,IAEPhuE,EAAAA,WAAO4rC,KAAK,UAAYlsC,EAAG/C,KAC3BqxE,GAAO,YAU7Bc,EAAY,QAAZA,KACF,MAAG70E,IAAKqqC,EAAOzvC,OACJO,QAAQC,SAAQ,GAEhB+lB,EAAQkpB,EAAOrqC,IAAIyC,KAAK,SAACgD,GAC5B,MAAGA,MAAO,GAENzF,IACO60E,KAEA15E,QAAQC,SAAQ,KAKvC,OAAOy5E,KAAYpyE,KAAK,SAACgD,GAAM,MAAOtK,SAAQC,QAAQqK,MAEpDqvE,EAAgB,SAACxtE,EAAKyrE,GACpB7vB,EAAWC,SAAS4vB,EAAMvpB,WAAY9lD,IACtCmvE,EAAavrE,EAAKyrE,EAAM1oC,OAAQ,YAGlC0qC,EAAgB,SAACztE,EAAK/M,EAAKy6E,GAC7Bv/C,EAAKjC,WAAW8S,kBAAmB,EAChCh/B,EAAIlO,QAAUkO,EAAIlO,OAAOi0C,WAExB3pC,EAAU+xB,EAAKjC,WAAW9vB,QAE9B,IAAIuxE,MACA5qC,EAAAA,MASJ,IARAA,EAASioC,EAASjoC,OAEf/iC,EAAIkrE,cAAqC,eAArBlrE,EAAIkrE,eAEnBnoC,EAAOzvC,OAAS,GAAwB,eAAnByvC,EAAO,GAAGlxC,MAA4C,IAAlBkxC,EAAOzvC,SAChEyvC,EAAO6qC,SAAS7qC,SAAS9vC,KAAM,SAAUqrB,QAAS9gB,KAAM,gBAAgB0kD,YAAYjvD,KAAK,SAASwf,MAAM,MAAM5gB,KAAK,aAAaoB,KAAK,YAGzI4hD,EAAY,CACZ,GAAMm1B,GAAe56D,OAAO8d,UAAW2nB,EACvCm1B,GAAa16D,QAAQ,SAAAu+D,GAAA,MAAMA,GAAG9qC,OAAOzzB,QAAQ,SAAAnP,GAAA,MAAKA,GAAEgsE,UAAW,MAC/DppC,EAASinC,EAAa9sD,OAAO6lB,GAnBQ,GAAAlW,GAAA,SAqBhCn0B,GACL,GAAIqqC,EAAOrqC,GAAGzF,OAASA,GAA0B,WAAlB8vC,EAAOrqC,GAAGzF,KACrC06E,EAAgBA,EAAgBr6E,QAAUyvC,EAAOrqC,OAEhD,IAAIqqC,EAAOrqC,GAAGzF,OAASA,GAA2B,YAAnB8vC,EAAOrqC,GAAGzF,KAAoB,CAC9D,GAAIgN,GAAO8iC,EAAOrqC,GAAGwxE,QACjBvpE,EAAMwtB,EAAKjC,WAAWoQ,cAAgBnO,EAAKjC,WAAWoQ,aAAar8B,GAAQkuB,EAAKjC,WAAWoQ,aAAar8B,GACtGkuB,EAAKjC,WAAW0/B,gBAAkBz9B,EAAKjC,WAAW0/B,eAAe3rD,GAAQkuB,EAAKjC,WAAW0/B,eAAe3rD,GAAQ1M,MAClHoN,IACAA,EAAImiE,KAAKruE,IAAI,WAAA,MAAM+4E,GAAcxtE,EAAK+iC,EAAOrqC,OATzD,KAAK,GAAIA,KAAKqqC,GAAQlW,EAAbn0B,EAcT,IAAIwqB,IAAS,EACP4qD,EAAgB,SAAA/qC,GAClB,GAAInhC,GAAI,EACFiY,EAAU,QAAVA,KAEF,MADAsU,GAAKjC,WAAWmT,gBAAkB,EAC/Bz9B,GAAKmhC,EAAOzvC,OAAeO,QAAQC,SAAQ,GACZ,WAA9BivC,EAAOnhC,GAAGsgD,WAAWjvD,MAAoD,WAA9B8vC,EAAOnhC,GAAGsgD,WAAWjvD,MAAoB2oD,EAAWC,SAAS9Y,EAAOnhC,GAAGsgD,WAAY9lD,GACvHmvE,EAAavrE,EAAK+iC,EAAOnhC,GAAGmhC,OAAQ9vC,EAAM,MAAK,EAAe,WAATA,GAAmBkI,KAAK,SAACgD,GACjF,MAAGA,MAAO,GACNyD,IACOiY,MAEJsU,EAAKjC,WAAWmT,sBAA0BrqC,UAAUuf,UAAW,GAA8B,MAAtBvf,UAAUmM,SAAmB4hC,EAAOzvC,OAAS,IACnH66B,EAAKjC,WAAWmT,gBAAkB,EAClCksC,EAAavrE,EAAI+iC,EAAOA,EAAOzvC,OAAQ,GAAGyvC,OAAO9vC,EAAM,MAAK,GAAM,IAEtEiwB,GAAS,EACFrvB,QAAQC,SAAQ,OAI/B8N,IACOiY,KAGf,OAAOA,KAEX,OAAOi0D,GAAcH,GAAiBxyE,KAAK,WAEvC,MADAuyE,IAAWA,IACJ75E,QAAQC,aAIjBi6E,EAAgB,SAAC/tE,EAAK+xD,GACxB,KAAI/xD,EAAIguE,WAAa7/C,EAAKjC,WAAW8R,UAGjC+zB,GAAWA,EAAQsD,cAAgBhnD,OAAOinD,YAAYC,QAA6B,IAAnBxD,EAAQC,QAA5E,CAGA7jC,EAAKjC,WAAW+S,cAAe,EACf,UAAbj/B,EAAInO,OACHs8B,EAAKjC,WAAW+S,cAAe,EAC/B9Q,EAAK01C,kBAGT,IAAMS,GAAUn2C,EAAKjC,WAAWi4B,eAAejhB,SAAS5vC,OAAS,EAC3D+yC,EAAYlY,EAAKjC,WAAWs3B,YAAYtgB,SAAS5vC,OAAS,CAChE,KAAK0M,EAAIkrE,eAAsC,cAArBlrE,EAAIkrE,cAAqD,eAArBlrE,EAAIkrE,eAC1DlrE,EAAIlO,SAAuC,cAA5BkO,EAAIlO,OAAOo5E,cAA4D,eAA5BlrE,EAAIlO,OAAOo5E,iBACtE/8C,EAAKjC,WAAWkO,WAAah+B,EAAQ0vC,QAAUw4B,IAAYj+B,IAAclY,EAAKjC,WAAWoT,UAE5F,WADAnR,GAAKjC,WAAWwf,UAAU,EAAG,sBAGjC1rC,GAAIguE,WAAY,EAChBt0E,EAAAA,WAAM8E,QAAQ,KAAKrD,KAAK,WACpBsyE,EAAcztE,EAAK,UAAU,WAAKA,EAAIguE,WAAY,QAIpDC,EAAyB,SAACjuE,GAC5BA,EAAI+iC,OAAOswB,YAAY5+D,IAAIs5E,EAA3B5/C,EAAgD,EAAGnuB,IAEjDkuE,EAAiB,SAACluE,GACpB,MAAK6qE,GAGEh3E,QAAQC,UAFJ25E,EAAcztE,EAAK,WAI5BmuE,EAAkB,SAACnuE,GACrBytE,EAAcztE,EAAK,WAGvB,IAAI,WAAagrE,EAAS/3E,KAAM,CAC5B,GAAIqY,GAAQ,IACR0/D,GAASv1E,QAAQ6V,OAAS0/D,EAASv1E,QAAQ6V,MAAM3S,MACjD2S,EAAQrZ,KAAK2vC,cAAcj8B,KAAKlR,IAAI6W,MAAM0/D,EAASv1E,QAAQ6V,MAAM3S,IAAKqyE,EAASv1E,QAAQ6V,MAAM9J,QAAQ,GAEzG,IAAMzL,GAAM9D,KAAK2vC,cAAc4uB,UAAU4a,EACrCC,EACAL,EAAS/yE,MACT+yE,EAAS5yE,OACT4yE,EAASv1E,QAAQU,WAAW66B,OAAOr4B,IACnCqyE,EAASv1E,QAAQU,WAAW86B,OAAOt4B,IACnC,SAAC5C,EAAKg8D,GAAN,MAAkBgc,GAAch4E,EAAIjE,OAAQigE,IAC5C,KACAzmD,EACA,KACA2/D,EAEJkD,GAAgBp4E,EAAIjE,QACpBm5E,EAAen2B,SAAW,SAE1Bm2B,EAAemD,YAAcv8E,KAAMk4E,EAASn1B,aAAcA,EAAcy5B,OAAQt4E,EAAIjE,OAAQqhD,SAAU+6B,IACrGpD,GAAU74E,KAAKi6B,WAAWqR,cAAc/nB,MAAM3jB,KAAMk4E,EAASn1B,aAAcA,EAAcy5B,OAAQt4E,EAAIjE,OAAQqhD,SAAU+6B,QAEvH,IAAI,UAAYlD,EAAS/3E,KAAM,CAChC,GAAI+G,GAAM/H,KAAK2vC,cAAcj8B,KAAKlR,IAAI0wB,MAAMimD,EAAQC,EAAQL,EAASv1E,QAAQU,WAAWwC,IACxFqB,GAAI/B,MAAQ+yE,EAAS/yE,MACrB+B,EAAI5B,OAAS4yE,EAAS5yE,OACtB6yE,EAAex2E,IAAIuF,GACnBi0E,EAAuBj0E,GACvBm0E,EAAgBn0E,GAChB/H,KAAK2vC,cAAcstB,gBAAgBl1D,EAAKgxE,EAASv1E,QAAQU,WAAWwC,KACpEsyE,EAAen2B,SAAW,QAC1B96C,EAAIkxE,aAAeF,EAASn5E,KAE5Bo5E,EAAemD,YAAcv8E,KAAMk4E,EAASn1B,aAAcA,EAAcy5B,OAAQr0E,EAAKm5C,SAAU+6B,IAC9FpD,GAAU74E,KAAKi6B,WAAWqR,cAAc/nB,MAAM3jB,KAAMk4E,EAASn1B,aAAcA,EAAcy5B,OAAQr0E,EAAKm5C,SAAU+6B,QAEhH,IAAI,SAAWlD,EAAS/3E,KAAM,CAC/B,GAAIq/D,GAAAA,OACAD,GAAazf,aAAc,OAAQC,aAAc,SAAU3uC,UAAU,EACzEouD,GAAK0Y,EAASv1E,QAAQ6pD,UAAY,GAC9BgT,EAAGjmD,QAAQ,MAAQ,IACnBimD,GAAU,MAEV0Y,EAASv1E,QAAQmgE,QAAS,EAC1BtD,EAAK,QAAUA,EAAK,IAAM0Y,EAASv1E,QAAQ6B,WAGvC0zE,EAASv1E,QAAQ6B,WACjBg7D,EAAKA,EAAK,IAAM0Y,EAASv1E,QAAQ6B,WAE5BrF,KAAKi6B,WAAW6V,UAAUpqC,OAC/B26D,EAAKA,EAAK,IAAMrgE,KAAKi6B,WAAW6V,UAAUpqC,KAAKL,YAIvD+6D,EAAU16D,KAAO26D,EACjBD,EAAUzrD,KAAOokE,EAASv1E,QAAQa,MAClC+7D,EAAUrqD,cAAiB/V,KAAK2vC,cAAcj8B,KAAK8H,OAAOs5C,QAA+BikB,EAAS/yE,MAA9B+yE,EAAS/yE,MAAQ,CAErF,IAAIhC,GAAMhE,KAAK2vC,cAAcj8B,KAAKlR,IAAIwP,KAAKmnE,EAAQC,EAAQ,GAAIhZ,EAAW4Y,GACtEr6B,EAAM,EACV,IAAIgL,EAAWn2C,QAAQulE,EAASv1E,QAAQgd,QAGpC,GAFAu4D,EAASv1E,QAAQgd,MAAMnD,QAAQ,SAAA1N,GAAA,MAAKgvC,IAAOgL,EAAWqC,WAAWr8C,EAAE5O,KAAMoJ,KACzEnK,KAAKi6B,WAAWwxB,uBAAuBstB,EAASv1E,QAAQgd,MAAOxc,EAAKmG,GAChEumC,EAAAA,WAAUrrC,WAAY,CACtB,GAAM0jD,GAAK/oD,KAAKi6B,WAAW6V,UAAUpqC,KAAKI,KAAO9F,KAAKi6B,WAAW+uB,sBAAsB+vB,EAASv1E,QAAQ6pD,WAAa0rB,EAASv1E,QAAQ6pD,UAChIpE,EAAKjpD,KAAKi6B,WAAW6V,UAAUpqC,KAAKI,KAAO9F,KAAKi6B,WAAWivB,qBAAqB6vB,EAASv1E,QAAQ6pD,WAAa0rB,EAASv1E,QAAQ6pD,SACrIrtD,MAAKi6B,WAAWkvB,iBAAiB4vB,EAASv1E,QAAQgd,MAAOyoC,EAAIF,EAAI/kD,EAAKmG,QAI1Ew0C,GAAMgL,EAAWqC,WAAW+sB,EAASv1E,QAAQgd,MAAOrW,EAExDnG,GAAI+yC,cAAe,EACnB/yC,EAAI83D,MAAM6E,eAAgB,EAC1B38D,EAAIuoE,iBAAkB,EACtBvoE,EAAI0oE,YAAc1sE,KAAKi6B,WAAW46B,aAAakkB,EAASv1E,QAAQ6pD,WAChErpD,EAAIwoE,WAAahR,EAAAA,WAASgR,WAC1BxoE,EAAIyoE,iBAAmBjR,EAAAA,WAASiR,iBAC5B/7B,EAAAA,WAAUrrC,YACVrB,EAAIitC,SAAS5zB,QAAQ,SAAA1N,GAAMA,EAAEg/B,SAAU,IACvC3qC,EAAIgO,KAAO,KAGXhO,EAAIgO,KAAO2sC,EAEfq9B,EAAuBh4E,GACvBk4E,EAAgBl4E,GAChBg1E,EAAen2B,SAAW,OAE1Bm2B,EAAemD,YAAcv8E,KAAMk4E,EAASn1B,aAAcA,EAAcy5B,OAAQp4E,EAAKk9C,SAAU+6B,IAC9FpD,GAAU74E,KAAKi6B,WAAWqR,cAAc/nB,MAAM3jB,KAAMk4E,EAASn1B,aAAcA,EAAcy5B,OAAQp4E,EAAKk9C,SAAU+6B,GACjH,IAAMI,GAAiBz5B,EAAaA,KAC9B05B,KAAarxD,OAAAC,EAAI6tD,EAASjoC,QAAb5lB,EAAwBmxD,IAAgBjhD,OAAO,SAAArpB,GAAA,MAAgB,YAAXA,EAAE/Q,QACxEs7E,EAAWj7E,SAAW2C,EAAI+yC,cAAe,OAEzC,IAAI,QAAUgiC,EAAS/3E,KAAM,CAC9B,GAAIu7E,GAAQv8E,KAAK2vC,cAAcj8B,KAAKlR,IAAIurD,OAAOorB,EAAQC,EAAQL,EAASv1E,QAAQU,WAAW66B,OAAOr4B,IAClG61E,GAAMv2E,MAAQ+yE,EAAS/yE,MACvBu2E,EAAMp2E,OAAS4yE,EAAS5yE,OACxB6yE,EAAex2E,IAAI+5E,GACnBP,EAAuBO,GACvBv8E,KAAK2vC,cAAcstB,gBAAgBsf,EAAOxD,EAASv1E,QAAQU,WAAW66B,OAAOr4B,IAE7E,IAAI81E,GAASx8E,KAAK2vC,cAAcj8B,KAAKlR,IAAIurD,OAAOorB,EAC1CC,EACAL,EAASv1E,QAAQU,WAAWsa,SAAS9X,IAC3C81E,GAAOx2E,MAAQ+yE,EAAS/yE,MACxBw2E,EAAOr2E,OAAS4yE,EAAS5yE,OACzB6yE,EAAex2E,IAAIg6E,GACnBR,EAAuBQ,GACvBx8E,KAAK2vC,cAAcstB,gBAAgBuf,EAAQzD,EAASv1E,QAAQU,WAAWsa,SAAS9X,IAEhF,IAAI+lD,GAAOzsD,KAAK2vC,cAAcj8B,KAAKlR,IAAI+9C,SAAS44B,EAAQC,EACxD3sB,GAAKjM,UAAU,UACfiM,EAAKhM,SAAS,EAAG,EAAGs4B,EAAS/yE,MAAO+yE,EAAS5yE,QAC7CsmD,EAAK/L,UACLs4B,EAAex2E,IAAIiqD,GACnB+vB,EAAO/vB,KAAOA,EACduvB,EAAuBvvB,GACvByvB,EAAgBzvB,EAEhB,IAAIgwB,GAAQ,GACRC,EAAQ,EAE6BD,GAAJ,IAAjC1D,EAASv1E,QAAQm5E,UAAU5pE,EAAkB,OACxCgmE,EAASv1E,QAAQm5E,UAAU5pE,IAAMgmE,EAAS/yE,MAAgB,QACrD,SAE2B02E,EAAJ,IAAjC3D,EAASv1E,QAAQm5E,UAAU3oE,EAAkB,MACxC+kE,EAASv1E,QAAQm5E,UAAU3oE,IAAM+kE,EAAS5yE,OAAiB,SACtD,QAId,KAvC8B,GAqCvBikC,IAAapqC,KAAKi6B,WAAlBmQ,UACHhlC,GAAQ,EACLA,GAAMglC,GAAU/oC,SACf+oC,GAAUhlC,IAAOmG,OAASwtE,EAASxtE,MAAmD,IAA3C6+B,GAAUhlC,IAAOwxC,MAAM3F,SAAS5vC,QADpD+D,MAK/BglC,GAAUhlC,KAAUmG,KAAMwtE,EAASxtE,KAC7BqrC,MAAOoiC,EACPh4E,KAAMy7E,EAAQ,IAAMC,EACpBl5E,QAASu1E,EAASv1E,SAExBxD,KAAK48E,qBACL5D,EAAen2B,SAAW,MAE1Bm2B,EAAemD,YAAcv8E,KAAMk4E,EAASn1B,aAAcA,EAAcy5B,OAAQ3vB,EAAMvL,SAAU+6B,IAC/FpD,GAAU74E,KAAKi6B,WAAWqR,cAAc/nB,MAAM3jB,KAAMk4E,EAASn1B,aAAcA,EAAcy5B,OAAQ3vB,EAAMvL,SAAU+6B,QAEjH,IAAI,UAAYlD,EAAS/3E,KAAM,CAChC,GAAMw2D,IAAY7N,EAAWC,SAASmvB,EAASv1E,QAAQgd,MAAOrW,GAC1Dg7D,GAAiB,GAAIiL,GAAQtL,YAAY9kE,KAAK2vC,cAAcj8B,KAC1DylE,EAAQC,EACRL,EAAS/yE,MAAO+yE,EAAS5yE,OACzBqxD,GACAuhB,EAASv1E,QAAQa,MACjB00E,EAASv1E,QAAQ6pD,UACjB0rB,EAASv1E,QAAQ6B,WAAa0zE,EAASv1E,QAAQ6B,WAAarF,KAAKi6B,WAAW6V,UAAUpqC,KAAO1F,KAAKi6B,WAAW6V,UAAUpqC,KAAKL,WAAa,GACzI0zE,EAASv1E,QAAQmgE,KAAOoV,EAASv1E,QAAQmgE,KAAO,KAElD,YAAanM,IACb2N,GAAekD,WAAU,EAG7B,IAAMwU,IAAgB,SAAC7qE,GACnB,GAAMrC,GAAIqC,EACJzG,EAAOwtE,EAASv1E,QAAQgd,MAAMk2C,KAC9BomB,EAAc,SAAC13E,EAAOuK,EAAG3O,GAE3B,IAAK,GADD+7E,GAAQ,GACHt2E,EAAE,EAAGA,EAAEkJ,EAAEtO,OAAQoF,KAClBkJ,EAAElJ,IAAI,KAAOkJ,EAAElJ,IAAI,KAAgB,MAATkJ,EAAElJ,IAAoB,IAANA,KAC1Cs2E,GAASptE,EAAElJ,GAGnB,IAAIu2E,GAAK9vB,WAAW6vB,EACpBC,GAAKA,EAAKA,EAAK,EACXA,kBACAA,kBAEKA,EAAK,iBACVA,EAAK,gBAEI,UAATh8E,EACAk7B,EAAKjC,WAAW9vB,QAAQszC,OAAOr4C,GAAOob,MAAQw8D,EAC9B,eAATh8E,IACPk7B,EAAKjC,WAAW9vB,QAAQk/C,YAAYjkD,GAAOob,MAAQw8D,GAEvD7X,GAAeY,SAAU,EACrB7Y,WAAW6vB,KAAWC,GAAM,IAAMA,EAClC7X,GAAenzD,KAAOgrE,EAAK,GAEtBD,IAAUptE,IACfw1D,GAAenzD,KAAO+qE,IAG1B33E,EAAAA,MACJ,KAAKA,EAAQ+E,EAAQszC,OAAOlrB,UAAU,SAAA5iB,GAAA,MAAKA,GAAEpE,OAASA,UAClDuxE,EAAY13E,EAAOuK,EAAG,aAErB,KAAKvK,EAAQ+E,EAAQk/C,YAAY92B,UAAU,SAAA5iB,GAAA,MAAKA,GAAEpE,OAASA,UAC5DuxE,EAAY13E,EAAOuK,EAAG,kBAErB,KAAKvK,EAAQ+E,EAAQm/C,aAAa/2B,UAAU,SAAA5iB,GAAA,MAAKA,GAAEpE,OAASA,UAC7DpB,EAAQm/C,aAAalkD,GAAOob,MAAQ7Q,MAEnC,KAAKvK,EAAQ+E,EAAQo/C,YAAYh3B,UAAU,SAAA5iB,GAAA,MAAKA,GAAEpE,OAASA,UAAe,CAC3E,GAAM0xE,IAA2C37E,SAArC6I,EAAQo/C,YAAYnkD,GAAOob,MAAsBmpC,EAAW0N,cAAcltD,EAAQo/C,YAAYnkD,GAAQ+E,GAAWA,EAAQo/C,YAAYnkD,GAAOob,OAAS,CACpH,WAAzCrW,EAAQo/C,YAAYnkD,GAAO0E,KAAK9I,KAChC87E,EAAYG,EAAIttE,EAAG,SAE2B,eAAzCxF,EAAQo/C,YAAYnkD,GAAO0E,KAAK9I,KACrC87E,EAAYG,EAAIttE,EAAG,cAE2B,gBAAzCxF,EAAQo/C,YAAYnkD,GAAO0E,KAAK9I,OACrCmJ,EAAQm/C,aAAa2zB,GAAIz8D,MAAQ7Q,IAK7Cw1D,IAAe0C,iBAAiBgV,IAChC1X,GAAeiD,iBAAiB0T,GAChC3W,GAAe+X,UAAYlE,EAC3BA,EAAevnB,aAAe0T,GAC9B+W,EAAgB/W,IAChB6T,EAAen2B,SAAW,QAE1Bm2B,EAAemD,YAAcv8E,KAAMk4E,EAASn1B,aAAcA,EAAcy5B,OAAQjX,GAAgBjkB,SAAU+6B,IACzGpD,GAAU74E,KAAKi6B,WAAWqR,cAAc/nB,MAAM3jB,KAAMk4E,EAASn1B,aAAcA,EAAcy5B,OAAQjX,GAAgBjkB,SAAU+6B,QAE3H,IAAI,UAAYlD,EAAS/3E,KAAM,CAChC,GAAMi5B,IAAaj6B,KAAKi6B,WACpBlyB,GAAM/H,KAAK2vC,cAAcj8B,KAAKlR,IAAI0wB,MAAM,EAAG,EAAG,KAClD8lD,GAAex2E,IAAIuF,IACnBixE,EAAel2B,aAAe,CAE9B,IAAMq6B,IAAgB,WAClB,GAAIljD,GAAWoT,UAAW,CAEtB,IAAK,GAAI5mC,GAAE,EAAGA,EAAEwzB,GAAWuR,UAAUnqC,OAAQoF,IACzC,GAAIwzB,GAAWuR,UAAU/kC,KAAOuyE,EAAep5E,KAC3C,OAAO,CAGf,QAAO,EAIP,IAAK,GAAI6G,GAAE,EAAGA,EAAEwzB,GAAWuR,UAAUnqC,OAAQoF,IACzC,GAAIwzB,GAAWuR,UAAU/kC,KAAOuyE,EAAep5E,KAC3C,OAAO,CAGf,QAAO,GAGTw9E,GAAgB,QAAhBA,MACF,MAAO,YACH,MAAID,WACAnE,EAAepnD,aAAertB,WAAW64E,KAAiBrE,EAASv1E,QAAQ65E,KAAK78D,aAGhFw4D,EAAel2B,eAAiBi2B,EAASv1E,QAAQkxB,MAAMlU,QACvDg7D,EAAczzE,GAAK,UACnBixE,EAAepnD,aAAertB,WAAW64E,KAAiBrE,EAASv1E,QAAQ65E,KAAK78D,WAKtF88D,GAAiB,WACnB,MAAO,YACCH,MAGJ3B,EAAczzE,GAAK,WAIU,KAAjCgxE,EAASv1E,QAAQkxB,MAAMlU,OACvBw4D,EAAepnD,aAAe/E,YAAYywD,KAAkBvE,EAASv1E,QAAQ65E,KAAK78D,OAClFw4D,EAAepnB,UAAY,iBAE3BonB,EAAepnD,aAAertB,WAAW64E,KAAiBrE,EAASv1E,QAAQ65E,KAAK78D,OAChFw4D,EAAepnB,UAAY,UAI/B,KAAK,GAAInrD,IAAE,EAAGA,GAAEzG,KAAKi6B,WAAWsR,YAAYlqC,OAAQoF,KAAK,CACrD,GAAMuC,IAAOhJ,KAAKi6B,WAAWsR,YAAY9kC,GACzC,IAAIuyE,EAAep5E,OAASoJ,GAAKpJ,MAAQ+4E,GAAe3vE,GAAKnJ,SAAW84E,EAAY/4E,KAAM,CACtFo5E,EAAel2B,aAAe95C,GAAK85C,aACnC9iD,KAAKi6B,WAAWsR,YAAYxsB,OAAOtY,GAAE,EACrC,QAIRzG,KAAKi6B,WAAW2Y,cAAcjE,UAAY3uC,KAAKi6B,WAAWuR,UAAUxrC,KAAKi6B,WAAWuR,UAAUnqC,QAAUy2E,GACxGkB,EAAen2B,SAAW,QAC1Bm2B,EAAemD,YAAcv8E,KAAMk4E,EAASn1B,aAAcA,EAAcy5B,OAAQr0E,GAAKm5C,SAAU+6B,IAC9FpD,GAAU74E,KAAKi6B,WAAWqR,cAAc/nB,MAAM3jB,KAAMk4E,EAASn1B,aAAcA,EAAcy5B,OAAQr0E,GAAKm5C,SAAU+6B,QAEhH,IAAI,cAAgBlD,EAAS/3E,KAAM,CACpC,GAAIm1C,IAAK,IACL4iC,GAASv1E,QAAQU,WAAWwC,KAC5ByvC,GAAKn2C,KAAK2vC,cAAcj8B,KAAKlR,IAAI0wB,MAAMimD,EAAQC,EAAQL,EAASv1E,QAAQU,WAAWwC,KACnFyvC,GAAGnwC,MAAQ+yE,EAAS/yE,MACpBmwC,GAAGhwC,OAAS4yE,EAAS5yE,SAErBgwC,GAAKn2C,KAAK2vC,cAAcj8B,KAAKlR,IAAI+9C,SAAS,EAAG,GAC7CpK,GAAGqK,UAAU,EAAK,GAClBrK,GAAGsK,SAAS04B,EAAQC,EAAQL,EAAS/yE,MAAO+yE,EAAS5yE,QACrDgwC,GAAGuK,UACHvK,GAAG9N,MAAQ,GAGf2wC,EAAex2E,IAAI2zC,IACnB6lC,EAAuB7lC,IACvB+lC,EAAgB/lC,IAChB6iC,EAAen2B,SAAW,YAC1Bm2B,EAAemD,YAAcv8E,KAAMk4E,EAASn1B,aAAcA,EAAcy5B,OAAQjmC,GAAI+K,SAAU+6B,IAC7FpD,GAAU74E,KAAKi6B,WAAWqR,cAAc/nB,MAAM3jB,KAAMk4E,EAASn1B,aAAcA,EAAcy5B,OAAQjmC,GAAI+K,SAAU+6B,GAnB5E,IAAAnhD,IAAA,SAoB3Br0B,GACL,GAAMyqC,GAAQhV,EAAKitC,QAAQ6P,EAAgBD,EAAS9nC,SAASxqC,GAAGw8C,IAAK81B,EAAS9nC,SAASxqC,GAAGk8C,aAAco2B,EAAS9nC,SAASxqC,GAAGsM,EAAGgmE,EAAS9nC,SAASxqC,GAAGuN,EAAG+kE,EAAS9nC,SAASxqC,GAAGqqC,OAAQ8nC,EAAUC,EAAOC,GAChMyE,EAAa,WASf,GARArsC,EAAMn+B,GAAKomE,EACXjoC,EAAMl9B,GAAKolE,EACPL,EAAS9nC,SAASxqC,GAAG4N,QACrB68B,EAAM78B,MAAM8Q,IAAI4zD,EAAS9nC,SAASxqC,GAAG4N,MAAO0kE,EAAS9nC,SAASxqC,GAAG4N,OACjE68B,EAAMn+B,GAAK42C,EAAWC,SAASmvB,EAAS9nC,SAASxqC,GAAGsM,EAAG5I,IAAY,EAAI4uE,EAAS9nC,SAASxqC,GAAG4N,OAC5F68B,EAAMl9B,GAAK21C,EAAWC,SAASmvB,EAAS9nC,SAASxqC,GAAGuN,EAAG7J,IAAY,EAAI4uE,EAAS9nC,SAASxqC,GAAG4N,QAG5F68B,EAAMugB,aAAc,CAEpB,GAAM+rB,GAAUxE,EAAen5E,QAAUm5E,EAAen5E,OAAO4iD,MAASkH,EAAWC,SAASovB,EAAen5E,OAAO4iD,MAAMvmB,EAAKjC,WAAW9vB,SAAWgvE,EAASA,EACtJsE,EAAUzE,EAAen5E,QAAUm5E,EAAen5E,OAAO6iD,MAASiH,EAAWC,SAASovB,EAAen5E,OAAO6iD,MAAMxmB,EAAKjC,WAAW9vB,SAAWivE,EAASA,CAC5JloC,GAAMugB,aAAa1+C,GAAKyqE,EACxBtsC,EAAMugB,aAAaz9C,GAAKypE,EAEpB1E,EAAS9nC,SAASxqC,GAAG4N,OACrB68B,EAAMugB,aAAazsD,UAAY+zE,EAAS9nC,SAASxqC,GAAG4N,MACpD68B,EAAMugB,aAAazrD,OAAS+yE,EAAS9nC,SAASxqC,GAAG4N,MACjD68B,EAAMugB,aAAatrD,OAAS+qC,EAAMugB,aAAazsD,UAG/CksC,EAAMugB,aAAarV,UAI/B,OAAKlL,OAGLqsC,MAFI5tE,GAAO,GA7Bf,KAAK,GAAIlJ,MAAKsyE,GAAS9nC,SAAU,CAAA,GAAAgiB,IAAAn4B,GAAxBr0B,GAAwB,IAAA,YAAA,mBAAAwsD,IAAA,YAAAC,EAAAD,KAAA,MAAAA,IAAAtjD,GAqCrC,MAAOshB,GAAS+nD,EAAiB/nD,GAMrCynD,kBAAkB,WAAU,GAAAt8C,GAAAp8B,IACxB,IAAG+C,UAAUuf,QAAgC,MAAtBvf,UAAUmM,SAAqC,SAAlBnM,UAAUye,IAAe,CACzE,GAAMk8D,GAAiB,QAAjBA,GAAkBxsC,GACpB,GAAI3lC,GAAO,EAIX,IAH0B,cAAvB2lC,EAAM+nC,eACL1tE,EAAO2lC,EAAMtxC,OAEZsxC,EAAMtxC,MAAQsxC,EAAMtxC,OAAS2L,GAAQ2lC,EAAMyR,cAAgBzR,EAAMyR,eAAiBp3C,IAAkB,KAATA,EAK5F,MAJA6wB,GAAKg8C,wBAAwBlnC,EAAO9U,EAAKnC,WAAWoQ,cACpDjO,EAAKnC,WAAWu3B,gBAAgBtgB,GAChC9U,EAAKnC,WAAWy3B,gBAAgBxgB,GAChCA,EAAMv0B,WACC,CAEN,IAAIu0B,EAAMD,UAAYC,EAAMD,SAAS5vC,OAAS,EAC/C,IAAK,GAAIoF,GAAE,EAAGA,EAAEyqC,EAAMD,SAAS5vC,OAAQoF,IACnCi3E,EAAexsC,EAAMD,SAASxqC,KAAOA,GAG7C,QAAO,EAGX8gC,GAAA55B,UAAUQ,YAAYjF,KAAK,SAAAgD,GACpBA,EAAGsC,WAAY,GAAQtC,EAAGqC,QAAU,GACnCmvE,EAAethD,EAAKuT,cAAcj8B,KAAKshC,WAM7Ds0B,gBAAiB,WAAY,GAAA5sC,GAAA18B,KACbqsB,EAAS,QAATA,KACF,GAAGqQ,EAAKzC,WAAWqR,cAAcjqC,OAAS,EAAE,CACxC,GAAI2H,GAAO0zB,EAAKzC,WAAWqR,cAAc,EAEzC,OADA5O,GAAKzC,WAAWqR,cAAcvsB,OAAO,EAAG,GACjC/V,EAAKk4C,SAASl4C,EAAKozE,QAAQlzE,KAAK,WACnC,MAAOmjB,OAIX,MAAOzqB,SAAQC,UAIvB,OAAOwqB,KAASnjB,KAAK,WAA8B,MAAzBwzB,GAAKg8C,oBAA2B92E,QAAQC,aAI5E+6E,mBAAoB,WACnB,IAAK,GAD0BjgD,GAAA38B,KAAAgiC,EAAA,SACtBv7B,GACR,GAAMk3E,GAAOhhD,EAAK1C,WAAWmQ,UAAU3jC,EACvC,KAAKk3E,EAAK/mC,MAAM3F,SAAS5vC,OAAU,MAAA,UAEnC,IAAMk7E,GAAQoB,EAAK/mC,MAAM3F,SAAS,GAC5BurC,EAASmB,EAAK/mC,MAAM3F,SAAS,GAC7Bwb,EAAOkxB,EAAK/mC,MAAM3F,SAAS,GAC3B2sC,EAASjhD,EAAK1C,WAAW0vB,WAAWC,SAAS+zB,EAAKn6E,QAAQgd,MAAMue,OAAO/4B,MAAO22B,EAAK1C,WAAW9vB,SAC9F0zE,EAAUlhD,EAAK1C,WAAW0vB,WAAWC,SAAS+zB,EAAKn6E,QAAQgd,MAAMue,OAAO54B,OAAQw2B,EAAK1C,WAAW9vB,SAChG2zE,EAASnhD,EAAK1C,WAAW0vB,WAAWC,SAAS+zB,EAAKn6E,QAAQgd,MAAMhC,SAASxY,MAAO22B,EAAK1C,WAAW9vB,SAChG4zE,EAAUphD,EAAK1C,WAAW0vB,WAAWC,SAAS+zB,EAAKn6E,QAAQgd,MAAMhC,SAASrY,OAAQw2B,EAAK1C,WAAW9vB,SAClGiyC,EAAS,SAACruC,EAAKgF,EAAGiB,EAAGhO,EAAOG,GAC7B4H,EAAIiwE,QACPjwE,EAAI4O,UACJ5O,EAAM4uB,EAAKgT,cAAcj8B,KAAKlR,IAAI+9C,SAASxtC,EAAGiB,GAC9CjG,EAAIyyC,UAAU,UACdzyC,EAAI0yC,SAAS,EAAG,EAAGz6C,EAAOG,GAC1B4H,EAAI2yC,UACJ3yC,EAAIgpC,cAAe,EACnB4mC,EAAK/mC,MAAMp0C,IAAIuL,GACfyuE,EAAO/vB,KAAO1+C,IAEdA,EAAIgF,EAAIA,EACRhF,EAAIiG,EAAIA,EACRjG,EAAI/H,MAAQA,EACZ+H,EAAI5H,OAASA,IAIX83E,EAA+B,SAAvBN,EAAKn6E,QAAQZ,MAAmB6pD,EAAO+vB,EAC7C3gE,EAAI3U,KAAK2mB,IAAIiwD,EAASvB,EAAMv2E,MAAQ43E,EAAQrB,EAAMv2E,OAClD4M,EAAI1L,KAAK2mB,IAAIkwD,EAAUxB,EAAMp2E,OAAS03E,EAAStB,EAAMp2E,OAE3D,QAAQw3E,EAAK38E,MACZ,IAAK,WACJo7C,EAAO6hC,EAAO1B,EAAMxpE,EAAGwpE,EAAMvoE,EAAG6H,EAAGjJ,EACnC,MACD,KAAK,aACJwpC,EAAO6hC,EAAO1B,EAAMxpE,GAAGwpE,EAAMv2E,MAAM6V,GAAG,EAAG0gE,EAAMvoE,EAAG6H,EAAGjJ,EACrD,MACD,KAAK,YACJwpC,EAAO6hC,EAAO1B,EAAMxpE,EAAEwpE,EAAMv2E,MAAM6V,EAAG0gE,EAAMvoE,EAAG6H,EAAGjJ,EACjD,MACD,KAAK,cACJwpC,EAAO6hC,EAAO1B,EAAMxpE,EAAGwpE,EAAMvoE,GAAGuoE,EAAMp2E,OAAOyM,GAAG,EAAGiJ,EAAGjJ,EACtD,MACD,KAAK,gBACJwpC,EAAO6hC,EAAO1B,EAAMxpE,GAAGwpE,EAAMv2E,MAAM6V,GAAG,EAAG0gE,EAAMvoE,GAAGuoE,EAAMp2E,OAAOyM,GAAG,EAAGiJ,EAAGjJ,EACxE,MACD,KAAK,eACJwpC,EAAO6hC,EAAO1B,EAAMxpE,EAAEwpE,EAAMv2E,MAAM6V,EAAG0gE,EAAMvoE,GAAGuoE,EAAMp2E,OAAOyM,GAAG,EAAGiJ,EAAGjJ,EACpE,MACD,KAAK,cACJwpC,EAAO6hC,EAAO1B,EAAMxpE,EAAGwpE,EAAMvoE,EAAEuoE,EAAMp2E,OAAOyM,EAAGiJ,EAAGjJ,EAClD,MACD,KAAK,gBACJwpC,EAAO6hC,EAAO1B,EAAMxpE,GAAGwpE,EAAMv2E,MAAM6V,GAAG,EAAG0gE,EAAMvoE,EAAEuoE,EAAMp2E,OAAOyM,EAAGiJ,EAAGjJ,EACpE,MACD,KAAK,eACJwpC,EAAO6hC,EAAO1B,EAAMxpE,EAAEwpE,EAAMv2E,MAAM6V,EAAI0gE,EAAMvoE,EAAEuoE,EAAMp2E,OAAOyM,EAAGiJ,EAAGjJ,KA3D3DnM,EAAI,EAAGA,EAAIzG,KAAKi6B,WAAWmQ,UAAU/oC,OAAQoF,IAAK,CAAAu7B,EAAlDv7B,KAiEVgrE,YAAa,SAAUyM,EAAepE,GAAgB,GAAA98C,GAAAh9B,KAC/C09E,EAAiB,QAAjBA,GAAkBxsC,EAAOtxC,GAC9B,GAAIsxC,EAAMtxC,MAAQsxC,EAAMtxC,OAASA,GAAQsxC,EAAMyR,cAAgBzR,EAAMyR,eAAiB/iD,EASrF,MAReo9B,GAAKo7C,wBAAwBlnC,EAAOlU,EAAK/C,WAAWoQ,cACpDrN,EAAK/C,WAAWu3B,gBAAgBtgB,GAChClU,EAAK/C,WAAWy3B,gBAAgBxgB,GAChCA,EAAMv0B,UACjBu0B,EAAMyf,QAAUmpB,IACnB98C,EAAK/C,WAAW6f,2BAChB9c,EAAK/C,WAAW2Y,cAAc8X,WAAU,GAAM,GAAO,KAE/C,CAEH,IAAIxZ,EAAMD,UAAYC,EAAMD,SAAS5vC,OAAS,EAClD,IAAK,GAAIoF,GAAE,EAAGA,EAAEyqC,EAAMD,SAAS5vC,OAAQoF,IACtCi3E,EAAexsC,EAAMD,SAASxqC,GAAI7G,IAAS6G,GAG7C,QAAO,EAERi3E,GAAe19E,KAAK2vC,cAAcj8B,KAAKshC,MAAOkpC,IAGzCC,aAAa,SAAUvnC,GACnB,GAAGA,EAAM6a,aACL,MAAO7a,GAAM6a,YACX,KAAG7a,EAAM3F,WAAY2F,EAAM3F,SAAS5vC,OAMtC,MAAO,KALP,KAAK,GAAIoF,GAAE,EAAGA,EAAEmwC,EAAM3F,SAAS5vC,OAAQoF,IAAK,CACxC,GAAIyF,GAAMlM,KAAKm+E,aAAavnC,EAAM3F,SAASxqC,GAC3C,IAAU,OAAPyF,GAAsB5K,SAAP4K,EAAkB,MAAOA,KAMvDwlE,cAAe,SAAU96B,EAAO+wB,GAC5B,GAAI/wB,EAAM6a,aACN7a,EAAM6a,aAAapH,KAAKsd,OAEvB,IAAI/wB,EAAM3F,UAAY2F,EAAM3F,SAAS5vC,OACtC,IAAK,GAAIoF,GAAE,EAAGA,EAAEmwC,EAAM3F,SAAS5vC,OAAQoF,IACnCzG,KAAK0xE,cAAc96B,EAAM3F,SAASxqC,GAAIkhE,IAKxD8Q,eAAgB,SAAU7hC,EAAOviC,GAChC,GAAIuiC,EAAM6a,aACG7a,EAAM6a,aAAazsD,UAAYqP,EAC/BuiC,EAAM6a,aAAazrD,OAASqO,EACxCuiC,EAAM6a,aAAatrD,OAASywC,EAAM6a,aAAazsD,SAAW,EAI1D4xC,EAAM6a,aAAarV,aAEf,IAAIxF,EAAM3F,UAAY2F,EAAM3F,SAAS5vC,OACzC,IAAK,GAAIoF,GAAE,EAAGA,EAAEmwC,EAAM3F,SAAS5vC,OAAQoF,IACtCzG,KAAKy4E,eAAe7hC,EAAM3F,SAASxqC,GAAI4N,IAK1CqlE,YAAa,SAAU5B,EAASsG,GAAS,GAAAjhD,GAAAn9B,KAElCq+E,EAAkB,QAAlBA,GAAmB53C,EAAMqxC,GAC9B,GAAI/lB,KAMJ,OALItrB,GAAK7mC,MAAQ6mC,EAAK7mC,OAASk4E,EAC9B/lB,EAAMxuC,KAAKkjB,GAEIsrB,EAAQtrB,EAAKwK,SAAS7tB,OAAO,SAAClO,EAAGrO,GAAJ,MAAUqO,GAAE+V,OAAOozD,EAAgBx3E,EAAGixE,SAE5E/lB,GAEJusB,KACE3E,EAAe0E,EAAgBr+E,KAAK2vC,cAAcj8B,KAAKshC,MAAO8iC,EAC3D,IAAGsG,EAAQ,CAEP,GAAIzE,EAAat4E,OAAS,EAAG,CAAA,GAClB2vC,GAAWhxC,KAAKi6B,WAAW6V,UAA3BkB,QACDF,EAASE,EAAQ8mC,GAAShnC,MAChC,KAAK,GAAI5iC,KAAK4iC,GACa,YAAnBA,EAAO5iC,GAAGlN,MACVhB,KAAKi6B,WAAWoQ,aAAayG,EAAO5iC,GAAG+pE,SAASpH,KAAKnmB,YAIjEivB,EAAat8D,QAAQ,SAAAkhE,GAAW,GACrB97B,GAAyD87B,EAAzD97B,MAAOC,EAAkD67B,EAAlD77B,MAAOruC,EAA2CkqE,EAA3ClqE,MAAOy/B,EAAoCyqC,EAApCzqC,SAAU7C,EAA0BstC,EAA1BttC,SAAU0R,EAAgB47B,EAAhB57B,YAEhD,KAAK,GAAIz0C,KAAKqwE,GAAQ37B,WACiB,YAA/B27B,EAAQ37B,WAAW10C,GAAGlN,MACtBm8B,EAAKlD,WAAWoQ,aAAak0C,EAAQ37B,WAAW10C,GAAG+pE,SAASpH,KAAKnmB,WAIzE,IAAM8zB,GAAUrhD,EAAKgsC,QAAQoV,EAAQ1+E,OAAQi4E,EAASn1B,EAAcF,EAAOC,EAAO67B,EAAQ37B,YAAaw7B,EACvG,IAAKI,EAAL,CAIArhD,EAAKwS,cAAcj8B,KAAKshC,MAAMxyC,IAAIg8E,EAElC,KAAK,GAAIn3E,GAAE,EAAGA,EAAE4pC,EAAS5vC,OAAQgG,IAAK,CAClC,GAAIo3E,IAAS,CACb,KAAK,GAAI53E,KAAK23E,GAAQvtC,SAClB,GAAIutC,EAAQvtC,SAASpqC,GAAGjH,OAASqxC,EAAS5pC,GAAGzH,KAAM,CAC/C6+E,GAAS,CACT,OAIHA,GAAWL,IAEZI,EAAQtwB,SAASjd,EAAS5pC,IAC1BA,GAAK,GAgBb,GAZgC,cAA5Bk3E,EAAQ1+E,OAAOgjD,WACf27B,EAAQzrE,GAAKoqB,EAAKlD,WAAW0vB,WAAWC,SAAS20B,EAAQ1+E,OAAO4iD,MAAOtlB,EAAKlD,WAAW9vB,SACvFq0E,EAAQxqE,GAAKmpB,EAAKlD,WAAW0vB,WAAWC,SAAS20B,EAAQ1+E,OAAO6iD,MAAOvlB,EAAKlD,WAAW9vB,UAGvFkK,IACAmqE,EAAQnqE,MAAM8Q,IAAI9Q,EAAMtB,EAAGsB,EAAML,GACjCwqE,EAAQzrE,GAAKoqB,EAAKlD,WAAW0vB,WAAWC,SAASnH,EAAOtlB,EAAKlD,WAAW9vB,UAAY,EAAIkK,EAAMtB,GAC9FyrE,EAAQxqE,GAAKmpB,EAAKlD,WAAW0vB,WAAWC,SAASlH,EAAOvlB,EAAKlD,WAAW9vB,UAAY,EAAIkK,EAAML,GAC9FmpB,EAAKs7C,eAAe+F,EAASnqE,EAAMtB,IAGnC+gC,EAAU,CACV0qC,EAAQ1qC,UAAW,CACnB,IAAM1uC,GAAQ+3B,EAAKlD,WAAWirB,YAAY3yB,UAAU,SAAA5iB,GAAA,MAAKA,GAAE/P,OAASk4E,GACpE36C,GAAKlD,WAAWirB,YAAYnmC,OAAO3Z,EAAO,EAAGo5E,GAOjD,GAJID,EAAQ5tB,SACR6tB,EAAQ7tB,QAAS,GAGjB4tB,EAAQ1+E,QAAkC,mBAAxB0+E,EAAQ1+E,OAAOD,KAA2B,CAC5D,GAAM8+E,GAAWvhD,EAAKlD,WAAWkQ,UAAU/vB,QAAQmkE,EACnDphD,GAAKlD,WAAWkQ,UAAUprB,OAAO2/D,EAAU,EAAGF,GAElDrhD,EAAKlD,WAAWy3B,gBAAgB6sB,GAChCA,EAAQ1+E,OAAO4W,QAAQ8nE,EAASC,GAAS7hE,UACzC2hE,EAAS/6D,KAAKi7D,UAGlB7E,GAAat8D,QAAQ,SAAAopB,GACjB,GAAIsrB,IAAS4sB,GAAG,EAAEC,GAAG,GACftjB,EAAS,QAATA,GAAU3rD,EAAEkvE,GACdP,EAAS/6D,KAAK5T,EACd,IAAImvE,IAAOH,GAAG,EAAEC,GAAG,GACbG,EAAgB,SAAC/B,GACnB,GAAItS,IAASiU,GAAG,EAAEC,GAAG,EAKrB,OAJG5B,GAAG3oE,OAAS2oE,EAAGv6B,OAASu6B,EAAGt6B,QAC1BgoB,EAAMiU,GAAKxhD,EAAKlD,WAAW0vB,WAAWC,SAASozB,EAAGv6B,MAAOtlB,EAAKlD,WAAW9vB,UAAY,EAAI6yE,EAAG3oE,MAAMtB,GAClG23D,EAAMkU,GAAKzhD,EAAKlD,WAAW0vB,WAAWC,SAASozB,EAAGt6B,MAAOvlB,EAAKlD,WAAW9vB,UAAY,EAAI6yE,EAAG3oE,MAAML,IAE/F02D,EAERmU,KACC9sB,EAAQgtB,EAAcpvE,GAE1B,IAAMopE,GAAW57C,EAAKlD,WAAW6V,UAAUkB,QAAQrhC,EAAE9P,OAAOD,KAC5D,IAAG+P,EAAE9P,OAAO,CACR,GAAIm/E,GAAK,EACLC,EAAK,CAkBT,IAjBGtvE,EAAE9P,OAAO4iD,OAAS9yC,EAAE9P,OAAO6iD,OAC1Bs8B,EAAK7hD,EAAKlD,WAAW0vB,WAAWC,SAASj6C,EAAE9P,OAAO4iD,MAAOtlB,EAAKlD,WAAW9vB,SACzE80E,EAAK9hD,EAAKlD,WAAW0vB,WAAWC,SAASj6C,EAAE9P,OAAO6iD,MAAOvlB,EAAKlD,WAAW9vB,UAC/C,cAAtBwF,EAAE9P,OAAOgjD,WAA6Bg8B,GAAUlvE,EAAE0E,QAAwB,IAAd1E,EAAE0E,MAAMtB,GAAyB,IAAdpD,EAAE0E,MAAML,MACvF8qE,EAAMC,EAAcpvE,GACpBqvE,GAAOF,EAAIH,GACXM,GAAOH,EAAIF,IAEfjvE,EAAEoD,EAAIisE,EACNrvE,EAAEqE,EAAIirE,GAEHJ,IACClvE,EAAEoD,EAAIg/C,EAAM4sB,GACZhvE,EAAEqE,EAAI+9C,EAAM6sB,IAIK,QAAtBjvE,EAAE9P,OAAOgjD,SAAmB,CAC3B,GAAI45B,GAAQ,GACRC,EAAQ,EAC6BD,GAAJ,IAAjC1D,EAASv1E,QAAQm5E,UAAU5pE,EAAkB,OACxCgmE,EAASv1E,QAAQm5E,UAAU5pE,IAAMgmE,EAAS/yE,MAAgB,QACrD,SAC2B02E,EAAJ,IAAjC3D,EAASv1E,QAAQm5E,UAAU3oE,EAAkB,MACxC+kE,EAASv1E,QAAQm5E,UAAU3oE,IAAM+kE,EAAS5yE,OAAiB,SACtD,QACd,IAAMnF,GAAOy7E,EAAQ,IAAMC,EACrBH,EAAQ5sE,EAAE9P,OAAOoxC,SAAS,GAC1BurC,EAAS7sE,EAAE9P,OAAOoxC,SAAS,GAC3Bwb,EAAO98C,EAAE9P,OAAOoxC,SAAS,GACzB2F,EAAQjnC,EAAE9P,OACV+9E,EAASzgD,EAAKlD,WAAW0vB,WAAWC,SAASmvB,EAASv1E,QAAQgd,MAAMue,OAAO/4B,MAAOm3B,EAAKlD,WAAW9vB,SAClG0zE,EAAU1gD,EAAKlD,WAAW0vB,WAAWC,SAASmvB,EAASv1E,QAAQgd,MAAMue,OAAO54B,OAAQg3B,EAAKlD,WAAW9vB,SACpG2zE,EAAS3gD,EAAKlD,WAAW0vB,WAAWC,SAASmvB,EAASv1E,QAAQgd,MAAMhC,SAASxY,MAAOm3B,EAAKlD,WAAW9vB,SACpG4zE,EAAU5gD,EAAKlD,WAAW0vB,WAAWC,SAASmvB,EAASv1E,QAAQgd,MAAMhC,SAASrY,OAAQg3B,EAAKlD,WAAW9vB,SACtGiyC,EAAS,SAACruC,EAAKgF,EAAGiB,EAAGhO,EAAOG,GAC1B4H,EAAIiwE,QACJjwE,EAAI4O,UACJ5O,EAAMovB,EAAKwS,cAAcj8B,KAAKlR,IAAI+9C,SAASxtC,EAAGiB,GAC9CjG,EAAIyyC,UAAU,UACdzyC,EAAI0yC,SAAS,EAAG,EAAGz6C,EAAOG,GAC1B4H,EAAI2yC,UACJ3yC,EAAIgpC,cAAe,EACnBH,EAAMp0C,IAAIuL,GACVyuE,EAAO/vB,KAAO1+C,IAEdA,EAAIgF,EAAIA,EACRhF,EAAIiG,EAAIA,EACRjG,EAAI/H,MAAQA,EACZ+H,EAAI5H,OAASA,IAIjB83E,EAAmC,SAA3BlF,EAASv1E,QAAQZ,MAAmB6pD,EAAO+vB,CACvD,KAAIyB,EAAO,MACX,IAAMpiE,GAAI3U,KAAK2mB,IAAIiwD,EAASvB,EAAMv2E,MAAQ43E,EAAQrB,EAAMv2E,OAClD4M,EAAI1L,KAAK2mB,IAAIkwD,EAAUxB,EAAMp2E,OAAS03E,EAAStB,EAAMp2E,OAC3D,QAAQnF,GACJ,IAAK,WACDo7C,EAAO6hC,EAAO1B,EAAMxpE,EAAGwpE,EAAMvoE,EAAG6H,EAAGjJ,EACnC,MACJ,KAAK,aACDwpC,EAAO6hC,EAAO1B,EAAMxpE,GAAGwpE,EAAMv2E,MAAM6V,GAAG,EAAG0gE,EAAMvoE,EAAG6H,EAAGjJ,EACrD,MACJ,KAAK,YACDwpC,EAAO6hC,EAAO1B,EAAMxpE,EAAEwpE,EAAMv2E,MAAM6V,EAAG0gE,EAAMvoE,EAAG6H,EAAGjJ,EACjD,MACJ,KAAK,cACDwpC,EAAO6hC,EAAO1B,EAAMxpE,EAAGwpE,EAAMvoE,GAAGuoE,EAAMp2E,OAAOyM,GAAG,EAAGiJ,EAAGjJ,EACtD,MACJ,KAAK,gBACDwpC,EAAO6hC,EAAO1B,EAAMxpE,GAAGwpE,EAAMv2E,MAAM6V,GAAG,EAAG0gE,EAAMvoE,GAAGuoE,EAAMp2E,OAAOyM,GAAG,EAAGiJ,EAAGjJ,EACxE,MACJ,KAAK,eACDwpC,EAAO6hC,EAAO1B,EAAMxpE,EAAEwpE,EAAMv2E,MAAM6V,EAAG0gE,EAAMvoE,GAAGuoE,EAAMp2E,OAAOyM,GAAG,EAAGiJ,EAAGjJ,EACpE,MACJ,KAAK,cACDwpC,EAAO6hC,EAAO1B,EAAMxpE,EAAGwpE,EAAMvoE,EAAEuoE,EAAMp2E,OAAOyM,EAAGiJ,EAAGjJ,EAClD,MACJ,KAAK,gBACDwpC,EAAO6hC,EAAO1B,EAAMxpE,GAAGwpE,EAAMv2E,MAAM6V,GAAG,EAAG0gE,EAAMvoE,EAAEuoE,EAAMp2E,OAAOyM,EAAGiJ,EAAGjJ,EACpE,MACJ,KAAK,eACDwpC,EAAO6hC,EAAO1B,EAAMxpE,EAAEwpE,EAAMv2E,MAAM6V,EAAI0gE,EAAMvoE,EAAEuoE,EAAMp2E,OAAOyM,EAAGiJ,EAAGjJ,QAIxE,IAAyB,UAAtBjD,EAAE9P,OAAOgjD,SAAsB,CACnC,GAAM2U,GAAYr6B,EAAKlD,WAAW0vB,WAAWC,SAASmvB,EAASv1E,QAAQgd,MAAO2c,EAAKlD,WAAW9vB,QAC9FwF,GAAE9P,OAAO4xD,aAAaz/C,KAAOwlD,MAE5B,IAAyB,SAAtB7nD,EAAE9P,OAAOgjD,SAAoB,CACjC,GAAM7+C,GAAM2L,EAAE9P,OAAOoxC,SAAS,GAC1B0N,EAAM,EACV,IAAIxhB,EAAKlD,WAAW0vB,WAAWn2C,QAAQulE,EAASv1E,QAAQgd,QAGpD,GAFAu4D,EAASv1E,QAAQgd,MAAMnD,QAAQ,SAAA1N,GAAA,MAAKgvC,IAAOxhB,EAAKlD,WAAW0vB,WAAWqC,WAAWr8C,EAAE5O,KAAMo8B,EAAKlD,WAAW9vB,WACzGgzB,EAAKlD,WAAWwxB,uBAAuBstB,EAASv1E,QAAQgd,MAAOxc,EAAKm5B,EAAKlD,WAAW9vB,SAChFumC,EAAAA,WAAUrrC,WAAY,CACtB,GAAM0jD,GAAK5rB,EAAKlD,WAAW6V,UAAUpqC,KAAKI,KAAOq3B,EAAKlD,WAAW+uB,sBAAsB+vB,EAASv1E,QAAQ6pD,WAAa0rB,EAASv1E,QAAQ6pD,UAChIpE,EAAK9rB,EAAKlD,WAAW6V,UAAUpqC,KAAKI,KAAOq3B,EAAKlD,WAAWivB,qBAAqB6vB,EAASv1E,QAAQ6pD,WAAa0rB,EAASv1E,QAAQ6pD,SACrIlwB,GAAKlD,WAAWkvB,iBAAiB4vB,EAASv1E,QAAQgd,MAAOyoC,EAAIF,EAAI/kD,EAAKm5B,EAAKlD,WAAW9vB,cAG1Fw0C,GAAMxhB,EAAKlD,WAAW0vB,WAAWqC,WAAW+sB,EAASv1E,QAAQgd,MAAO2c,EAAKlD,WAAW9vB,QAEpFumC,GAAAA,WAAUrrC,YACVrB,EAAIitC,SAAS5zB,QAAQ,SAAA1N,GAAMA,EAAEg/B,SAAU,IACvC3qC,EAAIgO,KAAO,KAGXhO,EAAIgO,KAAO2sC,GAIvB,GAAGhvC,EAAEshC,UAAYthC,EAAEshC,SAAS5vC,OAAS,EACjC,IAAI,GAAIoF,GAAG,EAAEA,EAAEkJ,EAAEshC,SAAS5vC,OAAOoF,IAC7B60D,EAAQ3rD,EAAEshC,SAASxqC,IAAG,GAIlC60D,GAAQ70B,GAAK,IAGrB,OAAO63C,IAGjBrJ,eAAgB,SAAUiK,EAAU1b,GACnC,GAAa,IAATA,EAAY,CACf,GAAIC,GAAOyb,EAASl5E,MAAQk5E,EAAS/4E,OAASnG,KAAK2vC,cAAcj8B,KAAKshC,MAAMhvC,MAAQhG,KAAK2vC,cAAcj8B,KAAKshC,MAAM7uC,OAASnG,KAAK2vC,cAAcj8B,KAAKshC,MAAMhvC,MAAQk5E,EAASl5E,MAAQhG,KAAK2vC,cAAcj8B,KAAKshC,MAAM7uC,OAAS+4E,EAAS/4E,MAClO+4E,GAASl5E,OAASy9D,EAClByb,EAAS/4E,QAAUs9D,EACnByb,EAASnsE,IAAMmsE,EAASl5E,MAAQhG,KAAK2vC,cAAcj8B,KAAKshC,MAAMhvC,OAAS,EACvEk5E,EAASlrE,IAAMkrE,EAAS/4E,OAASnG,KAAK2vC,cAAcj8B,KAAKshC,MAAM7uC,QAAU,MAErE,IAAa,IAATq9D,EAAY,CACpB,GAAIC,GAAO,CACPyb,GAASl5E,MAAQk5E,EAAS/4E,OAASnG,KAAK2vC,cAAcj8B,KAAKshC,MAAMhvC,MAAQhG,KAAK2vC,cAAcj8B,KAAKshC,MAAM7uC,QAC1Gs9D,EAAOzjE,KAAK2vC,cAAcj8B,KAAKshC,MAAMhvC,MAAQk5E,EAASl5E,MACtDk5E,EAASl5E,OAASy9D,EAClByb,EAAS/4E,QAAUs9D,EACnByb,EAASlrE,GAAKhU,KAAK2vC,cAAcj8B,KAAKshC,MAAM7uC,OAAS+4E,EAAS/4E,QAAU,IAGxEs9D,EAAOzjE,KAAK2vC,cAAcj8B,KAAKshC,MAAM7uC,OAAS+4E,EAAS/4E,OACvD+4E,EAASl5E,OAASy9D,EAClByb,EAAS/4E,QAAUs9D,EACnByb,EAASnsE,GAAK/S,KAAK2vC,cAAcj8B,KAAKshC,MAAMhvC,MAAQk5E,EAASl5E,OAAS,OAIvEk5E,GAASl5E,MAAQhG,KAAK2vC,cAAcj8B,KAAKshC,MAAMhvC,MAC/Ck5E,EAAS/4E,OAASnG,KAAK2vC,cAAcj8B,KAAKshC,MAAM7uC,QAIlD+sE,eAAgB,SAAUnlE,EAAKoxE,EAAY7uE,EAAU8uE,EAAMC,EAAW9uE,EAAO23D,EAAQoX,GAAM,GAAA7+C,GAAAzgC,IAE1F,OADAsQ,GAAWpJ,KAAK2M,IAAIvD,EAAU,GACvB,GAAI1O,SAAQ,SAACC,EAASC,GAC5B,GAAMy1C,GAAQ9W,EAAKkP,cAAcj8B,KAAKlR,IAAI+0C,MAAMxpC,GAAKwxE,GAAGJ,EACrD7uE,EACA8uE,EAAMC,EACN9uE,EAAO23D,EAAQoX,EAClB/nC,GAAMngC,WAAW5U,IAAI,WAAA,MAAMX,OAC3B4+B,EAAKxG,WAAWmR,cAAc7nB,KAAKg0B,IACtBxpC,EAAI+jE,gBAAkB/jE,EAAI+jE,kBACE/jE,EAAI+jE,cAAcvuD,KAAKg0B,GACjDxpC,EAAIlO,QAAUkO,EAAIlO,OAAOA,QAAUkO,EAAIlO,OAAOA,OAAOA,QAA2C,gBAAlCkO,EAAIlO,OAAOA,OAAOA,OAAOD,MACtFmO,EAAIlO,OAAOA,OAAOA,OAAOiyE,cAAcvuD,KAAKg0B,MAK9DioC,iBAAkB,SAAUzxE,EAAKoxE,EAAY7uE,EAAU8uE,EAAMC,EAAW9uE,EAAO23D,EAAQoX,GAAM,GAAAt+C,GAAAhhC,IAE5F,OADSsQ,GAAWpJ,KAAK2M,IAAIvD,EAAU,GAChC,GAAI1O,SAAQ,SAACC,EAASC,GAC5B,GAAMy1C,GAAQvW,EAAK2O,cAAcj8B,KAAKlR,IAAI+0C,MAAMxpC,GAAKk9C,KAAKk0B,EACvD7uE,EACA8uE,EAAMC,EACN9uE,EAAO23D,EAAQoX,EAClB/nC,GAAMngC,WAAW5U,IAAI,WAAA,MAAMX,OACfm/B,EAAK/G,WAAWmR,cAAc7nB,KAAKg0B,IAClCxpC,EAAI+jE,gBAAkB/jE,EAAI+jE,kBACc/jE,EAAI+jE,cAAcvuD,KAAKg0B,GAC7DxpC,EAAIlO,QAAUkO,EAAIlO,OAAOA,QAAUkO,EAAIlO,OAAOA,OAAOA,QAA4C,gBAAlCkO,EAAIlO,OAAOA,OAAOA,OAAOD,MACvFmO,EAAIlO,OAAOA,OAAOA,OAAOiyE,cAAcvuD,KAAKg0B,MASxDkoC,gBAAgB,SAAU7oC,EAAM7f,GAAU,GAAAgqB,GAAA/gD,IACtC,KAAI+2B,EAAU,MAAO,KACrB,IAAMizB,GAAQjzB,EAASI,KAAK,GACtB/yB,EAASpE,KAAK2vC,cAAcj8B,KAAKlR,IAAI69C,OAC3Cj8C,GAAOmH,KAAOy+C,EAAMz+C,KACpBnH,EAAOya,OAASmrC,EAAMnrC,OACtBza,EAAOs7E,OAAS11B,EAAM01B,OACtBt7E,EAAOgB,MAAQ4kD,EAAM5kD,MACrBhB,EAAO4B,MAAQgkD,EAAMwE,KAAKxoD,MAC1B5B,EAAO+B,OAAS6jD,EAAMwE,KAAKroD,OAC3B/B,EAAOu7E,SAAW31B,EAAMwE,KAAKroD,OAC7B/B,EAAOw7E,WAAa,EACpBx7E,EAAOy7E,QAAU,EACjBz7E,EAAOy/C,cACPz/C,EAAO0/C,aACP1/C,EAAO2/C,QAAS,EAChB3/C,EAAO4/C,WAAY,EACnB5/C,EAAO2yB,SAAWA,EAClB3yB,EAAOs7D,QAAS,EAChBt7D,EAAO2O,EAAIi3C,EAAMwE,KAAKz7C,EACtB3O,EAAO4P,EAAIg2C,EAAMwE,KAAKx6C,EACtB4iC,GAASA,EAAMsX,SAAS9pD,EAExB,IAAI07E,GAAK,IACQ,MAAd91B,EAAMtjD,KAAc1G,KAAK2vC,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAc2rC,EAAMtjD,KAC1E1G,KAAK2vC,cAAckyB,kBAAkB,EAAE,EACnC7X,EAAMwE,KAAKxoD,MACXgkD,EAAMwE,KAAKroD,OACX6jD,EAAMtjD,IACNtC,EACA4lD,EAAM5kD,QAEV06E,EAAK9/E,KAAK2vC,cAAcj8B,KAAKlR,IAAI+9C,SAAS,EAAE,GAC5Cu/B,EAAGt/B,UAAU,SAAS,GACtBs/B,EAAGr/B,SAAS,EAAE,EAAEuJ,EAAMwE,KAAKxoD,MAAMgkD,EAAMwE,KAAKroD,QAC5C25E,EAAGp/B,UACHt8C,EAAO8pD,SAAS4xB,GAEpB,IAAM7V,GAAajqE,KAAK2vC,cAAcj8B,KAAKlR,IAAIurD,OAAO,EAAE,EACxDkc,GAAWrqE,KAAO,mBAClBwE,EAAO8pD,SAAS+b,EAGhB,IAAM8V,GAAiB//E,KAAK2vC,cAAcj8B,KAAKlR,IAAI+9C,UACnDw/B,GAAengF,KAAO,iBACtBmgF,EAAev/B,UAAU,SAAS,GAClCu/B,EAAet/B,SAAS,EAAE,EAAE,EAAE,GAC9Bs/B,EAAer/B,UACfupB,EAAW/b,SAAS6xB,EAEpB,IAAIzV,GAAkB,EAAEC,EAAa,KACjCC,GAAa,EACbwV,EAAO,EAAEC,EAAO,EAAEC,EAAQ,EAAEC,EAAQ,EAClCxV,EAAW,SAAC7K,GACV,GAAI/sD,GAAAA,OAAGiB,EAAAA,OACH6H,EAAKrgB,OAAO0rC,YAAcllC,SAASmlC,gBAAgBzkC,aAAeV,SAASC,KAAKS,YAChFkQ,EAAKpX,OAAO4rC,aAAeplC,SAASmlC,gBAAgBxkC,cAAgBX,SAASC,KAAKU,YAmBtF,OAlBIkZ,GAAIjJ,EACD7P,UAAUC,UACT+P,EAAI+sD,EAAQsL,OACZp3D,GAAK8rD,EAAQuL,SAEbt4D,EAAI+sD,EAAQuL,OACZr3D,EAAI8rD,EAAQsL,QAIbroE,UAAUC,UACT+P,EAAI+sD,EAAQuL,OACZr3D,EAAI8rD,EAAQsL,SAEZr4D,EAAI+sD,EAAQsL,OACZp3D,GAAK8rD,EAAQuL,SAGbt4D,EAAAA,EAAEiB,EAAAA,IAEZ82D,EAAW,SAAC/3D,EAAEiB,GAChB,GAAG5P,EAAOw7E,WAAa51B,EAAMwE,KAAKroD,OAC9B,IACI8jE,EAAWnO,MAAMyP,cACpB,MAAOr9D,QAGT8F,GAAI,EACHi2D,EAAWj2D,EAAI,EACVA,IAAM5P,EAAOw7E,WAAa51B,EAAMwE,KAAKroD,QAC1C8jE,EAAWj2D,IAAM5P,EAAOw7E,WAAa51B,EAAMwE,KAAKroD,QAEhD8jE,EAAWj2D,EAAIA,GAGjBy2D,EAAS,SAAC3K,EAAS/sD,EAAGiB,GACxB,GAAM02D,GAAQC,EAAS7K,GACjB8K,EAAiB,WAAWtiE,KAAKgM,UAAU+G,WAAc,iBAAmB,YAC7EqvD,GAOIF,IACDxoE,SAASoZ,iBAAiBwvD,EAAeC,GACzCL,GAAa,GARbA,IACAxoE,SAASkZ,oBAAoB0vD,EAAeC,GAC5CL,GAAa,IAUnBK,EAAe,SAAA38D,GACjB,GAAMs9D,GAAQt9D,EAAEu9D,WAAav9D,EAAEu9D,WAAa,KAAOv9D,EAAEw9D,OAAS,CAC9DZ,GAAS,EAAGb,EAAWj2D,EAAY,IAARw3D,IAEzBT,EAAe,SAAChd,EAAQ+R,EAAS/sD,EAAGiB,EAAGg3D,EAAIC,GACzC,GAAIpvD,GAAKrgB,OAAO0rC,YAAcllC,SAASmlC,gBAAgBzkC,aAAeV,SAASC,KAAKS,YAChFkQ,EAAKpX,OAAO4rC,aAAeplC,SAASmlC,gBAAgBxkC,cAAgBX,SAASC,KAAKU,aAClFuoE,EAAKn4D,EACLo4D,EAAKn3D,CACTi3D,KAAeX,EAAkBv3D,GACjCw3D,EAAaN,EAAWj2D,EACpB6H,EAAIjJ,GAAoB,OAAf23D,IACTY,EAAKZ,EAAax3D,EAAIu3D,GAE1BQ,EAASI,EAAIC,IAEf8D,EAAc,SAAClhB,EAAQ+R,EAAS/sD,EAAGiB,EAAGg3D,EAAIC,GAC5CX,EAAkBv3D,EAClBw3D,EAAaN,EAAWj2D,GAEtBk7D,EAAa,SAACnhB,EAAQ+R,EAAS/sD,EAAGiB,EAAGg3D,EAAIC,GAC3CV,EAAaN,EAAWj2D,GAEtBm7D,EAAW,SAAC17D,EAAGu3D,GACjBkV,EAAUn/B,EAAKpR,cAAcj8B,KAAKooD,MAAM/oD,EACxCotE,EAAUp/B,EAAKpR,cAAcj8B,KAAKooD,MAAM9nD,GACpC9M,KAAKkN,IAAI4rE,EAAOE,IAAW,GAAKh5E,KAAKkN,IAAI6rE,EAASE,IAAW,IAAM/7E,EAAOs7D,SAC1Et7D,EAAOs7D,QAAS,EACkB,OAA/B3e,EAAK9mB,WAAW6S,YACfiU,EAAK9mB,WAAW6S,aAEpB1oC,EAAOg8E,QAAUh8E,EAAOg8E,OAAOh8E,IAEnC47E,EAAO,EAAEC,EAAO,EAAEC,EAAQ,EAAEC,EAAQ,EACpC/7E,EAAOs7D,QAAS,GAEd0B,EAAc,SAACrT,EAAO+R,GAIxB,MAHA17D,GAAOs7D,QAAS,EAChBsgB,EAASj/B,EAAKpR,cAAcj8B,KAAKooD,MAAM/oD,EACvCktE,EAASl/B,EAAKpR,cAAcj8B,KAAKooD,MAAM9nD,EACnC22D,EAAS7K,GAGN/R,EAAO+N,MAAMwP,aAFTvd,EAAO+N,MAAMyP,cAI5BtB,GAAWlzB,cAAe,EAC1BkzB,EAAWnO,MAAMwP,aACjBrB,EAAWnO,MAAM6P,qBAAsB,EACvC1B,EAAWn5B,OAAOi6B,aAAavoE,IAAIuoE,EAAc/qE,MACjDiqE,EAAWn5B,OAAOm+B,YAAYzsE,IAAIysE,EAAajvE,MAC/CiqE,EAAWn5B,OAAOo+B,WAAW1sE,IAAI0sE,EAAYlvE,MAC7CiqE,EAAWn5B,OAAOswB,YAAY5+D,IAAI4+D,EAAaphE,MAC/CiqE,EAAWn5B,OAAOqvB,UAAU39D,IAAI2sE,EAAUnvE,MAC1CA,KAAK2vC,cAAcj8B,KAAKooD,MAAM8P,gBAAgBnB,EAAQzqE,KAEtD,IAAIysD,GAAOzsD,KAAK2vC,cAAcj8B,KAAKlR,IAAI+9C,UAYvC,OAXAkM,GAAKjM,UAAU,EAAE,GACjBiM,EAAKhM,SAAS,EAAE,EAAEuJ,EAAMwE,KAAKxoD,MAAMgkD,EAAMwE,KAAKroD,QAC9CsmD,EAAK/L,UACLt8C,EAAO8pD,SAASzB,GAChBroD,EAAOqoD,KAAOA,EACdroD,EAAOi8E,UAAYvV,EACnBl0B,GAAS52C,KAAK2vC,cAAcj8B,KAAKshC,MAAM6V,WAAWjU,IACjD52C,KAAKi6B,WAAWw4B,YAAY6tB,UAAYtgF,KAAK2vC,cAAcj8B,KAAKshC,MAAM6V,WAAW7qD,KAAKi6B,WAAWw4B,aAClGzyD,KAAK2vC,cAAcj8B,KAAKshC,MAAM6V,WAAW7qD,KAAKi6B,WAAWi4B,gBACtDlyD,KAAKi6B,WAAW6U,UAAUmC,SAAS5vC,OAAS,GAAErB,KAAK2vC,cAAcj8B,KAAKshC,MAAM6V,WAAW7qD,KAAKi6B,WAAW6U,WAC1G9uC,KAAKi6B,WAAWmO,eAAeC,OAASroC,KAAK2vC,cAAcj8B,KAAKshC,MAAM6V,WAAW7qD,KAAKi6B,WAAWmO,gBAC1FhkC,GAQXm8E,aAAa,SAAUzqC,EAAK1xC,GAAQ,GAAA+8C,GAAAnhD,IAChC,OAAO,IAAI4B,SAAQ,SAACC,EAAQC,GACxB,GAAMu+C,GAAQc,EAAKxR,cAAcj8B,KAAKlR,IAAI69C,OAC1CA,GAAMtpB,SAAW+e,CACjB,IAAMkU,GAAQlU,EAAK3e,KAAK,GACjBn2B,EAAqCgpD,EAArChpD,KAAKwC,EAAgCwmD,EAAhCxmD,QAAQ26B,EAAwB6rB,EAAxB7rB,OAAOqiD,EAAiBx2B,EAAjBw2B,KAAKpb,EAAYpb,EAAZob,SAC1Bqb,EAAer8E,EAAOk8C,UAAU,oBAChCy/B,EAAiBU,GAAgBA,EAAa/zB,WAAW,GAC3Dg0B,GAAc,EACdC,EAAW,SAEX5tE,EAAI,EAAEiB,EAAE,CACZ,QAAQoxD,GACJ,IAAK,OACDryD,EAAI,EAAEiB,EAAI5P,EAAOw7E,WACjBe,EAAW,QACX,MACJ,KAAK,SACDD,GAAc,EACd3tE,EAAI3O,EAAO4B,MAAQ,EAAEgO,EAAI5P,EAAOw7E,WAChCe,EAAW,QACX,MACJ,KAAK,QACD5tE,EAAI3O,EAAO4B,MAAMgO,EAAI5P,EAAOw7E,WAC5Be,EAAW,SAMnB,GAHAtgC,EAAMttC,EAAIA,EACVstC,EAAMrsC,EAAIA,EAEPmtC,EAAKxR,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAc8f,EAAOz3B,MAAqB,WAAb0+D,EAAsB,CACrF,GAAMwb,GAAevgC,EAAM4b,OAAO99B,EAAOqwB,KAAKz7C,EAAEorB,EAAOqwB,KAAKx6C,EAAEmqB,EAAOz3B,KAC/D2N,EAAQnN,KAAK2mB,IAAIsQ,EAAOqwB,KAAKxoD,MAAM46E,EAAa56E,MAAMm4B,EAAOqwB,KAAKroD,OAAOy6E,EAAaz6E,OAC5Fy6E,GAAa56E,OAASqO,EACtBusE,EAAaz6E,QAAUkO,EACvBusE,EAAa7tE,GAAKorB,EAAOqwB,KAAKxoD,MAAQ46E,EAAa56E,OAAS,EAAIm4B,EAAOqwB,KAAKz7C,EAC5E6tE,EAAa5sE,GAAKmqB,EAAOqwB,KAAKroD,OAASy6E,EAAaz6E,QAAU,EAAIg4B,EAAOqwB,KAAKx6C,EAGlF,GAAgB,WAAboxD,EAAsB,CACrB,GAAMyb,IACFlsE,KAAK6rE,EAAKn8E,MACTqB,KAAK86E,EAAKnzB,UAAY,MAAOmzB,EAAKn7E,YAEjCy7E,EAAW3/B,EAAKlnB,WAAW0vB,WAAWqC,WAAWw0B,EAAKz/E,KAAMogD,EAAKlnB,WAAW9vB,SAC5E42E,EAAU5/B,EAAKxR,cAAcj8B,KAAKlR,IAAIwP,KAAK,EAAE,EAAE8uE,EAASD,EAAUxgC,EACxE0gC,GAAQlgC,cAAc2/B,EAAKhyB,KAAKz7C,EAAEytE,EAAKhyB,KAAKx6C,EAAEwsE,EAAKhyB,KAAKxoD,MAAMw6E,EAAKhyB,KAAKroD,QAI5E,GAAY,UAATnF,GAEC,GAAGmgD,EAAKxR,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAc7a,EAAQkD,KAAK,CAC7D,GAAMs6E,GAAa3gC,EAAM4b,OAAOz4D,EAAQgrD,KAAKz7C,EAAE2tE,EAAc,EAAIl9E,EAAQgrD,KAAKx6C,EAAExQ,EAAQkD,IACxFs6E,GAAWh7E,MAAQxC,EAAQgrD,KAAKxoD,MAChCg7E,EAAW76E,OAAS3C,EAAQgrD,KAAKroD,YAGnC,IAAY,SAATnF,EAAgB,CAErB,GAAMigF,IACFtsE,KAAKnR,EAAQa,MACZqB,KAAKlC,EAAQ6pD,UAAY,MAAQ7pD,EAAQ6B,WACxCs7C,aAAc,SACdC,aAAc,SACd3uC,UAAU,EACV8D,cAAevS,EAAQgrD,KAAKxoD,OAE5Bk7E,EAAa//B,EAAKxR,cAAcj8B,KAAKlR,IAAIwP,KAAKxO,EAAQgrD,KAAKz7C,EAAI,EAAE2tE,EAAc,EAAIl9E,EAAQgrD,KAAKx6C,EAAI,EAAE,GAAGitE,EAAiB5gC,EAChI6gC,GAAW3U,iBAAkB,EAC7B2U,EAAW1U,WAAahR,EAAAA,WAASgR,WACjC0U,EAAWxU,YAAcvrB,EAAKlnB,WAAW46B,aAAarxD,EAAQ6pD,UAC9D,IAAI8zB,GAAc,EAClB,IAAIhgC,EAAKlnB,WAAW0vB,WAAWn2C,QAAQhQ,EAAQzC,MAC3C,IAAK,GAAI0F,GAAE,EAAGA,EAAEjD,EAAQzC,KAAKM,OAAQoF,IACjC06E,GAAehgC,EAAKlnB,WAAW0vB,WAAWqC,WAAWxoD,EAAQzC,KAAK0F,GAAG1F,KAAMogD,EAAKlnB,WAAW9vB,SAE3Fg3C,EAAKlnB,WAAWwxB,uBAAuBjoD,EAAQzC,KAAMmgF,EAAY//B,EAAKlnB,WAAW9vB,aAKrFg3E,GAAchgC,EAAKlnB,WAAW0vB,WAAWqC,WAAWxoD,EAAQzC,KAAMogD,EAAKlnB,WAAW9vB,SAClF3G,EAAQzC,KAAKsD,QAAU68E,EAAWt+E,MAAM+R,KAAOnR,EAAQzC,KAAKsD,MAEhE,MAAO88E,EAAY9/E,QAAgD,OAAtC8/E,EAAYA,EAAY9/E,OAAO,IAExD8/E,EAAcA,EAAY3qE,UAAU,EAAG2qE,EAAY9/E,OAAO,EAG9D,IADA6/E,EAAWlvE,KAAOmvE,EACC,KAAhBA,EAAmB,CAGlB,GAAMC,GAAYjgC,EAAKxR,cAAcj8B,KAAKlR,IAAI+9C,WACxC8gC,EAAKH,EAAW/6E,OAAS3C,EAAQgrD,KAAKroD,OAAS+6E,EAAW/6E,OAAS3C,EAAQgrD,KAAKroD,MAMtF,IALAi7E,EAAU5gC,UAAUmgC,GACpBS,EAAUE,gBAAgB99E,EAAQgrD,KAAKz7C,EAAE2tE,EAAc,EAAIl9E,EAAQgrD,KAAKx6C,EAAExQ,EAAQgrD,KAAKxoD,MAAMq7E,EAAG,EAAE,GAClGD,EAAU1gC,UACVL,EAAMkhC,WAAWH,EAAU,GAEX,WAAbhc,EAAsB,CACrB,GAAIoc,GAAU,EAAEC,EAAU,EACtBC,EAAYl+E,EAAQgrD,KAAKz7C,EAAE4uE,EAAYn+E,EAAQgrD,KAAKx6C,EAAG,CAC3C,UAAboxD,GACCoc,MACAC,EAAU,GACVC,GAAa,GACK,UAAbtc,IACLoc,EAAU,GACVC,EAAU,GACVC,GAAcl+E,EAAQgrD,KAAKxoD,MAAQ,EAEvC,IAAM47E,GAAWzgC,EAAKxR,cAAcj8B,KAAKlR,IAAI+9C,UAC7CqhC,GAASphC,UAAUmgC,GACnBiB,EAASC,OAAOH,EAAUC,GAC1BC,EAASE,OAAOJ,EAAYF,EAASG,EAAYF,GACjDG,EAASE,OAAOJ,EAAUC,EAAY,IACtCC,EAASlhC,UACTL,EAAMkhC,WAAWK,EAAS,KAkBtC,MAXAx9E,GAAOw7E,YAAcv/B,EAAMl6C,OAAS,GACjC45E,IACCA,EAAej7D,QACfi7D,EAAev/B,UAAU,EAAS,GAClCu/B,EAAet/B,SAAS,EAAE,EAAEr8C,EAAO4B,MAAM5B,EAAOw7E,YAChDG,EAAer/B,WAEnB+/B,EAAavyB,SAAS7N,GACnBj8C,EAAOw7E,WAAax7E,EAAOu7E,WAC1Bc,EAAazsE,IAAM5P,EAAOw7E,WAAax7E,EAAOu7E,WAE3C99E,EAAQw+C,MAKvBmxB,SAAU,SAAUrnE,EAAS2nB,EAASk1B,EAAOprB,EAAaoX,GAAU,GAAA8O,GAAA9hD,KAClE2pD,EAAc3pD,KAAKi6B,WAAnB0vB,WACDrzB,EAAOxE,EAAQ6E,MAAMqwB,GACdk4B,EAAW,KACpB6C,EAAW,KACXC,EAAa,KACbC,GAAY,CACPjiF,MAAK0wE,eACV1wE,KAAKi6B,WAAWwS,eAAgB,GACvBy1C,WAAWn/E,UAAU+L,OAAO/L,UAAUstB,aAAY,EAA4B,MAAtBttB,UAAUmM,SAEtElP,KAAKi6B,WAAWwS,aAAc,GAElCzsC,KAAKi6B,WAAWgR,eAAiBnZ,EAAQgqB,SAAmB,IAARkL,GAExDhnD,KAAKi6B,WAAW8hB,mBAIjB,IAAMomC,GAAa,QAAbA,GAAcC,EAAe9xE,EAAkBC,GACpD,GAAM8xE,GAAYD,EACZnoD,EAAa6nB,EAAK7nB,WAClBklD,GACLpsE,EAAGknB,EAAWw4B,YAAY1/C,EAAIsvE,EAC9BruE,EAAGimB,EAAWw4B,YAAYz+C,EAAIquE,GAE3B3nD,IAMQ,IALAT,EAAW+f,aAAasoC,WAAY,EAChChsD,EAAKisD,UAAuC,WAA3BjsD,EAAKisD,SAASC,WAC/BvoD,EAAWw4B,YAAYgwB,UAAY,QACnC/nD,EAASnX,KAAKu+B,EAAKoxB,eAAej5C,EAAWw4B,YAAa0sB,EAAY,GAAI,MAAM,EAAM5uE,EAAO,GAAG,KAEhG0pB,EAAWgd,oBAAsBhd,EAAWgd,mBAAmBtI,QAAS,CACxE,GAAM+zC,GAAOzoD,EAAWgd,mBAAmBlkC,EACrC4vE,EAAO1oD,EAAWgd,mBAAmBjjC,CAC3CimB,GAAWgd,mBAAmBwrC,UAAY,QAC1C/nD,EAASnX,KAAKu+B,EAAKoxB,eAAej5C,EAAWgd,oBACxClkC,EAAGknB,EAAWgd,mBAAmBlkC,EAAIsvE,EAAWruE,EAAGimB,EAAWgd,mBAAmBjjC,EAAIquE,GACtF,GAAI,MAAM,EAAM9xE,EAAO,GAAG,GAAMrH,KAAK,WACrC+wB,EAAWgd,mBAAmBlkC,EAAI2vE,EAClCzoD,EAAWgd,mBAAmBjjC,EAAI2uE,KAuBtD,MApBY1oD,GAAW+f,aAAayoC,UAAY,QACpC/nD,EAASnX,KAAKu+B,EAAKoxB,eAAej5C,EAAW+f,cACzCjnC,GAAIsvE,EACJruE,GAAIquE,GACL,GAAI,MAAM,EAAM9xE,EAAO,GAAG,GACxBrH,KAAK,WAGF,MAFA+wB,GAAW+f,aAAajnC,EAAI,EAC5BknB,EAAW+f,aAAahmC,EAAI,EACiB,IAA1C8tC,EAAK7nB,WAAWqS,aAAah8B,UAC5B2pB,EAAW+f,aAAasoC,WAAY,EAC7B1gF,QAAQC,WAEf,EAAIyO,IAAa2pB,EAAWkO,WAAarW,IAAYmI,EAAWgV,YAAc+X,IAAU/sB,EAAWwc,aAC5F0rC,EAAWE,EAAW/xE,EAAS,IAAK,IAG3C2pB,EAAW+f,aAAasoC,WAAY,EAC7B1gF,QAAQC,cAGhCD,QAAQm5B,IAAIL,IAGdkoD,EAAa,WACN9gC,EAAK7nB,WAAW+f,eAAiB8H,EAAK7nB,WAAW+f,aAAasoC,WAAY,GAC1ExgC,EAAK7nB,WAAWqS,aAAa98B,MAAO,EACpCsyC,EAAK7nB,WAAWqS,aAAah8B,SAAW,CACxC,KAAI,GAAI7J,GAAI,EAAGA,EAAEq7C,EAAK7nB,WAAWmR,cAAc/pC,OAAOoF,IAAK,CACvD,GAAI8wC,GAAQuK,EAAK7nB,WAAWmR,cAAc3kC,EACvC8wC,GAAMxxC,QAAqC,UAA3BwxC,EAAMxxC,OAAO08E,YAC5BlrC,EAAM3+B,QACN2+B,EAAM/+B,MAAK,MAM1BqqE,EAAe,SAACvyE,EAAUC,EAAOlM,GAE1B,MADZy9C,GAAK7nB,WAAWoR,aAAe5jC,EAAAA,WAAM8E,QAAQgE,GAAS,GACnCuxC,EAAK7nB,WAAWoR,aAAaniC,KAAK,WACrC,GAAM45E,GAAUhhC,EAAKnS,cAAcj8B,KAAKlR,IAAI+9C,SAAS,EAAG,EAUxD,OATAuiC,GAAQtiC,UAAU/4C,EAAAA,WAAMs7E,cAAc1+E,GAAOoS,QAAQ,IAAK,OAC1DqsE,EAAQjB,OAAO,EAAG,GAClBiB,EAAQhB,OAAOhgC,EAAKnS,cAAcj8B,KAAKshC,MAAMhvC,MAAO,GACpD88E,EAAQhB,OAAOhgC,EAAKnS,cAAcj8B,KAAKshC,MAAMhvC,MAAO87C,EAAKnS,cAAcj8B,KAAKshC,MAAM7uC,QAClF28E,EAAQhB,OAAO,EAAGhgC,EAAKnS,cAAcj8B,KAAKshC,MAAM7uC,QAChD28E,EAAQhB,OAAO,EAAG,GAClBgB,EAAQpiC,UACRoiC,EAAQljF,KAAO,UACfkiD,EAAK7nB,WAAWoR,aAAe,KACxByW,EAAKoxB,eAAe4P,GAAUz6C,MAAO,GAAI/3B,EAAU,MAAM,EAAM,GAAGpH,KAAK,WAAA,MAAM45E,GAAQnmE,eAKvGqmE,EAAS,SAAC1yE,EAAUC,GACzB,MAAI2uE,GACIp9B,EAAK09B,iBAAiBN,GAAW72C,MAAO,GAAI/3B,EAAU,MAAM,EAAMC,GAEnE3O,QAAQC,WAIVohF,EAAU,SAAC3yE,EAAUC,GACvB,GAAI2yE,GAAUphC,EAAKnS,cAAcj8B,KAAKshC,MAAMsL,UAAU,kBACzC6iC,EAAUrhC,EAAKnS,cAAcj8B,KAAKshC,MAAMsL,UAAU,iBAClD4iC,KACAA,EAAUphC,EAAKnS,cAAcj8B,KAAKlR,IAAI+9C,SAAS,EAAE,GACjD2iC,EAAQ1iC,UAAU,GAClB0iC,EAAQziC,SAAS,EAAE,EAAEqB,EAAKnS,cAAcj8B,KAAK1N,MAAQ,EAAE87C,EAAKnS,cAAcj8B,KAAKvN,QAC/E+8E,EAAQxiC,UACRwiC,EAAQtjF,KAAO,kBAEfujF,IACAA,EAAUrhC,EAAKnS,cAAcj8B,KAAKlR,IAAI+9C,SAAS,EAAE,GACjD4iC,EAAQ3iC,UAAU,GAClB2iC,EAAQ1iC,SAAS,EAAE,EAAEqB,EAAKnS,cAAcj8B,KAAK1N,MAAQ,EAAE87C,EAAKnS,cAAcj8B,KAAKvN,QAC/Eg9E,EAAQziC,UACRyiC,EAAQvjF,KAAO,kBAEnBsjF,EAAQnwE,EAAI,EACZowE,EAAQpwE,EAAI+uC,EAAKnS,cAAcj8B,KAAK1N,MAAQ,EAC5C87C,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAWq4B,GACzCphC,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAWs4B,GACzCrhC,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAW6U,UACzD,IAAMpU,KAGN,OAFAA,GAASnX,KAAKu+B,EAAKoxB,eAAegQ,GAASnwE,IAAM+uC,EAAKnS,cAAcj8B,KAAK1N,MAAQ,IAAIsK,EAAS,MAAK,EAAKC,IACxGmqB,EAASnX,KAAKu+B,EAAKoxB,eAAeiQ,GAASpwE,EAAG+uC,EAAKnS,cAAcj8B,KAAK1N,OAAOsK,EAAS,MAAK,EAAKC,IACzF3O,QAAQm5B,IAAIL,IAIjB0oD,EAAc,SAAC9yE,EAAUC,GACpC,GAAI2yE,GAAUphC,EAAKnS,cAAcj8B,KAAKshC,MAAMsL,UAAU,sBAClD6iC,EAAUrhC,EAAKnS,cAAcj8B,KAAKshC,MAAMsL,UAAU,sBAChD+iC,EAAe,SAACriF,GACT,GAAIsiF,GAASxhC,EAAKnS,cAAcj8B,KAAKlR,IAAI+9C,SAAS,EAAE,EACpD+iC,GAAO9iC,UAAU,EAAS,GAC1B8iC,EAAO7iC,SAAS,EAAE,EAAEqB,EAAKnS,cAAcj8B,KAAK1N,MAAM87C,EAAKnS,cAAcj8B,KAAKvN;AAC1Em9E,EAAO5iC,SACP,IAAM6iC,GAASzhC,EAAKnS,cAAcj8B,KAAKvN,OAAS,EAC1Cq9E,EAAa,SAACC,EAAIC,GACpB,GAAIj3B,GAAO3K,EAAKnS,cAAcj8B,KAAKlR,IAAI+9C,SAAS,EAAE,EAMlD,OALAkM,GAAKjM,UAAU,GACfiM,EAAKhM,SAAS,EAAE,EAAEqB,EAAKnS,cAAcj8B,KAAK1N,MAAMu9E,GAChD92B,EAAK/L,UACL+L,EAAK15C,EAAI0wE,EACTh3B,EAAKz4C,EAAI0vE,EACFj3B,EAMX,OAJA62B,GAAOp1B,SAASs1B,EAAW,EAAED,GAAkB,IAATviF,EAAa,EAAI,KACvDsiF,EAAOp1B,SAASs1B,EAAW,EAAED,GAAkB,IAATviF,EAAa,EAAI,KACvDsiF,EAAOp1B,SAASs1B,EAAW,EAAED,GAAkB,IAATviF,EAAa,EAAI,KACvDsiF,EAAO1jF,KAAO,oBAAoBoB,EAC3BsiF,EAEPJ,KACAA,EAAUG,EAAa,IAEvBF,IACAA,EAAUE,EAAa,IAE3BH,EAAQnwE,EAAI,EACZowE,EAAQpwE,EAAI,EACZ+uC,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAWq4B,GACzCphC,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAWs4B,GACzCrhC,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAW6U,UACzD,IAAMpU,KAGN,OAFAA,GAASnX,KAAKu+B,EAAKoxB,eAAegQ,GAASnwE,GAAM+uC,EAAKnS,cAAcj8B,KAAK1N,OAAQsK,EAAS,MAAK,EAAKC,IACpGmqB,EAASnX,KAAKu+B,EAAKoxB,eAAeiQ,GAASpwE,EAAG+uC,EAAKnS,cAAcj8B,KAAK1N,OAAOsK,EAAS,MAAK,EAAKC,IACzF3O,QAAQm5B,IAAIL,IAIjBipD,EAAY,SAACrzE,EAAUC,GACzB,GAAI+yE,GAASxhC,EAAKnS,cAAcj8B,KAAKshC,MAAMsL,UAAU,mBACjDgjC,KACAA,EAASxhC,EAAKnS,cAAcj8B,KAAKlR,IAAI+9C,SAAS,EAAE,GAChD+iC,EAAO9iC,UAAU,GACjB8iC,EAAO7iC,SAAS,EAAE,EAAEqB,EAAKnS,cAAcj8B,KAAK1N,MAAM87C,EAAKnS,cAAcj8B,KAAKvN,QAC1Em9E,EAAO5iC,UACP4iC,EAAO1jF,KAAO,oBAElB0jF,EAAOvwE,GAAM+uC,EAAKnS,cAAcj8B,KAAK1N,KACrC,IAAI49E,GAAO,EACPC,EAAO,CACR3E,KACC0E,EAAO1E,EAASnsE,EAChB8wE,EAAO3E,EAASlrE,GAEhB8tC,EAAK7nB,WAAWuS,cAAgBsV,EAAKnS,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAcyjC,EAAK7nB,WAAWuS,eAC9F0yC,IAECA,EAAWp9B,EAAK7nB,WAAW+f,aAAaiiB,OAAOijB,EAASnsE,EAAGmsE,EAASlrE,EAAG8tC,EAAK7nB,WAAWuS,cACvF0yC,EAAS72C,MAA6C/mC,SAArCwgD,EAAK7nB,WAAWurB,iBAAiC,EAAI1D,EAAK7nB,WAAWurB,iBACtF1D,EAAKmzB,eAAeiK,EAAUp9B,EAAK7nB,WAAWyrB,eAC9C5D,EAAKnS,cAAcstB,gBAAgBiiB,EAAUp9B,EAAK7nB,WAAWqrB,eAGrExD,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAWy4B,GACzCxhC,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAW6U,UACzD,IAAMpU,KAQN,OAPAA,GAASnX,KAAKu+B,EAAKoxB,eAAeoQ,GAAQvwE,EAAG,GAAGzC,EAAW,EAAE,MAAK,EAAKC,GAAOrH,KAAK,WAC/Eg2E,EAAWp9B,EAAK7nB,WAAW+f,aAAaiiB,OAAO2nB,EAAMC,EAAM/hC,EAAK7nB,WAAWqrB,cAC3E45B,EAAS72C,MAA6C/mC,SAArCwgD,EAAK7nB,WAAWurB,iBAAiC,EAAI1D,EAAK7nB,WAAWurB,iBACtF1D,EAAKmzB,eAAeiK,EAAUp9B,EAAK7nB,WAAWyrB,eAC9C5D,EAAKnS,cAAcstB,gBAAgBiiB,EAAUp9B,EAAK7nB,WAAWqrB,cAC7DxD,EAAKoxB,eAAeoQ,GAAQvwE,EAAG+uC,EAAKnS,cAAcj8B,KAAK1N,OAAOsK,EAAW,EAAE,MAAK,EAAKC,MAElF3O,QAAQm5B,IAAIL,IAIjBopD,EAAQ,SAACxzE,EAAUC,GACrB,GAAM0pB,GAAa6nB,EAAK7nB,WACpBS,KACAqpD,GAAiB,EAEjBC,EAAYliC,EAAKnS,cAAcj8B,KAAKshC,MAAMivC,cAAchqD,EAAW+f,cACnEkqC,EAAWpiC,EAAKnS,cAAcj8B,KAAKshC,MAAMivC,cAAchqD,EAAWgd,oBAClEktC,EAAcriC,EAAKnS,cAAcj8B,KAAKshC,MAAMivC,cAAchqD,EAAWw4B,YACtE3Q,GAAK7nB,WAAWwpB,aAAa9U,UAAUmT,EAAK7nB,WAAWwpB,aAAa9U,SAAU,EAAMo1C,GAAiB,EAExG,IAAMK,GAActiC,EAAKnS,cAAcj8B,KAAKlR,IAAI69C,OAChDpmB,GAAW+f,aAAayoC,UAAY,SACpC2B,EAAY5hF,IAAIy3B,EAAW+f,cACvB/f,EAAWgd,oBAAsBhd,EAAWgd,mBAAmBtI,SAC/D1U,EAAWgd,mBAAmBtI,SAAU,EACxCy1C,EAAY5hF,IAAIy3B,EAAWgd,qBAE3BitC,KAEJE,EAAY5hF,IAAIy3B,EAAWw4B,aAM3B3Q,EAAK7nB,WAAW+f,aAAaqqC,aAAc,CAC3C,IAAIC,GAAaxiC,EAAKnS,cAAcj8B,KAAKlR,IAAI+9C,SAAS,EAAE,EACxD+jC,GAAW9jC,UAAU,GACrB8jC,EAAW7jC,SAAS,EAAE,EAAEqB,EAAKnS,cAAcj8B,KAAKshC,MAAMhvC,MAAM87C,EAAKnS,cAAcj8B,KAAKshC,MAAM7uC,QAC1Fm+E,EAAW5jC,UACX0jC,EAAY5hF,IAAI8hF,GAChBF,EAAY33B,KAAO63B,CAEnB,IAAMC,GAAQH,EAAYrxE,EACpByxE,EAAQJ,EAAYpwE,EACpBywE,EAAQL,EAAYp+E,MACpB0+E,EAAQN,EAAYj+E,MAmB1B,OAlBAi+E,GAAYrxE,EAAI+uC,EAAKnS,cAAcj8B,KAAKshC,MAAM2vC,QAC9CP,EAAYpwE,EAAI8tC,EAAKnS,cAAcj8B,KAAKshC,MAAM4vC,QAC9CR,EAAYp+E,MAAQ,EACpBo+E,EAAYj+E,OAAS,EACrB27C,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAW6U,WACzDpU,EAASnX,KAAKu+B,EAAKoxB,eAAekR,GAAcrxE,EAAEwxE,EAAMvwE,EAAEwwE,EAAMx+E,MAAMy+E,EAAMt+E,OAAOu+E,GAAQp0E,EAAU,MAAM,EAAMC,EAAO,GAAG,GAAOrH,KAAK,WACnIk7E,EAAYrxE,EAAIwxE,EAChBH,EAAYpwE,EAAIwwE,EAChBF,GAAcA,EAAW3nE,UACtBqnE,QAAkBliC,EAAKnS,cAAcj8B,KAAKshC,MAAMusC,WAAWtnD,EAAW+f,aAAagqC,GACnFE,QAAiBpiC,EAAKnS,cAAcj8B,KAAKshC,MAAMusC,WAAWtnD,EAAWgd,mBAAmBitC,GACxFC,QAAoBriC,EAAKnS,cAAcj8B,KAAKshC,MAAMusC,WAAWtnD,EAAWw4B,YAAY0xB,GACpFJ,IACCjiC,EAAK7nB,WAAWwpB,aAAa9U,SAAU,GAE3Cy1C,EAAYznE,UACZmlC,EAAK7nB,WAAW+f,aAAaqqC,aAAc,KAExCziF,QAAQm5B,IAAIL,IAI1BmqD,EAAa,SAAAC,GAClB,GAAMpqD,KAoCN,OAnCAoqD,GAAWznE,QAAQ,SAAA0nE,GAClB,GAAMx0E,GAAQuxC,EAAK7nB,WAAWkO,UAAY,EAAI48C,EAAUx0E,MAClDD,EAAWy0E,EAAUz0E,SAAY,EAAKwxC,EAAK7nB,WAAWkO,UAAY,IAAM48C,EAAUz0E,SAAY,CAC7E,aAAnBy0E,EAAU/jF,MACb05B,EAASnX,KAAKs/D,EAAavyE,EAAUC,EAAOw0E,EAAU1gF,QAEhC,UAAnB0gF,EAAU/jF,MACPsP,GAAYA,EAAW,GACPoqB,EAASnX,KAAK4+D,EAAW4C,EAAUx4C,MAA0B,EAAlBw4C,EAAUx4C,MAAY,GAAIj8B,EAAUC,IAG/E,WAAnBw0E,EAAU/jF,MACb05B,EAASnX,KAAKy/D,EAAO1yE,EAAUC,GAAOrH,KAAK,WAAA,MAAM44C,GAAK7nB,WAAW06B,OAAOxqD,EAAS,WAChF23C,EAAK7nB,WAAWo4B,cAAgBvQ,EAAK7nB,WAAWo4B,aAAa11C,UAC7DmlC,EAAK7nB,WAAWo4B,aAAe,KAC/BvQ,EAAK7nB,WAAWo4B,aAAevQ,EAAK7nB,WAAW+f,kBAG3B,YAAnB+qC,EAAU/jF,MAEM05B,EAASnX,KAAK0/D,EAAQ3yE,EAAUC,IAEd,gBAAnBw0E,EAAU/jF,MAET05B,EAASnX,KAAK6/D,EAAY9yE,EAAUC,IAElB,eAAnBw0E,EAAU/jF,MAET05B,EAASnX,KAAKogE,EAAWrzE,EAAUC,IAEjB,WAAnBw0E,EAAU/jF,MAET05B,EAASnX,KAAKugE,EAAOxzE,EAAUC,MAG5C3O,QAAQm5B,IAAIL,IAIdg7C,EAAiB,SAACx/B,GAAe,GAC/Buc,GAAe3Q,EAAK7nB,WAApBw4B,WAEP3Q,GAAK4zB,gBAHiC,IAAAsP,GAIaljC,EAAK7nB,WAAW6V,UAAUC,SAASpK,KAAK2L,OAApFC,EAJ+ByzC,EAI/BzzC,gBAAiBH,EAJc4zC,EAId5zC,eAAgB5tC,EAJFwhF,EAIExhF,QAClCmyE,EAAYljB,EAAYnS,UAAU,aAClC2kC,EAAmBxyB,EAAYnS,UAAU,oBACzC4kC,EAAgBzyB,EAAYnS,UAAU,iBACtCs1B,EAAkBnjB,EAAYnS,UAAU,kBAoB9C,IAnBAyhC,EAAWtvB,EAAYnS,UAAU,qBACjC0hC,EAAavvB,EAAYnS,UAAU,uBAE/Bq1B,IACHA,EAAUhnC,SAAWuH,EAAWqsC,SAASznC,QAEtCmqC,IACHA,EAAiBt2C,SAAWuH,EAAW/X,OAAO2c,QAE3C86B,IACHA,EAAgBjnC,SAAWuH,EAAWivC,YAAYrqC,QAEnDoqC,EAAcv2C,SAAWuH,EAAW/X,OAAO2c,OAC3CinC,EAASpzC,SAAWuH,EAAWivC,YAAYrqC,OAE3CgH,EAAK7nB,WAAWw4B,YAAY1/C,EAAImjC,EAAWqsC,SAASxvE,EACpD+uC,EAAK7nB,WAAWw4B,YAAYz+C,EAAIkiC,EAAWqsC,SAASvuE,EACpD8tC,EAAK7nB,WAAWw4B,YAAYpqB,MAAQ/mC,SAAc40C,EAAWqsC,SAASv8B,QAAU,EAAI9P,EAAWqsC,SAASv8B,QAEpGlE,EAAKnS,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAc63B,EAAW/X,OAAOz3B,KAAM,CAAA,GAAA0+E,GAC1C7zC,EAAgBpT,OAA7CprB,EADuEqyE,EACvEryE,EAAGiB,EADoEoxE,EACpEpxE,EAAGhO,EADiEo/E,EACjEp/E,MAAOG,EAD0Di/E,EAC1Dj/E,OAAQk/E,EADkDD,EAClDC,IAC1BtyE,IAAQw+B,EAAgBid,KAAKz7C,EAC7BiB,GAAQu9B,EAAgBid,KAAKx6C,EAE7BkxE,EAAcv8B,YAAYzS,EAAW/X,OAAOz3B,IAI7B,IAAM2N,GAAQnN,KAAK2mB,IAAI7nB,EAAQk/E,EAAc7wE,MAAMtB,EAAImyE,EAAcl/E,MAAOG,EAAS++E,EAAc7wE,MAAML,EAAIkxE,EAAc/+E,OAC3HH,GAAQk/E,EAAcl/E,MAAQk/E,EAAc7wE,MAAMtB,EAAIsB,EACtDlO,EAAS++E,EAAc/+E,OAAS++E,EAAc7wE,MAAML,EAAIK,EACxDtB,EAAIw+B,EAAgBpT,OAAOprB,EAAIw+B,EAAgBid,KAAKz7C,GAAKw+B,EAAgBpT,OAAOn4B,MAAQA,GAAS,EACjGgO,EAAIu9B,EAAgBpT,OAAOnqB,EAAIu9B,EAAgBid,KAAKx6C,GAAKu9B,EAAgBpT,OAAOh4B,OAASA,GAAU,EACnG++E,EAAcnyE,EAAIA,EAClBmyE,EAAclxE,EAAIA,EAClBkxE,EAAcl/E,MAAQA,EACtBk/E,EAAc/+E,OAASA,EAEtC++E,EAAcz4B,MAAQy4B,EAAcz4B,KAAK9vC,SACzC,IAAM8vC,GAAO3K,EAAKnS,cAAcj8B,KAAKlR,IAAI+9C,SAAS,EAAG,EAErD,QADAkM,EAAKjM,YACG6kC,GACP,IAAK,SACJ54B,EAAKhM,SAAS1tC,EAAGiB,EAAGhO,EAAOG,EAC3B,MACD,KAAK,UACJ,GAAMm/E,GAAO,GAAIlpE,QAAOmpE,OACxBD,GAAKxoB,OAAO,GAAI1gD,QAAOopE,MAAMx/E,EAAQ,EAAI+M,EAAGiB,GAC3C,GAAIoI,QAAOopE,MAAMx/E,EAAQ,EAAIG,EAAS,EAAIe,KAAK6xD,IAAI,EAAG,IAAShmD,EAAG5M,EAAS,EAAI6N,GAC/E,GAAIoI,QAAOopE,MAAMx/E,EAAQ,EAAIG,EAAS,EAAIe,KAAK6xD,IAAI,EAAG,IAAShmD,EAAG5M,EAAS,EAAI,EAAI6N,GACnF,GAAIoI,QAAOopE,MAAMx/E,EAAQ,EAAI+M,EAAG5M,EAAS6N,GACzC,GAAIoI,QAAOopE,MAAMx/E,EAAQ,EAAIG,EAAS,EAAIe,KAAK6xD,IAAI,EAAG,IAAShmD,EAAG5M,EAAS,EAAI,EAAI6N,GACnF,GAAIoI,QAAOopE,MAAMx/E,EAAQ,EAAIG,EAAS,EAAIe,KAAK6xD,IAAI,EAAG,IAAShmD,EAAG5M,EAAS,EAAI6N,KAChFy4C,EAAKg5B,YAAYH,EAAKI,OACtB,MACD,KAAK,QACJj5B,EAAKo1B,OAAO77E,EAAQ,EAAI+M,EAAG/M,EAAQ,EAAIgO,GACvCy4C,EAAKk5B,cAAsB,EAAR3/E,EAAY,EAAI+M,GAAI/M,EAAQ,EAAIgO,EAAW,EAARhO,EAAY,EAAI+M,EAAG/M,EAAQ,EAAIgO,EAAGhO,EAAQ,EAAI+M,EAAG/M,EAAQgO,GAC/Gy4C,EAAKk5B,eAAe3/E,EAAQ,EAAI+M,EAAG/M,EAAQ,EAAIgO,EAAGhO,EAAQ,EAAI+M,GAAI/M,EAAQ,EAAIgO,EAAGhO,EAAQ,EAAI+M,EAAG/M,EAAQ,EAAIgO,EAC5G,MACD,KAAK,QACL,QACCy4C,EAAKm5B,WAAW7yE,EAAI/M,EAAQ,EAAGgO,EAAI7N,EAAS,EAAGH,GAEjDymD,EAAK/L,UACLoB,EAAK7nB,WAAWw4B,YAAYjwD,IAAIiqD,GAChCy4B,EAAcz4B,KAAOA,EA3EgB,GAAAo5B,GA8Ee3vC,EAAWivC,YAAzD93B,EA9E+Bw4B,EA8E/Bx4B,UAAWhpD,EA9EoBwhF,EA8EpBxhF,MAAOs/D,EA9EakiB,EA8EbliB,KAAMt+D,EA9EOwgF,EA8EPxgF,WAAYy1C,EA9EL+qC,EA8EK/qC,OACrCgrC,EAAa10C,EAAetwC,MAAMkR,IACxCq7C,KAAcy4B,EAAW9gF,SAAWqoD,GACpChpD,IAAUyhF,EAAWzhF,MAAQA,GACpB/C,SAATqiE,IAAuBmiB,EAAWxmB,WAAaqE,EAAO,OAAS,UACnDt+D,EAAaygF,EAAWzgF,WAAaA,EAAay8C,EAAK7nB,WAAW6V,UAAUpqC,KAAOogF,EAAWzgF,WAAay8C,EAAK7nB,WAAW6V,UAAUpqC,KAAKL,WAAa,GACxJ/D,SAAXw5C,IAAyBgrC,EAAWhrC,OAASA,EAE7C,IAAIulB,GAAK,EACT,IAAI3vB,EAAAA,WAAUrrC,WAAY,CACtB,GAAIgmD,GAAS02B,EAAS9wC,SAAS,GAC3B4X,EAAUc,EAAWqC,WAAW9V,EAAWivC,YAAYpkF,KAAMoJ,IAC1C,YAAV9F,GAAiC,SAAVA,KAAsByhF,EAAWzhF,MAAQ,WAC7DgnD,IACAA,EAAOC,QAAQ3uC,UACf0uC,EAAO1uC,WAEX0uC,EAASvJ,EAAK7nB,WAAWixB,eACzB62B,EAAS7zB,SAAS7C,GAClBA,EAAOC,QAAQE,QAAQ3C,EAAUA,EAAU,KAAK,EAAM,EAAG,EAAG,QAAQ,GACpEwC,EAAO4C,KAAO3/C,SAASw3E,EAAWzhF,MAAMoS,QAAQ,IAAK,MACrD,IAAMsyC,GAAKjH,EAAK7nB,WAAW6V,UAAUpqC,KAAKI,KAAOg8C,EAAK7nB,WAAW+uB,sBAAsB88B,EAAW9gF,UAAY8gF,EAAW9gF,SACnHikD,EAAKnH,EAAK7nB,WAAW6V,UAAUpqC,KAAKI,KAAOg8C,EAAK7nB,WAAWivB,qBAAqB48B,EAAW9gF,UAAY8gF,EAAW9gF,QACpIqmD,GAAOrlD,MAAQijD,EAAKoC,EAAOC,QAAQt5C,KAAK3Q,OACxCgqD,EAAOllD,OAAS4iD,CAEJ,IAAMg9B,GAAS30C,EAAeod,KAAKz7C,EAAIq+B,EAAetwC,MAAM0tD,KAAKz7C,GAAKq+B,EAAetwC,MAAM0tD,KAAKxoD,MAAQqlD,EAAOrlD,OAAS,EAClHggF,EAAS50C,EAAeod,KAAKx6C,EAAIo9B,EAAetwC,MAAM0tD,KAAKx6C,CACjE+tE,GAASlhC,cAAcklC,EAAQC,EAAQ50C,EAAetwC,MAAM0tD,KAAKxoD,MAAOorC,EAAetwC,MAAM0tD,KAAKroD,QAClG47E,EAAS/vE,KAAO,QAEf,CACDquD,GAAMylB,EAAWxmB,WAAawmB,EAAWxmB,WAAa,IAAM,UAC5De,GAAMylB,EAAW9gF,SAAWsJ,SAASw3E,EAAW9gF,UAAY,MAAQ,GACpEq7D,GAAMylB,EAAWzgF,WAAaygF,EAAWzgF,WAAa,GAEtD08E,EAASkE,UACLvgF,KAAM26D,EACN1rD,KAAMmxE,EAAWzhF,MACjBs8C,aAAc,SACdC,aAAc,WAElBmhC,EAAS/vE,KAAO23C,EAAWqC,WAAW9V,EAAWivC,YAAYpkF,KAAMoJ,EAEnE,IAAM47E,GAAS30C,EAAeod,KAAKz7C,EAAIq+B,EAAetwC,MAAM0tD,KAAKz7C,EAC3DizE,EAAS50C,EAAeod,KAAKx6C,EAAIo9B,EAAetwC,MAAM0tD,KAAKx6C,CACjE+tE,GAASlhC,cAAcklC,EACjBC,GAAUjE,EAAS57E,OAASmI,SAASw3E,EAAW9gF,UAAY,KAAO,EACnEosC,EAAetwC,MAAM0tD,KAAKxoD,MAC1BorC,EAAetwC,MAAM0tD,KAAKroD,QAGpCk6D,EAAKnqB,EAAWqsC,SAASl1B,UAAY,GAC7CgT,EAAGjmD,QAAQ,MAAQ,IACtBimD,GAAU,MAEKnqB,EAAWqsC,SAAS5e,QAAS,IAC7BtD,EAAK,QAAUA,GAE/BA,EAAKA,EAAK,KAAOve,EAAK7nB,WAAW6V,UAAUpqC,KAAOo8C,EAAK7nB,WAAW6V,UAAUpqC,KAAKL,WAAa6wC,EAAWqsC,SAASl9E,WAAa6wC,EAAWqsC,SAASl9E,WAAa,IAChK28E,EAAWp/E,MAAM8C,KAAO26D,EACxB2hB,EAAWp/E,MAAM+R,KAAOuhC,EAAWqsC,SAASl+E,MAC5C29E,EAAWhwE,KAAO,GAClBgwE,EAAWjpC,IAAMv1C,EAAQgrD,KAAKx6C,EAC9BguE,EAAWtV,YAAc5qB,EAAK7nB,WAAW46B,aAAa3e,EAAWqsC,SAASl1B,WAE1E20B,EAAWv1B,MAAQu1B,EAAWv1B,KAAK9vC,SACnC,IAAM8vC,GAAO3K,EAAKnS,cAAcj8B,KAAKlR,IAAI+9C,SAAS,EAAG,EAYrD,OAXAkM,GAAKjM,YACLiM,EAAKhM,SAASj9C,EAAQgrD,KAAKz7C,EAC1BvP,EAAQgrD,KAAKx6C,EACbxQ,EAAQgrD,KAAKxoD,MACEkwC,EAAWqsC,SAASznC,OAASgH,EAAKnS,cAAcj8B,KAAKshC,MAAM7uC,OAAS3C,EAAQgrD,KAAKroD,QACjGsmD,EAAK/L,UACLoB,EAAK7nB,WAAWw4B,YAAYjwD,IAAIiqD,GAChCu1B,EAAWv1B,KAAOA,EACHvW,GAAcA,EAAWqsC,UAAYrsC,EAAWqsC,SAASuC,YAAc5uC,EAAWqsC,SAASuC,WAAWzjF,OAAS,IAC9GygD,EAAK7nB,WAAWw4B,YAAY9jB,SAAU,GAE/C/sC,QAAQC,WAIVqkF,EAAgB,WACrB,GAAI5yD,GAASgD,EAAK8I,UAIlB,IAHI4T,IACY1f,EAAS0f,EAAS1f,QAEa,mBAA3CnW,OAAOb,UAAU7R,SAASumB,KAAKsC,GAClC,IAAK,GAAItqB,KAAQsqB,GACZA,EAAOtqB,GACe,YAArBsqB,EAAOtqB,GAAMtC,IAChBo7C,EAAK7nB,WAAWw7B,iBAAiBzsD,EAAMsqB,EAAOtqB,GAAMuG,SAE5CuyC,EAAKnS,cAAcj8B,KAAKpC,KAAKkI,MAAM2E,cAAcmV,EAAOtqB,GAAMtC,MACvC,QAAU3D,UAAU+L,QAAU/L,UAAUstB,aAAe,WACtFyxB,EAAK7nB,WAAWm4B,UAAUppD,EAAMsqB,EAAOtqB,GAAMtC,KAAI,GACjDo7C,EAAK7nB,WAAWu7B,UAAUxsD,EAAMsqB,EAAOtqB,GAAMtC,IAAK4sB,EAAOtqB,GAAMuG,OAA8B,IAAtB+jB,EAAOtqB,GAAMojB,OAIrF01B,EAAK7nB,WAAWm4B,UAAUppD,QAIpB84C,EAAKnS,cAAcj8B,KAAKpC,KAAKkI,MAAM2E,cAAcmY,EAAK8I,WAAW14B,MACnD,QAAU3D,UAAU+L,QAAU/L,UAAUstB,aAAe,UAC7EyxB,EAAK7nB,WAAWu7B,UAAU,EAAGl/B,EAAK8I,WAAW14B,IAAK4vB,EAAK8I,WAAW7vB,QAAQ,IAKtE+lD,EAAY,SAACjiC,GAClB,GAAKA,EAAM3sB,KAAqB,KAAd2sB,EAAM3sB,KAGnB,GAAkB,YAAd2sB,EAAM3sB,IACdo7C,EAAK7nB,WAAWs7B,iBAAiBliC,EAAM9jB,YAEnC,IAAIuyC,EAAKnS,cAAcj8B,KAAKpC,KAAKkI,MAAM2E,cAAckV,EAAM3sB,MACzC,QAAU3D,UAAU+L,QAAU/L,UAAUstB,aAAe,QAAS,CACnF,GAAI9gB,GAAS8jB,EAAM9jB,MACQjO,UAAxB+xB,EAAMtjB,eAA+BsjB,EAAMtjB,qBAAuBR,EAAS8jB,EAAMtjB,eACvF+xC,EAAK7nB,WAAWk4B,UAAU9+B,EAAM3sB,KAAI,GACpCo7C,EAAK7nB,WAAWq7B,UAAUjiC,EAAM3sB,IAAK6I,EAAuB,IAAf8jB,EAAMjH,MAAW,QAV9D01B,GAAK7nB,WAAWk4B,aAeZg0B,EAAgB,SAACC,GAOV,GALZlH,EAAWp9B,EAAKnS,cAAcj8B,KAAKlR,IAAI+9C,SAAS,EAAG,EAAG6lC,GACtDlH,EAAS1+B,UAAU,EAAK,GACxB0+B,EAASz+B,SAAS,EAAG,EAAGqB,EAAKnS,cAAcj8B,KAAKshC,MAAMhvC,MAAO87C,EAAKnS,cAAcj8B,KAAKshC,MAAM7uC,QAC3F+4E,EAASx+B,WAEOpqB,EAAKS,SAAT,CAEI+qB,EAAK7nB,WAAWu/B,WAAa1X,EAAK7nB,WAAWu/B,UAAU7qB,UACtDrY,EAAKwuD,WAAW1pD,OAAO,SAAArpB,GAAA,MAAgB,WAAXA,EAAE/Q,OAAmBK,SAAWygD,EAAK7nB,WAAWu/B,UAAU7qB,SAAU,EAGjH,IAAM03C,GAAoC,YAAxB/vD,EAAKpyB,WAAWwC,IAC9B4/E,EAAWD,EAAYvkC,EAAK7nB,WAAWurB,iBAAmBlvB,EAAKpyB,WAAW8hD,QAC9DugC,EAAUF,EAAYvkC,EAAK7nB,WAAWyrB,cAAgBpvB,EAAKpyB,WAAWs/D,KAClFnE,EAASgnB,EAAYvkC,EAAK7nB,WAAWqrB,aAAehvB,EAAKpyB,WAAWwC,KACvE2/E,GAAa3hF,EAAA8tB,iBAAiB6iC,gBAAiBr0D,KAAM,aAAc0N,IAAK2wD,IACvDA,IACFvd,EAAK7nB,WAAWuS,aAAesV,EAAK7nB,WAAWqrB,aAC/CxD,EAAK7nB,WAAWqrB,aAAe+Z,EAC/Bvd,EAAK7nB,WAAWurB,iBAAmB8gC,EACnCxkC,EAAK7nB,WAAWyrB,cAAgB6gC,GAG5CzkC,EAAKnS,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAcghD,KACxC6f,EAAS72C,MAAQ,EACd62C,EAAWkH,EAAUnqB,OAAO3lC,EAAKpyB,WAAW6O,EAAGujB,EAAKpyB,WAAW8P,EAAGqrD,GACjF6f,EAAS72C,MAAqB/mC,SAAbglF,EAAyB,EAAIA,EAC9CxkC,EAAKmzB,eAAeiK,EAAUqH,GACfzkC,EAAKnS,cAAcstB,gBAAgBiiB,EAAU7f,MAKxDmnB,EAAgB,SAAC9mD,EAAYO,EAAO0lB,GAKzC,IAAA,GALqDpR,MAAAtpB,OAAAC,EAKhCwU,GALgCxU,EAKjB+U,IAApCwmD,EAAA,EAAAA,EAAAlyC,EAAAlzC,OAAAolF,IAA4C,CAAvC,GAAIz9E,GAAAA,EAAAA,GACFq4E,EAAKv/B,EAAKnS,cAAckyB,kBAAkB74D,EAAK+J,EAAG/J,EAAKgL,EAAGhL,EAAKhD,MAAOgD,EAAK7C,OAAQ6C,EAAKtC,IAAKo7C,EAAK7nB,WAAWgd,mBAAoBjuC,EAAK5D,MAC5Ii8E,GAAGh5C,MAAyB/mC,SAAjB0H,EAAKg9C,QAAwB,EAAIh9C,EAAKg9C,QACjDq7B,EAAGhqC,MAAkC,MAA1B/oC,SAAStF,EAAKs9C,QAAkB,MAAQt9C,EAAKs9C,QAAU,EAClE+6B,EAAGtgF,KAAK+jF,WAAa97E,EAAK87E,WAC1BzD,EAAG17B,QAAUA,EACb7D,EAAKnS,cAAcstB,gBAAgBokB,EAAIr4E,EAAKtC,KAExCsC,EAAKy9C,UACR46B,EAAGhqC,OAASgqC,EAAGhqC,MACfgqC,EAAGhtE,MAAMtB,GAAKsuE,EAAGhtE,MAAMtB,EACvBsuE,EAAG56B,SAAU,GAEVz9C,EAAK09C,UACR26B,EAAGhqC,OAASgqC,EAAGhqC,MACfgqC,EAAGhtE,MAAML,GAAKqtE,EAAGhtE,MAAML,EACvBqtE,EAAG36B,SAAU,GAGf5E,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWgd,oBACtD6K,EAAK7nB,WAAWw4B,YAAY9jB,UAAYmT,EAAK7nB,WAAWw4B,YAAY6tB,UACvDx+B,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWw4B,aAG1D3Q,EAAK7nB,WAAWwpB,aAAa9U,SAASmT,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWwpB,cAC/F3B,EAAK7nB,WAAW6U,UAAUH,WAAY,GAASmT,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAW6U,YAGlH43C,EAAiB,WACtB,GAAMhsD,MADsB4D,GAAA,EAAAC,GAAA,EAAAC,EAAAl9B,MAAA,KAE5B,IAAA,GAAAm9B,GAAAC,EAAiBojB,EAAK7nB,WAAWgd,mBAAmBhG,SAApDtS,OAAAC,cAAAN,GAAAG,EAAAC,EAAAG,QAAAC,MAAAR,GAAA,EAA8D,CAAA,GAArDt1B,GAAqDy1B,EAAAje,MAAA6e,GAAA,EAAAC,GAAA,EAAAC,EAAAj+B,MAAA,KAC7D,IAAA,GAAAk+B,GAAAC,EAAcz2B,EAAKjI,KAAK+jF,WAAxBnmD,OAAAC,cAAAS,GAAAG,EAAAC,EAAAZ,QAAAC,MAAAO,GAAA,EAAoC,CAAA,GAA3BttB,GAA2BytB,EAAAhf,KACnC,KAAmB,OAAdzO,EAAE40E,SAAkC,cAAd50E,EAAE40E,WAA6B7kC,EAAK7nB,WAAWkO,UACzE,GAAe,WAAXp2B,EAAE/Q,KACL05B,EAASnX,KAAKu+B,EAAK09B,iBAAiBx2E,GAAOq/B,MAAO,GAC/Ct2B,EAAEzB,SACF,MAAM,EACNyB,EAAExB,MAAO,GAAG,QAEX,IAAe,aAAXwB,EAAE/Q,KAAqB,CAC/B,GAAI+R,GAAI/J,EAAKy9C,QAAU10C,EAAEgB,EAAI/J,EAAKhD,MAAM,EAAI+L,EAAEgB,EAAI/J,EAAKhD,MAAM,EACzDgO,EAAIhL,EAAK09C,QAAU30C,EAAEiC,EAAIhL,EAAK7C,OAAO,EAAI4L,EAAEiC,EAAIhL,EAAK7C,OAAO,CAC/Du0B,GAASnX,KAAKu+B,EAAK09B,iBAAiBx2E,GAAO+J,EAAGA,EAAGiB,EAAGA,GACjDjC,EAAEzB,SACF,MAAM,EACNyB,EAAExB,MAAO,GAAG,MAf2C,MAAAsb,GAAAyT,GAAA,EAAAC,EAAA1T,EAAA,QAAA,KAAAwT,GAAAI,EAAAA,WAAAA,EAAAA,YAAA,QAAA,GAAAH,EAAA,KAAAC,MAFlC,MAAA1T,GAAA0S,GAAA,EAAAC,EAAA3S,EAAA,QAAA,KAAAyS,GAAAI,EAAAA,WAAAA,EAAAA,YAAA,QAAA,GAAAH,EAAA,KAAAC,IAsB5B,MAAO58B,SAAQm5B,IAAIL,IAIdksD,EAAa,SAACC,EAAYjuD,GAC/B,GAAIwb,IAAY,CAEJ,OAAO,IAAIxyC,SAAQ,SAACC,EAASC,GACxC,GAAIw0B,EAAK8C,MAAQ9C,EAAKpV,MAAQoV,EAAK+C,OAClC,MAAOx3B,IAASb,KAAM,GAGvB,IAAMgvD,IAAgBp3B,OAAyBrG,UAAU,SAAAmE,GAAA,MAAUizB,GAAWC,SAASlzB,EAAOu5B,WAAY9lD,KACpG+lD,EAAUF,EAAe,EAAI,KAAOp3B,EAAkBo3B,EAC5D,IAAIE,EACH,MAAOruD,IAASb,KAAM,EAAGoE,MAAM4qD,GAKhC,KAAK,GAFD82B,MACEC,KAZ6C3kD,EAAA,SAa1C37B,GAb0C,GAAAugF,GAcnBllC,EAAK7nB,WAAW6V,UAAUC,SAASpK,KAAKjP,OAAhE83B,EAd2Cw4B,EAc3Cx4B,KAAMzvB,EAdqCioD,EAcrCjoD,OAAQC,EAd6BgoD,EAc7BhoD,OAChBjsB,EAAuBy7C,EAAvBz7C,EAAGiB,EAAoBw6C,EAApBx6C,EAAGhO,EAAiBwoD,EAAjBxoD,MAAOG,EAAUqoD,EAAVroD,OACd8gF,EAAgBloD,EAAO76B,WAAWwC,IAClCwgF,EAAgBloD,EAAO96B,WAAWwC,IAClCygF,EAAiB,KAlB6BC,EAmBnBP,EAAWpgF,GAAnCf,EAnB2C0hF,EAmB3C1hF,KAAM8yD,EAnBqC4uB,EAmBrC5uB,MAAOv5B,EAnB8BmoD,EAmB9BnoD,OAEI39B,UAApBulF,EAAWpgF,GAAGsM,IACjBA,EAAI8zE,EAAWpgF,GAAGsM,GAEKzR,SAApBulF,EAAWpgF,GAAGuN,IACjBA,EAAI6yE,EAAWpgF,GAAGuN,GAES1S,SAAxBulF,EAAWpgF,GAAGT,OAAuB6gF,EAAWpgF,GAAG6W,eAAe,gBACrEtX,EAAQ6gF,EAAWpgF,GAAGT,OAEM1E,SAAzBulF,EAAWpgF,GAAGN,QAAwB0gF,EAAWpgF,GAAG6W,eAAe,gBACtEnX,EAAS0gF,EAAWpgF,GAAGN,QAEpB0gF,EAAWpgF,GAAGvC,YACd49C,EAAKnS,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAcwoE,EAAWpgF,GAAGvC,WAAW66B,OAAOr4B,OACpFugF,EAAgBJ,EAAWpgF,GAAGvC,WAAW66B,OAAOr4B,KAE7CmgF,EAAWpgF,GAAGvC,YACd49C,EAAKnS,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAcwoE,EAAWpgF,GAAGvC,WAAW86B,OAAOt4B,OACpFwgF,EAAgBL,EAAWpgF,GAAGvC,WAAW86B,OAAOt4B,KAG7CmgF,EAAWpgF,GAAGvC,YAAc2iF,EAAWpgF,GAAGvC,WAAW+6B,SACrD6iB,EAAKnS,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAcwoE,EAAWpgF,GAAGvC,WAAW+6B,QAAQv4B,OACrFygF,EAAiBN,EAAWpgF,GAAGvC,WAAW+6B,QAAQv4B,IAEnD,IAAMy8D,GAAe,SAACp1D,EAAK+xD,GAAY,GAAAlgC,IAAA,EAAAC,GAAA,EAAAC,EAAAx+B,MAAA,KACtC,IAAA,GAAAy+B,GAAAC,EAAc8mD,EAAdnoD,OAAAC,cAAAgB,GAAAG,EAAAC,EAAAnB,QAAAC,MAAAc,GAAA,EAA4B,CAAA,GAAnB/I,GAAmBkJ,EAAAvf,KAC3BqW,GAAEvzB,SAFmC,MAAAuoB,GAAAgU,GAAA,EAAAC,EAAAjU,EAAA,QAAA,KAAA+T,GAAAI,EAAAA,WAAAA,EAAAA,YAAA,QAAA,GAAAH,EAAA,KAAAC,IAIlCggC,EAAQsD,cAAgBhnD,OAAOinD,YAAYC,QAA6B,IAAnBxD,EAAQC,SAG7DhyD,EAAI+jB,QAAQ6E,MAAMt1B,OAAS,GAC9BQ,GAASb,KAAM,EAAGoE,MAAOqB,IACDq7C,EAAK7nB,WAAWs3B,YAAY50C,YAGpD9a,GAASb,KAAM,IACS8gD,EAAK7nB,WAAWs3B,YAAY50C,WAErDlV,EAAAA,WAAMkqB,WAAWpO,KAAKsjE,EAAWpgF,GAAG8E,QAG/BszD,GACLx5D,WAAYK,EAAKq5B,OAAO15B,WAAaK,EAAKq5B,OAAO15B,WAAay8C,EAAK7nB,WAAW6V,UAAUpqC,KAAOo8C,EAAK7nB,WAAW6V,UAAUpqC,KAAKL,WAAa,GACzIL,SAAUU,EAAKq5B,OAAOsuB,UACtBiS,WAAY55D,EAAKq5B,OAAO4kC,KAAO,OAAS,SACxCt/D,MAAOqB,EAAKq5B,OAAO16B,MACnBy2C,OAAQp1C,EAAKq5B,OAAO+b,QAGjBusC,GACLhiF,WAAYK,EAAKu5B,QAAQ55B,WAAaK,EAAKu5B,QAAQ55B,WAAay8C,EAAK7nB,WAAW6V,UAAUpqC,KAAOo8C,EAAK7nB,WAAW6V,UAAUpqC,KAAKL,WAAa,GAC3IL,SAAUU,EAAKu5B,QAAQouB,UACvBiS,WAAY55D,EAAKu5B,QAAQ0kC,KAAO,OAAS,SACzCt/D,MAAOqB,EAAKu5B,QAAQ56B,MACpBy2C,OAAQp1C,EAAKu5B,QAAQ6b,QAGlBjkB,IACNA,GAAEkI,OAAS8/B,EACXhoC,EAAEmI,OAAS6/B,EACXhoC,EAAE7kB,KAAO60E,EAAWpgF,GAAG7G,IACvB,IAAI0nF,GAAAA,MACAT,GAAWpgF,GAAG4S,OAASyoC,EAAKnS,cAAcj8B,KAAKpC,KAAKkI,MAAM2E,cAAc0oE,EAAWpgF,GAAG4S,MAAM3S,OAC/F4gF,EAAWxlC,EAAKnS,cAAcj8B,KAAKlR,IAAI6W,MAAMwtE,EAAWpgF,GAAG4S,MAAM3S,IAAKmgF,EAAWpgF,GAAG4S,MAAM9J,QAAQ,GAEnG,IAAMg4E,GAAOzlC,EAAKnS,cAAc4uB,UAAUxrD,EACzCiB,EACAhO,EACAG,EACA8gF,EACAC,EACA/jB,EACAtsC,EACAywD,EACA,SACqBxlC,EAAK7nB,WAAWs3B,aAEhCztD,EAAMyjF,EAAKjnC,UAAU,UACrBoL,EAAS67B,EAAKjnC,UAAU,OAQ9B,IAPAx8C,EAAIguB,SAAW6E,MAAOkwD,EAAWpgF,GAAGkwB,MAAQkwD,EAAWpgF,GAAGkwB,MAAQkwD,EAAWpgF,GAAGswB,SAAUl3B,QAAS83B,SAAU7F,EAAS8F,OAAQovB,IAE1H/nB,IACHn7B,EAAIizC,cAAe,EACnBwwC,EAAKroB,iBAAiBioB,GAAkBF,EAAeI,IAGpD7uB,EAAO,CACP1W,EAAK7nB,WAAWyS,cAAe,CAClC,IAAMgsB,GAAY,WACjB,MAAO,IAAI92D,SAAQ,SAACC,EAASC,GACD,GAAIsqB,GAAOu9B,EAAW69B,oBAAoBhvB,EAAOruD,EAC5E,KAAK08E,EAAWpgF,GAAGghF,YACY/7B,EAAO15C,KAAO60E,EAAWpgF,GAAG7G,MAAd,IAAyBwsB,EAAzB,KACVskB,EAAAA,WAAUrrC,YAAY,CACtB,GAAM05D,GAAYrT,EAAOza,SAAS,EAClC,IAAI8tB,EAAW,CACX,GAAMhW,GAAKjH,EAAK7nB,WAAW6V,UAAUpqC,KAAKI,KAAOg8C,EAAK7nB,WAAW+uB,sBAAsB6V,EAAS75D,UAAY65D,EAAS75D,SAC/GikD,EAAKnH,EAAK7nB,WAAW6V,UAAUpqC,KAAKI,KAAOg8C,EAAK7nB,WAAWivB,qBAAqB2V,EAAS75D,UAAY65D,EAAS75D,SAC9G6W,EAAIotC,EAAKyC,EAAO15C,KAAK3Q,OACrB0R,GAAK/M,EAAQ6V,GAAK,EAClB7H,GAAK7N,EAAS4iD,GAAM,CAC1BjH,GAAK7nB,WAAWkvB,mBAAmBpoD,KAAM2qD,EAAO15C,OAAQi3C,EAAIF,EAAI2C,EAAQvhD,GACxEuhD,EAAOza,SAAS,GAAGl+B,EAAIA,EACvB24C,EAAOza,SAAS,GAAGj9B,EAAIA,EACvB+qD,EAAU9tB,SAAS5zB,QAAQ,SAAArU,GAAA,MAAQA,GAAKsiD,QAAQ3uC,YAChDoiD,EAAUpiD,UACV+uC,EAAO15C,KAAO,KAM1B,GAAM01E,GAAc5lC,EAAKnS,cAAcj8B,KAAK0Y,KAAK0kB,OAAOthC,KAAK4M,OAAOurE,MAAMC,OAAQ,WAE9E,GADAx7D,KACKy6D,EAAWpgF,GAAGghF,YACf/7B,EAAO15C,KAAO60E,EAAWpgF,GAAG7G,MAAd,IAAyBwsB,EAAzB,KACVskB,EAAAA,WAAUrrC,YAAY,CACtB,GAAM05D,GAAYrT,EAAOza,SAAS,EAClC,IAAI8tB,EAAW,CACX,GAAMhW,GAAKjH,EAAK7nB,WAAW6V,UAAUpqC,KAAKI,KAAOg8C,EAAK7nB,WAAW+uB,sBAAsB6V,EAAS75D,UAAY65D,EAAS75D,SAC/GikD,EAAKnH,EAAK7nB,WAAW6V,UAAUpqC,KAAKI,KAAOg8C,EAAK7nB,WAAWivB,qBAAqB2V,EAAS75D,UAAY65D,EAAS75D,SAC9G6W,EAAIotC,EAAKyC,EAAO15C,KAAK3Q,OACrB0R,GAAK/M,EAAQ6V,GAAK,EAClB7H,GAAK7N,EAAS4iD,GAAM,CAC1BjH,GAAK7nB,WAAWkvB,mBAAmBpoD,KAAM2qD,EAAO15C,OAAQi3C,EAAIF,EAAI2C,EAAQvhD,GACxEuhD,EAAOza,SAAS,GAAGl+B,EAAIA,EACvB24C,EAAOza,SAAS,GAAGj9B,EAAIA,EACvB+qD,EAAU9tB,SAAS5zB,QAAQ,SAAArU,GAAA,MAAQA,GAAKsiD,QAAQ3uC,YAChDoiD,EAAUpiD,UACV+uC,EAAO15C,KAAO,KAI1B,GAAIoa,GAAQ,EAAG,CAEX,GADAs/B,EAAO15C,KAAO60E,EAAWpgF,GAAG7G,KACxB8wC,EAAAA,WAAUrrC,WAAY,CACtB,GAAM05D,GAAYrT,EAAOza,SAAS,EAClC,IAAI8tB,EAAW,CACX,GAAMhW,GAAKjH,EAAK7nB,WAAW6V,UAAUpqC,KAAKI,KAAOg8C,EAAK7nB,WAAW+uB,sBAAsB6V,EAAS75D,UAAY65D,EAAS75D,SAC/GikD,EAAKnH,EAAK7nB,WAAW6V,UAAUpqC,KAAKI,KAAOg8C,EAAK7nB,WAAWivB,qBAAqB2V,EAAS75D,UAAY65D,EAAS75D,SAC9G6W,EAAIotC,EAAKyC,EAAO15C,KAAK3Q,OACrB0R,GAAK/M,EAAQ6V,GAAK,EAClB7H,GAAK7N,EAAS4iD,GAAM,CAC1BjH,GAAK7nB,WAAWkvB,mBAAmBpoD,KAAM2qD,EAAO15C,OAAQi3C,EAAIF,EAAI2C,EAAQvhD,GACxEuhD,EAAOza,SAAS,GAAGl+B,EAAIA,EACvB24C,EAAOza,SAAS,GAAGj9B,EAAIA,EACvB+qD,EAAU9tB,SAAS5zB,QAAQ,SAAArU,GAAA,MAAQA,GAAKsiD,QAAQ3uC,YAChDoiD,EAAUpiD,UACV+uC,EAAO15C,KAAO,KAGtB8vC,EAAKnS,cAAcj8B,KAAK0Y,KAAK0kB,OAAOjyB,OAAO6oE,GACvC,YAAclvB,EAAMx3D,MAChB8C,EAAI+jF,QACJ/jF,EAAIizC,cAAe,EACnBwwC,EAAKroB,iBAAiBioB,GAAkBF,EAAeI,IAE3DxlF,GAAQ,KAEJiC,EAAI+jF,QACJ/jF,EAAIizC,cAAe,EACnBjzC,EAAIg4D,MAAM6E,eAAgB,EAC1B4mB,EAAKroB,iBAAiB+nB,EAAepoB,IAEzCh9D,GAAQ,OAIzCyB,EAAQ,WACiBw+C,EAAKnS,cAAcj8B,KAAK0Y,KAAK0kB,OAAOjyB,OAAO6oE,GACzE7lF,GAAQ,GAEkBilF,GAAavjE,MAAMjgB,MAAAA,IACnBw+C,EAAKnS,cAAcj8B,KAAK0Y,KAAK0kB,OAAOzV,UAG5C0rD,GAAkBxjE,KAAKm1C,SAEvBquB,GAAkBxjE,KAAK3hB,QAAQC,SAASo9B,GAE9DmV,IAAY,GA9LJ3tC,EAAI,EAAGA,EAAIogF,EAAWxlF,OAAQoF,IAAK27B,EAAnC37B,EAgMJ2tC,KACJvyC,GAASb,KAAM,IACG8gD,EAAK7nB,WAAWs3B,YAAY50C,WAEhC/a,QAAQm5B,IAAIgsD,GAAmB79E,KAAK,SAAA4+E,GAChChmC,EAAK7nB,WAAWyS,cAAe,EAC1Bo7C,EAAQ72E,KAAK,SAAAiE,GAAA,QAAOA,KACxBrT,GAASb,KAAM,SAO/B+mF,EAAa,SAAC/mF,GACnB8gD,EAAK7nB,WAAWwpB,aAAa9U,SAAU,CAEvC,KAAK,GAAItnC,GAAE,EAAGA,EAAEy6C,EAAK7nB,WAAWwpB,aAAaxS,SAAS5vC,OAAQgG,IAAK,CAAA,GAAA2gF,GAC1ClmC,EAAK7nB,WAAWwpB,aAAaxS,SAAS5pC,GAAvDsnC,EAD2Dq5C,EAC3Dr5C,QAAS/uC,EADkDooF,EAClDpoF,IACZ+uC,IAAW/uC,IAASoB,GACL8gD,EAAK7nB,WAAWwpB,aAAaxS,SAAS5pC,GAAGsV,UACzCtV,KAGAy6C,EAAK7nB,WAAWwpB,aAAaxS,SAAS5pC,GAAGsnC,SAAU,EAI1D,UAAT3tC,EACG+B,UAAUC,SACG8+C,EAAKnS,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAnC,IAAqD5W,EAAAA,WAAMs2B,4BAA3D,IAA0Ft2B,EAAAA,WAAMu2B,uBAAuB,QAAvH,oBAAoJ8jB,EAAK+0B,gBAEzJ/0B,EAAK+0B,gBAGP,UAAT71E,EACO8gD,EAAKnS,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAnC,IAAqD5W,EAAAA,WAAMs2B,4BAA3D,IAA0Ft2B,EAAAA,WAAMu2B,uBAAuB,QAAvH,sBAAsJ8jB,EAAK40B,gBAEzJ,UAAT11E,EACO8gD,EAAKnS,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAnC,IAAqD5W,EAAAA,WAAMs2B,4BAA3D,IAA0Ft2B,EAAAA,WAAMu2B,uBAAuB,QAAvH,qBAAqJ8jB,EAAKy0B,gBAE5I,gBAATv1E,EACL8gD,EAAKnS,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAnC,IAAqD5W,EAAAA,WAAMs2B,4BAA3D,IAA0Ft2B,EAAAA,WAAMu2B,uBAAuB,eAAvH,sBAA6J8jB,EAAKo1B,yBAEpJ,iBAATl2E,EACL8gD,EAAKnS,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAnC,IAAqD5W,EAAAA,WAAMs2B,4BAA3D,IAA0Ft2B,EAAAA,WAAMu2B,uBAAuB,gBAAvH,sBAA8J8jB,EAAKu1B,wBAErJ,kBAATr2E,EACL8gD,EAAKnS,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAnC,IAAqD5W,EAAAA,WAAMs2B,4BAA3D,IAA0Ft2B,EAAAA,WAAMu2B,uBAAuB,WAAvH,uBAA0J8jB,EAAK01B,mBAEjJ,cAATx2E,GACL8gD,EAAKnS,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAnC,IAAqD5W,EAAAA,WAAMs2B,4BAA3D,IAA0Ft2B,EAAAA,WAAMu2B,uBAAuB,aAAvH,wBAA6J8jB,EAAK61B,qBAElL71B,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWwpB,eAIpDwkC,EAAe,SAACl2B,EAAO/e,EAAU2S,GAC1B,GAAI3S,EAAU,CAGzB,IAAK,GADc6C,MACVpvC,EAAE,EAAGA,EAAEq7C,EAAK7nB,WAAWkQ,UAAU9oC,OAAQoF,IACjD,GAAkD,aAA9Cq7C,EAAK7nB,WAAWkQ,UAAU1jC,GAAGs8C,aAA6B,CAC1D,GAAMmlC,GAAQ,SAACv4E,GACX,IAAK,GAAIlJ,GAAG,EAAEA,EAAIsrD,EAAM1wD,OAAOoF,IAC3B,GAAGkJ,EAAE/P,OAASmyD,EAAMtrD,GAAGw8C,IACnB,OAAO,CAGG,QAAO,EAEPilC,GAAMpmC,EAAK7nB,WAAWkQ,UAAU1jC,KAAKovC,EAAItyB,KAAKu+B,EAAK7nB,WAAWkQ,UAAU1jC,IAGpF,IAAI,GAAI6M,GAAE,EAAEA,EAAGuiC,EAAIx0C,OAAOiS,IAAK,CAC3B,GAAIlO,GAAQ08C,EAAK7nB,WAAWkQ,UAAU/vB,QAAQy7B,EAAIviC,GAClDwuC,GAAK7nB,WAAWkQ,UAAUprB,OAAO3Z,EAAM,GAO3C,MAJA+iF,GAAarmC,EAAK7nB,WAAWkQ,WAAU,GACvC2X,EAAK7nB,WAAWqR,cAAcvsB,OAAO,GACrC+iC,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWi4B,qBACzDpQ,EAAK7nB,WAAWi4B,eAAevjB,SAAU,GAIzD,IAAK,GAAI16B,KAAK89C,GAAO,CACpBjQ,EAAKmnB,gBAAgBlX,EAAM99C,GAAGgvC,IAAK8O,EAAM99C,GAAG68B,OAAQgR,EAAK7nB,WAAWoQ,aACpE,IAAI+9C,GAAQtmC,EAAKqnB,QAAQrnB,EAAK7nB,WAAWi4B,eAAgBH,EAAM99C,GAAGgvC,IAAK8O,EAAM99C,GAAG0uC,aAAcoP,EAAM99C,GAAGlB,EAAGg/C,EAAM99C,GAAGD,EAAG+9C,EAAM99C,GAAG68B,OAC/H,KAAKs3C,EACJ,MAEGr2B,GAAM99C,GAAGI,QACZ+zE,EAAM/zE,MAAM8Q,IAAI4sC,EAAM99C,GAAGI,MAAO09C,EAAM99C,GAAGI,OACzC+zE,EAAMr1E,GAAK42C,EAAWC,SAASmI,EAAM99C,GAAGlB,EAAG5I,IAAY,EAAI4nD,EAAM99C,GAAGI,OACpE+zE,EAAMp0E,GAAK21C,EAAWC,SAASmI,EAAM99C,GAAGD,EAAG7J,IAAY,EAAI4nD,EAAM99C,GAAGI,OACpEytC,EAAK22B,eAAe2P,EAAOr2B,EAAM99C,GAAGI,QAErC+zE,EAAMrlC,aAAe4C,EAAUA,EAAU,WAC1B7D,EAAK7nB,WAAWkQ,UAAU5mB,KAAK6kE,GAGnCtmC,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWi4B,gBACzDpQ,EAAKwnB,kBACjBxnB,EAAK86B,qBACO96B,EAAK7nB,WAAWi4B,eAAevjB,SAAU,GAIhD05C,EAAkB,SAACC,EAAUhlC,GACtB,GAAIk1B,KAChB,KAAK,GAAIvkE,KAAKqvC,GACb,IAAK,GAAIpvC,KAAK4tC,GAAK7nB,WAAW6V,UAAUiiB,MACvC,GAAIzO,EAAgBrvC,KAAO6tC,EAAK7nB,WAAW6V,UAAUiiB,MAAM79C,GAAGyuC,aAAc,CAC3E61B,EAAc12B,EAAK7nB,WAAW6V,UAAUiiB,MAAM79C,GAAG+uC,KAAQnB,EAAK7nB,WAAW6V,UAAUiiB,MAAM79C,GAAG+uC,GAC5F,OAIS,GAAIqlC,GAAYxmC,EAAK7nB,WAAWirB,YAAa,CAUzC,IAAI,GATbgjC,GAAO,SAACltC,GACV,IAAI,GAAIv0C,GAAG,EAAEA,EAAGq7C,EAAK7nB,WAAW6V,UAAUiiB,MAAM1wD,OAAOoF,IACnD,GAAGu0C,IAAO8G,EAAK7nB,WAAW6V,UAAUiiB,MAAMtrD,GAAGk8C,aACzC,OAAO,CAGf,QAAO,GAEQ9M,KACIpvC,EAAI,EAAEA,EAAIq7C,EAAK7nB,WAAWirB,YAAY7jD,OAAOoF,IAC5DyhF,EAAMpmC,EAAK7nB,WAAWirB,YAAYz+C,GAAGk8C,eACtB9M,EAAItyB,KAAKu+B,EAAK7nB,WAAWirB,YAAYz+C,GAG7C,KAAI,GAAI6M,GAAE,EAAEA,EAAGuiC,EAAIx0C,OAAOiS,IACtB,GAAGuiC,EAAIviC,GAAGwgC,YAAa,EAAK,CACxB,GAAI1uC,GAAQ08C,EAAK7nB,WAAWirB,YAAY9qC,QAAQy7B,EAAIviC,GACpDwuC,GAAK7nB,WAAWirB,YAAYnmC,OAAO3Z,EAAM,GAGjD+iF,EAAarmC,EAAK7nB,WAAWirB,aAAY,EAEzC,KAAK,GAAIjxC,KAAK6tC,GAAK7nB,WAAWirB,YAC7BpD,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWirB,YAAYjxC,IAC9DukE,EAAc12B,EAAK7nB,WAAWirB,YAAYjxC,GAAGrU,QAC7CkiD,EAAK7nB,WAAWirB,YAAYjxC,GAAG06B,SAAU,EACzCmT,EAAK4vB,cAAc5vB,EAAK7nB,WAAWirB,YAAYjxC,IAAI,QAK3D6tC,GAAKy2B,cAAcC,EAEvB12B,GAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAW6U,YAIhEq5C,EAAe,SAACI,GAAgC,GAAnB1P,GAAmBz3E,UAAAC,OAAA,GAAAC,SAAAF,UAAA,IAAAA,UAAA,EACrD0gD,GAAK7nB,WAAWsR,cAChB,IAAMi9C,GAAgB,QAAhBA,GAAiBlmC,GACtB,IAAK,GAAI77C,GAAE,EAAGA,EAAE67C,EAAMjhD,OAAQoF,IAAK,CAClC,GAAMuC,GAAOs5C,EAAM77C,EACfuC,GAAK85C,eACRhB,EAAK7nB,WAAWsR,YAAYuW,EAAK7nB,WAAWsR,YAAYlqC,SAAWzB,KAAMoJ,EAAKpJ,KAAMC,OAAQmJ,EAAKnJ,OAAQijD,aAAa95C,EAAK85C,eAE1G0lC,EAAcx/E,EAAKioC,YAGjCw3C,EAAoB,SAACnmC,GAE1B,IAAK,GAAI77C,GAAE,EAAGA,EAAE67C,EAAMjhD,OAAQoF,IAAK,CAClC,GAAI67C,EAAM77C,GAAGm8C,WAEZ,MAED,KAAK,GAAItvC,GAAE,EAAGA,EAAEgjB,EAAKy7B,MAAM1wD,OAAQiS,IAClC,GAAIgjB,EAAKy7B,MAAMz+C,GAAG2vC,MAAQX,EAAM77C,GAAG7G,KAAM,CACxC0iD,EAAM77C,GAAGm8C,WAAatsB,EAAKy7B,MAAMz+C,GAAGw9B,OAAO7lB,QAC3C,SAKJu9D,GAAcD,IACbjyD,EAAKS,UAAY0xD,EAAkBF,EACpC,KAAK,GA5BgDnlD,GAAA,SAAAslD,GA6BpD,GAAM1/E,GAAOu/E,EAAa9hF,GACpB5G,EAAyB,YAAhBmJ,EAAKnJ,OAAuB,KAAOiiD,EAAKnS,cAAcj8B,KAAKshC,MAAMsL,UAAUt3C,EAAKnJ,QAC1E4mC,EAAOqb,EAAKqnB,QAAQtpE,EAAQmJ,EAAKpJ,KAAMoJ,EAAK25C,aAAc35C,EAAKy5C,MAAOz5C,EAAK05C,MAAO15C,EAAK45C,YAAW,EAAMi2B,GAExG8P,EAAgB,SAACC,EAAUC,GAa7B,IAAI,GAXEnuD,MACAouD,EAAc,SAACn5E,EAAE3G,GAEnB,IAAI,GADA6sC,GAAM7sC,EAAKioC,SAAWjoC,EAAKioC,SAAShmB,YAChCxkB,EAAI,EAAEA,EAAIovC,EAAIx0C,OAAOoF,IACzB,GAAGovC,EAAIpvC,IAAOkJ,EAAE/P,OAASi2C,EAAIpvC,GAAG7G,MAAQ+P,EAAEgzC,eAAiB9M,EAAIpvC,GAAGk8C,aAC9D,OAAO,CAGf,QAAO,GAEPomC,EAAYF,EAAW53C,SAAW43C,EAAW53C,SAAShmB,YAClD3X,EAAE,EAAEA,EAAIy1E,EAAU1nF,OAAOiS,IACzBw1E,EAAYC,EAAUz1E,GAAGs1E,IAEzBluD,EAASnX,KAAKu+B,EAAK2vB,YAAYsX,EAAUz1E,GAAG1T,MAGpD,OAAOgC,SAAQm5B,IAAIL,IAEjBsuD,EAAgB,QAAhBA,GAAiBJ,EAAUC,GAC7BF,EAAcC,EAAUC,GAAY3/E,KAAK,WACrC,KAAG0/E,GAAYA,EAAS33C,SAAS5vC,QAAU,GAuB3C,IAAK,GApBD0nF,GAAYF,EAAW53C,SAAW43C,EAAW53C,SAAShmB,YACpDg+D,EAAY,SAACt5E,EAAEkmC,GACjB,IAAI,GAAIpvC,GAAI,EAAEA,EAAIovC,EAAIx0C,OAAOoF,IACzB,GAAIkJ,EAAE/P,MAAQi2C,EAAIpvC,GAAG7G,MAAQ+P,EAAE/P,OAASi2C,EAAIpvC,GAAG7G,MAAU+P,EAAEgzC,cAAgB9M,EAAIpvC,GAAGk8C,cAAgBhzC,EAAEgzC,eAAiB9M,EAAIpvC,GAAGk8C,aACxH,MAAO9M,GAAIpvC,EAGnB,QAAO,GAGLyiF,EAAa,SAACC,GAChB,GAAI5mC,GAAUT,EAAKqnB,QAAQ0f,EAAYM,EAAGvpF,KAAMupF,EAAGxmC,aAC7CwmC,EAAG1mC,MAAO0mC,EAAGzmC,MAAOymC,EAAGvmC,YAAW,EAAMi2B,EAC1CgQ,GAAWpmC,OAASomC,EAAWnmC,OAASH,IACxCA,EAAQxvC,GAAK+uC,EAAK7nB,WAAW0vB,WAAWC,SAASi/B,EAAWpmC,MAAOX,EAAK7nB,WAAW9vB,SACnFo4C,EAAQvuC,GAAK8tC,EAAK7nB,WAAW0vB,WAAWC,SAASi/B,EAAWnmC,MAAOZ,EAAK7nB,WAAW9vB,UAEvFo4C,GAAWymC,EAAcG,EAAI5mC,IAGxB97C,EAAE,EAAGA,EAAEmiF,EAAS33C,SAAS5vC,OAAQoF,IAAK,CAC3C,GAAI+oB,GAAKo5D,EAAS33C,SAASxqC,GACvBwqB,EAASg4D,EAAUL,EAAS33C,SAASxqC,GAAGsiF,EACzC93D,MAAW,EACVi4D,EAAW15D,GAGXw5D,EAAcx5D,EAAIyB,MAMjD,OAAKwV,IAILuiD,EAAchgF,EAAMy9B,GACLA,EAAKpyB,MAAM8Q,IAAInc,EAAKqL,MAAMtB,EAAG/J,EAAKqL,MAAML,GACxCyyB,EAAK1zB,EAAI/J,EAAK+J,EACd0zB,EAAKzyB,EAAIhL,EAAKgL,EACd8tC,EAAK22B,eAAehyC,EAAMz9B,EAAKqL,MAAMtB,GAErC0zB,EAAKkI,QAAU3lC,EAAK2lC,QACpB45C,EAAa9hF,GAAKggC,EAC7B5mC,EACHA,EAAO2C,IAAIikC,GAGXA,EAAKqN,UAAW,OAhFTrtC,EA5B4CiiF,KA6FjCH,EAAaxpE,OAAOtY,IAAK,GACzB,aAlEXA,EAAE,EAAGA,EAAE8hF,EAAalnF,OAAQoF,IAAK,CAAA28B,EAAjC38B,GAmFTq7C,EAAK42B,qBAIA0Q,EAAU,WACf,GAAI9yD,EAAKjD,MAAM0xD,YAA4C,kBAA9BzuD,EAAKjD,MAAM0xD,UAAU/jF,MAA0D,WAA9Bs1B,EAAKjD,MAAM0xD,UAAU/jF,MACnG,CACgB,GAAI8gD,EAAK7nB,WAAW+N,SAMhB,MAL0C,KAAvC8Z,EAAK7nB,WAAW+N,SAASl4B,YACxBgyC,EAAK7nB,WAAW+N,SAASl4B,UAAYgyC,EAAK7nB,WAAW+N,SAASz4B,OAC9DuyC,EAAK7nB,WAAW+N,SAASj4B,cAAgB+xC,EAAK7nB,WAAW+N,SAASz4B,QAEtEuyC,EAAK7nB,WAAW+N,SAASz4B,OAASuyC,EAAK7nB,WAAW+N,SAASl4B,UAAYrI,EAAAA,WAAMyqB,YACtE4vB,EAAK09B,iBAAiB19B,EAAK7nB,WAAW+N,UAAWz4B,OAAO,GAAIuyC,EAAK7nB,WAAWkO,UAAY,GAAK,IAAM,MAAM,EAAM,EAAG,GAAG,EAE3H,IAAI,QAAUplC,UAAU+L,QAAU,SAAW/L,UAAUstB,YAC3D,MAAOmD,GAAAA,WAAW61D,eAAe,EAAGvnC,EAAK7nB,WAAWkO,UAAY,GAAK,IAAM,GAG5F,MAAOvmC,SAAQC,WAIVynF,EAAW,SAACl4B,GACd,GAAI96B,EAAKjD,MAAM0xD,YAA4C,kBAA9BzuD,EAAKjD,MAAM0xD,UAAU/jF,MAA0D,YAA9Bs1B,EAAKjD,MAAM0xD,UAAU/jF,MAC1F,CACI,GAAI8gD,EAAK7nB,WAAW+N,SAChB,MAAO,IAAIpmC,SAAQ,SAACC,EAASC,GACzB,GAAMy1C,GAAQuK,EAAKnS,cAAcj8B,KAAKlR,IAAI+0C,MAAMuK,EAAK7nB,WAAW+N,UAAUu3C,IAAIhwE,OAAO,GAAIuyC,EAAK7nB,WAAWkO,UAAY,GAAK,IAAM,MAAM,EAAM,EAAG,GAAG,EAClJoP,GAAMngC,WAAW5U,IAAI,WACjBs/C,EAAK7nB,WAAW+N,SAASz4B,QAAU9H,EAAAA,WAAMyqB,YACzCrwB,EAAQuvD,MAIf,IAAI,QAAUruD,UAAU+L,QAAU,SAAW/L,UAAUstB,YACxD,MAAOmD,GAAAA,WAAW+1D,aAAa,EAAGznC,EAAK7nB,WAAWkO,UAAY,GAAK,IAAM,GAI7F,MAAOvmC,SAAQC,QAAQuvD,IAGlBo4B,EAAW,SAAC1E,GAEjB,GADYhjC,EAAK7nB,WAAWw4B,YAAY9jB,SAAU,GAC7Cm2C,EAAWzjF,OACf,MAAOO,SAAQC,SAEhB,IAAM4nF,GAAK3E,EAAW1pD,OAAO,SAAArpB,GAAA,MAAgB,WAAXA,EAAE/Q,OAC9B0oF,EAAO5E,EAAW1pD,OAAO,SAAArpB,GAAA,MAAgB,aAAXA,EAAE/Q,OAEhCgiF,EAAS,WACd,GAAIyG,EAAGpoF,OACN,MAAOygD,GAAK09B,iBAAiB19B,EAAK7nB,WAAWw4B,aAAcpqB,MAAM,GAAIohD,EAAG,GAAGn5E,SAAU,MAAM,EAAMm5E,EAAG,GAAGl5E,MAAO,GAAG,IAG7Go5E,EAAW,WAChB,GAAID,EAAKroF,OACR,MAAOygD,GAAK09B,iBAAiB19B,EAAK7nB,WAAWw4B,aAAc1/C,EAAE22E,EAAK,GAAG32E,EAAGiB,EAAE01E,EAAK,GAAG11E,GAAI01E,EAAK,GAAGp5E,SAAU,MAAM,EAAMo5E,EAAK,GAAGn5E,MAAO,GAAG,GAIxI,OAAO3O,SAAQm5B,KAAKioD,IAAU2G,OAGzBC,EAAY,SAAC9E,GAClB,IAAKA,EAAWzjF,OACf,MAAOO,SAAQC,SAEhB,IAAMgoF,GAAM/E,EAAW1pD,OAAO,SAAArpB,GAAA,MAAgB,YAAXA,EAAE/Q,OAC/B8oF,EAAKhF,EAAW1pD,OAAO,SAAArpB,GAAA,MAAgB,WAAXA,EAAE/Q,OAE9B+oF,EAAU,WACf,GAAIF,EAAIxoF,OACP,MAAOygD,GAAKoxB,eAAepxB,EAAK7nB,WAAWw4B,aAAcpqB,MAAM,GAAIwhD,EAAI,GAAGv5E,SAAU,MAAM,EAAMu5E,EAAI,GAAGt5E,MAAO,GAAG,IAG7GsxE,EAAS,WACd,GAAIiI,EAAGzoF,OACN,MAAOygD,GAAKoxB,eAAepxB,EAAK7nB,WAAWw4B,aAAc1/C,EAAE+2E,EAAG,GAAG/2E,EAAGiB,EAAE81E,EAAG,GAAG91E,GAAI81E,EAAG,GAAGx5E,SAAU,MAAM,EAAMw5E,EAAG,GAAGv5E,MAAO,GAAG,GAI9H,OAAO3O,SAAQm5B,KAAKgvD,IAAWlI,OAG1BmI,EAAY,WACjB,MAAOloC,GAAK7nB,WAAW06B,OAAOxqD,EAAS,WAAA,MAAM06E,GAAWvuD,EAAKwuD,WAAW1pD,OAAO,SAAArpB,GAAA,MAAmB,OAAdA,EAAE40E,aACpFz9E,KAAK,WAGL,MAFkB44C,GAAK7nB,WAAWgd,qBAAuB6K,EAAK7nB,WAAWgd,mBAAmBtI,SAAU,GACpFmT,EAAK7nB,WAAWi4B,eAAevjB,SAAU,EACpDmT,EAAK7nB,WAAW06B,OAAOxqD,EAAS,WAAA,MAAMvI,SAAQm5B,KAAK2rD,IAAkB7B,EAAWvuD,EAAKwuD,WAAW1pD,OAAO,SAAArpB,GAAA,MAAmB,cAAdA,EAAE40E,WAA0B6C,EAASlzD,EAAKisD,SAASuC,WAAW1pD,OAAO,SAAArpB,GAAA,MAAmB,cAAdA,EAAE40E,iBAE/Lz9E,KAAK,WAAA,MAAM44C,GAAK7nB,WAAW06B,OAAOxqD,EAAS,WAAA,MAAM06E,GAAWvuD,EAAKwuD,WAAW1pD,OAAO,SAAArpB,GAAA,MAAmB,iBAAdA,EAAE40E,gBAGvFsD,EAAa,SAAA74B,GAClB,GAAM12B,MADsByF,GAAA,EAAAC,GAAA,EAAAC,EAAA/+B,MAAA,KAE5B,IAAA,GAAAg/B,GAAAC,EAAiBuhB,EAAK7nB,WAAWgd,mBAAmBhG,SAApDtS,OAAAC,cAAAuB,GAAAG,EAAAC,EAAA1B,QAAAC,MAAAqB,GAAA,EAA8D,CAAA,GAArDn3B,GAAqDs3B,EAAA9f,MAAA0pE,GAAA,EAAAC,GAAA,EAAAC,EAAA9oF,MAAA,KAC7D,IAAA,GAAA+oF,GAAAC,EAActhF,EAAKjI,KAAK+jF,WAAxBnmD,OAAAC,cAAAsrD,GAAAG,EAAAC,EAAAzrD,QAAAC,MAAAorD,GAAA,EAAoC,CAAA,GAA3Bn4E,GAA2Bs4E,EAAA7pE,KACnC,KAAmB,QAAdzO,EAAE40E,SAAmC,eAAd50E,EAAE40E,WAA8B7kC,EAAK7nB,WAAWkO,UAC3E,GAAe,YAAXp2B,EAAE/Q,KACL05B,EAASnX,KAAKu+B,EAAKoxB,eAAelqE,GAAOq/B,MAAO,GAC7Ct2B,EAAEzB,SACF,MAAM,EACNyB,EAAExB,MAAO,GAAG,QAEX,IAAe,WAAXwB,EAAE/Q,KAAmB,CAC1B,GAAIupF,GAAQvhF,EAAKqL,MAAMtB,EAAI,GAAK/J,EAAKhD,MAAM,EAAIgD,EAAKhD,MAAM,EACtDwkF,EAAQxhF,EAAKqL,MAAML,EAAI,GAAKhL,EAAK7C,OAAO,EAAI6C,EAAK7C,OAAO,CAC/Du0B,GAASnX,KAAKu+B,EAAKoxB,eAAelqE,GAAO+J,EAAGhB,EAAEgB,EAAIw3E,EAAOv2E,EAAGjC,EAAEiC,EAAIw2E,GAC/Dz4E,EAAEzB,SACF,MAAM,EACNyB,EAAExB,MAAO,GAAG,MAf2C,MAAAsb,GAAAs+D,GAAA,EAAAC,EAAAv+D,EAAA,QAAA,KAAAq+D,GAAAI,EAAAA,WAAAA,EAAAA,YAAA,QAAA,GAAAH,EAAA,KAAAC,MAFlC,MAAAv+D,GAAAuU,GAAA,EAAAC,EAAAxU,EAAA,QAAA,KAAAsU,GAAAI,EAAAA,WAAAA,EAAAA,YAAA,QAAA,GAAAH,EAAA,KAAAC,IAsB5B,MAAOyhB,GAAK7nB,WAAW06B,OAAOxqD,EAAS,WAAA,MAAMvI,SAAQm5B,IAAIL,MAGpD+vD,EAAgB,QAAhBA,GAAgBl8E,GACrB,GAAI,OAASA,EAAO,GAAI,CACvB,GAAIqK,GAAQ,qBAAqBw/C,KAAK7pD,EACtC,IAAIqK,EACH,MAAOnR,GAAAA,WAAM8E,QAAQu1C,EAAK7nB,WAAWkO,UAAY,EAAIvvB,EAAM,IACzD1P,KAAK,WAAA,MAAMuhF,GAAcl8E,EAAO8H,MAAMuC,EAAM,GAAGvX,OAAS,MAG5D,MAAIygD,GAAK7nB,WAAWoT,UACZ5lC,EAAAA,WAAM8E,QAAQ,KACnBrD,KAAK,WAAA,MAAMuhF,GAAcl8E,KAErB3M,QAAQC,QAAQ0M,IAGlBm8E,EAAwB,SAACp+B,EAAcq+B,GAAW,GAChDnnF,GAAWs+C,EAAK7nB,WAAW6V,UAAUC,SAASpK,KAAK2L,OAAnD9tC,QACDonF,EAAYt+B,EAAexK,EAAKnS,cAAcj8B,KAAKshC,MAAM7uC,OAAS3C,EAAQgrD,KAAKroD,OAC/EkB,EAAIsjF,EAASC,CACfvjF,GAAI,IACP26E,EAAWjpC,KAAO1xC,EAAI7D,EAAQgrD,KAAKx6C,IAI/B62E,EAAiB,QAAjBA,IAAkBC,EAASv8E,EAAQpE,EAAS4gF,EAAOz+B,GAC5C,GAAI5b,EAAAA,WAAUrrC,WAAY,CACtB,GAAM2lF,GAAWF,EACbG,EAAQ,CAEZ,IADAH,EAAQr0E,QAAQ,QAAS,SAAShD,EAAGhN,GAAIwkF,MACrCD,EAAS3pF,QAAU2pF,EAAS3pF,OAAS4pF,EAAQ,EAAG,CAChD,GAAM7lF,GAAQ4lF,EAAS3pF,OAAS4pF,EAAQ,EAClCx+B,EAAOu1B,EAAW/wC,SAAS,GAC3Byc,EAAUs0B,EAAWt0B,OACvBA,GAAQtoD,KACRqnD,EAAK15C,EAAI26C,EAAQtoD,GAAO2N,EAAI26C,EAAQtoD,GAAO/B,MAC3CopD,EAAKz4C,EAAI05C,EAAQtoD,GAAO4O,EACxB02E,EAAsBp+B,EAAcoB,EAAQtoD,GAAOyoD,cACnDm0B,EAAWx2B,QAAQ,KAAK,SAI/B,CACD,GAAMw/B,GAAWlpC,EAAKnS,cAAcj8B,KAAK8H,OAAOs5C,QAAUg2B,EAAUA,EAAQr0E,QAAQ,GAAIN,QAAO,IAAK,MAAO,KAC3G6rE,GAAWx2B,QAAQw/B,GAAU,GAC7BN,EAAsBp+B,EAAc01B,EAAW77E,QAE/D,MAAOskF,GAAcl8E,GACnBrF,KAAK,SAACqF,GACN,MAAOuzC,GAAK7nB,WAAW06B,OAAOxqD,EAAS,WAAA,MAAM1C,GAAAA,WAAM8E,QAAQw+E,GAAO7hF,KAAK,WACtE,MAAI+4E,GACIrgF,QAAQE,SAEXyM,EAGEuzC,EAAK7nB,WAAW06B,OAAOxqD,EAAS,WAAA,MAAM0gF,IAAeC,GAAWv8E,EAAO,GAAKA,EAAO,GAAK,IAAKA,EAAO8H,MAAM,GAAIlM,EAAS4gF,EAAOz+B,KAF7H1qD,QAAQC,iBAOdqpF,EAAU,SAACC,EAAWC,GACf,GAAIrqF,GAAO,EACX,IAAI4oD,EAAWn2C,QAAQ23E,EAAUpqF,MAAO,CACpC,IAAK,GAAI0F,GAAE,EAAGA,EAAE0kF,EAAUpqF,KAAKM,OAAQoF,IACnC1F,GAAQ4oD,EAAWqC,WAAWm/B,EAAUpqF,KAAK0F,GAAG1F,KAAMoJ,EAG1D23C,GAAK7nB,WAAWwxB,uBAAuB0/B,EAAUpqF,KAAMihF,EAAY73E,OAGnEpJ,GAAO4oD,EAAWqC,WAAWm/B,EAAUpqF,KAAMoJ,EAKjD,IAHIpJ,EAAKM,QAAkC,OAAxBN,EAAKA,EAAKM,OAAO,KAChCN,EAAOA,EAAKyV,UAAU,EAAGzV,EAAKM,OAAO,IAErCqvC,EAAAA,WAAUrrC,WAAY,CACtB,GAAM0jD,GAAKjH,EAAK7nB,WAAW6V,UAAUpqC,KAAKI,KAAOg8C,EAAK7nB,WAAW+uB,sBAAsBmiC,EAAU99B,WAAa89B,EAAU99B,UAClHpE,EAAKnH,EAAK7nB,WAAW6V,UAAUpqC,KAAKI,KAAOg8C,EAAK7nB,WAAWivB,qBAAqBiiC,EAAU99B,WAAa89B,EAAU99B,SACvHvL,GAAK7nB,WAAWkvB,iBAAiBgiC,EAAUpqF,KAAMkoD,EAAIF,EAAIi5B,EAAY73E,GAAS,EAAMghF,EAAUrwC,QAElG,GAAIswC,GAAiBD,EAAUE,UAAW,CACtC,GAAI36C,EAAAA,WAAUrrC,WACV28E,EAAW/wC,SAAS,KAAO+wC,EAAW/wC,SAAS,GAAGj9B,EAAIguE,EAAW3zB,YACjE2zB,EAAWhwE,KAAO,IAClB04E,EAAsBS,EAAUrwC,OAAQknC,EAAW3zB,gBAElD,CACD,GAAIrqD,GAAM2lD,EAAWoC,cAAchrD,EACnCihF,GAAWhwE,KAAO8vC,EAAKnS,cAAcj8B,KAAK8H,OAAOs5C,QAAU9wD,EAAMA,EAAIyS,QAAQ,GAAIN,QAAO,IAAK,MAAO,MAExG,MAAOvU,SAAQC,UAGnBogF,GAAY,CACZ,IAAMqJ,GAAa,GAAI1pF,SAAQ,SAACC,EAASC,GACrCggD,EAAK7nB,WAAW+f,aAAaC,iBAAiBz3C,IAAI,SAACmiC,EAAQm7B,GACxC,SAAXn7B,GAAqBm7B,EAAQsD,cAAgBhnD,OAAOinD,YAAYC,QAA6B,IAAnBxD,EAAQC,QAGtFl+D,QAGF0pF,EAAW,GAAI3pF,SAAQ,SAACC,EAASC,GACnCggD,EAAK7nB,WAAWy/B,UAAUyX,OAAO3uE,IAAI,WAAOX,OAEhD,OAAOigD,GAAK7nB,WAAW06B,OAAOxqD,EAAS,WAAA,MAAMvI,SAAQ4pF,MAAMX,EAAe,GAAI9pF,EAAMoJ,EAAS23C,EAAK7nB,WAAWkO,UAAY,EAAI75B,SAAS68E,EAAUJ,OAAQI,EAAUrwC,QAASwwC,EAAYC,MAClLriF,KAAK,WAIF,GAHA+4E,GAAY,EACZngC,EAAK7nB,WAAW+f,aAAaC,iBAAiByQ,YAC9C5I,EAAK7nB,WAAWy/B,UAAUyX,OAAOzmB,YAC7Bha,EAAAA,WAAUrrC,WACV28E,EAAW/wC,SAAS,KAAO+wC,EAAW/wC,SAAS,GAAGj9B,EAAIguE,EAAW3zB,YACjEq8B,EAAsBS,EAAUrwC,OAAQknC,EAAW3zB,YACnD2zB,EAAWx2B,QAAQ,KAAK,OAEvB,CACD,GAAIxnD,GAAM2lD,EAAWoC,cAAchrD,EACnCihF,GAAWhwE,KAAO8vC,EAAKnS,cAAcj8B,KAAK8H,OAAOs5C,QAAU9wD,EAAMA,EAAIyS,QAAQ,GAAIN,QAAO,IAAK,MAAO,MACpGu0E,EAAsBS,EAAUrwC,OAAQknC,EAAW77E,YAK7DslF,EAAW,QAAXA,IAAYr/D,EAAMglC,GACpB,GAAMs6B,GAAW5pC,EAAK7nB,WAAWkO,UAAY,GAAM/b,EAAO,GAAK,GAAKA,CACpE,OAAO3kB,GAAAA,WAAM8E,QAAQm/E,GAAUxiF,KAAK,WAChC,MAAI44C,GAAK7nB,WAAWoT,UACTo+C,GAAS,IAAKr6B,GAElBxvD,QAAQC,QAAQuvD,MAIlCu6B,EAAsB,SAACvzC,GACzB,GAAIwzC,GAAY,EACP,IAA2D,mBAAvDzuE,OAAOb,UAAU7R,SAASumB,KAAKonB,EAAKmqC,SAASxhF,MAC7C,IAAK,GAAI0F,GAAE,EAAGA,EAAE2xC,EAAKmqC,SAASxhF,KAAKM,OAAQoF,IACvCmlF,GAAaxzC,EAAKmqC,SAASxhF,KAAK0F,GAAG1F,SAIvC6qF,GAAYxzC,EAAKmqC,SAASxhF,IAE1C6qF,GAAYA,EAAUn1E,QAAQ,MAAM,GACxB,IAAI1V,GAAOq3C,EAAK+sC,YAAYrqC,QAAoC,KAA1B1C,EAAK+sC,YAAYpkF,KAAc6qF,EAAYxzC,EAAK+sC,YAAYpkF,KAAO,IAAM6qF,CAC/G7qF,IAAQ+gD,EAAK7nB,WAAWmtB,mBAAmBuC,EAAWoC,cAAcpC,EAAWqC,WAAWjrD,EAAMoJ,MAGvGm6B,EAAO,WACZ,IAAKhO,EACJ,MAAOwrB,GAAK23B,aAAatvE,EAAS2nB,EAASk1B,EAE5C,IAAM6kC,GAAa,WACH/pC,EAAK7nB,WAAW2rB,WAAa,GAC7B9D,EAAK7nB,WAAW9vB,QAAQqvC,kBAAoBljB,EAAKkjB,kBAAoBljB,EAAKkjB,mBAAqBzQ,MAAM,EAAOz3B,MAAM,EAEjI,IAAI4kC,IAAc/X,OAAQ7H,EAAK6H,OAAQgnD,YAAa7uD,EAAK6uD,YAAa5C,SAAUjsD,EAAKisD,SAClEjsD,GAAKisD,SAASxhF,OAASiyC,GAC1B24C,EAAoBr1D,GAIhBA,EAAKuS,KAAKiS,SACVgH,EAAK7nB,WAAW6V,UAAUC,SAASpK,KAAK8L,WACrCqQ,EAAK+zB,cAAa,IAExB/zB,EAAK+zB,cAAa,GACZ/zB,EAAK7nB,WAAW6U,UAAU/7B,EAAIujB,EAAKuS,KAAK91B,EACxC+uC,EAAK7nB,WAAW6U,UAAU96B,EAAIsiB,EAAKuS,KAAK70B,IAG3CsiB,EAAKwuD,WAAW1gD,KAAK,SAAAryB,GAAA,MAAgB,WAAXA,EAAE/Q,SAC7B8gD,EAAK7nB,WAAWo4B,cAAgBvQ,EAAK7nB,WAAWo4B,aAAa11C,UAC7DmlC,EAAK7nB,WAAWo4B,aAAevQ,EAAK7nB,WAAW+f,aAC/Ct1C,EAAA8tB,iBAAiB6iC,gBAAiBr0D,KAAM,gBAAiB0N,IAAKozC,EAAK7nB,WAAWqrB,gBAElF4gC,IACA5wB,EAAUtiB,EAAWA,EAAS3f,MAAQiD,EAAKjD,OAC3C8yD,EAAcrkC,EAAK7nB,WAAW+f,aAC9B,IAAM8xC,GAAa,WAkBf,MAjB+B,WAA3Bx1D,EAAKisD,SAASC,UACd9M,EAAex/B,GACfswC,EAAclwD,EAAKoJ,WAAYpJ,EAAK2J,OACpC8nD,EAAWzxD,EAAKkK,QAAQhgB,OACxBshC,EAAK7nB,WAAWw4B,YAAY6tB,UAAW,IAEvCkG,EAAclwD,EAAKoJ,WAAYpJ,EAAK2J,OACpC8nD,EAAWzxD,EAAKkK,QAAQhgB,OACxBk1D,EAAex/B,GACf4L,EAAK7nB,WAAWw4B,YAAY6tB,UAAW,GAG3Cx+B,EAAK7nB,WAAWs3B,aAAezP,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWs3B,aACxFzP,EAAK7nB,WAAWgd,qBAAuB6K,EAAK7nB,WAAWgd,mBAAmBtI,SAAU,GACpFmT,EAAK7nB,WAAWiO,cAAgB4Z,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWmO,gBACzF6/C,EAAa3xD,EAAKy7B,MAAO/e,GACzBq1C,EAA6B,OAAbr1C,GAAkC1xC,SAAb0xC,EAAwB1c,EAAKgtB,iBAC9DxB,EAAK7nB,WAAW6V,UAAUkV,kBAAoBlD,EAAK7nB,WAAW6V,UAAUkV,iBAAiBC,gBAAkB3uB,EAAK2uB,gBAA+C,IAA7B3uB,EAAK2uB,eAAejkD,OAAegyC,EACjK8O,EAAK7nB,WAAW0sB,WAAW,GAC3B,OAEOn6C,EAAAA,WAAOsN,KAAK,wBAAwB5Q,KAAK,WAC5C,MAAO44C,GAAK7nB,WAAWq4B,QAAQxQ,EAAK7nB,WAAWg8B,aAChD,WACC,MAAOnU,GAAK7nB,WAAWq4B,QAAQxQ,EAAK7nB,WAAWg8B,eAI3DnU,EAAK7nB,WAAWqS,aAAah8B,YAEtB1O,QAAQm5B,KAAKivD,IAAYZ,MAC3BlgF,KAAK,WAEF,MADA44C,GAAK7nB,WAAWu/B,YAAc1X,EAAK7nB,WAAWu/B,UAAU7qB,SAAU,GAC3Du8C,EAAQ50D,EAAKisD,YAEvBr5E,KAAK,WAKF,MAJI44C,GAAK7nB,WAAW6V,UAAUkV,kBAAoBlD,EAAK7nB,WAAW6V,UAAUkV,iBAAiBC,gBAAkB3uB,EAAK2uB,gBAA+C,IAA7B3uB,EAAK2uB,eAAejkD,OACtJ8gD,EAAK7nB,WAAW8U,UAChB+S,EAAK7nB,WAAW6qB,WAAW,GAAG,IAE3B8hC,EAAWtwD,EAAKG,QAASH,EAAKsC,qBAExC1vB,KAAK,SAAAkoD,GACF,GAAMihB,GAAUvwB,EAAK7nB,WAAWi4B,eAAejhB,SAAS5vC,OAAS,CACjE,OAAO,IAAIO,SAAQ,SAACC,EAASC,GACzB,GAAoB,IAAhBsvD,EAAOpwD,MAA8B,IAAhBowD,EAAOpwD,KAC5B,IAAKs1B,EAAK6d,WAAck+B,IAAYvwB,EAAK7nB,WAAWkO,YAAah+B,EAAQ0vC,OAAYiI,EAAK7nB,WAAWoT,UAE9F,CACH,GAAMqxB,GAAU,QAAVA,GAAW3qD,EAAG7F,GACZA,GAAKA,EAAEk1D,cAAgBhnD,OAAOinD,YAAYC,QAAuB,IAAbp1D,EAAE6xD,QAAgB,SAAWhsD,GAAKs+D,IAG1FvwB,EAAK7nB,WAAW+f,aAAaC,iBAAiBp7B,OAAO6/C,GACjD,eAAiB3qD,EACjBjS,IAEAD,EAAQuvD,IAGhBtP,GAAK7nB,WAAW+f,aAAaC,iBAAiBm3B,UAC9CtvB,EAAK7nB,WAAW+f,aAAaC,iBAAiBz3C,IAAIk8D,IACjD2T,GAAWvwB,EAAK7nB,WAAWy/B,UAAUyX,OAAOrT,QAAQ,WAAA,MAAMj8D,GAAQuvD,SAfnEvvD,GAAQuvD,OAkBZvvD,GAAQuvD,OAInBloD,KAAK,SAAAkoD,GAAA,MAAUq6B,GAASn1D,EAAKvyB,KAAKyc,MAAO4wC,KACzCloD,KAAK,SAAAkoD,GACF,MAAOxvD,SAAQm5B,KAAKkvD,EAAW74B,GAASk4B,EAASl4B,GAASw4B,EAAUtzD,EAAKisD,SAASuC,WAAW1pD,OAAO,SAAArpB,GAAA,MAAmB,eAAdA,EAAE40E,aACtGz9E,KAAK,WAAA,MAAM44C,GAAK7nB,WAAW06B,OAAOxqD,EAAS,WACxC,MAAOvI,SAAQC,QAAQuvD,SAGlCloD,KAAK,SAAAkoD,GACkB,IAAhBA,EAAOpwD,KACP8gD,EAAK23B,aAAatvE,EAAS2nB,EAASk1B,EAAO,SAAUoK,EAAOhsD,OAE5D08C,EAAK23B,aAAatvE,EAAS2nB,EAASk1B,IAEzC,SAAA94C,GAECtM,QAAQE,OAAOoM,MAG3B4zC,GAAK7nB,WAAW04B,eAAexoD,EAAQmsB,EAAKmnB,QAAQv0C,KAAK,SAACgD,GACnDA,KAAO,EACN41C,EAAK7nB,WAAWk5B,eAAehpD,EAASmsB,EAAKmnB,QAAO,EAAM,WACtDquC,MAGJA;IAKlBC,EAAe,WACjB,GAAIC,IAAY,EACf1oC,KACA2oC,EAAY,IACDnqC,GAAK7nB,WAAWoS,eAAgB,CAC/C,IAAM6/C,GAAiB,SAACC,EAAUp1D,EAAU3xB,GAA8B,GAAxBygD,GAAwBzkD,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAT,IAC7D,OAAO,IAAIQ,SAAQ,SAACC,EAAQC,GACT,GAAG+jD,GAAgBA,EAAaC,MAAM,CAElC,GAAMsmC,GAAiBvmC,EAAaC,KACpChE,GAAK7nB,WAAWqS,aAAa98B,KAAO48E,EAAej1D,KAAK,GAAG3nB,KAC3DsyC,EAAK7nB,WAAWqS,aAAaC,MAAQ6/C,EAAej1D,KAAK,GAAGoV,MAC5DuV,EAAK7nB,WAAWqS,aAAah8B,SAAW87E,EAAej1D,KAAK,GAAG7mB,SAC/DwxC,EAAK7nB,WAAWqS,aAAa/7B,MAAQ67E,EAAej1D,KAAK,GAAG5mB,MAC5DuxC,EAAK7nB,WAAWqS,aAAavV,SAAWq1D,CACxC,IAAMC,GAAU,QAAVA,KAEF,MADAvqC,GAAK7nB,WAAW+f,aAAasoC,WAAY,EAClCH,EAAWiK,EAAej1D,KAAK,GAAGoV,MAAuC,EAA/B6/C,EAAej1D,KAAK,GAAGoV,MAAY,GAAI6/C,EAAej1D,KAAK,GAAG7mB,SAAU87E,EAAej1D,KAAK,GAAG5mB,OAAOrH,KAAK,WAExJ,MADA44C,GAAK7nB,WAAW+f,aAAasoC,WAAY,EACtC8J,EAAej1D,KAAK,GAAG3nB,MAAQ48E,EAAej1D,KAAK,GAAGoV,MAAQ,GAAKuV,EAAK7nB,WAAWqS,aAAa98B,MAE/F48E,EAAej1D,KAAK,GAAG5mB,MAAQ,EACxB87E,KAEAzqF,QAAQC,YAI3BwqF,KAAUnjF,KAAK,WAEX44C,EAAK7nB,WAAW+f,aAAasoC,WAAY,IAMjD,GAHK6J,EAAS94D,OAAgD,KAAvC3uB,EAAA8tB,iBAAiByC,YAAY5B,OAChDyuB,EAAK7nB,WAAWk4B,YAEhBg6B,EAAS94D,QAAUyuB,EAAKnS,cAAcj8B,KAAKpC,KAAKkI,MAAM2E,cAAcguE,EAAS94D,MAAM3sB,MAC5E,QAAU3D,UAAU+L,QAAU/L,UAAUstB,aAAe,SAAU,CACxE,GAAI9gB,GAAS48E,EAAS94D,MAAM9jB,MACQjO,UAAjC6qF,EAAS94D,MAAMtjB,eAA+Bo8E,EAAS94D,MAAMtjB,qBAAsBR,EAAS48E,EAAS94D,MAAMtjB,eAC9G+xC,EAAK7nB,WAAWk4B,UAAUg6B,EAAS94D,MAAM3sB,KACzCo7C,EAAK7nB,WAAWq7B,UAAU62B,EAAS94D,MAAM3sB,IAAK6I,GAAQ,GAG1D,IAAK,GAAIvG,KAAQmjF,GAAS74D,OACtB,GAAI64D,EAAS74D,OAAOtqB,IAAuD,KAA9CtE,EAAA8tB,iBAAiByC,YAAY3B,OAAOtqB,IAC7D,GAAI84C,EAAKnS,cAAcj8B,KAAKpC,KAAKkI,MAAM2E,cAAcguE,EAAS74D,OAAOtqB,GAAMtC,MACpE,QAAU3D,UAAU+L,QAAU/L,UAAUstB,aAAe,QAAS,CACnE,GAAI9gB,GAAS48E,EAAS74D,OAAOtqB,GAAMuG,MACQjO,UAAxC6qF,EAAS74D,OAAOtqB,GAAM+G,eAA+Bo8E,EAAS74D,OAAOtqB,GAAM+G,qBAAsBR,EAAS48E,EAAS74D,OAAOtqB,GAAM+G,eACnI+xC,EAAK7nB,WAAWm4B,UAAUppD,EAAMmjF,EAAS74D,OAAOtqB,GAAMtC,KAAI,GAC1Do7C,EAAK7nB,WAAWu7B,UAAUxsD,EAAMmjF,EAAS74D,OAAOtqB,GAAMtC,IAAK6I,EAAuC,IAA/B48E,EAAS74D,OAAOtqB,GAAMojB,WAI7F01B,GAAK7nB,WAAWm4B,UAAUppD,IAIjCmjF,EAASh2C,KAAOg2C,EAASh2C,IAAM6P,QAAS,IACzCk5B,EAAWp9B,EAAK7nB,WAAW+f,aAAaiiB,OAAO,EAAG,EAAGkwB,EAASh2C,GAAGzvC,KACjEw4E,EAAS72C,MAAQ8jD,EAASh2C,GAAG6P,QAC7Bk5B,EAASl5E,MAAQ87C,EAAKnS,cAAcj8B,KAAKshC,MAAMhvC,MAC/Ck5E,EAAS/4E,OAAS27C,EAAKnS,cAAcj8B,KAAKshC,MAAM7uC,OAChD27C,EAAKnS,cAAcstB,gBAAgBiiB,EAAUiN,EAASh2C,GAAGzvC,KACpDo7C,EAAK7nB,WAAWgd,oBAAuB6K,EAAK7nB,WAAWgd,mBAAmBC,SAC3E4K,EAAK7nB,WAAWgd,mBAAqB6K,EAAKnS,cAAcj8B,KAAKlR,IAAI69C,QACjEyB,EAAK7nB,WAAWgd,mBAAmBr3C,KAAO,qBA7D3B,IAAA0sF,IAAA,EAAAC,GAAA,EAAAC,EAAAlrF,MAAA,KA+DnB,IAAA,GAAAmrF,GAAAC,EAAiBP,EAAS12C,cAA1B9W,OAAAC,cAAA0tD,GAAAG,EAAAC,EAAA7tD,QAAAC,MAAAwtD,GAAA,EAAyC,CAAA,GAAhCtjF,GAAgCyjF,EAAAjsE,MACtCzN,EAAI/J,EAAK+J,EACTiB,EAAIhL,EAAKgL,CACZhL,GAAKhD,MAAQkB,KAAKkN,IAAIpL,EAAKhD,OAC3BgD,EAAK7C,OAASe,KAAKkN,IAAIpL,EAAK7C,QACxB6C,EAAKi9C,QAAUj9C,EAAKm9C,SACpBn9C,EAAK+J,GAAK/J,EAAKhD,MAAQ,EACvBgD,EAAKgL,GAAKhL,EAAK7C,OAAS,EAE5B,IAAMk7E,GAAKv/B,EAAKnS,cAAckyB,kBAAkB74D,EAAK+J,EAAG/J,EAAKgL,EAAG9M,KAAKkN,IAAIpL,EAAKhD,OAAQgD,EAAK7C,OAAQ6C,EAAKtC,IAAKo7C,EAAK7nB,WAAWgd,mBAAoBjuC,EAAK5D,MACzJi8E,GAAGh5C,MAAQr/B,EAAKg9C,QACbq7B,EAAGhqC,MAAQruC,EAAKs9C,OACZt9C,EAAKi9C,QACLo7B,EAAGhtE,MAAMtB,EAAI/J,EAAKo9C,OAClBi7B,EAAGhtE,MAAML,EAAIhL,EAAKq9C,OAClBg7B,EAAGtuE,EAAIA,EACPsuE,EAAGrtE,EAAIA,EACHhL,EAAKy9C,UAAS46B,EAAG56B,SAAU,GAC3Bz9C,EAAK09C,UAAS26B,EAAG36B,SAAU,KAE3B19C,EAAKy9C,UACL46B,EAAGhqC,OAASgqC,EAAGhqC,MACfgqC,EAAGhtE,MAAMtB,GAAKsuE,EAAGhtE,MAAMtB,EACvBsuE,EAAG56B,SAAU,GAEbz9C,EAAK09C,UACL26B,EAAGhqC,OAASgqC,EAAGhqC,MACfgqC,EAAGhtE,MAAML,GAAKqtE,EAAGhtE,MAAML,EACvBqtE,EAAG36B,SAAU,IAIjB26B,EAAG17B,QAAU38C,EAAK28C,QACd38C,EAAKw9C,aACL66B,EAAGxhF,OAAOwU,MAAMyoD,MAAM9zD,EAAKw9C,YAAax9C,EAAKw9C,aAEjD1E,EAAKnS,cAAcstB,gBAAgBokB,EAAIr4E,EAAKtC,MAnG7B,MAAAmlB,GAAA0gE,GAAA,EAAAC,EAAA3gE,EAAA,QAAA,KAAAygE,GAAAI,EAAAA,WAAAA,EAAAA,YAAA,QAAA,GAAAH,EAAA,KAAAC,IAqGa,KAAhC1qC,EAAK7nB,WAAWmc,aAAsB2xC,EAAWoE,EAAS/1C,aAC1D0L,EAAK7nB,WAAW+Q,aAAemhD,EAAS7kC,SAEpC6kC,EAASj2C,WAAW,KAAO9wC,GAAS2xB,EAAS11B,QAAU+D,EAAQ2xB,EAAS11B,QAAmC,eAAzB01B,EAAS3xB,GAAOpE,OAClG00E,EAAeyW,EAASj2C,WAAW,IACnCg1C,EAAQiB,EAASj2C,WAAW,GAAGqsC,UAAU,IAIzCzgC,EAAK7nB,WAAWw4B,YAAY9jB,SAAU,CAE1C,IAAMg+C,GAAY,WAKd,MAJAX,IAAY,EACRlqC,EAAK7nB,WAAWyqB,YAAYzT,SAAS5vC,OAAS,GAC9CygD,EAAK7nB,WAAWyqB,YAAYgG,WAAU,GAEnC,GAAI9oD,SAAQ,SAACC,EAAQC,GAExB,GAAM8qF,GAAY,SAACnmF,GACf,GAAGq7C,EAAK7nB,WAAW0S,iBAAiBlmC,GAAG,CACnC,GAAIomF,GAAiB/qC,EAAK7nB,WAAW0S,iBAAiBlmC,GAAGswB,SACrDikB,EAAK8xC,EAAUD,EAAe11D,KAAK,GAAG/xB,OACpChB,EAAS09C,EAAK29B,gBAAgB39B,EAAK7nB,WAAWyqB,YAAamoC,EACjE,IAAG7xC,OAAS,CACR,GAAM+xC,GAAUjrC,EAAK7nB,WAAW0S,iBAAiBqO,GAAI6I,WAAW54B,SAC1D+hE,EAASlrC,EAAK7nB,WAAW0S,iBAAiBqO,GAAI8I,UAAU74B,SACxDgiE,EAAOnrC,EAAK7nB,WAAW0S,iBAAiBlmC,GAAGs9C,OAC3CC,EAAYlC,EAAK7nB,WAAW0S,iBAAiBlmC,GAAGu9C,SACtDlC,GAAK7nB,WAAW0S,iBAAiBqO,GAAM52C,EACvCA,EAAOy/C,WAAakpC,EAAQ9hE,SAC5B7mB,EAAO0/C,UAAYkpC,EAAO/hE,SAC1B7mB,EAAO2/C,OAASkpC,EAChB7oF,EAAO4/C,UAAYA,EACnB5/C,EAAOw7E,WAAa,EACpBx7E,EAAOuqC,QAAWvqC,EAAO2/C,UAAW,MAEpCjC,GAAK7nB,WAAW0S,iBAAiBppB,KAAKnf,GACtCA,EAAOy/C,cACPz/C,EAAO0/C,aACP1/C,EAAOw7E,WAAa,CAGxB,OADAx7E,GAAO4/C,YAAcioC,EAAY7nF,GAC1BxC,QAAQC,QAAQuC,GAEvB,MAAOxC,SAAQE,UAIjBorF,EAAY,QAAZA,GAAa55E,EAAElP,GACjB,GAAGA,EAAOy/C,WAAWvwC,GAAG,CACpB,GAAI65E,GAAiB/oF,EAAOy/C,WAAWvwC,EACvC,OAAOwuC,GAAKy+B,aAAa4M,EAAgB/oF,GAAQ8E,KAAK,SAACkJ,GAEnD,MADAkB,KACO45E,EAAU55E,EAAElP,KAGvB,MAAOxC,SAAQC,WAGnB4E,EAAI,EACJ6M,EAAI,EACF85E,EAAU,QAAVA,GAAW3mF,GACb,MAAOmmF,GAAUnmF,GAAGyC,KAAK,SAACkJ,GAEtB,MADAkB,GAAG,EACI45E,EAAU55E,EAAElB,GAAGlJ,KAAK,WAEvB,MADAzC,KACO2mF,EAAQ3mF,MAErB,WAEE,MAAO5E,OAGf,OAAOurF,GAAQ3mF,MAGjB4mF,EAAW,WACbvrC,EAAK7nB,WAAWy3B,gBAAgB5P,EAAK7nB,WAAWi4B,gBAChDpQ,EAAK7nB,WAAWu3B,gBAAgB1P,EAAK7nB,WAAWi4B,gBAChDpQ,EAAK7nB,WAAWi4B,eAAexH,WAAU,GACzC5I,EAAK7nB,WAAW63B,0BAA0Bq6B,EAAShiD,UAAW7T,GAC9DwrB,EAAKq2B,cAAcr2B,EAAK7nB,WAAWoQ,cACnC89C,EAAagE,EAAShiD,WACtB2X,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWi4B,eACzD,KAAK,GAAIzrD,KAAKq7C,GAAK7nB,WAAWirB,YAC1B,IAAKpD,EAAK7nB,WAAWirB,YAAYz+C,GAAGkoC,QAChC,IAAK,GAAIz6B,KAAK4tC,GAAK7nB,WAAW6V,UAAUiiB,MACpC,GAAIjQ,EAAK7nB,WAAW6V,UAAUiiB,MAAM79C,GAAG+uC,MAAQnB,EAAK7nB,WAAWirB,YAAYz+C,GAAG7G,KAAM,CAChF0jD,EAAgB78C,GAAMq7C,EAAK7nB,WAAW6V,UAAUiiB,MAAM79C,GAAGyuC,YACzD,OAKhB0lC,GAAgB,EAAM/kC,IAEpBgqC,EAAU,WACRnB,EAASphD,SAAS,KAClB+W,EAAK+zB,cAAa,GAClB/zB,EAAK7nB,WAAW6U,UAAU/7B,EAAIo5E,EAASphD,SAAS,GAAGh4B,EACnD+uC,EAAK7nB,WAAW6U,UAAU96B,EAAIm4E,EAASphD,SAAS,GAAG/2B,GAG3D,OAAO24E,KAAYzjF,KAAK,WAGpB,MAFAmkF,KACAC,IACOzrF,SAMbirF,EAAY,SAAC1nF,GACf,GAAG08C,EAAK7nB,WAAW0S,iBAAiBtrC,OAAS,EACzC,IAAI,GAAIoF,GAAI,EAAEA,EAAGq7C,EAAK7nB,WAAW0S,iBAAiBtrC,OAAOoF,IACrD,GAAG6H,SAASwzC,EAAK7nB,WAAW0S,iBAAiBlmC,GAAGrB,SAAWkJ,SAASlJ,IAAU08C,EAAK7nB,WAAW0S,iBAAiBlmC,GAC3G,MAAOA,EAInB,WAEE8mF,EAAc,WAChBzrC,EAAK7nB,WAAW0S,iBAAiBtvB,QAAQ,SAACjL,EAAEhN,GAASgN,EAAE4xC,WAAY,KAEhF33B,EAAS,SAACwJ,EAASpvB,GACN,GAAI2qD,IAAUpwD,KAAM,GAItC,OAHkB8gD,GAAK7nB,WAAWs2B,WAAa16B,EAC7BisB,EAAK7nB,WAAWu2B,YAAc/pD,EAEzC,GAAI7E,SAAQ,SAACC,EAASC,GACzB,GAAI,aAAe+zB,EAAQkB,SAAStwB,GAAGzF,MAAQ,SAAW60B,EAAQkB,SAAStwB,GAAGzF,MACrD,SAAW60B,EAAQkB,SAAStwB,GAAGzF,MAAQ,WAAa60B,EAAQkB,SAAStwB,GAAGzF,KAChG8gD,EAAK7nB,WAAW2/B,mBAAqB,SAEf,IAAI,eAAiB/jC,EAAQkB,SAAStwB,GAAGzF,KAAM,CAClE,GAAMwsF,GAAkB,SAACz7E,GACH,GAAI+tD,GAAU,GAAI1jD,QAAOk2D,QAAQxwB,EAAKnS,cAAcj8B,KAAM,EAAG0I,OAAOinD,YAAYC,OAChFxD,GAAQC,OAAS,EACjBje,EAAK7nB,WAAW+f,aAAaC,iBAAiBzoC,SAAS,UAAWsuD,GAClEhe,EAAK7nB,WAAW+f,aAAaC,iBAAiBzoC,SAAS,UAAWsuD,GAClEj+D,EAAQkQ,GAE9B+vC,GAAK7nB,WAAW2/B,mBAAqB4zB,MAGnB1rC,GAAK7nB,WAAW2/B,mBAAqB/3D,CAGzC,IAAMk1B,GAAWlB,EAAQkB,SACnBI,EAAOJ,EAAStwB,GAAG0wB,IACzB2qB,GAAK7nB,WAAW2rB,WAAa7uB,EAAStwB,GAAG8E,IArBvB,IAAAkiF,GAAA,WAsBlB,OAAQ12D,EAAStwB,GAAGzF,MAChB,IAAK,UAID,GAHAinF,EAAa9wD,EAAM,KAAMJ,EAAStwB,GAAG8E,MACrCu2C,EAAK7nB,WAAWi4B,eAAevjB,SAAU,EACzCmT,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAW6U,WACtDgT,EAAK7nB,WAAWiO,cAAgB4Z,EAAK7nB,WAAWkO,UAAU,CACzD2Z,EAAK7nB,WAAWiO,cAAe,EAC/B4Z,EAAK7nB,WAAWkO,WAAY,EAC5B2Z,EAAK7nB,WAAWmO,eAAeC,MAAQ,CACvC,IAAMq2B,GAAU,QAAVA,IAAW3qD,EAAG7F,GACZA,GAAKA,EAAEk1D,cAAgBhnD,OAAOinD,YAAYC,QAAuB,IAAbp1D,EAAE6xD,QAAgB,SAAWhsD,IAGrF+tC,EAAK7nB,WAAWmO,eAAeC,MAAQ,EACvCyZ,EAAK7nB,WAAW+f,aAAaC,iBAAiBp7B,OAAO6/C,IACrDgvB,EAAY5rC,EAAK7nB,WAAWs2B,WAAWzO,EAAK7nB,WAAWu2B,YAAc,IAKzE,OAHA1O,GAAK7nB,WAAW+f,aAAaC,iBAAiBm3B,UAC9CtvB,EAAK7nB,WAAW+f,aAAaC,iBAAiBz3C,IAAIk8D,GAClD5c,EAAK7nB,WAAWy/B,UAAUyX,OAAOrT,QAAQ,WAAQ4vB,EAAY5rC,EAAK7nB,WAAWs2B,WAAWzO,EAAK7nB,WAAWu2B,YAAc,MACtH7gD,EAAO7N,KAEX,KACJ,KAAK,UACDggD,EAAK2vB,YAAYt6C,EAAK,GACtB,MAC5B,KAAK,WACJ,GAAgB,gBAAZA,EAAK,GAAsB,CACA,GAAMqiB,GAAoBsI,EAAK7nB,WAAW9vB,QAAQqvC,iBAClD,OAAIA,IAAqBA,EAAkBzQ,MACvC+Y,EAAK7nB,WAAWwf,UAAU,EAAG,mBAC7B9pC,EAAO9N,EAAQuvD,OAElBtP,EAAK7nB,WAAW2Y,cAAcjE,SAAWmT,EAAK7nB,WAAW8U,UAC1D+S,EAAK7nB,WAAWiU,UAAS,GAAQ29B,YAAYhqE,EAASiqE,aAAc1a,KACpEzhD,EAAA,SAE1B,GAAgB,gBAAZwnB,EAAK,GAAsB,CACL,GAAMqiB,GAAoBsI,EAAK7nB,WAAW9vB,QAAQqvC,iBAClD,OAAIA,IAAqBA,EAAkBloC,MACvCwwC,EAAK7nB,WAAWwf,UAAU,EAAG,mBAC7B9pC,EAAO9N,EAAQuvD,MAEnBtP,EAAK7nB,WAAWiZ,UAAS,GAAQ24B,YAAYhqE,EAASiqE,aAAc1a,KACpEzhD,EAAA,SAEC,GAAgB,aAAZwnB,EAAK,GAEV,MADA2qB,GAAK7nB,WAAWyY,aAAavoC,GAAS0hE,YAAYhqE,EAASiqE,aAAc1a,KACzEzhD,EAAA,OAEC,IAAgB,aAAZwnB,EAAK,GAEV,MADA2qB,GAAK7nB,WAAW4Y,cAAcg5B,YAAYhqE,EAASiqE,aAAc1a,KACjEzhD,EAAA,OAER,KAAK,WACJ,GAAsB,IAAlBwnB,EAAK,GAAG/xB,MAAa,CACxB,GAAMihF,GAA4B,YAAhBlvD,EAAK,GAAGzwB,IAChB24D,EAASgnB,EAAYvkC,EAAK7nB,WAAWqrB,aAAenuB,EAAK,GAAGzwB,IAC5D6/E,EAAUF,EAAYvkC,EAAK7nB,WAAWyrB,cAAgBvuB,EAAK,GAAGqsC,KAC9D8iB,EAAWD,EAAYvkC,EAAK7nB,WAAWurB,iBAAmBruB,EAAK,GAAG6uB,OACtE,IAAIlE,EAAKnS,cAAcj8B,KAAKpC,KAAKkI,MAAM6E,cAAcghD,GAAS,CAC1D,GAAIsuB,GAAM7rC,EAAK7nB,WAAW+f,aAAa/I,SAASlyB,OAAO,EAAG,EAC1D4uE,GAAItsF,QAAUssF,EAAI,GAAGhxE,UACrBuiE,EAAWp9B,EAAK7nB,WAAW+f,aAAaiiB,OAAO9kC,EAAK,GAAGpkB,EAAGokB,EAAK,GAAGnjB,EAAGqrD,GACrE6f,EAAS72C,MAAqB/mC,SAAbglF,EAAyB,EAAIA,EAC9CxkC,EAAKmzB,eAAeiK,EAAUqH,GAC1BzkC,EAAK7nB,WAAWu/B,WAAa1X,EAAK7nB,WAAWu/B,UAAU7qB,UAAUmT,EAAK7nB,WAAWu/B,UAAU7qB,SAAU,GACzGmT,EAAK7nB,WAAWuS,aAAesV,EAAK7nB,WAAWqrB,aAC/CxD,EAAK7nB,WAAWqrB,aAAe+Z,EAC/Bvd,EAAK7nB,WAAWurB,iBAAmB8gC,EACnCxkC,EAAK7nB,WAAWyrB,cAAgB6gC,EAChCzkC,EAAKnS,cAAcstB,gBAAgBiiB,EAAU/nD,EAAK,GAAGzwB,UAIzD8/E,GAAcrvD,KAAUJ,EAAStwB,GAAG8E,KAExCu2C,GAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWyqB,aACzD5C,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWi4B,gBACzDm2B,GAAgB,EAAO/kC,GACvBxB,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAW6U,WACzDgT,EAAK7nB,WAAWiO,cAAgB4Z,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWmO,eACzF,MACJ,KAAK,WACJ,GAAI,IAAMjR,EAAK,GAAI,CACZ,GAAIw2D,GAAM7rC,EAAK7nB,WAAW+f,aAAa/I,SAASlyB,OAAO,EAAG,EAC1D4uE,GAAItsF,QAAUssF,EAAI,GAAGhxE,cAErB,KAAK,GAAIlW,GAAE,EAAGA,EAAEq7C,EAAK7nB,WAAWgd,mBAAmBhG,SAAS5vC,OAAQoF,IAAK,CACrE,GAAIyF,GAAK41C,EAAK7nB,WAAWgd,mBAAmB6qB,MAAMr7D,EAClD,SAAWyF,EAAI,KACf,IAAIA,EAAGq6C,SAAWpvB,EAAK,GAAI,CACvB2qB,EAAK7nB,WAAWgd,mBAAmB8qB,cAAct7D,GACjDyF,EAAGyQ,SACH,QAIZ,KACJ,KAAK,WACDmlC,EAAK7nB,WAAW8Q,SAAW5T,EAAKlM,SAChC62B,EAAK+zB,cAAa,GAClB/zB,EAAK7nB,WAAW6U,UAAU/7B,EAAIokB,EAAK,GAAGpkB,EACtC+uC,EAAK7nB,WAAW6U,UAAU96B,EAAImjB,EAAK,GAAGnjB,CACtC,MACJ,KAAK,WACD8tC,EAAK7nB,WAAW8Q,YAChB+W,EAAK7nB,WAAW6U,UAAUH,SAAU,CACpC,MACJ,KAAK,iBACD,IAAK,GAAIloC,GAAE,EAAGA,EAAE68C,EAAgBjiD,OAAQoF,IACpC,GAAI68C,EAAgB78C,KAAO0wB,EAAK,GAAI,CAChCmsB,EAAgBvkC,OAAOtY,EAAG,EAC1B,OAGR4hF,GAAgB,EAAO/kC,EACvB,MACJ,KAAK,iBAED,IADA,GAAI78C,GAAI,EACDA,EAAE68C,EAAgBjiD,QACjBiiD,EAAgB78C,KAAO0wB,EAAK,GADH1wB,KAG7BA,GAAK68C,EAAgBjiD,SAAQiiD,EAAgB78C,GAAK0wB,EAAK,IAE3DkxD,GAAgB,EAAO/kC,EACvB,MACJ,KAAK,aAKD,MAJAxB,GAAK7nB,WAAW6Q,cAAgB3T,EAAKlM,SACrC62B,EAAK7nB,WAAWw4B,YAAYqf,cAAcz0D,QAAQ,SAACwZ,EAAEpwB,GAAOowB,EAAEre,SAC9DspC,EAAK7nB,WAAWw4B,YAAYqf,cAAc/yD,OAAO,GACjD4sE,EAAoBx0D,EAAK,KACzBxnB,EAAO+lE,EAAev+C,EAAK,IACtBjuB,KAAK,WAiBF,MAhBIiuB,GAAK,GAAGorD,SAASC,UAA0C,WAA9BrrD,EAAK,GAAGorD,SAASC,UAC9C1gC,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWgd,oBACzD6K,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWyqB,aACzD5C,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWwpB,cACzD3B,EAAK7nB,WAAWw4B,YAAY6tB,UAAW,IAEvCx+B,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWw4B,aACzD3Q,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWwpB,cACzD3B,EAAK7nB,WAAWw4B,YAAY6tB,UAAW,GAExCnpD,EAAK,GAAGorD,SAASuC,YAAc3tD,EAAK,GAAGorD,SAASuC,WAAWzjF,OAAS,IACnEygD,EAAK7nB,WAAWw4B,YAAY9jB,SAAU,GAG1CmT,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWi4B,gBACzDm2B,GAAgB,EAAO/kC,GAChB4nC,EAAQ/zD,EAAK,GAAGorD,YAE1Br5E,KAAK,WACF,GAAMmpE,GAAUvwB,EAAK7nB,WAAWi4B,eAAejhB,SAAS5vC,OAAS,EAC3DusF,EAAY9rC,EAAK7nB,WAAWyqB,YAAYzT,SAAS5vC,OAAS,CAChE,KAAKygD,EAAK7nB,WAAW+Q,eAAkBqnC,IAAYvwB,EAAK7nB,WAAWkO,YAAa2Z,EAAK7nB,WAAW9vB,QAAQ0vC,OAAYiI,EAAK7nB,WAAWoT,UAE7H,CACH,GAAMqxB,GAAU,QAAVA,GAAW3qD,EAAG7F,GAChB,KAAIA,GAAKA,EAAEk1D,cAAgBhnD,OAAOinD,YAAYC,QAAuB,IAAbp1D,EAAE6xD,QAAgB,SAAWhsD,GAAKs+D,GAI1F,MADAvwB,GAAK7nB,WAAW+f,aAAaC,iBAAiBp7B,OAAO6/C,GACjD,eAAiB3qD,EACVjS,IAEAD,EAAQuvD,GAGvBtP,GAAK7nB,WAAW+f,aAAaC,iBAAiBm3B,UAC9CtvB,EAAK7nB,WAAW+f,aAAaC,iBAAiBz3C,IAAIk8D,GAC/CkvB,IACC9rC,EAAK7nB,WAAW6S,WAAa,WAEzB,MADAgV,GAAK7nB,WAAW6S,WAAa,KACtBjrC,EAAQuvD,MAItBihB,GAAWvwB,EAAK7nB,WAAWy/B,UAAUyX,OAAOrT,QAAQ,WAAO,MAAOj8D,GAAQuvD,SAtB3E3pD,GAAAA,WAAM8E,QAAQ,KAAKrD,KAAK,WAAK,MAAOrH,GAAQuvD,OAyB5D,KAAK,aACDtP,EAAK7nB,WAAW6Q,iBAChBgX,EAAK7nB,WAAWw4B,YAAY9jB,SAAU,CACtC,MACJ,KAAK,YACD2mB,EAAUn+B,EAAK,GACf,MACJ,KAAK,YACD2qB,EAAK7nB,WAAWk4B,WAChB,MACJ,KAAK,YACD,GAAoB,YAAhBh7B,EAAK,GAAGzwB,IAAmB,CAC1Bo7C,EAAK7nB,WAAWgO,WAAW9Q,EAAK,GAAG/xB,QACjE08C,EAAK7nB,WAAWw7B,iBAAiBt+B,EAAK,GAAG/xB,MAAO+xB,EAAK,GAAG5nB,OAE3B,QAEKuyC,EAAKnS,cAAcj8B,KAAKpC,KAAKkI,MAAM2E,cAAcgZ,EAAK,GAAGzwB,MACvD,QAAU3D,UAAU+L,QAAU,SAAW/L,UAAUstB,eAC1DyxB,EAAK7nB,WAAWm4B,UAAUj7B,EAAK,GAAG/xB,MAAO+xB,EAAK,GAAGzwB,KACjDo7C,EAAK7nB,WAAWu7B,UAAUr+B,EAAK,GAAG/xB,MAAO+xB,EAAK,GAAGzwB,IAAKywB,EAAK,GAAG5nB,OAAyB,IAAjB4nB,EAAK,GAAG/K,MAElF,MACJ,KAAK,YACD01B,EAAK7nB,WAAWm4B,UAAUj7B,EAAK,GAC/B,MACJ,KAAK,eACD,GAAG2qB,EAAK7nB,WAAWw4B,YAAY9jB,WAAY,EAAM,CAC7C,GAAMqkB,GAAQlR,EAAKnS,cAAcj8B,KAAKshC,MAAMivC,cAAcniC,EAAK7nB,WAAWw4B,aACpEo7B,EAAQ/rC,EAAKnS,cAAcj8B,KAAKshC,MAAMivC,cAAcniC,EAAK7nB,WAAWgd,mBACvE+b,GAAS66B,IAAW/rC,EAAK7nB,WAAWw4B,YAAY6tB,UAC/Cx+B,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWw4B,aAG9D3Q,EAAK7nB,WAAW6U,UAAUH,WAAY,GACrCmT,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAW6U,UAE7D,IAAMv+B,GAAQuxC,EAAK7nB,WAAWkO,UAAY,EAAIhR,EAAK,GAAG5mB,MAChDD,EAAWwxC,EAAK7nB,WAAWkO,UAAY,EAAIhR,EAAK,GAAG7mB,QACzD,IAAI6mB,EAAK,GAAG/xB,MAAQ,GAAK08C,EAAK7nB,WAAWgd,mBAAmBC,OACxD,IAAK,GAD2D3T,IAAA,SACvD98B,GACL,GAAI0wC,GAAW2K,EAAK7nB,WAAWgd,mBAAmBhG,SAASxqC,EAC3D,IAAI0wC,EAASoP,SAAWpvB,EAAK,GAAG/xB,MAAO,CACtC,GAAI2C,GAAMovC,EAASlG,SAAS,GACtBqlC,EAAc,WAETn/B,EAAS26B,gBACZ36B,EAAS26B,cAAcz0D,QAAQ,SAACwZ,EAAEpwB,GAAOowB,EAAEre,MAAK,KAC7C2+B,EAAS26B,cAAc/yD,OAAO,IAE9BhX,EAAI+pE,gBACP/pE,EAAI+pE,cAAcz0D,QAAQ,SAACwZ,EAAEpwB,GAAOowB,EAAEre,MAAK,KACxCzQ,EAAI+pE,cAAc/yD,OAAO,IAEzBhX,EAAIqvC,aACPrvC,EAAIsgC,MAAQtgC,EAAIqvC,WAAW/O,MACxBtgC,EAAIsvC,MAAQtvC,EAAIqvC,WAAWC,MAC3BtvC,EAAIgL,EAAIhL,EAAIqvC,WAAWrkC,EACvBhL,EAAIiM,EAAIjM,EAAIqvC,WAAWpjC,EACvBmjC,EAASpkC,EAAI,EACbokC,EAASnjC,EAAI,EACbmjC,EAAS9iC,MAAMtB,EAAIokC,EAASC,WAAW/iC,MAAMtB,EAC7CokC,EAAS9iC,MAAML,EAAImjC,EAASC,WAAW/iC,MAAML,EAGjD,IAAIq0B,GAAQlR,EAAK,GAAG6uB,QAChB3O,EAAqC,MAA7B/oC,SAAS6oB,EAAK,GAAGmvB,QAAkB,MAAQnvB,EAAK,GAAGmvB,OAC3DF,EAA4B9kD,SAAnB61B,EAAK,GAAGivB,OAAuB,EAAIjvB,EAAK,GAAGivB,OACpDC,EAA4B/kD,SAAnB61B,EAAK,GAAGkvB,OAAuB,EAAIlvB,EAAK,GAAGkvB,OACpDtzC,EAAIokB,EAAK,GAAGpkB,EAAIqzC,EAASr+C,EAAI/B,MAAM,EACnCgO,EAAImjB,EAAK,GAAGnjB,EAAIqyC,EAASt+C,EAAI5B,OAAO,CAcxC,IAXA4B,EAAI0+C,UAAYpP,GAASA,EAAOtkC,GAAKhL,EAAI/B,OACzC+B,EAAI2+C,UAAYrP,GAASA,EAAOrjC,GAAKjM,EAAI5B,UAEpC4B,EAAI+lF,UAAY/lF,EAAIsgC,QAAUA,GAAStgC,EAAI+lF,WAAazlD,KACzDtgC,EAAI+lF,SAAWzlD,EACfyZ,EAAKoxB,eAAenrE,GAAMsgC,MAAOA,GAAQ/3B,EAAU,MAAM,EAAMC,MAE9DxI,EAAIgmF,UAAYhmF,EAAIsvC,QAAUA,GAAStvC,EAAIgmF,WAAa12C,KACzDtvC,EAAIgmF,SAAW12C,EACfyK,EAAKoxB,eAAenrE,GAAMsvC,MAAOA,GAAQ/mC,EAAU,MAAM,EAAMC,KAE9DxI,EAAIimF,MAAQjmF,EAAIgL,IAAMA,GAAKhL,EAAIimF,OAASj7E,EAAG,CAC5ChL,EAAIimF,KAAOj7E,CACX,IAAIk7E,GAAOlmF,EAAI0+C,SAAW1+C,EAAIgL,EAAIhL,EAAI/B,MAAM,GAAMmxC,EAAS9iC,MAAMtB,GAAKhL,EAAIgL,EAAIhL,EAAI/B,MAAM,GAAMmxC,EAAS9iC,MAAMtB,EACzGm7E,EAAU/2D,EAAK,GAAGpkB,EAAIk7E,GAAQ7nC,EAASjP,EAAS9iC,MAAMtB,EAC1D+uC,GAAKoxB,eAAe/7B,GAAWpkC,EAAEm7E,GAAU59E,EAAU,MAAM,EAAMC,GAAOrH,KAAK,WACzEiuC,EAASpkC,EAAI,EACbhL,EAAIgL,EAAIhL,EAAIimF,OAIpB,IAAKjmF,EAAIomF,MAAQpmF,EAAIiM,IAAMA,GAAKjM,EAAIomF,OAASn6E,EAAG,CAC5CjM,EAAIomF,KAAOn6E,CACX,IAAIo6E,GAAOrmF,EAAI2+C,SAAW3+C,EAAIiM,EAAIjM,EAAI5B,OAAO,GAAKgxC,EAAS9iC,MAAML,GAAKjM,EAAIiM,EAAIjM,EAAI5B,OAAO,GAAKgxC,EAAS9iC,MAAML,EACzGq6E,EAAUl3D,EAAK,GAAGnjB,EAAIo6E,GAAQ/nC,EAASlP,EAAS9iC,MAAML,EAC1D8tC,GAAKoxB,eAAe/7B,GAAWnjC,EAAEq6E,GAAU/9E,EAAU,MAAM,EAAMC,GAAOrH,KAAK,WACzEiuC,EAASnjC,EAAI,EACbjM,EAAIiM,EAAIjM,EAAIomF,OAIpBpmF,EAAIqvC,YAAc/O,MAAMA,EAAOgP,MAAMA,EAAOtkC,EAAEA,EAAGiB,EAAEA,KAE9CmjC,EAASm3C,WAAan3C,EAAS9iC,MAAMtB,IAAMqzC,GAAUjP,EAASm3C,YAAcloC,KAC7EjP,EAASm3C,UAAYloC,EACrBtE,EAAKoxB,eAAe/7B,EAAS9iC,OAAQtB,EAAEqzC,GAAS91C,EAAU,MAAM,EAAMC,MAErE4mC,EAASo3C,WAAap3C,EAAS9iC,MAAML,IAAMqyC,GAAUlP,EAASo3C,YAAcloC,KAC7ElP,EAASo3C,UAAYloC,EACrBvE,EAAKoxB,eAAe/7B,EAAS9iC,OAAQL,EAAEqyC,GAAS/1C,EAAU,MAAM,EAAMC,IAE1E4mC,EAASC,YAAc/iC,OAAOtB,EAAEqzC,EAAQpyC,EAAEqyC,IAG9C,OADHiwB,KACG,UA7EC7vE,GAAE,EAAGA,GAAEq7C,EAAK7nB,WAAWgd,mBAAmBhG,SAAS5vC,OAAQoF,KAAK,CAAA,GAAA+nF,IAAAjrD,GAAhE98B,GAAgE,IAAA,UAAA+nF,GA6EjE,UAGiB,KAAlBr3D,EAAK,GAAG/xB,OAAe08C,EAAK7nB,WAAW+f,aAAa/I,SAAS,KACvE6Q,EAAKoxB,eAAepxB,EAAK7nB,WAAW+f,aAAa/I,SAAS,IAAK5I,MAAOlR,EAAK,GAAG6uB,SAAU11C,EAAU,MAAM,EAAMC,GAC9GuxC,EAAK7nB,WAAW+f,aAAa/I,SAAS,GAAGmG,YAAc/O,MAAOlR,EAAK,GAAG6uB,SACtElE,EAAK7nB,WAAWurB,iBAAmBruB,EAAK,GAAG6uB,QAE5C,MACJ,KAAK,gBACD,GAAIlE,EAAK7nB,WAAWw4B,YAAY9jB,QAAS,CACxC,GAAIp+B,IAAQuxC,EAAK7nB,WAAWkO,UAAY,EAAIhR,EAAK,GAAG5mB,MAChDD,GAAWwxC,EAAK7nB,WAAWkO,UAAY,EAAIhR,EAAK,GAAG7mB,SAC9Cm+E,GAAgB,WAClB,GAAItP,IAAc92C,MAAMlR,EAAK,GAAG6uB,QAAS3O,MAAMlgB,EAAK,GAAGmvB,OAAQvzC,EAAEm6C,WAAW/1B,EAAK,GAAGpkB,GAAIiB,EAAEk5C,WAAW/1B,EAAK,GAAGnjB,GAO7G,OANG8tC,GAAK7nB,WAAW6Q,cAAc,KAC7BgX,EAAK7nB,WAAW6Q,cAAc,GAAGkb,QAAU7uB,EAAK,GAAG6uB,QACnDlE,EAAK7nB,WAAW6Q,cAAc,GAAGwb,OAASnvB,EAAK,GAAGmvB,OAClDxE,EAAK7nB,WAAW6Q,cAAc,GAAG/3B,EAAIokB,EAAK,GAAGpkB,EAC7C+uC,EAAK7nB,WAAW6Q,cAAc,GAAG92B,EAAImjB,EAAK,GAAGnjB,GAE1C8tC,EAAKoxB,eAAepxB,EAAK7nB,WAAWw4B,YAAa0sB,EAAY7uE,GAAU,MAAM,EAAMC,IAAOrH,KAAK,WAClG44C,EAAK7nB,WAAWw4B,YAAY9jB,SAAU,GACrCmT,EAAK7nB,WAAWw4B,YAAY6tB,UAAYx+B,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWw4B,gBAGpGi8B,GAAc,WAChB,MAAO5sC,GAAKoxB,eAAepxB,EAAK7nB,WAAWw4B,YAAYp+C,OAAQtB,EAAEokB,EAAK,GAAGivB,OAAQpyC,EAAEmjB,EAAK,GAAGkvB,QAAS/1C,GAAU,MAAM,EAAMC,IAAOrH,KAAK,WAClI44C,EAAK7nB,WAAWw4B,YAAY9jB,SAAU,GACrCmT,EAAK7nB,WAAWw4B,YAAY6tB,UAAYx+B,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWw4B,eAG1Gg8B,OAAmBC,KAEvB,KACJ,KAAK,eACJ,GAAM5sC,EAAK7nB,WAAWkO,WA4ClB,GAAG2Z,EAAK7nB,WAAWqS,aAAa98B,KAAK,CAE9B,GAAIA,IAAO2nB,EAAK,GAAG3nB,MAAQ2nB,EAAK,GAAG3nB,OAAQ,CACvCA,MAAOsyC,EAAK7nB,WAAWqS,aAAa98B,KAAOA,SA/CzB,CAI1B,GAHqB,YAAjB2nB,EAAK,GAAGn2B,MACR6hF,EAAa1rD,EAAK,GAAG7mB,SAAU6mB,EAAK,GAAG5mB,MAAO4mB,EAAK,GAAG9yB,OAErC,UAAjB8yB,EAAK,GAAGn2B,KAAkB,CAC1B,GAAIwO,IAAO2nB,EAAK,GAAG3nB,MAAQ2nB,EAAK,GAAG3nB,OAAQ,CAS3C,IARMA,KAAQsyC,EAAK7nB,WAAWqS,aAAa98B,MAASsyC,EAAK7nB,WAAW+f,aAAasoC,aAAc,GAC3FM,IAEJ9gC,EAAK7nB,WAAWqS,aAAa98B,KAAOA,GACpCsyC,EAAK7nB,WAAWqS,aAAaC,MAAQpV,EAAK,GAAGoV,MAC7CuV,EAAK7nB,WAAWqS,aAAah8B,SAAW6mB,EAAK,GAAG7mB,SAChDwxC,EAAK7nB,WAAWqS,aAAa/7B,MAAQ4mB,EAAK,GAAG5mB,MAC7CuxC,EAAK7nB,WAAWqS,aAAavV,SAAWA,EAAStwB,IAC5Cq7C,EAAK7nB,WAAW+f,aAAasoC,WAAanrD,EAAK,GAAG7mB,SAAU,CAC7D,GAAM+7E,IAAU,QAAVA,MACF,GAAM97E,GAAQuxC,EAAK7nB,WAAWkO,UAAY,EAAIhR,EAAK,GAAG5mB,MAChDD,EAAW6mB,EAAK,GAAG7mB,SAAW,EAAKwxC,EAAK7nB,WAAWkO,UAAY,IAAMhR,EAAK,GAAG7mB,SAAY,CAE/F,OADAwxC,GAAK7nB,WAAW+f,aAAasoC,WAAY,EAClCH,EAAWhrD,EAAK,GAAGoV,MAAwB,EAAhBpV,EAAK,GAAGoV,MAAY,GAAIj8B,EAAUC,GAAOrH,KAAK,WAE5E,MADA44C,GAAK7nB,WAAW+f,aAAasoC,WAAY,EACtCxgC,EAAK7nB,WAAWqS,aAAa98B,MAAQ2nB,EAAK,GAAGoV,MAAQ,GACjDpV,EAAK,GAAGoV,QAAUuV,EAAK7nB,WAAWqS,aAAaC,QAAOpV,EAAK,GAAGoV,MAAQuV,EAAK7nB,WAAWqS,aAAaC,OACnGpV,EAAK,GAAG7mB,WAAawxC,EAAK7nB,WAAWqS,aAAah8B,WAAU6mB,EAAK,GAAG7mB,SAAWwxC,EAAK7nB,WAAWqS,aAAah8B,UAG/G6mB,EAAK,GAAG5mB,MAAQ,EACT87E,MAEAzqF,QAAQC,YAI3BwqF,MAAUnjF,KAAK,WAEX44C,EAAK7nB,WAAW+f,aAAasoC,WAAY,KAIjC,WAAjBnrD,EAAK,GAAGn2B,OAEN8gD,EAAK7nB,WAAW+f,aAAaqqC,aAAeP,EAAO3sD,EAAK,GAAG7mB,SAAU6mB,EAAK,GAAG5mB,OAStF,KACJ,KAAK,eACEuxC,EAAK7nB,WAAW+N,WACf8Z,EAAK7nB,WAAW+N,SAASl4B,UAAYqnB,EAAK,GAAG5nB,OAC7CuyC,EAAK7nB,WAAW+N,SAASj4B,cAAgBonB,EAAK,GAAG5nB,QAEjD,QAAUxM,UAAU+L,QAAU,SAAW/L,UAAUstB,aAChDmD,EAAAA,WAAW3jB,YACV2jB,EAAAA,WAAW3jB,UAAUE,cAAgBonB,EAAK,GAAG5nB,OAC7CikB,EAAAA,WAAW3jB,UAAUC,UAAYqnB,EAAK,GAAG5nB,QAE7C4nB,EAAK,GAAG5nB,QAAU9H,EAAAA,WAAMyqB,YACxBsB,EAAAA,WAAW+1D,aAAapyD,EAAK,GAAG5nB,OAAQ4nB,EAAK,GAAG7mB,SAAU6mB,EAAK,GAAG5mB,SAElE4mB,EAAK,GAAG5nB,QAAU9H,EAAAA,WAAMyqB,YACrB4vB,EAAK7nB,WAAW+N,WACf8Z,EAAK7nB,WAAW+N,SAASgtB,aAAe,QACxClT,EAAKoxB,eAAepxB,EAAK7nB,WAAW+N,UAAWz4B,OAAQ4nB,EAAK,GAAG5nB,QAAS4nB,EAAK,GAAG7mB,SAAU,MAAM,EAAM6mB,EAAK,GAAG5mB,OAAOrH,KAAK,eAKlI,MACJ,KAAK,eACE44C,EAAK7nB,WAAWgO,WAAW9Q,EAAK,GAAG/xB,SAClC08C,EAAK7nB,WAAWgO,WAAW9Q,EAAK,GAAG/xB,OAAO0K,UAAYqnB,EAAK,GAAG5nB,OAC9DuyC,EAAK7nB,WAAWgO,WAAW9Q,EAAK,GAAG/xB,OAAO2K,cAAgBonB,EAAK,GAAG5nB,QAElE,QAAUxM,UAAU+L,QAAU,SAAW/L,UAAUstB,aAChDmD,EAAAA,WAAW1iB,WAAWqmB,EAAK,GAAG/xB,SAC7BouB,EAAAA,WAAW1iB,WAAWqmB,EAAK,GAAG/xB,OAAO0K,UAAYqnB,EAAK,GAAG5nB,OACzDikB,EAAAA,WAAW1iB,WAAWqmB,EAAK,GAAG/xB,OAAO2K,cAAgBonB,EAAK,GAAG5nB,QAEjE4nB,EAAK,GAAG5nB,QAAU9H,EAAAA,WAAMwqB,YACxBuB,EAAAA,WAAWm7D,aAAax3D,EAAK,GAAG/xB,MAAO+xB,EAAK,GAAG5nB,OAAQ4nB,EAAK,GAAG7mB,SAAU6mB,EAAK,GAAG5mB,SAEjF4mB,EAAK,GAAG5nB,QAAU9H,EAAAA,WAAMwqB,YACrB6vB,EAAK7nB,WAAWgO,WAAW9Q,EAAK,GAAG/xB,SAClC08C,EAAK7nB,WAAWgO,WAAW9Q,EAAK,GAAG/xB,OAAO4vD,aAAe,QACzDlT,EAAKoxB,eAAepxB,EAAK7nB,WAAWgO,WAAW9Q,EAAK,GAAG/xB,QAASmK,OAAQ4nB,EAAK,GAAG5nB,QAAS4nB,EAAK,GAAG7mB,SAAU,MAAM,EAAM6mB,EAAK,GAAG5mB,OAAOrH,KAAK,WACvI44C,EAAK7nB,WAAWgO,WAAW9Q,EAAK,GAAG/xB,OAAOmK,OAASuyC,EAAK7nB,WAAWgO,WAAW9Q,EAAK,GAAG/xB,OAAO0K,UAAYrI,EAAAA,WAAMwqB,eAI3H,MACJ,KAAK,YACD6vB,EAAK7nB,WAAW04B,eAAexoD,EAAQgtB,GAAMjuB,KAAK,SAACgD,GAC/C,MAAGA,MAAO,EAMCrK,EAAQuvD,OALftP,GAAK7nB,WAAWk5B,eAAehpD,EAASgtB,GAAK,EAAM,WAC/C,MAAOt1B,GAAQuvD,MAO3B,MACJ,KAAK,OACJ,MAAItP,GAAK7nB,WAAWkO,WAAa2Z,EAAK7nB,WAAW6/B,iBAAmB/iC,EAAStwB,GAAG8E,MACzEu2C,EAAK7nB,WAAW6/B,eAAiB/iC,EAAStwB,GAAG8E,MAC7CoE,EAAO9N,EAAQuvD,MAEnBzhD,EAAO87E,EAASt0D,EAAK,GAAG3W,OAASxf,KAAM,IAAKkI,KAAK,WAC7C,MAAG44C,GAAK7nB,WAAWs2B,aAAe16B,GAE9B/D,KACA3U,OAAO8d,OAAOnJ,EAAQgwB,EAAK7nB,WAAWgV,YACtC+X,EAAQlF,EAAK7nB,WAAWwc,aACxB5gB,KACA1Y,OAAO8d,OAAOpF,EAAQisB,EAAK7nB,WAAWs2B,YACtC9pD,EAAKq7C,EAAK7nB,WAAWu2B,YACd3uD,GAAQ,IAEfA,EAAQuvD,KAEpB,KAAK,OAGD,MAFAtP,GAAK7nB,WAAW9vB,QAAUyB,KAAKkB,MAAMlB,KAAKC,UAAUi2C,EAAK7nB,WAAW9vB,UACpE23C,EAAK23B,aAAa33B,EAAK7nB,WAAW9vB,QAAS23C,EAAK7nB,WAAWgV,WAAY6S,EAAK7nB,WAAWwc,aAAc,OAAQtf,EAAK,KAClHxnB,EAAO9N,GAAQ,GACnB,KAAK,OAGD,MAFAigD,GAAK7nB,WAAW9vB,QAAUyB,KAAKkB,MAAMlB,KAAKC,UAAUi2C,EAAK7nB,WAAW9vB,UACpE23C,EAAK23B,aAAa33B,EAAK7nB,WAAW9vB,QAAS23C,EAAK7nB,WAAWgV,WAAY6S,EAAK7nB,WAAWwc,aAAc,SACrG9mC,EAAO9N,GAAQ,GACnB,KAAK,SAED,MADAigD,GAAK23B,aAAa33B,EAAK7nB,WAAW9vB,QAAS23C,EAAK7nB,WAAWgV,WAAY6S,EAAK7nB,WAAWwc,aAAc,aAActf,EAAK,KACxHxnB,EAAO9N,GAAQ,GACnB,KAAK,UASD,MARAmqF,IAAY,EACPlqC,EAAK7nB,WAAWs3B,aAAgBzP,EAAK7nB,WAAWs3B,YAAYra,SAC7D4K,EAAK7nB,WAAWs3B,YAAczP,EAAKnS,cAAcj8B,KAAKlR,IAAI69C,SAE9DyB,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWs3B,aACzDzP,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWi4B,gBACzDm2B,GAAgB,EAAO/kC,GACvBxB,EAAK7nB,WAAWiO,cAAgB4Z,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWmO,iBACzFz4B,EAAOlI,EAAAA,WAAM8E,QAAQ,KAAKrD,KAAK,WAC3B,MAAO09E,GAAWzvD,EAAM,MAAMjuB,KAAK,SAAA0lF,GAI/B,MAHAx9B,GAAOpwD,KAAO,UACdowD,EAAOhsD,MAAQwpF,EAAIxpF,MACnBV,EAAA8tB,iBAAiBq8D,uBAAuB93D,EAAUtwB,EAAG2qD,EAAOhsD,OACrDvD,EAAQuvD,OAG3B,KAAK,mBAKD,MAJA46B,IAAY,EACPlqC,EAAK7nB,WAAWs3B,aAAgBzP,EAAK7nB,WAAWs3B,YAAYra,SAC7D4K,EAAK7nB,WAAWs3B,YAAczP,EAAKnS,cAAcj8B,KAAKlR,IAAI69C,UAE9D1wC,EAAOi3E,KAAezvD,GAAMjuB,KAAK,SAAA0lF,GAK7B,MAJiB,KAAbA,EAAI5tF,OACPowD,EAAOpwD,KAAO,cAEf0D,EAAA8tB,iBAAiBq8D,uBAAuB93D,EAAUtwB,EAAgB,IAAbmoF,EAAI5tF,KAAa4tF,EAAIxpF,UACnEvD,EAAQuvD,KAEvB,KAAK,aACJA,EAAOpwD,KAAO,aACXowD,EAAOzB,KAAO7N,EAAK7nB,WAAW0vB,WAAWC,SAAS/zB,EAAQkB,SAAStwB,GAAG0wB,KAAK,GAAIhtB,EAC/E,MACJ,KAAK,aACJinD,EAAOpwD,KAAO,aACXowD,EAAOzB,KAAO7N,EAAK7nB,WAAW0vB,WAAWC,SAAS/zB,EAAQkB,SAAStwB,GAAG0wB,KAAK,GAAIhtB,EAC/E,MACJ,KAAK,iBACD,GAAI23C,EAAK7nB,WAAW6V,UAAUkV,kBAAoBlD,EAAK7nB,WAAW6V,UAAUkV,iBAAiBC,eAAgB,CACzG,GAAqB,IAAjB9tB,EAAK,GAAGn2B,KACR,MAAK8gD,GAAK7nB,WAAW0sB,WAAWxvB,EAAK,GAAG/xB,QAUxCuK,EAAO/N,QAAQC,cATX8N,EAAOnD,EAAAA,WAAOsN,KAAK,wBAAwB5Q,KAAK,WAE5C,MADA44C,GAAK7nB,WAAWq4B,QAAQxQ,EAAK7nB,WAAWg8B,YACjCr0D,QAAQC,aAChB,WAEC,MADAigD,GAAK7nB,WAAWq4B,QAAQxQ,EAAK7nB,WAAWg8B,YACjCr0D,QAAQC,cAMD,KAAjBs1B,EAAK,GAAGn2B,OACb8gD,EAAK7nB,WAAW8U,UAChB+S,EAAK7nB,WAAW6qB,WAAW3tB,EAAK,GAAG/xB,OAAO,IAGlD,KACJ,KAAK,WACD08C,EAAK7nB,WAAW+Q,aAAe7T,EAAK,EACpC,MACJ,KAAK,UACG,SAAWA,EAAK,GAChB2qB,EAAK7nB,WAAWwpB,aAAa9U,SAAU,EAGvCo5C,EAAW5wD,EAAK,GAEpB,MAC5B,KAAK,oBACJ2qB,EAAK7nB,WAAW9vB,QAAQqvC,kBAAoBriB,EAAK,EACjD,MACuB,KAAK,aAED,GAAI23D,IAAKhC,EAAU31D,EAAK,GAAG/xB,MAI3B,IAHA08C,EAAK7nB,WAAW2pB,gBAAgBkrC,IAChCA,GAAKhC,EAAU31D,EAAK,GAAG/xB,OACvBmoF,IACGuB,QAAU,CAET,GAAM/B,IAAUjrC,EAAK7nB,WAAW0S,iBAAiBmiD,IAAIjrC,WAAW54B,QAChE62B,GAAK7nB,WAAWyqB,YAAYxiD,YAAY4/C,EAAK7nB,WAAW0S,iBAAiBmiD,KACzEhtC,EAAK7nB,WAAW0S,iBAAiBmiD,IAAInyE,SACrC,IAAIvY,IAAS09C,EAAK29B,gBAAgB39B,EAAK7nB,WAAWyqB,YAAY3tB,EAAStwB,GACvEq7C,GAAK7nB,WAAW0S,iBAAiB5tB,OAAO+vE,GAAG,GAC3ChtC,EAAK7nB,WAAW0S,iBAAiBppB,KAAKnf,IACtCA,GAAOy/C,WAAakpC,GAAQ9hE,SAC5B7mB,GAAOuqC,SAAU,EACjBvqC,GAAOw7E,WAAa,EACpBx7E,GAAO4/C,WAAY,EACnBioC,EAAY7nF,EACZ,IAAM8oF,IAAY,QAAZA,MAAqB,GAARzmF,GAAQrF,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAJ,CACnB,OAAGqF,IAAKwlF,EAAUpoC,WAAWxiD,OAClBO,QAAQC,UAERigD,EAAKy+B,aAAa0L,EAAUpoC,WAAWp9C,GAAGwlF,GAAW/iF,KAAK,SAACkJ,GAE9D,MADA3L,KACOymF,GAAUzmF,KAI7B,QAAAkJ,EAAOu9E,KAAYhkF,KAAK,WAA8C,MAAxCm/E,IAAgB,EAAO/kC,GAAwBzhD,EAAQuvD,MAErF,GAAIhtD,IAAS09C,EAAK29B,gBAAgB39B,EAAK7nB,WAAWyqB,YAAY3tB,EAAStwB,GAKvE,OAJAq7C,GAAK7nB,WAAW0S,iBAAiBppB,KAAKnf,IACtCA,GAAO4/C,WAAY,EACnBioC,EAAY7nF,GACZikF,GAAgB,EAAO/kC,IACvB3zC,EAAO9N,EAAQuvD,GAEvB,KAAK,aAED,GAAG66B,EAAUloC,UAAW,EAAK,CACzB,GAAMgrC,IAAS,WACX,IAAI,GAAItoF,GAAIq7C,EAAK7nB,WAAW0S,iBAAiBtrC,OAAQ,EAAEoF,GAAK,EAAEA,IAAI,CAC9D,GAAIuoF,GAAaltC,EAAK7nB,WAAW0S,iBAAiBlmC,EAClD,IAAGuoF,GAAaA,EAAUjrC,UAAW,EAGjC,MAFAwpC,KACAyB,EAAUhrC,WAAY,EACfgrC,EAGf,MAAO,OAEPC,GAAUF,IACXE,MACChD,EAAYgD,IAGpB,GAAM5c,IAAUvwB,EAAK7nB,WAAWi4B,eAAejhB,SAAS5vC,OAAS,EAC3D6tF,GAAW,SAACC,GACd,GAAMzwB,GAAU,QAAVA,GAAW3qD,EAAG7F,GAChB,KAAIA,GAAKA,EAAEk1D,cAAgBhnD,OAAOinD,YAAYC,QAAuB,IAAbp1D,EAAE6xD,QAAgB,SAAWhsD,GAAKs+D,IAI1F,MADAvwB,GAAK7nB,WAAW+f,aAAaC,iBAAiBp7B,OAAO6/C,GACjD,eAAiB3qD,EACVjS,IAEAD,EAAQstF,EAAKA,EAAK/9B,GAGjCtP,GAAK7nB,WAAW+f,aAAaC,iBAAiBz3C,IAAIk8D,IACjD2T,IAAWvwB,EAAK7nB,WAAWy/B,UAAUyX,OAAOrT,QAAQ,WAAO,MAAOj8D,GAAQuvD,KAE/E,OAAGpe,IAAYg5C,GAEXkD,GAAS99B,GACT66B,EAAU7L,OAAS,SAAChuE,GAChB,MAAGA,IAAKA,IAAM65E,OACVA,EAAU7L,QAAU6L,EAAU7L,UAEvBv+E,EAAQuvD,IAGvB46B,GAAY,GACZr8E,EAAA,UAEJmyC,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWyqB,aACzD5C,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWi4B,gBACzDm2B,GAAgB,EAAO/kC,GACvBxB,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAW6U,WACzDgT,EAAK7nB,WAAWiO,cAAgB4Z,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWmO,gBACzF0Z,EAAK7nB,WAAWyqB,YAAYotB,cAAcz0D,QAAQ,SAACwZ,EAAEpwB,GAAOowB,EAAEre,MAAK,KACnEspC,EAAK7nB,WAAWyqB,YAAYotB,cAAc/yD,OAAO,IACjDpP,EAAOmyC,EAAKy+B,aAAaxpD,EAAStwB,GAAGwlF,GAAW/iF,KAAK,SAACwsC,GAElDoM,EAAK7nB,WAAW4S,oBAAoBtpB,KAAKwT,EAAStwB,GAAG8E,MACrD0gF,EAAUpoC,WAAWtgC,KAAKwT,EAAStwB,IACnCwlF,EAAUnoC,UAAUvgC,KAAKwT,EAAStwB,GAClC,IAAM6vE,GAAc,WAChB,MAAO,IAAI10E,SAAQ,SAACC,EAAQC,GACxB,MAAGq1B,GAAK,GAAG4tD,UACuB,WAA3B5tD,EAAK,GAAG4tD,UAAU/jF,KACV8gD,EAAK09B,iBAAiB9pC,GAASrN,MAAO,GAAIlR,EAAK,GAAG4tD,UAAUz0E,SAAU,MAAM,EAAM6mB,EAAK,GAAG4tD,UAAUx0E,OAAOrH,KAAK,WAEnH,MADAwsC,GAAOrN,MAAQ,EACRxmC,MAHf,OAOOA,MAgBnB,OAZAoqF,GAAU7L,OAAS,SAAChuE,GAChB,GAAGA,GAAKA,IAAM65E,EACVA,EAAU7L,QAAU6L,EAAU7L,aAE9B,KAAOt+B,EAAK7nB,WAAW+Q,eAAmBqnC,KAAavwB,EAAK7nB,WAAWkO,YAAa2Z,EAAK7nB,WAAW9vB,QAAQ0vC,OAAYiI,EAAK7nB,WAAWoT,UACpI,MAAOxrC,GAAQuvD,MAIpBtP,EAAK7nB,WAAW+Q,eAAmBqnC,KAAavwB,EAAK7nB,WAAWkO,YAAa2Z,EAAK7nB,WAAW9vB,QAAQ0vC,OAAYiI,EAAK7nB,WAAWoT,YACpI6hD,KAEG5Y,IAAcptE,KAAK,YACjB44C,EAAK7nB,WAAW+Q,eAAmBqnC,KAAavwB,EAAK7nB,WAAWkO,YAAa2Z,EAAK7nB,WAAW9vB,QAAQ0vC,OAAYiI,EAAK7nB,WAAWoT,UAIlI6hD,GAAS99B,GAFT7sD,WAAW,WAAK,MAAO1C,GAAQuvD,IAAU,UAMzD,KAAK,aAED,GAAMpW,IAAK8xC,EAAU31D,EAAK,GACvB6jB,WACC8G,EAAK7nB,WAAW0S,iBAAiBqO,IAAIrM,SAAU,EAC/CmT,EAAK7nB,WAAW0S,iBAAiBqO,IAAI+I,QAAS,MA9rBxC,OAAA,YAAA,mBAAA0pC,GAAA,YAAAv6B,EAAAu6B,IAAAA,EAAA99E,EAksBM,cAArBonB,EAAStwB,GAAGzF,KAA6Ba,EAAQuvD,GAApD,UAIjBs8B,EAAc,QAAdA,GAAe73D,EAASzwB,GAC7B,MAAO08C,GAAKywB,qBAAqBpoE,EAAS2nB,EAASk1B,EAAOnxB,EAASzwB,GAAO8D,KAAK,WAAA,MAAMmjB,GAAOwJ,EAASzwB,GAAO8D,KAAK,SAAAgM,GAEhH,GADqB4sC,EAAK7nB,WAAW2/B,mBAAqB,KACtD1kD,GAAK/K,IAAY23C,EAAK7nB,WAAW9vB,SAAW23C,EAAK7nB,WAAWoS,iBAAkB,EAAO,CAAA,GAAA+iD,GACnCttC,EAAK7nB,WAAWk3B,eAAehnD,EAAS0rB,EAASzwB,EAAO8P,GAAzEkjC,EADoDg3C,EACzDh3C,KAAiB3xC,EADwC2oF,EAC9ChqF,KAClBgzC,IAAQA,EAAKrhB,SAAStwB,GAAKinF,EAAYt1C,EAAM3xC,GAAKq7C,EAAK23B,aAAatvE,EAAS2nB,EAASk1B,QAKlGlF,GAAK7nB,WAAWo4B,cAAgBvQ,EAAK7nB,WAAWo4B,aAAa11C,UAC7DmlC,EAAK7nB,WAAWo4B,aAAevQ,EAAK7nB,WAAW+f,aAC/Ct1C,EAAA8tB,iBAAiB6iC,gBAAiBr0D,KAAM,gBAAiB0N,IAAKozC,EAAK7nB,WAAWqrB,eAC7FxD,EAAK7nB,WAAW+Q,cAAe,EAChB8W,EAAK7nB,WAAW6Q,iBAC/BgX,EAAK7nB,WAAW4/B,kBAAoB6zB,EACrBvH,EAAcrkC,EAAK7nB,WAAW+f,aAE7C,IAAInkB,IAAWkB,SAAUT,EAAKS,SAAUK,WAAY,KAAMC,mBACtDQ,EAAW,EACMw3D,EAAY,WACdvtC,EAAK+zB,eAAe/zB,EAAK7nB,WAAW6V,UAAUC,SAASpK,KAAK8L,YAC5D5b,GAAWA,EAAQkB,SAASc,GAAY61D,EAAY73D,EAASgC,GAAYiqB,EAAK23B,aAAatvE,EAAS2nB,EAASk1B,GAE5HprB,IAAeA,EAAY/F,SACZisB,EAAK7nB,WAAW9vB,QAAQqvC,kBAAoBljB,EAAKkjB,kBAAoBljB,EAAKkjB,kBAAoBsI,EAAK7nB,WAAW9vB,QAAQqvC,kBACxI3jB,EAAU+F,EAAY/F,QACtBgC,EAAW+D,EAAY/D,SACnBhC,EAAQkB,SAASc,IAAiD,aAApChC,EAAQkB,SAASc,GAAU72B,MAC5D62B,IAEqBhC,EAAQkB,SAASc,IAAiD,mBAApChC,EAAQkB,SAASc,GAAU72B,MACzD62B,IAEJq0D,EAAetwD,EAAYyZ,cAAexf,EAAQkB,SAAUc,EAAS+D,EAAYiqB,aAAejqB,EAAYiqB,aAAe,MAAM38C,KAAK,WAElI,GADlB8iF,GAAY,GACWn2D,EAAQkB,SAASc,GAAW,CAAA,GAAAy3D,GACPxtC,EAAK7nB,WAAWk3B,eAAehnD,EAAS0rB,EAASgC,EAAS,GAAI72B,KAAK,WAAlFo3C,EADsBk3C,EACtBl3C,KAAMhzC,EADgBkqF,EAChBlqF,KACbywB,GAAUuiB,EACVvgB,EAAWzyB,EAEfiqF,QAGJvtC,EAAK7nB,WAAW9vB,QAAQqvC,kBAAoBljB,EAAKkjB,kBAAoBljB,EAAKkjB,mBAAqBzQ,MAAM,EAAOz3B,MAAM,GAClH+9E,KA+BR,IA1BZvtC,EAAK7nB,WAAW+R,eAAgB,EACpB8V,EAAK7nB,WAAW+f,aAAe8H,EAAKnS,cAAcj8B,KAAKlR,IAAI69C,QAC3DyB,EAAK7nB,WAAW+f,aAAai5B,qBAAsB,EACnDnxB,EAAK7nB,WAAW+f,aAAasoC,WAAY,EACzCxgC,EAAK7nB,WAAW+f,aAAaqqC,aAAc,EAC3CviC,EAAK7nB,WAAW+f,aAAap6C,KAAO,YACpCkiD,EAAK7nB,WAAWgd,oBAAsB6K,EAAK7nB,WAAWgd,mBAAmBt6B,UACzEmlC,EAAK7nB,WAAWgd,mBAAqB6K,EAAKnS,cAAcj8B,KAAKlR,IAAI69C,QACjEyB,EAAK7nB,WAAWgd,mBAAmBr3C,KAAO,qBAC1CkiD,EAAK7nB,WAAWs3B,aAAezP,EAAK7nB,WAAWs3B,YAAY50C,UAC3DmlC,EAAK7nB,WAAWs3B,YAAczP,EAAKnS,cAAcj8B,KAAKlR,IAAI69C,QAE1DyB,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAW+f,cACzD8H,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWgd,oBACzD6K,EAAKnS,cAAcj8B,KAAKshC,MAAM6V,WAAW/I,EAAK7nB,WAAWw4B,aAEzDmwB,IAGP5vC,IACW8O,EAAK7nB,WAAWy3B,gBAAgB5P,EAAK7nB,WAAWi4B,gBAChDpQ,EAAK7nB,WAAWu3B,gBAAgB1P,EAAK7nB,WAAWi4B,gBAChDpQ,EAAK7nB,WAAWi4B,eAAexH,WAAU,GACzC5I,EAAK7nB,WAAWkQ,UAAUprB,OAAO,EAAG+iC,EAAK7nB,WAAWkQ,UAAU9oC,QAC9DygD,EAAKq2B,cAAcr2B,EAAK7nB,WAAWoQ,gBAEpC2I,GAAapX,GAAeA,EAAY/F,UAEpCisB,EAAK7nB,WAAW2S,qBAAqBvrC,OAAS,EAAE,CAC/CygD,EAAK7nB,WAAW0S,mBAChB,KAAI,GAAIr5B,GAAI,EAAEA,EAAIwuC,EAAK7nB,WAAW2S,qBAAqBvrC,OAAOiS,IAAI,CAC9D,GAAMi8E,GAAYztC,EAAK7nB,WAAW2S,qBAAqBt5B,GAAG0iC,WACtD5xC,EAAS09C,EAAK29B,gBAAiB,KAAM8P,EACzCnrF,GAAOy/C,WAAa/B,EAAK7nB,WAAW2S,qBAAqBt5B,GAAGoiC,OAAOzqB,SACnE7mB,EAAO0/C,UAAYhC,EAAK7nB,WAAW2S,qBAAqBt5B,GAAGwwC,UAAU74B,SACrE7mB,EAAO2/C,OAASjC,EAAK7nB,WAAW2S,qBAAqBt5B,GAAGywC,OACxD3/C,EAAO4/C,UAAYlC,EAAK7nB,WAAW2S,qBAAqBt5B,GAAG0wC,UAC3DlC,EAAK7nB,WAAW0S,iBAAiBppB,KAAKnf,GAE1C09C,EAAK7nB,WAAW2S,wBAIxBkV,EAAK7nB,WAAW4gB,YAAcvkB,EAC9BwrB,EAAK7nB,WAAWgV,WAAand,EAC7BgwB,EAAK7nB,WAAWwc,aAAeuQ,EACvC1wB,EAAKS,SACRg1D,IAGAF,IAIFvnD,KACStkC,KAAKi6B,WAAWiO,cAAgBloC,KAAK2vC,cAAcj8B,KAAKshC,MAAM6V,WAAW7qD,KAAKi6B,WAAWmO,iBAGnGonD,QAAS,SAAUC,GAAO,GAAAvrC,GAAAlkD,IAChBA,MAAKi6B,WAAW0S,iBAAiBtvB,QAAQ,SAACjL,EAAE3L,GACxCy9C,EAAKjqB,WAAW2pB,gBAAgBn9C,IAC/BgpF,IAAUr9E,EAAE2xC,QAAS,KAEtB/jD,KAAKi6B,WAAWyqB,YAAYzT,SAAS5vC,OAAS,GAC9CrB,KAAKi6B,WAAWyqB,YAAYgG,WAAU,GAEnD1qD,KAAKi6B,WAAWqe,WAAW3J,SAAU,EACrC3uC,KAAK2vC,cAAcj8B,KAAKooD,MAAMqV,OAAOzmB,YACrC1qD,KAAKi6B,WAAWw4B,YAAY9jB,SAAU,EACtC3uC,KAAKi6B,WAAW6U,UAAUH,SAAU,EACpC3uC,KAAKi6B,WAAWy/B,UAAUyX,OAAOzmB,YACxB1qD,KAAKi6B,WAAWkQ,UAAUprB,OAAO,EAAG/e,KAAKi6B,WAAWkQ,UAAU9oC,QACvErB,KAAKi6B,WAAWqd,oBAGjBmiC,aAAc,SAAUtvE,EAAS2nB,EAASk1B,EAAOhmD,EAAM2uD,GAAqB,GAAAtL,GAAArkD,KAAhB4vD,EAAgBxuD,UAAAC,OAAA,GAAAC,SAAAF,UAAA,IAAAA,UAAA,EACxEpB,MAAKi6B,WAAWoS,eAAgB,CADwC,IAG1DlW,GAAUhsB,EAAVgsB,MAH0Du5D,EAI0B1vF,KAAKi6B,WAAWy1B,YAAYvlD,EAAS2nB,EAASk1B,EAAOhmD,EAAM2uD,EAAKC,GAAvJ7I,EAJ6D2oC,EAItE59D,QAAmBm9B,EAJmDygC,EAInDzgC,OAAQrzB,EAJ2C8zD,EAI3C9zD,YAAsB+zD,EAJqBD,EAI9BvlF,QAAqB0lD,EAJS6/B,EAIT7/B,cAAeC,EAJN4/B,EAIM5/B,iBAClE8/B,EAAS,WACX,GAAG3gC,EAAO5tD,QAAU,GAAG,CAEnB,GAAI+D,MACEyqF,EAAe,SAACC,GAMlB,MALA/oC,GAASpwB,MAAMyN,KAAK,SAAC9N,EAAKhjB,GACnBgjB,EAAK/qB,OAASukF,IACb1qF,EAAQkO,KAGTlO,EAEX6pD,GAAS4gC,EAAa5gC,GAE1B,IAAKlI,EAASpwB,MAAMs4B,GAAS,CACzB,GAAIA,OAEA,MADA5K,GAAKmrC,UACEnrC,EAAKpqB,WAAWq4B,QAAQjO,EAAKpqB,WAAWg8B,WAE9C,MAAIhH,MAgBJ,MAAe,KAAXA,GACL5K,EAAKmrC,QAAQ5zD,GAAeA,EAAY/F,aACxCwuB,GAAKo1B,aAAatvE,EAAS48C,EAAUkI,KAIrC5K,EAAKpqB,WAAWw4B,YAAY9jB,SAAU,EACtC0V,EAAKpqB,WAAW6U,UAAUH,SAAU,EAC7B0V,EAAK0rC,WAvBRlgC,KACA8/B,EAAWx5D,OAAS05B,GAApB5kC,OAAAC,EAAsCykE,EAAWx5D,QACjD25B,IAAqB6/B,EAAWv5D,UAAY05B,GAAvB7kC,OAAAC,EAA4CykE,EAAWv5D,YAH9D,IAAA45D,GAKqF3rC,EAAKpqB,WAAWy1B,YAAYvlD,EAAS2nB,EAASk1B,EAAOhmD,EAAM2uD,GAAlJ9oD,EALEmpF,EAKXl+D,QAAoBzqB,EALT2oF,EAKC/gC,OAAwBghC,EALzBD,EAKYp0D,YAA2Bs0D,EALvCF,EAK8B7lF,QAA2BgmF,EALzDH,EAK2CngC,cAAmCugC,EAL9EJ,EAK6DlgC,gBAG/E,IAFA/I,EAAWlgD,EAAGooD,EAAS5nD,EAAGu0B,EAAcq0D,EAAKN,EAAaO,EAAIrgC,EAAgBsgC,EAAIrgC,EAAmBsgC,EACrG/rC,EAAKmrC,QAAQ5zD,GAAeA,EAAY/F,SACpCo5B,KAKA,MAJIY,KACA1lD,EAAQgsB,OAAS05B,GAAjB5kC,OAAAC,EAAmCykE,EAAWx5D,QAC9C25B,IAAqB6/B,EAAWv5D,UAAY05B,GAAvB7kC,OAAAC,EAA4CykE,EAAWv5D,aAEzEiuB,EAAKo1B,aAAatvE,EAAS2nB,EAASk1B,EAAOhmD,EAAM2uD,GAcpEtL,EAAKmrC,QAAQ5zD,GAAeA,EAAY/F,QACxC,IAAI+G,GAAa,KACbyzD,EAAc,KACdC,EAAe,IACnB,IAAIn6D,IAAUw5D,EAAWx5D,MAAO,CAC5B,GAAMvT,GAAQ+sE,EAAWx5D,MAAM,OACvBn1B,EAAgB4hB,EAAhB5hB,KAAMoE,EAAUwd,EAAVxd,KACD,aAATpE,GAA+B,sBAATA,GACtB47B,EAAa57B,EACbqvF,EAAcjrF,GACE,WAATpE,EACPsvF,EAAe,SACPX,EAAWx5D,MAAM90B,QAAS4tD,IAClCqhC,EAAe,QAUvB,GAPA5rF,EAAA8tB,iBAAiB+9D,uBAAuBz+D,EAAQ6E,MAAMqwB,GAAQpqB,EAAYyzD,GAC1E3rF,EAAA8tB,iBAAiBg+D,sBAAsB1+D,EAAQ6E,MAAOqwB,GAEjC,SAAjBspC,GAA4C,WAAjBA,IACV,SAAjBA,EAA0B5rF,EAAA8tB,iBAAiBi+D,iBAAiB1pC,GAAWriD,EAAA8tB,iBAAiBk+D,mBAAmB3pC,IAG1G1C,EAAKpqB,WAAWsZ,oBAAoBwT,EAASpwB,MAAMs4B,IAEjD,CACH,GAAM0hC,GAAsBtsC,EAAKpqB,WAAWwa,uBAAuBsS,EAASpwB,MAAMs4B,GAClF0hC,GAAoBtvF,OACdgjD,EAAKwuB,aAAa8d,GAAqB,GAAM,GAAMznF,KAAK,WAAA,MAAMm7C,GAAKmtB,SAASme,EAAY5oC,EAAUkI,EAAQrzB,KAC1GyoB,EAAKmtB,SAASme,EAAY5oC,EAAUkI,EAAQrzB,OALlDyoB,GAAKpqB,WAAWsc,qBAAqBo5C,EAAY5oC,EAAUkI,EAAQrzB,IAQrEg1D,EAAkB,WAEpB,GADAvsC,EAAKmrC,UACS,IAAVxoC,EACA3C,EAAKmtB,SAASrnE,EAAS2nB,EAAS,OAC7B,CACF+9B,IACH8/B,EAAWx5D,OAAS05B,GAApB5kC,OAAAC,EAAsCykE,EAAWx5D,QAC3C25B,IAAqB6/B,EAAWv5D,UAAY05B,GAAvB7kC,OAAAC,EAA4CykE,EAAWv5D,YAH7E,IAAAy6D,GAMmExsC,EAAKpqB,WAAWy1B,YAAYvlD,EAAS2nB,EAASk1B,EAAM,EAAG,GAAY2I,GAAzH5I,EANb8pC,EAMI/+D,QAAmBm9B,EANvB4hC,EAMuB5hC,OAAQrzB,EAN/Bi1D,EAM+Bj1D,YAAsB+zD,EANrDkB,EAM4C1mF,OAC9Dk6C,GAAKpqB,WAAWsc,qBAAqBo5C,EAAY5oC,EAAUkI,EAAQrzB,IAQ5D,IAJA57B,KAAKi6B,WAAW+R,eAAgB,EAChChsC,KAAKi6B,WAAWqS,aAAa98B,MAAO,EAGhCu3C,EAASttB,KAAiC,IAA1BstB,EAASpwB,MAAMt1B,OAAc,CAC7CrB,KAAKi6B,WAAWgS,wBAAyB,CAC5C,IAAMvS,GAAcqtB,EAASptB,aAAeotB,EAASptB,aAAeotB,EAASx7C,IAE7E,IAAGvL,KAAKi6B,WAAWqT,aAAa,CAC5B,GAAMwK,GAAY,SAACnhB,GACF,OAAVA,EACInqB,EAAAA,WAAOsf,MAAM,cAAc5iB,KAAK,WAAK0nF,KAAmB,WAAKA,MAC9C,SAAVj6D,EAELnqB,EAAAA,WAAOC,OAAO,QAAQ,kDAAkD,KAAK,OAAO,MAAK,GAAOvD,KAAK,YACjG,EAAA6uC,EAAAA,YAAK,aACDC,OAAO,EACP/pC,QAAS,SAEb2iF,KACF,WACEA,OAGJ7pC,EAASpwB,MAAQA,EAAQA,KACzBi5D,KAIX,YADG5vF,MAAKi6B,WAAWge,wBAAwBve,EAAYqtB,EAAS7O,OAAO6O,EAASttB,IAAIqe,GAIxF,IAAIiP,EAAS7O,QAAW,YAAcn1C,UAAU+L,QAAU,QAAU/L,UAAU+L,QAA+B,QAArB/L,UAAU+L,OAsC3F9O,KAAKi6B,WAAWC,mBAAmBR,EAAaqtB,EAASttB,KAAKvwB,KAAK,SAACytB,GAAQ,GAAAm6D,IAC1FA,EAAA/pC,EAASpwB,OAAMpT,KAAf3G,MAAAk0E,EAAA5lE,EAAuByL,IACLi5D,KACD,SAACzmF,QACWA,EAAIiR,QAAQ,WACnB5N,EAAAA,WAAOsf,MAAM3iB,GAEQ,WAAlBpG,UAAUye,IACThV,EAAAA,WAAO4rC,KAAK,uBAAuBlvC,KAAK,WACpC1N,OAAOkR,SAAS2rC,KAAO,uDAAwDt1C,UAAUwG,KAC3F,WACEqnF,MAGJpkF,EAAAA,WAAO4rC,KAAK,4BAA4BlvC,KAAK,WAAA,MAAM0nF,MAAmB,WAAA,MAAMhB,aApDsB,CACjH,GAAM5tC,GAAQ,WACP,GAAMzJ,GAAe,SAACC,EAAUtJ,GACxBsJ,EACA6L,EAAKpqB,WAAWC,mBAAmBR,EAAaqtB,EAASttB,KAAKvwB,KAAK,SAACytB,GAAQ,GAAAo6D,EACxE1sC,GAAKpqB,WAAW4R,sBAAwB,MACxCklD,EAAAhqC,EAASpwB,OAAMpT,KAAf3G,MAAAm0E,EAAA7lE,EAAuByL,IACvBi5D,KACD,WACyB,QAArB7sF,UAAU+L,OACTtT,OAAOqE,QAAUrE,OAAOqE,OAAO44C,YAE/BjsC,EAAAA,WAAOsf,MAAM,cAEjB8kE,MAEG1hD,EACP0hD,KAEApkF,EAAAA,WAAOsf,MAAM,UACb8jE,KAGRvrC,GAAKpqB,WAAWye,cAAchf,EAAaqtB,EAAS7O,OAAQ6O,EAASttB,IAAK8e,GAEzD,MAAlBx1C,UAAUkK,KAAmC,QAArBlK,UAAU+L,OAEjC9O,KAAKi6B,WAAWC,mBAAmBR,EAAaqtB,EAASttB,KAAKvwB,KAAK,SAACytB,GAAQ,GAAAq6D,EACxE3sC,GAAKpqB,WAAW4R,sBAAwB,MACxCmlD,EAAAjqC,EAASpwB,OAAMpT,KAAf3G,MAAAo0E,EAAA9lE,EAAuByL,IACvBi5D,KACD,WACC5tC,MAGJA,SAsBd,CACM,IAAI,YAAcj/C,UAAU+L,QAAU,QAAU/L,UAAU+L,SAAWi4C,EAAS7O,OAAO,CACjF,GAAMxe,GAAcqtB,EAASptB,aAAeotB,EAASptB,aAAeotB,EAASx7C,KACvE0lF,EAAc,SAACC,GACjB,IAAI,GAAIzqF,GAAG,EAAEA,EAAI49C,EAAKpqB,WAAWiS,mBAAmB7qC,OAAOoF,IACvD,GAAGyqF,IAAU7sC,EAAKpqB,WAAWiS,mBAAmBzlC,GAAI,OAAO,CAE/D,QAAO,EAEX,IAAGzG,KAAKi6B,WAAWgS,0BAA2B,GAASglD,EAAYv3D,GAAa,CAC5E,GAAMsoB,GAAS,WACX,GAAMmvC,GAA2B,SAAC34C,EAAUtJ,GACpCsJ,EACA6L,EAAKpqB,WAAWC,mBAAmBR,EAAaqtB,EAASttB,KAAKvwB,KAAK,SAACytB,GAChE0tB,EAAKpqB,WAAWgS,wBAAyB;AACzCoY,EAAKpqB,WAAWkV,wBAAwBzV,GACxC2qB,EAAKpqB,WAAW4R,sBAAwB,KACxCkb,EAASpwB,MAAQA,EACjBi5D,KACD,WACyB,QAArB7sF,UAAU+L,OACTtT,OAAOqE,QAAUrE,OAAOqE,OAAO44C,YAE/BjsC,EAAAA,WAAOsf,MAAM,cAEjB8kE,MAEG1hD,EACP0hD,KAEApkF,EAAAA,WAAOsf,MAAM,UACb8jE,KAGRvrC,GAAKpqB,WAAWye,cAAchf,EAAaqtB,EAAS7O,OAAQ6O,EAASttB,IAAK03D,GA2B9E,YAxBAnxF,MAAKi6B,WAAWC,mBAAmBR,EAAYqtB,EAASttB,KAAKvwB,KAAK,SAACytB,GAE/D0tB,EAAKpqB,WAAWkV,wBAAwBzV,GACxCk2D,KACF,SAACzmF,GAEIk7C,EAAKpqB,WAAWgS,0BAA2B,EAC1Cz/B,EAAAA,WAAOC,OAAO,OAAO,sBAAsB,OAAO,KAAK,OAAM,GAAMvD,KAAK,WAEpE0nF,KACF,SAAClvC,GACa,WAATA,EAECM,IACc,UAATN,GAELkvC,MAGHK,EAAYv3D,IACjBsoB,OAQnB4tC,MAIXG,SAAU,WACT/vF,KAAKi6B,WAAWoZ,WAIjBkvB,WAAY,WAIXviE,KAAKoxF,iBAAkB,GAAI31F,eAAcgrC,KAAK4qD,UAAUC,MAQxD,IAAI3vF,GAAO3B,IACXA,MAAK2vC,cAAc0sB,WAAa,WACnB16D,EAAKguC,cAAc1V,WAAat4B,EAAKs4B,WACrCt4B,EAAKwkC,OAAOK,iBAAiB,GAAI/qC,eAAcgrC,KAAKC,SAAS6qD,eAC7D5vF,EAAKwkC,OAAOK,iBAAiB,GAAI/qC,eAAcgrC,KAAKC,SAAS8qD,kBAC7D7vF,EAAKwkC,OAAOK,iBAAiB,GAAI/qC,eAAcgrC,KAAKC,SAAS+qD,kBAC7D9vF,EAAKwkC,OAAOK,iBAAiB,GAAI/qC,eAAcgrC,KAAKC,SAASgrD,gBAC7D/vF,EAAKwkC,OAAOK,iBAAiB,GAAI/qC,eAAcgrC,KAAKC,SAASirD,kBAC7DhwF,EAAKwkC,OAAOK,iBAAiB,GAAI/qC,eAAcgrC,KAAKC,SAASkrD,aACzEjwF,EAAKs4B,WAAWsO,mBAMjBvoC,KAAKi6B,WAAaj6B,KAAKmmC,OAAOq8B,cAAc/mE,cAAc4qC,MAAMC,MAAMC,WAAW3lC,OAIlFixF,SAAU,WAKT7xF,KAAKoxF,iBAAiB,OAarBniD,WAAY,OASdruC,KAAM,8JC15LR,GAAApB,GAAAC,EAAA,kBACA6nC,EAAA7nC,EAAA,oCACAiF,EAAAjF,EAAA,+BACAC,GAAAA,WAAQC,QAGAC,KAAM,+CACNC,OAAQH,EAAAA,WAAQwiE,WAGhBC,0BAA2B,WACvB,OACI1mE,cAAcC,aAAa2B,sBAInC+kE,mBAAoB,SAAUl8B,GAC1B,GAAMjkC,GAAOikC,EAAKuiC,SAClB,QAAQviC,EAAKm8B,WACT,IAAK5mE,eAAcC,aAAa2B,oBAC5B2C,KAAK2yC,aAAe1wC,EAAK0wC,aACzB3yC,KAAK8xF,kBAAkB7vF,EAAKkI,WAOxCo4D,WAAY,WACRviE,KAAKi6B,WAAaj6B,KAAKmmC,OAAOq8B,cAAc/mE,cAAc4qC,MAAMC,MAAMC,WAAW3lC,KACjF,IAAM6hE,GAAgBziE,KAAKmmC,OAAOu8B,iBAAiBjnE,cAAcgrC,KAAKC,SAASC,cAAc/lC,KAC7FZ,MAAK0T,KAAO+uD,EAAc9yB,eAAiB8yB,EAAc9yB,cAAcj8B,KACvE1T,KAAK2vC,cAAgB8yB,EAAc9yB,eAGvC7F,SAAU,QAAAA,KAAY,GAAA84B,GACa5iE,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKwD,SAAhEW,EADW84B,EACX94B,SAAUD,EADC+4B,EACD/4B,WACXkoD,EAAO/xF,KAAKi6B,WAAWugB,cAAc8F,UAAU,4BAC/C9kD,EAASwE,KAAKi6B,WAAWugB,cAAc8F,UAAU,6BACvDyxC,IAAQA,EAAK7yB,iBAAiBp1B,EAASiI,QAAQ7tC,WAAWwC,IAAKojC,EAASiI,QAAQ//B,MAChFxW,GAAUA,EAAO0jE,iBAAiBr1B,EAAWiI,UAAU5tC,WAAWwC,IAAKmjC,EAAWiI,UAAU9/B,OAGhG63B,WAAY,QAAAA,KAAY,GAAAg6B,GACW7jE,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKwD,SAAhEW,EADa+5B,EACb/5B,SAAUD,EADGg6B,EACHh6B,WACXkoD,EAAO/xF,KAAKi6B,WAAWugB,cAAc8F,UAAU,4BAC/C9kD,EAASwE,KAAKi6B,WAAWugB,cAAc8F,UAAU,6BACvDyxC,IAAQA,EAAK7yB,iBAAiBp1B,EAASgI,UAAU5tC,WAAWwC,IAAKojC,EAASgI,UAAU9/B,MACpFxW,GAAUA,EAAO0jE,iBAAiBr1B,EAAWkI,QAAQ7tC,WAAWwC,IAAKmjC,EAAWkI,QAAQ//B,OAG5F23B,OAAQ,QAAAA,KAAY,GAAAssC,GACUj2E,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKwD,SAA3DQ,EADSssC,EACTtsC,OAAQC,EADCqsC,EACDrsC,QACTooD,EAAKhyF,KAAKi6B,WAAWugB,cAAc8F,UAAU,0BAC7C2xC,EAAMjyF,KAAKi6B,WAAWugB,cAAc8F,UAAU,0BACpD0xC,IAAMA,EAAG9yB,iBAAiBv1B,EAAOoI,QAAQ7tC,WAAWwC,IAAKijC,EAAOoI,QAAQ//B,MACxEigF,GAAOA,EAAI/yB,iBAAiBt1B,EAAQkI,UAAU5tC,WAAWwC,IAAKkjC,EAAQkI,UAAU9/B,OAGpF43B,QAAS,QAAAA,KAAY,GAAAo7C,GACShlF,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKwD,SAA3DQ,EADUq7C,EACVr7C,OAAQC,EADEo7C,EACFp7C,QACTooD,EAAKhyF,KAAKi6B,WAAWugB,cAAc8F,UAAU,0BAC7C2xC,EAAMjyF,KAAKi6B,WAAWugB,cAAc8F,UAAU,0BACpD0xC,IAAMA,EAAG9yB,iBAAiBv1B,EAAOmI,UAAU5tC,WAAWwC,IAAKijC,EAAOmI,UAAU9/B,MAC5EigF,GAAOA,EAAI/yB,iBAAiBt1B,EAAQmI,QAAQ7tC,WAAWwC,IAAKkjC,EAAQmI,QAAQ//B,OAGhFkgF,qBA1DJ,SA0DyBlxF,EAAKwf,GACtB,GAAM2xE,GAAYnyF,KAAKi6B,WAAWugB,cAAc8F,UAAUt/C,EAAO,YACjE,IAAGmxF,EAAU,CACT,GAAMC,GAAKD,EAAU7xC,UAAU,MACzB+xC,EAASF,EAAU7xC,UAAU,UAC7BgyC,EAAaD,EAAOrsF,KACvBwa,IAAS,EAAG4xE,EAAGpsF,MAAQ,IACtBosF,EAAGpsF,MAAQwa,EAAQ8xE,IAM/BC,YAAa,WAAY,GAAA3sF,GAAA5F,KAAAgnF,EAC6GhnF,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKwD,SAAnKjlC,EADc8iF,EACd9iF,WAAY0tC,EADEo1C,EACFp1C,OAAQxI,EADN49C,EACM59C,cAAeK,EADrBu9C,EACqBv9C,WAAYJ,EADjC29C,EACiC39C,eAAgBK,EADjDs9C,EACiDt9C,YAAaI,EAD9Dk9C,EAC8Dl9C,SAAUD,EADxEm9C,EACwEn9C,WAAYF,EADpFq9C,EACoFr9C,OAAQC,EAD5Fo9C,EAC4Fp9C,QAAS1oB,EADrG8lE,EACqG9lE,KAGpHsxE,EAAc,SAACxxF,EAAKyxF,EAAOC,EAAQC,EAAGtoF,GACxC,GAAM8nF,GAAYvsF,EAAK8N,KAAKlR,IAAI69C,OAChC8xC,GAAUp/E,EAAI4/E,EAAG5/E,EACjBo/E,EAAUn+E,EAAI2+E,EAAG3+E,EACjBm+E,EAAUvyF,KAAOoB,EAAO,YACxB4E,EAAKq0B,WAAWugB,cAAch4C,IAAI2vF,EAClC,IAAMS,GAAYhtF,EAAK8N,KAAKpC,KAAKkI,MAAM6E,cAAco0E,GAAUA,EAAS,GAClEI,EAAcjtF,EAAK8N,KAAKpC,KAAKkI,MAAM6E,cAAcq0E,GAAWA,EAAU,GACxEL,EAASzsF,EAAK8N,KAAKlR,IAAI0wB,MAAM,EAAE,EAAE0/D,EAAU,KAAKT,EACpDE,GAAOrsF,MAAQ2sF,EAAG3sF,MAClBqsF,EAAOlsF,OAASwsF,EAAGxsF,OACnBksF,EAAOzyF,KAAO,QACd,IAAIkzF,GAASltF,EAAK8N,KAAKlR,IAAI0wB,MAAM,EAAE,EAAE2/D,EAAY,KAAKV,EACtDW,GAAO9sF,MAAQ2sF,EAAG3sF,MAClB8sF,EAAO3sF,OAASwsF,EAAGxsF,OACnB2sF,EAAOlzF,KAAO,QAEd,IAAMwyF,GAAKxsF,EAAK8N,KAAKlR,IAAI+9C,SAAS,EAAE,EACpC6xC,GAAG5xC,UAAU,SAAS,IACtB4xC,EAAG3xC,SAAS,EAAG,EAAGkyC,EAAG3sF,MAAO2sF,EAAGxsF,QAC/BisF,EAAG1xC,UACH0xC,EAAGxyF,KAAO,KACVuyF,EAAU3vF,IAAI4vF,GACdU,EAAOrmC,KAAO2lC,CAEd,IAAIW,IAAa,CACjBV,GAAOt7C,cAAe,CACtB,IAAMu7C,GAAaD,EAAOrsF,MACtBwY,EAAW,CACf5Y,GAAK8N,KAAK0Y,KAAK0kB,OAAOt4B,MAAK,EAC3B,IAAM4jC,GAAS,SAAC57B,GACTA,GAAS,EAAG4xE,EAAGpsF,MAAQ,IACtBosF,EAAGpsF,MAAQwa,EAAQ8xE,EAG3BD,GAAOvhD,OAAOswB,YAAY5+D,IAAI,SAACuL,EAAI28D,GAC/BqoB,GAAa,EACbv0E,GAAaksD,EAAM33D,EAAI4/E,EAAG5/E,GAAKu/E,EAC/Bl2C,EAAO59B,GACP5Y,EAAK8N,KAAK0Y,KAAK0kB,OAAOzV,SAJ1Bz1B,GAMAA,EAAK8N,KAAK0Y,KAAK0kB,OAAOthC,KAAK,GAAG,WACvBujF,IACCv0E,GAAa5Y,EAAK8N,KAAKooD,MAAM/oD,EAAI4/E,EAAG5/E,GAAKu/E,EACtC9zE,GAAW,IAAGA,EAAW,GACzBA,GAAW,IAAGA,EAAW,GAC5B49B,EAAO59B,KALf5Y,GASAA,EAAK8N,KAAKooD,MAAM+U,KAAKruE,IAAI,WAClBuwF,IACI1oF,GAASA,EAASmU,GACrB5Y,EAAK8N,KAAK0Y,KAAK0kB,OAAOt4B,MAAK,IAE/Bu6E,GAAa,GALjBntF,IASEotF,EAAY,SAAC3tC,EAAOstC,EAAI/yF,GAC1B,GAAM8O,GAAM9I,EAAK8N,KAAKpC,KAAKkI,MAAM6E,cAAcgnC,GAASA,EAAQ,GAC1DlP,EAAKvwC,EAAKq0B,WAAWugB,cAAcyhB,OAAO02B,EAAG5/E,EAAG4/E,EAAG3+E,EAAGtF,EAC5DynC,GAAGnwC,MAAQ2sF,EAAG3sF,MACdmwC,EAAGhwC,OAASwsF,EAAGxsF,OACfgwC,EAAGv2C,KAAOA,GAGRojE,EAAiB,SAACjwD,EAAGiB,EAAGhO,EAAOG,EAAQ3C,EAASy/D,EAASrjE,GAC3D,GAAMwgE,MACFC,EAAK,EACTA,IAAM4C,EAAQ3D,WAAa2D,EAAQ3D,WAAa,IAAM,UACtDe,GAAM4C,EAAQj+D,SAAWsJ,SAAS20D,EAAQj+D,UAAY,MAAQ,GAC9Dq7D,GAAMz6D,EAAKq0B,WAAW6V,UAAUpqC,KAAOE,EAAKq0B,WAAW6V,UAAUpqC,KAAKL,WAAa49D,EAAQ59D,WAAa49D,EAAQ59D,WAAa,GAE7H+6D,EAAU16D,KAAO26D,EACjBD,EAAUzrD,KAAOsuD,EAAQ5+D,MACzB+7D,EAAUzf,aAAe,SACzByf,EAAUxf,aAAe,SACzBwf,EAAUvrD,OAASouD,EAAQpuD,OAC3BurD,EAAUvtD,gBAAkBowD,EAAQpuD,OAAS,EAAI,CAEjD,IAAM7Q,GAAM4B,EAAK8N,KAAKlR,IAAIwP,KAAK,EAAG,EAAGxO,EAAS48D,EAAWx6D,EAAKq0B,WAAWugB,cAEzE,IADAx2C,EAAIpE,KAAOA,EACP8wC,EAAAA,WAAUrrC,WAAY,CACtB,GAAM4tF,GAAShwB,EAAQ5+D,MAAQ4+D,EAAQ5+D,MAAQ,UACzCW,EAAWi+D,EAAQj+D,SAAWsJ,SAAS20D,EAAQj+D,UAAY,GAC7DX,EAAQ,EACZ,IAAI4uF,EAAO74E,QAAQ,YAAe,CAC9B,GAAM6kD,GAAMg0B,EAAOx8E,QAAQ,OAAQ,IAAIA,QAAQ,IAAK,IAAIpE,MAAM,IAC9DhO,GAAQ,KAAOiK,SAAS2wD,EAAI,GAAI,IAAM3wD,SAAS2wD,EAAI,GAAI,IAAM3wD,SAAS2wD,EAAI,GAAI,IACpE,aAAV56D,IAAyBA,EAAQ,gBAGjCA,IAAoB,YAAX4uF,EAAuB,UAAYA,GAAQx8E,QAAQ,IAAK,KAErE,IAAMsyC,GAAKnjD,EAAKq0B,WAAW6V,UAAUpqC,KAAKI,KAAOF,EAAKq0B,WAAW+uB,sBAAsBhkD,GAAYA,EAC7FikD,EAAKrjD,EAAKq0B,WAAW6V,UAAUpqC,KAAKI,KAAOF,EAAKq0B,WAAWivB,qBAAqBlkD,GAAYA,CAClGhB,GAAIgP,OAAO+L,OAAO,EAAG/a,EAAIgP,OAAO3R,QAChC2C,EAAIgO,KAAO,IACXhO,EAAI2Q,KAAOtQ,EACXL,EAAIkoD,SAAS7nD,EAAO,GACpBL,EAAI+O,EAAIA,GAAK/M,EAAQijD,EAAKzlD,EAAQnC,QAAU,EAC5C2C,EAAIgQ,EAAIA,GAAK7N,EAAS4iD,GAAM,EAC5B/kD,EAAI+R,cAAgBkzC,GAAMzlD,EAAQnC,OAAS,GAC3CuE,EAAKq0B,WAAWkvB,mBAAmBpoD,KAAKyC,IAAWylD,EAAIF,EAAI/kD,EAAK4B,EAAKq0B,WAAW9vB,aAGhFnG,GAAI68C,cAAc9tC,EAAGiB,GAAKhQ,EAAImC,OAASmI,SAAS20D,EAAQj+D,WAAa,EAAGgB,EAAOG,EAGnF,OADA88D,GAAQnoB,SAAW92C,EAAI2qC,SAAU,GAC1B3qC,GAGLu6D,EAAY,SAACxwD,EAAKnO,EAAMoS,EAAM2sD,GAChC,GAAM9nC,KACNA,GAAEkI,OAAS4/B,EAAa5wD,EAAI+jC,UAAU9/B,KAAOjE,EAAIgxB,OAAO/sB,KACxD6kB,EAAEmI,OAAS2/B,EAAa,KAAO5wD,EAAIixB,OAAOhtB,KAC1C6kB,EAAE7kB,KAAOA,CACT,IAAMlO,GAAM8B,EAAK+pC,cAAc4uB,UAAUxwD,EAAIygD,KAAKz7C,EAC9ChF,EAAIygD,KAAKx6C,EACTjG,EAAIygD,KAAKxoD,MACT+H,EAAIygD,KAAKroD,OACTw4D,EAAa,KAAO5wD,EAAIgxB,OAAO76B,WAAWwC,IAC1Ci4D,EAAa,KAAO5wD,EAAIixB,OAAO96B,WAAWwC,IAC1CwsF,EACAr8D,EACAjxB,EAAKq0B,WAAWq/B,UAChB15D,EACAgG,EAAKq0B,WAAWugB,cAChBmkB,EAGJ,OADAA,IAAc76D,EAAIo7D,iBAAiBnxD,EAAI+jC,UAAU5tC,WAAWwC,IAAKsL,GAC1DlO,GAGLovF,EAAiB,SAACC,EAAMrzB,GACtBA,EAAQsD,cAAgBhnD,OAAOinD,YAAYC,QAA6B,IAAnBxD,EAAQC,SAGxC,6BAArBozB,EAAKtzF,OAAOD,MACZgG,EAAKkkC,WACLlkC,EAAKq0B,WAAWigB,gCAEU,+BAArBi5C,EAAKtzF,OAAOD,MACjBgG,EAAKikC,aACLjkC,EAAKq0B,WAAW4U,kCAEU,2BAArBskD,EAAKtzF,OAAOD,MACjBgG,EAAK+jC,SACL/jC,EAAKq0B,WAAWogB,8BAEU,4BAArB84C,EAAKtzF,OAAOD,MACjBgG,EAAKgkC,UACLhkC,EAAKq0B,WAAWqgB,+BAEU,yBAArB64C,EAAKtzF,OAAOD,OACjBgG,EAAKq0B,WAAWwS,aAAc,EAC9By1C,WAAWn/E,UAAU+L,OAAO/L,UAAUstB,aAAY,EAA4B,MAAtBttB,UAAUmM,SAClEtJ,EAAKq0B,WAAWsgB,2BACZ30C,EAAK+sC,eACL/sC,EAAK+sC,aAAak5B,YAAYjmE,EAAK+sC,aAAam5B,cAChDlmE,EAAK+sC,aAAe,SAK1BwD,EAAKn2C,KAAKi6B,WAAWugB,cAAcyhB,OAAO,EAAG,EAAGj8D,KAAK0T,KAAKpC,KAAKkI,MAAM6E,cAAcna,EAAWwC,MAAQxC,EAAWwC,IA4FvH,IA3FAyvC,EAAGnwC,MAAQhG,KAAK0T,KAAKshC,MAAMhvC,MAC3BmwC,EAAGhwC,OAASnG,KAAK0T,KAAKshC,MAAM7uC,OAC5BgwC,EAAGv2C,KAAO,mBACVu2C,EAAGY,cAAe,EAGlBi8C,EAAUphD,EAAO1tC,WAAWwC,IAAKkrC,EAAO4c,MACR,GAA5B5c,EAAO9wC,MAAMkR,KAAK8oC,QAClBkoB,EAAepxB,EAAO9wC,MAAM0tD,KAAKz7C,EAC3B6+B,EAAO9wC,MAAM0tD,KAAKx6C,EAClB49B,EAAO9wC,MAAM0tD,KAAKxoD,MAClB4rC,EAAO9wC,MAAM0tD,KAAKroD,OAClBnG,KAAKi6B,WAAWuO,UAAUW,SAC1ByI,EAAO9wC,MAAMkR,KACb,wBAINo3B,EAAc0R,SACdk4C,EAAU5pD,EAAcllC,WAAWwC,IAAK0iC,EAAcolB,MACjDplB,EAActoC,MAAMkR,KAAK8oC,QAC1BkoB,EAAe55B,EAActoC,MAAM0tD,KAAKz7C,EAAIq2B,EAAcolB,KAAKz7C,EACzDq2B,EAActoC,MAAM0tD,KAAKx6C,EAAIo1B,EAAcolB,KAAKx6C,EAChDo1B,EAActoC,MAAM0tD,KAAKxoD,MACzBojC,EAActoC,MAAM0tD,KAAKroD,OACzBnG,KAAKi6B,WAAWuO,UAAUY,cAC1BA,EAActoC,MAAMkR,KACpB,gCAKVy3B,EAAWqR,SACXk4C,EAAUvpD,EAAWvlC,WAAWwC,IAAK+iC,EAAW+kB,MAC3C/kB,EAAW3oC,MAAMkR,KAAK8oC,QACvBkoB,EAAev5B,EAAW3oC,MAAM0tD,KAAKz7C,EAAI02B,EAAW+kB,KAAKz7C,EACnD02B,EAAW3oC,MAAM0tD,KAAKx6C,EAAIy1B,EAAW+kB,KAAKx6C,EAC1Cy1B,EAAW3oC,MAAM0tD,KAAKxoD,MACtByjC,EAAW3oC,MAAM0tD,KAAKroD,OACtBnG,KAAKi6B,WAAWuO,UAAUiB,WAC1BA,EAAW3oC,MAAMkR,KACjB,6BAMdghF,EAAU3pD,EAAenlC,WAAWwC,IAAK2iC,EAAemlB,MACnDnlB,EAAer3B,KAAK8oC,QACrBkoB,EAAe35B,EAAemlB,KAAKz7C,EAC7Bs2B,EAAemlB,KAAKx6C,EACpBq1B,EAAemlB,KAAKxoD,MACpBqjC,EAAemlB,KAAKroD,OACpBnG,KAAKi6B,WAAWuO,UAAUa,eAC1BA,EAAer3B,KACf,gCAIVghF,EAAUtpD,EAAYxlC,WAAWwC,IAAKgjC,EAAY8kB,MAC7C9kB,EAAY13B,KAAK8oC,QAClBkoB,EAAet5B,EAAY8kB,KAAKz7C,EAC1B22B,EAAY8kB,KAAKx6C,EACjB01B,EAAY8kB,KAAKxoD,MACjB0jC,EAAY8kB,KAAKroD,OACjBnG,KAAKi6B,WAAWuO,UAAUkB,YAC1BA,EAAY13B,KACZ,6BAIL83B,EAASgR,QACVyjB,EAAUz0B,EAAU,2BAA4B9pC,KAAKi6B,WAAWuO,UAAUsB,UAAU,GAInFD,EAAWiR,QACZyjB,EAAU10B,EAAY,6BAA8B7pC,KAAKi6B,WAAWuO,UAAUqB,YAAY,GAIzFF,EAAOmR,QACRyjB,EAAU50B,EAAQ,yBAA0B3pC,KAAKi6B,WAAWuO,UAAUmB,QAAQ,GAI7EC,EAAQkR,QACTyjB,EAAU30B,EAAS,0BAA2B5pC,KAAKi6B,WAAWuO,UAAUoB,SAAS,IAIhF1oB,EAAK45B,OAAQ,CACd,GAAMykB,GAAWhB,EAAUr9C,EAAM,uBAAwBlhB,KAAKi6B,WAAWuO,UAAUtnB,KACnFq+C,GAASQ,OAAOI,UAAU39D,IAAI,WAAA,MAAMoD,GAAKq0B,WAAWq/B,WAAa1zD,EAAKq0B,WAAWq/B,UAAU9gD,SAI/F,GAAGxY,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKwD,SAASI,aAAa,CAC7D,GAAMA,GAAevpC,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKwD,SAASI,YACtEypD,GAAUzpD,EAAarlC,WAAWwC,IAAI6iC,EAAailB,MAC9CjlB,EAAav3B,KAAK8oC,QACnBkoB,EAAez5B,EAAailB,KAAKz7C,EAC3Bw2B,EAAailB,KAAKx6C,EAClBu1B,EAAailB,KAAKxoD,MAClBujC,EAAailB,KAAKroD,OAClBnG,KAAKi6B,WAAWuO,UAAUe,aAC1BA,EAAav3B,KACb,8BAId,GAAGhS,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKwD,SAASjX,YAAY,CAC5D,GAAMA,GAAclyB,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKwD,SAASjX,WACrEsgE,GAAY,QAAQtgE,EAAY6M,OAAO76B,WAAWwC,IAAIwrB,EAAY1T,SAASta,WAAWwC,IAAIwrB,EAAYs8B,KAAK,SAAChuC,GACxG5a,EAAKq0B,WAAW86B,kBAAkBv0C,KAI1C,GAAGxgB,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKwD,SAASK,aAAa,CAC7D,GAAMA,GAAexpC,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKwD,SAASK,YACtEwpD,GAAUxpD,EAAatlC,WAAWwC,IAAI8iC,EAAaglB,MAC9ChlB,EAAax3B,KAAK8oC,QACnBkoB,EAAex5B,EAAaglB,KAAKz7C,EAC3By2B,EAAaglB,KAAKx6C,EAClBw1B,EAAaglB,KAAKxoD,MAClBwjC,EAAaglB,KAAKroD,OAClBnG,KAAKi6B,WAAWuO,UAAUgB,aAC1BA,EAAax3B,KACb,8BAId,GAAGhS,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKwD,SAASlX,YAAY,CAC5D,GAAMA,GAAcjyB,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKwD,SAASlX,WACrEugE,GAAY,QAAQvgE,EAAY8M,OAAO76B,WAAWwC,IAAIurB,EAAYzT,SAASta,WAAWwC,IAAIurB,EAAYu8B,KAAK,SAAChuC,GACxG5a,EAAKq0B,WAAWg7B,kBAAkBz0C,KAI1C,GAAGxgB,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKwD,SAASG,aAAa,CAC7D,GAAMA,GAAetpC,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKwD,SAASG,YACtE0pD,GAAU1pD,EAAaplC,WAAWwC,IAAK4iC,EAAaklB,MAC/CllB,EAAaxoC,MAAMkR,KAAK8oC,QACzBkoB,EAAe55B,EAActoC,MAAM0tD,KAAKz7C,EAAIq2B,EAAcolB,KAAKz7C,EACzDq2B,EAActoC,MAAM0tD,KAAKx6C,EAAIo1B,EAAcolB,KAAKx6C,EAChDo1B,EAActoC,MAAM0tD,KAAKxoD,MACzBojC,EAActoC,MAAM0tD,KAAKroD,OACzBnG,KAAKi6B,WAAWuO,UAAUc,aAC1BF,EAActoC,MAAMkR,KACpB,+BAIdhS,KAAKi6B,WAAWugB,cAAc7L,SAAU,GAG5CmjD,kBAAmB,SAAU3nF,GAAS,GAAAyG,GAAA5Q,IACoB,KAAlDA,KAAKi6B,WAAWugB,cAAcvJ,SAAS5vC,QACvCrB,KAAKuyF,aAET,IAAMa,GAAiB,WACfxiF,EAAK8C,KAAKW,MAAMg/E,cAChBziF,EAAKk5B,WACL3/B,EAAQykC,YAAa,IAErBh+B,EAAKi5B,aACL1/B,EAAQykC,YAAa,IAGvB0kD,EAAe,WACbnpF,EAAQ0vC,KACRjpC,EAAK+4B,SAEL/4B,EAAKg5B,UAGR5pC,MAAKuzF,oBACNvzF,KAAKuzF,kBAAoBvzF,KAAK0T,KAAKW,MAAMm/E,mBAAmBhxF,IAAI,SAAA0L,GAAA,MAAKklF,SAEtEpzF,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKwD,SAASjX,aAAelyB,KAAKi6B,WAAW6V,UAAUC,SAASpK,KAAKwD,SAASlX,eAChHjyB,KAAKi6B,WAAWwS,aAAc,EAC9By1C,WAAWn/E,UAAU+L,OAAO/L,UAAUstB,aAAY,EAA2B,MAAtBttB,UAAUmM,UAErEkkF,IACAE,IACAtzF,KAAKkyF,qBAAqB,QAAQzqF,EAAAA,WAAMwqB,aACxCjyB,KAAKkyF,qBAAqB,QAAQzqF,EAAAA,WAAMyqB,aACxClyB,KAAKi6B,WAAWugB,cAAc7L,SAAU,EACxC3uC,KAAK0T,KAAKshC,MAAM6V,WAAW7qD,KAAKi6B,WAAWugB,kBAQ/C55C,KAAM","file":"build/app.js.map","sourcesContent":["// create the diygamePlayer namespace\r\nwindow.diygamePlayer =\r\n{\r\n    AppConstants: {\r\n        /** Commands */\r\n        CMD_STARTUP: \"CMD_STARTUP\",\r\n        CMD_FRAME_ENTER: \"CMD_FRAME_ENTER\",\r\n        CMD_SVG_MENU: \"CMD_SVG_MENU\",\r\n        CMD_LOAD_GAME: \"CMD_LOAD_GAME\",\r\n        CMD_UPDATE_MUSIC_STATE: \"CMD_UPDATE_MUSIC_STATE\",\r\n\r\n        /** Notification name constants */\r\n        APP_DEBUG_MODE: \"APP_DEBUG_MODE\",\r\n        APP_LOG: \"APP_LOG\",\r\n        APP_SHOW_INSPECTOR: \"APP_SHOW_INSPECTOR\",\r\n        APP_SHOW_MENUBAR: \"APP_SHOW_MENUBAR\",\r\n        APP_FPS_UPDATE: \"APP_FPS_UPDATE\",\r\n\r\n        STAGE_TRAP_MOUSE: \"STAGE_TRAP_MOUSE\",\r\n\r\n        SCENE_SHOW_ERROR: \"SCENE_SHOW_ERROR\",\r\n        SCENE_SHOW_SAVE_ALERT: \"SCENE_SHOW_SAVE_ALERT\",\r\n        SCENE_SHOW_AD: \"SCENE_SHOW_AD\",\r\n        SCENE_TOOGLE_SCREEN_STATE: \"SCENE_TOOGLE_SCREEN_STATE\",\r\n        SCENE_SKIPPING: \"SCENE_SKIPPING\",\r\n        SCENE_PRELOADING_BEGIN: \"SCENE_PRELOADING_BEGIN\",\r\n        SCENE_PRELOADING_PROGRESS: \"SCENE_PRELOADING_PROGRESS\",\r\n        SCENE_PRELOADING_COMPLETE: \"SCENE_PRELOADING_COMPLETE\",\r\n        SCENE_LOADING_BEGIN: \"SCENE_LOADING_BEGIN\",\r\n        SCENE_LOADING_PROGRESS: \"SCENE_LOADING_PROGRESS\",\r\n        SCENE_LOADING_COMPLETE: \"SCENE_LOADING_COMPLETE\",\r\n        SCENE_TEMPLATE_LOADED: \"SCENE_TEMPLATE_LOADED\",\r\n        SCENE_SHOW_LOGO: \"SCENE_SHOW_LOGO\",\r\n        SCENE_GOTO_COVERMENU: \"SCENE_GOTO_COVERMENU\",\r\n        SCENE_GOTO_MAINMENU: \"SCENE_GOTO_MAINMENU\",\r\n        SCENE_GOTO_SETTINGS: \"SCENE_GOTO_SETTINGS\",\r\n        SCENE_GOTO_PLAYBACK: \"SCENE_GOTO_PLAYBACK\",\r\n        SCENE_GOTO_RECORD: \"SCENE_GOTO_RECORD\",\r\n        SCENE_GOTO_END: \"SCENE_GOTO_END\",\r\n        SCENE_CLOSE_MENU: \"SCENE_CLOSE_MENU\",\r\n        SCENE_PLOT_ANIM_BEGIN: \"SCENE_PLOT_ANIM_BEGIN\",\r\n        SCENE_PLOT_SKIP: \"SCENE_PLOT_SKIP\",\r\n        SCENE_PLOT_CLOSED: \"SCENE_PLOT_CLOSED\",\r\n        SCENE_PLOT_LOAD_BEGIN: \"SCENE_PLOT_LOAD_BEGIN\",\r\n        SCENE_PLOT_LOAD_ASSETS_READY: \"SCENE_PLOT_LOAD_ASSETS_READY\",\r\n        SCENE_PLOT_LOAD_ASSETS_LOADED: \"SCENE_PLOT_LOAD_ASSETS_LOADED\",\r\n        SCENE_PLOT_LOAD_END: \"SCENE_PLOT_LOAD_END\",\r\n        SCENE_BACKGROUND_COLOR_UPDATE: \"SCENE_BACKGROUND_COLOR_UPDATE\",\r\n        SCENE_BACKGROUND_UPDATE: \"SCENE_BACKGROUND_UPDATE\",\r\n        SCENE_BACKGROUND_ENTERED: \"SCENE_BACKGROUND_ENTERED\",\r\n        SCENE_BACKGROUND_SWITCH: \"SCENE_BACKGROUND_SWITCH\",\r\n        SCENE_MUSIC_UPDATE: \"SCENE_MUSIC_UPDATE\",\r\n        SCENE_SOUND_UPDATE: \"SCENE_SOUND_UPDATE\",\r\n        SCENE_CHARACTER_UPDATE: \"SCENE_CHARACTER_UPDATE\",\r\n        SCENE_PROP_UPDATE: \"SCENE_PROP_UPDATE\",\r\n        SCENE_VIEW_UPDATE: \"SCENE_VIEW_UPDATE\",\r\n        SCENE_DIALOG_UPDATE: \"SCENE_DIALOG_UPDATE\",\r\n        SCENE_DIALOG_COMPLETE: \"SCENE_DIALOG_COMPLETE\",\r\n        SCENE_CHECK_IF_SKIP: \"SCENE_CHECK_IF_SKIP\",\r\n        SCENE_CLICK_ON_SCENE: \"SCENE_CLICK_ON_SCENE\",\r\n        SCENE_OPTION_UPDATE: \"SCENE_OPTION_UPDATE\",\r\n        SCENE_MENUBUTTON_UPDATE: \"SCENE_MENUBUTTON_UPDATE\",\r\n        SCENE_WEATHER_UPDATE: \"SCENE_WEATHER_UPDATE\",\r\n        SCENE_EFFECT_SHAKE: \"SCENE_EFFECT_SHAKE\",\r\n        SCENE_EFFECT_TWINKLE: \"SCENE_EFFECT_TWINKLE\",\r\n        SCENE_CLEAR: \"SCENE_CLEAR\",\r\n        SCENE_SHOW_GUIDE:\"SCENE_SHOW_GUIDE\",//显示引导层\r\n        ADD_PLAYBACK_CONTENT: \"ADD_PLAYBACK_CONTENT\",\r\n        SCENE_DESTROY_VIEW: \"SCENE_DESTROY_VIEW\",\r\n        SCENE_SHOW_INPUT_VIEW: \"SCENE_SHOW_INPUT_VIEW\"\r\n    }\r\n};\r\n","/**\r\n * @class diygamePlayer.ApplicationFacade\r\n * @extends puremvc.Facade\r\n */\r\nimport puremvc from 'puremvc';\r\npuremvc.define\r\n(\r\n\t// CLASS INFO\r\n\t{\r\n\t\tname: 'diygamePlayer.ApplicationFacade',\r\n\t\tparent: puremvc.Facade\r\n\t}, \r\n\t\r\n\t// INSTANCE MEMBERS\r\n\t{\r\n\t\t/**\r\n\t\t * A convenience method to start the PureMVC apparatus\r\n\t\t * \r\n\t\t * @return {void}\r\n\t\t */\r\n\t\tstartup: function ()\r\n\t\t{\r\n\t\t\tif (!this.initialized)\r\n\t\t\t{\r\n\t\t\t\tthis.initialized= true;\r\n\t\t\t\t// associate the SetupCommand with the STARTUP notification\r\n\t\t\t\tthis.registerCommand( diygamePlayer.AppConstants.CMD_STARTUP, diygamePlayer.controller.command.StartupCommand );\r\n\t\t\t\t// issue the SETUP notification to execute StartupCommand\r\n\t\t\t\tthis.sendNotification( diygamePlayer.AppConstants.CMD_STARTUP );\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t// STATIC MEMBERS\r\n\t{\r\n\t\t/**\r\n\t\t * Retrieve an instance of ApplicationFacade. If one has not yet been\r\n\t\t * instantiated, one will be created for you. \r\n\t\t * \r\n\t\t * @static\r\n\t\t * @param {string} multitonKey\r\n\t\t * @return demo.ApplicationFacade\r\n\t\t */\r\n\t\tgetInstance: function (multitonKey)\r\n\t\t{\r\n\t\t\t// all Facade instances, including Facade subclass instances, are stored\r\n\t\t\t// on Facade.instanceMap. When implementing you own #getInstance factory\r\n\t\t\t// method, ensure that follow the general pattern implemented here or else\r\n\t\t\t// puremvc.Facade#hasCore and puremvc.Facade#removeCore will not work if\r\n\t\t\t// you ever need to use them.\r\n\t\t\tvar instanceMap = puremvc.Facade.instanceMap;\r\n\t\t\tconst instance = instanceMap[multitonKey]; // read from the instance map\r\n\t\t\t\r\n\t\t\tif (instance) // if there is an instance...\r\n\t\t\t\treturn instance; // return it\r\n\t\t\t\r\n\t\t\t// otherwise create a new instance and cache it on Facade.instanceMap;\t\r\n\t\t\treturn instanceMap[multitonKey]= new diygamePlayer.ApplicationFacade(multitonKey);\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * @static\r\n\t\t * @type {string}\r\n\t\t */\r\n\t\tNAME: 'diygamePlayer'\r\n\t}\r\n)\r\n","/**\r\n * Created by liuE on 2016/10/10.\r\n */\r\nexport default class Dialog {\r\n\r\n    static showDialog(title, data, type, okText, cancelText,iscancle = false,cd = 0,cdtype = 0,showcancel=true) {\r\n        !this.isShow && (this.isShow = true);\r\n        const that = this;\r\n        return new Promise((resolve, reject) => {\r\n            const ok = () => {\r\n                document.body.removeChild(modalContainer);\r\n                that.isShow = false;\r\n                resolve('ok');\r\n            };\r\n\r\n            const cancel = () => {\r\n                document.body.removeChild(modalContainer);\r\n                that.isShow = false;\r\n                reject('cancel');\r\n            };\r\n\r\n            const closefun = () => {\r\n                document.body.removeChild(modalContainer);\r\n                that.isShow = false;\r\n                reject('close');\r\n            };\r\n\r\n            const modalContainer = document.createElement('div');\r\n            modalContainer.classList.add('ModalContainer');\r\n            const modalPortal = document.createElement('div');\r\n            modalPortal.classList.add('ModalPortal');\r\n            if (document.body.clientWidth <= document.body.clientHeight) {\r\n                modalPortal.style.transform = 'rotate(90deg)';\r\n            }\r\n            window.onresize = function(){\r\n                //横，竖屏时切换方向\r\n                if (document.body.clientWidth <= document.body.clientHeight) {\r\n                    flashvars.vertical ? modalPortal.style.transform = 'rotate(0)' : modalPortal.style.transform = 'rotate(90deg)'\r\n                    //modalPortal.style.transform = 'rotate(90deg)';\r\n                }\r\n                else {\r\n                    flashvars.vertical ? modalPortal.style.transform = 'rotate(90deg)' : modalPortal.style.transform = 'rotate(0)'\r\n                    //modalPortal.style.transform = 'rotate(0)';\r\n                }\r\n            }\r\n\r\n            modalContainer.appendChild(modalPortal);\r\n\r\n            const titleDiv = document.createElement('div');\r\n            titleDiv.classList.add('Title');\r\n            const titleData = document.createElement('span');\r\n            titleData.innerText = title;\r\n            const space = document.createElement('span');\r\n            //space.style.flex = 1;\r\n            space.classList.add('spaceSpan');\r\n            const close = document.createElement('span');\r\n            close.classList.add('Close');\r\n            close.innerText = '×';\r\n            close.onclick = iscancle ? closefun : cancel;\r\n            titleDiv.appendChild(titleData);\r\n            titleDiv.appendChild(space);\r\n            titleDiv.appendChild(close);\r\n            modalPortal.appendChild(titleDiv);\r\n\r\n            const content = document.createElement('div');\r\n            content.classList.add('Content');\r\n            modalPortal.appendChild(content);\r\n\r\n            const contentData = document.createElement('div');\r\n            contentData.classList.add('ContentData');\r\n            type && contentData.classList.add(type);\r\n            contentData.innerText = data;\r\n            content.appendChild(contentData);\r\n\r\n            const buttons = document.createElement('div');\r\n            buttons.classList.add('Buttons');\r\n            content.appendChild(buttons);\r\n\r\n            const buttonOk = document.createElement('button');\r\n            const buttonCancel = document.createElement('button');\r\n            buttonOk.classList.add('ButtonOk');\r\n            buttonCancel.classList.add('ButtonsCancel');\r\n            buttonOk.innerText = okText || '确定';\r\n            buttonCancel.innerText = cancelText || '取消';\r\n            buttons.appendChild(buttonOk);\r\n            if(showcancel !== false){\r\n                buttons.appendChild(buttonCancel);\r\n            }\r\n            buttonOk.onclick = ok;\r\n            buttonCancel.onclick = cancel;\r\n            document.body.appendChild(modalContainer);\r\n            //cd 时间   cdtype 按钮类型  0确认  1取消  2 全部\r\n            if(cd > 0){\r\n                const countdown = (btn,wait,txt) =>{\r\n                    if(wait <= 0){\r\n                        btn.removeAttribute(\"disabled\");\r\n                        btn.style.background = \"#3DC826\";\r\n                        btn.style.backgroundColor = \"#3DC826\";\r\n                        btn.style.border = \"#3DC826\";\r\n                        btn.style.color = \"#FFFFFF\";\r\n                        btn.innerText = txt;\r\n                    }else{\r\n                        btn.setAttribute(\"disabled\",true);\r\n                        btn.style.background = \"#8c8c8c\";\r\n                        btn.style.backgroundColor = \"#8c8c8c\";\r\n                        btn.style.color = \"#FFFFFF\";\r\n                        btn.style.border = \"#8c8c8c\";\r\n                        btn.innerText = wait;\r\n                        wait --;\r\n                        setTimeout(function() {\r\n                            countdown(btn,wait,txt)\r\n                        },1000)\r\n                    }\r\n                };\r\n                if(cdtype === 0){\r\n                    countdown(buttonOk,cd,buttonOk.innerText);\r\n                }else if(cdtype === 1){\r\n                    countdown(buttonCancel,cd,buttonCancel.innerText);\r\n                }else if(cdtype === 2){\r\n                    countdown(buttonOk,cd,buttonOk.innerText);\r\n                    countdown(buttonCancel,cd,buttonCancel.innerText);\r\n                }\r\n            }\r\n            window.onresize();\r\n        })\r\n    }\r\n\r\n    static info(data) {\r\n        if (this.isShow)    return;\r\n        return this.showDialog('提示', data, 'Info')\r\n    }\r\n\r\n    static warn(data) {\r\n        if (this.isShow)    return;\r\n        return this.showDialog('警告', data, 'Warn')\r\n    }\r\n\r\n    static error(data) {\r\n        if (this.isShow)    return;\r\n        return this.showDialog('错误', data, 'Error')\r\n    }\r\n    /**\r\n     * 自定义\r\n     * @param data          内容\r\n     * @param tileText      标题\r\n     * @param okText        确定按钮文字\r\n     * @param cancelText    取消按钮文字\r\n     * @param iscancle      X按钮是否发送时间\r\n     * @param showcancel    是否显示取消按钮\r\n     */\r\n    static custom(type,data,tileText,okText, cancelText,iscancle,cd,cdtype,showcancel = true){\r\n        if (this.isShow)    return Promise.reject();\r\n        return this.showDialog(tileText, data, type, okText, cancelText, iscancle,cd,cdtype,showcancel)\r\n    }\r\n}","import Utils from './Utils.js';\r\n\r\nexport default class FontUtils {\r\n    static isFontExist(name){\r\n        const baseFonts = ['Microsoft YaHei', 'Helvetica', 'sans-serif', 'serif'];\r\n        const testString = \"qwertyuiopasdfghjklzxcvbnm\";\r\n        const testSize = '72px';\r\n        const s = document.createElement(\"span\");\r\n        s.style.fontSize = testSize;\r\n        s.innerHTML = testString;\r\n        if (!this.defaultWidth || !this.defaultHeight) {\r\n            this.defaultWidth = {};\r\n            this.defaultHeight = {};\r\n            for (let index in baseFonts) {\r\n                s.style.fontFamily = baseFonts[index];\r\n                document.body.appendChild(s);\r\n                this.defaultWidth[baseFonts[index]] = s.offsetWidth;\r\n                this.defaultHeight[baseFonts[index]] = s.offsetHeight;\r\n                document.body.removeChild(s);\r\n            }\r\n        }\r\n\r\n        let detected = false;\r\n        for (let index in baseFonts) {\r\n            s.style.fontFamily = name + ',' + baseFonts[index];\r\n            document.body.appendChild(s);\r\n            var matched = (s.offsetWidth != this.defaultWidth[baseFonts[index]] || s.offsetHeight != this.defaultHeight[baseFonts[index]]);\r\n            document.body.removeChild(s);\r\n            detected = detected || matched;\r\n        }\r\n\r\n        return detected;\r\n    }\r\n\r\n    static mergeFontImage(font, default_font_size) {\r\n        let images = [];\r\n        if (font.size) {\r\n            if (font.size.target.width) {\r\n                this.charWidth = font.size.target.width;\r\n                this.charHeight = font.size.target.height;\r\n            }\r\n            else {\r\n                this.charWidth = font.size.target;\r\n                this.charHeight = font.size.target;\r\n            }\r\n        }\r\n        else {\r\n            this.charWidth = default_font_size;\r\n            this.charHeight = default_font_size;\r\n        }\r\n        this.widthImg = this.countPerRow * this.charWidth;\r\n        this.heightImg = this.rowPerImg * this.charHeight;\r\n\r\n        return new Promise((resolve, reject) => {\r\n            if (!font) {\r\n                return resolve();\r\n            }\r\n            //font.fontFamily = 'YouYuanY';\r\n            if (this.isFontExist(font.fontFamily)) {\r\n                return resolve();\r\n            }\r\n\r\n            FontUtils.fontFamily = font.fontFamily;\r\n            for (let i=0; i<font.images.length; i++) {\r\n                images[i] = 'https://apppic.3000test.com' + font.images[i].url;\r\n                this.fontChars += font.images[i].chars;\r\n            }\r\n\r\n            // doMerge\r\n            let c = document.createElement('canvas');\r\n            let ctx = c.getContext('2d');\r\n            let len = images.length;                    // 图片数\r\n            let nRow = Math.ceil(this.fontChars.length / this.countPerRow);    // 文字行数\r\n\r\n            c.width = this.widthImg;\r\n            c.height = nRow * this.charHeight;\r\n            //ctx.rect(0, 0, c.width, c.height);\r\n            //ctx.fillStyle='#fff';\r\n            //ctx.fill();\r\n\r\n            const drawing = (n) => {\r\n                if(n < len){\r\n                    let img = new Image;\r\n                    let srcHeight = n === len - 1 ? (nRow % this.rowPerImg) * this.charHeight : this.heightImg;\r\n                    img.src = images[n];\r\n                    img.onload = function(){\r\n                        ctx.drawImage(img, 0, 0, FontUtils.widthImg, srcHeight, 0, n*FontUtils.heightImg, FontUtils.widthImg, srcHeight);\r\n                        return drawing(n+1);\r\n                    }\r\n                }else{\r\n                    //保存生成作品图片\r\n                    let base64 = c.toDataURL(\"image/png\", 1);\r\n                    let blob = Utils.dataURLtoBlob(base64);\r\n                    let blobUrl = blob ? URL.createObjectURL(blob) : base64;\r\n                    this.fontImage = blobUrl;\r\n                    return resolve();\r\n                }\r\n            };\r\n            return drawing(0);\r\n        });\r\n    }\r\n\r\n    // 每个字符宽度\r\n    static getCharSpace(char, fontSize) {\r\n        if (/[a-zA-Z0-9]/.test(char)) {\r\n            return 14 * fontSize / 25;\r\n        }\r\n        else if ('(' === char || ')' === char) {\r\n            return 8 * fontSize / 25;\r\n        }\r\n        else if ('-' === char) {\r\n            return 11 * fontSize / 25;\r\n        }\r\n        else if ('.' === char || ':' === char) {\r\n            return 7;\r\n        }\r\n        else if (32 === char.charCodeAt(0) || 160 === char.charCodeAt(0) || '\\u2002' === char) { // 半角空格 == 半个汉字\r\n            return fontSize >> 1;\r\n        }\r\n        else {\r\n            return fontSize;\r\n        }\r\n    }\r\n\r\n    static getLeftMargin(char, fontSize) {\r\n        if (/[a-zA-Z0-9\\.\\)]/.test(char)) {\r\n            return 0;\r\n        }\r\n        else if ('(' === char || ':' === char) {\r\n            return -(4 * fontSize / 25);\r\n        }\r\n        else if ('-' === char) {\r\n            return -(fontSize / 25);\r\n        }\r\n        return 6 * fontSize / 25;\r\n    }\r\n}\r\n\r\nFontUtils.defaultWidth = undefined;\r\nFontUtils.defaultHeight = undefined;\r\nFontUtils.fontImage = undefined;\r\nFontUtils.fontChars = '';\r\nFontUtils.fontFamily = '';\r\nFontUtils.charWidth = 25;   // 字宽\r\nFontUtils.charHeight = 25;  // 字高\r\nFontUtils.countPerRow = 40; // 一行字数\r\nFontUtils.rowPerImg = 20;   // 每张图片行数\r\nFontUtils.widthImg = 1000;  // 字体图片宽\r\nFontUtils.heightImg = 500;  // 字体图片高","\r\nimport MD5 from 'spark-md5';\r\nimport Utils from \"./Utils.js\";\r\nimport * as Xhr from \"./XmlHttpRequest.js\";\r\nimport Dialog from './Dialog.js';\r\n\r\nexport default class OtherWap{\r\n    /**初始化全黑平台SDK*/\r\n    static initQHSdk(){\r\n        const loadSdkJS = (src) =>{\r\n            return new Promise((resolve,reject) =>{\r\n                let oHead = document.getElementsByTagName('head').item(0);\r\n                let oScript= document.createElement(\"script\");\r\n                oScript.type = \"text/javascript\";\r\n                oScript.src = src;\r\n                oHead.appendChild(oScript);\r\n                oScript.onload = function(){\r\n                    return resolve(\"QHSKD INIT SUCCESS\");\r\n                };\r\n            })\r\n        }\r\n        return loadSdkJS(\"//port.2r3r.com/game/qhjssdk\").then((msg)=>{\r\n            const initdata = {\r\n                \"username\":flashvars.qh_username,\t//用户id，群黑登录接口里面username参数\r\n                \"gid\":flashvars.qh_qhgid,\t//群黑游戏id，可以在后台游戏列表查询\r\n                \"qhchannel\":flashvars.qh_qhchannel,\t//用户标识，群黑登录接口里面qhchannel参数\r\n                \"qhchannelid\":flashvars.qh_qhchannelid\t//用户标识id，群黑登录接口里面qhchannelid参数\r\n            }\r\n            window.qhsdk.init(initdata);\r\n            return Promise.resolve(msg)\r\n        });\r\n    };\r\n\r\n    /**\r\n     * 发起支付\r\n     * @param price         价格\r\n     * @param goodsId       商品id\r\n     * @param indentId      随机生成唯一ID\r\n     * @param chapteruuid   章节uuid\r\n     * @param context       context\r\n     */\r\n    static pay(price, goodsId, indentId,chapteruuid,context,payindex,callback){\r\n        const sign = MD5.hash(price.toString() + flashvars.qh_username + indentId + flashvars.qh_key);\r\n        const paydata = {\r\n            \"userId\":flashvars.qh_username,\r\n            \"gid\":flashvars.qh_qhgid,\r\n            'goodsId':goodsId,\r\n            \"goodsName\":price + \"闪币\",\r\n            \"money\":price,\r\n            \"roleName\":\"3000闪艺\",\r\n            \"ext\":indentId,\r\n            \"serverId\":flashvars.qh_serverid,\r\n            \"sign\":sign\r\n        };\r\n        if(payindex ===1){context.payValues[0].name = encodeURI(context.payValues[0].name)};\r\n        const sydata = {\r\n            \"game_id\":flashvars.gid\r\n            ,\"uuid\":flashvars.uuid\r\n            ,\"chapter_uuid\":chapteruuid\r\n            ,\"amount\":price\r\n            ,\"set_value\":payindex === 0 ? \"\":Utils.encodeBase64(JSON.stringify(context.payValues))\r\n            ,\"payindex\":payindex\r\n            ,\"ext\":indentId\r\n            ,\"event_id\":goodsId\r\n            ,\"qh_username\":flashvars.qh_username\r\n            ,\"qh_qhgid\":flashvars.qh_qhgid\r\n        }\r\n        const send = (url,d)=>{\r\n            Xhr.xhrSend(url, d, null, 4000).then(rs => {\r\n                //send success\r\n            }, rj => {\r\n                //send fail\r\n            });\r\n        };\r\n        send(\"https://pay.3000.com/qunhei/paydata.php\",JSON.stringify(sydata));\r\n        //群和充值\r\n        window.qhsdk.pay(paydata,()=>{\r\n            console.log(\"群黑充值返回\")\r\n        });\r\n        Utils.timeout(200).then(()=>{\r\n            //重置返回提示\r\n            if(payindex === 0){\r\n                Dialog.custom(\"Info\",\"如果购买成功则点击继续观看作品，如果暂不购买则不能继续。\",\"是否支付成功？\",\"已支付成功\",\"暂不购买\",false).then(()=>{\r\n                    if(callback) callback(\"success\");\r\n                },()=>{\r\n                    if(callback) callback(\"cancel\");\r\n                })\r\n            }else{\r\n                Dialog.custom(\"Info\",\"若已支付成功，作品将会刷新，可读取存档继续观看。若暂不购买，将返回商城。\",\"是否支付成功？\",\"已支付成功\",\"暂不购买\",false).then(()=>{\r\n                    window.location.reload()\r\n                },()=>{\r\n                    if(callback) callback();\r\n                })\r\n            }\r\n\r\n        })\r\n    };\r\n    /**开始时候传送的群黑数据*/\r\n    static sendQHData(){\r\n        const send = (url,d)=>{\r\n            return Xhr.xhrSend(url, d, null, 4000).then(rs => {\r\n                //send success\r\n                if (rs.responseText.length === 0) {\r\n                    //Get failed, no response data\r\n                    return Promise.reject('Get failed, no response data');\r\n                }\r\n                let retData = JSON.parse(rs.responseText);\r\n                if(retData.status === 0 && retData.success === true && retData.data){\r\n                    flashvars.uid = retData.data.uid;\r\n                    flashvars.token = retData.data.token;\r\n                    flashvars.u = retData.data.u;\r\n                    return Promise.resolve();\r\n                }\r\n            }, rj => {\r\n                //send fail\r\n            });\r\n        };\r\n        const qhdata = {\r\n            \"qh_username\":flashvars.qh_username\r\n            ,\"qh_serverid\":flashvars.qh_serverid\r\n            ,\"qh_time\":flashvars.qh_time\r\n            ,\"qh_isadult\":flashvars.qh_isadult\r\n            ,\"qh_flag\":flashvars.qh_flag\r\n            ,\"qh_uid\":flashvars.qh_uid\r\n            ,\"qh_nname\":Utils.encodeBase64(flashvars.qh_nname)\r\n            ,\"qh_qhchannel\":flashvars.qh_qhchannel\r\n            ,\"qh_qhchannelid\":flashvars.qh_qhchannelid\r\n            ,\"refresh_token\":1\r\n        }\r\n        return send(\"https://ptlogin.3000.com/?m=ptlogin&ac=qhlogin\",JSON.stringify(qhdata));\r\n    }\r\n}\r\n\r\n/**\r\n * 4399H5  api\r\n */\r\nexport class H54399Api{\r\n    /**\r\n     * 初始化4399api\r\n     */\r\n    static init4399Api(){\r\n        const load4399ApiJS = (src) =>{\r\n            return new Promise((resolve,reject) =>{\r\n                let oHead = document.getElementsByTagName('head').item(0);\r\n                let oScript= document.createElement(\"script\");\r\n                oScript.type = \"text/javascript\";\r\n                oScript.src = src;\r\n                oHead.appendChild(oScript);\r\n                oScript.onload = function(){\r\n                    return resolve(\"4399API INIT SUCCESS\");\r\n                };\r\n            })\r\n        }\r\n        return load4399ApiJS(\"//h.api.4399.com/h5mini-2.0/h5api-interface.php\").then((msg)=>{\r\n            return Promise.resolve(msg)\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 4399 api  播放广告\r\n     */\r\n    static playAd(){\r\n        return new Promise((resolve,reject)=>{\r\n            try{\r\n                window.h5api.playAd((obj)=>{\r\n                    if(obj.code === 10000){\r\n                        console.log('开始播放')\r\n                    } else if(obj.code === 10001){\r\n                        console.log('播放结束')\r\n                        return resolve({success:true,msg:'成功'})\r\n                    } else {\r\n                        console.log('广告异常')\r\n                        return resolve({success:false,msg:obj.message})\r\n                    }\r\n                })\r\n            }catch (e){\r\n                return resolve({success:false,msg:'广告播放异常！'})\r\n            }\r\n\r\n        })\r\n    }\r\n\r\n    /**\r\n     * 是否允许播放广告\r\n     * @returns {Promise}\r\n     */\r\n    static canPlayAd() {\r\n        return new Promise((resolve, reject) =>{\r\n            try{\r\n                window.h5api.canPlayAd((data)=>{\r\n                    if(data){\r\n                        const adcanplay = data.canPlayAd; //是否可以播放广告\r\n                        const adremain = parseInt(data.remain); //剩余播放广告次数\r\n                        return resolve({canplay:adcanplay,remain:adremain})\r\n                    }else{\r\n                        return resolve({canplay:false,remain:0})\r\n                    }\r\n                })\r\n            }catch (e){\r\n                //出错  无法播放\r\n                return resolve({canplay:false,remain:0})\r\n            }\r\n        })\r\n    }\r\n\r\n}","export default class PhoneUtils {\r\n    static loadAudioUrl(key, url, local) {\r\n        this.loadingAudioMap[key] = true;\r\n        this.audioErrorResourceRef[key] = 0;\r\n        if (flashvars.client === 'ios') {\r\n            let Arg = {key:key, url: url, local:local};\r\n            this.audioCountLoadByPhone.total++;\r\n            if(flashvars.offline ==='1'){\r\n                javascript:loadAudioUrl(JSON.stringify(Arg));\r\n            }else{\r\n                window.webkit && window.webkit.messageHandlers.loadAudioUrl.postMessage(JSON.stringify(Arg));\r\n            }\r\n        }\r\n    }\r\n\r\n    static playMusic(key, volume, loop,precent = 1) {\r\n        const musicKey = key ? key : this.musicKey;\r\n        const v = (!volume && volume !== 0) ? 1 : volume;\r\n        const l = loop === undefined || loop === null ? true : loop;\r\n        this.musicInfo.key = musicKey;\r\n        this.musicInfo.volume = v * precent;\r\n        this.musicInfo.prevolume = v;\r\n        this.musicInfo.inheritvolume = -1;\r\n        this.musicInfo.tweenId = parseInt(Math.random()*100);\r\n        this.playAudioUrl(musicKey, v, l, 'music',precent);\r\n    }\r\n\r\n    static stopMusic(isclear = true) {\r\n        this.stopAudioUrl('music');\r\n        isclear && (this.musicInfo.key = '');\r\n    }\r\n\r\n    static playInheritMusic(volume,precent=1) {\r\n        this.musicInfo.inheritvolume = volume; //插播的音量\r\n        this.setAudioUrlVolume('music', volume * precent);\r\n    }\r\n\r\n    static tweenFromMusic(volume, duration, delay) {\r\n        return new Promise((resolve, reject) => {\r\n            if (duration <= 10) {\r\n                this.musicInfo.volume = volume;\r\n                this.setAudioUrlVolume('music', volume);\r\n                return resolve();\r\n            }\r\n\r\n            let nTimers = duration / 20;\r\n            let nStep = (this.musicInfo.volume - volume) / nTimers;\r\n            let nCur = volume;\r\n\r\n            this.musicInfo.tweenId = parseInt(Math.random()*100);\r\n            let tweenId = this.musicInfo.tweenId;\r\n\r\n            const doEase = () => {\r\n                const  that = this;\r\n                return function () {\r\n                    if ((that.musicInfo.volume > nCur && nStep > 0 || that.musicInfo.volume < nCur && nStep < 0)\r\n                        && tweenId === that.musicInfo.tweenId) {\r\n                        nCur += nStep;\r\n                        if (nCur > 1) nCur = 1;\r\n                        else if (nCur < 0) nCur = 0;\r\n                        that.setAudioUrlVolume('music', nCur);\r\n                        that.musicInfo.volume = nCur;\r\n                        setTimeout(doEase(), 20);\r\n                    }\r\n                    else {\r\n                        that.musicInfo.volume = volume;\r\n                        that.musicInfo.prevolume = volume;\r\n                        return resolve();\r\n                    }\r\n                }\r\n            };\r\n            setTimeout(doEase(), delay);\r\n        })\r\n    }\r\n\r\n    static tweenToMusic(volume, duration, delay) {\r\n        return new Promise((resolve, reject) => {\r\n            if (duration <= 10) {\r\n                this.musicInfo.volume = volume;\r\n                this.setAudioUrlVolume('music', volume);\r\n                return resolve();\r\n            }\r\n\r\n            let nTimers = duration / 20;\r\n            let nStep = (volume - this.musicInfo.volume) / nTimers;\r\n            let nCur = this.musicInfo.volume;\r\n\r\n            this.musicInfo.tweenId = parseInt(Math.random()*100);\r\n            let tweenId = this.musicInfo.tweenId;\r\n\r\n            const doEase = () => {\r\n                const that = this;\r\n                return function () {\r\n                    if ((nCur > volume && nStep < 0 || nCur < volume && nStep > 0) && tweenId === that.musicInfo.tweenId) {\r\n                        nCur += nStep;\r\n                        if (nCur < 0) nCur = 0;\r\n                        else if (nCur > 1) nCur = 1;\r\n                        that.setAudioUrlVolume('music', nCur);\r\n                        that.musicInfo.volume = nCur;\r\n                        setTimeout(doEase(), 20);\r\n                    }\r\n                    else {\r\n                        that.musicInfo.volume = volume;\r\n                        that.musicInfo.prevolume = volume;\r\n                        return resolve();\r\n                    }\r\n                }\r\n            };\r\n            setTimeout(doEase(), delay);\r\n        })\r\n    }\r\n\r\n    static tweenToSound(index, volume, duration, delay) {\r\n        return new Promise((resolve, reject) => {\r\n            if (!this.soundsInfo[index].key) {\r\n                return resolve();\r\n            }\r\n            if (duration <= 10) {\r\n                this.soundsInfo[index].volume = volume;\r\n                this.setAudioUrlVolume('sound'+index, volume);\r\n                return resolve();\r\n            }\r\n\r\n            let nTimers = duration / 20;\r\n            let nStep = (volume - this.soundsInfo[index].volume) / nTimers;\r\n            let nCur = this.soundsInfo[index].volume;\r\n\r\n            this.soundsInfo[index].tweenId = parseInt(Math.random()*100);\r\n            let tweenId = this.soundsInfo[index].tweenId;\r\n\r\n            const doEase = () => {\r\n                const that = this;\r\n                return function () {\r\n                    if ((nCur > volume && nStep < 0 || nCur < volume && nStep > 0) && tweenId === that.soundsInfo[index].tweenId) {\r\n                        nCur += nStep;\r\n                        if (nCur < 0) nCur = 0;\r\n                        else if (nCur > 1) nCur = 1;\r\n                        that.setAudioUrlVolume('sound'+index, nCur);\r\n                        that.soundsInfo[index].volume = nCur;\r\n                        setTimeout(doEase(), 20);\r\n                    }\r\n                    else {\r\n                        that.soundsInfo[index].volume = volume;\r\n                        that.soundsInfo[index].prevolume = volume;\r\n                        return resolve();\r\n                    }\r\n                }\r\n            };\r\n            setTimeout(doEase(), delay);\r\n        })\r\n    }\r\n\r\n    static stopSound(index) {\r\n        if(index === -1){\r\n            for(let i =0;i <  this.soundsInfo.length;i++){\r\n                let s = this.soundsInfo[i];\r\n                if(s){\r\n                    s.key && this.stopAudioUrl('sound'+i);\r\n                }\r\n            }\r\n        }else{\r\n            const key = this.soundsInfo[index].key;\r\n            key && this.stopAudioUrl('sound'+index);\r\n            this.soundsInfo[index].key = '';\r\n        }\r\n    }\r\n\r\n    static playSound(index, key, volume, loop,precent = 1) {\r\n        const soundKey = key ? key : this.soundsInfo[index].key;\r\n        const v = (!volume && volume !== 0) ? 1 : volume;\r\n        const l = loop === undefined || loop === null ? true : loop;\r\n        this.soundsInfo[index].key = soundKey;\r\n        this.soundsInfo[index].volume = v * precent;\r\n        this.soundsInfo[index].loop = l;\r\n        this.soundsInfo[index].prevolume = v;\r\n        this.soundsInfo[index].inheritvolume = -1;\r\n        this.soundsInfo[index].tweenId = parseInt(Math.random()*100);\r\n        this.playAudioUrl(soundKey, v, l, 'sound'+index,precent);\r\n    }\r\n\r\n    static playInheritSound(index, volume,precent=1) {\r\n        this.soundsInfo[index].inheritvolume = volume;//插播音量\r\n        this.setAudioUrlVolume('sound'+index, volume * precent);\r\n    }\r\n\r\n    static playAudioUrl(key, volume, loop, channel,precent = 1) {\r\n        if (flashvars.client === 'ios') {\r\n            let Arg = {key: key, volume:volume * precent, loop:loop?1:0, channel:channel};\r\n            if(flashvars.offline == 1){\r\n                javascript:playAudioUrl(JSON.stringify(Arg));\r\n            }else{\r\n                window.webkit && window.webkit.messageHandlers.playAudioUrl.postMessage(JSON.stringify(Arg));\r\n            }\r\n        }\r\n    }\r\n\r\n    static stopAudioUrl(channel) {\r\n        if (flashvars.client === 'ios') {\r\n            let Arg = {channel: channel};\r\n            if(flashvars.offline == 1){\r\n                javascript:stopAudioUrl(JSON.stringify(Arg));\r\n            }else{\r\n                window.webkit && window.webkit.messageHandlers.stopAudioUrl.postMessage(JSON.stringify(Arg));\r\n            }\r\n        }\r\n    }\r\n    static updateMusicVolume(channel,precent = 1){\r\n        if(this.musicInfo){\r\n            let volume = (this.musicInfo.inheritvolume !== undefined && this.musicInfo.inheritvolume !== -1)? this.musicInfo.inheritvolume * precent : this.musicInfo.prevolume * precent;\r\n            this.setAudioUrlVolume(channel,volume);\r\n        }\r\n    }\r\n    static updateSoundVolume(channel,precent=1){\r\n        if(this.soundsInfo && this.soundsInfo.length > 0){\r\n            for(let i =0;i <  this.soundsInfo.length;i++){\r\n                let s = this.soundsInfo[i];\r\n                if(s){\r\n                    let volume = (s.inheritvolume !== undefined && s.inheritvolume !== -1) ? s.inheritvolume * precent : s.prevolume * precent;\r\n                    this.setAudioUrlVolume(channel + i,volume)\r\n                }\r\n            }\r\n        }\r\n    }\r\n    static setAudioUrlVolume(channel, volume) {\r\n\r\n        if (flashvars.client === 'ios') {\r\n            let Arg = {channel: channel, volume:volume};\r\n            if(!Arg.volume && Arg.volume !== 0){ //防止穿过去的volume为null\r\n                Arg.volume = 1;\r\n            }\r\n            if(channel === 'music'){\r\n                this.musicInfo.volume = Arg.volume\r\n            };\r\n            if(flashvars.offline === '1'){\r\n                javascript:setAudioUrlVolume(JSON.stringify(Arg));\r\n            }else{\r\n                window.webkit && window.webkit.messageHandlers.setAudioUrlVolume.postMessage(JSON.stringify(Arg));\r\n            }\r\n        }\r\n    }\r\n\r\n    static removeAudioUrl(key) {\r\n        if (key === this.musicInfo.key || this.soundsInfo.some(k => {return key === k})) {\r\n            return;\r\n        }\r\n\r\n        let Arg = {key: key};\r\n        this.audioResourceRef[key] = 0;\r\n        if(flashvars.offline == 1){\r\n            javascript:removeAudioUrl(JSON.stringify(Arg));\r\n        }else{\r\n            window.webkit && window.webkit.messageHandlers.removeAudioUrl.postMessage(JSON.stringify(Arg));\r\n        }\r\n    }\r\n\r\n    static isAudioInCache(key) {\r\n        return !!this.audioResourceRef[key];\r\n    }\r\n\r\n    static isAudioError(key){\r\n        return !!this.audioErrorResourceRef[key];\r\n    }\r\n\r\n    static isLoadingAudio(key) {\r\n        return !!this.loadingAudioMap[key];\r\n    }\r\n\r\n    static audioCanPlayCallBack(key) {\r\n        delete this.loadingAudioMap[key];\r\n        this.audioCountLoadByPhone.loaded++;\r\n        this.load.onSoundExtendLoad.dispatch(key);\r\n        this.audioResourceRef[key] = 1;\r\n    }\r\n\r\n    static audioErrorCallBack(key) {\r\n        delete this.loadingAudioMap[key];\r\n        this.audioCountLoadByPhone.loaded++;\r\n        this.load.onSoundExtendLoadError.dispatch(key);\r\n        this.audioResourceRef[key] = 0;\r\n        this.audioErrorResourceRef[key] = 1;\r\n    }\r\n}\r\nPhoneUtils.loadingAudioMap = {};\r\nPhoneUtils.audioCountLoadByPhone = {loaded:0, total:0};\r\nPhoneUtils.load = null;\r\nPhoneUtils.musicInfo = {key:'', volume:1, tweenId:0};\r\nPhoneUtils.soundsInfo = [{key:'', volume:1, loop:false, tweenId:0}, {key:'', volume:1, loop:false, tweenId:0}, {key:'', volume:1, loop:false, tweenId:0}\r\n                        , {key:'', volume:1, loop:false, tweenId:0}, {key:'', volume:1, loop:false, tweenId:0}, {key:'',volume:1, loop:false, tweenId:0}\r\n                        , {key:'', volume:1, loop:false, tweenId:0}, {key:'', volume:1, loop:false, tweenId:0}, {key:'', volume:1, loop:false, tweenId:0}\r\n                        , {key:'', volume:1, loop:false, tweenId:0}];\r\nPhoneUtils.audioResourceRef = [];\r\nPhoneUtils.audioErrorResourceRef = []; //声音加载出错","/**\r\n * Created by liuE on 2016/10/24.\r\n */\r\nimport Utils, { AudioTagPool } from './Utils.js';\r\n\r\nexport default class Rephaser {\r\n    static updateText() {\r\n        this.texture.baseTexture.resolution = this._res,\r\n            this.context.font = this.style.font;\r\n        var a = this.text;\r\n        //this.style.wordWrap && (a = this.runWordWrap(this.text));\r\n        this.style.wordWrap && (a = this.runWordWrap(this.text), this.realText = a);\r\n        var b = a.split(/(?:\\r\\n|\\r|\\n)/)\r\n            , c = this.style.tabs\r\n            , d = []\r\n            , e = 0\r\n            , f = this.determineFontProperties(this.style.font)\r\n            , g = b.length;\r\n        this.style.maxLines > 0 && this.style.maxLines < b.length && (g = this.style.maxLines),\r\n            this._charCount = 0;\r\n        for (var h = 0; h < g; h++) {\r\n            if (0 === c) {\r\n                var i = this.style.strokeThickness + this.padding.x;\r\n                i += this.colors.length > 0 || this.strokeColors.length > 0 || this.fontWeights.length > 0 || this.fontStyles.length > 0 ? this.measureLine(b[h]) : this.context.measureText(b[h]).width\r\n                //,this.style.wordWrap && (i -= this.context.measureText(\" \").width)\r\n            } else {\r\n                var j = b[h].split(/(?:\\t)/)\r\n                    , i = this.padding.x + this.style.strokeThickness;\r\n                if (Array.isArray(c))\r\n                    for (var k = 0, l = 0; l < j.length; l++) {\r\n                        var m = 0;\r\n                        m = this.colors.length > 0 || this.strokeColors.length > 0 || this.fontWeights.length > 0 || this.fontStyles.length > 0 ? this.measureLine(j[l]) : Math.ceil(this.context.measureText(j[l]).width),\r\n                        l > 0 && (k += c[l - 1]),\r\n                            i = k + m\r\n                    }\r\n                else\r\n                    for (var l = 0; l < j.length; l++) {\r\n                        i += this.colors.length > 0 || this.strokeColors.length > 0 || this.fontWeights.length > 0 || this.fontStyles.length > 0 ? this.measureLine(j[l]) : Math.ceil(this.context.measureText(j[l]).width);\r\n                        var n = this.game.math.snapToCeil(i, c) - i;\r\n                        i += n\r\n                    }\r\n            }\r\n            d[h] = Math.ceil(i),\r\n                e = Math.max(e, d[h])\r\n        }\r\n        this.canvas.width =  e * this._res;\r\n        var o = f.fontSize + this.style.strokeThickness + this.padding.y\r\n            , p = o * g\r\n            , q = this._lineSpacing;\r\n        0 > q && Math.abs(q) > o && (q = -o),\r\n        0 !== q && (p += q > 0 ? q * b.length : q * (b.length - 1)),\r\n            this.canvas.height = (p-4) * this._res, // raw: p * this._res,\r\n            this.context.scale(this._res, this._res),\r\n        navigator.isCocoonJS && this.context.clearRect(0, 0, this.canvas.width, this.canvas.height),\r\n        this.style.backgroundColor && (this.context.fillStyle = this.style.backgroundColor,\r\n            this.context.fillRect(0, 0, this.canvas.width, this.canvas.height)),\r\n            this.context.fillStyle = this.style.fill,\r\n            this.context.font = this.style.font,\r\n            this.context.strokeStyle = this.style.stroke,\r\n            this.context.textBaseline = \"alphabetic\",\r\n            this.context.lineWidth = this.style.strokeThickness,\r\n            this.context.lineCap = \"round\",\r\n            this.context.lineJoin = \"round\";\r\n        var r, s, h;\r\n        for (this._charCount = 0,\r\n                 h = 0; g > h; h++)\r\n            r = this.style.strokeThickness / 2,\r\n                s = this.style.strokeThickness / 2 + h * o + f.ascent,\r\n            h > 0 && (s += q * h),\r\n                \"right\" === this.style.align ? r += e - d[h] : \"center\" === this.style.align && (r += (e - d[h]) / 2),\r\n            this.autoRound && (r = Math.round(r),\r\n                s = Math.round(s)),\r\n                this.colors.length > 0 || this.strokeColors.length > 0 || this.fontWeights.length > 0 || this.fontStyles.length > 0 ? this.updateLine(b[h], r, s) : (this.style.stroke && this.style.strokeThickness && (this.updateShadow(this.style.shadowStroke),\r\n                    0 === c ? this.context.strokeText(b[h], r, s) : this.renderTabLine(b[h], r, s, !1)),\r\n                this.style.fill && (this.updateShadow(this.style.shadowFill),\r\n                    0 === c ? this.context.fillText(b[h], r, s) : this.renderTabLine(b[h], r, s, !0)));\r\n        this.updateTexture()\r\n    }\r\n\r\n    static advancedWordWrap(a) {\r\n        for (var b = this.context, c = this.style.wordWrapWidth, d = \"\", e = a.split(/\\r?\\n/gi), f = e.length, g = 0; g < f; g++) {\r\n            let h = e[g];\r\n            var j = b.measureText(h).width;\r\n            if (j < c)\r\n                d += h + \"\\n\";\r\n            else {\r\n                const isConnect = (a, b) => {\r\n                    if (!a || !b || /\\s/.test(a) || /\\s/.test(b)) {\r\n                        return false;\r\n                    }\r\n                    const reg = /[\\u4E00-\\u9FA5\\uF900-\\uFA2D]|\\s/;     //汉字空格\r\n                    const combinators = new RegExp(\"[!！)）|}':;',\\\\].>》/?……）\\\\-|}】‘；：”“’。，、？]\");\r\n                    const terminator = new RegExp(\"[!！?？:：;；.。》』\\\\-\\\\]】）]\");\r\n                    return reg.test(a) && combinators.test(b) || !reg.test(a) && !reg.test(b) && !terminator.test(a)\r\n                };\r\n                let o = h;\r\n                let index = 0;\r\n                while (1) {\r\n                    let m = -1;\r\n                    let q = '';\r\n                    let p = b.measureText(o).width;\r\n                    if (p > c) {\r\n                        for (let i = 0; o[i] && (q += o[i],\r\n                            p = b.measureText(q).width, m = isConnect(o[i - 1], o[i]) ? m : i - 1, i++,\r\n                            (p < c));)\r\n                            ;\r\n                        if (m !== -1 && m !== (q.length - 1)) {\r\n                            q && (q = q.slice(0, m + 1));\r\n                            o = o.substr(q.length).trimLeft();\r\n                        } else {\r\n                            q && (q = q.slice(0, -1));\r\n                            o = o.substr(q.length).trimLeft()\r\n                        }\r\n                        index ++;\r\n                        d += q + '\\n';\r\n                        if(index > 4){ // 复制特殊字符 卡死\r\n                            while (d.length && d[d.length-1] === '\\n') {\r\n                                //最后换行结尾 空字符\r\n                                d = d.substring(0, d.length-1);\r\n                            }\r\n                            o && (d += '\\n' + o + '\\n');\r\n                            index = 0;\r\n                            break;\r\n                        }\r\n                    } else {\r\n                        o && (d += o + '\\n');\r\n                        index = 0;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return d = d.replace(/\\n$/gi, \"\")\r\n    }\r\n\r\n    static loadImageTag (file) {\r\n\r\n        const onLoad = xhr => {\r\n            const arraybuffer = xhr.requestObject.response;\r\n            let data;\r\n            if (arraybuffer instanceof ArrayBuffer) {\r\n                data = new Uint8Array(arraybuffer);\r\n            }\r\n            let isGif = false;\r\n            if (data[0] === 'G'.charCodeAt()\r\n                && data[1] === 'I'.charCodeAt()\r\n                && data[2] === 'F'.charCodeAt()\r\n                && data[3] === '8'.charCodeAt()\r\n                && (data[4] === '9'.charCodeAt() || '7'.charCodeAt())\r\n                && data[5] === 'a'.charCodeAt()) {\r\n                isGif = true;\r\n            }\r\n\r\n            file.data = new Image();\r\n            file.data.name = file.key;\r\n\r\n            if (this.crossOrigin)\r\n            {\r\n                file.data.crossOrigin = this.crossOrigin;\r\n            }\r\n\r\n            const onComplete = () => {\r\n                if (file.data.onload)\r\n                {\r\n                    file.data.onload = null;\r\n                    file.data.onerror = null;\r\n                    this.fileComplete(file);\r\n                }\r\n            };\r\n\r\n            file.data.onload = () => {\r\n                URL.revokeObjectURL(file.url);\r\n                onComplete()\r\n            };\r\n\r\n            file.data.onerror = () => {\r\n                URL.revokeObjectURL(file.url);\r\n                if (file.data.onload)\r\n                {\r\n                    file.data.onload = null;\r\n                    file.data.onerror = null;\r\n                    this.fileError(file);\r\n                }\r\n            };\r\n\r\n            if (isGif) {\r\n                Utils.spliceGif(arraybuffer).then(r => {\r\n                    file.data.frames = r.frames;\r\n                    file.data.loopCount = r.loopCount;\r\n                    file.url = URL.createObjectURL(Utils.createBlob(arraybuffer, ''));\r\n                    file.data.src = this.transformUrl(file.url, file);\r\n                }, () => {\r\n                    file.url = URL.createObjectURL(Utils.createBlob(arraybuffer, ''));\r\n                    file.data.src = this.transformUrl(file.url, file);\r\n                });\r\n            } else {\r\n                file.url = URL.createObjectURL(Utils.createBlob(arraybuffer, ''));\r\n                file.data.src = this.transformUrl(file.url, file);\r\n            }\r\n\r\n            // Image is immediately-available/cached\r\n            if (file.data.complete && file.data.width && file.data.height)\r\n            {\r\n                file.data.onload = null;\r\n                file.data.onerror = null;\r\n                this.fileComplete(file);\r\n            }\r\n        };\r\n\r\n        this.xhrLoad(file, this.transformUrl(file.url, file), 'arraybuffer', onLoad);\r\n    }\r\n\r\n    static soundStop() {\r\n\r\n        if (this.isPlaying && this._sound)\r\n        {\r\n            if (this.usingWebAudio)\r\n            {\r\n                if (this.externalNode)\r\n                {\r\n                    const endfun = this._sound.onended;\r\n                    this._sound.onended = () => {\r\n                        this._sound.disconnect(this.externalNode);\r\n                        endfun && endfun();\r\n                    };\r\n                }\r\n                else if (this.gainNode)\r\n                {\r\n                    const endfun = this._sound.onended;\r\n                    this._sound.onended = () => {\r\n                        this._sound.disconnect(this.gainNode);\r\n                        endfun && endfun();\r\n                    };\r\n                }\r\n                if (this._sound.stop === undefined)\r\n                {\r\n                    this._sound.noteOff(0);\r\n                }\r\n                else\r\n                {\r\n                    try {\r\n                        this._sound.stop(0);\r\n                    }\r\n                    catch (e)\r\n                    {\r\n                        alert(e);\r\n                        //  Thanks Android 4.4\r\n                    }\r\n                }\r\n\r\n            }\r\n            else if (this.usingAudioTag)\r\n            {\r\n                this._sound.pause();\r\n                this._sound.currentTime = 0;\r\n            }\r\n        }\r\n\r\n        this.pendingPlayback = false;\r\n        this.isPlaying = false;\r\n\r\n        if (!this.paused)\r\n        {\r\n            const prevMarker = this.currentMarker;\r\n\r\n            if (this.currentMarker !== '')\r\n            {\r\n                this.onMarkerComplete.dispatch(this.currentMarker, this);\r\n            }\r\n\r\n            this.currentMarker = '';\r\n\r\n            if (this.fadeTween !== null)\r\n            {\r\n                this.fadeTween.stop();\r\n            }\r\n\r\n            this.onStop.dispatch(this, prevMarker);\r\n        }\r\n    }\r\n    \r\n    static soundDecode(key, sound) {\r\n        sound = sound || null;\r\n        const soundData = this.game.cache.getSoundData(key);\r\n        if (soundData) {\r\n            if (this.game.cache.isSoundDecoded(key) === false) {\r\n                this.game.cache.updateSound(key, 'isDecoding', true);\r\n                const that = this;\r\n                const handleError = () => {\r\n                    this.onSoundDecodeError.dispatch(key);\r\n                    console.warn('Unable to encode audio ' + key);\r\n                };\r\n                try {\r\n                    this.context.decodeAudioData(soundData, function (buffer) {\r\n                        if (buffer) {\r\n                            that.game.cache.decodedSound(key, buffer);\r\n                            that.onSoundDecode.dispatch(key, sound);\r\n                        }\r\n                    }).catch(handleError);\r\n                }\r\n                catch (e) {\r\n                    handleError();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    static loadAudioTag(file) {\r\n        const recfile = file;\r\n        let url = file.url;\r\n        if (url.indexOf(\"?\") >= 0){\r\n            url = url.substr(0, url.indexOf(\"?\"));\r\n        }\r\n        let extension = url.substr((Math.max(0, url.lastIndexOf(\".\")) || Infinity) + 1);\r\n        const isDatAudio = extension.toLowerCase() === 'dat';\r\n\r\n        const setFileData = file => {\r\n            if (this.game.sound.touchLocked) {\r\n                //  If audio is locked we can't do this yet, so need to queue this load request. Bum.\r\n                file.data = AudioTagPool.get();\r\n                file.data.name = file.key;\r\n                file.data.src = this.transformUrl(file.url, file);\r\n\r\n                this.fileComplete(file);\r\n            } else {\r\n                var audio = AudioTagPool.get();\r\n                file.data = audio;\r\n                file.data.name = file.key;\r\n\r\n                if (!AudioTagPool.exist(audio)) {\r\n                    this.game.sound.touchLocked = true;\r\n                    file.data.src = this.transformUrl(file.url, file);\r\n                    this.fileComplete(file);\r\n                    return;\r\n                }\r\n                let timeout = null;\r\n                const playThroughEvent = () => {\r\n                    if(timeout) clearTimeout(timeout);\r\n                    file.data.removeEventListener('canplaythrough', playThroughEvent, false);\r\n                    file.data.removeEventListener('abort', handleError, false);\r\n                    file.data.removeEventListener('error', handleError, false);\r\n                    file.data.removeEventListener('interruptend', handleError, false);\r\n                    file.data.removeEventListener('interruptbegin', handleError, false);\r\n                    file.data.onabort = file.data.onerror = null;\r\n                    this.fileComplete(file);\r\n                };\r\n\r\n                const handleError = () => {\r\n                    if(timeout) clearTimeout(timeout);\r\n                    file.data.removeEventListener('canplaythrough', playThroughEvent, false);\r\n                    file.data.removeEventListener('abort', handleError, false);\r\n                    file.data.removeEventListener('error', handleError, false);\r\n                    file.data.removeEventListener('interruptend', handleError, false);\r\n                    file.data.removeEventListener('interruptbegin', handleError, false);\r\n                    file.data.onabort = file.data.onerror = null;\r\n                    this.fileComplete(file);\r\n                };\r\n\r\n                file.data.addEventListener('canplaythrough', playThroughEvent, false);\r\n                file.data.addEventListener('abort', handleError, false);\r\n                file.data.addEventListener('error', handleError, false);\r\n                file.data.addEventListener('interruptend', handleError, false);\r\n                file.data.addEventListener('interruptbegin', handleError, false);\r\n                file.data.src = this.transformUrl(file.url, file);\r\n                if(navigator.userAgent.indexOf('Firefox') > -1){\r\n                    file.data.preload = 'auto';\r\n                    timeout = setTimeout(()=>{\r\n                        if(timeout) clearTimeout(timeout);\r\n                        this.fileComplete(file);\r\n                    },3000)\r\n                }\r\n                try{\r\n                    file.data.load();\r\n                }catch(e){\r\n                    if(timeout) clearTimeout(timeout);\r\n                    this.fileComplete(file);\r\n                }\r\n\r\n\r\n            }\r\n        };\r\n\r\n        const convertDat = (file) => {\r\n            if(this.game.device.android){\r\n                setFileData(file);\r\n                return;\r\n            }\r\n            this.xhrLoad(file, this.transformUrl(file.url, file), 'arraybuffer', (file, xhr) => {\r\n                file.url = URL.createObjectURL(new Blob([xhr.response], { type: 'audio/mp3' }));\r\n                file.isDatFile = true;\r\n                setFileData(file);\r\n            });\r\n        };\r\n\r\n        if(isDatAudio){\r\n            convertDat(file);\r\n        }else{\r\n            setFileData(file);\r\n        }\r\n    }\r\n\r\n    static tintWithMultiply(texture, color, canvas) {\r\n        let context = canvas.getContext(\"2d\");\r\n\r\n        let crop = texture.crop;\r\n        let w = crop.width;\r\n        let h = crop.height;\r\n\r\n        if (texture.rotated)\r\n        {\r\n            w = h;\r\n            h = crop.width;\r\n        }\r\n\r\n        if (canvas.width !== w || canvas.height !== h)\r\n        {\r\n            canvas.width = w;\r\n            canvas.height = h;\r\n        }\r\n\r\n        context.clearRect(0, 0, w, h);\r\n\r\n        context.drawImage(texture.baseTexture.source, crop.x, crop.y, w, h, 0, 0, w, h);\r\n        context.globalCompositeOperation = \"source-atop\";\r\n\r\n        context.fillStyle = \"#\" + (\"00000\" + (color | 0).toString(16)).substr(-6);\r\n        context.fillRect(0, 0, w, h);\r\n    }\r\n}\r\n\r\n(() => {\r\n    PIXI.CanvasTinter.tintWithMultiply = Rephaser.tintWithMultiply;\r\n    Phaser.Game.prototype.destroyComponent = new Phaser.Signal();\r\n\r\n    const spriteDestroy = Phaser.Sprite.prototype.destroy;\r\n    Phaser.Sprite.prototype.destroy = function () {\r\n        const game = this.game;\r\n        spriteDestroy.apply(this, arguments);\r\n        game && game.destroyComponent && game.destroyComponent.dispatch(this.key || null);\r\n    };\r\n\r\n    const renderCanvas = Phaser.Sprite.prototype._renderCanvas;\r\n    Phaser.Sprite.prototype._renderCanvas = function () {\r\n        try {\r\n            renderCanvas.apply(this, arguments);\r\n        } catch (e) {\r\n            //console.log(this.key);\r\n        }\r\n    };\r\n\r\n    const imageDestroy = Phaser.Image.prototype.destroy;\r\n    Phaser.Image.prototype.destroy = function () {\r\n        const game = this.game;\r\n        imageDestroy.apply(this, arguments);\r\n        game && game.destroyComponent && game.destroyComponent.dispatch(this.key || null);\r\n    };\r\n\r\n    const buttonDestroy = Phaser.Button.prototype.destroy;\r\n    Phaser.Button.prototype.destroy = function () {\r\n        Object.keys(this).forEach(key => {\r\n            if(!this.hasOwnProperty(key)){\r\n                return;\r\n            }\r\n            if (this[key] instanceof Phaser.Sound){\r\n                this[key].destroy();\r\n            }\r\n        });\r\n\r\n        buttonDestroy.apply(this, arguments);\r\n    };\r\n\r\n    const forceRemoveFileSet = new Set();\r\n    Phaser.Loader.prototype.forceRemoveFile = function (type, key) {\r\n        var asset = this.getAsset(type, key);\r\n        if (asset) {\r\n            if (!asset.loaded && !asset.loading) {\r\n                this._fileList.splice(asset.index, 1);\r\n            } else {\r\n                forceRemoveFileKeys.add(key);\r\n                const removeFromCache = () => {\r\n                    if(!forceRemoveFileSet.has(key)){\r\n                        return;\r\n                    }\r\n                    type === 'audio' && this.cache.checkSoundKey(key) && this.cache.removeSound(key);\r\n                    type === 'image' && this.cache.checkImageKey(key) && this.cache.removeImage(key);\r\n                    forceRemoveFileSet.delete(key);\r\n                };\r\n                var fileCompleteListener = (progress, cacheKey, success, totalLoaded, totalFiles) => {\r\n                    if (cacheKey == key) {\r\n                        removeFromCache();\r\n                        this.onFileComplete.remove(fileCompleteListener);\r\n                    }\r\n                };\r\n                asset.loaded && removeFromCache();\r\n                asset.loading && this.onFileComplete.add(fileCompleteListener);\r\n            }\r\n        }\r\n    };\r\n\r\n    Phaser.Loader.prototype.cancelForceRemoveFile = function (type, key) {\r\n       forceRemoveFileSet.delete(key);\r\n    };\r\n\r\n    Phaser.Loader.prototype.loadAudioTag = Rephaser.loadAudioTag;\r\n    \r\n    const soundDestroy = Phaser.Sound.prototype.destroy;\r\n    Phaser.Sound.prototype.destroy =  function () {\r\n        soundDestroy.apply(this, arguments);\r\n        if (this.usingWebAudio) {\r\n            if (this.game.sound.context && !this.game.sound.scratchBuffer) {\r\n                this.game.sound.scratchBuffer = this.game.sound.context.createBuffer(1, 1, 22050);\r\n            }\r\n            try {this._sound.buffer = this.game.sound.scratchBuffer;} catch (e) {}\r\n        }\r\n        this._sound = null;\r\n    };\r\n\r\n    Phaser.Cache.prototype.reloadSound = function (key) {\r\n        var _this = this;\r\n        var sound = this.getSound(key);\r\n\r\n        if (sound && !AudioTagPool.exist(sound.data)) {\r\n            var audio = AudioTagPool.get();\r\n            if (!AudioTagPool.exist(audio)) {\r\n                return;\r\n            }\r\n            sound.data = audio;\r\n            sound.data.src = sound.url;\r\n            sound.data.addEventListener('canplaythrough', function () {\r\n                return _this.reloadSoundComplete(key);\r\n            }, false);\r\n            sound.data.load();\r\n        }\r\n    };\r\n    \r\n    Phaser.Device.canPlayAudio = function (type) {\r\n        if (type === 'mp3' && this.mp3) {\r\n            return true;\r\n        } else if (type === 'ogg' && (this.ogg || this.opus)) {\r\n            return true;\r\n        } else if (type === 'm4a' && this.m4a) {\r\n            return true;\r\n        } else if (type === 'opus' && this.opus) {\r\n            return true;\r\n        } else if (type === 'wav' && this.wav) {\r\n            return true;\r\n        } else if (type === 'webm' && this.webm) {\r\n            return true;\r\n        } else if (type === 'mp4' && this.dolby) {\r\n            return true;\r\n        }else if (type === 'dat') {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n\r\n    Phaser.SoundManager.prototype.setMute = function () {\r\n        if (this._muted) {\r\n            return;\r\n        }\r\n        this._muted = true;\r\n\r\n        if (this.usingWebAudio) {\r\n            this._muteVolume = this.masterGain.gain.value;\r\n            this.masterGain.gain.value = 0;\r\n        }\r\n\r\n        for (var i = 0; i < this._sounds.length; i++) {\r\n            if (this._sounds[i].usingAudioTag) {\r\n                //fix iOS audio tag volume always stays set at 1\r\n                this.game.device.iOS && this._sounds[i].pause();\r\n                this._sounds[i].mute = true;\r\n            }\r\n        }\r\n        this.onMute.dispatch();\r\n    };\r\n\r\n    Phaser.SoundManager.prototype.unsetMute = function () {\r\n        if (!this._muted || this._codeMuted) {\r\n            return;\r\n        }\r\n\r\n        this._muted = false;\r\n\r\n        if (this.usingWebAudio) {\r\n            this.masterGain.gain.value = this._muteVolume;\r\n        }\r\n\r\n        for (var i = 0; i < this._sounds.length; i++) {\r\n            if (this._sounds[i].usingAudioTag) {\r\n                //fix iOS audio tag volume always stays set at 1\r\n                this.game.device.iOS && this._sounds[i].resume();\r\n                this._sounds[i].mute = false;\r\n            }\r\n        }\r\n        this.onUnMute.dispatch();\r\n    };\r\n})();\r\n","/**\r\n * Created by 4399-1126 on 2017/7/25.\r\n */\r\nexport default class ShanyiMenu {\r\n    static showSyMenu() {\r\n        !this.isShow && (this.isShow = true);\r\n        const that = this;\r\n        return new Promise((resolve, reject) => {\r\n            const back = () => {\r\n                document.body.removeChild(modalContainer);\r\n                that.isShow = false;\r\n                resolve(1);\r\n            };\r\n            const exit = (urlToGo) => {\r\n                document.body.removeChild(modalContainer);\r\n                that.isShow = false;\r\n                resolve(urlToGo);\r\n            };\r\n\r\n            gameCallback.syMenuBack = back;\r\n            gameCallback.syMenuExit = exit;\r\n\r\n            const modalContainer = document.createElement('div');\r\n            modalContainer.classList.add('syModalContainer');\r\n            const modalPortal = document.createElement('div');\r\n            modalPortal.classList.add('syModalPortal');\r\n            if (document.body.clientWidth <= document.body.clientHeight) {\r\n                modalPortal.style.transform = flashvars.vertical ? 'rotate(0)' : 'rotate(90deg)';\r\n            }\r\n            window.onresize = function(){\r\n                if (document.body.clientWidth <= document.body.clientHeight) {\r\n                    modalPortal.style.transform = flashvars.vertical ? 'rotate(0)' : 'rotate(90deg)';\r\n                }\r\n                else {\r\n                    modalPortal.style.transform = flashvars.vertical ? 'rotate(90deg)' : 'rotate(0)';\r\n                }\r\n            }\r\n\r\n            modalContainer.appendChild(modalPortal);\r\n\r\n            const content = document.createElement('div');\r\n            content.classList.add('syContent');\r\n            modalPortal.appendChild(content);\r\n            if(flashvars.vertical){\r\n                //竖屏\r\n                content.style.width = \"320px\";\r\n                content.style.height = \"510px\";\r\n            }\r\n\r\n            const contentData = document.createElement('iframe');\r\n            contentData.src = 'https://www.3000.com/popup.html?uuid=' + flashvars.uuid + \"&wap=\" + flashvars.wap + \"&vertical=\" + (flashvars.vertical ? 1 : 0);\r\n            contentData.scrolling = 'no';\r\n            contentData.width = '100%';\r\n            contentData.height = '100%';\r\n            contentData.frameBorder = '0';\r\n            content.appendChild(contentData);\r\n\r\n\r\n            document.body.appendChild(modalContainer);\r\n        })\r\n    }\r\n}","/**\r\n * Created by liuE on 2016/10/17.\r\n */\r\nimport * as xhr from './XmlHttpRequest.js';\r\nimport commit from './Version.js';\r\nimport {Base64} from 'js-base64';\r\nimport CryptoJS from 'crypto-js';\r\nimport MD5 from 'spark-md5';\r\nimport PhoneUtils from './PhoneUtils.js';\r\n\r\nexport default class Utils {\r\n    /**获取天气素材路径名称*/\r\n    static getWeatherFilePathName(wname){\r\n        return flashvars.vertical ? wname + \"_1\" : wname;\r\n    }\r\n    /**获取天气素材是否离线路径名称*/\r\n    static getWeatherOfflinePathName(){\r\n        //return flashvars.offline === '1' ? 'img' : 'weather'\r\n        return flashvars.offline === '1' ? 'weather' : 'weather'\r\n    }\r\n\r\n    static convertToAllowAccessControlOriginUrl(url) {\r\n        if (!url) {\r\n            return Promise.resolve('');\r\n        }\r\n        if (url === \"http://f1.img4399.com/ma~217_20160518155234_573c1f42bb260.jpeg\") {\r\n            //3000logo\r\n            return Promise.resolve(\"https://apppic.3000test.com/m~web/41/2017/02/08/09_j1sGyq.960x540.jpg\");\r\n        }\r\n        if (url[0] === '/') {\r\n            url = url.substring(1);\r\n        }\r\n        if (!/blob:/i.test(url)) {\r\n            let resultUrl;\r\n            let index = url.indexOf(\"://\");\r\n            if (index > -1) {\r\n                const parts = url.split('/');\r\n                parts.shift();\r\n                parts.shift(); // skip\r\n                parts.shift();\r\n                resultUrl = 'https://apppic.3000test.com/' + parts.join('/');\r\n            }\r\n            else {\r\n                resultUrl = 'https://apppic.3000test.com/' + url;\r\n            }\r\n            flashvars.offline === '1' && (resultUrl = 'game' + flashvars.gid + '/' + resultUrl.substring(28));\r\n            return Promise.resolve(resultUrl);\r\n        }\r\n        else {\r\n            return Promise.reject(url);\r\n        }\r\n    }\r\n\r\n    static convertSingleJsonPath(uuid){\r\n        let path = ''\r\n        if(flashvars.offline === '1' && flashvars.single){\r\n            //独立\r\n            path = 'game' + flashvars.gid + '/json/' + uuid + '.json';\r\n        }\r\n        return path;\r\n    }\r\n\r\n    static spliceGif(arraybuffer) {\r\n        return new Promise((resolve, reject) => {\r\n\r\n            let currentData;\r\n            let currentPos = 0;\r\n            let hdr;\r\n            const tmpCanvas = document.createElement('canvas');\r\n            const spliceCanvas = document.createElement('canvas');\r\n            let frame;\r\n            let lastDisposalMethod;\r\n            let transparency = null;\r\n            let delay = null;\r\n            let disposalMethod = null;\r\n            let disposalRestoreFromIdx = null;\r\n            let lastImg = null;\r\n            let loopCount = 1;\r\n            const frames = [];\r\n\r\n            const bitsToNum = ba => {\r\n                return ba.reduce((s, n) => {\r\n                    return s * 2 + n;\r\n                }, 0);\r\n            };\r\n\r\n            const byteToBitArr = bite => {\r\n                const a = [];\r\n                for (let i = 7; i >= 0; i--) {\r\n                    a.push(!!(bite & (1 << i)));\r\n                }\r\n                return a;\r\n            };\r\n\r\n            const Stream = function (data) {\r\n                currentData = data;\r\n                currentPos = 0;\r\n\r\n                this.readByte = function () {\r\n                    if (currentPos >= data.length) {\r\n                        throw new Error('Attempted to read past end of stream.');\r\n                    }\r\n                    if (data instanceof Uint8Array)\r\n                        return data[currentPos++];\r\n                    else\r\n                        return data.charCodeAt(currentPos++) & 0xFF;\r\n                };\r\n\r\n                this.readBytes = function (n) {\r\n                    var bytes = [];\r\n                    for (var i = 0; i < n; i++) {\r\n                        bytes.push(this.readByte());\r\n                    }\r\n                    return bytes;\r\n                };\r\n\r\n                this.read = function (n) {\r\n                    var s = '';\r\n                    for (var i = 0; i < n; i++) {\r\n                        s += String.fromCharCode(this.readByte());\r\n                    }\r\n                    return s;\r\n                };\r\n\r\n                this.readUnsigned = function () { // Little-endian.\r\n                    var a = this.readBytes(2);\r\n                    return (a[1] << 8) + a[0];\r\n                };\r\n            };\r\n\r\n            const lzwDecode = (minCodeSize, data) => {\r\n                let pos = 0; // Maybe this streaming thing should be merged with the Stream?\r\n                let readCode = size => {\r\n                    let code = 0;\r\n                    for (let i = 0; i < size; i++) {\r\n                        if (data[pos >> 3] & (1 << (pos & 7))) {\r\n                            code |= 1 << i;\r\n                        }\r\n                        pos++;\r\n                    }\r\n                    return code;\r\n                };\r\n\r\n\r\n                let clearCode = 1 << minCodeSize;\r\n                let eoiCode = clearCode + 1;\r\n\r\n                let codeSize = minCodeSize + 1;\r\n\r\n                let outputBlockSize = 4096,\r\n                    bufferBlockSize = 4096;\r\n\r\n                let output = new Uint8Array(outputBlockSize),\r\n                    buffer = new Uint8Array(bufferBlockSize),\r\n                    dict = [];\r\n\r\n                let bufferOffset = 0,\r\n                    outputOffset = 0;\r\n\r\n\r\n                const fill = function () {\r\n                    for (let i = 0; i < clearCode; i++) {\r\n                        dict[i] = new Uint8Array(1);\r\n                        dict[i][0] = i;\r\n                    }\r\n                    dict[clearCode] = new Uint8Array(0);\r\n                    dict[eoiCode] = null;\r\n                };\r\n                const clear = function () {\r\n                    const keep = clearCode + 2;\r\n                    dict.splice(keep, dict.length - keep);\r\n                    codeSize = minCodeSize + 1;\r\n                    bufferOffset = 0;\r\n                };\r\n\r\n                // Block allocators, double block size each time\r\n                const enlargeOutput = function () {\r\n                    const outputSize = output.length + outputBlockSize;\r\n                    const newoutput = new Uint8Array(outputSize);\r\n                    newoutput.set(output);\r\n                    output = newoutput;\r\n                    outputBlockSize = outputBlockSize << 1;\r\n                };\r\n                const enlargeBuffer = function () {\r\n                    const bufferSize = buffer.length + bufferBlockSize;\r\n                    let newbuffer = new Uint8Array(bufferSize);\r\n                    newbuffer.set(buffer);\r\n                    buffer = newbuffer;\r\n                    bufferBlockSize = bufferBlockSize << 1;\r\n                };\r\n\r\n                const pushCode = function (code, last) {\r\n                    var newlength = dict[last].byteLength + 1;\r\n                    while (bufferOffset + newlength > buffer.length) enlargeBuffer();\r\n                    var newdict = buffer.subarray(bufferOffset, bufferOffset + newlength);\r\n                    newdict.set(dict[last]);\r\n                    newdict[newlength - 1] = dict[code][0];\r\n                    bufferOffset += newlength;\r\n                    dict.push(newdict);\r\n                };\r\n\r\n                let code;\r\n                let last;\r\n\r\n                fill();\r\n\r\n                while (true) {\r\n                    last = code;\r\n                    code = readCode(codeSize);\r\n\r\n                    if (code === clearCode) {\r\n                        clear();\r\n                        continue;\r\n                    }\r\n                    if (code === eoiCode) break;\r\n\r\n                    if (code < dict.length) {\r\n                        if (last !== clearCode) {\r\n                            pushCode(code, last);\r\n                        }\r\n                    }\r\n                    else {\r\n                        if (code !== dict.length) throw new Error('Invalid LZW code.');\r\n                        pushCode(last, last);\r\n                    }\r\n\r\n                    const newsize = dict[code].length;\r\n                    while (outputOffset + newsize > output.length) enlargeOutput();\r\n                    output.set(dict[code], outputOffset);\r\n                    outputOffset += newsize;\r\n\r\n                    if (dict.length === (1 << codeSize) && codeSize < 12) {\r\n                        // If we're at the last code and codeSize is 12, the next code will be a clearCode, and it'll be 12 bits long.\r\n                        codeSize++;\r\n                    }\r\n                }\r\n\r\n                // I don't know if this is technically an error, but some GIFs do it.\r\n                //if (Math.ceil(pos / 8) !== data.length) throw new Error('Extraneous LZW bytes.');\r\n                return output.subarray(0, outputOffset);\r\n            };\r\n\r\n            const setSizes = (w, h) => {\r\n                tmpCanvas.width = w;\r\n                tmpCanvas.height = h;\r\n                tmpCanvas.style.width = w + 'px';\r\n                tmpCanvas.style.height = h + 'px';\r\n                tmpCanvas.getContext('2d').setTransform(1, 0, 0, 1, 0, 0);\r\n                spliceCanvas.width = w;\r\n                spliceCanvas.height = w;\r\n            };\r\n\r\n            const clear = () => {\r\n                transparency = null;\r\n                delay = null;\r\n                lastDisposalMethod = disposalMethod;\r\n                disposalMethod = null;\r\n                frame = null;\r\n            };\r\n\r\n            const doHdr = _hdr => {\r\n                hdr = _hdr;\r\n                setSizes(hdr.width, hdr.height)\r\n            };\r\n\r\n            const doGCE = gce => {\r\n                pushFrame();\r\n                clear();\r\n                transparency = gce.transparencyGiven ? gce.transparencyIndex : null;\r\n                delay = gce.delayTime;\r\n                disposalMethod = gce.disposalMethod;\r\n                // We don't have much to do with the rest of GCE.\r\n            };\r\n\r\n            const pushFrame = () => {\r\n                if (!frame) return;\r\n                let dataUrl = tmpCanvas.toDataURL('image/png');\r\n                let blob = this.dataURLtoBlob(dataUrl);\r\n                frames.push({\r\n                    //base64: dataUrl,\r\n                    blobUrl: blob ? URL.createObjectURL(blob) : dataUrl,\r\n                    delay: Math.max(delay, 10)\r\n                });\r\n            };\r\n\r\n            const doImg = img => {\r\n                if (!frame) frame = tmpCanvas.getContext('2d');\r\n\r\n                const currIdx = frames.length;\r\n\r\n                //ct = color table, gct = global color table\r\n                const ct = img.lctFlag ? img.lct : hdr.gct; // TODO: What if neither exists?\r\n\r\n                if (currIdx > 0) {\r\n                    if (lastDisposalMethod === 3) {\r\n                        // Restore to previous\r\n                        // If we disposed every frame including first frame up to this point, then we have\r\n                        // no composited frame to restore to. In this case, restore to background instead.\r\n                        if (disposalRestoreFromIdx !== null) {\r\n                            if(frames[disposalRestoreFromIdx].data) frame.putImageData(frames[disposalRestoreFromIdx].data, 0, 0);\r\n                        } else {\r\n                            frame.clearRect(lastImg.leftPos, lastImg.topPos, lastImg.width, lastImg.height);\r\n                        }\r\n                    } else {\r\n                        disposalRestoreFromIdx = currIdx - 1;\r\n                    }\r\n\r\n                    if (lastDisposalMethod === 2) {\r\n                        // Restore to background color\r\n                        // Browser implementations historically restore to transparent; we do the same.\r\n                        // http://www.wizards-toolkit.org/discourse-server/viewtopic.php?f=1&t=21172#p86079\r\n                        frame.clearRect(lastImg.leftPos, lastImg.topPos, lastImg.width, lastImg.height);\r\n                    }\r\n                }\r\n                // else, Undefined/Do not dispose.\r\n                // frame contains final pixel data from the last frame; do nothing\r\n\r\n                //Get existing pixels for img region after applying disposal method\r\n                const imgData = frame.getImageData(img.leftPos, img.topPos, img.width, img.height);\r\n\r\n                //apply color table colors\r\n                for (let i = 0; i < img.pixels.length; i++) {\r\n                    const pixel = img.pixels[i];\r\n                    // imgData.data === [R,G,B,A,R,G,B,A,...]\r\n                    if (pixel !== transparency) {\r\n                        const pix = ct[pixel];\r\n                        const idx = i * 4;\r\n                        imgData.data[idx] = pix[0];\r\n                        imgData.data[idx + 1] = pix[1];\r\n                        imgData.data[idx + 2] = pix[2];\r\n                        imgData.data[idx + 3] = 255; // Opaque.\r\n                    }\r\n                }\r\n\r\n                frame.putImageData(imgData, img.leftPos, img.topPos);\r\n\r\n                lastImg = img;\r\n            };\r\n\r\n            const doNothing = function () {\r\n            };\r\n\r\n            const doNetscape = block => {\r\n                loopCount = block.iterations;\r\n            };\r\n\r\n            const handler = {\r\n                hdr: doHdr,\r\n                gce: doGCE,\r\n                com: doNothing,\r\n                // I guess that's all for now.\r\n                app: {\r\n                    // TODO: Is there much point in actually supporting iterations?\r\n                    NETSCAPE: doNetscape\r\n                },\r\n                img: doImg,\r\n                eof: () => {\r\n                    //toolbar.style.display = '';\r\n                    pushFrame();\r\n                }\r\n            };\r\n\r\n            const parseGIF = (st, handler) => {\r\n                handler || (handler = {});\r\n\r\n                // LZW (GIF-specific)\r\n                const parseCT = function (entries) { // Each entry is 3 bytes, for RGB.\r\n                    const ct = [];\r\n                    for (let i = 0; i < entries; i++) {\r\n                        ct.push(st.readBytes(3));\r\n                    }\r\n                    return ct;\r\n                };\r\n\r\n                const readSubBlocks = function () {\r\n                    let size, data, offset = 0;\r\n                    const bufsize = 8192;\r\n                    data = new Uint8Array(bufsize);\r\n\r\n                    const resizeBuffer = function () {\r\n                        const newdata = new Uint8Array(data.length + bufsize);\r\n                        newdata.set(data);\r\n                        data = newdata;\r\n                    };\r\n\r\n                    do {\r\n                        size = st.readByte();\r\n\r\n                        // Increase buffer size if this would exceed our current size\r\n                        while (offset + size > data.length) resizeBuffer();\r\n                        data.set(st.readBytes(size), offset);\r\n                        offset += size;\r\n                    } while (size !== 0);\r\n                    return data.subarray(0, offset); // truncate any excess buffer space\r\n                };\r\n\r\n                const parseHeader = function () {\r\n                    const hdr = {};\r\n                    hdr.sig = st.read(3);\r\n                    hdr.ver = st.read(3);\r\n                    if (hdr.sig !== 'GIF') throw new Error('Not a GIF file.'); // XXX: This should probably be handled more nicely.\r\n                    hdr.width = st.readUnsigned();\r\n                    hdr.height = st.readUnsigned();\r\n\r\n                    const bits = byteToBitArr(st.readByte());\r\n                    hdr.gctFlag = bits.shift();\r\n                    hdr.colorRes = bitsToNum(bits.splice(0, 3));\r\n                    hdr.sorted = bits.shift();\r\n                    hdr.gctSize = bitsToNum(bits.splice(0, 3));\r\n\r\n                    hdr.bgColor = st.readByte();\r\n                    hdr.pixelAspectRatio = st.readByte(); // if not 0, aspectRatio = (pixelAspectRatio + 15) / 64\r\n                    if (hdr.gctFlag) {\r\n                        hdr.gct = parseCT(1 << (hdr.gctSize + 1));\r\n                    }\r\n                    handler.hdr && handler.hdr(hdr);\r\n                };\r\n\r\n                const parseExt = function (block) {\r\n                    const parseGCExt = function (block) {\r\n                        const blockSize = st.readByte(); // Always 4\r\n                        const bits = byteToBitArr(st.readByte());\r\n                        block.reserved = bits.splice(0, 3); // Reserved; should be 000.\r\n                        block.disposalMethod = bitsToNum(bits.splice(0, 3));\r\n                        block.userInput = bits.shift();\r\n                        block.transparencyGiven = bits.shift();\r\n\r\n                        block.delayTime = st.readUnsigned();\r\n\r\n                        block.transparencyIndex = st.readByte();\r\n\r\n                        block.terminator = st.readByte();\r\n\r\n                        handler.gce && handler.gce(block);\r\n                    };\r\n\r\n                    const parseComExt = function (block) {\r\n                        block.comment = readSubBlocks();\r\n                        handler.com && handler.com(block);\r\n                    };\r\n\r\n                    const parsePTExt = function (block) {\r\n                        // No one *ever* uses this. If you use it, deal with parsing it yourself.\r\n                        const blockSize = st.readByte(); // Always 12\r\n                        block.ptHeader = st.readBytes(12);\r\n                        block.ptData = readSubBlocks();\r\n                        handler.pte && handler.pte(block);\r\n                    };\r\n\r\n                    const parseAppExt = function (block) {\r\n                        const parseNetscapeExt = function (block) {\r\n                            const blockSize = st.readByte(); // Always 3\r\n                            block.unknown = st.readByte(); // ??? Always 1? What is this?\r\n                            block.iterations = st.readUnsigned();\r\n                            block.terminator = st.readByte();\r\n                            handler.app && handler.app.NETSCAPE && handler.app.NETSCAPE(block);\r\n                        };\r\n\r\n                        const parseUnknownAppExt = function (block) {\r\n                            block.appData = readSubBlocks();\r\n                            // FIXME: This won't work if a handler wants to match on any identifier.\r\n                            handler.app && handler.app[block.identifier] && handler.app[block.identifier](block);\r\n                        };\r\n\r\n                        const blockSize = st.readByte(); // Always 11\r\n                        block.identifier = st.read(8);\r\n                        block.authCode = st.read(3);\r\n                        switch (block.identifier) {\r\n                            case 'NETSCAPE':\r\n                                parseNetscapeExt(block);\r\n                                break;\r\n                            default:\r\n                                parseUnknownAppExt(block);\r\n                                break;\r\n                        }\r\n                    };\r\n\r\n                    const parseUnknownExt = function (block) {\r\n                        block.data = readSubBlocks();\r\n                        handler.unknown && handler.unknown(block);\r\n                    };\r\n\r\n                    block.label = st.readByte();\r\n                    switch (block.label) {\r\n                        case 0xF9:\r\n                            block.extType = 'gce';\r\n                            parseGCExt(block);\r\n                            break;\r\n                        case 0xFE:\r\n                            block.extType = 'com';\r\n                            parseComExt(block);\r\n                            break;\r\n                        case 0x01:\r\n                            block.extType = 'pte';\r\n                            parsePTExt(block);\r\n                            break;\r\n                        case 0xFF:\r\n                            block.extType = 'app';\r\n                            parseAppExt(block);\r\n                            break;\r\n                        default:\r\n                            block.extType = 'unknown';\r\n                            parseUnknownExt(block);\r\n                            break;\r\n                    }\r\n                };\r\n\r\n                const parseImg = function (img) {\r\n                    const deinterlace = function (pixels, width) {\r\n                        // Of course this defeats the purpose of interlacing. And it's *probably*\r\n                        // the least efficient way it's ever been implemented. But nevertheless...\r\n                        var newPixels = new Array(pixels.length);\r\n                        var rows = pixels.length / width;\r\n                        var cpRow = function (toRow, fromRow) {\r\n                            var fromPixels = pixels.slice(fromRow * width, (fromRow + 1) * width);\r\n                            newPixels.splice.apply(newPixels, [toRow * width, width].concat(...fromPixels));\r\n                        };\r\n\r\n                        // See appendix E.\r\n                        var offsets = [0, 4, 2, 1];\r\n                        var steps = [8, 8, 4, 2];\r\n\r\n                        var fromRow = 0;\r\n                        for (var pass = 0; pass < 4; pass++) {\r\n                            for (var toRow = offsets[pass]; toRow < rows; toRow += steps[pass]) {\r\n                                cpRow(toRow, fromRow)\r\n                                fromRow++;\r\n                            }\r\n                        }\r\n\r\n                        return newPixels;\r\n                    };\r\n\r\n                    img.leftPos = st.readUnsigned();\r\n                    img.topPos = st.readUnsigned();\r\n                    img.width = st.readUnsigned();\r\n                    img.height = st.readUnsigned();\r\n\r\n                    var bits = byteToBitArr(st.readByte());\r\n                    img.lctFlag = bits.shift();\r\n                    img.interlaced = bits.shift();\r\n                    img.sorted = bits.shift();\r\n                    img.reserved = bits.splice(0, 2);\r\n                    img.lctSize = bitsToNum(bits.splice(0, 3));\r\n\r\n                    if (img.lctFlag) {\r\n                        img.lct = parseCT(1 << (img.lctSize + 1));\r\n                    }\r\n\r\n                    img.lzwMinCodeSize = st.readByte();\r\n\r\n                    var lzwData = readSubBlocks();\r\n\r\n                    img.pixels = lzwDecode(img.lzwMinCodeSize, lzwData);\r\n\r\n                    if (img.interlaced) { // Move\r\n                        img.pixels = deinterlace(img.pixels, img.width);\r\n                    }\r\n\r\n                    handler.img && handler.img(img);\r\n                };\r\n\r\n                const parseBlock = function () {\r\n                    var block = {};\r\n                    block.sentinel = st.readByte();\r\n\r\n                    switch (String.fromCharCode(block.sentinel)) { // For ease of matching\r\n                        case '!':\r\n                            block.type = 'ext';\r\n                            parseExt(block);\r\n                            break;\r\n                        case ',':\r\n                            block.type = 'img';\r\n                            parseImg(block);\r\n                            break;\r\n                        case ';':\r\n                            block.type = 'eof';\r\n                            handler.eof && handler.eof(block);\r\n                            break;\r\n                        default:\r\n                            throw new Error('Unknown block: 0x' + block.sentinel.toString(16)); // TODO: Pad this with a 0.\r\n                    }\r\n\r\n                    if (block.type !== 'eof') {\r\n                        setTimeout(parseBlock, 0);\r\n                    } else {\r\n                        resolve({\r\n                            loopCount: loopCount,\r\n                            frames: frames\r\n                        })\r\n                    }\r\n                };\r\n\r\n                const parse = () => {\r\n                    parseHeader();\r\n                    setTimeout(parseBlock, 0);\r\n                };\r\n\r\n                parse();\r\n            };\r\n\r\n            try {\r\n                const data = new Uint8Array(arraybuffer);\r\n                const stream = new Stream(data);\r\n                setTimeout(parseGIF(stream, handler), 0);\r\n            }\r\n            catch (err) {\r\n                reject(err);\r\n                console.error('parseGIF ERROR!!' + err);\r\n            }\r\n        })\r\n    }\r\n\r\n    static isObject(data) {\r\n        return Object.prototype.toString.apply(data) === '[object Object]';\r\n    }\r\n\r\n    static fixColorValue(color) {\r\n        const tempColor = color.match(/rgb\\([\\s]*(\\d+)[\\s]*,[\\s]*(\\d+)[\\s]*,[\\s]*(\\d+)[\\s]*\\)/i);\r\n        const toHex = value => {\r\n            const hex = parseInt(value, 10).toString(16);\r\n            if (hex.length !== 2) {\r\n                return '0' + hex;\r\n            } else {\r\n                return hex;\r\n            }\r\n        };\r\n\r\n        if (tempColor) {\r\n            color = '#' + toHex(tempColor[1]) + toHex(tempColor[2]) + toHex(tempColor[3]);\r\n            return color;\r\n        }\r\n\r\n        if (color && color[0] !== '#') {\r\n            color = '#' + color;\r\n        }\r\n\r\n        if (isNaN(parseInt(color.slice(1), 16))) {\r\n            color = '#ffffff';\r\n        }\r\n\r\n        return color ? color : '#ffffff';\r\n    }\r\n\r\n    static timeout(time = 0) {\r\n        let handle = null;\r\n        const promise = new Promise((resolve, reject) => handle = setTimeout(resolve, time));\r\n        promise.cancel = () => clearTimeout(handle);\r\n        return promise;\r\n    }\r\n\r\n    static getTimeOffset() {\r\n        if(flashvars.single && flashvars.offline=== '1'){\r\n            this.timeStamp = this.curLocalTime();\r\n            this.timeOffset = 0;\r\n            return Promise.resolve(this.timeOffset)\r\n        }\r\n        let url = 'https://my.3000.com/?m=timestamp&op=index&ac=get&api_v=1.0.0&api_from=webpc';\r\n        return xhr.xhrGetServerTime(url).then(rs => {\r\n            if (rs.responseText.length === 0) {\r\n                return Promise.reject('Get file failed, no response data');\r\n            }\r\n            let retData = JSON.parse(rs.responseText);\r\n            if (retData.status === 0) {\r\n                this.timeStamp = retData.data.timestamp;\r\n                this.timeOffset = this.timeStamp - this.curLocalTime();\r\n                return Promise.resolve(this.timeOffset);\r\n            }\r\n            else {\r\n                return Promise.reject(retData.msg + ': ' + retData.status);\r\n            }\r\n        }, rj => {\r\n            return Promise.reject(rj);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 本地时间定时器\r\n     * */\r\n    static localUpdateTime(){\r\n        if(Utils.localTime === -1) Utils.localTime = this.curLocalTime();\r\n        setInterval(()=>{\r\n            Utils.localTime ++;\r\n        },1000);\r\n    }\r\n    /**\r\n     * 本地当前的系统时间\r\n     * */\r\n    static curLocalTime(){\r\n        return Math.floor((new Date()).getTime() / 1000);\r\n    }\r\n\r\n    static updateContextTimeValues(context) {\r\n        if (-1 === this.timeStamp) return;\r\n        //context.systemValues[2].value = Math.floor(Date.now() / 1000) + this.timeOffset;\r\n        context.systemValues[2].value = Utils.localTime + this.timeOffset;\r\n        let date = new Date(context.systemValues[2].value * 1000);\r\n        context.systemValues[3].value = date.getFullYear();\r\n        context.systemValues[4].value = date.getMonth() + 1;\r\n        context.systemValues[5].value = date.getDate();\r\n        context.systemValues[6].value = date.getHours();\r\n        context.systemValues[7].value = date.getMinutes();\r\n        context.systemValues[8].value = date.getSeconds();\r\n        context.systemValues[10].value = date.getDay();\r\n    }\r\n\r\n    static getCurrentDateTime(timestamp) {\r\n        let date = new Date(timestamp);\r\n        let seperator1 = \"-\";\r\n        let seperator2 = \":\";\r\n        let toStr = function(value, max, min) {\r\n            if (value >= min && value <= max) {\r\n                return ('0' + value);\r\n            }\r\n            else{\r\n                return ('' + value);\r\n            }\r\n        };\r\n        let currentdate = date.getFullYear()\r\n            + seperator1 + toStr(date.getMonth() + 1, 9, 1)\r\n            + seperator1 + toStr(date.getDate(), 9, 0)\r\n            + \" \" + toStr(date.getHours(), 9, 0)\r\n            + seperator2 + toStr(date.getMinutes(), 9, 0)\r\n            + seperator2 + toStr(date.getSeconds(), 9, 0);\r\n        return currentdate;\r\n    }\r\n\r\n    static createBlob(parts, type) {\r\n        let BlobBuilder, bb;\r\n        try {\r\n            return new Blob([parts]);\r\n        } catch (e) {\r\n            BlobBuilder = window.BlobBuilder ||\r\n                window.WebKitBlobBuilder ||\r\n                window.MozBlobBuilder ||\r\n                window.MSBlobBuilder;\r\n            if (BlobBuilder) {\r\n                bb = new BlobBuilder();\r\n                bb.append(parts);\r\n                return bb.getBlob(type);\r\n            } else {\r\n                throw new Error(\"Unable to create blob\");\r\n            }\r\n        }\r\n    }\r\n\r\n    static dataURLtoBlob(dataUrl) {\r\n        let arr = dataUrl.split(','), mime = arr[0].match(/:(.*?);/)[1],\r\n            bStr = atob(arr[1]), n = bStr.length, u8arr = new Uint8Array(n);\r\n        while(n--){\r\n            u8arr[n] = bStr.charCodeAt(n);\r\n        }\r\n        let blobObj = null;\r\n        try {\r\n            blobObj = new Blob([u8arr], {type:mime});\r\n        } catch (err) {\r\n            console.error(err.name + '  ' + err.message);\r\n        }\r\n        return blobObj;\r\n    }\r\n\r\n    static encodeBase64(msg) {\r\n        if (msg === '') return '';\r\n        return Base64.encode(msg)\r\n    }\r\n\r\n    static decryptBase64(msg) {\r\n        if (msg === '') return '';\r\n        return Base64.decode(msg)\r\n    }\r\n\r\n    static aesEncrypt(msg, type) {\r\n        //msg = JSON.stringify({\"ss\": 1});\r\n        if (msg === '') return '';\r\n        let rawKey = 'de3kt|jq|fdcgj_|';\r\n        let rawVec = 'ff_|pf|#%@fw_j+q';\r\n        if (type === 1) {\r\n            rawKey = 'WDF#$H*#SJN*&G$&';\r\n            rawVec = 'JH&$GF$DR%*K@SC%';\r\n        }\r\n        else if (type === 2) {\r\n            // 获取已收费章节\r\n            rawKey = 'aDF#$HGF$DN*&G$e';\r\n            rawVec = 'bH&$GF$DcF#$HSCf';\r\n        }\r\n        else if (type === 3) {\r\n            // 获取商品购买信息\r\n            rawKey = 'aDF#$HGF$DN*&G$e';\r\n            rawVec = 'bH&$GF$DcF#$HSCf';\r\n        }\r\n        // 密钥\r\n        let key = CryptoJS.enc.Utf8.parse(rawKey);\r\n        // 初始向量\r\n        let ivv = CryptoJS.enc.Utf8.parse(rawVec);\r\n        // 加密\r\n        let encrypted = CryptoJS.AES.encrypt(msg+'', key, {iv: ivv, mode: CryptoJS.mode.CBC, padding: CryptoJS.pad.ZeroPadding});\r\n        // 转换为字符串\r\n        let enstr = encrypted.toString();\r\n        return enstr;\r\n    }\r\n\r\n    static aesDecrypt(msg, type) {\r\n        //msg = 'b25zHxn+S5dnVOrJPDn6DQ==';\r\n        if (msg === '') return '';\r\n        let rawKey = 'de3kt|jq|fdcgj_|';\r\n        let rawVec = 'ff_|pf|#%@fw_j+q';\r\n        if (type === 1) {\r\n            rawKey = 'WDF#$H*#SJN*&G$&';\r\n            rawVec = 'JH&$GF$DR%*K@SC%';\r\n        }\r\n        else if (type === 2) {\r\n            // 获取已收费章节\r\n            rawKey = 'aDF#$HGF$DN*&G$e';\r\n            rawVec = 'bH&$GF$DcF#$HSCf';\r\n        }else if(type === 4){\r\n            // 敏感词\r\n            rawKey = 'xiamenshanyi4399';\r\n            rawVec = '';\r\n        }\r\n        // 密钥\r\n        let key = CryptoJS.enc.Utf8.parse(rawKey);\r\n        // 初始向量\r\n        let ivv = CryptoJS.enc.Utf8.parse(rawVec);\r\n        //解密\r\n        let decrypted = CryptoJS.AES.decrypt(msg, key, {iv: ivv, mode: type !== 4 ? CryptoJS.mode.CBC : CryptoJS.mode.ECB, padding: CryptoJS.pad.ZeroPadding});\r\n        let deStr = decrypted.toString(CryptoJS.enc.Utf8);\r\n        return deStr;\r\n    }\r\n\r\n    static getCookie(name) {\r\n        let arr,reg = new RegExp(\"(^| )\"+name+\"=([^;]*)(;|$)\");\r\n        if(arr = document.cookie.match(reg))\r\n            return decodeURI(arr[2]);\r\n        else\r\n            return null;\r\n    }\r\n\r\n    static getUidByCookie() {\r\n        let uid = this.getCookie('SYPauth');\r\n        if (uid) {\r\n            let index = uid.indexOf('|');\r\n            uid = uid.substring(0, index);\r\n        }\r\n        return uid ? uid : '';\r\n    }\r\n\r\n    static generateUUID() {\r\n        let d = new Date().getTime();\r\n        let uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\r\n            let r = (d + Math.random()*16)%16 | 0;\r\n            d = Math.floor(d/16);\r\n            return (c=='x' ? r : (r&0x3|0x8)).toString(16);\r\n        });\r\n        return uuid;\r\n    }\r\n\r\n    static localStorageGetItem(key) {\r\n        if (flashvars.app_version < '1.2.0') {\r\n            return window.localStorage.getItem(key);\r\n        }\r\n        if (flashvars.client === 'android' && window.app) {\r\n            const retValue = window.app.localStorage_getItem(key);\r\n            return (retValue === '' ? null : retValue);\r\n        }\r\n        else if (flashvars.client === 'ios') {\r\n            let returnValue = null;\r\n\r\n            if(flashvars.offline === '1'){\r\n                returnValue = localStorage_getItem(key);\r\n            } else {\r\n                returnValue = window.localStorage.getItem(key);\r\n            }\r\n\r\n            if (returnValue === '') returnValue = null;\r\n\r\n            return returnValue;\r\n        }\r\n        else if (flashvars.client === '') {\r\n            return window.localStorage.getItem(key);\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    static localStorageSetItem(key, value) {\r\n        if (flashvars.app_version < '1.2.0') {\r\n            window.localStorage.setItem(key, value);\r\n            /*if (flashvars.client === 'android' || flashvars.client === 'ios') {\r\n                this.uploadLocalStorage(key);\r\n            }*/\r\n            return\r\n        }\r\n        if (flashvars.client === 'android') {\r\n            window.app && window.app.localStorage_setItem(key, value);\r\n        }\r\n        else if (flashvars.client === 'ios') {\r\n            const arg = {key: key, value: value};\r\n            if(flashvars.offline === '1'){\r\n                localStorage_setItem(JSON.stringify(arg));\r\n            }else{\r\n                window.webkit && window.webkit.messageHandlers.localStorage_setItem.postMessage(JSON.stringify(arg));\r\n                window.localStorage.setItem(key, value);\r\n            }\r\n        }\r\n        else {\r\n            window.localStorage.setItem(key, value);\r\n        }\r\n    }\r\n\r\n    static localStorageRemoveItem(key) {\r\n        if (flashvars.app_version < '1.2.0') {\r\n            window.localStorage.removeItem(key);\r\n            return;\r\n        }\r\n        if (flashvars.client === 'android') {\r\n            window.app && window.app.removeLocalStorage(key);\r\n        }\r\n        else if (flashvars.client === 'ios') {\r\n            if(flashvars.offline === '1'){\r\n                removeLocalStorage(key);\r\n            }else{\r\n                window.webkit && window.webkit.messageHandlers.removeLocalStorage.postMessage(key);\r\n                window.localStorage.removeItem(key);\r\n            }\r\n        }\r\n        else {\r\n            window.localStorage.removeItem(key);\r\n        }\r\n    }\r\n\r\n    static localStorageClear() {\r\n        window.localStorage.clear();\r\n    }\r\n\r\n    static getSensitiveWords() {\r\n        let url = 'https://mapi.3000api.com/apis/soft/v1.0/game-GetSensitiveStr.html';\r\n        let data = 'action=all';\r\n        return xhr.xhrSend(url, data).then(rs => {\r\n            if (rs.responseText.length === 0) {\r\n                return Promise.reject('getSensitiveWords failed, no response data');\r\n            }\r\n            let retData = JSON.parse(rs.responseText);\r\n            if (retData.code == 100) {\r\n                if(Object.prototype.toString.call(retData.result) == '[object Array]'){\r\n                    this.sensitiveWords = retData.result.concat();\r\n                }else{\r\n                    const data = JSON.parse(Utils.aesDecrypt(retData.result,4));\r\n                    this.sensitiveWords = data.concat();\r\n                }\r\n                return Promise.resolve();\r\n            }\r\n            else {\r\n                return Promise.reject();\r\n            }\r\n        }, rj => {\r\n            return Promise.reject(rj);\r\n        });\r\n    }\r\n\r\n    static getDeviceId() {\r\n        if (flashvars.client === 'android') {\r\n            let uuid = navigator.userAgent.match(/[0-9A-Za-z]{8}-[0-9A-Za-z]{4}-[0-9A-Za-z]{4}-[0-9A-Za-z]{4}-[0-9A-Za-z]{12}/g);\r\n            return uuid ? uuid[0] : '';\r\n        }\r\n        else if (flashvars.client === 'ios') {\r\n            let uuid = navigator.userAgent.match(/[0-9A-Za-z]{40}/g);\r\n            return uuid ? uuid[0] : '';\r\n        }\r\n        return '';\r\n    }\r\n\r\n    static formatNum(n) {\r\n        if (0 === n) return '00000';\r\n        else if (n < 10) return ('0000' + n);\r\n        else if (n < 100) return ('000' + n);\r\n        else return ('00' + n);\r\n    };\r\n\r\n    static sendStatistics() {\r\n        if (flashvars.client !== 'android' && flashvars.client !== 'ios') {\r\n            return Promise.resolve();\r\n        }\r\n\r\n        let deviceId = this.getDeviceId();\r\n        let stime = Math.floor((new Date()).getTime() / 1000) + this.timeOffset;\r\n        let sSign = 'mac_name=' + deviceId + '&time=' + stime + '&uid=' + flashvars.uid + '&v_key=shanyi_WDF#$H*#SJN*&G$&**';\r\n        sSign = this.aesEncrypt(MD5.hash(MD5.hash(sSign)), 1);\r\n        stime = this.aesEncrypt(stime, 1);\r\n\r\n        let url = 'https://app.3000.com/?m=statistics&op=start&ac=h5&v=' + flashvars.v + '&client=' + flashvars.client;\r\n        let data = 'mac_name=' + encodeURIComponent(this.aesEncrypt(deviceId, 1)) + '&uid=' + encodeURIComponent(this.aesEncrypt(flashvars.uid, 1))\r\n            + '&sign=' + encodeURIComponent(sSign) + '&time=' + encodeURIComponent(stime);\r\n        return xhr.xhrSend(url, data);\r\n    }\r\n\r\n    static sendSelOptions() {\r\n        const doSend = () => {\r\n            if (this.selOptions.length === 0) {\r\n                setTimeout(timerHandler(), 30000);\r\n                return Promise.resolve();\r\n            }\r\n\r\n            let url = 'https://www.3000.com/apis/client/v1.0/trace-optionClick.html?';\r\n            let data = 'from=h5&uuid=' + flashvars.uuid + '&optionid=' + JSON.stringify(this.selOptions);\r\n            return xhr.xhrLoad(url + data, '').then(() => {\r\n                this.selOptions.splice(0, this.selOptions.length);\r\n                setTimeout(timerHandler(), 30000);\r\n                return Promise.resolve();\r\n            }, () => {\r\n                setTimeout(timerHandler(), 30000);\r\n                return Promise.reject();\r\n            });\r\n        };\r\n        const timerHandler = () => {\r\n            return function () {\r\n                doSend();\r\n            }\r\n        };\r\n        setTimeout(timerHandler(), 30000);\r\n    }\r\n\r\n    static searchChapterByUUID(game, uuid) {\r\n        const searchChapter = (chapter) => {\r\n            if (chapter.uuid === uuid) {\r\n                return chapter;\r\n            }\r\n\r\n            for (var i = 0; i < chapter.subchapters.length; ++i) {\r\n                const result = searchChapter(chapter.subchapters[i]);\r\n                if (result) {\r\n                    return result;\r\n                }\r\n            }\r\n        };\r\n\r\n        let result = null;\r\n        for (var i = 0; i < game.chapters.length; ++i) {\r\n            result = searchChapter(game.chapters[i]);\r\n            if (result) {\r\n                return result;\r\n            }\r\n        }\r\n        return result; \r\n    }\r\n\r\n    /*static uploadLocalStorage(spKey) {\r\n        if (flashvars.app_version >= '1.2.0') {\r\n            return Promise.resolve();\r\n        }\r\n\r\n        const deviceId = this.getDeviceId();\r\n        const tag = window.localStorage.getItem('syUploaded');\r\n\r\n        const uploadOneItem = (key, value) => {\r\n            const sendData = (url, data) => {\r\n                return xhr.xhrSend(url, data).then(rs => {\r\n                    if (rs.responseText.length === 0) {\r\n                        window.localStorage.removeItem('syUploaded');\r\n                        return Promise.reject('uploadOneItem failed, no response data');\r\n                    }\r\n                    let retData = JSON.parse(rs.responseText);\r\n                    if (retData.status === 0) {\r\n                        return Promise.resolve();\r\n                    }\r\n                    else {\r\n                        window.localStorage.removeItem('syUploaded');\r\n                        return Promise.reject();\r\n                    }\r\n                }, rj => {\r\n                    window.localStorage.removeItem('syUploaded');\r\n                    return Promise.reject(rj);\r\n                });\r\n            };\r\n\r\n            let valueBase64 = this.encodeBase64(value);\r\n            let stime = Math.floor((new Date()).getTime() / 1000) + this.timeOffset;\r\n            let sSign = 'content=' + valueBase64 + '&game_key=' + key + '&h5_version=' + commit + '&mac_name=' + deviceId + '&time=' + stime+ '&v_key=shanyi_WDF#$H*#SJN*&G$&**';\r\n            sSign = this.aesEncrypt(MD5.hash(MD5.hash(sSign)), 1);\r\n            stime = this.aesEncrypt(stime, 1);\r\n\r\n            let url = 'https://app.3000.com/?m=cloud_save&op=back_up&ac=save&v=' + flashvars.v + '&client=' + flashvars.client;\r\n            let data = 'game_key=' + encodeURIComponent(this.aesEncrypt(key, 1)) + '&mac_name=' + encodeURIComponent(this.aesEncrypt(deviceId, 1)) + '&h5_version='\r\n                + encodeURIComponent(this.aesEncrypt(commit, 1)) + '&content=' + encodeURIComponent(this.aesEncrypt(valueBase64, 1))\r\n                + '&sign=' + encodeURIComponent(sSign) + '&time=' + encodeURIComponent(stime);\r\n\r\n            return sendData(url, data);\r\n        };\r\n        const uploadItemOneByOne = (index, times) => {\r\n            if (index >= window.localStorage.length) {\r\n                // 全部上传成功 设置标志\r\n                window.localStorage.setItem('syUploaded', '1');\r\n                return Promise.resolve();\r\n            }\r\n            if (times > 3) {\r\n                // 上传失败只尝试4次\r\n                return Promise.resolve();\r\n            }\r\n            let key = window.localStorage.key(index);\r\n            let data = window.localStorage.getItem(key);\r\n            let check = key.match(/[0-9A-Za-z]{8}-[0-9A-Za-z]{4}-[0-9A-Za-z]{4}-[0-9A-Za-z]{4}-[0-9A-Za-z]{12}/g);\r\n\r\n            if (!check) {\r\n                return uploadItemOneByOne(index+1, 0)\r\n            }\r\n            return uploadOneItem(key, data).then(() => {\r\n                return uploadItemOneByOne(index+1, 0)\r\n            }, () => {\r\n                return uploadItemOneByOne(index, times+1)\r\n            });\r\n        };\r\n\r\n        if (!deviceId) {\r\n            return Promise.resolve();\r\n        }\r\n        if (!spKey && tag !== '1') {\r\n            return uploadItemOneByOne(0, 0);\r\n        }\r\n        else if (spKey) {\r\n            // 上传特定数据\r\n            let data = window.localStorage.getItem(spKey);\r\n            return uploadOneItem(spKey, data);\r\n        }\r\n        return Promise.resolve();\r\n    }\r\n\r\n    static downloadLocalStorage() {\r\n        if (flashvars.app_version < '1.2.0') {\r\n            return Promise.resolve();\r\n        }\r\n        const tag = this.localStorageGetItem('syDownloaded');\r\n        if (tag === '1') {\r\n            return Promise.resolve();\r\n        }\r\n        const deviceId = this.getDeviceId();\r\n        if (!deviceId) {\r\n            return Promise.resolve();\r\n        }\r\n\r\n        let keys = [];\r\n        const getKeys = () => {\r\n            let stime = Math.floor((new Date()).getTime() / 1000) + this.timeOffset;\r\n            let sSign = 'mac_name=' + deviceId + '&time=' + stime + '&v_key=shanyi_WDF#$H*#SJN*&G$&**';\r\n            sSign = this.aesEncrypt(MD5.hash(MD5.hash(sSign)), 1);\r\n            stime = this.aesEncrypt(stime, 1);\r\n\r\n            let url = 'https://app.3000.com/?m=cloud_save&op=back_up&ac=all_key&v=' + flashvars.v + '&client=' + flashvars.client;\r\n            let data = 'mac_name=' + encodeURIComponent(this.aesEncrypt(deviceId, 1)) + '&sign=' + encodeURIComponent(sSign) + '&time=' + encodeURIComponent(stime);\r\n            return xhr.xhrSend(url, data).then(rs => {\r\n                if (rs.responseText.length === 0) {\r\n                    return Promise.reject('getKeys failed, no response data');\r\n                }\r\n                let retData = JSON.parse(rs.responseText);\r\n                if (retData.status === 0) {\r\n                    keys = retData.data.result.concat();\r\n                    return Promise.resolve();\r\n                }\r\n                else {\r\n                    return Promise.reject();\r\n                }\r\n            }, rj => {\r\n                return Promise.reject();\r\n            })\r\n        };\r\n        const getValue = (index) => {\r\n            let stime = Math.floor((new Date()).getTime() / 1000) + this.timeOffset;\r\n            let sSign = 'game_key=' + keys[index] + '&mac_name=' + deviceId + '&time=' + stime + '&v_key=shanyi_WDF#$H*#SJN*&G$&**';\r\n            sSign = this.aesEncrypt(MD5.hash(MD5.hash(sSign)), 1);\r\n            stime = this.aesEncrypt(stime, 1);\r\n\r\n            let url = 'https://app.3000.com/?m=cloud_save&op=back_up&ac=info&v=' + flashvars.v + '&client=' + flashvars.client;\r\n            let data = 'game_key=' + encodeURIComponent(this.aesEncrypt(keys[index], 1)) + '&mac_name=' + encodeURIComponent(this.aesEncrypt(deviceId, 1))\r\n                + '&sign=' + encodeURIComponent(sSign) + '&time=' + encodeURIComponent(stime);\r\n\r\n            return xhr.xhrSend(url, data).then(rs => {\r\n                if (rs.responseText.length === 0) {\r\n                    return Promise.reject('getLocalStorageData failed, no response data');\r\n                }\r\n                let retData = JSON.parse(rs.responseText);\r\n                if (retData.status === 0) {\r\n                    let d = this.decryptBase64(retData.data.content);\r\n                    this.localStorageSetItem(keys[index], d);\r\n                    return Promise.resolve();\r\n                }\r\n                else {\r\n                    return Promise.reject();\r\n                }\r\n            }, rj => {\r\n                return Promise.reject();\r\n            })\r\n        };\r\n        const getItemOneByOne = (index) => {\r\n            if (index >= keys.length) {\r\n                // 数据已全部下载\r\n                this.localStorageSetItem('syDownloaded', '1');\r\n                return Promise.resolve();\r\n            }\r\n            return getValue(index).then(rs => {\r\n                return getItemOneByOne(index+1)\r\n            }, rj => {\r\n                return Promise.reject()\r\n            })\r\n        };\r\n\r\n        return getKeys().then(rs => {\r\n            return getItemOneByOne(0)\r\n        }, rj => {\r\n            return Promise.reject()\r\n        });\r\n    }*/\r\n}\r\n\r\nUtils.timeStamp = -1;        // 服务器时间戳\r\nUtils.timeOffset = 0;       // 与服务器间时间偏移量\r\nUtils.sensitiveWords = [];  // 敏感词\r\nUtils.selOptions = [];      // 游戏经过的选项uuid\r\nUtils.soundVolume = 1;      //音效大小百分比\r\nUtils.musicVolume = 1;      //音乐大小百分比\r\nUtils.localTime = -1;       //游戏开始时本地获取到的本地时间\r\n\r\nclass DelayRemoveManager {\r\n    constructor(){\r\n        this.gifList = [];\r\n        this.imgList = [];\r\n    }\r\n\r\n    popGif() {\r\n        const index = this.gifList.findIndex(c => ResourcesManager.getCount('img', c.key) === 1);\r\n        if (~index) {\r\n            const { key } = this.gifList[index];\r\n            this.gifList.splice(index, 1);\r\n            ResourcesManager.removeFromCache('img', key, true);\r\n        }\r\n    }\r\n\r\n    popImg() {\r\n        const index = this.imgList.findIndex(c => ResourcesManager.getCount('img', c.key) === 1);\r\n        if (~index) {\r\n            const { key } = this.imgList[index];\r\n            this.imgList.splice(index, 1);\r\n            ResourcesManager.removeFromCache('img', key, true);\r\n        }\r\n    }\r\n\r\n    push(key, isGif) {\r\n        if (isGif) {\r\n            this.gifList.push({ key, timestamp: Date.now() });\r\n            ResourcesManager.addRefCount('img', key, 'cache');\r\n            if (this.gifList.length > 20) {\r\n                this.popGif();\r\n            }\r\n        } else {\r\n            this.imgList.push({ key, timestamp: Date.now() });\r\n            ResourcesManager.addRefCount('img', key, 'cache');\r\n            if (this.imgList.length > 100) {\r\n                this.popImg();\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport class ResourcesManager {\r\n    static pushInLoader(url, type, key, isPlot) {\r\n        const sKey = key || url;\r\n        if (('img' === type && this.cache.checkImageKey(sKey) ||\r\n                'audio' === type && this.cache.checkSoundKey(sKey)) &&\r\n            !('ios' === flashvars.client && 'audio' === type && flashvars.app_version >= '1.5.0')) {\r\n            return Promise.resolve(false);\r\n        }\r\n        return Utils.convertToAllowAccessControlOriginUrl(url).then(url => {\r\n            if (!url) {\r\n                return false;\r\n            }\r\n            const noLoading = !this.load.getAsset('img' === type ? 'image' : 'audio', sKey);\r\n            if ('img' === type) {\r\n                noLoading && this.load.image(sKey, url);\r\n                !isPlot && this.addRefCount(\"img\", sKey, 'global');\r\n            } else if ('audio' === type) {\r\n                let bAutoDecode = this.forceDecode.music === sKey || this.forceDecode.sounds.some(k => k === sKey);\r\n                if ('ios' === flashvars.client && flashvars.app_version >= '1.5.0') {\r\n                    const noCache = !PhoneUtils.isAudioInCache(sKey) && !PhoneUtils.isLoadingAudio(sKey);\r\n                    if (noCache) {\r\n                        PhoneUtils.loadAudioUrl(sKey, url, flashvars.offline);\r\n                    }\r\n                    return noCache;\r\n                } else {\r\n                    noLoading && this.load.audio(sKey, url, bAutoDecode);\r\n                }\r\n                !isPlot && this.addRefCount(\"audio\", sKey, 'global');\r\n            }\r\n            return noLoading;            \r\n        }, e => console.error(\"Invalid URL: \" + e))\r\n    }\r\n\r\n    static forEachReCount(fun) {\r\n        Object.keys(this.refCount.audio).forEach(key => fun && fun('audio', key, this.getCount('audio', key)));\r\n        Object.keys(this.refCount.img).forEach(key => fun && fun('img', key, this.getCount('img', key)));\r\n    }\r\n\r\n    static resetReCount(filterKeys=[]) {\r\n        [this.refCount.img, this.refCount.audio].forEach((obj, i) => {\r\n            Object.keys(obj).forEach(key => {\r\n                const oldData = obj[key];\r\n                const { global=0, cache=0 } = oldData;\r\n                const newData = { global, cache };\r\n                const keys = Object.keys(obj[key]);\r\n                filterKeys.forEach(key => keys.forEach(k => ~k.indexOf(key) ? newData[k] = oldData[k] : void 0));\r\n                obj[key] = newData;\r\n            });\r\n        });\r\n    }\r\n\r\n    static updateRefTypePrefix(prefix, keep = true, remove = true) {\r\n        [this.refCount.img, this.refCount.audio].forEach((obj, i) => {\r\n            Object.keys(obj).forEach(key => {\r\n                if(!obj.hasOwnProperty(key)){\r\n                    return;\r\n                }\r\n                Object.keys(obj[key]).forEach(k => {\r\n                    if (k.startsWith(prefix)) {\r\n                        const refCount = k.replace(prefix, '');\r\n                        keep && refCount && (obj[key][refCount] = (obj[key][refCount] || 0)+(obj[key][k] || 0));\r\n                        delete obj[key][k];\r\n                        remove && this.removeFromCache(i ? 'audio' : 'img', key);\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    }\r\n\r\n    static transferRefCount(type, fKey, fRefType, tKey, tRefType) {\r\n        this.refCount[type][tKey] = this.refCount[type][tKey] || {};\r\n        this.refCount[type][tKey][tRefType] = this.refCount[type][tKey][tRefType] || 0;\r\n        if (!this.refCount[type][fKey]) {\r\n            return;\r\n        }\r\n        this.refCount[type][tKey][tRefType] += this.refCount[type][fKey][fRefType];\r\n        this.refCount[type][fKey][fRefType] = 0;\r\n        this.removeFromCache(type, fKey);\r\n    }\r\n\r\n    static transferByRefCount(fRefType, tRefType) {\r\n        [this.refCount.img, this.refCount.audio].forEach(obj => {\r\n            Object.keys(obj).forEach(key => {\r\n                const refCount = obj[key];\r\n                refCount[tRefType] = (refCount[tRefType] || 0)+(refCount[fRefType] || 0);\r\n                delete refCount[fRefType];\r\n            });\r\n        });\r\n    }\r\n\r\n    static transferByRefCountByPrefix(prefix, refType) {\r\n        [this.refCount.img, this.refCount.audio].forEach(obj => {\r\n            Object.keys(obj).forEach(key => {\r\n                const refCount = obj[key];\r\n                let count = 0;\r\n                Object.keys(refCount).forEach(k => {\r\n                    if (k.startsWith(prefix)) {\r\n                        count += refCount[k]\r\n                        delete refCount[k];\r\n                    }\r\n                });\r\n                refCount[refType] = (refCount[refType] || 0) + count;\r\n            });\r\n        });\r\n    }\r\n    \r\n    static addRefCount(type, key, refType='play', count=1) {\r\n        if (!type || !key) {\r\n            return;\r\n        }\r\n        this.load.cancelForceRemoveFile(type, key);\r\n        this.refCount[type][key] = this.refCount[type][key] || {};\r\n        this.refCount[type][key][refType] = (this.refCount[type][key][refType] || 0) + count;\r\n    }\r\n\r\n    static subRefCount(type, key, refType='play') {\r\n        if (this.refCount[type][key]) {\r\n            const keys = Object.keys(this.refCount[type][key]);\r\n            for (let i = 0; i < keys.length; i++) {\r\n                if (/^\\$([A-Za-z0-9]*-){4}([A-Za-z0-9]*)l\\d/.test(keys[i])) {\r\n                    return;\r\n                }\r\n            }\r\n            const refCount = this.refCount[type][key];\r\n            refCount[refType] = (refCount[refType] || 0) - 1;\r\n            refCount[refType] = refCount[refType] < 0 ? 0 : refCount[refType];\r\n            this.removeFromCache(type, key);\r\n        }\r\n        else if ('audio' === type && 'ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n            !!key && PhoneUtils.removeAudioUrl(key);\r\n        }\r\n    }\r\n\r\n    static delRefTypeCount(type, key, refType) {\r\n        if (this.refCount[type][key]) {\r\n            const refCount = this.refCount[type][key];\r\n            refCount[refType] = 0;\r\n            this.removeFromCache(type, key);\r\n        }\r\n    }\r\n\r\n    static delByRefType(refType){\r\n        [this.refCount.img, this.refCount.audio].forEach((obj, i) => {\r\n            Object.keys(obj).forEach(key => {\r\n                delete obj[key];\r\n                this.removeFromCache(i ? 'audio' : 'img', key);\r\n            });\r\n        });\r\n    }\r\n\r\n    static getCount(type, key, refType = '') {\r\n        return this.refCount[type][key]\r\n            ? (refType ? (this.refCount[type][key][refType] || 0) : Object.keys(this.refCount[type][key]).reduce((acc, cur) => acc + this.refCount[type][key][cur], 0))\r\n            : 0;\r\n    }\r\n\r\n    static isGlobal(type, key) {\r\n        return this.refCount[type][key]['global'] > 0;\r\n    }\r\n\r\n    static removeFromCache(type, key, force = false) {\r\n        if (!this.refCount[type][key]) {\r\n            return;\r\n        }\r\n       \r\n        if (this.getCount(type, key) && !force) {\r\n            return;\r\n        }\r\n\r\n        const { background, music, sounds, preBackground } = this.usingKeyMap;\r\n        if (background === key || preBackground === key || music === key) {\r\n            this.addRefCount(type, key);\r\n            return;\r\n        }\r\n        for (let i = 0; i < sounds.length; i++) {\r\n            if (sounds[i] === key) {\r\n                this.addRefCount(type, key);\r\n                return;\r\n            }\r\n        }\r\n\r\n        if (type === 'audio' && this.cache) {\r\n            if ('ios' === flashvars.client && flashvars.app_version >= '1.5.0') {\r\n                PhoneUtils.removeAudioUrl(key);\r\n            }\r\n            else {\r\n                const sound = this.cache.getSound(key);\r\n                if (sound && sound.audioTag && sound.data) {\r\n                    sound.data.free = true;\r\n                }\r\n                if (sound && /blob:/i.test(sound.url)) {\r\n                    URL.revokeObjectURL(sound.url);\r\n                }\r\n                this.cache.checkSoundKey(key) && this.cache.removeSound(key);\r\n                this.load.forceRemoveFile(type, key);\r\n            }\r\n            this.PreloadState.size += 2000000;\r\n        }\r\n\r\n        if (type === 'img' && this.cache) {\r\n            if (key.indexOf(\"?\") >= 0){\r\n                key = key.substr(0, key.indexOf(\"?\"));\r\n            }\r\n            const extension = key.substr((Math.max(0, key.lastIndexOf(\".\")) || Infinity) + 1).toLowerCase();\r\n            if (!force) {\r\n                this.delayRemoveManager.push(key, extension === 'gif');\r\n                this.PreloadState.size += 200000;\r\n                this.startPreloadResources();\r\n                return;\r\n            }\r\n            const image = this.cache.getImage(key, true);\r\n            if(image){\r\n                const { frames } = image.data;\r\n                frames && frames.forEach((frame) => {\r\n                    URL.revokeObjectURL(frame.blobUrl);\r\n                    frame.blobUrl = null;\r\n                });\r\n                /blob:/i.test(image.url) && URL.revokeObjectURL(image.url);\r\n                this.cache.checkImageKey(key) && this.cache.removeImage(key);\r\n                this.load.forceRemoveFile('image', key);\r\n            }\r\n            this.PreloadState.size += 200000;\r\n        }\r\n        delete this.refCount[type][key];\r\n        this.startPreloadResources();\r\n    }\r\n\r\n    static startPreloadResources() {\r\n        if (this.PreloadState.loading || this.PreloadState.size <= 0) {\r\n            return;\r\n        }\r\n        this.PreloadState.loading = true;\r\n\r\n        const createhMark = ({ context, chapter, pIndex, cmdInfo, cIndex, preloadType, preloadedCount, lock }) => {\r\n            const { ...c } = context;\r\n            c.stack = [...(c.stack || [])];\r\n            c.cmdStack = [...(c.cmdStack || [])];\r\n            return { context: c, chapter, pIndex, cmdInfo, cIndex, preloadType, preloadedCount, lock };\r\n        };\r\n\r\n        const getOptinsMarks = (plot, type, mark) => {\r\n            const { context, chapter, pIndex = 0, cmdInfo, cIndex = 0, preloadType } = mark;\r\n            let marks = [];\r\n            const options = plot[type] || [];\r\n            for(let i=0; i< options.length; i++){\r\n                const option = options[i];\r\n                if(!option.plots.length){\r\n                    continue;\r\n                }\r\n                let temp = createhMark(mark);\r\n                temp.chapter = {plots: option.plots, uuid: chapter.uuid};;\r\n                temp.pIndex = 0;\r\n                const t = type === 'options' ? 'o' : (option.type !== 'branch' && this.checkCondOptionResources(option) <= 50 ? 'l' : 'c');\r\n                temp.preloadType = `${preloadType==='play'?'':preloadType}$${plot.uuid}${t}${i}-`;\r\n                if(option.plots[0].commands){\r\n                    temp.cmdInfo = { commands: option.plots[0].commands };\r\n                    temp.cIndex = 0;\r\n                }\r\n                marks.push(temp);\r\n            }\r\n            return marks;\r\n        };\r\n\r\n        const getCmdOptinsMarks = (cmd, mark) => {\r\n            const { context, chapter, pIndex = 0, cmdInfo, cIndex = 0, preloadType } = mark;\r\n            let marks = [];\r\n            const options = cmd.args;\r\n            for(let i=0; i< options.length; i++){\r\n                const option = options[i];\r\n                if(!option.commands.length){\r\n                    continue;\r\n                }\r\n                let temp = createhMark(mark);\r\n                temp.cmdInfo = { commands: option.commands, parentInfo: cmdInfo, parentCmdIndex: cIndex };\r\n                temp.cIndex = 0;\r\n                let t = cmd.type === 'options' ? 'o' : (option.type !== 'branch' && this.checkCondOptionResources(option, 'command') <= 50 ? 'l' : 'c');\r\n                temp.preloadType = `${preloadType==='play'?'':preloadType}$${cmd.uuid}${t}${i}-`;\r\n                marks.push(temp);\r\n            }\r\n            return marks;\r\n        };\r\n\r\n        const updateMarkCmdInfo = (mark) => {\r\n            if (!mark.cmdInfo && mark.chapter.plots.length > mark.pIndex && mark.chapter.plots[mark.pIndex].commands) {\r\n                mark.cmdInfo = { commands: mark.chapter.plots[mark.pIndex].commands };\r\n                mark.cIndex = 0;\r\n            }\r\n        };\r\n\r\n        const updateMark = (mark, type, data) => {\r\n            mark = createhMark(mark);\r\n            let { context, chapter, cmdInfo, preloadType, pIndex=0, cIndex=0 } = mark;\r\n            let newChapter = null;\r\n            let temp = null;\r\n            switch(type){\r\n                case 'pop':\r\n                    temp = context.stack[0];\r\n                    context.stack = context.stack.slice(1);\r\n                    mark.chapter = chapter.parent.pChapter;\r\n                    mark.pIndex = chapter.parent.pnPlot + 1;\r\n                    mark.preloadType = 'play';\r\n                    mark.cmdInfo = null;\r\n                    if(temp && temp.type === 'insert'){\r\n                        context.cmdStack = context.cmdStack.slice(1);\r\n                        mark.cmdInfo = temp.cmdInfo;\r\n                        mark.cIndex = temp.cmdIndex + 1; \r\n                        mark.preloadType = temp.preloadType || 'play';\r\n                        mark.pIndex--;\r\n                    }\r\n                    updateMarkCmdInfo(mark);\r\n                    break;\r\n                case 'jump':\r\n                case 'command-jump':\r\n                    context._preMark = { stack:[], cmdStack:[], chapter, cmdInfo, pIndex, cIndex, preloadType };\r\n                    context.stack = [];\r\n                    context.cmdStack = [];\r\n                    mark.cmdInfo = null;\r\n                    mark.chapter = Utils.searchChapterByUUID(this.gameData, data);\r\n                    mark.pIndex = 0;\r\n                    mark.preloadType = `${preloadType==='play'?'':preloadType}$${mark.chapter.uuid}j`;\r\n                    updateMarkCmdInfo(mark);\r\n                    break;\r\n                case 'insert':\r\n                case 'command-insert':\r\n                    context._preMark = { stack:context.stack, cmdStack:context.cmdStack, chapter, cmdInfo, pIndex, cIndex, preloadType };\r\n                    context.stack = [];\r\n                    context.cmdStack = [];\r\n                    mark.cmdInfo = null;\r\n                    mark.chapter = Utils.searchChapterByUUID(this.gameData, data);\r\n                    mark.pIndex = 0;\r\n                    mark.preloadType = `${preloadType==='play'?'':preloadType}$${mark.chapter.uuid}i`;\r\n                    updateMarkCmdInfo(mark);\r\n                    break;\r\n                case 'command-pop':\r\n                    mark.cmdInfo = cmdInfo && cmdInfo.parentInfo || null;\r\n                    mark.cIndex = (cmdInfo && cmdInfo.parentCmdIndex || 0) + 1;\r\n                    if (cmdInfo.parentInfo) {\r\n                        mark.preloadType = 'play';\r\n                        context.cmdStack = context.cmdStack.slice(1);\r\n                    } else {\r\n                        mark.cmdInfo = null;\r\n                        mark.pIndex++;\r\n                        updateMarkCmdInfo(mark);\r\n                    }\r\n                    break;\r\n                case 'command-break':\r\n                    mark.cmdInfo = null;\r\n                    mark.pIndex++;\r\n                    updateMarkCmdInfo(mark);\r\n                    break;\r\n            }\r\n            return mark;\r\n        }\r\n\r\n        const updateLoadedMarks = () => {\r\n            const specialTypes = ['jump', 'insert', 'back', 'options', 'conditionOptions', 'addImage', 'showDialog', 'playMusic', 'playSound', 'weather'];\r\n            for (let j = 0, len = this.LoadedMark.length; this.LoadedMark && j < len; j++) {\r\n                for (let i = 0; this.LoadedMark[j] && i < this.LoadedMark[j].length; i++) {\r\n                    let mark = this.LoadedMark[j][i];\r\n                    let { context, chapter, pIndex = 0, cmdInfo, cIndex = 0, preloadType } = mark;\r\n\r\n                    const weight = isNoUrgentlyMark(mark);\r\n                    if(weight){\r\n                        let optionCount = 0;\r\n                        if (cmdInfo) {\r\n                            const cmd = cmdInfo.commands[cIndex] || {};\r\n                            const { type, args } = cmd;\r\n                            optionCount = type === 'options' || type === 'conditionOptions' ? args.length : 0;\r\n                        } else {\r\n                            const plot = chapter.plots[pIndex] || {};\r\n                            const { options=[], condition_options=[] } = plot;\r\n                            optionCount = Math.max(options.length, condition_options.length);\r\n                        }\r\n                      \r\n                        if(optionCount>5){\r\n                           // console.log(1);\r\n                        }\r\n                        mark.preloadedCount = mark.preloadedCount || 0;\r\n                        if (mark.preloadedCount > 10 || (weight === 2 && mark.preloadedCount > 1) || optionCount > 8) {\r\n                            mark.lock = true;\r\n                            continue;\r\n                        } else {\r\n                            mark.preloadedCount++;\r\n                        }\r\n                    }\r\n\r\n                    if (mark.lock) {\r\n                        mark.lock = false;\r\n                        mark.preloadedCount = 0;\r\n                        continue;\r\n                    }\r\n\r\n                    if (cmdInfo) {\r\n                        if (cmdInfo.commands.length <= cIndex) {\r\n                            this.LoadedMark[j].splice(i--, 1);\r\n                            if ((context.stack.length || context.cmdStack.length) && cmdInfo.parentInfo) {\r\n                                this.pushLoadMarks([updateMark(mark, 'command-pop')]);\r\n                            } else if (!cmdInfo.parentInfo) {\r\n                                this.pushLoadMarks([updateMark(mark, 'command-break')]);\r\n                            }\r\n                        } else {\r\n                            const command = cmdInfo.commands[cIndex] || {};\r\n                            const { type, args } = command;\r\n                            if (type === 'options' || type === 'conditionOptions') {\r\n                                const marks = getCmdOptinsMarks(command, mark);\r\n                                mark.cIndex++;\r\n                                marks.length && this.pushLoadMarks(marks);\r\n                            } else if (type === 'back' || type === 'jump' || type === 'insert') {\r\n                                if (type !== 'insert') {\r\n                                    this.LoadedMark[j].splice(i--, 1);\r\n                                }\r\n                                type === 'jump' && this.pushLoadMarks([updateMark(mark, `command-jump`, args[0])]);\r\n                                type === 'insert' && this.pushLoadMarks([updateMark(mark, `command-insert`, args[0])]);\r\n                                mark.cIndex++;\r\n                            } else {\r\n                                let { type } = cmdInfo.commands[++mark.cIndex] || {};\r\n                                while (type && !specialTypes.some(t => t === type)) {\r\n                                    ({ type } = cmdInfo.commands[++mark.cIndex] || {});\r\n                                }\r\n                            }\r\n                        }\r\n                    } else if (chapter.plots.length <= pIndex) {\r\n                        this.LoadedMark[j].splice(i--, 1);\r\n                        if (context.stack.length) {\r\n                            mark = updateMark(mark, 'pop');\r\n                            this.pushLoadMarks([mark]);\r\n                        }\r\n                    } else {\r\n                        const plot = chapter.plots[pIndex] || {};\r\n                        const { options=[], condition_options=[] } = plot;\r\n                        if (options.length || condition_options.length) {\r\n                            const oMarks = getOptinsMarks(plot, 'options', mark);\r\n                            const cMarks = getOptinsMarks(plot, 'condition_options', mark);\r\n\r\n                            mark.pIndex++;\r\n                            updateMarkCmdInfo(mark);\r\n\r\n                            oMarks.length && this.pushLoadMarks(oMarks);\r\n                            cMarks.length && this.pushLoadMarks(cMarks);\r\n                        } else if(plot.back || plot.jump || plot.insert){\r\n                            if (!plot.insert) {\r\n                                this.LoadedMark[j].splice(i--, 1);\r\n                            }\r\n                            plot.jump && this.pushLoadMarks([updateMark(mark, 'jump', plot.jump)]);\r\n                            plot.insert && this.pushLoadMarks([updateMark(mark, 'insert', plot.insert)]);\r\n                            mark.pIndex++;\r\n                            updateMarkCmdInfo(mark);\r\n                        } else {   \r\n                            mark.pIndex++;\r\n                            updateMarkCmdInfo(mark);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            for (let i = 0; this.LoadedMark && i < this.LoadedMark.length; i++) {\r\n                if(this.LoadedMark[i] && !this.LoadedMark[i].length){\r\n                    this.LoadedMark.splice(i--, 1);\r\n                }\r\n            }\r\n        };\r\n\r\n        const revertMark = mark => {\r\n            if(mark.context._preMark){\r\n                let { stack, cmdStack, chapter } = mark.context._preMark;\r\n                mark.context.stack = stack;\r\n                mark.context.cmdStack = cmdStack;\r\n                mark.chapter = chapter;\r\n                mark.pIndex = 0;\r\n                updateMarkCmdInfo(mark);\r\n                delete mark.context._preMark;\r\n            }\r\n        };\r\n\r\n        const loadChapter = mark => {\r\n            const { chapter } = mark;\r\n            if (chapter.md5 && chapter.plots.length === 0 && flashvars.offline !== '1' && !chapter.chapter) {//非离线，非付费章节\r\n                const chapterUuid = chapter.downloadUuid ? chapter.downloadUuid : chapter.uuid;\r\n                let loadChapterPromise = null;\r\n                const handle = ({ type, plots=[] }) => {\r\n                    if (type === 'revert') {\r\n                        revertMark(mark);\r\n                    } else if (type === 'succes') {\r\n                        chapter.plots.length === 0 && chapter.plots.push(...plots);\r\n                        this.PreloadState.loadingChapterMap[chapterUuid] = null;\r\n                    }\r\n                    return mark;\r\n                };\r\n                if(this.PreloadState.loadingChapterMap[chapterUuid]){\r\n                    return this.PreloadState.loadingChapterMap[chapterUuid].then(handle);\r\n                }\r\n                loadChapterPromise = this.sceneProxy.checkIfChapterFree(chapterUuid, chapter.md5, false).then(\r\n                    (plots=[]) => {\r\n                        return {type:'succes', plots};\r\n                    }, (msg) => {\r\n                        console.warn(msg);\r\n                    });\r\n                this.PreloadState.loadingChapterMap[chapterUuid] = loadChapterPromise;\r\n                return loadChapterPromise.then(handle);\r\n            }\r\n            return Promise.resolve(mark);\r\n        };\r\n        \r\n        const isNoUrgentlyMark = mark => {\r\n            let { preloadType='play' } = mark;\r\n            const types = preloadType.split('$').slice(1).map(s => {\r\n                const t = s.slice(36);\r\n                if (/j$/.test(t)) {\r\n                    return 'jump';\r\n                } else if (/i$/.test(t)) {\r\n                    return 'insert';\r\n                } else if (/o\\d-$/.test(t)) {\r\n                    return 'option';\r\n                } else if (/(c|l)\\d-$/.test(t)) {\r\n                    return 'condOption';\r\n                }\r\n            });\r\n            let optionIndexs = [];\r\n            let condOptionIndexs = [];\r\n            let gotoIndexs = [];\r\n            let result = 0;\r\n            for (let i = 0; i < types.length; i++) {\r\n                switch (types[i]) {\r\n                    case 'option':\r\n                        optionIndexs.push(i);\r\n                        if (gotoIndexs.length) {\r\n                            return 2;\r\n                        }\r\n                        if (optionIndexs.length > 2) {\r\n                            return 2;\r\n                        } else if (optionIndexs.length === 2) {\r\n                            result = 1;\r\n                        }\r\n                        break;\r\n                    case 'condOption':\r\n                        condOptionIndexs.push(i);\r\n                        if (condOptionIndexs.length > 2 && gotoIndexs.length >= 1) {\r\n                            return 2;\r\n                        }\r\n                        if(condOptionIndexs.length > 2){\r\n                            result = 1;\r\n                        }\r\n                        break;\r\n                    case 'jump':\r\n                    case 'insert':\r\n                        gotoIndexs.push(i);\r\n                        result = 1;\r\n                        if (optionIndexs.length > 1) {\r\n                            return 2;\r\n                        }\r\n                        if (gotoIndexs.length > 1) {\r\n                            return 2;\r\n                        }\r\n                        break;\r\n                }\r\n                if (gotoIndexs.length && condOptionIndexs.length + optionIndexs.length > 2) {\r\n                    return 2;\r\n                }\r\n                if (i === 4) {\r\n                    return 1;\r\n                } else if (i > 4) {\r\n                    return 2;\r\n                }\r\n            }\r\n            return result;\r\n        }\r\n\r\n        const preloadResources = () => {\r\n            updateLoadedMarks();\r\n            const promises = [];\r\n            let loadedCount = 0;\r\n            for (let i = 0; this.LoadedMark && i < this.LoadedMark.length && this.PreloadState.preloaded < 200; i++) {\r\n                const markPromises = [];\r\n                for (let j = 0; this.LoadedMark[i] && j < this.LoadedMark[i].length; j++) {\r\n                    const mark = this.LoadedMark[i][j];\r\n                    if(mark.lock){\r\n                        continue;\r\n                    }\r\n                    const promise = Utils.timeout(0)\r\n                        .then(() => this.LoadedMark[i] && this.LoadedMark[i][j] && mark === this.LoadedMark[i][j] ? loadChapter(this.LoadedMark[i][j]) : Promise.reject())\r\n                        .then(mark => this.preloadResources(mark))\r\n                        .then(rs => Promise.all(rs.data.map(d => this.pushInLoader(d.key, d.type, d.key, true).then(r => Object.assign(d, {pushed: r})))))\r\n                        .then(rs => {\r\n                            const pushedList = rs.filter(r => r.pushed);\r\n                            const size = pushedList.reduce((acc, cur) => acc + (cur.type === 'img' ? 200000 : 2000000), 0);\r\n                            this.PreloadState.size -= size;\r\n                            if (pushedList.length && size) {\r\n                                loadedCount++;\r\n                            }\r\n                            pushedList.length && this.load.start();\r\n                        }).then(() => Utils.timeout(15));\r\n                    markPromises.push(promise);      \r\n                }\r\n\r\n                markPromises.length && promises.push(Promise.all(markPromises).then(null, r => console.warn(r)));\r\n            }\r\n            const finish = () => {\r\n                loadedCount && this.PreloadState.preloaded++;\r\n                if (this.PreloadState.size <= 0 || !this.LoadedMark.length || this.PreloadState.preloaded >= 200) {\r\n                    this.PreloadState.loading = false;\r\n                } else {\r\n                    setTimeout(preloadResources, 0);\r\n                }\r\n            };\r\n            promises.length ? Promise.all(promises).then(finish, finish) : (this.PreloadState.loading = false);\r\n        };\r\n\r\n       setTimeout(preloadResources, 0);\r\n    }\r\n\r\n    static resetInsertPreload(chapter) {\r\n        const preloadType = `$${chapter.uuid}i`;\r\n        this.transferByRefCount(preloadType, 'play');\r\n        this.updateRefTypePrefix(preloadType);\r\n        this.updateLoadMarkByPrefix(preloadType);\r\n        this.startPreloadResources();\r\n    }\r\n\r\n    static resetInsertBack(context, chapter, pIndex=0, cmdPlotSnap = {}) {\r\n        const { cmdInfo, cmdIndex=0 } = cmdPlotSnap\r\n        ResourcesManager.LoadedMark = [];\r\n        this.resetReCount();\r\n        const usingKeyMap = this.sceneProxy.usingResourceCountMap();\r\n        this.forEachReCount((type, key, count) => {\r\n            if(usingKeyMap[key]){\r\n                this.addRefCount(type, key, usingKeyMap[key]);\r\n            }\r\n        });\r\n        this.getResourcesByContext(context, chapter, pIndex, cmdInfo, cmdIndex).then(() => this.startPreloadResources()); \r\n    }\r\n\r\n    static resetJumpPreload(chapter) {\r\n        const preloadType = `$${chapter.uuid}j`;\r\n        this.resetReCount([preloadType]);\r\n        this.transferByRefCount(preloadType, 'play');\r\n        this.updateRefTypePrefix(preloadType, true, false);\r\n        const usingKeyMap = this.sceneProxy.usingResourceCountMap();\r\n        this.forEachReCount((type, key, count) => {\r\n            if(usingKeyMap[key]){\r\n                this.addRefCount(type, key, usingKeyMap[key]);\r\n            }else if(count === 0){\r\n                this.removeFromCache(type, key);\r\n            }\r\n        });\r\n        this.updateLoadMarkByPrefix(preloadType, false);\r\n        this.startPreloadResources();\r\n    }\r\n\r\n    static resetCmdPOptionPreload(commands, index, opIndex) {\r\n        const cmd = commands[index];\r\n        if(!cmd){\r\n            return;\r\n        }\r\n        const t = cmd.type === 'options' ? 'o' : 'c';\r\n        const preloadType = `$${cmd.uuid}${t}${opIndex}-`;\r\n\r\n        const optionMarks = [];\r\n        for (let i = 0; i < this.LoadedMark.length; i++) {\r\n            for (let j = 0; j < this.LoadedMark[i].length; j++) {\r\n                const mark = this.LoadedMark[i][j];\r\n                if (mark.preloadType.startsWith(preloadType)) {\r\n                    optionMarks.push(mark);\r\n                }\r\n            }\r\n        }\r\n        const nextJump = optionMarks.length && optionMarks.every(mark => /^\\$.{36}j/.test(mark.preloadType.substring(preloadType.length)));\r\n        this.transferByRefCount(preloadType, 'play');\r\n        cmd.args.forEach((options, i) => {\r\n            const prefix = `$${cmd.uuid}${t}${i}-`;\r\n            const isSame = i === opIndex;\r\n            !isSame && this.updateRefTypePrefix(prefix);\r\n            !isSame && this.clearLoadMarkByPrefix(prefix);\r\n        });\r\n        this.updateLoadMarkByPrefix(preloadType, !nextJump, false);\r\n        this.updateRefTypePrefix(preloadType, true);\r\n        this.startPreloadResources();\r\n    }\r\n\r\n    static clearPreCmdResources(commands, index) {\r\n        this.startPreloadResources();\r\n        const cmd = commands[index-1];\r\n        const specialTypes = ['jump', 'insert', 'back', 'options', 'conditionOptions', 'addImage', 'showDialog', 'playMusic', 'playSound', 'weather'];\r\n        if(cmd && specialTypes.some(t => t === cmd.type)){\r\n            this.PreloadState.preloaded--;\r\n        }\r\n        if(!cmd || cmd.type!== 'conditionOptions'){\r\n            return;\r\n        }\r\n        cmd.args.forEach((options, i) => this.updateRefTypePrefix(`$${cmd.uuid}l${i}-`, false));\r\n    }\r\n\r\n    static resetPlotOptionPreload(plot, optionType='', index = -1) {\r\n        const type = optionType === 'options' ? 'o' : (optionType === 'condition_options' ? 'c' : '');\r\n        const { options=[], condition_options=[] } = plot;\r\n        if (!options.length && !condition_options.length) {\r\n            return;\r\n        }\r\n        const preloadType = `$${plot.uuid}${type}${index}-`;\r\n        const optionMarks = [];\r\n        for (let i = 0; i < this.LoadedMark.length; i++) {\r\n            for (let j = 0; j < this.LoadedMark[i].length; j++) {\r\n                const mark = this.LoadedMark[i][j];\r\n                if (mark.preloadType.startsWith(preloadType)) {\r\n                    optionMarks.push(mark);\r\n                }\r\n            }\r\n        }\r\n        this.transferByRefCount(preloadType, 'play');\r\n        const nextJump = optionMarks.length && optionMarks.every(mark => /^\\$.{36}j/.test(mark.preloadType.substring(preloadType.length)));\r\n        options.forEach((options, i) => {\r\n            const prefix = `$${plot.uuid}o${i}-`;\r\n            const sameIndex = i === index && optionType === 'options';\r\n            !sameIndex && this.updateRefTypePrefix(prefix, sameIndex);\r\n            !sameIndex && this.clearLoadMarkByPrefix(prefix);\r\n        });\r\n        condition_options.forEach((options, i) => {\r\n            const prefix = `$${plot.uuid}c${i}-`;\r\n            const sameIndex = i === index && optionType === 'condition_options';\r\n            !sameIndex && this.updateRefTypePrefix(prefix, sameIndex);\r\n            !sameIndex && this.clearLoadMarkByPrefix(prefix);\r\n        });\r\n        this.updateLoadMarkByPrefix(preloadType, !nextJump, false);\r\n        this.updateRefTypePrefix(preloadType, true);\r\n\r\n        this.startPreloadResources();\r\n    }\r\n\r\n    static clearPrePlotResources(plots, index) {\r\n        this.startPreloadResources();\r\n        this.PreloadState.preloaded--;\r\n        const plot = plots[index - 1];\r\n        if (!plot || plot.commands ||  !plot.condition_options && !plot.condition_options.length) {\r\n            return;\r\n        }\r\n        const { condition_options=[] } = plot;\r\n        condition_options.forEach((options, i) => this.updateRefTypePrefix(`$${plot.uuid}l${i}-`, false));\r\n     }\r\n\r\n    static preloadResources(loadedMark){\r\n        let {context, chapter, pIndex = 0, cmdInfo, cIndex =0, preloadType} = loadedMark;\r\n        const resources = { data: [], size: 0 };\r\n        if (!chapter || !chapter.plots || !chapter.plots[pIndex] || cmdInfo && !cmdInfo.commands[cIndex]) {\r\n            return Promise.resolve(resources);\r\n        }\r\n\r\n        const addRefCount = (type, url, preloadType) => this.addRefCount(type, url, preloadType);\r\n\r\n        const addResource = (url, type, preloadType) => {\r\n            addRefCount(type, url, preloadType);\r\n            if (!resources.data.some(d => d.key === url)) {\r\n                return xhr.getResourceSize(url, type).then(size => {\r\n                    resources.data.push({ key: url, type, size });\r\n                    resources.size += size;\r\n                    return true;\r\n                });\r\n            }\r\n            return Promise.resolve(false);\r\n        };\r\n        const getInCmdInfo = (cmdInfo, cIndex, preloadType) => {\r\n            if (cIndex >= cmdInfo.commands.length) {\r\n                return Promise.resolve();\r\n            }\r\n            return Promise.all(this.getCommandResources(cmdInfo.commands[cIndex]).map(r => addResource(r.url, r.type, preloadType)));\r\n        };\r\n\r\n        const getInChapter = (chapter, pIndex ,preloadType) => {\r\n            const promises = [];\r\n            const plot = chapter.plots[pIndex];\r\n\r\n            if (!plot || plot.commands && !plot.commands.length) {\r\n                return Promise.resolve();\r\n            }\r\n\r\n            if(plot.commands){\r\n                loadedMark.cmdInfo = { commands: plot.commands };\r\n                loadedMark.cIndex = 0;\r\n                return getInCmdInfo(plot, 0, preloadType);\r\n            }\r\n\r\n            return Promise.all(this.getPlotResources(plot).map(r => addResource(r.url, r.type, preloadType)));\r\n        };\r\n\r\n        return cmdInfo\r\n            ? getInCmdInfo(cmdInfo, cIndex, preloadType).then(() => resources)\r\n            : getInChapter(chapter, pIndex, preloadType).then(() => resources);\r\n    }\r\n\r\n    static pushLoadMarks(marks) {\r\n        if (!marks.length) {\r\n            return;\r\n        }\r\n        const revertMark = (mark, count) => {\r\n            let { context, cmdInfo, cIndex, chapter, pIndex } = mark;\r\n            context = { ...context, stack:[...(context.stack || [])], cmdStack: [...(context.cmdStack || [])] };\r\n            while(count--){\r\n                if (cmdInfo && cmdInfo.parentInfo) {\r\n                    context.cmdStack.splice(0, 1);\r\n                    cmdInfo = cmdInfo.parentInfo;\r\n                    cIndex = cmdInfo.parentCmdIndex;\r\n                    continue;\r\n                } else {\r\n                    cmdInfo = null;\r\n                }\r\n                if (context.stack.length) {\r\n                    const frame = context.stack.splice(0, 1)[0];\r\n                    if (frame && frame.type === 'insert') {\r\n                        context.cmdStack.splice(0, 1);\r\n                        cmdInfo = frame.cmdInfo;\r\n                        cIndex = frame.cmdIndex + 1;\r\n                    }\r\n                    pIndex = chapter.parent.pnPlot;\r\n                    chapter = chapter.parent.pChapter;\r\n                } else {\r\n                    break;\r\n                }\r\n            }\r\n            return {context, cmdInfo, cIndex, chapter, pIndex, preloadType:'' };\r\n        }\r\n\r\n        const compareMark = (m1, m2) => {\r\n            let { chapter, cmdInfo, preloadType, pIndex, cIndex, context } = m1;\r\n            if (cmdInfo && m2.cmdInfo && cmdInfo.commands === m2.cmdInfo.commands && preloadType === m2.preloadType) {\r\n                return cIndex - m2.cIndex;\r\n            }\r\n            if (chapter.plots === m2.chapter.plots && preloadType === m2.preloadType) {\r\n                return pIndex - m2.pIndex;\r\n            }\r\n\r\n            if (chapter.uuid === m2.chapter.uuid && preloadType === m2.preloadType) {\r\n                return pIndex - m2.pIndex;\r\n            }\r\n\r\n            if (m2.preloadType.startsWith(m1.preloadType)) {\r\n                let m1Types = m1.preloadType.split('$').slice(1);\r\n                let m2Types = m2.preloadType.split('$').slice(1);\r\n                const sameCount = m2Types.length - m1Types.length;\r\n                if (sameCount&&(m2.chapter.parent||m2.cmdInfo&&m2.cmdInfo.parentInfo)) {\r\n                    return -compareMark(revertMark(m2, sameCount), revertMark(m1, 0));\r\n                }\r\n            }\r\n            return NaN;\r\n        }\r\n        /* for (let i = 0; i < this.LoadedMark.length; i++) {\r\n            for (let j = 0; j < this.LoadedMark[i].length; j++) {\r\n                const result = compareMark(this.LoadedMark[i][j], marks[0]);\r\n                if (result === 0 || result > 0) {\r\n                   // return;\r\n                }\r\n            }\r\n        } */\r\n\r\n        this.LoadedMark.push(marks);\r\n        //console.log(marks)\r\n    }\r\n\r\n    static updateLoadMarkByPrefix(prefix, keep=true, needPop=true) {\r\n        for (let i = 0; i < this.LoadedMark.length; i++) {\r\n            for (let j = 0; j < this.LoadedMark[i].length; j++) {\r\n                const mark = this.LoadedMark[i][j];\r\n                let { preloadType, context } = mark;\r\n                if (preloadType.startsWith(prefix)) {\r\n                    preloadType = preloadType.substring(prefix.length);\r\n                    mark.preloadType = preloadType ? preloadType : 'play';\r\n                    if (needPop) {\r\n                        const frame = context.stack.pop();\r\n                        if (frame && frame.type === 'insert') {\r\n                            context.cmdStack.pop();\r\n                        }\r\n                    }\r\n                } else if(!keep){\r\n                    this.updateRefTypePrefix(preloadType, false);\r\n                    this.LoadedMark[i].splice(j--, 1);\r\n                }\r\n            }\r\n            if (!this.LoadedMark[i].length) {\r\n                this.LoadedMark.splice(i--, 1)\r\n            }\r\n        }\r\n    }\r\n\r\n    static clearLoadMarkByPrefix(prefix) {\r\n        for (let i = 0; i < this.LoadedMark.length; i++) {\r\n            for (let j = 0; j < this.LoadedMark[i].length; j++) {\r\n                const mark = this.LoadedMark[i][j];\r\n                let { preloadType } = mark;\r\n                if (preloadType.startsWith(prefix)) {\r\n                    this.LoadedMark[i].splice(j--, 1);\r\n                }\r\n            }\r\n            if (!this.LoadedMark[i].length) {\r\n                this.LoadedMark.splice(i--, 1)\r\n            }\r\n        }\r\n    }\r\n\r\n    static getWeatherResources(type){\r\n        const resources = [];\r\n        if (type === 'snowy') {\r\n            for (let i=0; i<120; i++) {\r\n                resources.push({url: `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('snow')}/xuehua_${Utils.formatNum(i)}.png`, type:'img'});\r\n            }\r\n        }\r\n        else if(type === 'windy'){\r\n            if(flashvars.vertical){\r\n                for(let i =0;i < 20;i++){\r\n                    resources.push({url: `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"wind\")}/feng_${Utils.formatNum(i)}.png`, type:'img'});\r\n                }\r\n            }\r\n        }\r\n        else if (type === 'rainy') {\r\n            for (let i=0; i<50; i++) {\r\n                resources.push({url: `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('rain')}/xiayu_${Utils.formatNum(i)}.png`, type:'img'});\r\n            }\r\n        }\r\n        else if (type === 'defoliation') {\r\n            for (let i=0; i<90; i++) {\r\n                resources.push({url: `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('mapleLeaves')}/fengye_${Utils.formatNum(i)}.png`, type:'img'});\r\n            }\r\n        }\r\n        else if (type === 'fallingPeach') {\r\n            for (let i=0; i<90; i++) {\r\n                resources.push({url: `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('beachBlossom')}/taohua_${Utils.formatNum(i)}.png`, type:'img'});\r\n            }\r\n        }\r\n        else if (type === 'fallingFlower') {\r\n            for (let i=0; i<90; i++) {\r\n                resources.push({url: `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('blossom')}/yinghua_${Utils.formatNum(i)}.png`, type:'img'});\r\n            }\r\n        }\r\n        else if (type === 'lightning') {\r\n            for (let i=0; i<50; i++) {\r\n                resources.push({url: `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('lightning')}/shandian_${Utils.formatNum(i)}.png`, type:'img'});\r\n            }\r\n        }\r\n        return resources;\r\n    }\r\n\r\n    static getCommandResources(command){\r\n        const resources = [];\r\n        switch (command.type) {\r\n            case 'addImage':\r\n                if(command.args[0].url && 'inherit' !== command.args[0].url){\r\n                    resources.push({type:'img', url:command.args[0].url, isBackground: command.args[0].index === 1});\r\n                }\r\n                break;\r\n            case 'showDialog':\r\n                resources.push({type:'img', url:command.args[0].avatar.url});\r\n                break;\r\n            case 'playMusic':\r\n                if(command.args[0].url && 'inherit'!== command.args[0].url){\r\n                    resources.push({type:'audio', url:command.args[0].url, isMusic:true });\r\n                }\r\n                break;\r\n            case 'playSound':\r\n                if(command.args[0].url && 'inherit'!== command.args[0].url){\r\n                    resources.push({type:'audio', url:command.args[0].url, isSound:true, index:command.args[0].index });\r\n                }\r\n                break;\r\n            case 'options':\r\n                for (let option of command.args) {\r\n                    const { background, sound } = option;\r\n                    if (background) {\r\n                        const { normal, active, disable } = background;\r\n                        normal && normal.url && resources.push({ type: 'img', url: normal.url });\r\n                        active && active.url && resources.push({ type: 'img', url: active.url });\r\n                        disable && disable.url && resources.push({ type: 'img', url: disable.url });\r\n                    }\r\n                    if (sound && sound.url) {\r\n                        resources.push({ type: 'audio', url: sound.url });\r\n                    }\r\n                }\r\n                break;\r\n            case 'weather':\r\n                if(flashvars.offline !== '1') resources.push(...this.getWeatherResources(command.args[0]));\r\n                break;\r\n            case 'showBubble':\r\n                if(command.args[0].url){\r\n                    resources.push({type:'img', url:command.args[0].url});\r\n                }\r\n                break;\r\n            case 'emitBubble':\r\n                const {avatar,content} = command.args[0];\r\n                if(avatar.url){\r\n                    resources.push({type:'img', url:avatar.url});\r\n                }\r\n                if(content.url){\r\n                    resources.push({type:'img', url:content.url});\r\n                }\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        return resources;\r\n    }\r\n\r\n    static getPlotResources(plot){\r\n        const resources = [];\r\n        // sound\r\n        if (Object.prototype.toString.call(plot.plot_sound) == '[object Array]') {\r\n            for (let i in plot.plot_sound) {\r\n                let item = plot.plot_sound[i];\r\n                if (item && 'inherit' !== item.url) {\r\n                    resources.push({ url: item.url, type: 'audio', isSound:true, index: i });\r\n                }\r\n            }\r\n        } else if (plot.plot_sound.url && 'inherit' !== plot.plot_sound.url) {\r\n            resources.push({ url: item.url, type: 'audio', isSound:true, index: 0 });\r\n        }\r\n        // background\r\n        if (plot.background.url && plot.background.url !== 'inherit') {\r\n            resources.push({ url: plot.background.url, type: 'img', isBackground:true });\r\n        }\r\n\r\n        // avatar\r\n        if (plot.avatar.url) {\r\n            resources.push({ url: plot.avatar.url, type: 'img'});\r\n        }\r\n        // music\r\n        if (plot.music.url && plot.music.url !== 'inherit') {\r\n            resources.push({ url: plot.music.url, type:'audio', isMusic:true });\r\n        } \r\n\r\n        // characters\r\n        for (let character of plot.characters) {\r\n            character.url && resources.push({ url: character.url, type: 'img' });\r\n        }\r\n\r\n        // props\r\n        for (let prop of plot.props) {\r\n            prop.url && resources.push({ url: prop.url, type: 'img' });\r\n        }\r\n        // options\r\n        for (let option of plot.options) {\r\n            const { background, sound } = option;\r\n            if (background) {\r\n                const { normal, active, disable } = background;\r\n                normal && normal.url && resources.push({ type: 'img', url: normal.url });\r\n                active && active.url && resources.push({ type: 'img', url: active.url });\r\n                disable && disable.url && resources.push({ type: 'img', url: disable.url });\r\n            }\r\n            if (sound && sound.url) {\r\n                resources.push({ type: 'audio', url: sound.url });\r\n            }\r\n        }\r\n        // weather\r\n        if (plot.weather.value) {\r\n            if(flashvars.offline !== '1') resources.push(...this.getWeatherResources(plot.weather.value));\r\n        }\r\n\r\n        return resources;\r\n    }\r\n\r\n    static checkCondOptionResources(option, type = 'general'){\r\n        let count = this.OptionResourcesCountMap.get(option) || 0;\r\n        if (count) {\r\n            return count;\r\n        }\r\n        const resourcesMap = {};\r\n\r\n        const addResource = r => {\r\n            if (!resourcesMap[r.url]) {\r\n                count++;\r\n                resourcesMap[r.url] = true;\r\n            }\r\n        };\r\n\r\n        const getCountInOption = (option) => {\r\n            for (let i = 0; i < option.plots.length && count <= 50; i++) {\r\n                const plot = option.plots[i];\r\n                let rs = [];\r\n                if (plot.commands) {\r\n                    rs = plot.commands.map(c => {\r\n                        if (c.type === 'options' || c.type === 'conditionOptions') {\r\n                            getCountInCmdOptions(c.args);\r\n                        }\r\n                        return this.getCommandResources(c);\r\n                    }).reduce((acc, cur) => [...cur, acc], [])\r\n                } else {\r\n                    if (plot.options.length) {\r\n                        getCountInOptions(plot.options);\r\n                    }\r\n                    if (plot.condition_options.length) {\r\n                        getCountInOptions(plot.condition_options);\r\n                    }\r\n                    rs = this.getPlotResources(plot);\r\n                }\r\n                rs.forEach(r => addResource(r));\r\n            }\r\n        };\r\n        const getCountInOptions = (options) => options.forEach(o => getCountInOption(o));\r\n\r\n        const getCountInCmdOption = (option) => {\r\n            for (let i = 0; i < option.commands.length && count <= 50; i++) {\r\n                const cmd = option.commands[i];\r\n                this.getCommandResources(cmd).forEach(r => addResource(r))\r\n                if (cmd.type === 'options' || cmd.type === 'conditionOptions') {\r\n                    getCountInCmdOptions(cmd.args);\r\n                }\r\n            }\r\n        };\r\n        const getCountInCmdOptions = (options) => options.forEach(o => getCountInCmdOption(o));\r\n\r\n        if (type === 'general') {\r\n            getCountInOption(option);\r\n        } else {\r\n            getCountInCmdOption(option);\r\n        }\r\n\r\n        return count;\r\n    }\r\n\r\n    static getResourcesByContext(context, chapter, pIndex = 0, cmdInfo, cIndex =0, canAddRefCount = true) {\r\n        const resources = { data: [], size: 0 };\r\n        context = { ...context };\r\n        context.stack = [...(context.stack || [])];\r\n        context.cmdStack = [...(context.cmdStack || [])];\r\n\r\n        if (!chapter || !chapter.plots || !chapter.plots[pIndex] || cmdInfo && !cmdInfo.commands[cIndex]) {\r\n            return Promise.resolve(resources);\r\n        }\r\n\r\n        const isMaxSize = () => resources.size > this.MaxSize/5 || resources.data.length > 30;\r\n\r\n        const addRefCount = (type, url, preloadType) => canAddRefCount && this.addRefCount(type, url, preloadType);\r\n\r\n        const addResource = (url, type, preloadType) => {\r\n            addRefCount(type, url, preloadType);\r\n            if (!resources.data.some(d => d.key === url)) {\r\n                return xhr.getResourceSize(url, type).then(size => {\r\n                    resources.data.push({ key: url, type, size });\r\n                    resources.size += size;\r\n                });\r\n            }\r\n            return Promise.resolve();\r\n        };\r\n\r\n        const createMark = ({context, chapter, pIndex, cmdInfo, cIndex, preloadType}) => {\r\n            const c = { ...context, stack:[], cmdStack: [] };\r\n            const plots = chapter.plots || [];\r\n            if (!cmdInfo && plots.length > pIndex && plots[pIndex] && plots[pIndex].commands) {\r\n                cmdInfo = { commands: plots[pIndex].commands };\r\n                cIndex = -1;\r\n            } \r\n            return { context: c, chapter, pIndex, cmdInfo, cIndex, preloadType  };\r\n        }\r\n\r\n        const createJumpMark = (content, chapterUuid) => {\r\n            let { context, preloadType } = content;\r\n            const newChapter = Utils.searchChapterByUUID(this.gameData, chapterUuid);\r\n            if(!newChapter){\r\n                return;\r\n            }\r\n            preloadType = `${preloadType==='play'?'':preloadType}$${newChapter.uuid}j`;\r\n            content = { context, cmdInfo:null, chapter: newChapter, pIndex: -1 , preloadType};\r\n            return createMark(content);\r\n        }\r\n\r\n        const createInsertMark = (content, chapterUuid) => {\r\n            let { context, preloadType } = content;\r\n            const newChapter = Utils.searchChapterByUUID(this.gameData, chapterUuid);\r\n            if(!newChapter){\r\n                return;\r\n            }\r\n            preloadType = `${preloadType==='play'?'':preloadType}$${newChapter.uuid}i`;\r\n            content = { context, cmdInfo:null, chapter:newChapter, pIndex: -1 , preloadType };\r\n            return createMark(content);\r\n        }\r\n\r\n        const getInCommand = (command, preloadType) => {\r\n            const resources = this.getCommandResources(command);\r\n            resources.forEach(r => {\r\n                const {type, url, isMusic, isSound, index} = r;\r\n                if (isMusic && this.forceDecode.musics.length < this.MaxForceDecodeMusic) {\r\n                    this.forceDecode.musics.push(url);\r\n                }\r\n                if (isSound && !this.forceDecode.sounds[index]) {\r\n                    this.forceDecode.sounds[index] = url;\r\n                }\r\n            });\r\n\r\n            return Promise.all(resources.map(r => addResource(r.url, r.type, preloadType)));\r\n        };\r\n\r\n        const preloadCmdOptions = (content) => {\r\n            const { context, preloadType, chapter, pIndex, cmdInfo, cIndex } = content;\r\n            const cmd = cmdInfo.commands[cIndex];\r\n            const options = cmd.args;\r\n            const optionPromises = [];\r\n            const marks = [];\r\n            for (let opIndex = 0; options && opIndex < options.length; opIndex++) {\r\n                const option = options[opIndex];\r\n                let optionType = cmd.type === 'options' ? 'o' : (option.type !== 'branch' && this.checkCondOptionResources(option, 'command') <= 50 ? 'l' : 'c');\r\n                const newCmdInfo = { commands: option.commands };\r\n                const newpreloadType = `${preloadType==='play'?'':preloadType}$${cmd.uuid}${optionType}${opIndex}-`;\r\n                const pushMark = (cIndex) => {\r\n                    const mark = createMark({...content, cmdInfo:newCmdInfo, cIndex, preloadType:newpreloadType});\r\n                    marks.push(mark);\r\n                };\r\n                const temp = { ...content, cmdInfo:newCmdInfo, cIndex:0, preloadType:newpreloadType }\r\n                let promise = Promise.resolve();\r\n                for (let opPlotIndex = 0; opPlotIndex < option.commands.length && opPlotIndex < 10; opPlotIndex++) {\r\n                    const cmd = option.commands[opPlotIndex];\r\n                    const {type, args} = cmd;\r\n                    promise = promise.then(() => {\r\n                        return getInCommand(cmd, newpreloadType).then(() => {\r\n                            if (isMaxSize(true)) {\r\n                                return Promise.reject(opPlotIndex);\r\n                            } else if (type === 'options' || type === 'conditionOptions') {\r\n                                const content = { ...temp, cIndex:opPlotIndex };\r\n                                content.context = { ...context, cmdStack:[] };\r\n                                return preloadCmdOptions(content);\r\n                            }else if(type === 'jump'){\r\n                                this.pushLoadMarks([createJumpMark({ ...temp, cIndex:opPlotIndex }, args[0])]);\r\n                                return Promise.reject(-1);\r\n                            } else if(type === 'insert'){\r\n                                this.pushLoadMarks([createInsertMark({ ...temp, cIndex:opPlotIndex }, args[0])]);\r\n                                return Promise.reject(-1);\r\n                            } else if (type === 'back') {\r\n                                return Promise.reject(-1);\r\n                            } \r\n                            return Promise.resolve();\r\n                        });\r\n                    });\r\n                    if (type === 'options' || type === 'conditionOptions') {\r\n                        if(opPlotIndex + 1 < option.commands.length){\r\n                            promise = promise.then(() => Promise.reject(opPlotIndex));\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n                promise = promise.then(() => {\r\n                    if (option.commands.length > 10) {\r\n                        pushMark(9);\r\n                    }\r\n                }, index => {\r\n                    if (index >= 0 && option.commands.length > index) {\r\n                        pushMark(index);\r\n                    }\r\n                });\r\n                optionPromises.push(promise);\r\n            }\r\n            return Promise.all(optionPromises).then(() => {\r\n                marks.length && this.pushLoadMarks(marks);\r\n                return Promise.resolve();\r\n            });\r\n        };\r\n\r\n        const getInNextCommand = (content, nextPlot = true) => {\r\n            let { context, chapter, pIndex, cmdInfo, cIndex, preloadType } = content;\r\n            if (isMaxSize(true)) {\r\n                this.pushLoadMarks([createMark(content)]);\r\n                return Promise.resolve();\r\n            }\r\n            const { type, args }= cmdInfo.commands[cIndex] || {};\r\n            if(type === 'jump'){\r\n                this.pushLoadMarks([createJumpMark(content, args[0])]);\r\n                return Promise.resolve();\r\n            } else if(type === 'insert'){\r\n                this.pushLoadMarks([createInsertMark(content, args[0])]);\r\n                return getInCmdInfo({...content, cIndex: cIndex+1 });\r\n            } else if (type === 'back') {\r\n                return Promise.resolve();\r\n            } else if (type === 'options' || type === 'conditionOptions') {\r\n                return preloadCmdOptions(content, nextPlot).then(() => getInCmdInfo({...content, cIndex: cIndex+1 }, nextPlot));\r\n            } else if (cmdInfo.commands.length > cIndex + 1) {\r\n                return getInCmdInfo({...content, cIndex: cIndex+1 }, nextPlot);\r\n            } else if (nextPlot && context.cmdStack.length) {\r\n                context.cmdStack = context.cmdStack.splice(1);\r\n                cIndex = cmdInfo.parentCmdIndex + 1;\r\n                cmdInfo = cmdInfo.parentInfo;\r\n                if (cmdInfo && Number.isInteger(cIndex)) {\r\n                    return getInCmdInfo({ ...content, cmdInfo, cIndex }, nextPlot);\r\n                }\r\n            } else if (nextPlot && context.stack.length) {\r\n                //context.stack = context.stack.splice(1);\r\n                context.stack = context.stack.slice(1);\r\n                if(chapter.parent){\r\n                    pIndex = chapter.parent.pnPlot + 1;\r\n                    chapter = chapter.parent.pChapter;\r\n                }\r\n                if (chapter && Number.isInteger(pIndex)) {\r\n                    return getInChapter({ ...content, chapter, pIndex});\r\n                }\r\n            }\r\n            return nextPlot ? getInChapter({...content, pIndex: pIndex + 1}) : Promise.resolve() ;\r\n        };\r\n\r\n        const getInCmdInfo = (content, nextPlot=true) => {\r\n            const {chapter, pIndex, cmdInfo, cIndex, preloadType } = content;\r\n            if (cIndex >= cmdInfo.commands.length) {\r\n                return getInNextCommand(content, nextPlot);\r\n            }\r\n\r\n            return getInCommand(cmdInfo.commands[cIndex], preloadType).then(() => getInNextCommand(content, nextPlot));\r\n        };\r\n\r\n        const getPlotOptionCount = plot => {\r\n            let count = 0;\r\n            for (let opIndex = 0; plot.options && opIndex < plot.options.length; opIndex++) {\r\n                count += plot.options[opIndex].plots.length;\r\n            }\r\n\r\n            for (let opIndex = 0; plot.condition_options && opIndex < plot.condition_options.length; opIndex++) {\r\n                count += plot.condition_options[opIndex].plots.length;\r\n            }\r\n            return count;\r\n        };\r\n\r\n        const getInChapter = (content) => {\r\n            const { chapter, pIndex, preloadType } = content;\r\n            const plot = chapter.plots[pIndex];\r\n\r\n            if (!plot || plot.commands && !plot.commands.length) {\r\n                return Promise.resolve();\r\n            }\r\n\r\n            if(plot.commands){\r\n                return getInCmdInfo({...content, cmdInfo:plot, cIndex:0});\r\n            }\r\n\r\n            const getInPlot = (plot, preloadType) => {\r\n                const resources = this.getPlotResources(plot);\r\n                resources.forEach(r => {\r\n                    const {type, url, isMusic, isSound, index} = r;\r\n                    if (isMusic && this.forceDecode.musics.length < this.MaxForceDecodeMusic) {\r\n                        this.forceDecode.musics.push(url);\r\n                    }\r\n                    if (isSound && !this.forceDecode.sounds[index]) {\r\n                        this.forceDecode.sounds[index] = url;\r\n                    }\r\n                });\r\n                return Promise.all(resources.map(r => addResource(r.url, r.type, preloadType)));\r\n            };\r\n\r\n            const preloadPlotOptions = (content) => {\r\n                const { chapter, pIndex, preloadType, context } = content;\r\n                const plot = chapter.plots[pIndex];\r\n                const opMarks = [];\r\n                const copMarks = [];\r\n                const optionPromises = [];\r\n                const condOptionPromises = [];\r\n\r\n                const pushMark = (content, marks) => marks.push(createMark(content));\r\n                const loadPlotIntoPromise = (promise, plot, content) => {\r\n                    promise = promise.then(() => {\r\n                        if (plot.commands) {\r\n                            content.cmdInfo = { commands: plot.commands };\r\n                            content.cIndex = 0;\r\n                            return getInCmdInfo(content, false);\r\n                        } else {\r\n                            return getInPlot(plot, content.preloadType);\r\n                        }\r\n                    }).then(() => {\r\n                        if (isMaxSize(true)) {\r\n                            return Promise.reject(content.pIndex);\r\n                        } else if (getPlotOptionCount(plot)) {\r\n                            return preloadPlotOptions(content);\r\n                        }else if(plot.jump){\r\n                            this.pushLoadMarks([createJumpMark(content, plot.jump)]);\r\n                            return Promise.reject(-1);\r\n                        } else if(plot.insert){\r\n                            this.pushLoadMarks([createInsertMark(content, plot.insert)]);\r\n                            return Promise.reject(-1);\r\n                        } else if (plot.back) {\r\n                            return Promise.reject(-1);\r\n                        } \r\n                        return Promise.resolve();\r\n                    });\r\n                    return promise;\r\n                };\r\n\r\n                for (let opIndex = 0; plot.options && opIndex < plot.options.length; opIndex++) {\r\n                    const option = plot.options[opIndex];\r\n                    const newPreloadType = `${preloadType==='play'?'':preloadType}$${plot.uuid}o${opIndex}-`;\r\n                    const optChapter = {plots: option.plots, uuid: chapter.uuid};\r\n                    const temp = { ...content, chapter:optChapter, pIndex: 0, preloadType:newPreloadType };\r\n                    let promise = Promise.resolve();\r\n                    for (let opPlotIndex = 0; opPlotIndex < option.plots.length && opPlotIndex < 5; opPlotIndex++) {\r\n                        const content = { ...temp, pIndex:opPlotIndex };\r\n                        content.context = { ...context };\r\n                        promise = loadPlotIntoPromise(promise, option.plots[opPlotIndex], content);\r\n                    }\r\n                    promise = promise.then(() => {\r\n                        if (option.plots.length > 5) {\r\n                            pushMark({ ...temp, pIndex:4 }, opMarks);\r\n                        }\r\n                    }, index => {\r\n                        if (index >= 0 && option.plots.length > index && !option.plots[index].commands) {\r\n                            pushMark({ ...temp, pIndex: index }, opMarks);\r\n                        }\r\n                        return Promise.resolve();\r\n                    });\r\n                    optionPromises.push(promise);\r\n                }\r\n\r\n                for (let opIndex = 0; plot.condition_options && opIndex < plot.condition_options.length; opIndex++) {\r\n                    let option = plot.condition_options[opIndex];\r\n                    const optChapter = {plots: option.plots, parent: {pChapter: chapter, pnPlot: pIndex}, uuid: chapter.uuid};\r\n                    const type = option.type !== 'branch' && this.checkCondOptionResources(option) <= 50 ? 'l' : 'c';\r\n                    const newPreloadType = `${preloadType==='play'?'':preloadType}$${plot.uuid}${type}${opIndex}-`;\r\n                    const temp = { ...content, chapter:optChapter, pIndex: 0, preloadType:newPreloadType };\r\n                    let promise = Promise.resolve();\r\n                    for (let opPlotIndex = 0; opPlotIndex < option.plots.length && opPlotIndex < 5; opPlotIndex++) {\r\n                        const content = { ...temp, pIndex:opPlotIndex };\r\n                        content.context = { ...context };\r\n                        promise = loadPlotIntoPromise(promise, option.plots[opPlotIndex], content);\r\n                    }\r\n                    promise = promise.then(() => {\r\n                        if (option.plots.length > 5) {\r\n                            pushMark({ ...temp, pIndex:4 }, copMarks);\r\n                        }\r\n                    }, index => {\r\n                        if (index >= 0 && option.plots.length > index && !option.plots[index].commands) {\r\n                            pushMark({ ...temp, pIndex: index }, copMarks);\r\n                        }\r\n                        return Promise.resolve();\r\n                    });\r\n                    condOptionPromises.push(promise);\r\n                }\r\n\r\n                const optionPromise = Promise.all(optionPromises).then(() => opMarks.length && this.pushLoadMarks(opMarks));\r\n                const condoptionPromise = Promise.all(condOptionPromises).then(() => copMarks.length && this.pushLoadMarks(copMarks));\r\n                return Promise.all([optionPromise, condoptionPromise]);\r\n            };\r\n\r\n            const getInNextPlot = (content) => {\r\n                let { context, chapter, pIndex } = content;\r\n                const plot = chapter.plots[pIndex];\r\n                if(isMaxSize()){\r\n                    const mark = createMark(content);\r\n                    this.pushLoadMarks([mark]);\r\n                    return Promise.resolve();\r\n                }else if(plot.back){\r\n                    return Promise.resolve();\r\n                }else if(plot.jump){\r\n                    this.pushLoadMarks([createJumpMark(content, plot.jump)]);\r\n                    return Promise.resolve();\r\n                } else if(plot.insert){\r\n                    this.pushLoadMarks([createInsertMark(content, plot.insert)]);\r\n                    return getInChapter({ ...content, pIndex: pIndex + 1 });\r\n                } else if (getPlotOptionCount(plot)) {\r\n                    return preloadPlotOptions(content).then(() => getInChapter({ ...content, pIndex: pIndex + 1 }));\r\n                } else if (chapter.plots.length > pIndex + 1 ) {\r\n                    return getInChapter({ ...content, pIndex: pIndex + 1 });\r\n                } else if (context.stack.length) {\r\n                    context.stack = context.stack.slice(1);\r\n                    if(chapter.parent){\r\n                        pIndex = chapter.parent.pnPlot + 1;\r\n                        chapter = chapter.parent.pChapter;\r\n                    }\r\n                    if (chapter && Number.isInteger(pIndex)) {\r\n                        return getInChapter({ ...content, chapter, pIndex});\r\n                    }\r\n                }\r\n                return Promise.resolve();\r\n            };\r\n\r\n            return getInPlot(plot, preloadType).then(() => getInNextPlot(content));\r\n        };\r\n\r\n        const checkResources = (resources) => {\r\n            if(resources.size < this.MaxSize){\r\n                this.PreloadState.size = this.MaxSize - resources.size;\r\n            }\r\n\r\n            if(this.PreloadState.size > 0){\r\n                this.startPreloadResources();\r\n            }\r\n            return resources;\r\n        }\r\n\r\n        const content = { context, chapter, pIndex, cmdInfo, cIndex, preloadType:'play' };\r\n        return cmdInfo\r\n            ? getInCmdInfo(content).then(() => checkResources(resources))\r\n            : getInChapter(content).then(() => checkResources(resources));\r\n    }\r\n\r\n    static getResourcesSize(resources) {\r\n        const promises = [];\r\n        resources.forEach(r => {\r\n            promises.push(xhr.getResourceSize(r.key, r.type))\r\n        });\r\n        return Promise.all(promises).then(sizes => sizes.reduce((a,b) => a + b, 0));\r\n    }\r\n\r\n    static updateUsingKey({type, key, index}){\r\n        let oldKey = '';\r\n        switch(type){\r\n            case 'background':\r\n                this.usingKeyMap.background = key;\r\n                break;\r\n            case 'preBackground':\r\n                this.usingKeyMap.preBackground = key;\r\n                break;\r\n            case 'music':\r\n                oldKey = this.usingKeyMap.music;\r\n                this.usingKeyMap.music = key;\r\n                oldKey && this.subRefCount('audio', oldKey);\r\n                break;\r\n            case 'sound':\r\n                oldKey = this.usingKeyMap.sounds[index];\r\n                this.usingKeyMap.sounds[index] = key;\r\n                oldKey && this.subRefCount('audio', oldKey);\r\n                break;\r\n        }\r\n    }\r\n\r\n    static isUsingKey(key){\r\n        const { background, music, sounds, preBackground } = this.usingKeyMap;\r\n        return background === key || preBackground === key || music === key || sounds.some(s => s === key);\r\n    }\r\n}\r\n\r\nResourcesManager.delayRemoveManager = new DelayRemoveManager();\r\nResourcesManager.OptionResourcesCountMap = new Map();\r\nResourcesManager.PreloadState = { size:0, loading: false, preloaded:0, loadingChapterMap:{} };\r\nResourcesManager.LoadedMark = [];\r\nResourcesManager.MaxSize = 100000000;\r\nResourcesManager.MaxForceDecodeMusic = 3;\r\nResourcesManager.refCount = { audio: {}, img: {} };\r\nResourcesManager.usingKeyMap = { background: '', sounds: new Array(10).fill(''), music: '', preBackground: '' };\r\nResourcesManager.forceDecode = { musics: [], sounds: new Array(10).fill('') };\r\n\r\nexport class AudioTagPool {\r\n    static get() {\r\n        let freeAudio = AudioTagPool.pool.find(a => a.free);\r\n        if (freeAudio) {\r\n            freeAudio.pause();\r\n            freeAudio.free = false;\r\n        } else {\r\n            freeAudio = document.createElement('audio');\r\n            freeAudio.crossOrigin = 'anonymous';\r\n        }\r\n        return freeAudio;\r\n    }\r\n\r\n    static exist(audio){\r\n        return AudioTagPool.pool.some(a => a === audio);\r\n    }\r\n\r\n    static fill() {\r\n        const addAudio = len => {\r\n            for (let i = 0; i < len; i++) {\r\n                let audio = document.createElement('audio');\r\n                audio.crossOrigin = 'anonymous';\r\n                audio.free = true;\r\n                audio.loop = false;\r\n                audio.play();\r\n                AudioTagPool.pool.push(audio);\r\n            }\r\n        };\r\n        if (AudioTagPool.pool.length) {\r\n            const freeCount = AudioTagPool.pool.reduce((acc, cur) => acc + (cur && cur.free ? 1 : 0), 0);\r\n            if (freeCount < 10) {\r\n                addAudio(50);\r\n            }\r\n        } else {\r\n            addAudio(100);\r\n        }\r\n    }\r\n}\r\nAudioTagPool.pool = [];","/**\r\n * Created by chenwl on 3/25/16.\r\n */\r\nconst commit = \"8f0e2a487b3fe1aa6e00c03c10b46b6c97de0ed7\";\r\nexport default commit;\r\n\r\nconst version = \"1.0.0\";\r\nexport {version};\r\n","import Utils from \"./Utils\";\r\n\r\nconst urls = {\r\n    getGame : \"https://mapi.3000api.com/apis/soft/v1.0/game-info.html\",\r\n    getTestGame: \"https://mapi.3000api.com/apis/soft/v1.0/game-test.html\",\r\n    getOtherGame: \"https://mapi.3000api.com/apis/soft/v1.0/game-external.html\",\r\n    materialRedirect:\"https://mapi.3000api.com/client/material-redirect.html\"\r\n};\r\n\r\nfunction serializeQuery(params) {\r\n    params['_'] = Date.now();\r\n    return '?' + Object.keys(params).map(key => {\r\n            const val = params[key];\r\n            if (val) {\r\n                return encodeURIComponent(key) + '=' + encodeURIComponent(val)\r\n            }\r\n            else {\r\n                return '';\r\n            }\r\n        }).join('&');\r\n}\r\n\r\nexport function xhrGetServerTime(url) {\r\n    return new Promise((resolve, reject) => {\r\n        const xhr = new XMLHttpRequest();\r\n        xhr.open(\"GET\", url, true);\r\n\r\n        xhr.onload = function () {\r\n            try {\r\n                if (xhr.readyState === 4 && xhr.status >= 400 && xhr.status <= 599) { // Handle HTTP status codes of 4xx and 5xx as errors, even if xhr.onerror was not called.\r\n                    return reject(`error readyState: ${xhr.readyState}, status: ${xhr.status}`);\r\n                }\r\n                else {\r\n                    return resolve(xhr);\r\n                }\r\n            } catch (e) {\r\n                reject(e)\r\n            }\r\n        };\r\n\r\n        xhr.onerror = reject;\r\n        xhr.send();\r\n    })\r\n}\r\n\r\nexport function xhrSend(url, data, onProgress, timeout) {\r\n    return new Promise((resolve, reject) => {\r\n        const xhr = new XMLHttpRequest();\r\n        xhr.ontimeout = function () {\r\n            console.log(url + ' time out');\r\n        };\r\n        xhr.onreadystatechange = function() {\r\n            switch(xhr.readyState) {\r\n                case 4 :\r\n                    if((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {\r\n                        return resolve(xhr);\r\n                    }\r\n                    else {\r\n                        return reject(`error readyState: ${xhr.readyState}, status: ${xhr.status}`);\r\n                    }\r\n                    break;\r\n            }\r\n        };\r\n        xhr.open(\"post\", url, true);\r\n        xhr.withCredentials = true;\r\n        timeout && (xhr.timeout = timeout);\r\n        onProgress && xhr.addEventListener(\"progress\", onProgress, false);\r\n        xhr.setRequestHeader(\"CONTENT-TYPE\", \"application/x-www-form-urlencoded\");\r\n        xhr.send(data);\r\n        xhr.onerror = reject;\r\n    });\r\n}\r\n\r\nexport function xhrLoad(url, type, onProgress,istimeout = true) {\r\n    return new Promise((resolve, reject) => {\r\n\r\n        const xhr = new XMLHttpRequest();\r\n        xhr.ontimeout = function () {\r\n            console.log(url + ' time out');\r\n            if(istimeout) return reject(\"get time out\")\r\n        };\r\n        xhr.onload = function () {\r\n            try {\r\n                if (xhr.readyState === 4 && xhr.status >= 400 && xhr.status <= 599) { // Handle HTTP status codes of 4xx and 5xx as errors, even if xhr.onerror was not called.\r\n                    return reject(`error readyState: ${xhr.readyState}, status: ${xhr.status}`);\r\n                }\r\n                else {\r\n                    return resolve(xhr);\r\n                }\r\n            } catch (e) {\r\n                return reject(e)\r\n            }\r\n        };\r\n        xhr.open(\"GET\", url, true);\r\n        xhr.responseType = type;\r\n        onProgress && xhr.addEventListener(\"progress\", onProgress, false);\r\n        istimeout && (xhr.timeout = 5000);//get增加5秒的请求超时\r\n        xhr.onerror = reject;\r\n        xhr.send();\r\n    });\r\n}\r\n\r\nexport function getJson(url, onProgress) {\r\n    return xhrLoad(url, '', onProgress,false).then(xhr => {\r\n        return JSON.parse(xhr.response);\r\n    });\r\n}\r\n\r\nexport function getMaterialRedirect(url) {\r\n    return getJson(urls.materialRedirect + serializeQuery({url}))\r\n        .then(json => {\r\n            if (json.code == '100') {\r\n                return json.result;\r\n            }\r\n            else {\r\n                return Promise.reject(json.message);\r\n            }\r\n        });\r\n}\r\n\r\nexport function getGame(uuid, onProgress) {\r\n    let url = urls.getGame + '?uuid=' + uuid;\r\n    if(flashvars.offline === '1' && flashvars.single){\r\n        //独立\r\n        if(flashvars.offline === '1' && flashvars.single){\r\n            url = Utils.convertSingleJsonPath(uuid);\r\n        }\r\n    }\r\n    return getJson(url, onProgress)\r\n        .then(json => {\r\n            if (json.code == '100') {\r\n                return json.result;\r\n            }\r\n            else if (flashvars.offline === '1') {\r\n                return json;\r\n            }\r\n            else {\r\n                return Promise.reject(json.message);\r\n            }\r\n        });\r\n}\r\n\r\nexport function getTestGame(uuid, onProgress) {\r\n    let url = /*'https://www.3000.com/proxy/liuhualin/json.txt';/**/urls.getTestGame + '?uuid=' + uuid;\r\n    if(flashvars.offline === '1' && flashvars.single){\r\n        url = Utils.convertSingleJsonPath(uuid);\r\n    }\r\n    return getJson(url, onProgress)\r\n        .then(json => {\r\n            if (json.code == '100') {\r\n                return json.result;\r\n            }\r\n            else if (flashvars.offline === '1') {\r\n                return json;\r\n            }\r\n            else {\r\n                return Promise.reject(json.message);\r\n            }\r\n        });\r\n}\r\n\r\nexport function getOtherGame(uuid, onProgress) {\r\n    let url = /*'https://www.3000.com/proxy/liuhualin/json.txt';/**/urls.getOtherGame + '?uuid=' + uuid;\r\n    if(flashvars.offline === '1' && flashvars.single){\r\n        url = Utils.convertSingleJsonPath(uuid);\r\n    }\r\n    return getJson(url, onProgress)\r\n        .then(json => {\r\n            if (json.code == '100') {\r\n                return json.result;\r\n            }\r\n            else if (flashvars.offline === '1') {\r\n                return json;\r\n            }\r\n            else {\r\n                return Promise.reject(json.message);\r\n            }\r\n        });\r\n}\r\n\r\nexport function getResourceSize(url, type) {\r\n    if (type === 'img') {\r\n        return Promise.resolve(200000)\r\n    } else if (type === 'audio') {\r\n        return Promise.resolve(2000000)\r\n    }\r\n}","/**\r\n * @class demo.controller.PrepareControllerCommand.js\r\n */\r\nimport puremvc from 'puremvc';\r\npuremvc.define\r\n(\r\n\t// CLASS INFO\r\n\t{\r\n\t\tname: 'diygamePlayer.controller.command.PrepareControllerCommand',\r\n\t\tparent: puremvc.SimpleCommand\r\n\t},\r\n\t\r\n\t// INSTANCE MEMBERS\t\r\n\t{\r\n\t\t/** @override */\r\n\t\texecute: function (note)\r\n\t\t{\r\n\t\t\t// register teh ProcessTextCommand to handle the PROCESS_TEXT notification \r\n\t\t\t//this.facade.registerCommand( demo.AppConstants.PROCESS_TEXT, diygamePlayer.controller.command.ProcessTextCommand );\r\n\t\t}\r\n\t}\t\r\n);\r\n","/**\r\n * @class demo.controller.PrepareModelCommand.js\r\n */\r\nimport puremvc from 'puremvc';\r\npuremvc.define\r\n(\r\n\t// CLASS INFO\r\n\t{\r\n\t\tname: 'diygamePlayer.controller.command.PrepareModelCommand',\r\n\t\tparent: puremvc.SimpleCommand\r\n\t},\r\n\t\r\n\t// INSTANCE MEMBERS\r\n\t{\r\n\t\t/** @override */\r\n\t\texecute: function (note)\r\n\t\t{\r\n\t\t\t// register the TextProxy \r\n\t\t\tthis.facade.registerProxy( new diygamePlayer.model.proxy.SceneProxy );\r\n\t\t}\r\n\t}\r\n)","/**\r\n * @class demo.controller.PrepareW3CViewCommand\r\n * @extends puremvc.SimpleCommand\r\n */\r\nimport puremvc from 'puremvc';\r\npuremvc.define\r\n(\r\n\t// CLASS INFO\r\n\t{\r\n\t\tname: 'diygamePlayer.controller.command.PrepareViewCommand',\r\n\t\tparent: puremvc.SimpleCommand\r\n\t},\r\n\t\r\n\t// INSTANCE TRAITS\r\n\t{\r\n\t\t/** @override */\r\n\t\texecute: function (note)\r\n\t\t{\r\n\t\t\t// register the TextComponentMediator\r\n\t\t\tthis.facade.registerMediator( new diygamePlayer.view.mediator.SceneMediator );\r\n\t\t}\r\n\t}\r\n);\t\t\t\t","/**\r\n * @class demo.controller.StartupCommand\r\n * @extends puremvc.MacroCommand\r\n */\r\nimport puremvc from 'puremvc';\r\npuremvc.define\r\n(\r\n\t// CLASS INFO\r\n\t{\r\n\t\tname: 'diygamePlayer.controller.command.StartupCommand',\r\n\t\tparent: puremvc.MacroCommand\r\n\t},\r\n\r\n\t// INSTANCE MEMBERS\t\r\n\t{\r\n\t\t/** @override */\r\n\t\tinitializeMacroCommand: function ()\r\n\t\t{\r\n\t\t\t// add the PrepareControllerCommand- it will register Commands with the Facade\r\n\t\t\tthis.addSubCommand( diygamePlayer.controller.command.PrepareControllerCommand );\r\n\r\n\t\t\t// add the PrepareModelCommand- it will register Proxys with the Facade\r\n\t\t\tthis.addSubCommand( diygamePlayer.controller.command.PrepareModelCommand );\r\n\r\n\t\t\t// add the SetupViewsCommand- it will register Mediators with the Facade\r\n\t\t\tthis.addSubCommand( diygamePlayer.controller.command.PrepareViewCommand );\r\n\t\t}\r\n\t}\r\n)","/**\r\n *\r\n * This is a simple state template to use for getting a Phaser game up\r\n * and running quickly. Simply add your own game logic to the default\r\n * state object or delete it and make your own.\r\n *\r\n */\r\n\r\n// initialize the app when all DOM content has loaded.\r\nimport 'babel-polyfill';\r\nimport './AppConstants.js';\r\nimport './ApplicationFacade.js';\r\nimport './controller/command/PrepareControllerCommand.js';\r\nimport './controller/command/PrepareModelCommand.js';\r\nimport './controller/command/PrepareViewCommand.js';\r\nimport './controller/command/StartupCommand.js';\r\nimport './model/proxy/SceneProxy.js';\r\nimport './view/component/Scene.js';\r\nimport './view/mediator/SceneMediator.js';\r\ndocument.addEventListener('DOMContentLoaded', function () {\r\n    //先获取浏览器显示宽高\r\n    global.width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\r\n    global.height = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\r\n    // initialize the facade by retrieving an instance and calling startup\r\n    diygamePlayer.ApplicationFacade.getInstance(diygamePlayer.ApplicationFacade.NAME).startup();\r\n    console.log(\"Initialized\");\r\n});","/**\r\n * @class demo.model.TextProxy\r\n * @extends puremvc.Proxy\r\n */\r\nimport puremvc from 'puremvc';\r\nimport Utils, {ResourcesManager} from '../../common/Utils.js';\r\nimport MD5 from 'spark-md5';\r\nimport Dialog from './../../common/Dialog.js';\r\nimport ShanyiMenu from './../../common/ShanyiMenu.js'\r\nimport * as Xhr from './../../common/XmlHttpRequest.js';\r\nimport PhoneUtils from '../../common/PhoneUtils.js';\r\nimport FontUtils from '../../common/FontUtils.js';\r\nimport OtherWap from \"../../common/OtherWap\";\r\nimport Copy from 'copy-to-clipboard';\r\nimport jsonp from 'jsonp';\r\n\r\npuremvc.define\r\n(\r\n\t// CLASS INFO\r\n\t{\r\n\t\tname: 'diygamePlayer.model.proxy.SceneProxy',\r\n\t\tparent: puremvc.Proxy\r\n\t},\r\n\r\n\t// INSTANCE MEMBERS\r\n\t{\r\n        chargeMsgReceive: function(ev) {\r\n        \tif (ev.originalEvent.key !== 'msgCharged') return; // ignore other keys\r\n            let message = JSON.parse(ev.originalEvent.newValue);\r\n            if (!message) return; // ignore empty msg or msg reset\r\n\r\n            // here you act on messages.\r\n            // you can send objects like { 'command': 'doit', 'data': 'abcd' }\r\n            if (message.command == 'doit') alert(message.data);\r\n        },\r\n        resumeAudio: function () {\r\n\t\t\tthis.bk_music && this.bk_music.play();\r\n            this.plotSounds && this.plotSounds.forEach(s => s && s.resume());\r\n            //if (this.isScreenHold) {\r\n                this.isScreenHold = false;\r\n                this.quickPlay = false;\r\n                if(this.quickPlayLayer){this.quickPlayLayer.alpha = 0};\r\n            //}\r\n        },\r\n\t\tpauseAudio: function () {\r\n            this.bk_music && this.bk_music.pause();\r\n            this.plotSounds && this.plotSounds.forEach(s => s && s.pause());\r\n            //if (this.isScreenHold) {\r\n                this.isScreenHold = false;\r\n                this.quickPlay = false;\r\n                if(this.quickPlayLayer){this.quickPlayLayer.alpha = 0};\r\n            //}\r\n        },\r\n\r\n        /**\r\n\t\t * Set the TextProxy's text.\r\n\t\t *\r\n\t\t * Sends a TextProxy.TEXT_CHANGED notification.\r\n\t\t *\r\n\t\t * @param {string} text\r\n\t\t * @return {void}\r\n\t\t */\r\n\t\tpreloadingBegin: function () {\r\n\t\t\tthis.stringMap = {};\r\n\t\t\tthis.stringMap.loadMenu = \"读档\";\r\n\t\t\tthis.stringMap.overMenu = \"结束\";\r\n\t\t\tthis.stringMap.settingsMenu = \"设置\";\r\n\t\t\tthis.stringMap.startMenu = \"开始\";\r\n\t\t\tthis.stringMap.menu = \"菜单\";\r\n\t\t\tthis.stringMap.mainMenu = \"菜单\";\r\n\t\t\tthis.stringMap.save = \"保存进度\";\r\n\t\t\tthis.stringMap.load = \"读取进度\";\r\n\t\t\tthis.stringMap.playback = \"剧情回放\";\r\n\t\t\tthis.stringMap.autoplay = \"自动播放\";\r\n\t\t\tthis.stringMap.manualPlay = \"手动播放\";\r\n\t\t\tthis.stringMap.settings = \"设置\";\r\n\t\t\tthis.stringMap.displayHeader = \"显示设定\";\r\n\t\t\tthis.stringMap.displayCaption = \"画面模式\";\r\n\t\t\tthis.stringMap.volumeHeader = \"音量\";\r\n\t\t\tthis.stringMap.musicCaption = \"音乐音量\";\r\n\t\t\tthis.stringMap.soundCaption = \"音效音量\";\r\n\t\t\tthis.stringMap.textHeader = \"文字设定\";\r\n\t\t\tthis.stringMap.textCaption = \"自动进行\";\r\n\t\t\tthis.stringMap.autoOn = \"开\";\r\n\t\t\tthis.stringMap.autoOff = \"关\";\r\n\t\t\tthis.stringMap.windowMode = \"窗口模式\";\r\n\t\t\tthis.stringMap.fullMode = \"全屏模式\";\r\n\t\t\tthis.stringMap.back = \"返回\";\r\n\t\t\tthis.progressTips = ['手指右滑就可召唤退出按钮，退出作品时，记得存档哦'\r\n\t\t\t\t, '收藏作品，更新会第一时间通知你'\r\n            \t, '把作品下载到本地，随时随地任性玩'\r\n            \t, '感觉作品很棒，和你的好友分享吧~'\r\n                , '引战、刷屏、作品无关的评论会被删除哦'\r\n\t\t\t\t, '素材库为全站通用，可能发生人物走错片场的情况，请不要慌张'\r\n            \t, '在当前作品的评论中对比其他作品容易给作者大大招黑哦~'\r\n                , '制作辛苦，写下精彩长评支持喜欢的作者吧'\r\n\t\t\t\t, '长按屏幕可以快进剧情'];\r\n\t\t\tthis.recordTipCount = 0;\r\n\t\t\tthis.isShowGuide = true;\r\n\t\t\tthis.plotSounds = [];\r\n\t\t\tthis.playbackData = [];\r\n\t\t\tthis.plotViews = [];\r\n\t\t\tthis.prgsViews = [];\r\n            this.plotViewKeys = [];\r\n\t\t\tthis.bViewLoaded = false;\r\n            this.bSignedIn = false;\r\n            this.bCloudSel = false;\r\n\t\t\tthis.visibleLayout = [];\r\n\t\t\tthis.resourceManager = {plotIndex: 0, resourceList: [], baseList: []};\r\n\t\t\tthis.lstDialogInfo = [];\r\n\t\t\tthis.menuInfo = [];\r\n\t\t\tthis.quickPlay = false;\r\n\t\t\tthis.isScreenHold = false;\r\n\t\t\tthis.bCmdAutoText = false;\r\n\t\t\tthis.isGameStarted = false;\r\n\t\t\tthis.usedStarCount = 0;\r\n\t\t\tthis.gameStarLimit = 0;\r\n\t\t\tthis.lstPlotTweens = [];\r\n\t\t\tthis.twinkleTimer = null;\r\n\t\t\tthis.uiOnLoadQueue = [];\r\n\t\t\tthis.timerCounts = [];\r\n\t\t\tthis.menuTimer = [];\r\n\t\t\tthis.recUidBelongTo = flashvars.uid;\r\n\t\t\tthis.gameUidBelongTo = flashvars.uid;\r\n\t\t\tthis.bSwitchAccInPlot = true;\r\n\t\t\tthis.payValueUid = flashvars.uid;\r\n\t\t\tthis.unlockChapterCallBack = null;\r\n\t\t\tthis.mallPayCallback = null;\r\n\t\t\tthis.isPaying = false;\r\n\t\t\tthis.isGettingNext = true;\r\n\t\t\tthis.isPreferentialFinished = false;\r\n\t\t\tthis.preferentialVector = [];\r\n\t\t\tthis.isSetValues = false;\r\n\t\t\tthis.isPaySuccess = false;\r\n\t\t\tthis.isGoToCommand = true;\r\n\t\t\tthis.shakeLoopObj = {level:0,duration:0,delay:0,loop:false,commands:null};\r\n\t\t\tthis.prePlotBkKey = null;\r\n\t\t\tthis.isQuickPlay = true;\r\n\t\t\tthis.hasCountDown = false;\r\n\t\t\tthis.saveBubbleVector = [];\r\n\t\t\tthis.saveBubbleDataVector = [];\r\n            this.bubbleArchivalCount = [];\r\n            this.dialogNext = null;\r\n            this.setValueAfterPay = false;\r\n            this.isInputFocus = false;\r\n            this.z_key = null;\r\n            this.isLineUpdatePaySuccess = false;\r\n            this.playAdCallBack = null;\r\n            this.playAdPayStatus = 0;\r\n            this.playPause = false;\r\n\t\t\tif(this.isWapOther()){\r\n                OtherWap.sendQHData();\r\n                OtherWap.initQHSdk().then((msg)=>{console.log(\"--->>>>> \" + msg)})\r\n\t\t\t}\r\n\t\t\taudioMgr.pause = this.pauseAudio.bind(this);\r\n\t\t\taudioMgr.resume = this.resumeAudio.bind(this);\r\n\t\t\taudioMgr.audioCanPlayCallBack = PhoneUtils.audioCanPlayCallBack.bind(PhoneUtils);\r\n\t\t\taudioMgr.audioErrorCallBack = PhoneUtils.audioErrorCallBack.bind(PhoneUtils);\r\n            gameCallback.updateAccInfo = this.updateAccInfo.bind(this);\r\n            gameCallback.unlockChapterFinished = this.unlockChapterFinished.bind(this);\r\n            gameCallback.mallPay = this.mallPay.bind(this);\r\n            gameCallback.preferentialFinished = this.preferentialFinished.bind(this);\r\n            gameCallback.showSave = this.showSaveInterface.bind(this);\r\n            gameCallback.playadBack = this.playadBackInterface.bind(this);\r\n\t\t\t//成功或者失败 都添加本地计时器\r\n\t\t\tUtils.getTimeOffset().then(()=>{Utils.localUpdateTime();},()=>{Utils.localUpdateTime();});\r\n\t\t\tUtils.sendSelOptions();\r\n\t\t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_PRELOADING_BEGIN);\r\n\t\t},\r\n        /**\r\n\t\t * 播放广告回调\r\n         * @param adtype\r\n         */\r\n        playadBackInterface:function (adtype) {\r\n            if(this.playAdCallBack !== null){\r\n                this.playAdCallBack(adtype);\r\n            }\r\n        },\r\n        /**调用存档*/\r\n        showSaveInterface:function () {\r\n            if(this.recordLayer.visible){ //存档界面关闭\r\n                this.recordLayer.visible = false;\r\n\t\t\t}\r\n            this.context.fullScreen && this.onSettingsWindowModeBtnClicked();//全屏 退出全屏\r\n            this.menuLayer.visible = true;//主菜单显示\r\n\t\t\tthis.getSnap();\r\n            this.menuLayer.visible = false;//主菜单按钮关闭\r\n\t\t\tthis.showSave();\r\n        },\r\n\r\n\t\t/*优惠券结束回调*/\r\n\t\tpreferentialFinished:function (result/*uuid*/) {\r\n\t\t\tconst downloaduuid = this.curChapter && (this.curChapter.downloadUuid ? this.curChapter.downloadUuid : this.curChapter.uuid);\r\n\t\t\tthis.preferentialVector.push((result.uuid ? result.uuid : result));//记录下限免结束的downloaduuid\r\n            if(downloaduuid === (result.uuid ? result.uuid : result)){\r\n                //当前章节的uuid和限免uuid相同\r\n                this.isPreferentialFinished = true;//通知限免结束\r\n            }\r\n        },\r\n\r\n\t\tunlockChapterFinished: function (result, stayIfFail) {\r\n            this.unlockChapterCallBack && this.unlockChapterCallBack(result, stayIfFail);\r\n        },\r\n\t\t/**移除限免记的数组*/\r\n        dislodgePreferentVector:function (uuid) {\r\n            for(let i =0;i < this.preferentialVector.length;i++){\r\n                if(uuid === this.preferentialVector[i]){\r\n                \tthis.preferentialVector.splice(i,1)\r\n\t\t\t\t};\r\n            }\r\n        },\r\n\r\n        mallPay: function (result) {\r\n\t\t\tthis.mallPayCallback && this.mallPayCallback(result);\r\n\t\t\tthis.mallPayCallback = null;\r\n        },\r\n\r\n\t\tcheckIfMallPaySuccess: function (indentId,type=0) {\r\n            const getData = (url, d) => {\r\n                return Xhr.xhrSend(url, d).then(rs => {\r\n                    if (rs.responseText.length === 0) {\r\n                        return Promise.resolve(false);\r\n                    }\r\n\r\n                    let retData = JSON.parse(rs.responseText);\r\n                    if(flashvars.client === 'wap'){\r\n                        if (retData.status === 100) {\r\n                            return Promise.resolve(retData.data.serial_num === indentId && retData.data.c_status == '1');\r\n                        }else if(retData.status === 200){// 不存在此订单的流水号\r\n                            return Promise.resolve(false);\r\n\t\t\t\t\t\t}else if(retData.status === 102){// 流水当好为空\r\n                            return Promise.resolve(false);\r\n\t\t\t\t\t\t}else if(retData.status === 101){ //不允许的类型\r\n                            return Promise.resolve(false);\r\n\t\t\t\t\t\t}else{\r\n                            return Promise.resolve(false);\r\n\t\t\t\t\t\t}\r\n                    }else{\r\n                        if (retData.status === 0) {\r\n                            return Promise.resolve(retData.data.serial_num === indentId && retData.data.c_status == '1');\r\n                        }\r\n                        else if (retData.status === 100) {// 不存在此订单的流水号\r\n                            return Promise.resolve(false);\r\n                        }\r\n                        else { // status>0 && status<9 账号被踢出\r\n                            return Promise.resolve(false);\r\n                        }\r\n\t\t\t\t\t}\r\n\r\n                }, rj => {\r\n                    return Promise.resolve(false); // 请求遭拒  如跨域问题\r\n                });\r\n            };\r\n            let url = 'https://app.3000.com/?m=consume&op=index&ac=market_order_status&client=' + flashvars.client + '&v=' + flashvars.v +'&app_version=' + flashvars.app_version;\r\n            let data = 'u=' + encodeURIComponent(Utils.aesEncrypt(flashvars.u, 1))\r\n\t\t\t\t+ '&token=' + encodeURIComponent(Utils.aesEncrypt(flashvars.token, 1))\r\n\t\t\t\t+ '&serial_num=' + encodeURIComponent(Utils.aesEncrypt(indentId, 1));\r\n            if(flashvars.client === 'wap'){\r\n            \tif(flashvars.uid === ''){\r\n                    return this.getUserInfoFromWap().then(()=>{\r\n\t\t\t\t\t\tif(flashvars.uid === ''){\r\n                            //未登入\r\n                            return Promise.resolve(false);\r\n\t\t\t\t\t\t}else{\r\n                            url = 'https://pay.3000.com/?m=consume&op=h5_flash_request';\r\n                            data = 'type=' + encodeURIComponent(Utils.aesEncrypt(type, 3))\r\n                                + '&serial_num=' + encodeURIComponent(Utils.aesEncrypt(indentId, 3));\r\n                            return getData(url, data);\r\n\t\t\t\t\t\t}\r\n                    })\r\n\t\t\t\t}else{\r\n                    url = 'https://pay.3000.com/?m=consume&op=h5_flash_request';\r\n                    data = 'type=' + encodeURIComponent(Utils.aesEncrypt(type, 3))\r\n                        + '&serial_num=' + encodeURIComponent(Utils.aesEncrypt(indentId, 3));\r\n                    return getData(url, data);\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n                return getData(url, data);\r\n\t\t\t}\r\n        },\r\n\r\n\t\taddAssets: function (url, type, key, isPlot) {\r\n\t\t\treturn ResourcesManager.pushInLoader(url, type, key, isPlot);\r\n\t\t},\r\n\r\n\t\taddImage: function (key, url, image) {\r\n\t\t\tthis.viewComponent.game.cache.addImage(key, url || null, image);\r\n\t\t},\r\n\r\n\t\taddImageUrl: function (url, md5) {\r\n\t\t\treturn new Promise((resolve,  reject) => {\r\n\t\t\t\tconst data = new Image();\r\n\t\t\t\tdata.src = url;\r\n\t\t\t\tdata.onload = e => {\r\n\t\t\t\t\tif (!this.viewComponent.game.load.cache.checkImageKey(md5)) {\r\n\t\t\t\t\t\tthis.viewComponent.game.cache.addImage(md5, url, e.target);\r\n\t\t\t\t\t\tresolve()\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tdata.onerror = data.onabort = e => reject(e);\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\t// 解析Json Template\r\n\t\tparseJsonFile: function (game) {\r\n\t\t\tthis.json_data = game;//JSON.parse(JSON.stringify(game));\r\n\t\t\t// load template\r\n\t\t\tconst promises = [];\r\n\t\t\tif (this.json_data.template && this.json_data.template.json) {\r\n\t\t\t\tpromises.push(this.parseTemplateCoverAssets());\r\n\t\t\t\tpromises.push(this.parseTemplateDialogAssets());\r\n\t\t\t\tpromises.push(this.parseTemplateMenuAssets());\r\n\t\t\t\tpromises.push(this.parseTemplateSyMenuAssets());\r\n\t\t\t\tpromises.push(this.parseTemplateMainMenuAssets());\r\n\t\t\t\tpromises.push(this.parseTemplateSettingsAssets());\r\n\t\t\t\tpromises.push(this.parseTemplateOptionAssets());\r\n\t\t\t\tpromises.push(this.parseTemplatePlaybackAssets());\r\n\t\t\t\tpromises.push(this.parseTemplateRecordAssets());\r\n\t\t\t\tpromises.push(this.parseTemplateSoundAssets());\r\n\t\t\t}\r\n\t\t\treturn Promise.all(promises).then(() => {\r\n\t\t\t\tif (false && this.json_data.font) {\r\n                    return FontUtils.mergeFontImage(this.json_data.font, this.json_data.default_settings.font_size);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn Promise.resolve();\r\n\t\t\t\t}\r\n\t\t\t}).then(() => {\r\n\t\t\t\t//this.json_data = Utils.fixGame(this.json_data);\r\n\t\t\t\tpromises.length = 0;\r\n\r\n\t\t\t\t// font image\r\n                FontUtils.fontImage && this.viewComponent.game.load.image(FontUtils.fontFamily, FontUtils.fontImage);\r\n\r\n                // load logo\r\n\t\t\t\tif (this.json_data.logo && this.json_data.logo.background && this.json_data.logo.background.url) {\r\n\t\t\t\t\tpromises.push(this.addAssets(this.json_data.logo.background.url, 'img'));\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// load cover\r\n\t\t\t\tif (this.json_data.cover.background && this.json_data.cover.background.url) {\r\n\t\t\t\t\tpromises.push(this.addAssets(this.json_data.cover.background.url, 'img'));\r\n\t\t\t\t}\r\n\t\t\t\tif (this.json_data.cover.music && this.json_data.cover.music.url) {\r\n                    let url = this.json_data.cover.music.url;\r\n\t\t\t\t\tpromises.push(this.addAssets(url, 'audio'));\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// load views\r\n\t\t\t\tconst addEventAssets = (events) => {\r\n\t\t\t\t\tif (Object.prototype.toString.call(events) == '[object Array]') {\r\n\t\t\t\t\t\tevents.forEach(e => {\r\n\t\t\t\t\t\t\te.events.forEach(subEvent => {\r\n\t\t\t\t\t\t\t\tif (subEvent.type === 'playMusic' && subEvent.handle.music.url) {\r\n\t\t\t\t\t\t\t\t\tpromises.push(this.addAssets(subEvent.handle.music.url, 'audio'));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if (subEvent.type === 'playSound') {\r\n\t\t\t\t\t\t\t\t\tsubEvent.handle.sounds.forEach(sound => {sound && sound.url != 'inherit' && promises.push(this.addAssets(sound.url, 'audio'));});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tfor (let p in this.json_data.viewMap) {\r\n                    if (this.json_data.viewMap[p].type === 'timer') {\r\n                        addEventAssets(this.json_data.viewMap[p].events);\r\n                        continue;\r\n                    }\r\n                    const background = this.json_data.viewMap[p].content.background;\r\n\t\t\t\t\tconst sound = this.json_data.viewMap[p].content.sound;\r\n\t\t\t\t\tif (!background) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (background.url) {\r\n\t\t\t\t\t\tpromises.push(this.addAssets(background.url, 'img'));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (background.normal && background.normal.url) {\r\n\t\t\t\t\t\tpromises.push(this.addAssets(background.normal.url, 'img'));\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (background.active && background.active.url) {\r\n\t\t\t\t\t\tpromises.push(this.addAssets(background.active.url, 'img'));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (background.progress && background.progress.url) {\r\n\t\t\t\t\t\tpromises.push(this.addAssets(background.progress.url, 'img'));\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (sound && sound.url) {\r\n\t\t\t\t\t\tpromises.push(this.addAssets(sound.url, 'audio'));\r\n\t\t\t\t\t}\r\n\t\t\t\t\taddEventAssets(this.json_data.viewMap[p].events);\r\n\t\t\t\t\tthis.json_data.viewMap[p].children.forEach(child => {addEventAssets(child.events)});\r\n\t\t\t\t}\r\n\t\t\t\treturn Promise.all(promises).then(() => {\r\n                    return Promise.resolve();\r\n                    //this.sendNotification( diygamePlayer.AppConstants.SCENE_PRELOADING_PROGRESS); // 移至获取闪币数方法中\r\n\t\t\t\t}, e => Promise.reject(e))\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tparseTemplateCoverAssets:function () {\r\n\t\t\tconst promises = [];\r\n\t\t\tconst {titleContainer, startMenu, loadMenu, settingsMenu, overMenu} = this.json_data.template.json.cover;\r\n\r\n\t\t\tif (titleContainer.background.url && titleContainer.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(titleContainer.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (startMenu.normal.background.url && startMenu.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(startMenu.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (startMenu.active.background.url && startMenu.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(startMenu.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (loadMenu.normal.background.url && loadMenu.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(loadMenu.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (loadMenu.active.background.url && loadMenu.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(loadMenu.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (settingsMenu.normal.background.url && settingsMenu.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(settingsMenu.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (settingsMenu.active.background.url && settingsMenu.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(settingsMenu.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (overMenu.normal.background.url && overMenu.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(overMenu.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (overMenu.active.background.url && overMenu.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(overMenu.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\treturn Promise.all(promises)\r\n\t\t},\r\n\r\n\t\tparseTemplateDialogAssets:function () {\r\n\t\t\tconst promises = [];\r\n\t\t\tconst {background, avatarContainer, titleContainer} = this.json_data.template.json.dialog;\r\n\r\n\t\t\tif (background && background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (avatarContainer.background.url && avatarContainer.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(avatarContainer.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (titleContainer.background.url && titleContainer.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(titleContainer.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\treturn Promise.all(promises)\r\n\t\t},\r\n\r\n\t\tparseTemplateMenuAssets:function () {\r\n\t\t\tconst promises = [];\r\n\t\t\tconst {normal, active} = this.json_data.template.json.menu;\r\n\t\t\tif (normal.background && normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (active.background && active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\treturn Promise.all(promises);\r\n\t\t},\r\n\r\n\t\tparseTemplateSyMenuAssets: function () {\r\n\t\t\tif (!this.json_data.template.json.shanyiMenu) return;\r\n\r\n            const promises = [];\r\n            const {normal, active} = this.json_data.template.json.shanyiMenu;\r\n            if (normal.background && normal.background.url) {\r\n                promises.push(this.addAssets(normal.background.url, 'img'));\r\n            }\r\n            if (active.background && active.background.url) {\r\n                promises.push(this.addAssets(active.background.url, 'img'));\r\n            }\r\n            return Promise.all(promises);\r\n        },\r\n\r\n\t\tparseTemplateMainMenuAssets:function () {\r\n\t\t\tconst promises = [];\r\n\t\t\tconst {background, header, save, load, playback, autoplay, settings, back} = this.json_data.template.json.mainMenu;\r\n\r\n\t\t\tif (background.url && background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (header.background && header.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(header.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (save.normal.background && save.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(save.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (save.active.background && save.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(save.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (load.normal.background && load.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(load.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (load.active.background && load.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(load.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (playback.normal.background && playback.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(playback.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (playback.active.background && playback.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(playback.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (autoplay.normal.background && autoplay.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(autoplay.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (autoplay.active.background && autoplay.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(autoplay.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (settings.normal.background && settings.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(settings.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (settings.active.background && settings.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(settings.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (back.normal.background && back.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(back.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (back.active.background && back.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(back.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\treturn Promise.all(promises);\r\n\t\t},\r\n\r\n\t\tparseTemplateSettingsAssets:function () {\r\n\t\t\tconst promises = [];\r\n\t\t\tconst {background, header, displayHeader, textHeader, displayCaption, textCaption, fullMode, windowMode, autoOn, autoOff, back} = this.json_data.template.json.settings;\r\n\t\t\tif(this.json_data.template.json.settings.musicCaption){\r\n\t\t\t\tconst musicCaption = this.json_data.template.json.settings.musicCaption;\r\n                if (musicCaption.background && musicCaption.background.url) {\r\n                    promises.push(this.addAssets(musicCaption.background.url, 'img'));\r\n                }\r\n\t\t\t}\r\n\t\t\tif(this.json_data.template.json.settings.musicVolume){\r\n                const musicVolume = this.json_data.template.json.settings.musicVolume;\r\n                if(musicVolume.normal && musicVolume.normal.background && musicVolume.normal.background.url){\r\n                    promises.push(this.addAssets(musicVolume.normal.background.url, 'img'));\r\n                }\r\n                if(musicVolume.progress && musicVolume.progress.background && musicVolume.progress.background.url){\r\n                    promises.push(this.addAssets(musicVolume.progress.background.url, 'img'));\r\n                }\r\n\t\t\t}\r\n\t\t\tif(this.json_data.template.json.settings.soundCaption){\r\n                const soundCaption = this.json_data.template.json.settings.soundCaption;\r\n                if (soundCaption.background && soundCaption.background.url) {\r\n                    promises.push(this.addAssets(soundCaption.background.url, 'img'));\r\n                }\r\n\t\t\t}\r\n\t\t\tif(this.json_data.template.json.settings.soundVolume){\r\n                const soundVolume = this.json_data.template.json.settings.soundVolume;\r\n                if(soundVolume.normal && soundVolume.normal.background && soundVolume.normal.background.url){\r\n                    promises.push(this.addAssets(soundVolume.normal.background.url, 'img'));\r\n                }\r\n                if(soundVolume.progress && soundVolume.progress.background && soundVolume.progress.background.url){\r\n                    promises.push(this.addAssets(soundVolume.progress.background.url, 'img'));\r\n                }\r\n\t\t\t}\r\n            if(this.json_data.template.json.settings.volumeHeader){\r\n                const volumeHeader = this.json_data.template.json.settings.volumeHeader;\r\n                if (volumeHeader.background && volumeHeader.background.url) {\r\n                    promises.push(this.addAssets(volumeHeader.background.url, 'img'));\r\n                }\r\n            }\r\n\t\t\tif (background && background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (header.background && header.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(header.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (displayHeader.background && displayHeader.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(displayHeader.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (textHeader.background && textHeader.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(textHeader.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (displayCaption.background && displayCaption.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(displayCaption.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (textCaption.background.url && textCaption.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(textCaption.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (fullMode.unchecked.background && fullMode.unchecked.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(fullMode.unchecked.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (fullMode.checked.background && fullMode.checked.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(fullMode.checked.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (windowMode.unchecked.background && windowMode.unchecked.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(windowMode.unchecked.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (windowMode.checked.background && windowMode.checked.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(windowMode.checked.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (autoOn.unchecked.background && autoOn.unchecked.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(autoOn.unchecked.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (autoOn.checked.background && autoOn.checked.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(autoOn.checked.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (autoOff.unchecked.background && autoOff.unchecked.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(autoOff.unchecked.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (autoOff.checked.background && autoOff.checked.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(autoOff.checked.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (back.normal.background && back.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(back.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (back.active.background && back.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(back.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\treturn Promise.all(promises);\r\n\t\t},\r\n\r\n\t\tparseTemplateOptionAssets:function () {\r\n\t\t\tconst promises = [];\r\n\t\t\tconst {normal, active} = this.json_data.template.json.option;\r\n\t\t\tif (normal.background && normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (active.background && active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\treturn Promise.all(promises);\r\n\t\t},\r\n\r\n\t\tparseTemplatePlaybackAssets:function () {\r\n\t\t\tconst promises = [];\r\n\t\t\tconst {background, scrollBox, back} = this.json_data.template.json.playback;\r\n\t\t\tif (background && background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (scrollBox.background && scrollBox.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(scrollBox.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (scrollBox.item.background && scrollBox.item.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(scrollBox.item.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (scrollBox.item.content.background && scrollBox.item.content.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(scrollBox.item.content.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (back.normal.background && back.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(back.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (back.active.background.url && back.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(back.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\treturn Promise.all(promises);\r\n\t\t},\r\n\r\n\t\tparseTemplateRecordAssets:function () {\r\n\t\t\tconst promises = [];\r\n\t\t\tconst {background, scrollBox, back} = this.json_data.template.json.record;\r\n\r\n\t\t\tif (background && background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (scrollBox.background && scrollBox.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(scrollBox.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (scrollBox.item.background && scrollBox.item.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(scrollBox.item.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (scrollBox.item.content.background && scrollBox.item.content.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(scrollBox.item.content.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (back.normal.background && back.normal.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(back.normal.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\tif (back.active.background.url && back.active.background.url) {\r\n\t\t\t\tpromises.push(this.addAssets(back.active.background.url, 'img'));\r\n\t\t\t}\r\n\t\t\treturn Promise.all(promises);\r\n\t\t},\r\n\r\n\t\tparseTemplateSoundAssets:function () {\r\n\t\t\tconst promises = [];\r\n\t\t\tif (this.json_data.template.json.sound && this.json_data.template.json.sound.url) {\r\n\t\t\t\tpromises.push(this.addAssets(this.json_data.template.json.sound.url, 'audio'));\r\n\t\t\t}\r\n\t\t\treturn Promise.all(promises);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * wap端 获取用户info\r\n\t\t * */\r\n\t\tgetUserInfoFromWap:function () {\r\n\t\t\t//const url = 'https://ptlogin.3000.com/?m=ptlogin&ac=cookieuid';\r\n            /*return Xhr.xhrLoad(url, '').then(rs => {\r\n                if (rs.responseText.length === 0) {\r\n                    //获取用户信息失败\r\n\t\t\t\t\tflashvars.uid = ''\r\n\t\t\t\t\treturn Promise.resolve()\r\n                }\r\n                const retData = JSON.parse(rs.responseText);\r\n                if(retData.success === true && retData.data ){\r\n                    flashvars.uid = retData.data.uid\r\n\t\t\t\t}\r\n                return Promise.resolve();\r\n            }, rj => {\r\n                flashvars.uid = '';\r\n                return Promise.resolve()\r\n            })*/\r\n            return new Promise((resolve,reject) =>{\r\n                jsonp('https://ptlogin.3000.com/?m=ptlogin&ac=cookieuid',{},(err,data)=>{\r\n                \tif(err){\r\n                        flashvars.uid = '';\r\n                        return resolve();\r\n                \t}\r\n\r\n                \tif(data){\r\n                        flashvars.uid = data.data.uid ? data.data.uid : '';\r\n\t\t\t\t\t}\r\n                    return resolve();\r\n\t\t\t\t})\r\n                /*jQuery.ajax({\r\n                    async : true,\r\n                    url : \"https://ptlogin.3000.com/?m=ptlogin&ac=cookieuid\",\r\n                    type : \"GET\",\r\n                    dataType : \"jsonp\", // 返回的数据类型，设置为JSONP方式\r\n                    jsonp : 'callback', //指定一个查询参数名称来覆盖默认的 jsonp 回调参数名 callback\r\n                    jsonpCallback: 'handleResponse', //设置回调函数名\r\n                    data : {},\r\n                    success: function(data){\r\n                        flashvars.uid = data.data.uid ? data.data.uid : '';\r\n                        return resolve();\r\n                    },\r\n                    error:function () {\r\n                        flashvars.uid = ''\r\n\t\t\t\t\t\treturn resolve();\r\n                    }\r\n                });*/\r\n\t\t\t})\r\n\r\n        },\r\n\r\n\t\tshowLogo: function ()\t{\r\n\t\t\tthis.sendNotification( diygamePlayer.AppConstants.SCENE_SHOW_LOGO);\r\n\t\t},\r\n\t\tshowCover: function () {\r\n\t\t\tconst { music } = this.json_data.cover;\r\n\t\t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_GOTO_COVERMENU);\r\n\t\t},\r\n\t\tshowMainMenu: function (context) {\r\n\t\t\tthis.onPause();\r\n\t\t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_GOTO_MAINMENU, context);\r\n\t\t},\r\n\t\tshowSettings: function (context, callbackInfo) {\r\n            this.onPause();\r\n            Utils.timeout(200).then(()=>{\r\n\t\t\t\tif (this.mainMenuLayer.visible) {\r\n\t\t\t\t\tthis.mainMenuLayer.visible = false;\r\n\t\t\t\t\tthis.visibleLayout = [this.mainMenuLayer, ...this.visibleLayout];\r\n\t\t\t\t}\r\n            })\r\n\t\t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_GOTO_SETTINGS, {context:context, callbackInfo: callbackInfo});\r\n\t\t},\r\n\t\tshowPlayback: function (callbackInfo) {\r\n            this.onPause();\r\n            Utils.timeout(200).then(()=>{\r\n                if (this.mainMenuLayer.visible) {\r\n                    this.mainMenuLayer.visible = false;\r\n                    this.visibleLayout = [this.mainMenuLayer, ...this.visibleLayout];\r\n                }\r\n            })\r\n\t\t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_GOTO_PLAYBACK, callbackInfo);\r\n\t\t},\r\n\r\n\t\tshowSave: function (bLocalCloudSwitch, callbackInfo) {\r\n\t\t\t// 隐藏菜单层\r\n\t\t\tthis.menuLayer.visible = false;\r\n            this.bToSaveFile = true;\r\n            this.loadData(bLocalCloudSwitch);\r\n            this.showRecord(callbackInfo);\r\n\r\n\t\t},\r\n\r\n\t\tshowLoad: function (bLocalCloudSwitch, callbackInfo) {\r\n            // 隐藏菜单层\r\n            this.menuLayer.visible = false;\r\n            if (flashvars.u==='' && flashvars.token==='' && flashvars.client==='') {\r\n                flashvars.uid = Utils.getUidByCookie();\r\n            }\r\n            if(flashvars.client === 'wap' && flashvars.uid === ''){\r\n            \tthis.getUserInfoFromWap().then(()=>{\r\n                    this.getPayInfo().then(() => {\r\n                        this.bToSaveFile = false;\r\n                        this.loadData(bLocalCloudSwitch);\r\n                        this.showRecord(callbackInfo);\r\n                    })\r\n\t\t\t\t})\r\n\t\t\t}else{\r\n                this.getPayInfo().then(() => {\r\n                    this.bToSaveFile = false;\r\n                    this.loadData(bLocalCloudSwitch);\r\n                    this.showRecord(callbackInfo);\r\n                })\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tshowRecord: function (callbackInfo) {\r\n            this.onPause();\r\n            Utils.timeout(200).then(()=>{\r\n                if (this.mainMenuLayer.visible) {\r\n                    this.mainMenuLayer.visible = false;\r\n                    this.visibleLayout = [this.mainMenuLayer, ...this.visibleLayout];\r\n                }\r\n\t\t\t})\r\n\r\n\t\t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_GOTO_RECORD, callbackInfo);\r\n\t\t},\r\n\r\n\t\tshowEnd: function () {\r\n\t\t\t//show end时， 调用app结束接口\r\n            if (flashvars.client === 'ios') {\r\n                if(flashvars.offline === 1){\r\n                    javascript:workFinished('1');\r\n                }else{\r\n                    window.webkit && window.webkit.messageHandlers.workFinished.postMessage('1');\r\n                }\r\n            }\r\n            else if (flashvars.client === 'android') {\r\n                window.app && window.app.workFinished('1');\r\n            }\r\n            this.sendNotification(diygamePlayer.AppConstants.SCENE_SHOW_INPUT_VIEW, false);\t// 隐藏剧情输入框\r\n\t\t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_GOTO_END);\r\n\t\t},\r\n\r\n\t\tisPlotResourceExist: function (plotInfo) {\r\n            const useIOSAudio = ('ios' === flashvars.client && '1.5.0' >= flashvars.app_versionl);\r\n\r\n            const usingCountMap = this.usingResourceCountMap();\r\n            let hasCheckCount = 0;\r\n            const isNotExist = (type, key) => {\r\n                const count = ResourcesManager.getCount(type, key);\r\n                if (!count || (count == usingCountMap[key] && !ResourcesManager.isGlobal(type, key) && !ResourcesManager.isUsingKey(key))) {\r\n                    return true;\r\n                }\r\n                hasCheckCount ++;\r\n                return false;\r\n            };\r\n\r\n            const checkCmd = command => {\r\n                if ('addImage' === command.type) {\r\n                    const { index,  url } = command.args[0];\r\n                    if ('inherit' === url) {\r\n                        return true;\r\n                    }\r\n                    return !isNotExist('img', url);\r\n                } else if (('playMusic' === command.type || 'playSound' === command.type)) {\r\n                    if('inherit' === command.args[0].url){\r\n                        return true;\r\n                    }\r\n                    return !isNotExist('audio', command.args[0].url);\r\n                } if ('showDialog' === command.type) {\r\n                    return !isNotExist('img', command.args[0].avatar.url);\r\n                } else if ('options' === command.type || 'conditionOptions' === command.type) {\r\n                    for (let item of command.args) {\r\n                        if (item.background && item.background.normal && item.background.normal.url && isNotExist('img', item.background.normal.url)) {\r\n                            return false;\r\n                        }\r\n                        if (item.background && item.background.active && item.background.active.url && isNotExist('img', item.background.active.url)) {\r\n                            return false;\r\n                        }\r\n                        if (item.background && item.background.disable && item.background.disable.url && isNotExist('img', item.background.disable.url)) {\r\n                            return false;\r\n                        }\r\n                        if (item.sound && item.sound.url && isNotExist('audio', item.sound.url)) {\r\n                            return false;\r\n                        }\r\n                    }\r\n                } else if ('weather' === command.type && '1' !== flashvars.offline && !isExistWeatherResources(command.args[0].value)) {\r\n                    return false;\r\n                }\r\n                return true;\r\n            }\r\n\r\n            const cmdState = { autotext: false, showDialog: false, hasOption: false };\r\n            const isSafeState =  () => {\r\n                if (cmdState.hasOption && hasCheckCount > 10) {\r\n                    return true;\r\n                }\r\n                if (cmdState.showDialog && !cmdState.autotext && hasCheckCount > 10) {\r\n                    return true;\r\n                }\r\n                return hasCheckCount > 20;\r\n            }\r\n\r\n            const checkCmds = commands => {\r\n                for (let i = 0; i < commands.length && !isSafeState(); i++) {\r\n                    const cmd = commands[i];\r\n                    if (!checkCmd(cmd)) {\r\n                        return false;\r\n                    }\r\n                    if(cmd.type === 'options'){\r\n                        cmdState.hasOption = true;\r\n                    }\r\n                    if(cmd.type === 'showDialog'){\r\n                        cmdState.showDialog = true;\r\n                    }\r\n                    if(cmd.type === 'autotext'){\r\n                        cmdState.autotext = true;\r\n                    }\r\n\r\n                    if ((cmd.type === 'options' || cmd.type === 'conditionOptions')) {\r\n                        for (let j = 0; j < cmd.args.length && !isSafeState(); j++) {\r\n                            if (!checkCmds(cmd.args[j].commands)) {\r\n                                return false;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                return true;\r\n            }\r\n\r\n            const isExistWeatherResources = weather => {\r\n                if (weather === 'snowy' && isNotExist('img', `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('snow')}/xuehua_00119.png`)) {\r\n                    return false;\r\n                }\r\n                else if (weather === 'rainy' && isNotExist('img', `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('rain')}/xiayu_00049.png`)) {\r\n                    return false;\r\n                }\r\n                else if (weather === 'defoliation' && isNotExist('img', `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('mapleLeaves')}/fengye_00089.png`)) {\r\n                    return false;\r\n                }\r\n                else if (weather === 'fallingPeach' && isNotExist('img', `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('beachBlossom')}/taohua_00089.png`)) {\r\n                    return false;\r\n                }\r\n                else if (weather === 'fallingFlower' && isNotExist('img', `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('blossom')}/yinghua_00089.png`)) {\r\n                    return false;\r\n                }\r\n                else if (weather === 'lightning' && isNotExist('img', `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('lightning')}/shandian_00049.png`)) {\r\n                    return false;\r\n                }\r\n                else if(flashvars.vertical && weather === 'windy' && isNotExist('img',`/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName('wind')}/feng_00019.png`)){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n                return true;\r\n            }\r\n\r\n            if (plotInfo.commands){\r\n                return checkCmds(plotInfo.commands);\r\n            }\r\n\r\n            if (plotInfo.background.url && plotInfo.background.url !== 'inherit' && isNotExist('img', plotInfo.background.url)) {\r\n                return false;\r\n            } \r\n            if (plotInfo.avatar.url && isNotExist('img', plotInfo.avatar.url)) {\r\n                return false;\r\n            }\r\n            if (plotInfo.music.url  && plotInfo.music.url !== 'inherit' && (isNotExist('audio', plotInfo.music.url) && !useIOSAudio)) {\r\n                return false;\r\n            }\r\n            if (plotInfo.options.length) {\r\n                for (let item of plotInfo.options) {\r\n                    if (item.background && item.background.normal && item.background.normal.url && isNotExist('img', item.background.normal.url)) {\r\n                        return false;\r\n                    }\r\n                    if (item.background && item.background.active && item.background.active.url && isNotExist('img', item.background.active.url)) {\r\n                        return false;\r\n                    }\r\n                    if (item.background && item.background.disable && item.background.disable.url && isNotExist('img', item.background.disable.url)) {\r\n                        return false;\r\n                    }\r\n                    if (item.sound && item.sound.url && isNotExist('audio', item.sound.url)) {\r\n                        return false;\r\n                    }\r\n                }\r\n            }\r\n            if (plotInfo.characters.length || plotInfo.props.length) {\r\n                for (let item of [...plotInfo.characters, ...plotInfo.props]) {\r\n                    if (isNotExist('img', item.url)) {\r\n                        return false;\r\n                    }\r\n                }\r\n            }\r\n            if (plotInfo.weather && flashvars.offline !==  '1' && !isExistWeatherResources(plotInfo.weather.value)) {\r\n                return false;\r\n            }\r\n            for (let item in plotInfo.plot_sound) {\r\n                if (plotInfo.plot_sound[item]) {\r\n                    const url = plotInfo.plot_sound[item].url;\r\n                    if (url && url!=='inherit' && !useIOSAudio && isNotExist('audio', plotInfo.plot_sound[item].url)) {\r\n                        return false;\r\n                    }\r\n                }\r\n            }\r\n            return true;\r\n        },\r\n\r\n\t\tgetLoadingPlotResource: function (plotInfo) {\r\n            const resources = [];\r\n            if (!plotInfo.commands) {\r\n                resources.push(...ResourcesManager.getPlotResources(plotInfo));\r\n            } else {\r\n                let countCmd = 0;\r\n                const resources = [];\r\n                const getInCommands = commands => {\r\n                    for (let i = 0; i < commands.length && countCmd < 20; i++) {\r\n                        const cmd = commands[i];\r\n                        const res = ResourcesManager.getCommandResources(cmd);\r\n                        if (res.length) {\r\n                            resources.push(...res);\r\n                            countCmd++;\r\n                        }\r\n\r\n                        if ((cmd.type === 'options' || cmd.type === 'conditionOptions')) {\r\n                            for (let j = 0; j < cmd.args.length && countCmd < 20; j++) {\r\n                                getInCommands(cmd.args[j].commands);\r\n                            }\r\n                        }\r\n                    }\r\n                };\r\n\r\n                getInCommands(plotInfo.commands);\r\n            }\r\n\r\n            const { load } = this.viewComponent.game;            \r\n            return resources.filter(({ type, url }) => load.getAsset('img' === type ? 'image' : 'audio', url)).map(a => Object.assign(a, { key: a.url }));\r\n        },\r\n\r\n\t\tusingResourceCountMap: function (key) {\r\n\t\t\tconst keyMap = { };\r\n\t\t\tconst imgCount = (g = this.viewComponent.game.world) => g.children.forEach(r => {\r\n\t\t\t\tkeyMap[r.key] = (keyMap[r.key] || 0) + 1;\r\n\t\t\t\timgCount(r);\r\n\t\t\t});\r\n\t\t\tconst soundCount = () => this.viewComponent.game.sound._sounds.forEach(s => keyMap[s.key] = (keyMap[s.key] || 0) + 1);\r\n\t\t\timgCount();\r\n\t\t\tsoundCount();\r\n\t\t\treturn keyMap;\r\n\t\t},\r\n\r\n        resetResources: function (resources = []) {\r\n            const usingCountMap = this.usingResourceCountMap();\r\n\t\t\tResourcesManager.forEachReCount((type, key, count) => {\r\n\t\t\t\tconst usingCount = usingCountMap[key];\r\n\t\t\t\tif (usingCount > 0) {\r\n\t\t\t\t\tResourcesManager.addRefCount(type, key, 'play',usingCount);\r\n\t\t\t\t}\r\n\t\t\t\tif (!resources.some(d => d.key === key)) {\r\n\t\t\t\t\t!count && ResourcesManager.removeFromCache(type, key);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (key === ResourcesManager.usingKeyMap.music) {\r\n\t\t\t\t\t\tResourcesManager.addRefCount(type, key);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (key === ResourcesManager.usingKeyMap.background) {\r\n\t\t\t\t\t\tResourcesManager.addRefCount(type, key);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (ResourcesManager.usingKeyMap.sounds.some(k => k === key)) {\r\n\t\t\t\t\t\tResourcesManager.addRefCount(type, key);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n        },\r\n\t\tgetResources: function (context, chapter, plotIndex, cmdPlotSnap={}, loadData) {\r\n\t\t\tconst { cmdInfo, cmdIndex, cmdScreenSnap } = cmdPlotSnap\r\n\t\t\tconst plots = chapter.plots;\r\n\t\t\tlet { music, sounds, background } = ResourcesManager.usingKeyMap;\r\n\t\t\tif(loadData){\r\n\t\t\t\tmusic = loadData.music.url\r\n\t\t\t\tsounds = loadData.sounds.map(s => s && s.url);\r\n\t\t\t\tbackground = loadData.background;\r\n\t\t\t}\r\n            ResourcesManager.forceDecode = { musics: [], sounds: new Array(10).fill('') };\r\n            if (!chapter.parent && !plotIndex) {\r\n                ResourcesManager.resetReCount();\r\n            }\r\n            ResourcesManager.LoadedMark = [];\r\n            ResourcesManager.gameData = this.json_data;\r\n            ResourcesManager.sceneProxy = this;\r\n\t\t\treturn ResourcesManager.getResourcesByContext(context, chapter, plotIndex, cmdInfo, cmdIndex).then(resources => {\r\n\t\t\t\tconst addResources = (data) => {\r\n\t\t\t\t\tif (!resources.data.some(d => d.key === data.key)) {\r\n\t\t\t\t\t\tresources.data.push(data);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tResourcesManager.addRefCount(data.type, data.key);\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif (plotIndex !== undefined && plots[plotIndex] && !plots[plotIndex].commands && plots[plotIndex].music.url === 'inherit') {\r\n\t\t\t\t\tconst music = this.getMusic(chapter, plotIndex);\r\n\t\t\t\t\tif (music) {\r\n\t\t\t\t\t\taddResources({ key: music, type: 'audio' });\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (loadData) {\r\n\t\t\t\t\tconst { music, sounds, charsAndProps, background, images,bubble } = loadData;\r\n\t\t\t\t\tif (background && !resources.data.some(d => d.key === background)) {\r\n\t\t\t\t\t\taddResources({ key: background, type: 'img' });\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (music && !resources.data.some(d => d.key === music.url)) {\r\n\t\t\t\t\t\tResourcesManager.forceDecode.musics.push(music.url);\r\n\t\t\t\t\t\taddResources({ key: music.url, type: 'audio' });\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsounds && sounds.forEach((s, i) => {\r\n\t\t\t\t\t\tif (s && !resources.data.some(d => d.key === s.url)) {\r\n\t\t\t\t\t\t\tResourcesManager.forceDecode.sounds[i] = s.url;\r\n\t\t\t\t\t\t\taddResources({ key: s.url, type: 'audio' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tcharsAndProps && charsAndProps.forEach(cp => {\r\n\t\t\t\t\t\tif (!resources.data.some(d => d.key === cp.url)) {\r\n\t\t\t\t\t\t\taddResources({ key: cp.url, type: 'img' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\timages && images.forEach(img => {\r\n\t\t\t\t\t\tif (!resources.data.some(d => d.key === img.url)) {\r\n\t\t\t\t\t\t\taddResources({ key: img.url, type: 'img' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n                    if(bubble){\r\n                        const getbubbleurl = (ary)=>{\r\n                            ary.forEach((cmds,index) =>{\r\n                                const {avatar,content} = cmds.args[0];\r\n                                if(avatar.url){\r\n                                    addResources({type:'img', key:avatar.url});\r\n                                }\r\n                                if(content.url){\r\n                                    addResources({type:'img', key:content.url});\r\n                                }\r\n                            })\r\n                        }\r\n                        bubble.forEach((b,i)=>{\r\n                            if(b.bubbleMode.args[0].url){\r\n                                resources.push({type:'img', key:b.bubbleMode.args[0].url});\r\n                            }\r\n                            getbubbleurl(b.bubble)\r\n                        })\r\n\r\n                    }\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (cmdScreenSnap) {\r\n\t\t\t\t\tconst { music, sounds, charsAndProps, dialogInfo, bk } = cmdPlotSnap.cmdScreenSnap;\r\n\t\t\t\t\tif (dialogInfo && dialogInfo[0] && dialogInfo[0].avatar.url) {\r\n\t\t\t\t\t\taddResources({ key: dialogInfo[0].avatar.url, type: 'img' });\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (bk && bk.url) {\r\n\t\t\t\t\t\taddResources({ key: bk.url, type: 'img' });\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (music && music.url) {\r\n\t\t\t\t\t\taddResources({ key: music.url, type: 'audio' });\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsounds && sounds.forEach((s, i) => s && s.url && addResources({ key: s.url, type: 'audio' }));\r\n\t\t\t\t\tcharsAndProps && charsAndProps.forEach(cp => cp && cp.url && addResources({ key: cp.url, type: 'img' }));\r\n\t\t\t\t\tif(cmdScreenSnap.weatherType !== ''){\r\n                        ResourcesManager.getWeatherResources(cmdScreenSnap.weatherType).forEach((w)=>{\r\n\t\t\t\t\t\t\tw && addResources({ key: w.url, type: w.type })\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn resources;\r\n\t\t\t});\r\n\t\t},\r\n\t\tpreloadCommandsAssets: function (context, chapter, plotIndex, cmdInfo, cmdIndex, loadData){\r\n\t\t\treturn this.getResources(context, chapter, plotIndex, { cmdInfo, cmdIndex }, loadData).then(resources => {\r\n                ResourcesManager.PreloadState.preloaded = 0;\r\n\t\t\t\tconst promises = [];\r\n\t\t\t\tloadData && this.resetResources(resources.data);\r\n\t\t\t\tresources.data.forEach(d => {\r\n\t\t\t\t\tpromises.push(this.addAssets(d.key, d.type, d.key, true).then(needLoad => Object.assign({needLoad},d)));\r\n\t\t\t\t});\r\n\t\t\t\treturn Promise.all(promises).then(resources => resources.filter(r => r.needLoad));\r\n\t\t\t});\r\n\t\t},\r\n\t\tpreloadChapterAssets: function (context, chapter, plotIndex, cmdPlotSnap, loadData,restart) {\r\n\t\t\tthis.curChapter = chapter;\r\n\t\t\tthis.curPlotIndex = plotIndex || 0;\r\n            this.cmdPlotSnap = cmdPlotSnap;\r\n\t\t\treturn this.getResources(context, chapter, plotIndex, cmdPlotSnap, loadData).then(resources => {\r\n                ResourcesManager.PreloadState.preloaded = 0;\r\n\t\t\t\tconst promises = [];\r\n\t\t\t\t(loadData || restart) && this.resetResources(resources.data); //重播和读档\r\n\t\t\t\tresources.data.forEach(d => {\r\n\t\t\t\t\tpromises.push(this.addAssets(d.key, d.type, d.key, true).then(needLoad => Object.assign({needLoad},d)));\r\n\t\t\t\t});\r\n\t\t\t\treturn Promise.all(promises).then(resources => {\r\n                    const needLoadList = resources.filter(r => r.needLoad);\r\n\t\t\t\t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_PLOT_LOAD_ASSETS_READY, {context, loadData, needLoadList});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tenableLayerInput: function (layer, bEnabled) {\r\n\t\t\tconst enableChild = function (child, b) {\r\n\t\t\t\tif (child.inputEnabled == !b && !child.text) {\r\n\t\t\t\t\tchild.inputEnabled = b;\r\n\t\t\t\t}\r\n\t\t\t\tif (child.children.length > 0) {\r\n\t\t\t\t\tfor (let i in child.children) {\r\n\t\t\t\t\t\tenableChild(child.children[i], b);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tif ('recordLayer' === layer.name) {\r\n\t\t\t\tlayer.visible = bEnabled;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\telse if ('menuLayer' === layer.name) {\r\n\t\t\t\tlayer.children[0].inputEnabled = bEnabled;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tfor (let i in layer.children) {\r\n\t\t\t\t\tenableChild(layer.children[i], bEnabled);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tapToFinalState: function () {\r\n            if (this.charsAndPropsLayer && this.charsAndPropsLayer.exists) {\r\n                for (let i=0; i<this.charsAndPropsLayer.children.length; i++) {\r\n                    let imgGroup = this.charsAndPropsLayer.children[i];\r\n                    let img = imgGroup.children[0];\r\n                    if (img && img.finalState) {\r\n                        img.alpha = img.finalState.alpha;\r\n                        img.angle = img.finalState.angle;\r\n                        img.x = img.finalState.x;\r\n                        img.y = img.finalState.y;\r\n                        imgGroup.x = 0;\r\n                        imgGroup.y = 0;\r\n                        imgGroup.scale.x = imgGroup.finalState.scale.x;\r\n                        imgGroup.scale.y = imgGroup.finalState.scale.y;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n\t\tremovePlotTweens: function () {\r\n            // 清理上一剧情动画\r\n            this.twinkleTimer && this.twinkleTimer.cancel() && (this.twinkleTimer=null);\r\n            while (this.lstPlotTweens.length) {\r\n                let tween = this.lstPlotTweens.splice(0, 1);\r\n                tween[0].stop(true);\r\n                if (tween[0].target && tween[0].target.name === 'twinkle') {\r\n                    tween[0].target.destroy();\r\n                }\r\n            }\r\n            this.apToFinalState();\r\n        },\r\n\r\n\t\tonPause: function () {\r\n\t\t\t// 暂停剧情播放\r\n            this.playPause = true;\r\n\r\n\t\t\t// 暂停所有元素的缓动动画\r\n            //this.viewComponent.game.tweens.pauseAll();\r\n            for (let i = this.viewComponent.game.tweens._tweens.length - 1; i >= 0; i--)\r\n            {\r\n            \tlet t = this.viewComponent.game.tweens._tweens[i];\r\n                if (t.name && t.name==='toast') continue;\r\n                t.pause();\r\n            }\r\n            this.sendNotification(diygamePlayer.AppConstants.SCENE_SHOW_INPUT_VIEW, false);\t// 隐藏剧情输入框\r\n        },\r\n\r\n\t\tonResume: function () {\r\n            this.isQuickPlay = true;\r\n            this.playPause = false;\t\t\t\t\t\t// 唤醒剧情播放\r\n            this.viewComponent.game.tweens.resumeAll();\t\t// 唤醒所有元素的缓动动画\r\n            this.hasCountDown && this.viewComponent.game.time.events.start(); // 恢复倒计时\r\n\t\t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_SHOW_INPUT_VIEW, true);\t// 显示剧情输入框UI\r\n        },\r\n\r\n\t\tonCoverStartBtnClicked: function () {\r\n            const chapter = this.findFirstChapter();\r\n            const chapterUuid = chapter.downloadUuid ? chapter.downloadUuid : chapter.uuid;\r\n            if (chapter.md5 && chapter.plots.length === 0) {\r\n                //第三方\r\n                if(this.isWapOther()){\r\n                    const otherback = (plots)=>{\r\n                        if(plots === null){\r\n                            Dialog.error('获取付费章节信息失败');\r\n                        }else if(plots === \"fail\"){\r\n                            //查询失败\r\n                            Dialog.custom(\"Error\",\"仍未查询到您的支付信息哦，请确认已经支付~ 如有疑问请添加闪艺客服QQ：819786897 ~\",\"提示\",\"复制QQ\",\"取消\",false).then(()=>{\r\n                                Copy(\"819786897\",{\r\n                                    debug: false,\r\n                                    message: '复制成功',\r\n                                })\r\n                            },()=>{\r\n                            })\r\n                        }else{\r\n                            chapter.plots = plots ? plots : [];\r\n                            this.preloadChapterAssets(this.context, chapter);\r\n                        }\r\n                    }\r\n                    this.unlockChapterByWapOther(chapterUuid,chapter.charge,chapter.md5,otherback);\r\n                    return;\r\n                }\r\n\r\n                if (chapter.charge && ('android' === flashvars.client || 'ios' === flashvars.client || flashvars.client === 'wap')) {\r\n                    const unlockFinish = (bSuccess, stayIfFail) => {\r\n                        if (bSuccess) {\r\n                            this.checkIfChapterFree(chapterUuid, chapter.md5).then((plots)=>{\r\n                                this.unlockChapterCallBack = null;\r\n                                chapter.plots.push(...plots);\r\n                                this.preloadChapterAssets(this.context, chapter);\r\n                            }, () => {\r\n                                if(flashvars.client === 'wap'){\r\n                                    window.parent && window.parent.playLogin();\r\n                                }else{\r\n                                    Dialog.error('获取付费章节信息失败');\r\n\t\t\t\t\t\t\t\t}\r\n                                this.coverLayer.visible = true;\r\n                            })\r\n                        }\r\n                        else if (stayIfFail) {\r\n                            this.coverLayer.visible = true;\r\n                        }\r\n                    };\r\n\r\n                    this.unlockChapter(chapterUuid, chapter.charge, chapter.md5, unlockFinish);\r\n                } else {\r\n                    this.checkIfChapterFree(chapterUuid, chapter.md5).then((plots)=>{\r\n                        chapter.plots.push(...plots);\r\n                        this.preloadChapterAssets(this.context, chapter);\r\n                    }, (msg)=>{\r\n                        if (-1 === msg.indexOf('code=87')) { // 账号未登录\r\n                            Dialog.error(msg);\r\n                        } else { // 未购买此章节\r\n                            if(flashvars.wap === 'zxwwap'){\r\n                                Dialog.info('当前为收费章节，是否前往闪艺抢先体验？').then(()=>{\r\n                                    window.location.href = 'https://wap.3000.com/?m=detail&op=index&ac=index&id='+ flashvars.gid;\r\n                                })\r\n                            }else{\r\n                                Dialog.info('当前为收费章节，请前往闪艺app或电脑端进行购买');\r\n\t\t\t\t\t\t\t}\r\n                        }\r\n                        this.coverLayer.visible = true;\r\n                    })\r\n\t\t\t\t}\r\n            } else {\r\n                this.preloadChapterAssets(this.context, chapter);// 播放剧情\r\n\t\t\t}\r\n            this.coverLayer.visible = false;\r\n        },\r\n\t\tonCoverLoadBtnClicked: function () {\r\n\t\t\tthis.showLoad();\r\n\t\t},\r\n\t\tonCoverSettingBtnClicked: function () {\r\n\t\t\tthis.showSettings(this.context)\r\n\t\t},\r\n\t\tonCoverOverBtnClicked: function () {\r\n\t\t\tif(flashvars.app_version && (flashvars.client === \"ios\" || flashvars.client === \"android\")){\r\n\t\t\t\t//点击结束按钮，app端，点击无效\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n            if (navigator.userAgent.indexOf(\"MSIE\") > 0) {\r\n                if (navigator.userAgent.indexOf(\"MSIE 6.0\") > 0) {\r\n                    window.opener = null;\r\n                    window.close();\r\n                } else {\r\n                    window.open('', '_top');\r\n                    window.top.close();\r\n                }\r\n            }\r\n            else if (navigator.userAgent.indexOf(\"Firefox\") > 0) {\r\n                window.location.href = 'about:blank ';\r\n            } else {\r\n                //open(location, '_self').close();\r\n                window.opener = null;\r\n                window.open(\"\", \"_self\");\r\n                window.close();\r\n            }\r\n\t\t},\r\n\r\n\t\tonMenuBtnClicked: function () {\r\n\t\t\tthis.getSnap();\r\n\t\t\t//this.onPause();\r\n\t\t\tthis.showMainMenu(this.context)\r\n\t\t},\r\n\t\t//更多按钮点击\r\n        onMenuBtnMoreClicked:function () {\r\n\t\t\tif(flashvars.single === true && flashvars.offline === '1'){\r\n                this.context.fullScreen && this.onSettingsWindowModeBtnClicked();\r\n                window.app && window.app.moreWorks();\r\n\t\t\t}\r\n        },\r\n\t\tonSyMenuBtnClicked: function () {\r\n\t\t\tif(flashvars.client === 'wap'){\r\n                this.context.fullScreen && this.onSettingsWindowModeBtnClicked();\r\n                window.parent && window.parent.closGame();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (flashvars.client === 'ios' || flashvars.client === 'android') {\r\n\t\t\t\tif(this.isWapOther()){\r\n                    this.context.fullScreen && this.onSettingsWindowModeBtnClicked();\r\n                    ShanyiMenu.showSyMenu().then(v => {\r\n                        if (1 !== v) {\r\n                            if (typeof v === 'string' && -1 !== v.indexOf('http')) {\r\n                                window.location.href = v;\r\n                            }\r\n                        }\r\n                    });\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (flashvars.app_version < '1.2.0') {\r\n\t\t\t\t\tDialog.info('版本过低，不支持该功能');\r\n\t\t\t\t} else {\r\n                    window.location.href = 'lzj3000://menu';\r\n                }\r\n\t\t\t} else {\r\n                this.context.fullScreen && this.onSettingsWindowModeBtnClicked();\r\n                ShanyiMenu.showSyMenu().then(v => {\r\n                \tif (1 !== v) {\r\n                          if (typeof v === 'string' && -1 !== v.indexOf('http')) {\r\n                            window.location.href = v;\r\n                        }\r\n                \t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n        },\r\n\r\n\t\tonMainMenuSaveBtnClicked: function () {\r\n            if (!this.context.disableSaveOrLoad || !this.context.disableSaveOrLoad.save) {\r\n                this.showSave();\r\n            } else {\r\n                this.showToast(1, '抱歉，作者在此设置了禁用存档');\r\n            }\r\n\t\t},\r\n\t\tonMainMenuLoadBtnClicked: function () {\r\n\t\t\tif (!this.context.disableSaveOrLoad || !this.context.disableSaveOrLoad.load) {\r\n                this.showLoad();\r\n\t\t\t} else {\r\n\t\t\t\tthis.showToast(1, '抱歉，作者在此设置了禁用读档');\r\n\t\t\t}\r\n\t\t},\r\n\t\tonMainMenuPlaybackBtnClicked: function () {\r\n\t\t\tthis.showPlayback();\r\n\t\t},\r\n\t\tonMainMenuAutoplayBtnClicked: function () {\r\n\t\t\tthis.context.auto = !this.context.auto;\r\n\t\t\tthis.onMainMenuBackBtnClicked();\r\n\t\t},\r\n\t\tonMainMenuSettingsBtnClicked: function () {\r\n\t\t\tthis.showSettings(this.context);\r\n\t\t},\r\n\t\tonMainMenuBackBtnClicked: function () {\r\n\t\t\tthis.mainMenuLayer.visible = false;\t\t\t// 隐藏主菜单层\r\n\t\t\tthis.onResume();\r\n\t\t\tif (this.context.auto) {\r\n\t\t\t\tthis.curPlotLayer.onChildInputDown.dispatch('auto');\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tonSettingsFullModeBtnClicked: function () {\r\n\t\t\tthis.viewComponent.game.scale.startFullScreen(false);\r\n\t\t\tthis.context.fullScreen = true;\r\n\t\t},\r\n\t\tonSettingsWindowModeBtnClicked: function () {\r\n\t\t\tthis.viewComponent.game.scale.stopFullScreen();\r\n\t\t\tthis.context.fullScreen = false;\r\n\t\t},\r\n\t\tonSettingsAutoOnBtnClicked: function () {\r\n\t\t\tthis.context.auto = true;\r\n\t\t},\r\n\t\tonSettingsAutoOffBtnClicked: function () {\r\n\t\t\tthis.context.auto = false;\r\n\t\t},\r\n\t\tonSettingsBackBtnClicked: function () {\r\n\t\t\tthis.visibleLayout[0] && (this.visibleLayout[0].visible = true);\r\n            if (this.visibleLayout[0] !== this.mainMenuLayer) {\r\n                this.onResume();\r\n            }\r\n\t\t\tthis.visibleLayout = this.visibleLayout.slice(1);\r\n\t\t\tthis.settingsLayer.visible = false;\r\n\t\t},\r\n\r\n\t\tonRecordBackBtnClicked: function () {\r\n\t\t\tthis.visibleLayout[0] && (this.visibleLayout[0].visible = true);\r\n            if (this.visibleLayout[0] !== this.mainMenuLayer) {\r\n                this.onResume();\r\n            }\r\n\t\t\tthis.visibleLayout = this.visibleLayout.slice(1);\r\n\t\t\tthis.recordLayer.visible = false;\r\n\r\n\t\t\tthis.showMenu();\r\n\t\t},\r\n\t\tonRecordLocalBtnClicked: function () {\r\n\t\t\tthis.bCloudSel = false;\r\n\t\t\tthis.bToSaveFile ? this.showSave(true) : this.showLoad(true);\r\n        },\r\n\t\tonRecordCloudBtnClicked: function () {\r\n\t\t\tthis.bCloudSel = true;\r\n            this.bToSaveFile ? this.showSave(true) : this.showLoad(true);\r\n        },\r\n\r\n\t\tshowMenu: function () {\r\n            // 显示菜单层\r\n            this.menuLayer.visible = true;\r\n            if (this.curPlotInfo && this.curPlotInfo.menu) {\r\n                this.menuLayer.visible = !this.curPlotInfo.menu.hidden;\r\n            }\r\n        },\r\n\r\n\t\tshowGuideTip:function (index) {\r\n\t\t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_SHOW_GUIDE,{id:index})\r\n        },\r\n\r\n\t\tisSignedIn: function () {\r\n\t\t\treturn this.loadCloudRecord(99).then(rs => {\r\n\t\t\t\tconst convertCloudData = (data) => {\r\n\t\t\t\t\tlet cdata = JSON.parse(data);\r\n\t\t\t\t\tlet rdata = Array(12);\r\n\r\n\t\t\t\t\tfor (let i=0; i<cdata.length; i++) {\r\n                        if (!cdata[i].plotUuid) {\r\n                        \trdata[i] = {};\r\n                        \tcontinue\r\n                        }\r\n                        else {\r\n                        \tlet strTS = '' + cdata[i].time_stamp;\r\n                        \trdata[i] = {};\r\n                        \trdata[i].plotUuid = cdata[i].plotUuid;\r\n                        \trdata[i].timestamp = strTS.length > 10 ? cdata[i].time_stamp : cdata[i].time_stamp * 1000;\r\n                        \trdata[i].plotSnap = 'data:image/jpeg;base64,' + cdata[i].plot_snap;\r\n                        }\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn rdata;\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthis.bSignedIn = true;\r\n\t\t\t\tthis.cloudPlotsData = rs === ''? Array(12).fill({}) : convertCloudData(rs);\r\n\t\t\t\treturn this.getPayInfo().then(() => this.getAccountInfo()).then(() => {return Promise.resolve()});\r\n\t\t\t\t}\r\n\t\t\t, rj => {\r\n\t\t\t\tthis.bSignedIn = false;\r\n\t\t\t\treturn Promise.reject(rj);\r\n\t\t\t\t});\r\n        },\r\n\r\n\t\tfindFirstChapter: function () {\r\n\t\t\tconst checkChapter = chapter => {\r\n\t\t\t\tif (chapter.plots.length > 0 || chapter.md5) {\r\n\t\t\t\t\tchapter.isFirst = true;\r\n\t\t\t\t\treturn chapter;\r\n                }\r\n\t\t\t\tfor (let i=0; i<chapter.subchapters.length; i++) {\r\n\t\t\t\t\tconst result = checkChapter(chapter.subchapters[i]);\r\n\t\t\t\t\tif (result) {\r\n\t\t\t\t\t\treturn result;\r\n                    }\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t};\r\n\r\n\t\t\tfor (let i=0; i<this.json_data.chapters.length; i++) {\r\n\t\t\t\tconst result = checkChapter(this.json_data.chapters[i]);\r\n\t\t\t\tif (result) return result;\r\n\t\t\t}\r\n\r\n\t\t\treturn this.json_data.chapters[0];\r\n        },\r\n\r\n\t\tnotifyGameStarted: function () {\r\n\t\t\tif (flashvars.app_version && flashvars.app_version < '1.3.0') {\r\n                this.isGameStarted = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.isGameStarted = true;\r\n            if (flashvars.client === 'ios') {\r\n                if(flashvars.offline == 1){\r\n                    javascript:gameStart('1');\r\n                }else{\r\n                    window.webkit && window.webkit.messageHandlers.gameStart.postMessage('1');\r\n                }\r\n            }\r\n            else if (flashvars.client === 'android') {\r\n                window.app && window.app.gameStart('1');\r\n            }\r\n            else if (this.isWap3000()) {\r\n                Xhr.xhrLoad('https://www.3000.com/apis/client/v1.0/trace-play.html?id=' + flashvars.gid + '&from=wap', '', null);\r\n\t\t\t}\r\n        },\r\n\r\n        updateAccInfo: function (bLogout, bEntering) {\r\n\t\t\tif(flashvars.single && flashvars.offline === '1'){\r\n                if (!this.context) {\r\n                    this.context = {};\r\n                }\r\n                this.getPayInfo().then((rs)=>{\r\n                    this.getAccountInfo().then(()=>{\r\n                        if (bEntering) {\r\n                            this.sendNotification( diygamePlayer.AppConstants.SCENE_PRELOADING_PROGRESS);\r\n                        }\r\n                    })\r\n\t\t\t\t})\r\n                return;\r\n\t\t\t}\r\n            if (bLogout) {\r\n                flashvars.u = '';\r\n                flashvars.token = '';\r\n                this.context.systemValues[0].value = 0;\r\n                this.getPayInfo();\r\n                return;\r\n            }\r\n\r\n            if (!this.context) {\r\n                this.context = {};\r\n                \r\n            }\r\n            const update = ()=>{\r\n                this.localRecFileToUidRecFile(false);\r\n\r\n                const doUpdate = () => {\r\n                    this.getPayInfo().then((rs) => {\r\n                        if (Object.prototype.toString.apply(rs) !== '[object String]' || rs === \"\" || bEntering) {\r\n                        \tif(rs === \"\" && flashvars.uid && this.json_data.payValues){\r\n                                this.payValueUid = flashvars.uid;\r\n                        \t\t//一开始获取的就是空值时，保存一份本地最新值\r\n                                const copy = (obj) => {\r\n                                    if (!obj) {\r\n                                        return obj;\r\n                                    }\r\n                                    return JSON.parse(JSON.stringify(obj))\r\n                                };\r\n                                this.context.payValues = copy(this.json_data.payValues);\r\n                                this.context.payValues.forEach(v =>{v.value = v.init.value})\r\n\t\t\t\t\t\t\t\tthis.savePayInfo();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(bEntering){\r\n                                this.getAccountInfo().then(() => {\r\n                                    this.getFansInfo().then(() => {\r\n                                        if (bEntering/*!this.context.values*/) {\r\n                                            this.sendNotification( diygamePlayer.AppConstants.SCENE_PRELOADING_PROGRESS);\r\n                                        }\r\n                                    })\r\n                                });\r\n\t\t\t\t\t\t\t}\r\n                        }\r\n                        else {\r\n                            setTimeout(function() {return doUpdate();}, 1);\r\n                        }\r\n                    });\r\n                };\r\n                doUpdate();\r\n\t\t\t}\r\n            if (!flashvars.uid && !flashvars.client) {\r\n            \tflashvars.uid = Utils.getUidByCookie();\r\n\t\t\t}\r\n\t\t\tif(flashvars.client === 'wap' && flashvars.uid === ''){\r\n            \tthis.getUserInfoFromWap().then(()=>{\r\n\t\t\t\t\tupdate();\r\n\t\t\t\t})\r\n\t\t\t}else{\r\n                update();\r\n\t\t\t}\r\n\r\n\r\n\t\t},\r\n\r\n\t\tlocalRecFileToUidRecFile: function (bLocalCloudSwitch) {\r\n            const recId = flashvars.uuid + flashvars.uid;\r\n            const userData = Utils.localStorageGetItem(recId);\r\n            const savedData = Utils.localStorageGetItem(flashvars.uuid);\r\n            if (!userData && savedData) {\r\n                Utils.localStorageSetItem(recId, savedData);\r\n                Utils.localStorageRemoveItem(flashvars.uuid);\r\n            }\r\n            if (!bLocalCloudSwitch) {\r\n                if (this.recordLayer && this.recordLayer.visible) {\r\n                    this.bSwitchAccInPlot = false;\r\n                } else {\r\n                    this.bSwitchAccInPlot = true;\r\n                }\r\n            }\r\n            if (this.gameUidBelongTo === '' && flashvars.uid !== '') {\r\n                this.gameUidBelongTo = flashvars.uid;\r\n            }\r\n        },\r\n\r\n\t\tgetFansInfo: function () {\r\n\t\t\tif ('ios' !== flashvars.client && 'android' !== flashvars.client && flashvars.client !== 'wap') {\r\n\t\t\t\tflashvars.uid = Utils.getUidByCookie();\r\n\t\t\t}\r\n            const getData = (url)=>{\r\n                return Xhr.xhrLoad(url, '',null,false).then(rs => {\r\n                    if (rs.responseText.length === 0) {\r\n                        return Promise.resolve('Get Fans Count failed, no response data');\r\n                    }\r\n                    const data = JSON.parse(rs.responseText);\r\n                    this.context.systemValues[9].value = data.data.fans_total;\r\n                    return Promise.resolve(this.context.systemValues);\r\n                }, rj => {\r\n                    return Promise.resolve('跨域了('+rj+')');\r\n                })\r\n            }\r\n            let url = 'https://pay.3000.com/?m=payinterface&op=player_one_opus_fans&opus_id=' + flashvars.gid + '&uid=' + flashvars.uid;\r\n            if(flashvars.client === 'wap'){\r\n                return this.getUserInfoFromWap().then(()=>{\r\n                    url = 'https://pay.3000.com/?m=payinterface&op=player_one_opus_fans&opus_id=' + flashvars.gid + '&uid=' + flashvars.uid;\r\n\t\t\t\t\treturn getData(url);\r\n                })\r\n            }else{\r\n                return getData(url);\r\n\t\t\t}\r\n\t\t},\r\n\r\n        saveAccountInfo:function () {\r\n            const sendData = (systemvalue) => {\r\n                //保存消费数据和 系统数值到本地  和apk中\r\n                return new Promise((resolve,reject)=>{\r\n                    window.app && window.app.saveGameValue(flashvars.uuid + 'systemInfo',systemvalue);\r\n                    Utils.localStorageSetItem(flashvars.uuid + 'systemInfo', systemvalue);\r\n                    return resolve();\r\n                })\r\n            };\r\n            const systemvaluestr = JSON.stringify(this.context.systemValues);\r\n            const systemvalueBase64 = Utils.encodeBase64(systemvaluestr);\r\n            return sendData(systemvalueBase64);\r\n        },\r\n\r\n        getAccountInfo: function () {\r\n            if(flashvars.single && flashvars.offline === '1'){\r\n                return new Promise((resolve,reject)=>{\r\n                    let systemData = null;\r\n                    if(window.app){\r\n                        systemData = window.app.readGameValue(flashvars.uuid + 'systemInfo')\r\n                    }\r\n                    if(systemData === null){\r\n                        systemData = Utils.localStorageGetItem(flashvars.uuid + 'systemInfo');\r\n                    }\r\n                    if(systemData){\r\n                        let values = JSON.parse(Utils.decryptBase64(systemData));\r\n                        if(!this.context.systemValues){\r\n                            this.context.systemValues = values;\r\n                            return resolve(this.context.systemValues);\r\n\t\t\t\t\t\t}\r\n                        for(let i = 0;i < values.length;i++){\r\n                            for(let j = 0;j < this.context.systemValues.length;j++){\r\n                                if (this.context.systemValues[j].uuid === values[i].uuid) {\r\n                                    this.context.systemValues[j].value = (values[i].value === undefined ? this.context.systemValues[j].init.value : values[i].value);\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                        return resolve(this.context.systemValues);\r\n                    }else{\r\n                    \tif(!this.context.systemValues){\r\n                            this.context.systemValues = [{name: '闪币余额', uuid: '', key:'coinTotal', init: { type: 'system', value: 0 }}\r\n                                , {name: '星星余额', uuid: '', key:'starTotal', init: { type: 'system', value: 0}}\r\n                                , { name: '时间戳', uuid: '', key:'timestamp', init: { type: 'system', value: -1 }}\r\n                                , { name: '当前年', uuid: '', key:'year', init: { type: 'system', value: -1 } }\r\n                                , { name: '当前月', uuid: '', key:'month', init: { type: 'system', value: -1 } }\r\n                                , { name: '当前日', uuid: '', key:'day', init: { type: 'system', value: -1 } }\r\n                                , { name: '当前小时', uuid: '', key:'hour', init: { type: 'system', value: -1 } }\r\n                                , { name: '当前分钟', uuid: '', key:'minute', init: { type: 'system', value: -1 } }\r\n                                , { name: '当前秒', uuid: '', key:'second', init: { type: 'system', value: -1 } }\r\n                                , { name: '贡献值', uuid: '', key:'contribution', init: { type: 'system', value: 0 } }\r\n                                , { name: '星期', uuid: '', key:'weekday', init: {type: 'system', value: 0 } } ];\r\n\t\t\t\t\t\t}\r\n                        for(let i = 0;i < this.context.systemValues.length;i++){\r\n                            this.context.systemValues[i].value = this.context.systemValues[i].init.value;\r\n                        }\r\n                        return resolve('失败')\r\n                    }\r\n                })\r\n            }\r\n            const getData = (url, d,single = false) => {\r\n                    return Xhr.xhrSend(url, d, null, 4000).then(rs => {\r\n                        if (rs.responseText.length === 0) {\r\n                            return Promise.resolve('Get AccountInfo failed, no response data');\r\n                        }\r\n                        let retData = {};\r\n                        try{\r\n                            retData = JSON.parse(rs.responseText);\r\n                        }catch (err){\r\n                            return Promise.resolve('Get AccountInfo failed, no response data');\r\n                        }\r\n                        if (retData.status === 0) {\r\n                            this.context.systemValues[0].value = retData.data.payment_available;\r\n                            this.context.systemValues[1].value = retData.data.game_coin_available ? retData.data.game_coin_available : 0;\r\n                            this.usedStarCount = retData.data.single_game_star_use ? retData.data.single_game_star_use : 0;\r\n                            this.gameStarLimit = retData.data.single_game_star ? retData.data.single_game_star : 0;\r\n                            return Promise.resolve(this.context.systemValues);\r\n                        }\r\n                        else { // status>0 && status<9 账号被踢出\r\n                            this.context.systemValues[0].value = 0;\r\n                            this.context.systemValues[1].value = 0;\r\n                            this.usedStarCount = 0;\r\n                            this.gameStarLimit = 0;\r\n                            return Promise.resolve(retData);\r\n                        }\r\n                    }, rj => {\r\n                        this.context.systemValues[0].value = 0;\r\n                        this.context.systemValues[1].value = 0;\r\n                        return Promise.resolve('获取用户信息权限错误(' + rj + ')');\r\n                    });\r\n            };\r\n            const get = ()=>{\r\n                let url = 'https://pay.3000.com/?m=player&op=h5_get_account_info';\r\n                let data = 'gid=' + flashvars.gid;\r\n                if (flashvars.client === 'ios' || flashvars.client === 'android') {\r\n                    url = 'https://app.3000.com/?m=user&op=index&ac=my_account&client=' + flashvars.client +'&v=' + flashvars.v + '&app_version=' + flashvars.app_version;\r\n                    data = 'u=' + encodeURIComponent(Utils.aesEncrypt(flashvars.u, 1)) + '&token=' + encodeURIComponent(Utils.aesEncrypt(flashvars.token, 1))\r\n                        + '&game_id=' + encodeURIComponent(Utils.aesEncrypt(flashvars.gid, 1));\r\n                }\r\n\r\n                if(this.bSignedIn !== true && flashvars.client !== 'ios' && flashvars.client !== 'android' && flashvars.client !== 'wap'){\r\n                    //记录状态未登入，非ios和android端时，\r\n                    return this.loadCloudRecord(99).then(rs => {\r\n                            //登入状态\r\n                            return getData(url, data);\r\n                        }\r\n                        , rj => {\r\n                            //未登入状\r\n                            this.context.systemValues[0].value = 0;\r\n                            this.context.systemValues[1].value = 0;\r\n                            return Promise.resolve('pc端未登入，无法同步闪币信息！');\r\n                        });\r\n                }\r\n                return getData(url, data);\r\n            }\r\n            if (!this.context.systemValues) {\r\n                this.context.systemValues = [{name: '闪币余额', uuid: '', key:'coinTotal', init: { type: 'system', value: 0 }}\r\n                    , {name: '星星余额', uuid: '', key:'starTotal', init: { type: 'system', value: 0}}\r\n                    , { name: '时间戳', uuid: '', key:'timestamp', init: { type: 'system', value: -1 }}\r\n                    , { name: '当前年', uuid: '', key:'year', init: { type: 'system', value: -1 } }\r\n                    , { name: '当前月', uuid: '', key:'month', init: { type: 'system', value: -1 } }\r\n                    , { name: '当前日', uuid: '', key:'day', init: { type: 'system', value: -1 } }\r\n                    , { name: '当前小时', uuid: '', key:'hour', init: { type: 'system', value: -1 } }\r\n                    , { name: '当前分钟', uuid: '', key:'minute', init: { type: 'system', value: -1 } }\r\n                    , { name: '当前秒', uuid: '', key:'second', init: { type: 'system', value: -1 } }\r\n                    , { name: '贡献值', uuid: '', key:'contribution', init: { type: 'system', value: 0 } }\r\n                    , { name: '星期', uuid: '', key:'weekday', init: {type: 'system', value: 0 } } ];\r\n            }\r\n            if(flashvars.client === 'wap'){\r\n                if(flashvars.uid === ''){\r\n                    return this.getUserInfoFromWap().then(()=>{\r\n\t\t\t\t\t\tif(flashvars.uid === ''){\r\n                            this.context.systemValues[0].value = 0;\r\n                            this.context.systemValues[1].value = 0;\r\n                            this.usedStarCount = 0;\r\n                            this.gameStarLimit = 0;\r\n                            return Promise.resolve({status:1,message:'您还没有登入！'});\r\n\t\t\t\t\t\t}else{return get();}\r\n                    })\r\n\t\t\t\t}else{return get();}\r\n\t\t\t}else{\r\n                return get();\r\n\t\t\t}\r\n        },\r\n        /**\r\n\t\t *获取消费数值\r\n         * @param outlogin\t是否需服务器返回判断未登入\r\n         */\r\n        getPayInfo: function (outlogin) {\r\n            if (!this.context.payValues) {\r\n                this.context.payValues = [{name: '消费数值1',\r\n                    uuid: '',\r\n                    init: { type: 'const', value: 0 },\r\n                    value: 0\r\n                }];\r\n            }\r\n        \tif(flashvars.single && flashvars.offline === '1'){\r\n                return new Promise((resolve,reject)=>{\r\n                    let payInfoData = null;\r\n                    if(window.app && window.app.readGameValue){\r\n                        payInfoData = window.app.readGameValue(flashvars.uuid + 'payInfo')\r\n                    }\r\n                    if(payInfoData === null){\r\n                        payInfoData = Utils.localStorageGetItem(flashvars.uuid + 'payInfo');\r\n                    }\r\n                    if(payInfoData){\r\n                        let values = JSON.parse(Utils.decryptBase64(payInfoData));\r\n                        for (let i=0; i<values.length; i++) {\r\n                            for (let j=0; j<this.json_data.payValues.length; j++) {\r\n                                if (this.json_data.payValues[j].uuid === values[i].uuid) {\r\n                                    if(values[i].value === undefined){\r\n                                        values[i].value = values[i].init.value || 0;\r\n                                    }\r\n                                    this.context.payValues[j] = values[i];\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                        return resolve(this.context.payValues)\r\n                    }else{\r\n                        return resolve('失败')\r\n                    }\r\n                })\r\n            }\r\n\r\n            const getData = (url, d) => {\r\n                return Xhr.xhrSend(url, d, null, 4000).then(rs => {\r\n                    if (rs.responseText.length === 0) {\r\n                        return Promise.resolve('Get AccountInfo failed, no response data');\r\n                    }\r\n                    let retData = JSON.parse(rs.responseText);\r\n                    if (retData.status === 0 || retData.status === -1) {\r\n                    \tif (retData.status === -1) {\r\n                    \t\t//服务器返回没有登入，获取本地cookie值\r\n                            let payInfoData = Utils.localStorageGetItem(flashvars.uuid + 'payInfo'/* + flashvars.uid*/);\r\n                            retData.data.content = payInfoData === null ? '' : payInfoData;\r\n                            if(outlogin && retData.msg && retData.msg.indexOf('您还没有登录') !== -1){\r\n                            \tflashvars.uid = '';\r\n                            \treturn Promise.resolve(retData.msg);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (retData.status === 0 && !retData.data.content) {\r\n                    \t\t//已登入，没有值返回\r\n                            let payInfoData = Utils.localStorageGetItem(flashvars.uuid + 'payInfo' + flashvars.uid);\r\n                            Utils.localStorageRemoveItem(flashvars.uuid + 'payInfo' + flashvars.uid);\r\n                            if (!payInfoData) {\r\n                                payInfoData = Utils.localStorageGetItem(flashvars.uuid + 'payInfo');\r\n                                Utils.localStorageRemoveItem(flashvars.uuid + 'payInfo');\r\n\t\t\t\t\t\t\t}\r\n                            retData.data.content = payInfoData === null ? '' : payInfoData;\r\n\t\t\t\t\t\t}\r\n                        if (retData.data.content !== '' && this.json_data.payValues) {\r\n                            this.payValueUid = flashvars.uid;\r\n                        \tlet values = JSON.parse(Utils.decryptBase64(retData.data.content));\r\n                        \tfor (let i=0; i<values.length; i++) {\r\n                                for (let j=0; j<this.json_data.payValues.length; j++) {\r\n                                    if (this.json_data.payValues[j].uuid === values[i].uuid) {\r\n                                        if(values[i].value === undefined){\r\n                                            values[i].value = values[i].init.value || 0;\r\n                                        }\r\n                                        this.context.payValues[j] = values[i];\r\n                                        break;\r\n                                    }\r\n                                }\r\n                            }\r\n                            if (0 === retData.status && -1 !== rs.responseText.indexOf('{\\\"content\\\":\\\"\\\"}')) {\r\n                        \t\treturn this.savePayInfo();\r\n\t\t\t\t\t\t\t}\r\n                            return Promise.resolve(this.context.payValues);\r\n                        }\r\n                        else {\r\n                    \t\tif (this.payValueUid !== flashvars.uid) {\r\n                    \t\t\tthis.context.payValues.forEach(v => {v.value = 0})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn Promise.resolve('');\r\n                            //return this.savePayInfo();\r\n                        }\r\n                    }\r\n                    return Promise.resolve('获取用户信息失败(' + retData.msg + ':' + retData.status + ')');\r\n                }, rj => {\r\n                    return Promise.resolve('获取用户信息权限错误(' + rj + ')');\r\n                });\r\n            };\r\n            let aesKeyType = flashvars.u && flashvars.token ? 1 : 0;\r\n            //let stime = Math.floor((new Date()).getTime() / 1000) + Utils.timeOffset;\r\n            let stime = Utils.localTime + Utils.timeOffset;\r\n            let gid = flashvars.gid === '' ? 1 : parseInt(flashvars.gid);\r\n            let sSign = '';\r\n\r\n            if (aesKeyType) {\r\n                sSign = 'app_name=' + (flashvars.app_name === '' ? 'shanyi' : flashvars.app_name)\r\n                    + '&device_name=' + (flashvars.device_name === '' ? 'Google Nexus S' : flashvars.device_name)\r\n                    + '&device_system_version=' + (flashvars.deviceOsVer === '' ? '4.1.1' : flashvars.deviceOsVer)\r\n                    + '&gid=' + gid + '&time=' + stime + '&token=' + flashvars.token + '&u=' + flashvars.u\r\n                    + '&v_key=shanyi_WDF#$H*#SJN*&G$&**';\r\n            }\r\n            else {\r\n                sSign = 'gid=' + gid + '&time=' + stime + '&v_key=0GjRAtUUoK4BwJGUz73jBa2M';\r\n            }\r\n\r\n            gid = Utils.aesEncrypt(gid, aesKeyType);\r\n            sSign = Utils.aesEncrypt(MD5.hash(MD5.hash(sSign)), aesKeyType);\r\n            stime = Utils.aesEncrypt(stime, aesKeyType);\r\n\r\n            let url = 'https://my.3000.com/?m=pay_value&op=index&ac=info&api_v=1.0.0&api_from=webpc';\r\n            let data = 'gid=' + encodeURIComponent(gid) + '&sign=' + encodeURIComponent(sSign) + '&time=' + encodeURIComponent(stime);\r\n\r\n            if (flashvars.u !== '' && flashvars.token !== '') {\r\n                url = 'https://app.3000.com/?m=pay_value&op=index&ac=info&client=' + flashvars.client +'&v=' + flashvars.v + '&app_version=' + flashvars.app_version;\r\n                data += this.getPhoneData();\r\n            }\r\n            return getData(url, data);\r\n        },\r\n\r\n        savePayInfo: function () {\r\n            if(flashvars.single && flashvars.offline === '1'){\r\n                const sd = (payvalue) => {\r\n                    //保存消费数据和 系统数值到本地  和apk中\r\n                    return new Promise((resolve,reject)=>{\r\n                    \tif(window.app && window.app.saveGameValue){\r\n                            window.app.saveGameValue(flashvars.uuid + 'payInfo',payvalue);\r\n\t\t\t\t\t\t}\r\n                        Utils.localStorageSetItem(flashvars.uuid + 'payInfo', payvalue);\r\n                        return resolve();\r\n                    })\r\n                };\r\n                const payvaluestr = JSON.stringify(this.context.payValues);\r\n                const payvaluesBase64 = Utils.encodeBase64(payvaluestr);\r\n                return sd(payvaluesBase64);\r\n            }\r\n\r\n            const sendData = (url, d, dataIfFail) => {\r\n            \t/*if(flashvars.offline === \"1\"){//离线玩游戏无需保存数值到线上\r\n                    Utils.localStorageSetItem(flashvars.uuid + 'payInfo' + flashvars.uid, dataIfFail);\r\n                    //this.showToast(1, '用户数据无法保存，请在网络恢复后重新操作');\r\n                    return Promise.resolve();\r\n\t\t\t\t}*/\r\n                return Xhr.xhrSend(url, d, null, 4000).then(rs => {\r\n                \t//有网络\r\n                    if (rs.responseText.length === 0) {\r\n                    \tthis.showToast(1, '用户数据无法保存，请在网络恢复后重新操作');\r\n                        return Promise.reject('Save file failed, no response data');\r\n                    }\r\n                    let retData = JSON.parse(rs.responseText);\r\n                    if (retData.status === 0) {\r\n                        return Promise.resolve();\r\n                    }\r\n                    else {\r\n                        if (retData.status === -1) { // 服务器返回提示未登录，保存本地\r\n                            Utils.localStorageSetItem(flashvars.uuid + 'payInfo' + flashvars.uid, dataIfFail);\r\n                            this.showToast(2, '温馨提醒：登录后才可以同步用户数据哦～');\r\n                        \treturn Promise.resolve();\r\n                        }\r\n                        else if (retData.status === 2) {\r\n                            this.showToast(1, '用户数据保存失败，账号已在其他设备登录');\r\n                            return Promise.reject(retData.msg + ': ' + retData.status);\r\n                        }\r\n                        this.showToast(1, '用户数据无法保存，请在网络恢复后重新操作');\r\n                        return Promise.reject(retData.msg + ': ' + retData.status);\r\n                    }\r\n                }, rj => {\r\n                \t//没有网络\r\n                    Utils.localStorageSetItem(flashvars.uuid + 'payInfo', dataIfFail); //保存一份数值到本地\r\n                    this.showToast(1, '用户数据无法保存，请在网络恢复后重新操作');\r\n                    return Promise.reject(rj);\r\n                });\r\n            };\r\n            let aesKeyType = flashvars.u && flashvars.token ? 1 : 0;\r\n            const str = JSON.stringify(this.context.payValues);\r\n            const strBase64 = Utils.encodeBase64(str);\r\n            //const stime = Math.floor((new Date()).getTime() / 1000) + Utils.timeOffset;\r\n            const stime = Utils.localTime + Utils.timeOffset;\r\n            const gid = flashvars.gid === '' ? 1 : parseInt(flashvars.gid);\r\n            let\tsSign = '';\r\n\r\n            if (aesKeyType) {\r\n                sSign = 'app_name=' + (flashvars.app_name === '' ? 'shanyi' : flashvars.app_name)\r\n                    + '&content=' + strBase64\r\n                    + '&device_name=' + (flashvars.device_name === '' ? 'Google Nexus S' : flashvars.device_name)\r\n                    + '&device_system_version=' + (flashvars.deviceOsVer === '' ? '4.1.1' : flashvars.deviceOsVer)\r\n                    + '&gid=' + gid + '&progress=1&time=' + stime + '&token=' + flashvars.token + '&u=' + flashvars.u\r\n                    + '&v_key=shanyi_WDF#$H*#SJN*&G$&**';\r\n            }\r\n            else {\r\n                sSign = 'content=' + strBase64 + '&gid=' + gid + '&progress=1&time=' + stime + '&v_key=0GjRAtUUoK4BwJGUz73jBa2M';\r\n            }\r\n\r\n            let url = 'https://my.3000.com/?m=pay_value&op=index&ac=save&api_v=1.0.0&api_from=webpc';\r\n            let data = 'content=' + encodeURIComponent(Utils.aesEncrypt(strBase64, aesKeyType))\r\n                + '&gid=' + encodeURIComponent(Utils.aesEncrypt(gid, aesKeyType))\r\n                + '&progress=' + encodeURIComponent(Utils.aesEncrypt(1, aesKeyType))\r\n                + '&sign=' + encodeURIComponent(Utils.aesEncrypt(MD5.hash(MD5.hash(sSign)), aesKeyType))\r\n                + '&time=' + encodeURIComponent(Utils.aesEncrypt(stime, aesKeyType));\r\n\r\n            if (flashvars.u !== '' && flashvars.token !== '') {\r\n                url = 'https://app.3000.com/?m=pay_value&op=index&ac=save&client=' + flashvars.client +'&v=' + flashvars.v + '&app_version=' + flashvars.app_version;\r\n                data += this.getPhoneData();\r\n            }\r\n\r\n            return sendData(url, data, strBase64);\r\n        },\r\n        //获取商品支付信息\r\n        getPayGoodsInfo:function (goodsid) {\r\n            return this.loadCloudRecord(99).then(rs=>{\r\n                //已登入\r\n                const getData = (url,d)=>{\r\n                    return Xhr.xhrSend(url,d,null,4000).then((rs)=>{\r\n                        if(rs.responseText.length === 0){\r\n                            return Promise.resolve({status:\"error\",msg:\"获取商品支付信息失败\",count:0});\r\n                        }\r\n                        let retData = JSON.parse(rs.responseText);\r\n                        if(retData.status === 0){\r\n                            if(retData.success && retData.data){\r\n                                //成功\r\n                                return Promise.resolve({status:\"success\",msg:retData.msg,count:retData.data.count})\r\n                            }else{\r\n                                //失败\r\n                                return Promise.resolve({status:\"fail\",msg:retData.msg,count:0})\r\n                            }\r\n                        }\r\n                        //无status非0状态或无status\r\n                        return Promise.resolve({status:\"fail\",msg:retData.msg,count:0})\r\n                    },(rj)=>{\r\n                        return Promise.resolve({status:\"error\",msg:\"获取商品支付信息失败\",count:0})\r\n                    })\r\n                };\r\n                //post表单数据处理\r\n                const formatdata = (d) =>{\r\n                    let ary = [];\r\n                    let i = 0;\r\n                    for(let dd in d){\r\n                        ary[i] = encodeURIComponent(dd) + \"=\" + encodeURIComponent(d[dd]);\r\n                        i++;\r\n                    }\r\n                    return ary.join(\"&\");\r\n                }\r\n                let url = \"https://pay.3000.com/?m=player&op=h5_purchase_market_count\";\r\n                let data = {\r\n                    event_id:Utils.aesEncrypt(goodsid,3)\r\n                    ,game_id:Utils.aesEncrypt(flashvars.gid,3)\r\n                }\r\n                if (flashvars.client === 'ios' || flashvars.client === 'android') {\r\n                    url = 'https://app.3000.com/?m=consume&op=index&ac=h5_purchase_market_count&client=' + flashvars.client +'&v=' + flashvars.v + '&app_version=' + flashvars.app_version;\r\n                    data = {\r\n                        u:Utils.aesEncrypt(flashvars.u, 1)\r\n\t\t\t\t\t\t,token:Utils.aesEncrypt(flashvars.token, 1)\r\n                        ,event_id:Utils.aesEncrypt(goodsid,1)\r\n                        ,game_id:Utils.aesEncrypt(flashvars.gid,1)\r\n                    }\r\n                }\r\n\r\n                return getData(url,formatdata(data));\r\n            },rj=>{\r\n                //未登入 提示登入;\r\n                let n = rj.indexOf('- status:-1');\r\n                n = n >= 0 ? n : rj.indexOf('- status:2');\r\n                if (n >= 0) {\r\n                    if (flashvars.client !== 'ios' && flashvars.client !== 'android' && flashvars.client !== 'wap') {\r\n                    \t//pc端未登入，直接提示去购买\r\n                        return Promise.resolve({status:\"success\",msg:\"pc端未登入，直接提示去购买！\",count:-1})\r\n                    }\r\n                    if(rj.indexOf('- status:-110') > 0){ //访问频繁\r\n                        Dialog.error(rj.substr(0, n)).then(()=>{\r\n                        \tthis.isPaying = false;\r\n                            return Promise.reject();\r\n\t\t\t\t\t\t},()=>{\r\n                        \tthis.isPaying = false;\r\n                            return Promise.reject();\r\n                        })\r\n                    }else{\r\n                        //调用登入界面\r\n                        if (flashvars.app_version >= '1.2.0') {\r\n                            window.location.href = 'lzj3000://logout';\r\n                        }\r\n                        if(flashvars.client === 'wap'){\r\n                            this.isPaying = false;\r\n                            window.parent && window.parent.playLogin();\r\n                        }else{\r\n                            Dialog.error(rj.substr(0, n)).then(()=>{\r\n                                this.isPaying = false;\r\n                                window.location.href = 'lzj3000://login';\r\n                            },()=>{\r\n                                this.isPaying = false;\r\n                            })\r\n                        }\r\n\t\t\t\t\t}\r\n                    return Promise.reject();\r\n                } else if (0 <= rj.indexOf('error')) {\r\n                    Dialog.error('网络异常，请检查您的网络！').then(()=>{\r\n                    \tthis.isPaying = false;\r\n                        return Promise.reject();\r\n\t\t\t\t\t},()=>{\r\n                    \tthis.isPaying = false;\r\n                        return Promise.reject();\r\n                    });\r\n                }\r\n            })\r\n        },\r\n\r\n\t\tgetDiscounts: function (gameId, chapterUuid, productId, platform) {\r\n\t\t\tconst getData = (url) => {\r\n                return Xhr.xhrLoad(url, '').then(rs => {\r\n                    if (rs.responseText.length === 0) {\r\n                        return Promise.resolve('Get Discounts failed, no response data');\r\n                    }\r\n                    const data = JSON.parse(rs.responseText);\r\n                    return Promise.resolve(data.result);\r\n                }, rj => {\r\n                    return Promise.resolve('获取商品价格失败！');\r\n\t\t\t\t})\r\n\t\t\t};\r\n\t\t\tlet data = 'uuid=' + gameId + (chapterUuid ? '&chapter_uuid=' + chapterUuid : '&product_id=' + productId) + '&platform=' + platform;\r\n            if(this.isWapOther()){\r\n                data += \"&key=external\";\r\n            }\r\n\t\t\tlet url = 'https://mapi.3000api.com/apis/soft/v1.0/game-getCharge.html?' + data;\r\n\r\n\t\t\treturn getData(url);\r\n        },\r\n\r\n        payOperation: function (price, goodsId, indentId, callback,context) {\r\n\t\t\tthis.isPaySuccess = false;\r\n\t\t\tlet disCounts = -1;\r\n\t\t\tconst invokeApp = () => {\r\n                let payArg = {gid: flashvars.gid, eid: goodsId, charge: price\r\n\t\t\t\t\t, special_price: disCounts\r\n                    , balance: context.systemValues[0].value\r\n                    , starsNeed: price * 100\r\n                    , stars: context.systemValues[1].value\r\n                    , starsUsed: this.usedStarCount\r\n                    , starsLimited: this.gameStarLimit\r\n                    , payValues: Utils.encodeBase64(JSON.stringify(context.payValues))\r\n                    , indentId: indentId};\r\n\r\n                if (flashvars.client === 'ios') {\r\n                    this.mallPayCallback = callback;\r\n                    if(flashvars.offline === '1'){\r\n                        javascript:worksmall(JSON.stringify(payArg));\r\n                    }else{\r\n                        window.webkit && window.webkit.messageHandlers.worksmall.postMessage(JSON.stringify(payArg));\r\n                    }\r\n                }\r\n                else if (flashvars.client === 'android') {\r\n                    this.mallPayCallback = callback;\r\n                    window.app && window.app.worksmall(JSON.stringify(payArg));\r\n                }\r\n                else if(flashvars.client === 'wap'){\r\n                    this.mallPayCallback = callback;\r\n                    payArg.consume_falg = 'mall'\r\n\t\t\t\t\tpayArg.uuid = flashvars.uuid;\r\n                    window.parent && window.parent.get_account_info(JSON.stringify(payArg));\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n            if (flashvars.client === 'android' || flashvars.client === 'ios' || flashvars.client === 'wap') {\r\n                if (flashvars.app_version < '1.2.0' && flashvars.client !== 'wap') {\r\n                \tDialog.info('版本过低不支持改功能，请先更新版本~').then(null,null);\r\n                    this.isPaying = false\r\n                    callback(0);\r\n                \treturn Promise.resolve(disCounts);\r\n                }\r\n            \treturn this.getAccountInfo().then(info => {\r\n            \t\tif (typeof info === 'string') {\r\n            \t\t\tDialog.error('网络异常，请检查您的网络！');\r\n            \t\t\tcallback(0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (info.status && info.status>0 && info.status<9) {\r\n            \t\t\tif (flashvars.app_version >= '1.2.0') {\r\n                            window.location.href = 'lzj3000://logout';\r\n\t\t\t\t\t\t}\r\n                        if(flashvars.client === 'wap'){\r\n                            window.parent && window.parent.playLogin();\r\n                        }else{\r\n                            Dialog.info(info.msg).then(() => {\r\n                                window.location.href = 'lzj3000://login';\r\n                            });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcallback(0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (100 === info.status && !info.success) {\r\n                        callback(0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n                        return this.getDiscounts(flashvars.uuid, null, goodsId, 'app').then(info => {\r\n                            if (typeof info === 'string') {\r\n                                Dialog.error(info);\r\n                                callback(0);\r\n                            }\r\n                            else {\r\n                            \tprice = info.charge;\r\n                            \tdisCounts = info.special_price;\r\n                                invokeApp();\r\n                            }\r\n                            return Promise.resolve(disCounts);\r\n                        });\r\n\t\t\t\t\t}\r\n                    return Promise.resolve(disCounts);\r\n\t\t\t\t})\r\n            }\r\n            else {\r\n                Dialog.info('请前往APP或电脑端购买~').then(null,null);\r\n                this.isPaying = false\r\n                callback(0);\r\n                return Promise.resolve(disCounts);\r\n            }\r\n        },\r\n\r\n\t\tchapterInfoProgress: function (prgsInfo) {\r\n            let group = this.viewComponent.game.world.getByName('chapterInfoProgress');\r\n            if (!group) {\r\n                group = this.viewComponent.game.add.group();\r\n                group.name = 'chapterInfoProgress';\r\n\r\n                let background = this.viewComponent.game.add.graphics(0, 0, group);\r\n                background.beginFill(0x0, 0.5);\r\n                background.drawRect(0, 0, this.viewComponent.game.world.width, this.viewComponent.game.world.height);\r\n                background.endFill();\r\n                background.name = 'background';\r\n                background.inputEnabled = true;\r\n\r\n                let style = { font: \"16px 宋体\", fill: \"#fff\", boundsAlignH: \"center\", boundsAlignV: \"middle\" };\r\n\t\t\t\tlet text = this.viewComponent.game.add.text(0, 0, \"\", style, group);\r\n\t\t\t\ttext.setTextBounds(0, 0, this.viewComponent.game.world.width, this.viewComponent.game.world.height);\r\n\t\t\t\ttext.name = 'chapterInfoProgressText';\r\n            }\r\n            let txt = group.getByName('chapterInfoProgressText');\r\n            if (txt) {\r\n            \ttxt.text = '章节信息获取中...' + prgsInfo;\r\n\t\t\t}\r\n        },\r\n\r\n\t\tcheckIfChapterFree: function (chapterUuid, chapterMd5, showProgress = true) {\r\n            if(flashvars.offline === '1' && flashvars.single){\r\n                const url = Utils.convertSingleJsonPath(chapterUuid);\r\n                const progress = evt => {\r\n                    showProgress && this.chapterInfoProgress(evt.loaded);\r\n                }\r\n                return Xhr.getJson(url,progress).then((rs)=>{\r\n                    let group = this.viewComponent.game.world.getByName('chapterInfoProgress');\r\n                    if (group) {\r\n                        group.destroy();\r\n                    }\r\n                    if (rs.code === '100') {\r\n                        return Promise.resolve(rs.result.plots);\r\n                    }\r\n                    else if (flashvars.offline === '1') {\r\n                        return Promise.resolve(rs.plots);\r\n                    }\r\n                    else {\r\n                        return Promise.reject(rs.message + ' code=' + rs.code);\r\n                    }\r\n\t\t\t\t})\r\n            }else{\r\n                const getData = (url, d) => {\r\n                    const progress = evt => {\r\n                        showProgress && this.chapterInfoProgress(evt.loaded);\r\n                    }\r\n                    return Xhr.xhrSend(url, d, progress).then(rs => {\r\n                        let group = this.viewComponent.game.world.getByName('chapterInfoProgress');\r\n                        if (group) {\r\n                            group.destroy();\r\n                        }\r\n                        if (rs.responseText.length === 0) {\r\n                            return Promise.reject('Get chapterInfo failed, no response data');\r\n                        }\r\n                        let retData = JSON.parse(rs.responseText);\r\n                        if (retData.code === '100') {\r\n                            return Promise.resolve(retData.result.plots);\r\n                        }\r\n                        else if (flashvars.offline == 1) {\r\n                            return Promise.resolve(retData.plots);\r\n                        }\r\n                        else {\r\n                            return Promise.reject(retData.message + ' code=' + retData.code);\r\n                        }\r\n                    }, rj => {\r\n                        let group = this.viewComponent.game.world.getByName('chapterInfoProgress');\r\n                        if (group) {\r\n                            group.destroy();\r\n                        }\r\n                        return Promise.reject(rj);\r\n                    });\r\n                };\r\n                const get =()=>{\r\n                    if (!flashvars.u && !flashvars.token && flashvars.client !== 'wap') {\r\n                        flashvars.uid = Utils.getUidByCookie();\r\n                    }\r\n                    let data = 'uuid=' + flashvars.uuid + '&uid=' + flashvars.uid + '&chapter_uuid=' + chapterUuid + '&md5=' + chapterMd5 + '&platform=' + (flashvars.client ? 'app' : 'pc');\r\n                    if(this.isWapOther()){\r\n                        data += \"&key=external\";\r\n                    };\r\n                    let url = 'https://mapi.3000api.com/apis/soft/v1.0/chapter-chapterInfo.html?' + data;\r\n                    return getData(url, data);\r\n                }\r\n\r\n                if(flashvars.client === 'wap'){\r\n                    if(flashvars.uid === ''){ //uid不存在\r\n                        return this.getUserInfoFromWap().then(()=>{\r\n                            return get();\r\n                        })\r\n                    }else{\r\n                        return get();\r\n                    }\r\n                }else{\r\n                    return get();\r\n                }\r\n\t\t\t}\r\n        },\r\n\t\t/**第三方解锁章节*/\r\n\t\tunlockChapterByWapOther:function (uuid, charge, md5, callBack) {\r\n            if(this.isWapOther()){\r\n            \tlet getcount = 0;//请求次数\r\n                //支付\r\n                const pay = (game_uuid,chapter_uuid,charge,payback)=>{\r\n                    let discounts = -1;\r\n                    this.getDiscounts(game_uuid, chapter_uuid, null, 'app').then(info =>{\r\n                        if (typeof info !== 'string') {\r\n                            charge = info.charge;\r\n                            discounts = info.special_price;\r\n                        }\r\n                        const generateuuid = Utils.generateUUID();//生成一个订单搬好\r\n                        Utils.timeout(100).then(()=>{\r\n                            Dialog.custom(\"Info\",\"当前为收费章节，需支付\"+ charge +\"元解锁观看\",\"章节收费提示\",\"支付\",\"取消\",false).then((msg)=>{\r\n                                OtherWap.pay(charge,chapter_uuid,generateuuid,chapter_uuid,null,0,(msg)=>{\r\n                                    if(payback) payback(msg);\r\n                                });\r\n                            },(msg1)=>{\r\n                                if(payback) payback(\"cancel\")\r\n                            })\r\n                        })\r\n                    })\r\n                };\r\n                //购买返回\r\n                const payback = (msg)=>{\r\n\t\t\t\t\tif(msg === \"success\"){\r\n\t\t\t\t\t\t//成功\r\n                        getchapterinfo(uuid,md5,charge)\r\n\t\t\t\t\t}else if(msg === \"cancel\"){\r\n                        if(callBack)callBack(null);\r\n\t\t\t\t\t}else if(msg === \"fail\"){\r\n\t\t\t\t\t\t//失败\r\n\t\t\t\t\t\tDialog.custom(\"Info\",\"未查询到你的付费信息哦，请确认已支付再点击刷新。如未购买请退出或重新购买~\",\"提示\",\"重试\",\"退出\",false,3,0).then(()=>{\r\n                                getchapterinfo(uuid,md5,charge);\r\n                            },()=>{\r\n                                if(callBack)callBack(null);\r\n                            })\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n            \t//获取章节数据\r\n\t\t\t\tconst getchapterinfo = (chapter_uuid, chapter_md5,chaptercharge)=>{\r\n                    getcount ++;\r\n\t\t\t\t\tthis.checkIfChapterFree(chapter_uuid,chapter_md5).then((info)=>{\r\n\t\t\t\t\t\t//成功有数据\r\n                        if(callBack)callBack(info);\r\n\t\t\t\t\t},(msg)=>{\r\n                        //章节需要付费\r\n                        if (-1 === msg.indexOf('code=87')) {\r\n                            Dialog.error(msg).then(()=>{ if(callBack)callBack(null)},()=>{ if(callBack)callBack(null)});\r\n                        } else { // 未购买此章节\r\n\t\t\t\t\t\t\tif(getcount <=1){\r\n                                pay(flashvars.uuid,chapter_uuid,chaptercharge,payback)\r\n\t\t\t\t\t\t\t}else{\r\n                                if(getcount <4){\r\n                                \tpayback(\"fail\")\r\n                                }else{\r\n                                    if(callBack)callBack(\"fail\");\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n                        }\r\n                    })\r\n\t\t\t\t}\r\n                getchapterinfo(uuid,md5,charge,callBack);\r\n\r\n                /*let discounts = -1;\r\n                this.getDiscounts(flashvars.uuid, uuid, null, 'app').then(info => {\r\n                    if (typeof info !== 'string') {\r\n                        charge = info.charge;\r\n                        discounts = info.special_price;\r\n                    }\r\n                    const generateuuid = Utils.generateUUID();//生成一个订单搬好\r\n                    Utils.timeout(100).then(()=>{\r\n                        Dialog.custom(\"Info\",\"当前为收费章节，需支付\"+ charge +\"元解锁观看\",\"章节收费提示\",\"支付\",\"取消\",false).then((msg)=>{\r\n                            OtherWap.pay(charge,uuid,generateuuid,uuid,null,0,()=>{\r\n                                if(callBack) callBack();\r\n                            });\r\n                        },(msg1)=>{\r\n                            if(callBack) callBack()\r\n                        })\r\n                    })\r\n                })*/\r\n            }\r\n        },\r\n\t\t/**解锁章节*/\r\n        unlockChapter: function (uuid, charge, md5, callBack, showDialog = true) {\r\n            if (flashvars.app_version < '1.2.0' && flashvars.client !== 'wap') {\r\n                showDialog && Dialog.info('该章节为付费章节，当前版本过低，不支持该功能');\r\n                callBack(false, true);\r\n                return;\r\n            }\r\n            let discounts = -1;\r\n            this.getDiscounts(flashvars.uuid, uuid, null, 'app').then(info => {\r\n            \tif (typeof info !== 'string') {\r\n            \t\tcharge = info.charge;\r\n                    discounts = info.special_price;\r\n\t\t\t\t}\r\n                if (flashvars.client === 'ios') {\r\n                    let unlockArg = {gid: flashvars.gid, uuid: uuid, charge: charge, md5: md5, special_price: discounts};\r\n                    this.unlockChapterCallBack = callBack;\r\n                    if(flashvars.offline == 1){\r\n                        javascript:unlock(JSON.stringify(unlockArg));\r\n                    }else{\r\n                        window.webkit && window.webkit.messageHandlers.unlock.postMessage(JSON.stringify(unlockArg));\r\n                    }\r\n                }\r\n                else if (flashvars.client === 'android') {\r\n                    window.app && window.app.unlock(flashvars.gid, uuid, charge, md5); // 解锁\r\n                    this.unlockChapterCallBack = callBack;\r\n                }else if(flashvars.client === 'wap'){\r\n                    this.unlockChapterCallBack = callBack;\r\n                    const pay=()=>{\r\n                        let wapunlockArg = {uuid:flashvars.uuid,\r\n                            gid: flashvars.gid,\r\n                            chapter_uuid: uuid,\r\n                            charge: charge,\r\n                            md5: md5,\r\n                            special_price: discounts,\r\n                            author_id:flashvars.uid,\r\n                            consume_falg:'chapter'};\r\n                        window.parent && window.parent.get_account_info(JSON.stringify(wapunlockArg));\r\n\t\t\t\t\t}\r\n            \t\tif(flashvars.uid === ''){ //uid不存在 从cookie获取uid\r\n\t\t\t\t\t\tthis.getUserInfoFromWap().then(()=>{\r\n\t\t\t\t\t\t\tif(flashvars.uid === ''){\r\n\t\t\t\t\t\t\t\t//未登入，弹窗提示 该章节为付费章节，需登入后查看~\r\n\t\t\t\t\t\t\t\tDialog.info('该章节为付费章节，需登录后查看~').then(()=>{\r\n                                    callBack(false, true,true);\r\n                                    window.parent && window.parent.playLogin();\r\n\t\t\t\t\t\t\t\t},()=>{\r\n                                    callBack(false, true,true);\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}else{\r\n                                pay();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}else{\r\n            \t\t\tpay();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n            });\r\n        },\r\n\r\n\t\tgetPhoneData: function () {\r\n            let u = encodeURIComponent(Utils.aesEncrypt(flashvars.u, 1));\r\n            let token = encodeURIComponent(Utils.aesEncrypt(flashvars.token, 1));\r\n            let app_name = encodeURIComponent(Utils.aesEncrypt(flashvars.app_name === '' ? 'shanyi' : flashvars.app_name, 1));\r\n            let device_name = encodeURIComponent(Utils.aesEncrypt(flashvars.device_name === '' ? 'Google Nexus S' : flashvars.device_name, 1));\r\n            let deviceOsVer = encodeURIComponent(Utils.aesEncrypt(flashvars.deviceOsVer === '' ? '4.1.1' : flashvars.deviceOsVer, 1));\r\n\r\n            return '&u=' + u + '&token=' + token + '&app_name=' + app_name\r\n                + '&device_name=' + device_name + '&device_system_version=' + deviceOsVer;\r\n        },\r\n\r\n\t\tloadCloudRecord: function (index) {\r\n\t\t\tconst getData = (url, d) => {\r\n\t\t\t\treturn Xhr.xhrSend(url, d).then(rs => {\r\n\t\t\t\t\tif (rs.responseText.length === 0) {\r\n\t\t\t\t\t\treturn Promise.reject('Get file failed, no response data');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet retData = JSON.parse(rs.responseText);\r\n\t\t\t\t\tif (retData.status === 0) {\r\n                        let encrypted = retData.data.content || '';\r\n                        let decrypted = Utils.decryptBase64(encrypted);\r\n                        return Promise.resolve(decrypted);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\treturn Promise.reject(retData.msg + ' - status:' + retData.status);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, rj => {\r\n\t\t\t\t\treturn Promise.reject(rj);\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n            let aesKeyType = flashvars.u && flashvars.token ? 1 : 0;\r\n\t\t\t//let stime = Math.floor((new Date()).getTime() / 1000) + Utils.timeOffset;\r\n\t\t\tlet stime = Utils.localTime + Utils.timeOffset;\r\n\t\t\tlet gid = flashvars.gid === '' ? 1 : parseInt(flashvars.gid);\r\n            let sSign = '';\r\n            let type = index + '';\r\n\r\n            if (aesKeyType) {\r\n                sSign = 'app_name=' + (flashvars.app_name === '' ? 'shanyi' : flashvars.app_name)\r\n\t\t\t\t\t\t+ '&device_name=' + (flashvars.device_name === '' ? 'Google Nexus S' : flashvars.device_name)\r\n\t\t\t\t\t\t+ '&device_system_version=' + (flashvars.deviceOsVer === '' ? '4.1.1' : flashvars.deviceOsVer)\r\n\t\t\t\t\t\t+ '&gid=' + gid + '&time=' + stime + '&token=' + flashvars.token + '&type=' + type + '&u=' + flashvars.u\r\n\t\t\t\t\t\t+ '&v_key=shanyi_WDF#$H*#SJN*&G$&**';\r\n            }\r\n            else {\r\n                sSign = 'gid=' + gid + '&time=' + stime + '&type=' + type + '&v_key=0GjRAtUUoK4BwJGUz73jBa2M';\r\n            }\r\n\r\n\t\t\tgid = Utils.aesEncrypt(gid, aesKeyType);\r\n\t\t\tsSign = Utils.aesEncrypt(MD5.hash(MD5.hash(sSign)), aesKeyType);\r\n\t\t\tstime = Utils.aesEncrypt(stime, aesKeyType);\r\n\t\t\ttype = Utils.aesEncrypt(type, aesKeyType);\r\n\r\n            let url = 'https://my.3000.com/?m=cloud_save&op=index&ac=info&client_type=1&api_v=1.0.0&api_from=webpc';\r\n            let data = 'gid=' + encodeURIComponent(gid) + '&sign=' + encodeURIComponent(sSign) + '&time=' + encodeURIComponent(stime) + '&type=' + encodeURIComponent(type);\r\n\r\n\t\t\tif (flashvars.u !== '' && flashvars.token !== '') {\r\n                url = 'https://app.3000.com/?m=cloud_save&op=index&ac=info&client=' + flashvars.client +'&v=' + flashvars.v + '&app_version=' + flashvars.app_version;\r\n                data += this.getPhoneData();\r\n\t\t\t}\r\n\r\n\t\t\treturn getData(url, data);\r\n        },\r\n\r\n\t\tsaveCloudRecord: function (index) {\r\n            const sendData = (url, d) => {\r\n                return Xhr.xhrSend(url, d).then(rs => {\r\n                    if (rs.responseText.length === 0) {\r\n                        return Promise.reject('Save file failed, no response data');\r\n                    }\r\n                    let retData = JSON.parse(rs.responseText);\r\n                    if (retData.status === 0) {\r\n                        return Promise.resolve();\r\n                    }\r\n                    else {\r\n                        return Promise.reject(retData.msg + ': ' + retData.status);\r\n                    }\r\n                }, rj => {\r\n                    return Promise.reject(rj);\r\n                });\r\n            };\r\n\r\n            let aesKeyType = flashvars.u && flashvars.token ? 1 : 0;\r\n            const str = JSON.stringify(this.savedPlotsData[index]);\r\n            const strBase64 = Utils.encodeBase64(str);\r\n            //const stime = Math.floor((new Date()).getTime() / 1000) + Utils.timeOffset;\r\n            const stime = Utils.localTime + Utils.timeOffset;\r\n            const gid = flashvars.gid === '' ? 1 : parseInt(flashvars.gid);\r\n            let\tsSign = '';\r\n\r\n            if (aesKeyType) {\r\n                sSign = 'app_name=' + (flashvars.app_name === '' ? 'shanyi' : flashvars.app_name)\r\n\t\t\t\t\t+ '&content=' + strBase64\r\n                    + '&device_name=' + (flashvars.device_name === '' ? 'Google Nexus S' : flashvars.device_name)\r\n                    + '&device_system_version=' + (flashvars.deviceOsVer === '' ? '4.1.1' : flashvars.deviceOsVer)\r\n\t\t\t\t\t+ '&gid=' + gid + '&progress=1&time=' + stime + '&token=' + flashvars.token + '&type=' + index + '&u=' + flashvars.u\r\n\t\t\t\t\t+ '&v_key=shanyi_WDF#$H*#SJN*&G$&**';\r\n            }\r\n            else {\r\n                sSign = 'content=' + strBase64 + '&gid=' + gid + '&progress=1&time=' + stime + '&type=' + index + '&v_key=0GjRAtUUoK4BwJGUz73jBa2M';\r\n            }\r\n\r\n            let url = 'https://my.3000.com/?m=cloud_save&op=index&ac=save&client_type=1&api_v=1.0.0&api_from=webpc';\r\n            let data = 'content=' + encodeURIComponent(Utils.aesEncrypt(strBase64, aesKeyType))\r\n                + '&gid=' + encodeURIComponent(Utils.aesEncrypt(gid, aesKeyType))\r\n                + '&progress=' + encodeURIComponent(Utils.aesEncrypt(1, aesKeyType))\r\n                + '&sign=' + encodeURIComponent(Utils.aesEncrypt(MD5.hash(MD5.hash(sSign)), aesKeyType))\r\n                + '&time=' + encodeURIComponent(Utils.aesEncrypt(stime, aesKeyType))\r\n                + '&type=' + encodeURIComponent(Utils.aesEncrypt(index+'', aesKeyType));\r\n\r\n            if (flashvars.u !== '' && flashvars.token !== '') {\r\n                url = 'https://app.3000.com/?m=cloud_save&op=index&ac=save&client=' + flashvars.client +'&v=' + flashvars.v + '&app_version=' + flashvars.app_version;\r\n                data += this.getPhoneData();\r\n            }\r\n\r\n            return sendData(url, data);\r\n        },\r\n\r\n        getViewData: function(items, subView) {\r\n            let view = {};\r\n            const visitChild = (children, parent) => {\r\n                for (let i=0; i<children.length; i++) {\r\n                    if (!children[i].xInfo || !children[i].yInfo) {\r\n                        continue;\r\n                    }\r\n                    let child = {name:children[i].name, instanceUuid:children[i].instanceUuid, xInfo:children[i].xInfo, yInfo:children[i].yInfo\r\n\t\t\t\t\t\t, eventsInfo: children[i].eventsInfo, scale:children[i].scale, visible:children[i].visible};\r\n                    child.children = [];\r\n                    if (children[i].viewType === 'TIMER') {\r\n                        view.currentCount = children[i].currentCount;\r\n                    }\r\n                    visitChild(children[i].children, child);\r\n                    parent.children.push(child);\r\n                }\r\n            };\r\n            for (let i=0; items && i<items.length; i++) {\r\n                if (!items[i].parent) {\r\n                    continue;\r\n                }\r\n                view = {name:items[i].name, instanceUuid:items[i].instanceUuid, xInfo:items[i].xInfo, yInfo:items[i].yInfo, eventsInfo:items[i].eventsInfo\r\n\t\t\t\t\t, scale:items[i].scale, parent:items[i].parent.name, x: items[i].x, y: items[i].y, visible:items[i].visible};\r\n                view.children = [];\r\n                if (items[i].viewType === 'TIMER') {\r\n                \tview.currentCount = items[i].currentCount;\r\n\t\t\t\t}\r\n\t\t\t\tif (items[i].generateType) {\r\n                \tview.generateType = items[i].generateType;\r\n\t\t\t\t}\r\n                visitChild(items[i].children, view);\r\n                subView.push(view);\r\n            }\r\n        },\r\n\r\n        getViewParentEvents: function(ref) {\r\n            const viewMap = this.json_data.viewMap;\r\n            for (let i in viewMap) {\r\n                if (i === ref) {\r\n                    return viewMap[i].events.concat();\r\n                }\r\n                else {\r\n                    for (let j in viewMap.children) {\r\n                        if (viewMap.children[j].ref === ref) {\r\n                            return viewMap.children[j].events.concat();\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        copyFlashViewData: function(src, commandObj) {\r\n            let bVisible = true;\r\n            if (commandObj && commandObj.historyCommand && commandObj.historyCommand.hideGlobalViews) {\r\n                for (let v=0; v<commandObj.historyCommand.hideGlobalViews.length; v++) {\r\n                    if (src.instanceUuid === commandObj.historyCommand.hideGlobalViews[v]) {\r\n                        bVisible = false;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            let dest = {name: src.ref\r\n                , instanceUuid: src.instanceUuid\r\n                , xInfo: Object.prototype.toString.apply(src.x) === '[object Object]' ? src.x : {type: 'literal', value: src.x}\r\n                , yInfo: Object.prototype.toString.apply(src.y) === '[object Object]' ? src.y : {type: 'literal', value: src.y}\r\n                , scale: {x: src.scale, y: src.scale, type: 25}\r\n                , visible: bVisible};\r\n            src.currentCount && (dest.currentCount = src.currentCount);\r\n            dest.children = [];\r\n            for (let n=0; n<src.children.length; n++) {\r\n                dest.children[n] = this.copyFlashViewData(src.children[n], commandObj);\r\n                dest.children[n].eventsInfo = this.getViewParentEvents(src.ref);\r\n            }\r\n            return dest;\r\n        },\r\n\r\n\t\tgetWeatherType: function() {\r\n        \t//windy snowy rainy defoliation fallingPeach fallingFlower lightning\r\n            if (!this.weatherLayer.visible) {\r\n                return '';\r\n            }\r\n            let w = this.weatherLayer.getByName('wind');\r\n            if (w && w.visible) {\r\n                return 'windy';\r\n            }\r\n            w = this.weatherLayer.getByName('snow');\r\n            if (w && w.visible) {\r\n                return 'snowy';\r\n            }\r\n            w = this.weatherLayer.getByName('rain');\r\n            if (w && w.visible) {\r\n                return 'rainy';\r\n            }\r\n            //桃花\r\n            w = this.weatherLayer.getByName('beachBlossom');\r\n            if (w && w.visible) {\r\n                return 'fallingPeach';\r\n            }\r\n            //樱花\r\n            w = this.weatherLayer.getByName('blossom');\r\n            if (w && w.visible) {\r\n                return 'fallingFlower';\r\n            }\r\n            //闪电\r\n            w = this.weatherLayer.getByName('lightning');\r\n            if (w && w.visible) {\r\n                return 'lightning';\r\n            }\r\n            //枫叶\r\n            w = this.weatherLayer.getByName('fallingLeaves');\r\n            if (w && w.visible) {\r\n                return 'defoliation';\r\n            }\r\n            return '';\r\n        },\r\n\r\n\t\t/**获取屏幕效果*/\r\n\t\tgetScreenAnime:function () {\r\n\t\t\tif(this.shakeLoopObj.loop === true){\r\n\t\t\t\t//正处于循环振动中\r\n\t\t\t\treturn JSON.parse(JSON.stringify(this.shakeLoopObj));\r\n\t\t\t}\r\n\t\t\treturn {level:0,duration:0,delay:0,loop:false,commands:null}\r\n        },\r\n\r\n        /**\r\n\t\t * 获取当前的气泡数据\r\n         */\r\n\t\tgetBubbleData:function (isclear) {\r\n\t\t\tlet ary = [];\r\n            if(this.saveBubbleVector.length > 0){\r\n                for(let i = 0; i < this.saveBubbleVector.length;i++){\r\n                    let border = this.saveBubbleVector[i];\r\n                    if(isclear){\r\n\t\t\t\t\t\tthis.clearBubbleData(i);\r\n                    }\r\n                    let bubble = [];\r\n                    for(let j = 0;j < border.savebubble.length;j++){\r\n                        //bubble\r\n                        bubble.push(border.savebubble[j]);\r\n                    }\r\n                    let curbubble = [];\r\n                    for(let k = 0;k < border.curbubble.length;k++){\r\n                        //curbubble\r\n                        curbubble.push(border.curbubble[k]);\r\n                    }\r\n                    ary.push({bubbleMode:border.commands,bubble:bubble,curbubble:curbubble,ishide:border.ishide,iscurrent:border.iscurrent})\r\n                }\r\n            }\r\n            return ary;\r\n        },\r\n        /**\r\n\t\t * 计算气泡数量上线\r\n         */\r\n\t\tbubbleUpper:function () {\r\n\t\t\twhile (this.bubbleArchivalCount.length > 1000){\r\n                let buuid = this.bubbleArchivalCount.shift();\r\n                const cleardata = (ary,uuid) =>{\r\n                    for(let i = 0;i < ary.length;i++){\r\n                    \tif(ary[i].uuid === uuid){\r\n                            ary.splice(i,1);\r\n                    \t\tbreak;\r\n\t\t\t\t\t\t}\r\n                    }\r\n\t\t\t\t}\r\n                this.saveBubbleVector.forEach((b,index) =>{\r\n                \tcleardata(b.savebubble,buuid);\r\n                \tcleardata(b.curbubble,buuid);\r\n\t\t\t\t})\r\n\t\t\t}\r\n        },\r\n\r\n        /**\r\n\t\t * 清除气泡数据\r\n         */\r\n\t\tclearBubbleData:function (id) {\r\n\t\t\t//删除计数数据\r\n\t\t\tconst clearcount = (uuid) =>{\r\n\t\t\t\tconst getcountindex = (uuid)=>{\r\n\t\t\t\t\tfor(let i = 0;i<this.bubbleArchivalCount.length;i++){\r\n                        if(this.bubbleArchivalCount[i] === uuid) return i;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t}\r\n\t\t\t\tlet gindex = getcountindex(uuid);\r\n\t\t\t\tgindex !== -1 && this.bubbleArchivalCount.splice(gindex,1);\r\n\t\t\t}\r\n            if(id !== -1){\r\n                //找到对应编号 气泡模式\r\n                if(this.saveBubbleVector[id].remove === 2){\r\n                    //无需保留，清除所有数据\r\n                    const removeborder = this.saveBubbleVector[id];\r\n                    for(let i = 0;i < removeborder.savebubble.length;i++){\r\n                        clearcount(removeborder.savebubble[i].uuid);\r\n\t\t\t\t\t}\r\n                    this.bubbleLayer.removeChild(removeborder);\r\n                    this.saveBubbleVector.splice(id,1);\r\n                    removeborder.destroy();\r\n                }else if(this.saveBubbleVector[id].remove === 1){\r\n                \t//清除当前气泡模式下后面的数据\r\n                    const getindex = (bc)=>{\r\n                        for(let i =0;i < this.saveBubbleVector[id].savebubble.length;i++){\r\n                            if(this.saveBubbleVector[id].savebubble[i].uuid === bc.uuid){\r\n                            \treturn i;\r\n\t\t\t\t\t\t\t}\r\n                        }\r\n                        return -1;\r\n                    }\r\n                    this.saveBubbleVector[id].curbubble.forEach((bc,ii) =>{\r\n\t\t\t\t\t\tlet index = getindex(bc);\r\n\t\t\t\t\t\tclearcount(bc.uuid);\r\n                        index !== -1 && this.saveBubbleVector[id].savebubble.splice(index,1);\r\n\t\t\t\t\t})\r\n                    this.saveBubbleVector[id].curbubble = [];\r\n                }\r\n            }\r\n        },\r\n\r\n\t\tsaveRecord: function (index, auto) {\r\n\t\t\t// 保存进度\r\n\t\t\tif (index === 0 && this.json_data.default_settings.autoSaveOrLoad && !auto) {\r\n\t\t\t\treturn Promise.resolve(null);\r\n\t\t\t}\r\n            const save = ()=>{\r\n                !this.savedPlotsData && this.loadData();\r\n                const timestamp = Date.now();\r\n\r\n                let globalViews = [];\r\n                let plotViews = [];\r\n                let chAndProps = [];\r\n                this.getViewData(this.globalViews, globalViews);\r\n                this.getViewData(this.plotViews, plotViews);\r\n                this.bubbleUpper();//存档时候气泡数量上限计算\r\n\r\n                const saveData = {};\r\n                saveData.plotUuid = this.curChapter.plots[this.curPlotIndex].uuid;\r\n                saveData.chapterUuid = this.curChapter.uuid;\r\n                saveData.bkKey = this.lstPlotBkKey;\r\n                saveData.bkOpacity = this.lstPlotBkOpacity;\r\n                saveData.bkFlex = this.lstPlotBkFlex;\r\n                saveData.cmdUuid = this.curCmdUuid;\r\n                saveData.bCmdAutoText = this.bCmdAutoText;\r\n                saveData.timestamp = timestamp;\r\n                saveData.context = JSON.parse(JSON.stringify(this.context));\r\n                saveData.plotSnap = this.plotSnap;\r\n                saveData.weatherType = this.getWeatherType();\r\n                saveData.globalViews = globalViews.concat();\r\n                saveData.plotViews = plotViews.concat();\r\n                saveData.playbackData = this.playbackData.concat();\r\n                saveData.animateScene = {shake:null}\r\n                saveData.animateScene.shake = this.getScreenAnime().commands;//存档转场动画振动\r\n                saveData.bubble = [];\r\n                saveData.bubble = this.getBubbleData().concat();\r\n                saveData.bubbleCount = [];\r\n                saveData.bubbleCount = this.bubbleArchivalCount && this.bubbleArchivalCount.concat();\r\n                if ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n                    saveData.music = {url: PhoneUtils.musicInfo.key, volume: PhoneUtils.musicInfo.prevolume || PhoneUtils.musicInfo.volume,inheritvolume:PhoneUtils.musicInfo.inheritvolume};\r\n                    saveData.sounds = PhoneUtils.soundsInfo.map(s => {\r\n                        if (s.key) {\r\n                            return {url: s.key, volume: s.prevolume || s.volume, time: s.loop ? 0 : 1,inheritvolume:s.inheritvolume}\r\n                        }\r\n                        return null;\r\n                    })\r\n                } else {\r\n                    saveData.music = {url: this.bk_music && this.bk_music.key, volume: this.bk_music && (this.bk_music.prevolume || this.bk_music.volume),inheritvolume: this.bk_music && this.bk_music.inheritvolume};\r\n                    saveData.sounds = this.plotSounds.map(s => {\r\n                        if (s) {\r\n                            return {\r\n                                url: s.key,\r\n                                volume: s.prevolume || s.volume,\r\n                                time: s.loop ? 0 : 1,\r\n\t\t\t\t\t\t\t\tinheritvolume:s.inheritvolume\r\n                            }\r\n                        }\r\n                        return null;\r\n                    });\r\n                }\r\n\r\n                if (this.curCmdUuid !== '') {\r\n                    this.charsAndPropsLayer && this.charsAndPropsLayer.children.forEach(g => {\r\n                        let c = g.children[0];\r\n                        let item = {url:c.key, x:c.x, y:c.y, width:c.width, height:c.height, opacity: c.alpha, pivotX: c.pivot.x, pivotY: c.pivot.y\r\n                            , scaleX:c.scale.x, scaleY:c.scale.y, rotate:c.angle, cmdUuid:c.cmdUuid, index:g.zIndex, parentScale: g.scale.x,mirrorH:(c.mirrorH ? c.mirrorH : false),mirrorV:(c.mirrorV ? c.mirrorV : false)};\r\n\r\n                        if (c.finalState) {\r\n                            item.x = c.finalState.x;\r\n                            item.y = c.finalState.y;\r\n                            item.opacity = c.finalState.alpha;\r\n                            item.rotate = c.finalState.angle\r\n                        }\r\n                        if (g.finalState) {\r\n                            item.parentScale = g.finalState.scale.x;\r\n                        }\r\n                        chAndProps.push(item);\r\n                    });\r\n\r\n                    let bk = this.curPlotLayer.children[1];\r\n                    saveData.bk = {};\r\n                    if (bk) {\r\n                        saveData.bk = {url: bk.key, opacity: bk.alpha};\r\n                        bk.finalState && (saveData.bk.opacity = bk.finalState.alpha);\r\n                    }\r\n                }\r\n\r\n                saveData.charsAndProps = chAndProps.concat();\r\n                saveData.dialogInfo = this.lstDialogInfo.concat();\r\n                saveData.menuInfo = this.menuInfo.concat();\r\n                this.savedPlotsData[index] = JSON.parse(JSON.stringify(saveData));\r\n                this.bSignedIn && this.bCloudSel && (this.cloudPlotsData[index] = JSON.parse(JSON.stringify(saveData)));\r\n                return this.saveData(index, auto).then(rs => {return Promise.resolve(saveData)}, rj => {return Promise.resolve(null)});\r\n            };\r\n\r\n\t\t\tif(auto === true && this.bSignedIn !== true){\r\n\t\t\t\t//自动存档时，已登入\r\n                this.isSignedIn().then(() => {\r\n                \t//登入\r\n                    this.bCloudSel = true;\r\n\t\t\t\t\treturn save();\r\n                },()=>{\r\n                \t//未登入\r\n                    return save();\r\n\t\t\t\t})\r\n\t\t\t}else{\r\n                return save();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tloadRecord: function (index) {\r\n\t\t\t!this.savedPlotsData && this.loadData();\r\n            const {plotUuid, chapterUuid, context, playbackData} = this.savedPlotsData[index];\r\n            const goRecord = (nChapter, nPlot) => {\r\n                this.destroyAll();\r\n                this.saveBubbleDataVector = [];\r\n                this.lstPlotBkKey = this.savedPlotsData[index].bkKey;\r\n                this.lstPlotBkOpacity = this.savedPlotsData[index].bkOpacity;\r\n                this.lstPlotBkFlex = this.savedPlotsData[index].bkFlex;\r\n                this.globalViews = this.savedPlotsData[index].globalViews.concat();\r\n                this.plotViews = this.savedPlotsData[index].plotViews.concat();\r\n                this.charsAndPropsInfo = this.savedPlotsData[index].charsAndProps.concat();\r\n                this.lstDialogInfo = this.savedPlotsData[index].dialogInfo ? this.savedPlotsData[index].dialogInfo.concat() : [];\r\n                this.menuInfo = this.savedPlotsData[index].menuInfo ? this.savedPlotsData[index].menuInfo.concat() : [];\r\n                this.curCmdUuid = this.savedPlotsData[index].cmdUuid;\r\n                this.bCmdAutoText = this.savedPlotsData[index].bCmdAutoText;\r\n                this.saveBubbleDataVector = this.savedPlotsData[index].bubble ? this.savedPlotsData[index].bubble.concat() : [];\r\n                this.bubbleArchivalCount = this.savedPlotsData[index].bubbleCount ? this.savedPlotsData[index].bubbleCount.concat() : [];\r\n                //this.saveBubbleVector = JSON.parse(JSON.stringify(this.savedPlotsData[index].bubble));//气泡\r\n                //this.shakeLoopObj = this.savedPlotsData[index].screenAnime && Object.assign(this.savedPlotsData[index].screenAnime,{})\r\n                this.visibleLayout[0] && (this.visibleLayout[0].visible = true);\r\n                this.visibleLayout = this.visibleLayout.slice(1);\r\n                this.recordLayer.visible = false;\r\n                this.mainMenuLayer.visible = false;\r\n                this.endLayer.visible = false;\r\n                this.onResume();\r\n                this.removePlotTweens();\r\n                this.playbackData = [];\r\n                playbackData.forEach(d => this.addPlayBackContent(d));\r\n                let cmdPlotSnap = {};\r\n                if (this.curCmdUuid) {\r\n                    if(this.savedPlotsData[index].weatherType !== ''){\r\n                        if(this.savedPlotsData[index].weatherType === 'snow' || this.savedPlotsData[index].weatherType === 'wind' || this.savedPlotsData[index].weatherType === 'rain'){\r\n                            this.savedPlotsData[index].weatherType += 'y';\r\n                        }\r\n                    }\r\n                    cmdPlotSnap = this.getCommandByCommandUuid(chapter.plots[nPlot], this.curCmdUuid);\r\n                    cmdPlotSnap.cmdScreenSnap = {charsAndProps: JSON.parse(JSON.stringify(this.savedPlotsData[index].charsAndProps))\r\n                        , sounds: this.savedPlotsData[index].sounds\r\n                        , music: this.savedPlotsData[index].music\r\n                        , plotViews: this.plotViews\r\n                        , dialogInfo: this.lstDialogInfo\r\n                        , menuInfo: this.menuInfo\r\n                        , bk: this.savedPlotsData[index].bk\r\n                        , weatherType: this.savedPlotsData[index].weatherType\r\n\t\t\t\t\t\t, autoText:this.bCmdAutoText\r\n                    };\r\n\r\n                    cmdPlotSnap.animateScene = {shake:null}\r\n                    if(this.savedPlotsData[index].animateScene && this.savedPlotsData[index].animateScene.shake){\r\n                        cmdPlotSnap.animateScene.shake = Object.assign(this.savedPlotsData[index].animateScene.shake,{});\r\n\t\t\t\t\t}\r\n                }\r\n\r\n                this.initContext(context, true);\r\n                context.commandInserts && (this.context.commandInserts = context.commandInserts.concat());\r\n                context.inserts && (this.context.inserts = context.inserts.concat());\r\n\t\t\t\tconst loadData = {\r\n\t\t\t\t\tmusic: this.savedPlotsData[index].music,\r\n\t\t\t\t\tsounds: this.savedPlotsData[index].sounds,\r\n\t\t\t\t\tcharsAndProps: this.charsAndPropsInfo,\r\n\t\t\t\t\tbackground: this.lstPlotBkKey,\r\n\t\t\t\t\timages: [this.lstDialogInfo && this.lstDialogInfo[0] ? { url: this.lstDialogInfo[0].avatar.url } : {}]\r\n\t\t\t\t\t,bubble:this.saveBubbleDataVector\r\n\t\t\t\t};\r\n                this.preloadChapterAssets(this.context, nChapter, nPlot, cmdPlotSnap, loadData);\r\n                this.coverLayer.visible = false;\r\n                !this.isGameStarted && this.notifyGameStarted();\r\n            };\r\n            const goRecordHandle = (chapter, index) => {\r\n            \tif (index < 0) {\r\n            \t\tconst {chapter:c, index:i} = this.getChapterByPlotUuid(this.json_data, plotUuid, chapterUuid);\r\n            \t\tgoRecord(c, i);\r\n\t\t\t\t} else {\r\n                    goRecord(chapter, index);\r\n                }\r\n\t\t\t};\r\n            if (!plotUuid) {\r\n                return false;\r\n            }\r\n\r\n\t\t\tconst {chapter, index: n} = this.getChapterByPlotUuid(this.json_data, plotUuid, chapterUuid);\r\n            const downloaduuid = chapter.downloadUuid ? chapter.downloadUuid : chapter.uuid;\r\n            const unlockLoadRecord = ()=>{\r\n                const unlockFinish = (bSuccess) => {\r\n                    if (bSuccess) {\r\n                        this.checkIfChapterFree(downloaduuid, chapter.md5).then((plots)=>{\r\n                            this.isPreferentialFinished = false;//成功有数据\r\n                            this.unlockChapterCallBack = null;\r\n                            chapter.plots.push(...plots);\r\n                            goRecordHandle(chapter, n);\r\n                        }, () => {\r\n                            if(flashvars.client === 'wap'){\r\n                                window.parent && window.parent.playLogin();\r\n                            }else{\r\n                                Dialog.error('获取付费章节信息失败')\r\n\t\t\t\t\t\t\t}\r\n                        })\r\n                    }\r\n                };\r\n                this.unlockChapter(downloaduuid, chapter.charge, chapter.md5, unlockFinish);\r\n            }\r\n            if(this.isPreferentialFinished !== false && ('android' === flashvars.client || 'ios' === flashvars.client)){\r\n                this.checkIfChapterFree(downloaduuid, chapter.md5).then((plots)=>{\r\n                    if(plots.length <=0 ){\r\n                        //数据为空\r\n                        unlockLoadRecord();\r\n                    }else{\r\n                        this.isPreferentialFinished = false;//成功有数据\r\n                    }\r\n                }, (msg)=>{\r\n                    //读档没数据\r\n                    unlockLoadRecord();\r\n                })\r\n\t\t\t}\r\n\r\n            if (chapter && chapter.md5 && (chapter.plots.length === 0)) {//如果读取的存档是在限免结束后读取  重新加载一次章节数据\r\n            \t//const chapterUuid = chapter.downloadUuid ? chapter.downloadUuid : chapter.uuid;\r\n                //第三方\r\n                if(this.isWapOther()){\r\n                    const otherback = (plots)=>{\r\n                        if(plots === null){\r\n                            Dialog.error('获取付费章节信息失败');\r\n                        }else if(plots === \"fail\"){\r\n                            //查询失败\r\n                            Dialog.custom(\"Error\",\"仍未查询到您的支付信息哦，请确认已经支付~ 如有疑问请添加闪艺客服QQ：819786897 ~\",\"提示\",\"复制QQ\",\"取消\",false).then(()=>{\r\n                                Copy(\"819786897\",{\r\n                                    debug: false,\r\n                                    message: '复制成功',\r\n                                })\r\n                            },()=>{\r\n                            })\r\n                        }else{\r\n                            chapter.plots.push(...plots ? plots : []);\r\n                            goRecordHandle(chapter, n);\r\n                        }\r\n                    }\r\n                    this.unlockChapterByWapOther(downloaduuid,chapter.charge,chapter.md5,otherback);\r\n                    return;\r\n                }\r\n                if (chapter.charge && ('android' === flashvars.client || 'ios' === flashvars.client || flashvars.client === 'wap')) {\r\n                \tif(flashvars.uid !== '' && flashvars.client === 'wap'){\r\n                        //wap端 已登 解锁之前再请求一次接口数据\r\n                        this.checkIfChapterFree(downloaduuid, chapter.md5).then((plots)=>{\r\n                            chapter.plots.push(...plots);\r\n                            goRecordHandle(chapter, n);\r\n                        },()=>{\r\n                            unlockLoadRecord();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}else{\r\n                        unlockLoadRecord();\r\n\t\t\t\t\t}\r\n                } else {\r\n                    this.checkIfChapterFree(downloaduuid, chapter.md5).then((plots)=>{\r\n                        chapter.plots.push(...plots);\r\n                        goRecordHandle(chapter, n);\r\n                    }, (msg)=>{\r\n                        if (-1 === msg.indexOf('code=87')) {\r\n                            Dialog.error(msg);\r\n                        } else { // 未购买此章节\r\n                            if(flashvars.wap === 'zxwwap'){\r\n                                Dialog.info('当前为收费章节，是否前往闪艺抢先体验？').then(()=>{\r\n                                    window.location.href = 'https://wap.3000.com/?m=detail&op=index&ac=index&id='+ flashvars.gid;\r\n                                })\r\n                            }else{\r\n                                Dialog.info('当前为收费章节，请前往闪艺app或电脑端进行购买');\r\n\t\t\t\t\t\t\t}\r\n                        }\r\n                    })\r\n\t\t\t\t}\r\n            } else if (chapter && -4 !== n) {\r\n                goRecord(chapter, n);\r\n            }\r\n            return true;\r\n\t\t},\r\n        /**\r\n\t\t *\r\n         * @param iCol\t\t行\r\n         * @param iRow\t\t列\r\n         * @param nCol\t\t总列数\r\n         */\r\n\t\tonRecordItemClicked: function (iCol, iRow,nCol) {\r\n\t\t\tconst index = iRow * nCol + iCol;\r\n\t\t\tconst get = ()=>{\r\n                if (this.bToSaveFile) {\r\n                    if ((this.gameUidBelongTo === this.recUidBelongTo || this.gameUidBelongTo === '') && this.recUidBelongTo === flashvars.uid) {\r\n                        this.saveRecord(index).then(saveData => {\r\n                            if (!saveData) {\r\n                                return false;\r\n                            }\r\n                            const item = this.recordLayer.getByName('scrollPane').children.find(c => c.name === `recordItem_${index}`);\r\n                            const itemContent = item.getByName('content');\r\n                            const itemTime = item.getByName('textTime');\r\n\r\n                            const setPreviewImage = key => {\r\n                                const {width, height} = itemContent;\r\n                                itemContent.loadTexture(key);\r\n                                itemContent.width = width;\r\n                                itemContent.height = height;\r\n                            };\r\n                            const snapMd5 = MD5.hash(saveData.plotSnap);\r\n                            if (!this.viewComponent.game.load.cache.checkImageKey(snapMd5)) {\r\n                                this.addImageUrl(saveData.plotSnap, snapMd5).then(() => setPreviewImage(snapMd5));\r\n                            } else {\r\n                                setPreviewImage(snapMd5);\r\n                            }\r\n                            const strText = Utils.getCurrentDateTime(saveData.timestamp);\r\n                            if (FontUtils.fontFamily) {\r\n                                const fh = this.json_data.font.size ? this.toRealImageFontHeight(itemTime.fontSize) : itemTime.fontSize;\r\n                                const fw = this.json_data.font.size ? this.toRealImageFontWidth(itemTime.fontSize) : itemTime.fontSize;\r\n                                this.addImageFontText([{data:strText}], fw, fh, itemTime, this.context);\r\n                                itemTime.text = ' ';\r\n                            }\r\n                            else {\r\n                                itemTime.text = strText;\r\n                            }\r\n                        });\r\n                    } else {\r\n                        Dialog.info('存档失败，请登录正确的账号后重新尝试');\r\n                    }\r\n                }\r\n                else {\r\n                    if (this.recUidBelongTo === flashvars.uid) {\r\n                        this.gameUidBelongTo = this.recUidBelongTo;\r\n                        if (this.savedPlotsData && this.savedPlotsData[index].plotUuid && !this.savedPlotsData[index].context) {\r\n                            // 说明是云存档数据 且还未获取存档内容\r\n                            this.loadCloudRecord(index).then(rs => {\r\n                                const convertCloudData = (data) => {\r\n                                    let cdata = JSON.parse(data);\r\n\r\n                                    if (cdata.context) {\r\n                                        this.savedPlotsData[index] = cdata;\r\n                                    }\r\n                                    else {\r\n                                    \t//flash存档\r\n                                        this.savedPlotsData[index].plotUuid = cdata.plotUuid;\r\n                                        this.savedPlotsData[index].chapterUuid = cdata.chapterUuid ? cdata.chapterUuid : undefined;\r\n                                        this.savedPlotsData[index].bkKey = cdata.backgroundObject ? cdata.backgroundObject.url : null;\r\n                                        //let ttt = cdata.date + ' ' + cdata.time;\r\n                                        //let arr = ttt.split(/[- : \\/]/);\r\n                                        //let ss = new Date(arr[0], arr[1]-1, arr[2], arr[3], arr[4], arr[5]);\r\n                                        //this.savedPlotsData[index].timestamp = Date.parse(ss);\r\n                                        //this.savedPlotsData[index].plotSnap = 'data:image/jpeg;base64,' + cdata.thumb;\r\n                                        this.savedPlotsData[index].context = {};\r\n                                        this.savedPlotsData[index].context.auto = false;\r\n                                        this.savedPlotsData[index].context.fullScreen = false;\r\n                                        this.savedPlotsData[index].context.values = [];\r\n                                        this.savedPlotsData[index].context.savedValues = [];\r\n                                        this.savedPlotsData[index].context.stringValues = [];\r\n                                        this.savedPlotsData[index].context.indexValues = [];\r\n                                        for (let j=0; j<cdata.values.length; j++) {\r\n                                            if (cdata.values[j].saved) {\r\n                                                let vi = this.savedPlotsData[index].context.savedValues.length;\r\n                                                for (let n=0; n<this.json_data.savedValues.length; n++) {\r\n                                                    if (this.json_data.savedValues[n].uuid === cdata.values[j].key) {\r\n                                                        vi = n;\r\n                                                        break;\r\n                                                    }\r\n                                                }\r\n                                                this.savedPlotsData[index].context.savedValues[vi] = {uuid: cdata.values[j].key\r\n                                                    , name: cdata.values[j].name\r\n                                                    , init: cdata.values[j].init\r\n                                                    , value: cdata.values[j].value };\r\n                                            }\r\n                                            else if (cdata.values[j].index) {\r\n                                                let vi = this.savedPlotsData[index].context.indexValues.length;\r\n                                                for (let n=0; n<this.json_data.indexValues.length; n++) {\r\n                                                    if (this.json_data.indexValues[n].uuid === cdata.values[j].key) {\r\n                                                        vi = n;\r\n                                                        break;\r\n                                                    }\r\n                                                }\r\n                                                this.savedPlotsData[index].context.indexValues[vi] = {uuid: cdata.values[j].key\r\n                                                    , name: cdata.values[j].name\r\n                                                    , init: cdata.values[j].init\r\n                                                    , value: cdata.values[j].value };\r\n                                            }\r\n                                            else if (cdata.values[j].init && cdata.values[j].init.type === 'string') {\r\n                                                let vi = this.savedPlotsData[index].context.stringValues.length;\r\n                                                for (let n=0; n<this.json_data.stringValues.length; n++) {\r\n                                                    if (this.json_data.stringValues[n].uuid === cdata.values[j].key) {\r\n                                                        vi = n;\r\n                                                        break;\r\n                                                    }\r\n                                                }\r\n                                                this.savedPlotsData[index].context.stringValues[vi] = {uuid: cdata.values[j].key\r\n                                                    , name: cdata.values[j].name\r\n                                                    , init: cdata.values[j].init\r\n                                                    , value: cdata.values[j].value };\r\n                                            }\r\n                                            else if (cdata.values[j].key && cdata.values[j].key[2] !== '_' && !cdata.values[j].pay){\r\n                                                let vi = this.savedPlotsData[index].context.values.length;\r\n                                                for (let n=0; n<this.json_data.values.length; n++) {\r\n                                                    if (this.json_data.values[n].uuid === cdata.values[j].key) {\r\n                                                        vi = n;\r\n                                                        break;\r\n                                                    }\r\n                                                }\r\n                                                this.savedPlotsData[index].context.values[vi] = {uuid: cdata.values[j].key\r\n                                                    , name: cdata.values[j].name\r\n                                                    , init: cdata.values[j].init\r\n                                                    , value: cdata.values[j].value };\r\n                                            }\r\n                                        }\r\n                                        this.savedPlotsData[index].context.stack = (cdata.stack || []).concat();\r\n                                        this.savedPlotsData[index].context.cmdStack = (cdata.cmdStack || []).concat();\r\n                                        this.savedPlotsData[index].globalViews = [];\r\n                                        this.savedPlotsData[index].plotViews = [];\r\n                                        for (let j=0; j<cdata.globalViewsData.length; j++) {\r\n                                            this.savedPlotsData[index].globalViews[j] = this.copyFlashViewData(cdata.globalViewsData[j], cdata.commandObj);\r\n                                            this.savedPlotsData[index].globalViews[j].x = this.Expression.safeEval(cdata.globalViewsData[j].x, this.savedPlotsData[index].context) * (1 - cdata.globalViewsData[j].scale);\r\n                                            this.savedPlotsData[index].globalViews[j].y = this.Expression.safeEval(cdata.globalViewsData[j].y, this.savedPlotsData[index].context) * (1 - cdata.globalViewsData[j].scale);\r\n                                            this.savedPlotsData[index].globalViews[j].parent = '__world';\r\n                                        }\r\n                                        for (let j=0; j<cdata.viewsData.length; j++) {\r\n                                            this.savedPlotsData[index].plotViews[j] = this.copyFlashViewData(cdata.viewsData[j], cdata.commandObj);\r\n                                            this.savedPlotsData[index].plotViews[j].x = this.Expression.safeEval(cdata.viewsData[j].x, this.savedPlotsData[index].context) * (1 - cdata.viewsData[j].scale);\r\n                                            this.savedPlotsData[index].plotViews[j].y = this.Expression.safeEval(cdata.viewsData[j].y, this.savedPlotsData[index].context) * (1 - cdata.viewsData[j].scale);\r\n                                            this.savedPlotsData[index].plotViews[j].parent = 'plotViewsLayer';\r\n                                        }\r\n                                        this.savedPlotsData[index].music = cdata.musics[0] ? {url: cdata.musics[0].url, volume: cdata.musics[0].volume} : {};\r\n                                        this.savedPlotsData[index].sounds = cdata.sounds.concat();\r\n                                        this.savedPlotsData[index].playbackData = cdata.speakings.concat();\r\n                                        this.savedPlotsData[index].bk = {};\r\n                                        this.savedPlotsData[index].charsAndProps = [];\r\n                                        this.savedPlotsData[index].dialogInfo = [];\r\n                                        this.savedPlotsData[index].cmdUuid = '';\r\n                                        this.savedPlotsData[index].weatherType = '';\r\n                                        this.savedPlotsData[index].bCmdAutoText = false;\r\n                                        const parsebubble = (bdata)=>{\r\n                                            for(let i =0;i < bdata.length;i++){\r\n                                                let bubblemode = bdata[i];\r\n                                                let modecommands = {\r\n                                                    args:bubblemode.args\r\n                                                    ,type:bubblemode.type\r\n                                                    ,uuid:bubblemode.uuid\r\n                                                }\r\n                                                let bubbleary = [];\r\n                                                let curbubbleary = [];\r\n                                                let ishide = !bubblemode.show;\r\n                                                let iscurrent = (i === bdata.length -1);\r\n                                                if(bubblemode.bubble && bubblemode.bubble.length > 0){\r\n                                                    for(let j = 0;j < bubblemode.bubble.length;j++){\r\n                                                        bubbleary.push(bubblemode.bubble[j]);\r\n                                                    }\r\n                                                    curbubbleary = bubblemode.bubble.slice(bubblemode.bubble.length - bubblemode.currentCount);\r\n                                                }\r\n                                                this.savedPlotsData[index].bubble.push({bubbleMode:modecommands,bubble:bubbleary,curbubble:curbubbleary,ishide:ishide,iscurrent:iscurrent})\r\n                                            }\r\n\t\t\t\t\t\t\t\t\t\t}\r\n                                        if (cdata.commandObj && cdata.commandObj.historyCommand) {\r\n                                            let {images, dialog, autotext, weather} = cdata.commandObj.historyCommand;\r\n                                            //this.savedPlotsData[index].bk = cdata.backgroundObject ? {url: cdata.backgroundObject.url, opacity: cdata.backgroundObject.opacity} : {};\r\n                                            this.savedPlotsData[index].cmdUuid = cdata.commandObj.commandUuid;\r\n                                            this.savedPlotsData[index].bCmdAutoText = autotext ? autotext.args[0] : false;\r\n                                            this.savedPlotsData[index].dialogInfo = dialog && dialog.command ? dialog.command.args : [];\r\n                                            this.savedPlotsData[index].weatherType = weather && weather.args[0];\r\n                                            if(cdata.commandObj.historyCommand.animateScene){\r\n                                                this.savedPlotsData[index].animateScene = cdata.commandObj.historyCommand.animateScene;\r\n\t\t\t\t\t\t\t\t\t\t\t}else{\r\n                                                this.savedPlotsData[index].animateScene = null;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n                                            if (images) {\r\n                                                for (let v=0; v<images.length; v++) {\r\n                                                    if (images[v].index > 1) {\r\n                                                        let item = {url:images[v].url, x:images[v].x, y:images[v].y, width:images[v].width, height:images[v].height, opacity: images[v].opacity\r\n                                                            , rotate:images[v].rotate, index:images[v].index,mirrorH:(images[v].mirrorH ? images[v].mirrorH : false),mirrorV:(images[v].mirrorV ? images[v].mirrorV : false)};\r\n                                                        this.savedPlotsData[index].charsAndProps.push(item);\r\n                                                    }\r\n                                                    else if (images[v].index === 1) {\r\n                                                        this.savedPlotsData[index].bk = {url:images[v].url, opacity:images[v].opacity};\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                            this.savedPlotsData[index].bubble  = []\r\n                                            cdata.commandObj.historyCommand.bubbleMode && parsebubble(cdata.commandObj.historyCommand.bubbleMode);\r\n                                            this.savedPlotsData[index].bubbleCount = [];\r\n\t\t\t\t\t\t\t\t\t\t\tif(cdata.commandObj.historyCommand.bubbleCount){\r\n                                                this.savedPlotsData[index].bubbleCount = cdata.commandObj.historyCommand.bubbleCount.concat();\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n                                        }else{\r\n                                        \t//普通剧情\r\n                                            this.savedPlotsData[index].bubble  = [];\r\n                                            cdata.bubbleMode && parsebubble(cdata.bubbleMode);\r\n                                            this.savedPlotsData[index].bubbleCount = [];\r\n                                            this.savedPlotsData[index].bubbleCount = cdata.bubbleCount && cdata.bubbleCount.concat()\r\n\t\t\t\t\t\t\t\t\t\t}\r\n                                        if (cdata.commandInserts && cdata.commandInserts.length) {\r\n                                            // 高级剧情有插播\r\n                                            this.savedPlotsData[index].context.commandInserts = cdata.commandInserts.concat();\r\n                                        }\r\n                                        if(cdata.inserts && cdata.inserts.length){\r\n                                        \t//普通剧情有插播\r\n                                            this.savedPlotsData[index].context.inserts = cdata.inserts.concat();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n                                        this.cloudPlotsData[index] = JSON.parse(JSON.stringify(this.savedPlotsData[index]));\r\n                                    }\r\n                                };\r\n                                convertCloudData(rs);\r\n                                this.loadRecord(index);\r\n                                this.showMenu();\r\n                            }, () => {\r\n                                Dialog.error('获取存档数据失败')\r\n                            });\r\n                        }\r\n                        else {\r\n                            this.loadRecord(index);\r\n                            this.showMenu();\r\n                        }\r\n                    } else {\r\n                        Dialog.info('读档失败，请登录正确的账号后重新尝试');\r\n                    }\r\n                }\r\n                return true;\r\n\t\t\t}\r\n            if (flashvars.u==='' && flashvars.token==='' && flashvars.client==='') {\r\n                let uid = Utils.getUidByCookie();\r\n                flashvars.uid = uid;\r\n            }\r\n            if(flashvars.client === 'wap' && flashvars.uid === ''){\r\n            \treturn this.getUserInfoFromWap().then(()=>{\r\n\t\t\t\t\treturn get();\r\n\t\t\t\t})\r\n\t\t\t}else{\r\n            \treturn get();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tonPlaybackBackBtnClicked: function () {\r\n\t\t\tthis.visibleLayout[0] && (this.visibleLayout[0].visible = true);\r\n            if (this.visibleLayout[0] !== this.mainMenuLayer) {\r\n                this.onResume();\r\n            }\r\n            this.playBackLayer.removeAll(true);\r\n\t\t\tthis.visibleLayout = this.visibleLayout.slice(1);\r\n\t\t\tthis.playBackLayer.visible = false;\r\n\t\t},\r\n\r\n\t\taddPlayBackContent: function (data) {\r\n\t\t\tthis.sendNotification(diygamePlayer.AppConstants.ADD_PLAYBACK_CONTENT, data);\r\n\t\t},\r\n\r\n\t\tshowLoadingToast: function (type) {\r\n\t\t\tif (1 === type) {\r\n\t\t\t\tthis.loadingToastLayer.visible = true;\r\n                this.viewComponent.game.world.bringToTop(this.loadingToastLayer);\r\n\t\t\t}\r\n\t\t\telse if (0 === type) {\r\n                this.loadingToastLayer.visible = false;\r\n\t\t\t}\r\n        },\r\n\r\n        showToast: function (type, text) {\r\n            let ss = this.toastLayer.getByName('typeSuccess');\r\n            let ee = this.toastLayer.getByName('typeError');\r\n            if (ss) {\r\n                if (0 === type) {\r\n                    ss.visible = true;\r\n                    ss.children[2].text = text;\r\n                    ss.children[0].width = ss.children[2].width + 36;\r\n                    ss.x = (this.viewComponent.game.world.width - ss.children[0].width) / 2;\r\n                    ss.y = flashvars.vertical ? 100 : 252;\r\n                } else {\r\n                    ss.visible = false;\r\n                }\r\n            }\r\n            if (ee) {\r\n                if (1 === type) {\r\n                    ee.visible = true;\r\n                    ee.children[2].text = text;\r\n                    ee.children[0].width = ee.children[2].width + 36;\r\n                    ee.children[1].visible = true;\r\n                    ee.children[2].x = 30;\r\n                    ee.x = (this.viewComponent.game.world.width - ee.children[0].width) / 2;\r\n                    ee.y = flashvars.vertical ? 100 : 252;\r\n                } else if (2 === type) {\r\n                    ee.visible = true;\r\n                    ee.children[2].text = text;\r\n                    ee.children[0].width = ee.children[2].width + 20;\r\n                    ee.children[1].visible = false;\r\n                    ee.children[2].x = 10;\r\n                    ee.x = (this.viewComponent.game.world.width - ee.children[0].width) / 2;\r\n                    ee.y = flashvars.vertical ? 100 : 252;\r\n\t\t\t\t} else {\r\n                    ee.visible = false;\r\n                }\r\n            }\r\n            this.toastLayer.alpha = 0;\r\n            this.viewComponent.game.world.bringToTop(this.toastLayer);\r\n            this.viewComponent.game.add.tween(this.toastLayer).from({alpha: 1}, 2500, null, true).name = 'toast';\r\n        },\r\n\r\n        addRetroText: function (x, y, w, h, txtData) {\r\n            let font = this.viewComponent.game.add.retroFont(FontUtils.fontFamily, FontUtils.charWidth, FontUtils.charHeight, FontUtils.fontChars, FontUtils.countPerRow);\r\n            let txtImg = this.viewComponent.game.add.image(x ? x : 0, y ? y : 0, font);\r\n            txtImg.fontImg = font;\r\n            if (document.body.clientWidth < document.body.clientHeight) {\r\n                font.stamp.angle = -90;\r\n            }\r\n            if (txtData) {\r\n                font.setText(txtData, true, 0, 0, 'center', true);\r\n                if (w) {\r\n                    txtImg.width = w;\r\n                }\r\n                if (h) {\r\n                    txtImg.height = h;\r\n                }\r\n            }\r\n\r\n            return txtImg;\r\n        },\r\n\r\n        addImageFontTextColors: function (data, txtObj, context) {\r\n            // 先清除上一次保存的颜色值\r\n            txtObj.colors.splice(0, txtObj.colors.length);\r\n\r\n            let iPos = 0;\r\n            let color = this.json_data.default_settings.color;\r\n            txtObj.fill = color;\r\n            for (let i=0; i<data.length; i++) {\r\n                let realData = '';\r\n                if (data[i].lineBreak) continue;  // 换行符不计入设置颜色的字符个数\r\n                else if (data[i].placeholder && '\\\\' === data[i].data[0]) {   // 停顿\r\n                    realData = this.Expression.parseWaitTime(data[i].data);\r\n                }\r\n                else {\r\n                    realData = this.Expression.parseValue(data[i].data, context);\r\n                }\r\n                color = data[i].color ? data[i].color : this.json_data.default_settings.color;\r\n                if (color[0] === '#' && color.length === 4) {\r\n                \tlet clr = '#' + color[1] + color[1] + color[2] + color[2] + color[3] + color[3];\r\n                \tcolor = clr;\r\n\t\t\t\t}\r\n                txtObj.addColor(color, iPos);\r\n                iPos += realData.length;\r\n            }\r\n        },\r\n\r\n        addImageFontText: function (data, font_width, font_height, txtObj, context, bSpeaking, bSpeakHidden) {\r\n            const {Expression} = this;\r\n            // 先清除上一剧情fontImage\r\n\t\t\tif (txtObj.children.length) {\r\n                let charGroup = txtObj.children[0];\r\n                let mask = txtObj.children[1];\r\n                for (let i=0; i<charGroup.children.length; i++) {\r\n                    let txtImg = charGroup.getChildAt(i);\r\n                    let fontImg = txtImg.fontImg;\r\n                    fontImg.destroy();\r\n                    txtImg.destroy();\r\n                }\r\n                charGroup.destroy();\r\n                mask && mask.destroy();\r\n                txtObj.removeChildren();\r\n            }\r\n\r\n            let xPos = 0;\r\n            let yPos = 0;\r\n            let cr = '#fffffe';\r\n            let bkWidth = 0;\r\n            let firstMargin = 0;\r\n            let fontHeight = parseFloat(font_height);\r\n            let fontWidth = parseFloat(font_width);\r\n            let t_h = this.json_data.font.size ? (this.json_data.font.size.target.height ? this.json_data.font.size.target.height : this.json_data.font.size.target) : this.json_data.default_settings.font_size;\r\n            let sizeRow = this.json_data.font.size ? (fontHeight * this.json_data.font.size.source / t_h) : fontHeight;\r\n            let seperation = this.json_data.font.size ? (1.5 * sizeRow - fontHeight) : (0.5 * sizeRow);\r\n            let fontChars = [];\r\n            let itemChar = {content:'', color:'#fffffe', x:0, y:0, space:0};\r\n            let charCount = 0;\r\n            let posInfo = [];\r\n            yPos += 0.5 * seperation;\t// 客户端第一行与顶部有0.5个间距 issue8176\r\n\r\n            for (let i=0; i<data.length; i++) {\r\n                let realData = '';\r\n                if (data[i].lineBreak) {\r\n                    if (i === data.length-1) {    // 最后一个换行符不输出\r\n                        break;\r\n                    }\r\n                    yPos += fontHeight + seperation;\r\n                    xPos = 0;\r\n                    continue;\r\n                }\r\n                else if (data[i].placeholder && '\\\\' === data[i].data[0]) {   // 停顿\r\n                    realData = Expression.parseWaitTime(data[i].data);\r\n                }\r\n                else {\r\n                    realData = Expression.parseValue(data[i].data, context);\r\n                }\r\n\r\n                for (let j=0; j<realData.length; j++) {\r\n                    if (txtObj.colors[charCount]) {\r\n                        cr = txtObj.colors[charCount];\r\n                        if (cr === '#ffffff') cr = '#fefefe';\r\n                    }\r\n\r\n                    const m = FontUtils.getLeftMargin(realData[j], fontWidth);\r\n                    const s = FontUtils.getCharSpace(realData[j], fontWidth);\r\n\r\n                    let x = xPos + m;\r\n                    if (x + s > txtObj.style.wordWrapWidth) { // 检测是否还能放下一个字符\r\n                        if (bkWidth < x+s) {\r\n                            bkWidth = x+s;\r\n                        }\r\n                        xPos = 0;\r\n                        x = xPos + m;\r\n                        yPos += fontHeight + seperation;\r\n                        firstMargin = m;\r\n                    }\r\n\r\n                    if (itemChar.space === 0) {\r\n                    \titemChar.space = s;\r\n                    \titemChar.color = cr;\r\n                    \titemChar.x = x;\r\n                    \titemChar.y = yPos;\r\n                    \tif (firstMargin === 0) {\r\n                    \t\tfirstMargin = m;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (32 === realData[j].charCodeAt(0) || 160 === realData[j].charCodeAt(0) || '\\u2002' === realData[j]  // 半角空格\r\n\t\t\t\t\t\t|| '\\u3000' === realData[j] || 8195 === realData[j].charCodeAt(0)) { // 全角空格\r\n                        itemChar.content && fontChars.push(itemChar);\r\n                        fontChars.push({content: realData[j], color:cr, x:x, y:yPos, space:s});\r\n                        itemChar = {content:'', color:'#fffffe', x:0, y:0, space:0};\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (itemChar.space !== s || itemChar.color !== cr || itemChar.y !== yPos || fontWidth !== s) {\r\n                        itemChar.content && fontChars.push(itemChar);\r\n                    \titemChar = {content:realData[j], color:cr, x:x, y:yPos, space:s};\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n                    \titemChar.content += realData[j];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tposInfo.push({x: x, y: yPos, space: s, bottomInText: yPos + fontHeight});\r\n\r\n\t\t\t\t\tcharCount++;\r\n                    xPos += s;\r\n                }\r\n            }\r\n            if (data.length) {\r\n            \tif (itemChar.content) {\r\n                    fontChars[fontChars.length - 1] !== itemChar && fontChars.push(itemChar);\r\n                    if (bkWidth < xPos) {\r\n                    \tbkWidth = xPos;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet charsBk = this.viewComponent.game.add.sprite(0, 0);\r\n                fontChars.forEach(item => {\r\n                \tif (32 === item.content.charCodeAt(0) || 160 === item.content.charCodeAt(0) || '\\u2002' === item.content\r\n\t\t\t\t\t\t|| '\\u3000' === item.content || 8195 === item.content.charCodeAt(0))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n                    let imgTxt = this.addRetroText(item.x, item.y, fontWidth * item.content.length, fontHeight, item.content);\r\n                    imgTxt.tint = parseInt(item.color.replace('#', '0x'));\r\n                    charsBk.addChild(imgTxt);\r\n                });\r\n                charsBk.extWidth = bkWidth;\r\n                charsBk.extMargin = firstMargin;\r\n                txtObj.addChild(charsBk);\r\n                txtObj.posInfo = posInfo;\r\n                fontChars.length && (txtObj.imgFBottom = fontChars[fontChars.length-1].y + fontHeight);\r\n\r\n                if (bSpeaking) {\r\n                    let mask = this.viewComponent.game.add.graphics(0, 0);\r\n                    let maskWidth = txtObj.style.wordWrapWidth;\r\n                    let maskHeight = bSpeakHidden ? 540 : this.json_data.template.json.dialog.rect.height;\r\n                    mask.beginFill(0xffffff);\r\n                    mask.drawRect(-maskWidth, -maskHeight, 2 * maskWidth, maskHeight);\r\n                    mask.drawRect(-maskWidth, 0, maskWidth, fontHeight);\r\n                    mask.endFill();\r\n                    charsBk.mask = mask;\r\n                    txtObj.addChild(mask);\r\n                }\r\n\t\t\t}\r\n        },\r\n\r\n        saveData: function (index, auto) {\r\n            return new Promise((resolve, reject) => {\r\n                if (flashvars.uuid && !this.bCloudSel) {\r\n                    Utils.localStorageSetItem(flashvars.uuid + flashvars.uid, JSON.stringify(this.savedPlotsData));\r\n                    !auto && this.showToast(0, '存档成功，下次可以从这里读档继续哦~');\r\n                    resolve();\r\n                }\r\n                else if (flashvars.gid && this.bCloudSel) {\r\n                \tthis.showLoadingToast(1);\r\n                    this.saveCloudRecord(index).then(rs => {\r\n                    \tthis.showLoadingToast(0);\r\n                        !auto && this.showToast(0, '存档成功，下次可以从这里读档继续哦~');\r\n                        resolve();\r\n                    }, rj => {\r\n                        //Dialog.error(rj)\r\n                        this.showLoadingToast(0);\r\n                        !auto && this.showToast(1, '存档失败，请检查您的网络哦~');\r\n                        reject();\r\n                    });\r\n                }\r\n            })\r\n        },\r\n\r\n\t\tloadData: function (bLocalCloudSwitch) {\r\n        \tconst load = ()=>{\r\n                if (!this.bCloudSel) {\r\n                    this.recUidBelongTo = flashvars.uid;\r\n                }\r\n                else if (this.recUidBelongTo === '') {\r\n                    this.recUidBelongTo = flashvars.uid;\r\n                }\r\n\r\n                if (flashvars.uuid) {\r\n                    if (this.bSignedIn && this.bCloudSel) {\r\n                        this.savedPlotsData = JSON.parse(JSON.stringify(this.cloudPlotsData));\r\n                    }\r\n                    else {\r\n                        let savedData = Utils.localStorageGetItem(flashvars.uuid + flashvars.uid);\r\n                        if (savedData && 'ios' === flashvars.client) {\r\n                            savedData = savedData.replace(/\\n/g, '');\r\n                            savedData = savedData.replace(/\\r/g, '');\r\n                        }\r\n                        this.savedPlotsData = JSON.parse(savedData);\r\n                    }\r\n                }\r\n                if (!this.savedPlotsData) {\r\n                    this.savedPlotsData = Array(12).fill({});\r\n                }\r\n\t\t\t}\r\n            if (flashvars.u==='' && flashvars.token==='' && flashvars.client==='') {\r\n                let uid = Utils.getUidByCookie();\r\n                if ('' !== uid && flashvars.uid !== uid) {\r\n                    flashvars.uid = uid;\r\n                    this.localRecFileToUidRecFile(bLocalCloudSwitch);\r\n                } else {\r\n                \tflashvars.uid = uid;\r\n\t\t\t\t}\r\n            }\r\n            if(flashvars.client === 'wap' && flashvars.uid === ''){\r\n            \tthis.getUserInfoFromWap().then(()=>{\r\n\t\t\t\t\tload();\r\n\t\t\t\t})\r\n\t\t\t}else{\r\n            \tload();\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tgetSnap: function () {\r\n            const canvas = document.createElement('canvas');\r\n            canvas.width =  this.viewComponent.game.world.width / 3;\r\n            canvas.height =  this.viewComponent.game.world.height / 3;\r\n            this.viewComponent.game.updateRender(1);\r\n            const ctx = canvas.getContext('2d');\r\n\t\t\tconst w = (window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth)\r\n\t\t\tconst h = (window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight)\r\n\t\t\tif (w > h) {\r\n\t\t\t\tif(flashvars.vertical){\r\n                    ctx.save();\r\n                    ctx.translate(0, canvas.height);\r\n                    ctx.rotate(-90 * Math.PI / 180);\r\n                    ctx.drawImage(this.viewComponent.game.canvas, 0, 0);\r\n                    ctx.restore();\r\n\t\t\t\t}else{\r\n                    ctx.drawImage(this.viewComponent.game.canvas, 0, 0, this.viewComponent.game.world.width, this.viewComponent.game.world.height, 0, 0, canvas.width, canvas.height);\r\n\t\t\t\t}\r\n                this.plotSnap = canvas.toDataURL(\"image/jpeg\", 0.3);\r\n\t\t\t}\r\n\t\t\telse {\r\n                if(flashvars.vertical){\r\n                    ctx.drawImage(this.viewComponent.game.canvas, 0, 0, this.viewComponent.game.world.width, this.viewComponent.game.world.height, 0, 0, canvas.width, canvas.height);\r\n                }else{\r\n                    ctx.save();\r\n                    ctx.translate(0, canvas.height);\r\n                    ctx.rotate(-90 * Math.PI / 180);\r\n                    ctx.drawImage(this.viewComponent.game.canvas, 0, 0);\r\n                    ctx.restore();\r\n\t\t\t\t}\r\n\r\n                this.plotSnap = canvas.toDataURL(\"image/jpeg\", 0.3);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tgetChapterByPlotUuid: function (game, uuid, chapterUuid) {\r\n\t\t\tconst searchPlot = (plots, chapter, uuid, chapterUuid) => {\r\n\t\t\t\tlet result = null;\r\n\t\t\t\tif (chapterUuid && chapter.uuid !== chapterUuid) {\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t}\r\n\t\t\t\telse if (chapterUuid && chapter.uuid === chapterUuid && chapter.plots.length === 0) {\r\n\t\t\t\t\tresult = {chapter: chapter, index: -4};\r\n\t\t\t\t}\r\n\t\t\t\tplots.find((plot, i) => {\r\n\t\t\t\t\tif (plot.uuid === uuid) {\r\n\t\t\t\t\t\tresult = {chapter: chapter, index: i};\r\n\t\t\t\t\t} else if (chapter.plots[i].options) {\r\n\t\t\t\t\t\tresult = searchPlotByOption(chapter, i, uuid);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn result !== null;\r\n\t\t\t\t});\r\n\r\n\t\t\t\treturn result;\r\n\t\t\t};\r\n\r\n\t\t\tconst searchPlotByOption = (chapter, nIndex, uuid) => {\r\n\t\t\t\tlet result = null;\r\n\t\t\t\tconst plot = chapter.plots[nIndex];\r\n\t\t\t\tplot.options.find((option, i) => {\r\n\t\t\t\t\tresult = searchPlot(option.plots, {plots: option.plots, parent: {pChapter: chapter, pnPlot: nIndex}, uuid: chapter.uuid, md5:chapter.md5, downloadUuid:chapter.downloadUuid}, uuid);\r\n\t\t\t\t\treturn result !== null\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (result) {\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tplot.condition_options && plot.condition_options.find((option, i) => {\r\n\t\t\t\t\tresult = searchPlot(option.plots, {plots: option.plots, parent: {pChapter: chapter, pnPlot: nIndex}, uuid: chapter.uuid, md5:chapter.md5, downloadUuid:chapter.downloadUuid}, uuid);\r\n\t\t\t\t\treturn result !== null\r\n\t\t\t\t});\r\n\r\n\t\t\t\treturn result;\r\n\t\t\t};\r\n\r\n\t\t\tconst searchPlotByChapter = (chapter, uuid, chapterUuid) => {\r\n\t\t\t\tlet result = null;\r\n\t\t\t\tresult = searchPlot(chapter.plots, chapter, uuid, chapterUuid);\r\n\t\t\t\tif (result) {\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t}\r\n\t\t\t\tchapter.subchapters.find((subchapter, i) => {\r\n\t\t\t\t\tresult = searchPlotByChapter(chapter.subchapters[i], uuid, chapterUuid);\r\n\t\t\t\t\treturn result !== null\r\n\t\t\t\t});\r\n\r\n\t\t\t\treturn result;\r\n\t\t\t};\r\n\r\n\t\t\tlet result = null;\r\n\t\t\tgame.chapters.find((chapter, i) => {\r\n                result = searchPlotByChapter(game.chapters[i], uuid, chapterUuid);\r\n                return result !== null\r\n\t\t\t});\r\n\t\t\tif (!result || -4 === result.index && !result.chapter.md5) {\r\n\t\t\t\tDialog.error('该剧情已被作者删除啦！\\r\\n无法从该剧情继续哦~');\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t},\r\n\r\n\t\tgetCommandByCommandUuid: function (plot, uuid) {\r\n            const searchCommandInOption = (ops, pCmdInfo, pIndex) => {\r\n            \tfor (let i=0; i<ops.length; i++) {\r\n                    let result = null;\r\n                    result = searchCommand({commands: ops[i].commands, parentInfo: pCmdInfo, parentCmdIndex: pIndex});\r\n            \t\tif (result.cmdInfo !== null) return result;\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t};\r\n\r\n            const searchCommand = (cmdInfo) => {\r\n            \tlet result = null;\r\n            \tcmdInfo.commands.find((command, i) => {\r\n            \t\tif (command.uuid === uuid) {\r\n            \t\t\tresult = {cmdIndex: i, uuid: uuid, cmdInfo: {commands: cmdInfo.commands, parentInfo: cmdInfo.parentInfo, parentCmdIndex: cmdInfo.parentCmdIndex}}\r\n                    }\r\n            \t\telse if (command.type === 'options' || command.type === 'conditionOptions') {\r\n            \t\t\tresult = searchCommandInOption(command.args, cmdInfo, i);\r\n                    }\r\n\r\n                    return null !== result;\r\n\t\t\t\t});\r\n            \tif (null === result) {\r\n            \t\treturn {cmdIndex: -1, cmdInfo: null};\r\n                }\r\n                return result;\r\n\t\t\t};\r\n\r\n            let cmdInfo = {commands: plot.commands, parentInfo: null, parentCmdIndex: -1};\r\n            return searchCommand(cmdInfo);\r\n        },\r\n\r\n\t\tgetMusic: function (chapter, nPlot) {\r\n\t\t\tlet url = null;\r\n\t\t\tfor (let i = nPlot; i >= 0; i--) {\r\n\t\t\t\tconst plot = chapter.plots[i];\r\n\t\t\t\tif (plot.music && plot.music.url !== \"inherit\") {\r\n\t\t\t\t\turl = plot.music.url;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!url && chapter.parent) {\r\n\t\t\t\treturn this.getMusic(chapter.parent.pChapter, chapter.parent.pnPlot);\r\n\t\t\t}\r\n\t\t\tif (!url && chapter.isFirst) {\r\n\t\t\t\tif (this.json_data.cover.music && this.json_data.cover.music.url !== 'inherit') {\r\n                    return this.json_data.cover.music.url;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn url;\r\n\t\t},\r\n\r\n\t\tgetCmdScreenSnap: function () {\r\n\t\t\tlet {bk_music, plotSounds, curPlotLayer} = this;\r\n\t\t\tlet bkInfo = curPlotLayer.children[1];\r\n\t\t\tlet chAndProps = [];\r\n            let plotViews = [];\r\n            let dialogInfo = this.lstDialogInfo.concat();\r\n            let menuInfo = this.menuInfo.concat();\r\n            let music = bk_music ? {url: bk_music.key, volume: bk_music.volume} : null;\r\n            let sounds = plotSounds.map(s => {\r\n                if (s) {\r\n                    return {\r\n                        url: s.key,\r\n                        volume: s.volume,\r\n                        time: s.loop ? 0 : 1\r\n                    }\r\n                }\r\n                return null;\r\n            });\r\n            let bk = bkInfo ? {url: bkInfo.key, opacity: bkInfo.alpha, width: bkInfo.width, height: bkInfo.height} : null;\r\n\r\n            this.saveBubbleDataVector = []\r\n            let bubble =  this.getBubbleData().concat();\r\n            this.apToFinalState();\r\n            this.charsAndPropsLayer && this.charsAndPropsLayer.children.forEach(g => {\r\n            \tlet c = g.children[0];\r\n\t\t\t\tlet item = {url:c.key, x:c.x, y:c.y, width:c.width, height:c.height, opacity: c.alpha, pivotX: c.pivot.x, pivotY: c.pivot.y\r\n\t\t\t\t\t, scaleX:c.scale.x, scaleY:c.scale.y, rotate:c.angle, cmdUuid:c.cmdUuid, index:g.zIndex, parentScale: g.scale.x};\r\n\t\t\t\tchAndProps.push(item);\r\n\t\t\t});\r\n            this.getViewData(this.plotViews, plotViews);\r\n            return {bk: bk, charsAndProps: chAndProps, sounds: sounds, music: music, plotViews: plotViews, dialogInfo: dialogInfo, menuInfo: menuInfo, autoText: this.bCmdAutoText, weatherType: this.getWeatherType(),bubble:bubble};\r\n        },\r\n\r\n\t\tgetNextPlot: function (context, chapter, nPlot, type, eArg,isview = false) {\r\n            const searchChapterByUUID = Utils.searchChapterByUUID;\r\n\t\t\tlet {json_data, Expression} = this;\r\n\t\t\tconst game = json_data;\r\n\t\t\tlet cmdPlotSnap = {cmdIndex: 0, cmdInfo: null, cmdScreenSnap: null,animateScene:{shake:null}};\r\n\t\t\tlet nIndex = nPlot;\r\n\t\t\tlet nChapter = chapter;\r\n\t\t\tlet preStackFrame = undefined;\r\n\t\t\tlet preCmdStackFrame = undefined;\r\n\t\t\tconst plot = chapter.plots[nPlot];\r\n\t\t\tnIndex++;\r\n\r\n\t\t\tif (type === 'option') { \r\n\t\t\t\tif (plot.options[eArg]) {\r\n                    const frame = {};\r\n                    frame.type = 'options';\r\n                    frame.index = eArg;\r\n                    frame.loopCondition = null;\r\n                    frame.loopCount = 1;\r\n                    context.stack = [frame, ...context.stack];\r\n                    nChapter = {plots: plot.options[eArg].plots, parent: {pChapter: nChapter, pnPlot: nPlot}, uuid: chapter.uuid};\r\n                    nIndex = 0;\r\n\t\t\t\t}\r\n\t\t\t} else if (plot && !plot.insert && !plot.jump && !plot.back && !type) {\r\n                const condOptIndex = (plot.condition_options || []).findIndex(option => {\r\n                    return Expression.safeEval(option.expression, context)\r\n                        && (option.count ? parseInt(Expression.safeEval(option.count, context)) > 0 : true)\r\n                });\r\n                const condOpt = condOptIndex < 0 ? null : plot.condition_options[condOptIndex];\r\n                if (condOpt) {\r\n                    const frame = {};\r\n                    frame.type = 'condition_options';\r\n                    frame.index = condOptIndex;\r\n                    frame.loopCondition = \"loop\" === condOpt.type || \"countLoop\" === condOpt.type ? condOpt.expression : null;\r\n                    frame.loopCount = 1;\r\n                    frame.loopCountExpr = condOpt.count;\r\n                    context.stack = [frame, ...context.stack];\r\n                    nIndex = 0;\r\n                    nChapter = {plots: condOpt.plots, parent: {pChapter: chapter, pnPlot: nPlot}, uuid: chapter.uuid};\r\n                }\r\n\t\t\t}\r\n            if (plot && (plot.back === true ||  type === 'back') && ((type !== undefined && type !== 'insertPlot') || type === undefined)) {\r\n                nIndex = -2;\r\n                context.stack = [];\r\n            }\r\n\r\n\t\t\tif (plot && ((plot.jump && !type) || (plot.jump && 'nextPlot' === type) || type === 'jump')) {\r\n\t\t\t\tlet jumpUuid = type === 'jump' ? eArg : plot.jump;\r\n\t\t\t\tconst jumpChapter = searchChapterByUUID(game, jumpUuid);\r\n\t\t\t\tif (jumpChapter) {\r\n\t\t\t\t\tnChapter = jumpChapter;\r\n\t\t\t\t\tnIndex = 0;\r\n\t\t\t\t\tcontext.stack = [];\r\n\t\t\t\t\tcontext.cmdStack = [];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n            if (plot && type === 'jumpOption') {\r\n                context = JSON.parse(JSON.stringify(this.context));\r\n\r\n                for (let t = 0; t < eArg; t++) {\r\n                    if (!nChapter.parent) {\r\n                        break;//return false;\r\n                    }\r\n                    if (context.stack[0] && context.stack[0].type !== 'insert') {\r\n                        context.stack = context.stack.splice(1);\r\n                        nIndex = nChapter.parent.pnPlot;\r\n                        nChapter = nChapter.parent.pChapter;\r\n                    } else {\r\n                    \tbreak;\r\n\t\t\t\t\t}\r\n                }\r\n                if (-1 !== nIndex) {\r\n                    this.context = context;\r\n                    nIndex++;\r\n                }\r\n            }\r\n\r\n            if (plot && type === 'backOption') {\r\n                context = JSON.parse(JSON.stringify(this.context));\r\n                for (let t = 0; t < eArg; t++) {\r\n                    if (!nChapter.parent) {\r\n                        break;//return false;\r\n                    }\r\n                    if (context.stack[0] && context.stack[0].type !== 'insert') {\r\n                        context.stack = context.stack.splice(1);\r\n                        nIndex = nChapter.parent.pnPlot;\r\n                        nChapter = nChapter.parent.pChapter;\r\n                    } else {\r\n                    \tbreak;\r\n\t\t\t\t\t}\r\n                }\r\n                if (-1 < nIndex) {\r\n                    this.context = context;\r\n                    return {chapter: nChapter, nIndex: nIndex, context: context};\r\n                }\r\n            }\r\n\r\n\t\t\tif (plot && (plot.insert && !type || type === 'insertPlot' && eArg)) {\r\n\t\t\t\tconst chapterUuid = eArg || plot.insert;\r\n\t\t\t\tconst c = searchChapterByUUID(game, chapterUuid);\r\n\t\t\t\tif (c) {\r\n\t\t\t\t\tconst frame = {};\r\n\t\t\t\t\tframe.type = 'insert';\r\n\t\t\t\t\tframe.isCommand = chapter.plots[nPlot].commands ? true : false;\r\n\t\t\t\t\tframe.cmdInfo = frame.isCommand ? this.curCmdInfo : null;\r\n\t\t\t\t\tframe.cmdIndex = frame.isCommand ? this.curCmdIndex : null;\r\n\t\t\t\t\tframe.isView = isview ;//是否是高级界面的插播\r\n\t\t\t\t\tframe.cmdScreenSnap = frame.isCommand ? this.getCmdScreenSnap() : null;\r\n                    frame.isCommand && (context.cmdStack = [{type:'insert'}, ...context.cmdStack]);\r\n\t\t\t\t\tframe.loopCondition = null;\r\n\t\t\t\t\tframe.loopCount = 1;\r\n\t\t\t\t\tframe.pPlotUuid = nChapter.plots[nIndex-1].uuid;\r\n\t\t\t\t\tframe.chapterUuid = nChapter.uuid;\r\n                    frame.animateScene = {shake:null};\r\n\t\t\t\t\tframe.animateScene.shake = this.getScreenAnime().commands;//获取振动效果\r\n\t\t\t\t\tcontext.stack = [frame, ...context.stack];\r\n\t\t\t\t\tnChapter = {plots:c.plots, md5:c.md5, uuid:c.uuid, downloadUuid: c.downloadUuid, charge: c.charge, parent:{pChapter:nChapter, pnPlot:nIndex - 1}};\r\n\t\t\t\t\tnIndex = 0;\r\n\r\n\t\t\t\t\tif (this.mainMenuLayer.visible)\r\n            \t    {\r\n            \t    \tif (this.mainMenuLayer.children[1] && this.mainMenuLayer.children[1].isMenu) {\r\n            \t    \t\tthis.sendNotification(diygamePlayer.AppConstants.SCENE_DESTROY_VIEW, {name:this.mainMenuLayer.children[1].name, isMainMenu: true});\r\n\t\t\t\t\t\t}\r\n                \t    this.onMainMenuBackBtnClicked();\r\n                \t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\twhile ((!nChapter.plots[nIndex] && nIndex !== 0 && nChapter.plots.length && context.stack && 0 < context.stack.length)\r\n\t\t\t\t\t|| (!nChapter.plots[nIndex] && nIndex === 0 && !nChapter.plots.length && !nChapter.md5 && context.stack && 0 < context.stack.length)) {\r\n                //context.stack有值\r\n                const frame = context.stack[0];\r\n\r\n                if (frame.loopCondition && Expression.safeEval(frame.loopCondition, context)) {\r\n                    //满足循环条件\r\n                    nIndex = 0;\r\n                    if (frame.loopCount) {\r\n                        frame.loopCount++;\r\n                    }\r\n                    if (frame.loopCountExpr) {\r\n                        const count = parseInt(Expression.safeEval(frame.loopCountExpr, context));\r\n                        if (frame.loopCount <= count) {\r\n                            //满足次数循环条件\r\n                            break;\r\n                        }\r\n                    } else {\r\n                        break;\r\n                    }\r\n                }\r\n                context.stack = context.stack.splice(1);\r\n                if (frame.type === 'insert' && context.cmdStack.length && context.cmdStack[0].type && context.cmdStack[0].type === 'insert') {\r\n                    preCmdStackFrame = context.cmdStack[0];\r\n                    context.cmdStack = context.cmdStack.splice(1);\r\n                    this.saveBubbleDataVector = this.getBubbleData(true).concat();\r\n\t\t\t\t\t// 修复flash存档数据高级剧情insert部分\r\n                    if (context.commandInserts) {\r\n                        for (let i=0; i<context.commandInserts.length; i++) {\r\n                            if (frame.pPlotUuid !== context.commandInserts[i].uuid) {\r\n                                continue;\r\n                            }\r\n                            const result = this.getChapterByPlotUuid(this.json_data, frame.pPlotUuid, frame.chapterUuid);\r\n                            if (null === result || result.chapter && result.index === -4) {\r\n                                break;\r\n                            }\r\n                            const cmdResult = this.getCommandByCommandUuid(result.chapter.plots[result.index], context.commandInserts[i].data.commandUuid);\r\n                            frame.cmdInfo = cmdResult.cmdInfo;\r\n                            frame.cmdIndex = cmdResult.cmdIndex;\r\n\r\n                            if (context.commandInserts[i].data.historyCommand) {\r\n                                let snap = {charsAndProps:[], sounds: Array(12), music: null, plotViews: [], menuInfo: []};\r\n                                let {images, dialog, autoText, weather, viewsData} = context.commandInserts[i].data.historyCommand;\r\n                                snap.autoText = autoText ? autoText.args[0] : false;\r\n                                snap.dialogInfo = dialog && dialog.command ? dialog.command.args : [];\r\n                                snap.weatherType = weather ? weather.args[0] : '';\r\n                                if (images) {\r\n                                    for (let v=0; v<images.length; v++) {\r\n                                        if (images[v].index > 1) {\r\n                                            let item = {url:images[v].url, x:images[v].x, y:images[v].y, width:images[v].width, height:images[v].height, opacity: images[v].opacity\r\n                                                , rotate:images[v].rotate, index:images[v].index};\r\n                                            snap.charsAndProps.push(item);\r\n                                        }\r\n                                        else if (images[v].index === 1) {\r\n                                            snap.bk = {url:images[v].url, opacity:images[v].opacity};\r\n                                        }\r\n                                    }\r\n                                }\r\n                                if (viewsData && viewsData.length) {\r\n                                    for (let j=0; j<viewsData.length; j++) {\r\n                                        snap.plotViews[j] = this.copyFlashViewData(viewsData[j]);\r\n                                        snap.plotViews[j].x = 0;\r\n                                        snap.plotViews[j].y = 0;\r\n                                        snap.plotViews[j].parent = 'plotViewsLayer';\r\n                                    }\r\n                                }\r\n                                frame.cmdScreenSnap = snap;\r\n                            }\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (nChapter.parent && 'insert' !== frame.type) {\r\n                    cmdPlotSnap.cmdIndex = frame.isCommand ? frame.cmdIndex+1 : -1;\r\n                    cmdPlotSnap.cmdInfo = frame.cmdInfo;\r\n                    cmdPlotSnap.cmdScreenSnap = frame.cmdScreenSnap;\r\n                    nIndex = frame.isCommand ? nChapter.parent.pnPlot : nChapter.parent.pnPlot + 1;\r\n                    nChapter = nChapter.parent.pChapter;\r\n                    //修复flash存档普通剧情insert部分\r\n                    if(context.inserts && context.inserts.length && !nChapter.plots[nIndex] && context.stack.length <= 0){\r\n\t\t\t\t\t\tconst {chapterUuid,plotUuid} = context.inserts.pop();\r\n                        const serchchapter = searchChapterByUUID(game,chapterUuid);\r\n                        if(!serchchapter) break;\r\n                        nChapter = serchchapter;\r\n                        nIndex = plotUuid;\r\n                    }\r\n                    this.saveBubbleDataVector = this.getBubbleData(true).concat();\r\n                } else if (frame.pPlotUuid && frame.type === 'insert') {\r\n                    cmdPlotSnap.cmdIndex = frame.isCommand ? frame.cmdIndex+1 : -1;\r\n                    cmdPlotSnap.cmdInfo = frame.cmdInfo;\r\n                    cmdPlotSnap.cmdScreenSnap = frame.cmdScreenSnap;\r\n                    cmdPlotSnap.bubble = frame.bubble ? frame.bubble.concat() : [];\r\n                    if(frame.animateScene && frame.animateScene.shake !== null){\r\n                        cmdPlotSnap.animateScene.shake = Object.assign(frame.animateScene.shake,{})\r\n\t\t\t\t\t}\r\n                    const {chapter: c, index: n} = this.getChapterByPlotUuid(this.json_data, frame.pPlotUuid, frame.chapterUuid);\r\n                    nIndex = frame.isCommand ? n : n+1;\r\n                    if(frame.isView && !frame.isCommand && nIndex > c.plots.length){nIndex = n};\r\n                    nChapter = c;\r\n                    preStackFrame = frame;\r\n                    this.saveBubbleDataVector = this.getBubbleData(true).concat();\r\n                }\r\n\t\t\t};\r\n\t\t\treturn {chapter: nChapter, nIndex: nIndex, cmdPlotSnap, context, preStackFrame, preCmdStackFrame}\r\n\t\t},\r\n\r\n\t\tgetNextCommand: function (context, cmdInfo, index, action) {\r\n            let {Expression} = this;\r\n            let rCmdInfo = cmdInfo;\r\n            let rIndex = index;\r\n            rIndex++;\r\n\r\n            if ('options' === action.type) {\r\n                const args = cmdInfo.commands[index].args;\r\n                if (action.index >= 0 && args[action.index].commands.length > 0) {\r\n                    const frame = {};\r\n                    frame.loopCondition = null;\r\n                    frame.loopCount = 1;\r\n                    context.cmdStack = [frame, ...context.cmdStack];\r\n\r\n                    rIndex = 0;\r\n                    rCmdInfo = {commands: args[action.index].commands, parentInfo: cmdInfo, parentCmdIndex: index};\r\n                }\r\n                else {\r\n                    this.optionLayer.destroy();\r\n                }\r\n            }\r\n            else if ('cdtOptions' === action.type) {\r\n                const args = cmdInfo.commands[index].args;\r\n                const condOptIndex = (args).findIndex(option => {\r\n                    return Expression.safeEval(option.expression, context)\r\n                        && (option.count ? parseInt(Expression.safeEval(option.count, context)) > 0 : true)\r\n                });\r\n                const condOpt = condOptIndex < 0 ? null : args[condOptIndex];\r\n                if (condOpt) {\r\n                    const frame = {};\r\n                    frame.loopCondition = \"loop\" === condOpt.type || \"countLoop\" === condOpt.type ? condOpt.expression : null;\r\n                    frame.loopCount = 1;\r\n                    frame.loopCountExpr = condOpt.count;\r\n                    context.cmdStack = [frame, ...context.cmdStack];\r\n                    rIndex = 0;\r\n                    rCmdInfo = {commands: condOpt.commands, parentInfo: cmdInfo, parentCmdIndex: index};\r\n\t\t\t\t}\r\n            }\r\n            else if ('backOption' === action.type) {\r\n                for (let i=0; i<action.eArg; i++) {\r\n                \tif (!rCmdInfo.parentInfo) {\r\n                \t\tbreak;\r\n\t\t\t\t\t}\r\n                    if (context.cmdStack[0] && context.cmdStack[0].type !== 'insert') {\r\n                        context.cmdStack = context.cmdStack.splice(1);\r\n                        rIndex = rCmdInfo.parentCmdIndex;\r\n                        rCmdInfo = rCmdInfo.parentInfo;\r\n                    } else {\r\n                        break;\r\n                    }\r\n                }\r\n                if (rIndex > -1 && rCmdInfo.commands) {\r\n                \treturn {info: rCmdInfo, index: rIndex};\r\n                }\r\n            }\r\n            else if ('jumpOption' === action.type) {\r\n                for (let i=0; i<action.eArg; i++) {\r\n                \tif (!rCmdInfo.parentInfo) {\r\n                \t\tbreak;\r\n\t\t\t\t\t}\r\n                    if (context.cmdStack[0] && context.cmdStack[0].type !== 'insert') {\r\n                        context.cmdStack = context.cmdStack.splice(1);\r\n                        rIndex = rCmdInfo.parentCmdIndex;\r\n                        rCmdInfo = rCmdInfo.parentInfo;\r\n                    } else {\r\n                \t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n                rIndex++;\r\n\t\t\t}\r\n\r\n            while (rCmdInfo && !rCmdInfo.commands[rIndex] && context.cmdStack && 0 < context.cmdStack.length) {\r\n                const frame = context.cmdStack[0];\r\n                if (frame.loopCondition && Expression.safeEval(frame.loopCondition, context)) {\r\n                    //满足循环条件\r\n                    rIndex = 0;\r\n                    if (frame.loopCount) {\r\n                        frame.loopCount++;\r\n                    }\r\n                    if (frame.loopCountExpr) {\r\n                        const count = parseInt(Expression.safeEval(frame.loopCountExpr, context));\r\n                        if (frame.loopCount <= count) {\r\n                            //满足次数循环条件\r\n                            break;\r\n                        }\r\n                    } else {\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                if (!frame.type || frame.type !== 'insert') {\r\n                    context.cmdStack = context.cmdStack.splice(1);\r\n                }\r\n\r\n                if (frame.type && frame.type === 'insert') {\r\n                    rIndex = -1;\r\n                    rCmdInfo = null;\r\n\t\t\t\t}\r\n                else if (rCmdInfo.parentInfo) {\r\n                    rIndex = rCmdInfo.parentCmdIndex + 1;\r\n                    rCmdInfo = rCmdInfo.parentInfo;\r\n\t\t\t\t}\r\n            }\r\n\r\n            return {info: rCmdInfo, index: rIndex};\r\n        },\r\n\r\n\t\tremoveInputView: function (layer) {\r\n            if (layer.inputElement) {\r\n                layer.inputElement.destroy();\r\n            }\r\n            else if (layer.children && layer.children.length) {\r\n                for (let i = 0; i < layer.children.length; i++) {\r\n                    this.removeInputView(layer.children[i]);\r\n                }\r\n            }\r\n        },\r\n\r\n        removeViewTimer: function (view) {\r\n            if (view.viewType === 'TIMER') {\r\n                if (view.timerType === 'timeOut') {\r\n                    clearTimeout(view.timerHandler);\r\n                } else {\r\n                    clearInterval(view.timerHandler);\r\n                }\r\n                return;\r\n            }\r\n            else {\r\n                view.children.forEach(v => this.removeViewTimer(v));\r\n            }\r\n        },\r\n\r\n\t\tfilterInexistentPlotViews: function (views, plotInfo) {\r\n\t\t\t// 过滤高级剧情中已移除的高级UI\r\n\t\t\tif (!plotInfo.commands || 0 === plotInfo.commands.length) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst isUuidExist = (uuid, cmdInfo) => {\r\n\t\t\t\tfor (let i=0; i<cmdInfo.length; i++) {\r\n\t\t\t\t\tif (cmdInfo[i].uuid === uuid) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if ('options' === cmdInfo[i].type || 'conditionOptions' === cmdInfo[i].type) {\r\n\t\t\t\t\t\tfor (let j=0; j<cmdInfo[i].args.length; j++) {\r\n\t\t\t\t\t\t\tif (isUuidExist(uuid, cmdInfo[i].args[j].commands)) {\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\t\t\tfor (let i=0; i<views.length; i++) {\r\n\t\t\t\tif (!views[i].generateType) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tconst cmdUuid = views[i].generateType;\r\n\t\t\t\tif (isUuidExist(cmdUuid, plotInfo.commands)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tviews.splice(i, 1);\r\n\t\t\t\ti--;\r\n\t\t\t}\r\n        },\r\n\r\n\t\tdestroyAll: function () {\r\n            this.playBackLayer.removeAll(true);\r\n            this.globalViews && this.globalViews.forEach(s => {\r\n                this.removeInputView(s);\r\n                s.destroy && s.destroy()\r\n            });\r\n            this.globalViews = null;\r\n            this.plotViewsLayer.children.forEach(c => {\r\n\t\t\t\tthis.removeViewTimer(c);\r\n            \tthis.removeInputView(c)\r\n            });\r\n            this.plotViewsLayer.removeAll(true);\r\n            if ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n            \tPhoneUtils.stopMusic();\r\n            \tPhoneUtils.removeAudioUrl(PhoneUtils.musicInfo.key);\r\n            \t\r\n            \tfor (let i=0; i<10; i++) {\r\n            \t\tif (PhoneUtils.soundsInfo[i].key) {\r\n            \t\t\tPhoneUtils.stopSound(i);\r\n            \t\t\tPhoneUtils.removeAudioUrl(PhoneUtils.soundsInfo[i].key);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n                this.bk_music && this.bk_music.destroy();\r\n                this.bk_music = null;\r\n                this.plotSounds && this.plotSounds.forEach(s => s && s.destroy());\r\n                this.plotSounds = [];\r\n\t\t\t}\r\n\r\n            if (this.lstPlotLayer) {\r\n                this.lstPlotLayer.destroy();\r\n                this.lstPlotLayer = null;\r\n            }\r\n        },\r\n\r\n\t\treStart: function (isextend = false) {\r\n            //重播调用app  结束接口\r\n            /*if (flashvars.client === 'ios') {\r\n                if(flashvars.offline === 1){\r\n                    javascript:workFinished('1');\r\n                }else{\r\n                    window.webkit && window.webkit.messageHandlers.workFinished.postMessage('1');\r\n                }\r\n            }\r\n            else if (flashvars.client === 'android') {\r\n                window.app && window.app.workFinished('1');\r\n            }*/\r\n            this.dialogLayer.visible = false;\t\t// 隐藏对话框层\r\n\t\t\tthis.unlockChapterCallBack = null;\t\t// 清除解锁回调\r\n\t\t\tthis.mallPayCallback = null;\r\n\t\t\tthis.destroyAll();\r\n            if (this.bubbleLayer.children.length > 0){\r\n                this.bubbleLayer.removeAll(true);\r\n            }\r\n            this.saveBubbleVector = [];\r\n            this.bubbleArchivalCount = [];\r\n\t\t\tthis.initContext(this.context);\r\n            const back = ()=>{\r\n                if (!this.json_data.cover.hidden) {\r\n                    return this.showCover();// 创建封面\r\n                } else {\r\n                    const chapter = this.findFirstChapter();\r\n                    const chapterUuid = chapter.downloadUuid ? chapter.downloadUuid : chapter.uuid;\r\n\r\n                    //第三方\r\n                    if(this.isWapOther()){\r\n                        this.checkIfChapterFree(chapterUuid, chapter.md5).then((plots)=>{\r\n                            chapter.plots.push(...plots);\r\n                            this.preloadChapterAssets(this.context, chapter,undefined,undefined,undefined,true);\r\n                        },(msg)=>{\r\n                            //章节需要付费\r\n                            if (-1 === msg.indexOf('code=87')) {\r\n                                Dialog.error(msg);\r\n                            } else { // 未购买此章节\r\n                                this.unlockChapterByWapOther(chapterUuid, chapter.charge, chapter.md5, null)\r\n                            }\r\n                        });\r\n                        return;\r\n                    }\r\n\r\n                    if (chapter.md5 && chapter.plots.length === 0) {\r\n                        if (chapter.charge && ('android' === flashvars.client || 'ios' === flashvars.client || flashvars.client === 'wap')) {\r\n                            const unlockFinish = (bSuccess) => {\r\n                                if (bSuccess) {\r\n                                    this.checkIfChapterFree(chapterUuid, chapter.md5).then((plots)=>{\r\n                                        this.unlockChapterCallBack = null;\r\n                                        chapter.plots = plots;\r\n                                        this.preloadChapterAssets(this.context, chapter,undefined,undefined,undefined,true);\r\n                                    }, () => {\r\n                                        if(flashvars.client === 'wap'){\r\n                                            window.parent && window.parent.playLogin();\r\n                                        }else{\r\n                                            Dialog.error('获取付费章节信息失败')\r\n\t\t\t\t\t\t\t\t\t\t}\r\n                                    })\r\n                                }\r\n                            };\r\n\r\n                            this.unlockChapter(chapterUuid, chapter.charge, chapter.md5, unlockFinish);\r\n                        } else {\r\n                            this.checkIfChapterFree(chapterUuid, chapter.md5).then((plots)=>{\r\n                                chapter.plots = plots;\r\n                                this.preloadChapterAssets(this.context, chapter,undefined,undefined,undefined,true);\r\n                            }, (msg)=>{\r\n                                if (-1 === msg.indexOf('code=87')) {\r\n                                    Dialog.error(msg);\r\n                                } else { // 未购买此章节\r\n                                    if(flashvars.wap === 'zxwwap'){\r\n                                        Dialog.info('当前为收费章节，是否前往闪艺抢先体验？').then(()=>{\r\n                                            window.location.href = 'https://wap.3000.com/?m=detail&op=index&ac=index&id='+ flashvars.gid;\r\n                                        })\r\n                                    }else{\r\n                                        Dialog.info('当前为收费章节，请前往闪艺app或电脑端进行购买');\r\n\t\t\t\t\t\t\t\t\t}\r\n                                }\r\n                            })\r\n                        }\r\n                    } else {\r\n                        this.preloadChapterAssets(this.context, chapter,undefined,undefined,undefined,true);\r\n                    }\r\n                }\r\n            };\r\n\t\t\tif(isextend !== false){\r\n\t\t\t\t//推广返回封面\r\n\t\t\t\tDialog.custom(\"Info\",\"没体验够？下载闪艺APP，继续玩！\",\"提示\",\"下载闪艺\",\"取消\").then(()=>{\r\n                    window.location.href = \"http://app.3000.com/\"\r\n\t\t\t\t},(rj)=>{\r\n\t\t\t\t\tback();\r\n\t\t\t\t})\r\n\t\t\t}else{\r\n\t\t\t\tback();\r\n\t\t\t}\r\n\t\t},\r\n        /**\r\n\t\t * 同步最新的消费数值\r\n         */\r\n        updatePayValue:function (context,values,isstep = false,isafterpay = false) {\r\n        \tif(isstep === true || isafterpay === true){\r\n        \t\treturn Promise.resolve(true); //定时器触发和购买后的数值操作   不用再同步\r\n\t\t\t}\r\n            //判断数值操作中是否有消费数值操作\r\n            const haspayvalue = () =>{\r\n                if(values && values.length > 0){\r\n                    for(let i = 0; i< values.length;i++){\r\n                        let index1 = -1;\r\n                        if(context.payValues.findIndex(v => v.uuid === values[i].uuid) !== -1){//有消费数值\r\n                            return true;\r\n                        }\r\n                        if(context.indexValues && (index1 = context.indexValues.findIndex(v => v.uuid === values[i].uuid)) !== -1){//有消费数值\r\n                            if(context.indexValues[index1].init.type === 'payValue'){\r\n                                return true;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                return false;\r\n            };\r\n            return new Promise((resolve,reject) =>{\r\n                if(haspayvalue()){\r\n                    this.getPayInfo().then((rs)=>{\r\n                        if (Object.prototype.toString.apply(rs) !== '[object String]' && flashvars.uid !== '') {\r\n                            this.isLineUpdatePaySuccess = true;\r\n                            context.payValues = JSON.parse(JSON.stringify(this.context.payValues));\r\n                            return resolve(true);\r\n                        }else{\r\n                            this.isLineUpdatePaySuccess = false;\r\n                            if(rs.indexOf('获取用户信息权限错误') !== -1){\r\n                                //没有网络\r\n                                Dialog.info('当前网络信号差，商城、成就等账号功能无法正常使用，请检查网络设置后，重新打开作品').then(null,null)\r\n                                return resolve(false)\r\n                            }else{\r\n                                //有网同步失败\r\n                                return resolve(true);\r\n                            }\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n                }else{\r\n                    return resolve(true);\r\n                }\r\n\t\t\t})\r\n        },\r\n        /**\r\n\t\t * 数值操作\r\n         * @param context\t\t\tcontext\r\n         * @param values\t\t\t数值\r\n         * @param bCancelUpload\t\t是否上传保存分数  (pay数值预算 true)\r\n         * @param callback\t\t\t数值操作回调函数\r\n         */\r\n\t\tvalueOperation: function (context, values, bCancelUpload,callback=null,ispay=false) {\r\n\t\t\tthis.isSetValues = true;//数值操作中\r\n            let isupload = false;//是否需要上传数值\r\n            let normalValue = [], savedValue = [], stringValue = [], payValue = [];\r\n            //记录原先值\r\n            const saveprevalues = ()=>{\r\n                for (let j=0; j<context.values.length; j++) { normalValue[j] = context.values[j].value }\r\n                for (let j=0; j<context.savedValues.length; j++) { savedValue[j] = context.savedValues[j].value }\r\n                for (let j=0; j<context.stringValues.length; j++) { stringValue[j] = context.stringValues[j].value }\r\n                for (let j=0; j<context.payValues.length; j++) { payValue[j] = context.payValues[j].value }\r\n            }\r\n            //恢复\r\n            const recovervalues = () => {\r\n                for (let j=0; j<normalValue.length; j++) { context.values[j].value = normalValue[j] }\r\n                for (let j=0; j<savedValue.length; j++) { context.savedValues[j].value = savedValue[j] }\r\n                for (let j=0; j<stringValue.length; j++) { context.stringValues[j].value = stringValue[j] }\r\n                for (let j=0; j<payValue.length; j++) { context.payValues[j].value = payValue[j] }\r\n            }\r\n\t\t\t//上传保存数值\r\n\t\t\tconst uploadPayValue = ()=>{\r\n            \tif(flashvars.single && flashvars.offline === '1'){\r\n                    return this.savePayInfo().then(()=>{ return this.saveAccountInfo()})\r\n\t\t\t\t}else{\r\n                    //上传payvalue 数值\r\n                    if(!isupload){return Promise.reject()};//没有payvalue操作 无需上传数值\r\n                    if(flashvars.u === '' && flashvars.token === '' && flashvars.client === ''){\r\n                        let uid = Utils.getUidByCookie();\r\n                        if (uid !== flashvars.uid && uid !== ''){\r\n                            //同步数值\r\n                            flashvars.uid = uid;\r\n                            this.localRecFileToUidRecFile(false);\r\n                            this.getPayInfo().then(() => {\r\n                                this.getAccountInfo();\r\n                            });\r\n                            return Promise.reject();\r\n                        }else{\r\n                            if(!bCancelUpload){return this.savePayInfo()}else{return Promise.reject()} ;\r\n                        }\r\n                    }else{\r\n                        if(flashvars.client === 'wap' && flashvars.uid === ''){\r\n                            return this.getUserInfoFromWap().then(()=>{\r\n                                if(!bCancelUpload){return this.savePayInfo()}else{\r\n                                    return Promise.reject()\r\n                                };\r\n                            })\r\n                        }\r\n                        if(!bCancelUpload){return this.savePayInfo()}else{\r\n                            return Promise.reject()\r\n                        };\r\n                    }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//\r\n\t\t\tconst indexValueOperator = (index, v, reference) => {\r\n\t\t\t\tif (!reference) {\r\n\t\t\t\t\tif (v < 1) {\r\n                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n\t\t\t\t\t}\r\n                    else if (context.indexValues[index].init.type === 'value' && v>context.values.length) {\r\n                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (context.indexValues[index].init.type === 'savedValue' && v>context.savedValues.length) {\r\n                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (context.indexValues[index].init.type === 'stringValue' && v>context.stringValues.length) {\r\n                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (context.indexValues[index].init.type === 'payValue' && v>context.payValues.length) {\r\n                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcontext.indexValues[index].value = v;\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\r\n                const i = context.indexValues[index].value === undefined ? context.indexValues[index].init.value-1 : context.indexValues[index].value-1;\r\n\t\t\t\tif (context.indexValues[index].init.type === 'value') {\r\n\t\t\t\t\tif (i<0 || i>=context.values.length) {\r\n\t\t\t\t\t\tDialog.info('出现未知数值操作，请联系作者检查修改');\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n                    context.values[i].value = v;\r\n\t\t\t\t}\r\n                else if (context.indexValues[index].init.type === 'savedValue') {\r\n                    if (i<0 || i>=context.savedValues.length) {\r\n                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n                        return;\r\n                    }\r\n                    context.savedValues[i].value = v;\r\n                }\r\n                else if (context.indexValues[index].init.type === 'stringValue') {\r\n                    if (i<0 || i>=context.stringValues.length) {\r\n                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n                        return;\r\n                    }\r\n                    context.stringValues[i].value = v;\r\n                }\r\n                else if (context.indexValues[index].init.type === 'payValue') {\r\n                    if (i<0 || i>=context.payValues.length) {\r\n                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n                        return;\r\n                    }\r\n                    isupload = true;\r\n                    context.payValues[i].value = v;\r\n                    //payValueOperator(i, v);\r\n                }\r\n\t\t\t};\r\n\t\t\t//判断数值操作中是否有消费数值操作\r\n\t\t\tconst haspayvalue = () =>{\r\n                if(values && values.length > 0){\r\n                \tfor(let i = 0; i< values.length;i++){\r\n                \t\tlet index1 = -1;\r\n                \t\tif(context.payValues.findIndex(v => v.uuid === values[i].uuid) !== -1){//有消费数值\r\n                \t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n                        if(context.indexValues && (index1 = context.indexValues.findIndex(v => v.uuid === values[i].uuid)) !== -1){//有消费数值\r\n                            if(context.indexValues[index1].init.type === 'payValue'){\r\n                            \treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tif (values && values.length > 0) {\r\n\t\t\t\tlet i = 0;\r\n\t\t\t\tconst isnext = (i)=>{\r\n\t\t\t\t\tif(i >= values.length - 1){\r\n\t\t\t\t\t\t//数值已操作完成\r\n\t\t\t\t\t\tuploadPayValue().then(()=>{\r\n\t\t\t\t\t\t\t//上传成功\r\n\t\t\t\t\t\t\tthis.isSetValues = false;\r\n                            callback && callback(context);\r\n\t\t\t\t\t\t},()=>{\r\n\t\t\t\t\t\t\t//没有上传或者上传失败\r\n\t\t\t\t\t\t\tif(isupload && !ispay && !bCancelUpload){\r\n                                //上传失败，恢复数值\r\n                                recovervalues();\r\n\t\t\t\t\t\t\t}\r\n                            this.isSetValues = false;\r\n                            callback && callback(context);\r\n\t\t\t\t\t\t})//上传数值\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn i < values.length - 1;\r\n\t\t\t\t}\r\n\t\t\t\tconst setvalues = (i)=>{\r\n                    let value = values[i];\r\n                    const v = this.Expression.safeEval(value.expression, this.context);\r\n                    const uuid = value.uuid;\r\n                    let index;\r\n                    if ((index = this.context.values.findIndex(v => v.uuid === uuid)) !== -1) {\r\n                        context.values[index].value = v;\r\n                        isnext(i) && setvalues(i+=1);\r\n                    }\r\n                    else if ((index = this.context.savedValues.findIndex(v => v.uuid === uuid)) !== -1) {\r\n                        context.savedValues[index].value = v;\r\n                        Utils.localStorageSetItem(flashvars.uuid + 'savedValues' + flashvars.uid, JSON.stringify(context.savedValues));\r\n                        isnext(i) && setvalues(i+=1);\r\n                    }\r\n                    else if ((index = this.context.stringValues.findIndex(v => v.uuid === uuid)) !== -1) {\r\n                        context.stringValues[index].value = v;\r\n                        isnext(i) && setvalues(i+=1);\r\n                    }\r\n                    else if ((index = this.context.payValues.findIndex(v => v.uuid === uuid)) !== -1) {\r\n                        context.payValues[index].value = v;\r\n                        isupload = true;\r\n                        isnext(i) && setvalues(i+=1)\r\n                        //payValueOperator(index, v).then(()=>{isnext(i) && setvalues(i+=1);},()=>{isnext(i) && setvalues(i+=1);});\r\n                    }\r\n                    else if ((index = this.context.indexValues.findIndex(v => v.uuid === uuid)) !== -1) {\r\n                        indexValueOperator(index, v, value.reference);\r\n                        isnext(i) && setvalues(i+=1);\r\n                    }\r\n                    else {\r\n                        console.error('Cannot find value/savedValue with uuid = ', uuid);\r\n                        isnext(i) && setvalues(i+=1);\r\n                    }\r\n\t\t\t\t};\r\n\t\t\t\tif(flashvars.single && flashvars.offline === '1'){\r\n                    setvalues(i)\r\n\t\t\t\t}else{\r\n                    if(haspayvalue()){\r\n                        //有消费数值操作\r\n                        if(bCancelUpload || ispay){\r\n                            if(bCancelUpload){\r\n                                context = JSON.parse(JSON.stringify(context));\r\n                            }\r\n                        \t//预算值\r\n                            if(ispay) saveprevalues(); //记录起初的数值\r\n                            setvalues(i);\r\n                        }else{\r\n                            saveprevalues(); //记录起初的数值\r\n                            setvalues(i);\r\n                        }\r\n                    }else{\r\n                        setvalues(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n                if(callback !== null) {this.isSetValues = false;callback(context)}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tupdateValues: function (oldContext) {\r\n\t\t\tlet tempValues = JSON.parse(JSON.stringify(this.json_data.values));\r\n\t\t\tfor (let i=0; i<oldContext.values.length; i++) {\r\n\t\t\t\tfor (let j=0; j<tempValues.length; j++) {\r\n\t\t\t\t\tif (tempValues[j].uuid === oldContext.values[i].uuid) {\r\n\t\t\t\t\t\ttempValues[j].value = oldContext.values[i].value;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\toldContext.values = tempValues.concat();\r\n\r\n\t\t\ttempValues = JSON.parse(JSON.stringify(this.json_data.savedValues));\r\n            for (let i=0; i<oldContext.savedValues.length; i++) {\r\n                for (let j=0; j<tempValues.length; j++) {\r\n                    if (tempValues[j].uuid === oldContext.savedValues[i].uuid) {\r\n                        tempValues[j].value = oldContext.savedValues[i].value;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            oldContext.savedValues = tempValues.concat();\r\n\r\n            tempValues = JSON.parse(JSON.stringify(this.json_data.stringValues));\r\n            for (let i=0; i<oldContext.stringValues.length; i++) {\r\n                for (let j=0; j<tempValues.length; j++) {\r\n                    if (tempValues[j].uuid === oldContext.stringValues[i].uuid) {\r\n                        tempValues[j].value = oldContext.stringValues[i].value;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            oldContext.stringValues = tempValues.concat();\r\n\r\n            if (this.json_data.payValues) {\r\n                tempValues = JSON.parse(JSON.stringify(this.json_data.payValues));\r\n                if (oldContext.payValues) {\r\n                    for (let i=0; i<oldContext.payValues.length; i++) {\r\n                        for (let j=0; j<tempValues.length; j++) {\r\n                            if (tempValues[j].uuid === oldContext.payValues[i].uuid) {\r\n                                tempValues[j].value = oldContext.payValues[i].value;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n\t\t\t\t}\r\n                oldContext.payValues = tempValues.concat();\r\n            }\r\n\r\n            if (this.json_data.indexValues) {\r\n                tempValues = JSON.parse(JSON.stringify(this.json_data.indexValues));\r\n                if (oldContext.indexValues) {\r\n                    for (let i=0; i<oldContext.indexValues.length; i++) {\r\n                        for (let j=0; j<tempValues.length; j++) {\r\n                            if (tempValues[j].uuid === oldContext.indexValues[i].uuid) {\r\n                                tempValues[j].value = oldContext.indexValues[i].value;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                oldContext.indexValues = tempValues.concat();\r\n\t\t\t}\r\n\r\n        },\r\n\r\n\t\tinitContext: function (oldContext, isLoad) {\r\n\t\t\tconst copy = (obj) => {\r\n\t\t\t\tif (!obj) {\r\n\t\t\t\t\treturn obj;\r\n\t\t\t\t}\r\n\t\t\t\treturn JSON.parse(JSON.stringify(obj))\r\n\t\t\t};\r\n\t\t\tconst context = {};\r\n\t\t\tisLoad && this.updateValues(oldContext);\r\n\t\t\tcontext.auto = this.context && this.context.auto || false;\r\n\t\t\tcontext.fullScreen = this.context && this.context.fullScreen || false;\r\n            context.savedValues = copy(oldContext && oldContext.savedValues || this.json_data.savedValues);\r\n            if (!oldContext && !isLoad) {\r\n                const strSavedValues = Utils.localStorageGetItem(flashvars.uuid + 'savedValues' + flashvars.uid);\r\n                if (strSavedValues) {\r\n                    const lstSavedValues = JSON.parse(strSavedValues);\r\n                    for (let i=0; i<lstSavedValues.length; i++) {\r\n                    \tfor (let j=0; j<context.savedValues.length; j++) {\r\n                    \t\tif (context.savedValues[j].uuid === lstSavedValues[i].uuid) {\r\n                    \t\t\tcontext.savedValues[j].value = lstSavedValues[i].value;\r\n                    \t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n                }\r\n\t\t\t}\r\n            if (isLoad) {\r\n                context.values = copy(oldContext.values);\r\n                context.stringValues = copy(oldContext.stringValues);\r\n                context.payValues = copy(this.context.payValues);\r\n                context.indexValues = copy(oldContext.indexValues);\r\n            }\r\n            else {\r\n                context.values = copy(this.json_data.values);\r\n                context.stringValues = copy(this.json_data.stringValues);\r\n                context.payValues = copy(this.json_data.payValues ? this.json_data.payValues : this.context.payValues);\r\n                context.indexValues = copy(this.json_data.indexValues ? this.json_data.indexValues : this.context.indexValues);\r\n                for (let i=0; i<context.payValues.length; i++) {\r\n                \tfor (let j=0; j<this.context.payValues.length; j++) {\r\n                        if (context.payValues[i].uuid === this.context.payValues[j].uuid) {\r\n                            context.payValues[i].value = this.context.payValues[j].value;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (this.json_data.systemValues) {\r\n                context.systemValues = copy(this.json_data.systemValues);\r\n                if (context.systemValues.length===1) {\r\n                    context.systemValues = context.systemValues.concat([{},{},{},{},{},{},{},{},{},{}]);\r\n\t\t\t\t} else if (context.systemValues.length===9) {\r\n                    context.systemValues = context.systemValues.concat([{},{}]);\r\n\t\t\t\t} else if (context.systemValues.length===10) {\r\n                \tcontext.systemValues = context.systemValues.concat([{}]);\r\n\t\t\t\t}\r\n                context.systemValues[0].value = this.context.systemValues[0].value;\r\n                context.systemValues[1].value = this.context.systemValues[1].value;\r\n                context.systemValues[9].value = this.context.systemValues[9].value;\r\n            }\r\n\t\t\telse {\r\n                context.systemValues = copy(this.context.systemValues);\r\n\t\t\t}\r\n\r\n\t\t\tif (-1 === Utils.timeStamp) {\r\n                Utils.getTimeOffset().then(() => {Utils.updateContextTimeValues(context)}, null);\r\n            }\r\n            else {\r\n                let date = new Date(Utils.timeStamp * 1000);\r\n                context.systemValues[2].value = Utils.timeStamp;\r\n                context.systemValues[3].value = date.getFullYear();\r\n                context.systemValues[4].value = date.getMonth() + 1;\r\n                context.systemValues[5].value = date.getDate();\r\n                context.systemValues[6].value = date.getHours();\r\n                context.systemValues[7].value = date.getMinutes();\r\n                context.systemValues[8].value = date.getSeconds();\r\n                context.systemValues[10].value = date.getDay();\r\n\t\t\t}\r\n\r\n            if (isLoad && oldContext && oldContext.stack) {\r\n                context.stack = copy(oldContext.stack);\r\n\t\t\t\tcontext.cmdStack = copy(oldContext.cmdStack);\r\n            } else {\r\n                context.stack = [];\r\n                context.cmdStack = [];\r\n            }\r\n\t\t\tthis.context = context;\r\n\t\t},\r\n\r\n\t\tdoInCT: function (context, func) {\r\n\t\t\tif (context !== this.context) {\r\n\t\t\t\treturn Promise.reject('timeline changed');\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn func();\r\n\t\t\t}\r\n\t\t},\r\n\r\n        txtLineSpace: function (fontSize) {\r\n            let space = 0;\r\n            if (fontSize==12 || fontSize==14 || fontSize==16 || fontSize==18) space = -4 + fontSize / 2;\r\n            else if (fontSize < 19) space = -5 + fontSize / 2;\r\n            else if (fontSize < 28) space = -6 + fontSize / 2;\r\n            else if (fontSize < 37) space = -7 + fontSize / 2;\r\n            else if (fontSize < 46) space = -9 + fontSize / 2;\r\n            else if (fontSize < 56) space = -10 + fontSize / 2;\r\n            else space = (-Math.ceil(fontSize / 5)) + fontSize / 2;\r\n            !this.viewComponent.game.device.desktop && (space -= 2);\r\n            return space;\r\n        },\r\n\r\n\t\t/**更新music声音大小*/\r\n\t\tupdateMusicVolume:function (volume) {\r\n\t\t\tUtils.musicVolume = volume;\r\n            if ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n                PhoneUtils.updateMusicVolume('music',volume);\r\n            }else{\r\n                if(this.bk_music){\r\n                \tif(this.bk_music.prevolume === 0 && this.bk_music.volume !== 0){\r\n                        //还在动画中，有声音，记录的原始声音为0时\r\n                        this.bk_music.prevolume = this.bk_music.volume;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 如果存在插播音量\r\n\t\t\t\t\tlet value = (this.bk_music.inheritvolume !== undefined && this.bk_music.inheritvolume !== -1)  ? this.bk_music.inheritvolume * volume : this.bk_music.prevolume * volume;\r\n                    this.bk_music.volume  = value;\r\n                    for(let i = 0; i<this.lstPlotTweens.length;i++ ){\r\n                        let tween = this.lstPlotTweens[i];\r\n                        if(tween.target && (tween.target.animateMusic === 'music')){\r\n                            tween.pause();\r\n                            tween.stop(true);\r\n                        }\r\n                    }\r\n                }\r\n\t\t\t}\r\n\r\n        },\r\n        /**更新sound声音大小*/\r\n\t\tupdateSoundVolume:function (volume) {\r\n\t\t\tUtils.soundVolume = volume;\r\n            if('ios' === flashvars.client && '1.5.0' <= flashvars.app_version){\r\n                PhoneUtils.updateSoundVolume('sound',volume)\r\n            }else{\r\n                if(this.plotSounds && this.plotSounds.length > 0){\r\n                    for(let i =0; i< this.plotSounds.length;i++){\r\n                        let s = this.plotSounds[i];\r\n                        if(s){\r\n                            if(s.prevolume === 0 && s.volume !== 0){\r\n                                //还在动画中，有声音，记录的原始声音为0时\r\n                                s.prevolume = s.volume;\r\n                            }\r\n                            let value = (s.inheritvolume !== undefined && s.inheritvolume !== -1) ? s.inheritvolume * volume : s.prevolume * volume;\r\n\t\t\t\t\t\t\ts.volume = value;\r\n                        }\r\n                    }\r\n                }\r\n                for(let i = 0; i<this.lstPlotTweens.length;i++ ){\r\n                    let tween = this.lstPlotTweens[i];\r\n                    if(tween.target && (tween.target.animateMusic === 'sound')){\r\n                        tween.pause();\r\n                        tween.stop(true);\r\n                    }\r\n                }\r\n\t\t\t}\r\n\r\n        },\r\n\r\n\t\tstopMusic: function (nextToPlay, isViewEvent = false) {\r\n            if ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n            \tPhoneUtils.stopMusic(!isViewEvent);\r\n            } else {\r\n                if (nextToPlay && this.bk_music && nextToPlay === this.bk_music.key) {\r\n                    this.bk_music.stop();\r\n                } else if (this.bk_music) {\r\n                    this.bk_music.destroy();\r\n                    this.bk_music = null;\r\n                    this.decodeCacheAudio(nextToPlay);\r\n                }\r\n\t\t\t}\r\n\r\n            !isViewEvent && ResourcesManager.updateUsingKey({type:'music', key: ''});\r\n        },\r\n\r\n\t\tplayMusic: function (key, volume, loop, isViewEvent = false) {\r\n            ResourcesManager.updateUsingKey({type:'music', key});\r\n\t\t\tif ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n\t\t\t\tPhoneUtils.playMusic(key, volume, loop,Utils.musicVolume);\r\n\t\t\t} else {\r\n                if (!this.bk_music || key !== this.bk_music.key) {\r\n                    this.bk_music = this.viewComponent.game.add.sound(key, volume, loop);\r\n                    this.bk_music.prevolume = volume;\r\n                    this.bk_music.inheritvolume = -1;\r\n                }\r\n                this.bk_music.play();\r\n                this.bk_music.volume = this.bk_music.prevolume * Utils.musicVolume\r\n\t\t\t}\r\n        },\r\n\r\n\t\tplayInheritMusic: function (volume) {\r\n            if ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n            \tPhoneUtils.playInheritMusic(volume,Utils.musicVolume);\r\n            } else {\r\n                if (this.bk_music && volume !== undefined) {\r\n                \tthis.bk_music.inheritvolume = volume;//记录声音插播的音量\r\n                    this.bk_music.volume = volume * Utils.musicVolume;\r\n                }\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tstopSound: function (index, nextToPlay, isViewEvent = false) {\r\n\t\t\tif (null === index || undefined === index) return;\r\n            if ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n            \tPhoneUtils.stopSound(index);\r\n            } else {\r\n            \tif(index === -1){\r\n            \t\t//停止所有音效\r\n\t\t\t\t\tfor(let i = 0;i < this.plotSounds.length;i++){\r\n\t\t\t\t\t\tlet s = this.plotSounds[i];\r\n\t\t\t\t\t\tif(s){\r\n                            s.stop();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n                    if (nextToPlay && this.plotSounds[index] && nextToPlay === this.plotSounds[index].key) {\r\n                        this.plotSounds[index].stop();\r\n                    } else if (this.plotSounds[index]) {\r\n                        this.plotSounds[index].destroy();\r\n                        this.plotSounds[index] = null;\r\n                        this.decodeCacheAudio(nextToPlay);\r\n                    }\r\n\t\t\t\t}\r\n\r\n            }\r\n\r\n            !isViewEvent && ResourcesManager.updateUsingKey({type:'sound', key: '', index});\r\n        },\r\n\r\n\t\tplaySound: function (index, key, volume, loop, isViewEvent = false) {\r\n            ResourcesManager.updateUsingKey({type:'sound', key, index});\r\n\t\t\tif ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n\t\t\t\tPhoneUtils.playSound(index, key, volume, loop,Utils.soundVolume);\r\n\t\t\t} else {\r\n                if (!this.plotSounds[index] || this.plotSounds[index].key !== key) {\r\n                    this.plotSounds[index] = this.viewComponent.game.add.sound(key, volume, loop);\r\n                    this.plotSounds[index].prevolume = volume;\r\n                    this.plotSounds[index].inheritvolume = -1;\r\n                    this.plotSounds[index].volume *= Utils.soundVolume;\r\n                }\r\n                this.plotSounds[index].play();\r\n\t\t\t}\r\n        },\r\n\r\n\t\tplayInheritSound: function (index, volume) {\r\n\t\t\tif ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n\t\t\t\tPhoneUtils.playInheritSound(index, volume,Utils.soundVolume);\r\n\t\t\t} else {\r\n                if (this.plotSounds[index] && volume !== undefined) {\r\n                    this.plotSounds[index].inheritvolume = volume;\r\n                    this.plotSounds[index].volume *= Utils.soundVolume;\r\n                }\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tdecodeCacheAudio: function (nextToPlay) {\r\n\t\t\tif (nextToPlay) {\r\n\t\t\t\tlet sound = this.viewComponent.game.load.cache.getSound(nextToPlay);\r\n\t\t\t\tif (sound && !sound.decoded && !sound.isDecoding) {\r\n\t\t\t\t\tthis.viewComponent.game.sound.decode(nextToPlay);\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tlet countDecoded = 0;\r\n            let audioKeys = this.viewComponent.game.load.cache.getKeys(Phaser.Cache.SOUND);\r\n\t\t\tfor (let i in audioKeys) {\r\n\t\t\t\tlet sound = this.viewComponent.game.load.cache.getSound(audioKeys[i]);\r\n\t\t\t\tif (sound.decoded || sound.isDecoding) countDecoded++;\r\n\t\t\t\tif (countDecoded > 4) return;\r\n\t\t\t}\r\n            audioKeys.some(k => {\r\n                let sound = this.viewComponent.game.load.cache.getSound(k);\r\n                if (!sound.decoded && !sound.isDecoding) {\r\n                \tthis.viewComponent.game.sound.decode(k);\r\n                \treturn true;\r\n\t\t\t\t} else {\r\n                \treturn false;\r\n\t\t\t\t}\r\n            })\r\n        },\r\n\r\n\t\ttoRealImageFontHeight: function(size) {\r\n            const t = this.json_data.font.size.target.height ? this.json_data.font.size.target.height : this.json_data.font.size.target;\r\n            return (parseFloat(size) * t / this.json_data.font.size.source);\r\n\t\t},\r\n\r\n\t\ttoRealImageFontWidth: function (size) {\r\n            const t = this.json_data.font.size.target.width ? this.json_data.font.size.target.width : this.json_data.font.size.target;\r\n            return (parseFloat(size) * t / this.json_data.font.size.source);\r\n        },\r\n\r\n        isWap3000: function(){\r\n            if(flashvars.wap === \"3000\"){\r\n            \treturn true;\r\n\t\t\t}else{\r\n            \treturn false;\r\n\t\t\t}\r\n        },\r\n\t\t/**是否来自第三方*/\r\n\t\tisWapOther:function () {\r\n\t\t\tif (flashvars.wap !== \"3000\" && flashvars.wap !== \"zxwwap\" && flashvars.wap !== \"4399\" && flashvars.wap !== \"\"){\r\n\t\t\t\treturn true;\r\n\t\t\t}else{\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n        },\r\n\t\t//是否为推广\r\n\t\tisExtend:function () {\r\n\t\t\tif(flashvars.extend !== \"\"){\r\n\t\t\t\treturn true;\r\n\t\t\t}else{\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n        },\r\n\t\t//是否显示本地存档按钮\r\n\t\tisShowLocalBtn:function (){\r\n\t\t\tif(this.isWapOther()/*第三方来源（联运）不显示本地存档按钮*/){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\t//是否显示云存档按钮\r\n\t\tisShowCloudBtn:function (){\r\n\t\t\tif(this.isExtend()/*推广，不显示云存档按钮*/\r\n\t\t\t || flashvars.wap === \"zxwwap\" /*wap为在线完时*/\r\n\t\t\t || this.isWapOther() /*第三方来源取消云存档按钮*/\r\n\t\t\t || (flashvars.single) /*独立离线播放器*/){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\tExpression: class {\r\n\r\n\t\t\tstatic isString(data) {\r\n\t\t\t\treturn Object.prototype.toString.apply(data) === '[object String]';\r\n\t\t\t}\r\n\r\n\t\t\tstatic isArray(data) {\r\n\t\t\t\treturn Object.prototype.toString.apply(data) === '[object Array]';\r\n\t\t\t}\r\n\r\n\t\t\tstatic toN(x) {\r\n\t\t\t\tconst n = Number(x);\r\n\t\t\t\tif (isNaN(n)) {\r\n\t\t\t\t\tconsole.warn(`${x} is not a number`);\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn n;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tstatic toInt(x, radix = 10) {\r\n\t\t\t\tconst n = parseInt(x, radix);\r\n\t\t\t\tif (isNaN(n)) {\r\n\t\t\t\t\tconsole.warn(`${x} is not a int`);\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn n;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tstatic toWeek(x) {\r\n\t\t\t\tswitch (x)\r\n\t\t\t\t{\r\n\t\t\t\t\tcase 0: return 7;//'星期天';\r\n\t\t\t\t\tdefault: return x;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tstatic safeEval(expr, context) {\r\n\r\n\t\t\t\tconst evaluate = (expr, context) => {\r\n\t\t\t\t\tlet arg1;\r\n\t\t\t\t\tlet arg2;\r\n\t\t\t\t\tlet value;\r\n\t\t\t\t\tswitch (expr.type) {\r\n\t\t\t\t\t\tcase \"arg1\":\r\n\t\t\t\t\t\t\treturn evaluate(expr.arg1, context);\r\n\t\t\t\t\t\tcase \"+\":\r\n\t\t\t\t\t\t\targ1 = evaluate(expr.arg1, context);\r\n\t\t\t\t\t\t\targ2 = evaluate(expr.arg2, context);\r\n\t\t\t\t\t\t\tif (this.isString(arg1) || this.isString(arg2)) {\r\n\t\t\t\t\t\t\t\treturn ('#' + arg1 + arg2).slice(1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn this.add(evaluate(expr.arg1, context), evaluate(expr.arg2, context));\r\n\t\t\t\t\t\tcase \"-\":\r\n\t\t\t\t\t\t\targ1 = evaluate(expr.arg1, context);\r\n\t\t\t\t\t\t\targ2 = evaluate(expr.arg2, context);\r\n\t\t\t\t\t\t\tif (this.isString(arg1) || this.isString(arg2)) {\r\n\t\t\t\t\t\t\t\treturn (arg1 + '').split(arg2 + '').join('');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn this.sub(evaluate(expr.arg1, context), evaluate(expr.arg2, context));\r\n\t\t\t\t\t\tcase \"*\":\r\n\t\t\t\t\t\t\treturn this.mul(evaluate(expr.arg1, context), evaluate(expr.arg2, context));\r\n\t\t\t\t\t\tcase \"/\":\r\n\t\t\t\t\t\t\treturn this.div(evaluate(expr.arg1, context), evaluate(expr.arg2, context));\r\n\t\t\t\t\t\tcase \"%\":\r\n                            arg1 = parseInt(evaluate(expr.arg1, context));\r\n                            arg2 = parseInt(evaluate(expr.arg2, context));\r\n                            if (arg2 === 0) {\r\n                                Dialog.error('求余除数不能为 0');\r\n                                return 0;\r\n                            }\r\n\r\n                            return this.mod(arg1, arg2);\r\n\t\t\t\t\t\tcase \"==\":\r\n\t\t\t\t\t\t\treturn evaluate(expr.arg1, context) === evaluate(expr.arg2, context);\r\n\t\t\t\t\t\tcase \"!=\":\r\n\t\t\t\t\t\t\treturn evaluate(expr.arg1, context) !== evaluate(expr.arg2, context);\r\n\t\t\t\t\t\tcase \">\":\r\n\t\t\t\t\t\t\treturn evaluate(expr.arg1, context) > evaluate(expr.arg2, context);\r\n\t\t\t\t\t\tcase \"<\":\r\n\t\t\t\t\t\t\treturn evaluate(expr.arg1, context) < evaluate(expr.arg2, context);\r\n\t\t\t\t\t\tcase \">=\":\r\n\t\t\t\t\t\t\treturn evaluate(expr.arg1, context) >= evaluate(expr.arg2, context);\r\n\t\t\t\t\t\tcase \"<=\":\r\n\t\t\t\t\t\t\treturn evaluate(expr.arg1, context) <= evaluate(expr.arg2, context);\r\n\t\t\t\t\t\tcase \"min\":\r\n\t\t\t\t\t\t\treturn Math.min.apply(null,\r\n\t\t\t\t\t\t\t\texpr.args.map(arg => evaluate(arg, context))\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\tcase \"max\":\r\n\t\t\t\t\t\t\treturn Math.max.apply(null,\r\n\t\t\t\t\t\t\t\texpr.args.map(arg => evaluate(arg, context))\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\tcase \"all\":\r\n\t\t\t\t\t\t\treturn expr.args.map(arg => evaluate(arg, context)).every(v => v);\r\n\t\t\t\t\t\tcase \"any\":\r\n\t\t\t\t\t\t\treturn expr.args.map(arg => evaluate(arg, context)).some(v => v);\r\n\t\t\t\t\t\tcase \"literal\":\r\n\t\t\t\t\t\t\treturn Number(expr.value);\r\n                        case \"int\":\r\n                            return parseInt(this.toN(evaluate(expr.arg1, context)));\r\n                        case 'random':\r\n\t\t\t\t\t\t\tconst start = this.toInt(expr.range[0]);\r\n\t\t\t\t\t\t\tconst end = this.toInt(expr.range[1]);\r\n\t\t\t\t\t\t\treturn ~~(Math.random() * (end - start + 1) + start);\r\n\t\t\t\t\t\tcase 'value':\r\n\t\t\t\t\t\tcase 'savedValue':\r\n                        case 'payValue':\r\n                            value = [...context.values, ...context.savedValues, ...context.payValues]\r\n\t\t\t\t\t\t\t\t.find(v => v.uuid === expr.arg1);\r\n\t\t\t\t\t\t\treturn value.value !== undefined ? this.toN(value.value) : this.safeInitValue(value);\r\n                        case 'systemValue':\r\n                            value = context.systemValues.find(v => v.uuid === expr.arg1);\r\n                            if (value.value !== undefined) {\r\n                            \tif (value.uuid !== context.systemValues[0].uuid && value.uuid !== context.systemValues[1].uuid\r\n\t\t\t\t\t\t\t\t\t&& value.uuid !== context.systemValues[9].uuid) {\r\n                                    Utils.updateContextTimeValues(context);\r\n                                    //return this.toN(context.systemValues[2].value);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (value.uuid === context.systemValues[10].uuid) {\r\n                            \t\treturn this.toWeek(value.value);\r\n\t\t\t\t\t\t\t\t} else {\r\n                                    return this.toN(value.value);\r\n                                }\r\n\t\t\t\t\t\t\t} else {\r\n                            \treturn this.safeInitValue(value);\r\n\t\t\t\t\t\t\t}\r\n                        case 'indexValue':\r\n                        \tvalue = context.indexValues.find(v => v.uuid === expr.arg1);\r\n                            return value.value !== undefined ? this.toN(value.value) : this.safeInitValue(value);\r\n                        case \"string\":\r\n\t\t\t\t\t\t\treturn (expr.value + '');\r\n\t\t\t\t\t\tcase \"stringValue\":\r\n\t\t\t\t\t\t\tvalue = context.stringValues.find(v => v.uuid === expr.arg1);\r\n\t\t\t\t\t\t\treturn value.value !== undefined ? (value.value + '') : this.safeInitValue(value);\r\n\t\t\t\t\t\tcase 'reference':\r\n\t\t\t\t\t\t\tvalue = context.indexValues.find(v => v.uuid == expr.arg1);\r\n\t\t\t\t\t\t\tif (value) {\r\n\t\t\t\t\t\t\t\tconst i = (value.value === undefined ? this.safeInitValue(value) : this.toN(value.value)) - 1;\r\n\t\t\t\t\t\t\t\tif (value.init.type === 'value') {\r\n\t\t\t\t\t\t\t\t\tif (i<0 || i>=context.values.length) {\r\n\t\t\t\t\t\t\t\t\t\tDialog.info('出现未知数值操作，请联系作者检查修改');\r\n\t\t\t\t\t\t\t\t\t\treturn '[未知数值]';\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn context.values[i].value !== undefined ? this.toN(context.values[i].value) : this.safeInitValue(context.values[i]);\r\n                                }\r\n                                else if (value.init.type === 'savedValue') {\r\n                                    if (i<0 || i>=context.savedValues.length) {\r\n                                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n                                        return '[未知数值]';\r\n                                    }\r\n\t\t\t\t\t\t\t\t\treturn context.savedValues[i].value !== undefined ? this.toN(context.savedValues[i].value) : this.safeInitValue(context.savedValues[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if (value.init.type === 'payValue') {\r\n                                    if (i<0 || i>=context.payValues.length) {\r\n                                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n                                        return '[未知数值]';\r\n                                    }\r\n                                    return context.payValues[i].value !== undefined ? this.toN(context.payValues[i].value) : this.safeInitValue(context.payValues[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if (value.init.type === 'stringValue') {\r\n                                    if (i<0 || i>=context.stringValues.length) {\r\n                                        Dialog.info('出现未知数值操作，请联系作者检查修改');\r\n                                        return '[未知数值]';\r\n                                    }\r\n                                    return context.stringValues[i].value !== undefined ? (context.stringValues[i].value + '') : this.safeInitValue(context.stringValues[i]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase \"contain\":\r\n\t\t\t\t\t\t\targ1 = evaluate(expr.arg1, context);\r\n\t\t\t\t\t\t\targ2 = evaluate(expr.arg2, context);\r\n\t\t\t\t\t\t\treturn (arg1 + '').indexOf(arg2 + '') > -1;\r\n\t\t\t\t\t\tcase \"stringLength\":\r\n\t\t\t\t\t\t\targ1 = evaluate(expr.arg1, context);\r\n\t\t\t\t\t\t\treturn arg1 ? arg1.length : 0;\r\n\t\t\t\t\t\tdefault :\r\n\t\t\t\t\t\t\tthrow new error(\"expr type  is  error\");\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\treturn evaluate(expr, context);\r\n\t\t\t\t}\r\n\t\t\t\tcatch (e) {\r\n\t\t\t\t\tconsole.error(e);\r\n\t\t\t\t\treturn NaN;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tstatic safeInitValue(value) {\r\n\t\t\t\tfunction initValue(value) {\r\n\t\t\t\t\tif (value.init.type === 'const' || value.init.type === 'system') {\r\n\t\t\t\t\t\tvalue.value  = value.init.value;\r\n\t\t\t\t\t\treturn value.value;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (value.init.type === 'random') {\r\n\t\t\t\t\t\tconst start = Number(value.init.range[0]);\r\n\t\t\t\t\t\tconst end = Number(value.init.range[1]);\r\n\t\t\t\t\t\tvalue.value = ~~(Math.random() * (end - start + 1) + start);\r\n\t\t\t\t\t\treturn value.value;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (value.init.type === 'string') {\r\n\t\t\t\t\t\tvalue.value = (value.init.value + '');\r\n\t\t\t\t\t\treturn value.value;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (value.init.onlyRead) {\t// 索引\r\n\t\t\t\t\t\tvalue.value = value.init.value;\r\n\t\t\t\t\t\treturn value.value;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tconsole.error('unknown init type');\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\treturn initValue(value);\r\n\t\t\t\t}\r\n\t\t\t\tcatch (e) {\r\n\t\t\t\t\tconsole.error(e);\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tstatic fix(expr, context) {\r\n\t\t\t\tconst {type, arg1, arg2, args, value:oldValue} = expr;\r\n\t\t\t\tconst newExpr = {type};\r\n\t\t\t\tlet value;\r\n\t\t\t\tswitch (type) {\r\n\t\t\t\t\tcase \"arg1\":\r\n\t\t\t\t\tcase \"stringLength\":\r\n\t\t\t\t\t\tconst fixArg1 = this.fix(arg1, context);\r\n\t\t\t\t\t\tif (!fixArg1) {\r\n\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnewExpr.arg1 = fixArg1;\r\n\t\t\t\t\t\treturn newExpr;\r\n\t\t\t\t\tcase \"+\":\r\n\t\t\t\t\tcase \"-\":\r\n\t\t\t\t\tcase \"*\":\r\n\t\t\t\t\tcase \"/\":\r\n\t\t\t\t\tcase \"%\":\r\n\t\t\t\t\tcase \"==\":\r\n\t\t\t\t\tcase \"!=\":\r\n\t\t\t\t\tcase \">\":\r\n\t\t\t\t\tcase \"<\":\r\n\t\t\t\t\tcase \">=\":\r\n\t\t\t\t\tcase \"<=\":\r\n\t\t\t\t\tcase \"contain\":\r\n\t\t\t\t\t\tnewExpr.arg1 = this.fix(arg1, context);\r\n\t\t\t\t\t\tnewExpr.arg2 = this.fix(arg2, context);\r\n\t\t\t\t\t\tif (!newExpr.arg1 || !newExpr.arg2) {\r\n\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn newExpr;\r\n\t\t\t\t\tcase \"min\":\r\n\t\t\t\t\tcase \"max\":\r\n\t\t\t\t\tcase \"all\":\r\n\t\t\t\t\tcase \"any\":\r\n\t\t\t\t\t\tconst fixArgs = args.map(arg => this.fix(arg, context));\r\n\t\t\t\t\t\tnewExpr.args = fixArgs.filter(arg => arg !== null);\r\n\t\t\t\t\t\treturn newExpr;\r\n\t\t\t\t\tcase \"literal\":\r\n\t\t\t\t\t\tnewExpr.value = Number(oldValue);\r\n\t\t\t\t\t\treturn newExpr;\r\n\t\t\t\t\tcase 'random':\r\n\t\t\t\t\t\tnewExpr.range = (expr.range || [0, 100]).map(value => this.toInt(value));\r\n\t\t\t\t\t\tnewExpr.range.sort();\r\n\t\t\t\t\t\treturn newExpr;\r\n\t\t\t\t\tcase 'value':\r\n\t\t\t\t\tcase 'savedValue':\r\n                    case 'payValue':\r\n                    case 'systemValues':\r\n\t\t\t\t\tcase 'indexValue':\r\n\t\t\t\t\t\tvalue = [...context.values, ...context.savedValues, ...context.payValues, ...context.systemValues, ...context.indexValues]\r\n\t\t\t\t\t\t\t.find(v => v.uuid === expr.arg1);\r\n\t\t\t\t\t\tif (value === undefined) {\r\n\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnewExpr.arg1 = arg1;\r\n\t\t\t\t\t\treturn newExpr;\r\n\t\t\t\t\tcase \"string\":\r\n\t\t\t\t\t\tnewExpr.value = (oldValue + '' || '');\r\n\t\t\t\t\t\treturn newExpr;\r\n\t\t\t\t\tcase \"stringValue\":\r\n\t\t\t\t\t\tvalue = context.stringValues.find(v => v.uuid === expr.arg1);\r\n\t\t\t\t\t\tif (value === undefined) {\r\n\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnewExpr.arg1 = arg1;\r\n\t\t\t\t\t\treturn newExpr;\r\n\t\t\t\t\tdefault :\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tstatic parseValue(string, context, isGetName) {\r\n\t\t\t\tconst parseValueFormat = /([\\s\\S]*)&(s|v|sv|p|x|i|iv)\\[(\\d+)\\]([\\s\\S]*)/;\r\n\t\t\t\tlet value = parseValueFormat.exec(string), nameStr;\r\n\t\t\t\tlet str = string;\r\n\t\t\t\twhile (value) {\r\n\t\t\t\t\tconst type = value[2];\r\n\t\t\t\t\tconst index = parseInt(value[3]);\r\n\t\t\t\t\tlet temp = '[未知数值]';\r\n\t\t\t\t\tif (type === 's' && context.savedValues[index]) {\r\n\t\t\t\t\t\tnameStr = '[' + 'Y' + (index + 1) + ':' + context.savedValues[index].name + ']';\r\n\t\t\t\t\t\ttemp = context.savedValues[index].value === undefined\r\n\t\t\t\t\t\t\t? this.safeInitValue(context.savedValues[index])\r\n\t\t\t\t\t\t\t: context.savedValues[index].value;\r\n\t\t\t\t\t\tif (isGetName) {\r\n\t\t\t\t\t\t\ttemp = nameStr;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n                            temp = this.toFixed(temp,2);\r\n                        }\r\n                    }\r\n\t\t\t\t\telse if (type === 'v' && context.values[index]) {\r\n\t\t\t\t\t\tnameStr = '[' + 'P' + (index + 1) + ':' + context.values[index].name + ']';\r\n\t\t\t\t\t\ttemp = context.values[index].value === undefined\r\n\t\t\t\t\t\t\t? this.safeInitValue(context.values[index])\r\n\t\t\t\t\t\t\t: context.values[index].value;\r\n\t\t\t\t\t\tif (isGetName) {\r\n\t\t\t\t\t\t\ttemp = nameStr;\r\n\t\t\t\t\t\t}\r\n \t\t\t\t\t\telse {\r\n                            temp = this.toFixed(temp,2);\r\n                        }\r\n                    }\r\n\t\t\t\t\telse if (type === 'sv' && context.stringValues[index]) {\r\n\t\t\t\t\t\tnameStr = '[' + 'Z' + (index + 1) + ':' + context.stringValues[index].name + ']';\r\n\t\t\t\t\t\ttemp = context.stringValues[index].value === undefined\r\n\t\t\t\t\t\t\t? this.safeInitValue(context.stringValues[index])\r\n\t\t\t\t\t\t\t: context.stringValues[index].value;\r\n\t\t\t\t\t\tif (isGetName) {\r\n\t\t\t\t\t\t\ttemp = nameStr;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n                    else if (type === 'p' && context.payValues[index]) {\r\n                        nameStr = '[' + 'X' + (index + 1) + ':' + context.payValues[index].name + ']';\r\n                        temp = context.payValues[index].value === undefined\r\n                            ? this.safeInitValue(context.payValues[index])\r\n                            : context.payValues[index].value;\r\n                        if (isGetName) {\r\n                            temp = nameStr;\r\n                        }\r\n                        else {\r\n                            temp = this.toFixed(temp,2);\r\n                        }\r\n                    }\r\n                    else if (type === 'x' && context.systemValues[index]) {\r\n\t\t\t\t\t\tif (-1 === Utils.timeStamp) {\r\n\t\t\t\t\t\t\tUtils.getTimeOffset().then(() => {\r\n\t\t\t\t\t\t\t\tUtils.updateContextTimeValues(context);\r\n\t\t\t\t\t\t\t}, () => {\r\n                                Dialog.info('当前网络不佳，获取系统时间失败');\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tUtils.updateContextTimeValues(context);\r\n\t\t\t\t\t\t}\r\n\r\n                        nameStr = '[' + 'S' + (index + 1) + ':' + context.systemValues[index].name + ']';\r\n                        temp = context.systemValues[index].value === undefined\r\n                            ? this.safeInitValue(context.systemValues[index])\r\n                            : index === 10 ? this.toWeek(context.systemValues[10].value) : context.systemValues[index].value;\r\n                        if (isGetName) {\r\n                            temp = nameStr;\r\n                        }\r\n                        else {\r\n                            temp = this.toFixed(temp,2);\r\n                        }\r\n                    }\r\n                    else if (type === 'i' && context.indexValues[index]) {\r\n                        nameStr = '[' + 'I' + (index + 1) + ':' + context.indexValues[index].name + ']';\r\n                        temp = context.indexValues[index].value === undefined ? this.safeInitValue(context.indexValues[index]) : context.indexValues[index].value;\r\n                        if (isGetName) {\r\n                            temp = nameStr;\r\n                        }\r\n                        else {\r\n                        \ttemp = this.toFixed(temp, 2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (type === 'iv') {\r\n\t\t\t\t\t\tif (index >= context.indexValues.length) {\r\n\t\t\t\t\t\t\ttemp = '[未知数值]';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n                            nameStr = '[' + 'IV' + (index + 1) + ':' + context.indexValues[index].name + ']';\r\n                            const i = (context.indexValues[index].value === undefined ? this.safeInitValue(context.indexValues[index]) : context.indexValues[index].value) - 1;\r\n                            if (isGetName) {\r\n                                temp = nameStr;\r\n                            }\r\n                            else {\r\n                                const ii = this.toFixed(i, 2);\r\n                                if (context.indexValues[index].init.type === 'value') {\r\n                                    if (i<0 || i>=context.values.length) {\r\n                                        temp = '[未知数值]';\r\n                                    }\r\n                                    else {\r\n                                        temp = context.values[ii].value === undefined ? this.safeInitValue(context.values[ii]) : context.values[ii].value;\r\n                                        temp = this.toFixed(temp, 2);\r\n                                    }\r\n                                }\r\n                                else if (context.indexValues[index].init.type === 'savedValue') {\r\n                                    if (i<0 || i>=context.savedValues.length) {\r\n                                        temp = '[未知数值]';\r\n                                    }\r\n                                    else {\r\n                                        temp = context.savedValues[ii].value === undefined ? this.safeInitValue(context.savedValues[ii]) : context.savedValues[ii].value;\r\n                                        temp = this.toFixed(temp, 2);\r\n                                    }\r\n                                }\r\n                                else if (context.indexValues[index].init.type === 'payValue') {\r\n                                    if (i<0 || i>=context.payValues.length) {\r\n                                        temp = '[未知数值]';\r\n                                    }\r\n                                    else {\r\n                                        temp = context.payValues[ii].value === undefined ? this.safeInitValue(context.payValues[ii]) : context.payValues[ii].value;\r\n                                        temp = this.toFixed(temp, 2);\r\n                                    }\r\n                                }\r\n                                else if (context.indexValues[index].init.type === 'stringValue') {\r\n                                    if (i<0 || i>=context.stringValues.length) {\r\n                                        temp = '[未知数值]';\r\n                                    }\r\n                                    else {\r\n                                        temp = context.stringValues[ii].value === undefined ? this.safeInitValue(context.stringValues[ii]) : context.stringValues[ii].value;\r\n                                    }\r\n                                }\r\n                            }\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tstr = value[1] + temp + value[4];\r\n\t\t\t\t\tvalue = parseValueFormat.exec(str);\r\n\t\t\t\t}\r\n\t\t\t\treturn str;\r\n\t\t\t}\r\n\r\n\t\t\tstatic parseWaitTime(data, show) {\r\n\t\t\t\tconst parsePauseFormat = /([\\s\\S]*)\\\\(\\d+)\\s([\\s\\S]*)/;\r\n\t\t\t\tlet value = parsePauseFormat.exec(data);\r\n\t\t\t\twhile (value) {\r\n\t\t\t\t\tif (show) {\r\n\t\t\t\t\t\tdata = value[1] + `[停顿:${value[2]}ms]` + value[3]\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdata = value[1] + value[3];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvalue = parsePauseFormat.exec(data);\r\n\t\t\t\t}\r\n\t\t\t\treturn data;\r\n\t\t\t}\r\n\r\n\t\t\tstatic getGameValueByTimer(timer, context) {\r\n\t\t\t\tlet value = {};\r\n\t\t\t\tif (!timer) {\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t}\r\n\t\t\t\tconst { type, arg1 } = timer.time;\r\n\r\n\t\t\t\tif (type === 'value') {\r\n\t\t\t\t\tvalue = context.values.find(v => v.uuid === arg1)\r\n\t\t\t\t} else if (type === 'savedValue') {\r\n\t\t\t\t\tvalue = context.savedValues.find(v => v.uuid === arg1)\r\n\t\t\t\t} else if (type === 'literal') {\r\n\t\t\t\t\tvalue.value = timer.time.value\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t}\r\n\t\t\t\tconst countDown = value && value.value === undefined\r\n\t\t\t\t\t? this.safeInitValue(value)\r\n\t\t\t\t\t: value.value;\r\n\t\t\t\treturn Math.max(countDown, 0);\r\n\t\t\t}\r\n\r\n            static add(num1, num2) {\r\n                let len1 = 0, len2 = 0, m = 1;\r\n                try {\r\n                    len1 = num1.toString().split('.')[1].length;\r\n                } catch (e) {\r\n                }\r\n                try {\r\n                    len2 = num2.toString().split(\".\")[1].length;\r\n                } catch (e) {\r\n                }\r\n                m = Math.max(len1, len2);\r\n                num1 = parseInt(num1.toString().replace(\".\", \"\")) * Math.pow(10, m - len1);\r\n                num2 = parseInt(num2.toString().replace(\".\", \"\")) * Math.pow(10, m - len2);\r\n                return (num1 + num2) / Math.pow(10, m);\r\n            }\r\n\r\n            static sub(num1, num2) {\r\n                let len1 = 0, len2 = 0, m = 1;\r\n                try {\r\n                    len1 = num1.toString().split('.')[1].length;\r\n                } catch (e) {\r\n                }\r\n                try {\r\n                    len2 = num2.toString().split(\".\")[1].length;\r\n                } catch (e) {\r\n                }\r\n                m = Math.max(len1, len2);\r\n                num1 = parseInt(num1.toString().replace(\".\", \"\")) * Math.pow(10, m - len1);\r\n                num2 = parseInt(num2.toString().replace(\".\", \"\")) * Math.pow(10, m - len2);\r\n                return (num1 - num2) / Math.pow(10, m);\r\n            }\r\n\r\n            static div(num1, num2) {\r\n                if (!num2) {\r\n                \tDialog.error('除数不能为 0');\r\n                    return 0;\r\n                }\r\n                let len1 = 0, len2 = 0, temp;\r\n                try {\r\n                    len1 = num1.toString().split('.')[1].length;\r\n                } catch (e) {\r\n                }\r\n                try {\r\n                    len2 = num2.toString().split(\".\")[1].length;\r\n                } catch (e) {\r\n                }\r\n                temp = parseInt(num1.toString().replace(\".\", \"\")) / parseInt(num2.toString().replace(\".\", \"\"));\r\n                if (len2 - len1 < 0 || temp !== parseInt(temp)) {\r\n                    return this.mul(temp, Math.pow(10, len2 - len1));\r\n                }\r\n                return temp * Math.pow(10, len2 - len1);\r\n            }\r\n\r\n            static mul(num1, num2) {\r\n                let m = 0, str1 = num1.toString(), str2 = num2.toString();\r\n                try {\r\n                    m += str1.includes('1e-') ? parseInt(str1.split('1e-')[1]) : str1.split(\".\")[1].length\r\n                } catch (e) {\r\n                }\r\n                try {\r\n                    m += str2.includes('1e-') ? parseInt(str2.split('1e-')[1]) : str2.split(\".\")[1].length\r\n                } catch (e) {\r\n                }\r\n                return parseInt(str1.replace(\".\", \"\")) * parseInt(str2.replace(\".\", \"\")) / Math.pow(10, m);\r\n            }\r\n\r\n            static mod(num1, num2) {\r\n                let len1 = 0, len2 = 0, m = 1;\r\n                try {\r\n                    len1 = num1.toString().split('.')[1].length;\r\n                } catch (e) {\r\n                }\r\n                try {\r\n                    len2 = num2.toString().split(\".\")[1].length;\r\n                } catch (e) {\r\n                }\r\n                m = Math.pow(10, Math.max(len1, len2));\r\n                return ((num1 * m) % (num2 * m)) / m;\r\n            }\r\n\r\n            static toFixed(value = 0, fixed = 2) {\r\n                let len = 0;\r\n                try {\r\n                    len = value.toString().split(\".\")[1].length;\r\n                } catch (e) {\r\n                }\r\n                let str = value.toString();\r\n                if (len > fixed && fixed >= 0) {\r\n                    str = str.substring(0, str.indexOf('.') + fixed + 1);\r\n                    len = fixed;\r\n                }\r\n                value = parseInt(str.replace(\".\", \"\"));\r\n                return value / Math.pow(10, len);\r\n            }\r\n        }\r\n\t},\r\n\r\n\t// CLASS MEMBERS\r\n\t{\r\n\t\t/**\r\n\t\t * The TextProxy's name.\r\n\t\t *\r\n\t\t * @static\r\n\t\t * @type {string}\r\n\t\t */\r\n\t\tNAME: 'SceneProxy'\r\n\t\t, guideLayer:null \t\t//指引层\r\n\t\t, logo: null\t\t\t// Logo层\r\n\t\t, coverLayer: null\t\t// 封面层\r\n\t\t, progressLayer: null\t// 进度条层\r\n\t\t, dialogLayer: null\t\t// 对话框层\r\n\t\t, menuLayer: null\t\t// 菜单层\r\n\t\t, mainMenuLayer: null\t// 主菜单层\r\n\t\t, settingsLayer: null\t// 设置层\r\n\t\t, recordLayer: null\t\t// 保存的进度层\r\n\t\t, playBackLayer: null\t// 回放层\r\n\t\t, weatherLayer: null\t// 天气\r\n\t\t, charsAndPropsLayer: null\t// 角色&道具层\r\n\t\t, optionLayer: null\t\t// 选项层\r\n\t\t, plotViewsLayer: null\t// 剧情高级UI层\r\n\t\t, globalViews: null\t\t// 全局高级UI\r\n\t\t, plotViews: null\t\t// 剧情高级UI\r\n\t\t, prgsViews: null\t\t// 高级UI进度条\r\n\t\t, endLayer: null\t\t// 结尾层\r\n\t\t, toastLayer: null\t\t// toast层\r\n\t\t, loadingToastLayer: null\t// 加载中提示层\r\n\t\t, quickPlayLayer: null\t// 快速播放提示层\r\n\t\t, bubbleLayer: null\t\t//气泡层\r\n\r\n\t\t, bk_music: null\t\t// 背景音乐\r\n\t\t, plotSounds: null\t\t// 剧情音效\r\n\t\t, btn_sound: null\t\t// 按钮音效\r\n\t\t, audioDecodedCount: 0\t// 自动解码的音频数\r\n\r\n\t\t, lstPlotBkKey: null\t// 前一个剧情背景Key\r\n\t\t, prePlotBkKey: null\t// 上一个剧情背景Key\r\n\t\t, lstPlotBkOpacity: 0\t// 前一剧情背景透明度\r\n\t\t, lstPlotBkFlex: 1\t\t// 前一剧情背景flex\r\n\t\t, lstGameBk: null\t\t// 上一张游戏背景\r\n\t\t, curPlotLayer: null\t// 当前播放剧情层\r\n\t\t, lstPlotLayer: null\t// 上一剧情层\r\n\r\n\t\t, viewComponent: null\r\n\r\n\t\t// data\r\n\t\t, json_data: {}\t\t\t// 游戏json数据\r\n\t\t, Template: {}\t\t\t// 游戏中模板数据\r\n\t\t, stringMap: {}\t\t\t// 文本映射\r\n\t\t, progressTips: []\t\t// 加载tip\r\n\t\t, unlockChapterCallBack: null\t// 解锁付费章节回调\r\n\t\t, mallPayCallback: null\t// 商城购买回调\r\n\r\n\t\t, context: {}\t\t\t// 播放过程的数据\r\n\t\t, plotSnap: null\t\t// 剧情快照(可用于存档缩略图)\r\n\t\t, savedPlotsData: null\t// 存档数据\r\n\t\t, cloudPlotsData: null\t// 云端存档数据\r\n\t\t, recUidBelongTo: ''\t// 存档所属UID\r\n\t\t, gameUidBelongTo: ''\t// 游戏所属UID\r\n\t\t, bSwitchAccInPlot: true\t// 是否在剧情中切换账号\r\n\t\t, payValueUid: ''\t\t// payValues所属UID\r\n\t\t, playPause: false\t\t// 是否已暂停播放\r\n\t\t, bViewLoaded: false\t// 全局UI已初始化\r\n\t\t, bSignedIn: false\t\t// 是否已登录\r\n\t\t, bCloudSel: false\t\t// 是否选择云端存档\r\n\r\n\t\t, curChapter: null\t\t// 当前播放的章节信息\r\n\t\t, curPlotInfo: null\t\t// 当前展示的剧情信息\r\n\t\t, curPlotIndex: 0\t\t// 当前播放剧情索引\r\n\t\t, cmdPlotSnap: null\t\t// 高级剧情快照\r\n\t\t, curCmdUuid: ''\t\t// 当前剧情指令UUID\r\n\t\t, bCmdAutoText: false\t// 高级剧情是否自动播放\r\n\t\t, lstDialogInfo: null\t// 高级剧情对话框信息\r\n\t\t, menuInfo: null\t\t// 高级剧情菜单信息\r\n\t\t, charsAndPropsInfo: []\t// 高级剧情人物道具信息\r\n\t\t, bToSaveFile: true\t\t// 是否为保存进度(false = 读取存档)\r\n\r\n\t\t, space_key: null       // 空格键\r\n\t\t, z_key:null\t\t\t//Z键\r\n        , globalViewKeys: null  // 高级UI消息键\r\n        , plotViewKeys: null    // 剧情UI消息键\r\n\t\t, quickPlay: false     // 快速播放\r\n\t\t, isScreenHold: false\t// 屏幕是否按住\r\n\t\t, isQuickPlay: true\t\t//是否要执行屏幕按住 快速播放\r\n\t\t, isShowGuide:true    //是否需要显示引导层（存档提示引导层）\r\n\t\t, recordTipCount:0\t\t//存档引导提示次数\r\n\t\t, visibleLayout: []\t\t// 所有显示层\r\n\t\t, resourceManager: {}\r\n\t\t, lstPlotTweens: []\r\n\t\t, twinkleTimer: null\t// 闪烁计时器\r\n\t\t, uiOnLoadQueue: []\t\t// 高级UIonLoad事件回调队列\r\n\t\t, timerCounts: []\t\t// 计时组件已计时次数(用于读档时恢复计时次数)\r\n\t\t, menuTimer: []\t\t\t// 自制菜单中的计时器\r\n\r\n\t\t, cmdPlotNextPromise: null\t// 高级剧情前一指令Promise处理器\r\n\t\t, cmdPlayHandlerFun: null\t// 高级剧情playHandler函数指针\r\n\t\t, curCmdInfo: null\t\t\t// 当前执行指令信息\r\n\t\t, curCmdIndex: 0\t\t\t// 当前执行指令索引\r\n\t\t, preWaitCmdUuid: ''\t\t// 前一个等待指令uuid\r\n\r\n\t\t, isGameStarted: false\t\t// 记录游戏是否已开始\r\n\t\t, usedStarCount: 0\t\t\t// 已使用的星星数\r\n\t\t, gameStarLimit: 0\t\t\t// 单作品可用星星上限\r\n        , isPaying:\tfalse\t\t\t// 是否正在进行pay操作\r\n\t\t, isGettingNext: false\t\t// 是否正在获取下一剧情信息\r\n\t\t, isPreferentialFinished : false\t//是否通知章节限免结束\r\n\t\t, preferentialVector:[]\t\t//限免已结束的章节\r\n\t\t, isSetValues : false\t\t//数值操作中\r\n\t\t, isPaySuccess : false\t\t//是否pay操作成功\r\n\t\t, isGoToCommand: true\t\t//是否继续高级指令\r\n\t\t, shakeLoopObj: null\t\t//循环振动数据\r\n\t\t, hasCountDown: null\t\t//是否存在倒计时\r\n\t\t, saveBubbleVector:[]\t\t//记录气泡模式\r\n\t\t, saveBubbleDataVector:[]\t//记录气泡数据\r\n\t\t, bubbleArchivalCount:[]\t//气泡数据存档计数 上线1000条\r\n\t\t, dialogNext:null\t\t\t//气泡模式存在，对话框下一步\r\n\t\t, setValueAfterPay:false\t//是否是pay后面的setvalue操作\r\n\t\t, isInputFocus:false\t\t//文本输入框是否获得焦点\r\n\t\t, isLineUpdatePaySuccess:false\t//是否同步线上消费数值成功\r\n\t\t, playAdCallBack:null\t\t//广告回调函数\r\n\t\t, playAdPayStatus:0\t\t\t//购买  看广告后的状态\r\n\t}\r\n);","/**\r\n * @class demo.view.TextComponent\r\n * @implements EventListener\r\n *\r\n * TextComponent is implemented without any abstract concept of a UiComponent\r\n * or Sprite, and uses standard HTML5 methods to manipulate the DOM. It\r\n * does however implement the {@link #handleEvent W3C EventListener interface}\r\n * which means it can be passed directly to HTMLElement#addEventListener, rather\r\n * than providing a Function, leading to tidier code and no need for Function#bind\r\n * to preserve the execution scope of its methods.\r\n */\r\nimport puremvc from 'puremvc';\r\nimport * as Xhr from '../../common/XmlHttpRequest.js';\r\nimport RePhaser from '../../common/RePhaser.js';\r\nimport Utils, {ResourcesManager, AudioTagPool} from '../../common/Utils.js';\r\nimport commit from '../../common/Version.js';\r\nimport PhoneUtils from '../../common/PhoneUtils.js';\r\nimport FontUtils from '../../common/FontUtils.js';\r\nimport {H54399Api} from '../../common/OtherWap.js';\r\n\r\npuremvc.define\r\n(\r\n    // CLASS INFO\r\n    {\r\n        name: 'diygamePlayer.view.component.Scene',\r\n\r\n        /** @constructor */\r\n        constructor: function () {\r\n            const initPlayer = ()=>{\r\n                var scene = this;\r\n                const ww = flashvars.vertical ? 540 : 960;\r\n                const hh = flashvars.vertical ? 960 : 540;\r\n                var state = {\r\n                    init: function () {\r\n                        // Delete this init block or replace with your own logic.\r\n                        !scene.game.device.desktop && (scene.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL);\r\n                        if(flashvars.wap && (flashvars.wap=== \"qh\" || flashvars.wap === '4399')){\r\n                            scene.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;//群黑平台游戏默认全屏显示\r\n                        }\r\n                        scene.game.scale.fullScreenScaleMode = Phaser.ScaleManager.SHOW_ALL;\r\n                        scene.game.scale.pageAlignVertically = true;\r\n                        scene.game.scale.pageAlignHorizontally = true;\r\n                        scene.game.stage.disableVisibilityChange = true;\r\n                        const isIphone = ()=>{\r\n                            return (navigator.userAgent.indexOf('iPhone') > -1 && (window.orientation && window.orientation === 0));\r\n                        }\r\n                        scene.game.scale.setResizeCallback((scaleManager, rectangle) => {\r\n                            const game = document.getElementById(\"game\");\r\n                            let w = isIphone() ? (global.width): (window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth)\r\n                            let h = isIphone() ? (global.height): (window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight);\r\n                            if(isIphone()){\r\n                                if(w > h){\r\n                                    w = global.height;\r\n                                    h = global.width;\r\n                                }\r\n                            }\r\n                            game.style.width = w + 'px';\r\n                            game.style.height = h + 'px';\r\n                            if (w > h) {\r\n                                if(flashvars.vertical){\r\n                                    if (scene.game.world.angle !== 90) {\r\n                                        scene.game.scale.setGameSize(960, 540);\r\n                                        scene.game.world.angle = 90;\r\n                                        scene.game.world.setBounds(-960, 0, 540, 960);\r\n                                        scene.game.scale.refresh();\r\n                                    }\r\n                                }else{\r\n                                    if (scene.game.world.angle !== 0) {\r\n                                        scene.game.scale.setGameSize(960, 540);\r\n                                        scene.game.world.angle = 0;\r\n                                        scene.game.world.setBounds(0, 0, 960, 540);\r\n                                        scene.game.scale.refresh();\r\n                                    }\r\n                                }\r\n                            } else {\r\n                                if(flashvars.vertical){\r\n                                    if (scene.game.world.angle !== 0) {\r\n                                        scene.game.scale.setGameSize(540, 960);\r\n                                        scene.game.world.angle = 0;\r\n                                        scene.game.world.setBounds(0, 0, 540, 960);\r\n                                        scene.game.scale.refresh();\r\n                                    }\r\n                                }else{\r\n                                    if (scene.game.world.angle !== 90) {\r\n                                        scene.game.scale.setGameSize(540, 960);\r\n                                        scene.game.world.angle = 90;\r\n                                        scene.game.world.setBounds(-960, 0, 960, 540);\r\n                                        scene.game.scale.refresh();\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                        });\r\n                        scene.game.load.loadImageTag = RePhaser.loadImageTag;\r\n                        scene.game.load.onSoundExtendLoad = new Phaser.Signal();\r\n                        scene.game.load.onSoundExtendLoadError = new Phaser.Signal();\r\n                        PhoneUtils.load = scene.game.load;\r\n                        scene.game.renderer.renderSession.roundPixels = true;\r\n                        scene.game.sound.decode = RePhaser.soundDecode;\r\n                        scene.game.sound.onSoundDecodeError = new Phaser.Signal();\r\n\r\n                        //fix iOS audio tag volume always stays set at 1\r\n\r\n                        const init = () => {\r\n                            scene.game.sound.touchLocked = false;\r\n                            AudioTagPool.fill();\r\n                            const keys = scene.game.cache.getKeys(Phaser.Cache.SOUND);\r\n                            keys.forEach(key => {\r\n                                var sound = scene.game.cache.getSound(key);\r\n                                if (sound && !AudioTagPool.exist(sound.data)) {\r\n                                    scene.game.cache.reloadSound(key);\r\n                                }\r\n                            });\r\n                        };\r\n\r\n                        if (scene.game.device.iOS) {\r\n                            if (scene.game.device.iOSVersion > 8) {\r\n                                scene.game.input.touch.addTouchLockCallback(init, scene.game, true);\r\n                            } else {\r\n                                scene.game.input.touch.addTouchLockCallback(init, scene.game);\r\n                            }\r\n                        } else {\r\n                            if(flashvars.client === 'wap' && scene.game.device.android && (navigator.userAgent.indexOf('vivo Y66') !== -1\r\n                                    || navigator.userAgent.indexOf('DIG-AL00') !== -1  )){\r\n                                scene.game.input.touch.addTouchLockCallback(init, scene.game,true);\r\n                            }else{\r\n                                init();\r\n                            }\r\n                        }\r\n\r\n                        ResourcesManager.cache = scene.game.cache;\r\n                        ResourcesManager.load = scene.game.load;\r\n                        scene.game.destroyComponent.add(key => {\r\n                            ResourcesManager.subRefCount('img', key, 'play');\r\n                        });\r\n                        window.ResourcesManager = ResourcesManager;\r\n                    },\r\n                    preload: function () {\r\n                    },\r\n                    create: function () {\r\n                        this.game.canvas.oncontextmenu = e => e.preventDefault();\r\n                        // State create logic goes here\r\n                        // Create simple text display for current Phaser version\r\n                        let startBk = scene.game.add.graphics(0, 0);\r\n                        startBk.name = 'startBk';\r\n                        startBk.beginFill(0x62d3d5);\r\n                        startBk.drawRect(0, 0, ww, hh);\r\n                        startBk.endFill();\r\n                        //scene.game.stage.backgroundColor = \"#62d3d5\";\r\n                        if (scene.onRendered) {\r\n                            scene.onRendered();\r\n                        }\r\n                    },\r\n                    update: function () {\r\n                        // State Update Logic goes here.\r\n                    }\r\n                };\r\n                // 闪退手机浏览器版本: Chrome/50.0.2661.86 & Chrome/51.0.2704.81 渲染方式改为自动\r\n                let phaserRender = Phaser.CANVAS;\r\n                let agentV = navigator.userAgent.match(/chrome\\/((([0-9]*)+(\\.))*)+([0-9]*)/gi);\r\n                if (agentV) {\r\n                    if (agentV[0] == 'Chrome/50.0.2661.86' || agentV[0] == 'Chrome/51.0.2704.81') {\r\n                        if (-1 === navigator.userAgent.indexOf('Android 6.0.1; MI 4LTE')\r\n                            && -1 === navigator.userAgent.indexOf('vivo Y67')) {\r\n                            phaserRender = Phaser.AUTO;\r\n                        }\r\n                    }\r\n                    else if (agentV[0] == 'Chrome/46.0.2490.76' && -1 !== navigator.userAgent.indexOf('OPPO R9s')) {\r\n                        phaserRender = Phaser.AUTO;\r\n                    }\r\n                }\r\n                scene.game = new Phaser.Game(\r\n                    ww,\r\n                    hh,\r\n                    phaserRender,\r\n                    'game',\r\n                    state\r\n                );\r\n                scene.game.preserveDrawingBuffer = true;\r\n                window.game = scene.game;\r\n                window['AudioContext'] = null;\r\n                window['webkitAudioContext'] = null;\r\n                console.log('versionCommit: ', commit);\r\n            }\r\n            Xhr.getJson('config.json','',null).then((rs)=>{\r\n                flashvars.uuid = rs.uuid;\r\n                flashvars.type = 0;\r\n                flashvars.offline = rs.offline;\r\n                flashvars.gid = rs.gid;\r\n                flashvars.vertical = rs.vertical === '1';\r\n                flashvars.name = rs.name;\r\n                flashvars.wap = rs.wap;\r\n                flashvars.single = rs.single === '1';\r\n                initPlayer();\r\n            },(rj)=>{initPlayer();})\r\n        }\r\n    },\r\n\r\n    // INSTANCE MEMBERS\r\n    {\r\n        showLogo: function () {\r\n            let logo_preloader = this.game.world.getByName('logo_preloader');\r\n            if (!logo_preloader) {\r\n                logo_preloader = this.game.add.image(this.game.world.width / 2, this.game.world.height / 2, 'logo_preloader');\r\n                logo_preloader.name = 'logo_preloader';\r\n                logo_preloader.anchor.setTo(0.5, 0.5);\r\n            }\r\n            logo_preloader.visible = true;\r\n        },\r\n\r\n        showLoading: function () {\r\n            let logo_preloader = this.game.world.getByName('logo_preloader');\r\n            let loading_gif = this.game.world.getByName('loading_gif');\r\n            if (!loading_gif) {\r\n                loading_gif = this.game.add.image(this.game.world.width / 2, flashvars.vertical ? (this.game.world.height / 2 - 100) : this.game.world.height, 'loading_gif');\r\n                loading_gif.anchor.set(0.5,0.5);\r\n                loading_gif.x = this.game.world.width / 2;\r\n                loading_gif.y = flashvars.vertical ? (this.game.world.height / 2 - loading_gif.height / 2) : (this.game.world.height / 2 - 80);\r\n                loading_gif.name = 'loading_gif';\r\n                this.addGifAnimation(loading_gif);\r\n            }\r\n            if (logo_preloader) {\r\n                logo_preloader.scale.setTo(0.35, 0.35);\r\n                logo_preloader.x = this.game.world.width - logo_preloader.width + 25;\r\n                logo_preloader.y = this.game.world.height - logo_preloader.height + 12;\r\n            }\r\n            loading_gif.visible = true;\r\n            return true;\r\n        },\r\n        //离线背景图片\r\n        showOfflineBg:function () {\r\n            let offlinebg = this.game.world.getByName('offlinebg');\r\n            if (!offlinebg) {\r\n                offlinebg = this.game.add.image(this.game.world.width / 2, this.game.world.height / 2, 'OfflineBg');\r\n                offlinebg.name = 'offlinebg';\r\n                offlinebg.inputEnabled = true;\r\n                offlinebg.anchor.setTo(0.5, 0.5);\r\n                this.game.world.setChildIndex(offlinebg,1);//放底部\r\n            }\r\n            offlinebg.visible = true;\r\n        },\r\n\r\n        destroyLogo: function () {\r\n            const startBk = this.game.world.getByName('startBk');\r\n            const logo_preloader = this.game.world.getByName('logo_preloader');\r\n            const loading_gif = this.game.world.getByName('loading_gif');\r\n            const logInfo = this.game.world.getByName('logInfo');\r\n            const offlinebg = this.game.world.getByName('offlinebg');\r\n            const imgContinue = this.game.world.getByName('Continue');\r\n            offlinebg && offlinebg.destroy();\r\n            imgContinue && imgContinue.destroy();\r\n            startBk && startBk.destroy();\r\n            logo_preloader && logo_preloader.destroy();\r\n            loading_gif && loading_gif.destroy();\r\n            logInfo && logInfo.destroy();\r\n        },\r\n\r\n        preLoadCertainAssets: function () {\r\n            if(!flashvars.vertical)this.game.load.spritesheet('wind', './img/wind.png', 960, 540);\r\n            this.game.load.image('icon_back', './img/icon_back.png');\r\n            this.game.load.image('icon_back_over_pressed', './img/icon_back_over_pressed.png');\r\n            this.game.load.image('icon_candy', './img/icon_candy.png');\r\n            this.game.load.image('icon_candy_over_pressed', './img/icon_candy_over_pressed.png');\r\n            this.game.load.image('icon_get', './img/icon_get.png');\r\n            this.game.load.image('icon_get_hover_pressed', './img/icon_get_hover_pressed.png');\r\n            this.game.load.image('icon_save', './img/icon_save.png');\r\n            this.game.load.image('icon_save_over_pressed', './img/icon_save_over_pressed.png');\r\n            this.game.load.image('cloud', './img/cloud.png');\r\n            this.game.load.image('cloud_hover', './img/cloud_hover.png');\r\n            this.game.load.image('local', './img/local.png');\r\n            this.game.load.image('local_hover', './img/local_hover.png');\r\n            this.game.load.image('icon_success', './img/icon_success.png');\r\n            this.game.load.image('icon_error', './img/icon_error.png');\r\n            this.game.load.image('light', './img/light.png');\r\n            this.game.load.image('toast_loading', './img/toast_loading.gif');\r\n            this.game.load.image('app_button_speed', './img/app_button_speed.png');\r\n            this.game.load.image('app_icon_speed', './img/app_icon_speed.png');\r\n            if(flashvars.client === 'wap') this.game.load.image('wapback', './img/wapback.png');//wap端增加退出按钮\r\n\r\n            if(flashvars.single && flashvars.offline === '1'){\r\n                this.game.load.image('OfflineBg',flashvars.vertical ? './img/offlinebg_1.png' : './img/offlinebg.png'); //增加离线背景图片\r\n                this.game.load.image('Continue', './img/Continue.png'); //点击继续图片\r\n                this.game.load.image('menuMore', './img/more.png'); //菜单按钮更多\r\n                this.game.load.image('menuMoreHover', './img/more_hover.png');  //菜单按钮更多滑过\r\n            }else{\r\n                this.game.load.image('Operation_tip', flashvars.vertical ? \"./img/Operation_tip_1.gif\" : './img/Operation_tip.png');\r\n                this.game.load.image('Cloud_record_tip', flashvars.vertical ? \"./img/Cloud_record_tip_1.png\" : './img/Cloud_record_tip.png');\r\n                this.game.load.image('logo_preloader', './img/logo_preloader.png');\r\n                this.game.load.image('loading_gif', './img/loading_gif.gif');\r\n            }\r\n\r\n        },\r\n        /**\r\n         * 离线天气素材\r\n         */\r\n        preLoadWeatherAssets(){\r\n            if (flashvars.offline === '1') {\r\n                if(flashvars.vertical){\r\n                    for(let i=0;i < 20;i++){\r\n                        this.game.load.image('/weather/'+ Utils.getWeatherFilePathName(\"wind\") +'/feng_' + Utils.formatNum(i) + '.png', './img/'+ Utils.getWeatherFilePathName(\"wind\") + '/feng_' + Utils.formatNum(i) + '.png');\r\n                    }\r\n                }\r\n                for (let i=0; i<50; i++) {\r\n                    this.game.load.image('/weather/'+ Utils.getWeatherFilePathName(\"rain\") +'/xiayu_' + Utils.formatNum(i) + '.png', './img/'+ Utils.getWeatherFilePathName(\"rain\") + '/xiayu_' + Utils.formatNum(i) + '.png');\r\n                }\r\n                for (let i=0; i<120; i++) {\r\n                    this.game.load.image('/weather/' + Utils.getWeatherFilePathName(\"snow\") + '/xuehua_' + Utils.formatNum(i) + '.png', './img/' + Utils.getWeatherFilePathName(\"snow\") + '/xuehua_' + Utils.formatNum(i) + '.png');\r\n                }\r\n                for (let i=0; i<90; i++) {\r\n                    this.game.load.image('/weather/'+Utils.getWeatherFilePathName(\"mapleLeaves\")+ '/fengye_' + Utils.formatNum(i) + '.png', './img/'+Utils.getWeatherFilePathName(\"mapleLeaves\")+ '/fengye_' + Utils.formatNum(i) + '.png');\r\n                }\r\n                for (let i=0; i<90; i++) {\r\n                    this.game.load.image('/weather/' + Utils.getWeatherFilePathName(\"beachBlossom\")+'/taohua_' + Utils.formatNum(i) + '.png', './img/' + Utils.getWeatherFilePathName(\"beachBlossom\")+'/taohua_' + Utils.formatNum(i) + '.png');\r\n                }\r\n                for (let i=0; i<90; i++) {\r\n                    this.game.load.image('/weather/' + Utils.getWeatherFilePathName(\"blossom\")+ '/yinghua_' + Utils.formatNum(i) + '.png', './img/' + Utils.getWeatherFilePathName(\"blossom\")+ '/yinghua_' + Utils.formatNum(i) + '.png');\r\n                }\r\n                for (let i=0; i<50; i++) {\r\n                    this.game.load.image('/weather/'+ Utils.getWeatherFilePathName(\"lightning\") + '/shandian_' + Utils.formatNum(i) + '.png', './img/' + Utils.getWeatherFilePathName(\"lightning\") + '/shandian_' + Utils.formatNum(i) + '.png');\r\n                }\r\n            }\r\n        },\r\n\r\n        preLoad: function () {\r\n            const pload =()=>{\r\n                return new Promise((resolve, reject) => {\r\n                    this.preLoadCertainAssets();\r\n                    this.game.load.onLoadStart.addOnce(() => {\r\n                        this.addLog('正在准备播放..')\r\n                    });\r\n                    this.game.load.onFileComplete.add((progress, cacheKey, success, totalLoaded, totalFiles) => {\r\n                        if(flashvars.single && flashvars.offline === '1'){\r\n                            if(\"offlinebg\" === cacheKey) this.showOfflineBg();\r\n                        }else{\r\n                            if ('logo_preloader' === cacheKey) this.showLogo();\r\n                        }\r\n                        this.addLog('正在准备播放.. ' + progress + \"%\", true);\r\n                    });\r\n                    this.game.load.onLoadComplete.addOnce(() => {\r\n                        this.game.load.onFileComplete.removeAll();\r\n                        this.addLog(\"正在准备播放..【成功】\", true);\r\n                        return resolve();\r\n                    });\r\n                    this.game.load.start();\r\n                })\r\n            }\r\n            if(flashvars.single && flashvars.offline === '1' && flashvars.wap === '4399'){\r\n                //先初始化4399api\r\n                return H54399Api.init4399Api().then((msg)=>{\r\n                    console.log('4399API',msg)\r\n                    return pload();\r\n                })\r\n            }else{\r\n                return pload();\r\n            }\r\n\r\n        },\r\n\r\n        getGameJson: function (iswapother) {\r\n            flashvars.uuid = flashvars.uuid || '41138941-7f1c-4701-9a94-394893483662';\r\n            const uuid = flashvars.uuid;\r\n\r\n            document.title = flashvars.name && decodeURI(flashvars.name) || \"测试\";\r\n\r\n            const onProgress = evt => {\r\n                if (evt.lengthComputable) {\r\n                    const percentComplete = evt.loaded / evt.total;\r\n                    this.addLog(\"加载用户配置.. \" + ~~percentComplete + '%', true);\r\n                } else {\r\n                    this.addLog(\"加载用户配置.. \" + evt.loaded, true);\r\n                }\r\n            };\r\n\r\n            this.addLog(\"加载用户配置..\");\r\n            const getGame = iswapother ? Xhr.getOtherGame : (flashvars.type == 1 ? Xhr.getTestGame : Xhr.getGame);\r\n            return getGame(uuid, onProgress).then(game => {\r\n                this.addLog(\"加载用户配置..【成功】\", true);\r\n                return game;\r\n            }, e => {\r\n                this.addLog(\"发生错误：\" + e);\r\n                return Promise.reject(e);\r\n            });\r\n        },\r\n\r\n        addLog: function (info, replace) {\r\n            if (!info) {\r\n                return;\r\n            }\r\n            let logInfo = this.game.world.getByName('logInfo');\r\n            if (!logInfo) {\r\n                const style = {font: \"16px 宋体\", fill: \"#fff\"};\r\n                //logInfo = this.game.add.text(18, 540 - 36, '', style);\r\n                logInfo = this.game.add.text(18, this.game.world.height - 36, '', style);\r\n                logInfo.name = 'logInfo';\r\n            }\r\n            let text = logInfo.text;\r\n            const textGroup = text.split(/\\r?\\n/gi).filter(t => !!t);\r\n            if (replace) {\r\n                textGroup[textGroup.length - 1] = info;\r\n            } else {\r\n                textGroup.push(info);\r\n            }\r\n            logInfo.text = '';\r\n            textGroup.slice(-4).map(str => logInfo.text += str + '\\n');\r\n            //logInfo.y = 540 - textGroup.length * 26;\r\n            logInfo.y = this.game.world.height - textGroup.length * 26;\r\n        },\r\n\r\n        addButton: function (x, y, width, height, key_normal, key_active, onClick, text, audio, name, parent, isCheckBox) {\r\n            const changeImageText = (textInfo, content, width, height, textObj) => {\r\n                const txtImgOld = textObj.children[0];\r\n                const strContent = content ? content : txtImgOld ? txtImgOld.text : '';\r\n\r\n                if (!strContent) {\r\n                    return;\r\n                }\r\n\r\n                const fontSize = textInfo.fontSize ? parseInt(textInfo.fontSize) : 25;\r\n                const color = textInfo.color ? textInfo.color : '#fefefe';\r\n                const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(fontSize) : fontSize;\r\n                const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(fontSize) : fontSize;\r\n                if (color.indexOf('rgb') !== -1) {\r\n                    const rgb = color.replace('rgb(', '').replace(')', '').split(',');\r\n                    textObj.addColor('#' + ('00000' + (parseInt(rgb[0]) << 16 | parseInt(rgb[1]) << 8 | parseInt(rgb[2])).toString(16)).substr(-6), 0);\r\n                }\r\n                else {\r\n                    textObj.addColor(color === '#ffffff' ? '#fefefe' : color, 0);\r\n                }\r\n                textObj.wordWrapWidth = 540/*width*/;\r\n                this.sceneProxy.addImageFontText([{data:strContent}], fw, fh, textObj, this.sceneProxy.context);\r\n                const w = textObj.children[0].extWidth ? textObj.children[0].extWidth : fw * strContent.length;\r\n                const x = (width - w) / 2 - (textObj.children[0].extMargin ? textObj.children[0].extMargin : 0);\r\n                const y = (height - fh) / 2;\r\n                textObj.children[0].x = x;\r\n                textObj.children[0].y = y;\r\n                textObj.children[0].text = strContent;\r\n\r\n                if (txtImgOld) {\r\n                    txtImgOld.children.forEach(item => item.fontImg.destroy());\r\n                    txtImgOld.destroy();\r\n                }\r\n\r\n                textObj.text = ' ';\r\n            };\r\n            const changeBackground = (buttonGroup, key, text, clear) => {\r\n                const background = buttonGroup.getByName('background');\r\n                const btnObj = buttonGroup.getByName('button');\r\n                const txtObj = buttonGroup.getByName('text');\r\n                const bk_key = this.game.load.cache.checkImageKey(key) ? key : null;\r\n\r\n                if (!btnObj) {\r\n                    return\r\n                }\r\n\r\n                if (txtObj && text) {\r\n                    if (FontUtils.fontFamily) {\r\n                        changeImageText(text, '', width, height, txtObj);\r\n                    }\r\n                    else {\r\n                        txtObj.font = text.fontFamily　|| txtObj.font;\r\n                        txtObj.fontSize = text.fontSize ||　txtObj.fontSize;\r\n                        txtObj.fontWeight = text.fontWeight || txtObj.fontWeight;\r\n                        txtObj.fill = text.color ||　txtObj.fill;\r\n                    }\r\n\r\n                    txtObj.visible = !text.hidden;\r\n                }\r\n                if (bk_key) {\r\n                    let scale = 1;\r\n                    const {width, height} = btnObj;\r\n                    const image = this.game.cache.getImage(bk_key);\r\n\r\n                    if (!image.delay) {\r\n                        scale = Math.min(width / image.width, height / image.height);\r\n                        background.loadTexture(bk_key);\r\n                        background.scale.setTo(scale, scale);\r\n                        background.x = (width - background.width) / 2;\r\n                        background.y = (height - background.height) / 2;\r\n                    }\r\n                    else if (background.key !== bk_key) {\r\n                        this.addGifAnimation(background, bk_key);\r\n                    }\r\n                } else if (!clear) {\r\n                    background.loadTexture(null);\r\n                }\r\n            };\r\n\r\n            const btnGroup= this.game.add.group();\r\n            btnGroup.name = name;\r\n            parent && parent.add(btnGroup);\r\n            btnGroup.x = x;\r\n            btnGroup.y = y;\r\n\r\n            const bk_key_normal = this.game.load.cache.checkImageKey(key_normal) ? key_normal : null;\r\n            const bk_key_active = this.game.load.cache.checkImageKey(key_active) ? key_active : null;\r\n            const bk = this.game.add.image(0, 0, bk_key_normal, null, btnGroup);\r\n            bk.name = 'background';\r\n            const scale = Math.min(width / bk.width, height / bk.height);\r\n            bk.scale.setTo(scale, scale);\r\n            bk.x = (width - bk.width) / 2;\r\n            bk.y = (height - bk.height) / 2;\r\n            this.addGifAnimation(bk, bk_key_normal);\r\n            let isdown = false;\r\n            let btnobj = null;\r\n            let btnpointer = null;\r\n            const butclick = (obj, pointer)=>{\r\n                btnobj = obj;\r\n                btnpointer = pointer;\r\n            }\r\n            const btn = this.game.add.button(0, 0, null, isCheckBox ? onClick : butclick, this, 0, 0, 0, 0, btnGroup);\r\n            btn.width = width;\r\n            btn.height = height;\r\n            btn.name = \"button\";\r\n            if (audio) {\r\n                audio.prevolume = audio.prevolume !== undefined ? audio.prevolume : audio.volume;\r\n                this.game.device.desktop ? btn.setOverSound(audio) : btn.setDownSound(audio);\r\n                this.game.device.desktop ? btn.onInputOut.add(() => audio.stop()) : btn.onInputUp.add(() => {});\r\n            }\r\n\r\n            let textObj = null;\r\n            if (text) {\r\n                const fontStyle = {};\r\n                let ff = '';\r\n                ff += text.normal.fontWeight ? text.normal.fontWeight + ' ' : 'normal ';\r\n                ff += text.normal.fontSize ? parseInt(text.normal.fontSize) + 'px ' : '';\r\n                ff += text.normal.fontFamily ? text.normal.fontFamily : this.sceneProxy.json_data.font ? this.sceneProxy.json_data.font.fontFamily : '';\r\n\r\n                fontStyle.font = ff;\r\n                fontStyle.fill = text.normal.color;\r\n                fontStyle.stroke = text.normal.stroke;\r\n                fontStyle.strokeThickness = text.normal.stroke ? 2 : 0;\r\n\r\n                fontStyle.boundsAlignH = \"center\";\r\n                fontStyle.boundsAlignV = \"middle\";\r\n                textObj = this.game.add.text(0, 0, text.text, fontStyle, btnGroup);\r\n                textObj.name = 'text';\r\n                if (FontUtils.fontFamily) {\r\n                    changeImageText(text.normal, text.text, width, height, textObj);\r\n                }\r\n                else {\r\n                    textObj.setTextBounds(0, (textObj.height - parseInt(text.normal.fontSize || 12)) / 2, width, height);\r\n                }\r\n                text.normal.hidden && (textObj.visible = false);\r\n            }\r\n            btn.input.mouseOut = function () {\r\n                if (this.sprite === null || !this.sprite.inputEnabled)\r\n                {\r\n                    //  Abort. We've been destroyed.\r\n                    return;\r\n                }\r\n                var data = this._pointerData[0];\r\n\r\n                data.isOver = false;\r\n                data.isOut = true;\r\n                data.timeOut = this.game.time.time;\r\n\r\n                if (this.useHandCursor && data.isDragged === false)\r\n                {\r\n                    this.game.canvas.style.cursor = \"default\";\r\n                    this._setHandCursor = false;\r\n                }\r\n\r\n                if (this.sprite && this.sprite.events)\r\n                {\r\n                    this.sprite.events.onInputOut$dispatch(this.sprite, null);\r\n\r\n                    if (this.sprite && this.sprite.parent && this.sprite.parent.type === Phaser.GROUP)\r\n                    {\r\n                        this.sprite.parent.onChildInputOut.dispatch(this.sprite, null);\r\n                    }\r\n                }\r\n            };\r\n            !isCheckBox && btn.onInputOver.add(() => {\r\n                btn.onOverSound && (btn.onOverSound.volume = (btn.onOverSound.prevolume !== undefined ? btn.onOverSound.prevolume : btn.onOverSound.volume) * Utils.soundVolume)\r\n                changeBackground(btnGroup, bk_key_active, text && text.normal);\r\n                /*this.game.input.mouse.onMouseOut = () => {\r\n                    btn.input.mouseOut();\r\n                };*/\r\n            });\r\n            !isCheckBox && btn.onInputOut.add(() => {isdown = false;changeBackground(btnGroup, bk_key_normal, text && text.normal)});\r\n            !isCheckBox && btn.onInputDown.add(() => {\r\n                isdown = true;\r\n                btn.onDownSound && (btn.onDownSound.volume = (btn.onDownSound.prevolume !== null ?  btn.onDownSound.prevolume: btn.onDownSound.volume) * Utils.soundVolume)\r\n                changeBackground(btnGroup, bk_key_active, text && text.active)\r\n            });\r\n            !isCheckBox && btn.onInputUp.add(() => {isdown = false;changeBackground(btnGroup, bk_key_normal, text && text.normal);onClick && onClick(btnobj,btnpointer)});\r\n\r\n            btnGroup.changeBackground = function (key, text, type) {\r\n                changeBackground(this, key, text, type)\r\n            };\r\n            btnGroup.button = btn;\r\n            btnGroup.text = textObj;\r\n            return btnGroup;\r\n        },\r\n\r\n        addGifAnimation: function(obj, key) {\r\n            const image = this.game.cache.getImage(obj.key, true);\r\n            const {frames, loopCount} = image.data;\r\n            if (frames) {\r\n                let nCount = 1;\r\n                const setFrame = index => {\r\n                    if (!frames[index] || !frames[index].blobUrl) {\r\n                        return;\r\n                    }\r\n                    const img = new Image();\r\n                    img.onload = e => {\r\n                        const base = new PIXI.BaseTexture(e.target);\r\n                        const texture = new PIXI.Texture(base);\r\n                        obj && obj.parent && obj.setTexture(texture);\r\n                    };\r\n                    //img.src = frames[index].base64;\r\n                    img.src = frames[index].blobUrl;\r\n                };\r\n\r\n                const update = index => {\r\n                    Utils.timeout(frames[index].delay * 10).then(() => {\r\n                        setFrame(index);\r\n                        index++;\r\n                        if (index >= frames.length) {\r\n                            if (loopCount && nCount >= loopCount || !obj || !obj.parent) {\r\n                                return;\r\n                            } else {\r\n                                nCount++;\r\n                                update(0)\r\n                            }\r\n                        } else {\r\n                            update(index)\r\n                        }\r\n                    });\r\n                };\r\n                update(0);\r\n            }\r\n        },\r\n\r\n        addFitImageSprint: function (x, y, width, height, key, parent, index) {\r\n            const sKey = this.game.load.cache.checkImageKey(key) ? key : null;\r\n            const sprite = this.game.add.sprite(x, y, sKey);\r\n            if (sKey) {\r\n                const scale = Math.min(width / sprite.width, height / sprite.height);\r\n                sprite.pivot.x = sprite.width / 2;\r\n                sprite.pivot.y = sprite.height / 2;\r\n                sprite.scale.setTo(scale, scale);\r\n                sprite.x += sprite.width / 2;\r\n                sprite.y += sprite.height / 2;\r\n            }\r\n            if (index > 0) {\r\n                let i = 0;\r\n                for (i=0; i<parent.children.length; i++) {\r\n                    let rs = parent.getAt(i);\r\n                    if (-1 === rs) break;\r\n                    if (rs.zIndex === index) {\r\n                        parent.removeChildAt(i);\r\n                        rs.destroy();\r\n                        break;\r\n                    }\r\n                    else if (rs.zIndex > index) {\r\n                        break;\r\n                    }\r\n                }\r\n                let childGroup = this.game.add.group();\r\n                childGroup.add(sprite);\r\n                childGroup.zIndex = index;\r\n                parent.add(childGroup, false, i);\r\n            }\r\n            else {\r\n                parent.add(sprite);\r\n            }\r\n\r\n            return sprite;\r\n        },\r\n\r\n        game: null,\r\n        onRendered: null,\r\n        sceneProxy: null\r\n    },\r\n\r\n    // STATIC MEMBERS\r\n    {\r\n        /**\r\n         * @static\r\n         * @type {string}\r\n         */\r\n        TEXT_CHANGED: 'textChanged'\r\n    }\r\n);\r\n","/**\r\n * Created by 4399-1126 on 2016/9/13.\r\n */\r\nimport puremvc from 'puremvc';\r\nimport FontUtils from '../../common/FontUtils.js';\r\nimport PhoneUtils from '../../common/PhoneUtils.js';\r\n\r\npuremvc.define\r\n(\r\n    {\r\n        name: 'diygamePlayer.view.mediator.CoverMediator',\r\n        parent: puremvc.Mediator\r\n    },\r\n    {\r\n        listNotificationInterests: function () {\r\n            return [\r\n                diygamePlayer.AppConstants.SCENE_GOTO_COVERMENU\r\n            ]\r\n        },\r\n\r\n        handleNotification: function (note) {\r\n            switch (note.getName()) {\r\n                case diygamePlayer.AppConstants.SCENE_GOTO_COVERMENU:\r\n                    this.showCoverLayer();\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        },\r\n\r\n        onRegister: function () {\r\n            this.sceneProxy = this.facade.retrieveProxy(diygamePlayer.model.proxy.SceneProxy.NAME);\r\n            const sceneMediator = this.facade.retrieveMediator(diygamePlayer.view.mediator.SceneMediator.NAME);\r\n            this.game = sceneMediator.viewComponent && sceneMediator.viewComponent.game;\r\n            this.viewComponent = sceneMediator.viewComponent;\r\n        },\r\n\r\n        addCover: function () {\r\n            const {template, cover} = this.sceneProxy.json_data;\r\n            const {titleContainer, startMenu, loadMenu, settingsMenu, overMenu} = template.json.cover;\r\n            const worldWidth = this.game.world.width;\r\n            const worlHeight = this.game.world.height;\r\n\r\n            const addTextContent = (x, y, width, height, content, objText, name, isTitle) => {\r\n                const fontStyle = {};\r\n                let ff = '';\r\n                ff += objText.fontWeight ? objText.fontWeight + ' ' : 'normal ';\r\n                ff += objText.fontSize ? parseInt(objText.fontSize) + 'px ' : '';\r\n                ff += objText.fontFamily ? objText.fontFamily : '';\r\n\r\n                fontStyle.font = ff;\r\n                fontStyle.fill = objText.color;\r\n                fontStyle.stroke = objText.stroke;\r\n                fontStyle.strokeThickness = objText.stroke ? 2 : 0;\r\n\r\n                fontStyle.boundsAlignH = \"center\";\r\n                fontStyle.boundsAlignV = isTitle ? \"bottom\" : \"middle\";\r\n                const txt = this.game.add.text(0, 0, content, fontStyle, this.sceneProxy.coverLayer);\r\n                txt.name = name;\r\n                if (FontUtils.fontFamily) {\r\n                    const color = (objText.color === '#ffffff' ? '#fefefe' : objText.color).replace('#', '0x');\r\n                    const fontSize = objText.fontSize ? parseInt(objText.fontSize) : 25;\r\n                    txt.colors.splice(0, txt.colors.length);\r\n                    txt.text = ' ';\r\n                    txt.fill = color;\r\n                    txt.addColor(color, 0);\r\n                    txt.x = (worldWidth - fontSize * content.length) / 2;\r\n                    txt.y = y;\r\n                    txt.wordWrapWidth = worldWidth;\r\n\r\n                    const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(fontSize) : fontSize;\r\n                    const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(fontSize) : fontSize;\r\n                    this.sceneProxy.addImageFontText([{data:content}], fw, fh, txt, this.sceneProxy.context);\r\n                }\r\n                else {\r\n                    txt.setTextBounds(x, y + (txt.height - parseInt(objText.fontSize)) / 2, width, height);\r\n                }\r\n                objText.hidden && (txt.visible = false);\r\n                return txt;\r\n            };\r\n\r\n            const addButton = (obj, name, text) => {\r\n                const t = {};\r\n                t.normal = obj.normal.text;\r\n                t.active = obj.active.text;\r\n                t.text = text;\r\n                const btnGroup = this.viewComponent.addButton(obj.rect.x,\r\n                    obj.rect.y,\r\n                    obj.rect.width,\r\n                    obj.rect.height,\r\n                    obj.normal.background.url,\r\n                    obj.active.background.url,\r\n                    onBtnClicked,\r\n                    t,\r\n                    this.sceneProxy.btn_sound,\r\n                    name,\r\n                    this.sceneProxy.coverLayer\r\n                );\r\n                btnGroup.button.onInputUp.add(() => this.sceneProxy.btn_sound && this.sceneProxy.btn_sound.stop())\r\n            };\r\n\r\n            const onBtnClicked = (obj, pointer) => {\r\n                if (pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n                    return;\r\n                }\r\n                if (obj.parent.name === 'cover_button_start') {\r\n                    // 开始游戏\r\n                    this.sceneProxy.onCoverStartBtnClicked();\r\n                }\r\n                else if (obj.parent.name === 'cover_button_load') {\r\n                    // 加载按钮\r\n                    this.sceneProxy.onCoverLoadBtnClicked();\r\n                }\r\n                else if (obj.parent.name === 'cover_button_settings') {\r\n                    // 设置按钮\r\n                    this.sceneProxy.onCoverSettingBtnClicked();\r\n                }\r\n                else if (obj.parent.name === 'cover_button_over') {\r\n                    // 游戏结束\r\n                    this.sceneProxy.onCoverOverBtnClicked();\r\n                }\r\n            };\r\n\r\n            let bk = this.viewComponent.game.add.graphics(0, 0, this.sceneProxy.coverLayer);\r\n            bk.beginFill(0);\r\n            bk.drawRect(0,0,worldWidth,worlHeight);\r\n            bk.endFill();\r\n            /*blackBk.beginFill(0x0);\r\n            blackBk.moveTo(0, 0);\r\n            blackBk.lineTo(worldWidth, 0);\r\n            blackBk.lineTo(worldWidth, worlHeight);\r\n            blackBk.lineTo(0, worlHeight);\r\n            blackBk.lineTo(0, 0);\r\n            blackBk.endFill();\r\n            blackBk.inputEnabled = true;*/\r\n\r\n            const backgroundKey = cover.background.url;\r\n            if(this.game.load.cache.checkImageKey(backgroundKey)){\r\n                bk = this.sceneProxy.coverLayer.create(0, 0,backgroundKey);\r\n            }\r\n            this.sceneProxy.prePlotBkKey = this.sceneProxy.lstPlotBkKey;\r\n            this.sceneProxy.lstPlotBkKey = cover.background.url;\r\n            this.sceneProxy.lstPlotBkFlex = cover.background.flex;\r\n            this.sceneProxy.lstPlotBkOpacity = cover.background.opacity;\r\n            this.sceneProxy.lstGameBk = this.viewComponent.game.add.sprite(0, 0, this.game.load.cache.checkImageKey(backgroundKey) && backgroundKey);\r\n            bk.inputEnabled = true;\r\n            if (cover.background.flex === 3) {// 填充\r\n                let rate = bk.width / bk.height < worldWidth / worlHeight ? worldWidth / bk.width : worlHeight / bk.height;\r\n                bk.width *= rate;\r\n                bk.height *= rate;\r\n                bk.x = -(bk.width - worldWidth) / 2;\r\n                bk.y = -(bk.height - worlHeight) / 2;\r\n            }\r\n            else if (cover.background.flex === 5) {// 适应\r\n                let rate = 0;\r\n                if (bk.width / bk.height > worldWidth / worlHeight) {\r\n                    rate = worldWidth / bk.width;\r\n                    bk.width *= rate;\r\n                    bk.height *= rate;\r\n                    bk.y = (worlHeight - bk.height) / 2;\r\n                }\r\n                else {\r\n                    rate = worlHeight / bk.height;\r\n                    bk.width *= rate;\r\n                    bk.height *= rate;\r\n                    bk.x = (worldWidth - bk.width) / 2;\r\n                }\r\n            }\r\n            else {\r\n                bk.width = worldWidth;\r\n                bk.height = worlHeight;\r\n            }\r\n            this.sceneProxy.lstGameBk.x = bk.x;\r\n            this.sceneProxy.lstGameBk.y = bk.y;\r\n            this.sceneProxy.lstGameBk.width = bk.width;\r\n            this.sceneProxy.lstGameBk.height = bk.height;\r\n            // 封面标题背景\r\n            if (cover.title.data && !titleContainer.title.text.hidden) {\r\n                this.viewComponent.addFitImageSprint(titleContainer.rect.x,\r\n                    titleContainer.rect.y,\r\n                    titleContainer.rect.width,\r\n                    titleContainer.rect.height,\r\n                    titleContainer.background.url,\r\n                    this.sceneProxy.coverLayer\r\n                );\r\n            }\r\n\r\n            const {font_size, color, bold, fontFamily, hidden} = cover.title;\r\n            const titleText = titleContainer.title.text;\r\n            font_size && (titleText.fontSize = font_size);\r\n            color && (titleText.color = color);\r\n            bold !== undefined && (titleText.fontWeight = bold ? 'bold' : 'normal');\r\n            titleText.fontFamily = this.sceneProxy.json_data.font ? this.sceneProxy.json_data.font.fontFamily : fontFamily ? fontFamily : '';\r\n            hidden !== undefined && (titleText.hidden = hidden);\r\n\r\n            // 封面标题文字\r\n            addTextContent(titleContainer.title.rect.x + titleContainer.rect.x\r\n                , titleContainer.title.rect.y + titleContainer.rect.y\r\n                , titleContainer.title.rect.width\r\n                , titleContainer.title.rect.height\r\n                , cover.title.data\r\n                , titleText\r\n                , 'cover_text_title'\r\n                , true);\r\n\r\n            // 封面菜单-开始游戏\r\n            if (!startMenu.hidden) {\r\n                addButton(startMenu, 'cover_button_start', this.sceneProxy.stringMap.startMenu);\r\n            }\r\n\r\n            // 封面菜单-加载档案\r\n            if (!loadMenu.hidden) {\r\n                addButton(loadMenu, 'cover_button_load', this.sceneProxy.stringMap.loadMenu);\r\n            }\r\n\r\n            // 封面菜单-环境设置\r\n            if (!settingsMenu.hidden) {\r\n                addButton(settingsMenu, 'cover_button_settings', this.sceneProxy.stringMap.settingsMenu);\r\n            }\r\n\r\n            // 封面菜单-游戏结束\r\n            if (!overMenu.hidden) {\r\n                addButton(overMenu, 'cover_button_over', this.sceneProxy.stringMap.overMenu);\r\n            }\r\n            this.sceneProxy.coverLayer.visible = false;\r\n        },\r\n\r\n        showCoverLayer: function () {\r\n            this.sceneProxy.lstPlotLayer && this.sceneProxy.lstPlotLayer.destroy();\r\n            this.sceneProxy.curPlotLayer && this.sceneProxy.curPlotLayer.destroy();\r\n            this.sceneProxy.dialogLayer.visible = false;\r\n            this.sceneProxy.menuLayer.visible = false;\r\n            this.sceneProxy.lstGameBk && (this.sceneProxy.lstGameBk.visible = true);\r\n            if (this.sceneProxy.coverLayer.children.length === 0) {\r\n                this.addCover()\r\n            }\r\n\r\n            // 封面背景音乐\r\n            const {music, background} = this.sceneProxy.json_data.cover;\r\n            if (this.sceneProxy.bk_music) {\r\n                this.sceneProxy.stopMusic();\r\n            }\r\n            if (music && (this.game.load.cache.checkSoundKey(music.url) || PhoneUtils.isAudioInCache(music.url) && flashvars.client === 'ios' && '1.5.0' <= flashvars.app_version)) {\r\n                this.sceneProxy.playMusic(music.url, music.volume, true);\r\n            }\r\n            this.sceneProxy.lstPlotBkKey = background.url;\r\n            this.sceneProxy.lstPlotBkOpacity = background.opacity;\r\n            this.sceneProxy.lstPlotBkFlex = background.flex;\r\n            this.sceneProxy.coverLayer.visible = true;\r\n            this.game.world.bringToTop(this.sceneProxy.coverLayer);\r\n        }\r\n    },\r\n    {\r\n        /**\r\n         * @static\r\n         * @type {string}\r\n         */\r\n        NAME: 'CoverMediator'\r\n    }\r\n);","/**\r\n * Created by liuE on 2016/10/9.\r\n */\r\n/**\r\n * Created by 4399-1126 on 2016/9/13.\r\n */\r\nimport puremvc from 'puremvc';\r\npuremvc.define\r\n(\r\n    {\r\n        name: 'diygamePlayer.view.mediator.EndMediator',\r\n        parent: puremvc.Mediator\r\n    },\r\n    {\r\n        listNotificationInterests: function () {\r\n            return [\r\n                diygamePlayer.AppConstants.SCENE_GOTO_END\r\n            ]\r\n        },\r\n\r\n        handleNotification: function (note) {\r\n            switch (note.getName()) {\r\n                case diygamePlayer.AppConstants.SCENE_GOTO_END:\r\n                    this.showEndLayer();\r\n                default:\r\n                    break;\r\n            }\r\n        },\r\n\r\n        onRegister: function () {\r\n            this.sceneProxy = this.facade.retrieveProxy(diygamePlayer.model.proxy.SceneProxy.NAME);\r\n            const sceneMediator = this.facade.retrieveMediator(diygamePlayer.view.mediator.SceneMediator.NAME);\r\n            this.game = sceneMediator.viewComponent && sceneMediator.viewComponent.game;\r\n        },\r\n\r\n        btnStatesChanged: function (b, p, btnObj, txtObj, keyBk, text, inputEnabled) {\r\n            if (txtObj) {\r\n                txtObj.font = text.fontFamily;\r\n                txtObj.fontSize = text.fontSize;\r\n                txtObj.fontWeight = text.fontWeight;\r\n                txtObj.fill = text.color;\r\n                txtObj.visible = !text.hidden;\r\n                if (inputEnabled !== undefined) {\r\n                    txtObj.inputEnabled = inputEnabled;\r\n                }\r\n            }\r\n\r\n            this.loadTexture(btnObj, keyBk);\r\n        },\r\n\r\n        loadTexture: function (button, key) {\r\n            if (!button) {\r\n                return;\r\n            }\r\n            const {width, height} = button;\r\n            const buttonKey = this.game.cache.checkImageKey(key) ? key : null;\r\n            button.loadTexture(buttonKey);\r\n            button.width = width;\r\n            button.height = height;\r\n        },\r\n\r\n        addEnd: function () {\r\n\r\n            const addButton = (x, y, key, width, height, name) => {\r\n                const bk_key = this.game.cache.checkImageKey(key) ? key : null;\r\n                const button = this.game.add.button(x, y, bk_key, onBtnClicked, this, 0, 0, 0, 0, this.sceneProxy.endLayer);\r\n                button.width = width;\r\n                button.height = height;\r\n                button.name = name;\r\n                return button;\r\n            };\r\n\r\n            const addTextContent = (x, y, width, height, content, objText, name) => {\r\n                const fontStyle = {};\r\n                let ff = '';\r\n                ff += objText.fontWeight ? objText.fontWeight + ' ' : 'normal ';\r\n                ff += objText.fontSize ? parseInt(objText.fontSize) + 'px ' : '';\r\n                ff += objText.fontFamily ? objText.fontFamily : '';\r\n\r\n                fontStyle.font = ff;\r\n                fontStyle.fill = objText.color;\r\n                fontStyle.boundsAlignH = \"center\";\r\n                fontStyle.boundsAlignV = \"middle\";\r\n                const txt = this.game.add.text(0, 0, content, fontStyle, this.sceneProxy.endLayer);\r\n                txt.name = name;\r\n                txt.setTextBounds(x, y + (txt.height - parseInt(objText.fontSize)) / 2, width, height);\r\n                objText.hidden && (txt.visible = false);\r\n                return txt;\r\n            };\r\n\r\n            /*const giveCandy = () => {\r\n                let text = this.sceneProxy.endLayer.getByName(\"end_text_candy_tip\");\r\n\r\n                !text && (text = addTextContent(144\r\n                    , 220\r\n                    , 96\r\n                    , 20\r\n                    , \"赠送糖果成功(测试)\"\r\n                    , {\r\n                        fontFamily: \"\",\r\n                        fontSize: \"12px\",\r\n                        color: \"#ef7297\"\r\n                    }\r\n                    , 'end_text_candy_tip'));\r\n                text.visible = true;\r\n                this.timer && this.game.time.events.remove(this.timer);\r\n                this.timer = this.game.time.events.add(1000, () => {\r\n                    text.visible = false;\r\n                })\r\n            };*/\r\n\r\n            const onBtnClicked = (obj, pointer) => {\r\n                if (pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n                    return;\r\n                }\r\n                switch (obj.name) {\r\n                    /*case 'end_button_candy':\r\n                        this.btnStatesChanged(null, null, obj, this.sceneProxy.endLayer.getByName(\"end_text_candy\"), 'icon_candy', text_normal);\r\n                        giveCandy();\r\n                        break;*/\r\n                    case 'end_button_get':\r\n                        this.btnStatesChanged(null, null, obj, this.sceneProxy.endLayer.getByName('end_text_gte'), 'icon_get', text_normal);\r\n                        this.sceneProxy.endLayer.visible = false;\r\n                        this.sceneProxy.visibleLayout = [this.sceneProxy.endLayer, ...this.sceneProxy.visibleLayout];\r\n                        this.sceneProxy.showLoad();\r\n                        break;\r\n                    case 'end_button_back':\r\n                        this.sceneProxy.reStart(this.sceneProxy.isExtend());\r\n                        this.btnStatesChanged(null, null, obj, this.sceneProxy.endLayer.getByName(\"end_text_back\"), 'icon_back', text_normal);\r\n                        this.sceneProxy.endLayer.visible = false;\r\n                        break;\r\n                    case 'end_button_save':\r\n                        this.btnStatesChanged(null, null, obj, this.sceneProxy.endLayer.getByName(\"end_text_save\"), 'icon_save', text_normal);\r\n                        this.sceneProxy.showSave();\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }\r\n            };\r\n\r\n            const itemBlackBk = this.game.add.bitmapData(this.game.world.width, this.game.world.height);\r\n            itemBlackBk.fill(0, 0, 0, 0.8);\r\n            const item_bk = this.game.add.sprite(0, 0, itemBlackBk);\r\n            item_bk.width = this.game.world.width;\r\n            item_bk.height = this.game.world.height;\r\n            item_bk.inputEnabled = true;\r\n            this.sceneProxy.endLayer.add(item_bk);\r\n\r\n            const text_normal = {\r\n                fontFamily: \"\",\r\n                fontSize: \"14px\",\r\n                color: \"#ffffff\"\r\n            };\r\n\r\n            const text_active = {\r\n                fontFamily: \"\",\r\n                fontSize: \"14px\",\r\n                color: \"#ef7297\"\r\n            };\r\n\r\n            /*const btn_candy = addButton(144, 100, 'icon_candy', 96, 96, 'end_button_candy');\r\n            const txt_candy = addTextContent(144, 200, 96, 30, \"游戏好棒，送颗糖\", text_normal, 'end_text_candy');\r\n\r\n            btn_candy.onInputOver.add(this.btnStatesChanged, this, 0, btn_candy, txt_candy, 'icon_candy_over_pressed', text_active);\r\n            btn_candy.onInputDown.add(this.btnStatesChanged, this, 0, btn_candy, txt_candy, 'icon_candy_over_pressed', text_active);\r\n            btn_candy.onInputOut.add(this.btnStatesChanged, this, 0, btn_candy, txt_candy, 'icon_candy', text_normal);*/\r\n\r\n            const btn_load = addButton(flashvars.vertical ? 55 : 168, flashvars.vertical ? 427 : 100, 'icon_get', 96, 96, 'end_button_get');\r\n            const txt_load = addTextContent(flashvars.vertical ? 55 : 168, flashvars.vertical ? 527 : 200, 96, 30, \"读取进度\", text_normal, 'end_text_get');\r\n\r\n            btn_load.onInputOver.add(this.btnStatesChanged, this, 0, btn_load, txt_load, 'icon_get_hover_pressed', text_active);\r\n            btn_load.onInputDown.add(this.btnStatesChanged, this, 0, btn_load, txt_load, 'icon_get_hover_pressed', text_active);\r\n            btn_load.onInputOut.add(this.btnStatesChanged, this, 0, btn_load, txt_load, 'icon_get', text_normal);\r\n\r\n            const btn_back = addButton(flashvars.vertical ? 216 : 432, flashvars.vertical ? 427 : 100, 'icon_back', 96, 96, 'end_button_back');\r\n            const txt_back = addTextContent(flashvars.vertical ? 216 : 432, flashvars.vertical ? 527 : 200, 96, 30, \"返回封面\", text_normal, 'end_text_back');\r\n\r\n            btn_back.onInputOver.add(this.btnStatesChanged, this, 0, btn_back, txt_back, 'icon_back_over_pressed', text_active);\r\n            btn_back.onInputDown.add(this.btnStatesChanged, this, 0, btn_back, txt_back, 'icon_back_over_pressed', text_active);\r\n            btn_back.onInputOut.add(this.btnStatesChanged, this, 0, btn_back, txt_back, 'icon_back', text_normal);\r\n\r\n            const btn_save = addButton(flashvars.vertical ? 377 : 696, flashvars.vertical ? 427 : 100, 'icon_save', 96, 96, 'end_button_save');\r\n            const txt_save = addTextContent(flashvars.vertical ? 377 : 696, flashvars.vertical ? 527 : 200, 96, 30, \"存个档，下次玩\", text_normal, 'end_text_save');\r\n\r\n            btn_save.onInputOver.add(this.btnStatesChanged, this, 0, btn_save, txt_save, 'icon_save_over_pressed', text_active);\r\n            btn_save.onInputDown.add(this.btnStatesChanged, this, 0, btn_save, txt_save, 'icon_save_over_pressed', text_active);\r\n            btn_save.onInputOut.add(this.btnStatesChanged, this, 0, btn_save, txt_save, 'icon_save', text_normal);\r\n\r\n            this.sceneProxy.endLayer.visible = false;\r\n        },\r\n\r\n        showEndLayer: function () {\r\n            this.sceneProxy.getSnap();\r\n            if (this.sceneProxy.endLayer.children.length === 0) {\r\n                this.addEnd()\r\n            }\r\n\r\n            this.game.world.bringToTop(this.sceneProxy.endLayer);\r\n            this.sceneProxy.endLayer.visible = true;\r\n        }\r\n    },\r\n    {\r\n        /**\r\n         * @static\r\n         * @type {string}\r\n         */\r\n        NAME: 'EndMediator'\r\n    }\r\n);","import Utils from '../../common/Utils.js';\r\n\r\nexport function HtmlTextBox(game,x,y,width,height,text,color,size,family,bold)\r\n{\r\n    Phaser.Group.call(this,game);\r\n\r\n    this.game = game;\r\n    this.name = 'input';\r\n    this.parentElement = game.canvas.parentNode;\r\n\r\n    //创建一个inputElement\r\n    this.textBoxElement = document.createElement('input');\r\n    this.textBoxElement.style.position = 'absolute';\r\n    this.textBoxElement.style.margin = '0';\r\n    this.textBoxElement.style.border = '0';\r\n    this.textBoxElement.style.padding = '0';\r\n    this.textBoxElement.style.left = x+'px';\r\n    this.textBoxElement.style.top = y+'px';\r\n    this.textBoxElement.style.width = width+'px';\r\n    this.textBoxElement.style.height = height+'px';\r\n    this.textBoxElement.style.color = color;\r\n    this.textBoxElement.style.backgroundColor = 'transparent';\r\n    this.textBoxElement.style.borderColor = 'transparent transparent transparent transparent';\r\n    this.textBoxElement.style.outline = 'none';\r\n    this.textBoxElement.style.fontSize = size + 'px';\r\n    this.textBoxElement.style.fontFamily = family;\r\n    this.textBoxElement.style.fontWeight = bold ? 'bold' : 'normal';\r\n    this.parentElement.insertBefore(this.textBoxElement,game.canvas);\r\n\r\n    this._x = x;\r\n    this._y = y;\r\n    this._width = width;\r\n    this._height = height;\r\n    this._fontSize = size;\r\n    this.text = text;\r\n    this.isValue = false;\r\n\r\n    game.add.existing(this);\r\n    this.onDestroy.add(function(group)\r\n    {\r\n        //删除界面上的Element\r\n        this.parentElement.removeChild(this.textBoxElement);\r\n    },this);\r\n    //this.update();\r\n}\r\n\r\nHtmlTextBox.prototype = Object.create(Phaser.Group.prototype);\r\nHtmlTextBox.prototype.constructor = HtmlTextBox;\r\n//更新函数，用来重新计算TextBox的位置\r\nHtmlTextBox.prototype.update  = function()\r\n{\r\n    let canvas = this.game.canvas;\r\n\r\n    let canvasX = canvas.offsetLeft;\r\n    let canvasY =  canvas.offsetTop;\r\n    let canvasWidth = canvas.offsetWidth;\r\n    let canvasHeight = canvas.offsetHeight;\r\n\r\n    if (this.oldCanvasWidth == canvasWidth && this.oldCanvasHeight == canvasHeight\r\n        && this.oldCanvasX == canvasX && this.oldCanvasY == canvasY) {\r\n        return;\r\n    }\r\n\r\n    let gameWidth = this.game.world.width;\r\n    let gameHeight = this.game.world.height;\r\n\r\n    if (canvas.offsetWidth > canvas.offsetHeight) {\r\n        let widthScale = (flashvars.vertical ? canvasHeight : canvasWidth)/gameWidth;\r\n        let heightScale = (flashvars.vertical ? canvasWidth : canvasHeight)/gameHeight;\r\n\r\n        let xScale = this._x/gameWidth;\r\n        let yScale = this._y/gameHeight;\r\n\r\n        let newX = flashvars.vertical ? (canvasX + canvasWidth - canvasWidth * yScale) : (canvasX + canvasWidth * xScale);\r\n        let newY = flashvars.vertical ? (canvasY + canvasHeight * xScale) : (canvasY + canvasHeight * yScale);\r\n        let newWidth = this._width * widthScale;\r\n        let newHeight = this._height * heightScale;\r\n        let fontSize = this._fontSize * heightScale;\r\n\r\n\r\n        this.setLeft(flashvars.vertical ? (newX - newWidth/2 - newHeight/2) : newX);\r\n        this.setTop(flashvars.vertical ? (newY + newWidth / 2 - newHeight / 2) : newY);\r\n        this.setWidth(newWidth);\r\n        this.setHeight(newHeight);\r\n        this.setFontSize(fontSize);\r\n        this.textBoxElement.style.transform = flashvars.vertical ? 'rotate(90deg)' : 'rotate(0deg)';\r\n    }\r\n    else {\r\n        let widthScale = (flashvars.vertical ? canvasWidth : canvasHeight)/gameWidth;\r\n        let heightScale = (flashvars.vertical ? canvasHeight : canvasWidth)/gameHeight;\r\n\r\n        let xScale = this._x/gameWidth;\r\n        let yScale = this._y/gameHeight;\r\n\r\n        let newX = flashvars.vertical ? (canvasX + canvasWidth * xScale) : (canvasX + canvasWidth - canvasWidth * yScale);\r\n        let newY = flashvars.vertical ? (canvasY + canvasHeight * yScale) : (canvasY + canvasHeight * xScale);\r\n        let newWidth = this._width * widthScale;\r\n        let newHeight = this._height * heightScale;\r\n        let fontSize = this._fontSize * heightScale;\r\n\r\n        this.setLeft(flashvars.vertical ? newX : (newX - newWidth/2 - newHeight/2));\r\n        this.setTop(flashvars.vertical ? newY : (newY + newWidth / 2 - newHeight / 2));\r\n        this.setWidth(newWidth);\r\n        this.setHeight(newHeight);\r\n        this.setFontSize(fontSize);\r\n\r\n        this.textBoxElement.style.transform = flashvars.vertical ? 'rotate(0deg)' : 'rotate(90deg)';\r\n    }\r\n\r\n    this.oldCanvasWidth = canvasWidth;\r\n    this.oldCanvasHeight = canvasHeight;\r\n    this.oldCanvasX = canvasX;\r\n    this.oldCanvasY = canvasY;\r\n};\r\n\r\nHtmlTextBox.prototype.destroy = function () {\r\n    this.parentElement.removeChild(this.textBoxElement);\r\n};\r\n\r\nHtmlTextBox.prototype.show = function (bShow) {\r\n    this.textBoxElement.style.visibility = bShow ? 'visible' : 'hidden';\r\n};\r\n\r\nHtmlTextBox.prototype.setInputCallback = function (callback) {\r\n    const inputUpdate = () => {\r\n        this._text = this.textBoxElement.value;\r\n        Utils.sensitiveWords.forEach(word => {\r\n            if (word.length === 0) return;\r\n\r\n            let index = this._text.indexOf(word);\r\n            if (index !== -1) {\r\n                let rw = '*'.repeat(word.length);\r\n                this._text = this._text.replace(new RegExp(word, 'gi'), rw);\r\n                this.textBoxElement.value = this._text;\r\n            }\r\n        })\r\n        callback(this._text);\r\n    };\r\n    if (flashvars.client === 'ios' || navigator.userAgent.indexOf('iPhone') > -1) {\r\n        /*this.textBoxElement.addEventListener('compositionstart', ()=>{\r\n            this.textBoxElement.style.backgroundColor = \"black\";\r\n        });\r\n        this.textBoxElement.addEventListener(\"compositionupdate\", () => {\r\n            this.textBoxElement.style.backgroundColor = \"red\"; //开始编辑，背景变成黄色\r\n        });*/\r\n        let agentV = navigator.userAgent.match(/CPU\\siPhone\\sOS\\s((([0-9]*)+(_))*)+([0-9]*)/gi);\r\n        if (agentV && (agentV[0] >= 'CPU iPhone OS 10_3_1' || agentV[0] === 'CPU iPhone OS 10_0_2')) {\r\n            this.textBoxElement.addEventListener(\"input\", inputUpdate, false);\r\n        } else {\r\n            this.textBoxElement.addEventListener('compositionend', () => {\r\n                this.textBoxElement.removeEventListener(\"input\", inputUpdate, false);\r\n                this.textBoxElement.addEventListener(\"input\", inputUpdate, false);\r\n            }, false);\r\n        }\r\n    } else {\r\n        this.textBoxElement.addEventListener(\"input\", inputUpdate, false);\r\n    }\r\n\r\n    this.textBoxElement.onblur = ()=> {\r\n        if (this.isValue) {\r\n            let v = parseFloat(this._text);\r\n            v ? this.text = v + '' : this.text = '0';\r\n        }\r\n    }\r\n};\r\n\r\nHtmlTextBox.prototype.setClickCallback = function (callback) {\r\n    this.textBoxElement.addEventListener('click', () => {callback(this);}, false);\r\n};\r\n\r\n//设置位置X\r\nHtmlTextBox.prototype.setLeft = function (left) {\r\n    this.textBoxElement.style.left = left+'px';\r\n};\r\n\r\nHtmlTextBox.prototype.setTop = function (top) {\r\n    this.textBoxElement.style.top = top+'px';\r\n};\r\n\r\n//设置width\r\nHtmlTextBox.prototype.setWidth = function(width) {\r\n    this.textBoxElement.style.width = width+'px';\r\n};\r\n\r\n//设置height\r\nHtmlTextBox.prototype.setHeight = function(height) {\r\n    this.textBoxElement.style.height = height+'px';\r\n};\r\n\r\n// 设置字体大小\r\nHtmlTextBox.prototype.setFontSize = function (fontSize) {\r\n    this.textBoxElement.style.fontSize = fontSize + 'px';\r\n};\r\n\r\n// Enable\r\nHtmlTextBox.prototype.setEnable = function (bEnabled) {\r\n    this.textBoxElement.readOnly = (!!bEnabled).toString();\r\n};\r\n\r\n//使用属性的方式操作X\r\nObject.defineProperty(HtmlTextBox.prototype,'x',\r\n    {\r\n        get:function()\r\n        {\r\n            return this._x;\r\n        },\r\n        set:function(value)\r\n        {\r\n            this.setLeft(value);\r\n            this._x = value;\r\n        }\r\n    });\r\n//使用属性的方式操作Y\r\nObject.defineProperty(HtmlTextBox.prototype,'y',\r\n    {\r\n        get:function()\r\n        {\r\n            return this._y;\r\n        },\r\n        set:function(value)\r\n        {\r\n            this.setTop(value);\r\n            this._y = value;\r\n        }\r\n    });\r\n\r\n//使用属性的方式操作width\r\nObject.defineProperty(HtmlTextBox.prototype,'width',\r\n    {\r\n        get:function()\r\n        {\r\n            return this._width;\r\n        },\r\n        set:function(value)\r\n        {\r\n            this.setWidth(value);\r\n            this._width = value;\r\n        }\r\n    });\r\n\r\n//使用属性的方式操作height\r\nObject.defineProperty(HtmlTextBox.prototype,'height',\r\n    {\r\n        get:function()\r\n        {\r\n            return this._height;\r\n        },\r\n        set:function(value)\r\n        {\r\n            this.setHeight(value);\r\n            this._height = value;\r\n        }\r\n    });\r\n\r\n//使用属性的方式操作fontSize\r\nObject.defineProperty(HtmlTextBox.prototype,'fontSize',\r\n    {\r\n        get:function () {\r\n            return this._fontSize;\r\n        },\r\n        set:function (value) {\r\n            this.setFontSize(value);\r\n            this._fontSize = value;\r\n        }\r\n    });\r\n\r\n//使用属性的方式操作style\r\nObject.defineProperty(HtmlTextBox.prototype,'style',\r\n    {\r\n        get:function()\r\n        {\r\n            return this._style;\r\n        },\r\n        set:function(value)\r\n        {\r\n            for(var key in value)\r\n            {\r\n                this.textBoxElement.style[key] = value[key];\r\n            }\r\n            this._style = value;\r\n        }\r\n    });\r\n\r\n//设置字体\r\nObject.defineProperty(HtmlTextBox.prototype,'text',\r\n    {\r\n        get:function()\r\n        {\r\n            return this._text;\r\n        },\r\n        set:function(value)\r\n        {\r\n            this.textBoxElement.value = value;\r\n            this._text = value;\r\n        }\r\n    });\r\n\r\n// enable\r\nObject.defineProperty(HtmlTextBox.prototype,'readOnly',\r\n    {\r\n        get:function()\r\n        {\r\n            return this.readOnly;\r\n        },\r\n        set:function(value)\r\n        {\r\n            this.setEnable(value);\r\n            this.textBoxElement.readOnly = (!!value).toString();\r\n        }\r\n    });","/**\r\n * Created by 4399-1126 on 2016/9/13.\r\n */\r\nimport puremvc from 'puremvc';\r\nimport FontUtils from '../../common/FontUtils.js';\r\npuremvc.define\r\n(\r\n    {\r\n        name: 'diygamePlayer.view.mediator.MainMenuMediator',\r\n        parent: puremvc.Mediator\r\n    },\r\n    {\r\n        listNotificationInterests: function () {\r\n            return [\r\n                diygamePlayer.AppConstants.SCENE_GOTO_MAINMENU\r\n            ]\r\n        },\r\n\r\n        handleNotification: function (note) {\r\n            const body = note.getBody();\r\n            switch (note.getName()) {\r\n                case diygamePlayer.AppConstants.SCENE_GOTO_MAINMENU:\r\n                    this.showMainMenuLayer(body);\r\n                default:\r\n                    break;\r\n            }\r\n        },\r\n\r\n        onRegister: function () {\r\n            this.sceneProxy = this.facade.retrieveProxy(diygamePlayer.model.proxy.SceneProxy.NAME);\r\n            this.sceneMediator = this.facade.retrieveMediator(diygamePlayer.view.mediator.SceneMediator.NAME);\r\n            this.game = this.sceneMediator.viewComponent && this.sceneMediator.viewComponent.game;\r\n            this.viewComponent = this.sceneMediator.viewComponent;\r\n            this.isAllHide = false;\r\n        },\r\n        /**\r\n         * 添加系统菜单\r\n         */\r\n        addMainMenu: function () {\r\n            const {background, header, save, load, playback, settings, autoplay, back} = this.sceneProxy.json_data.template.json.mainMenu;\r\n\r\n            const addImgFontText = (textInfo, x, y, width, height, content, textObj) => {\r\n                const fontSize = textInfo.fontSize ? parseInt(textInfo.fontSize) : 25;\r\n                const color = textInfo.color ? textInfo.color : '#fefefe';\r\n\r\n                const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(fontSize) : fontSize;\r\n                const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(fontSize) : fontSize;\r\n                const w = fw * content.length;\r\n                const l = x + (width - w) / 2;\r\n                const t = y + (height - fh) / 2;\r\n                const txtImg = this.sceneProxy.addRetroText(l, t, w, fh, content);\r\n                txtImg.tint = (color === '#ffffff' ? '#fefefe' : color).replace('#', '0x');\r\n\r\n                textObj.addChild(txtImg);\r\n                textObj.text = ' ';\r\n            };\r\n            const addTextContent = (x, y, width, height, content, objText, name) => {\r\n                const fontStyle = {};\r\n                let ff = '';\r\n                ff += objText.fontWeight ? objText.fontWeight + ' ' : 'normal ';\r\n                ff += objText.fontSize ? parseInt(objText.fontSize) + 'px ' : '';\r\n                ff += this.sceneProxy.json_data.font ? this.sceneProxy.json_data.font.fontFamily : objText.fontFamily ? objText.fontFamily : '';\r\n\r\n                fontStyle.font = ff;\r\n                fontStyle.fill = objText.color;\r\n                fontStyle.boundsAlignH = \"center\";\r\n                fontStyle.boundsAlignV = \"middle\";\r\n                fontStyle.stroke = objText.stroke;\r\n                fontStyle.strokeThickness = objText.stroke ? 2 : 0;\r\n\r\n                const txt = this.viewComponent.game.add.text(0, 0, content, fontStyle, this.sceneProxy.mainMenuLayer);\r\n                txt.name = name;\r\n                if (FontUtils.fontFamily) {\r\n                    addImgFontText(objText, x, y, width, height, content, txt);\r\n                }\r\n                else {\r\n                    txt.setTextBounds(x, y + (txt.height - parseInt(objText.fontSize)) / 2, width, height);\r\n                }\r\n\r\n                objText.hidden && (txt.visible = false);\r\n                return txt;\r\n            };\r\n            const addButton = (obj, name, text) => {\r\n                const t = {};\r\n                t.normal = obj.normal.text;\r\n                t.active = obj.active.text;\r\n                t.text = text;\r\n                const btnGroup = this.viewComponent.addButton(obj.rect.x,\r\n                    obj.rect.y,\r\n                    obj.rect.width,\r\n                    obj.rect.height,\r\n                    obj.normal.background.url,\r\n                    obj.active.background.url,\r\n                    onBtnClicked,\r\n                    t,\r\n                    this.sceneProxy.btn_sound,\r\n                    name,\r\n                    this.sceneProxy.mainMenuLayer\r\n                );\r\n                btnGroup.button.onInputUp.add(() => this.sceneProxy.btn_sound && this.sceneProxy.btn_sound.stop())\r\n            };\r\n\r\n            const onBtnClicked = (obj, pointer) => {\r\n                if (pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n                    return;\r\n                }\r\n                if (obj.parent.name === 'mainMenu_button_save') {\r\n                    // 保存进度\r\n                    this.sceneProxy.onMainMenuSaveBtnClicked();\r\n                }\r\n                else if (obj.parent.name === 'mainMenu_button_load') {\r\n                    // 读取进度\r\n                    this.sceneProxy.onMainMenuLoadBtnClicked();\r\n                }\r\n                else if (obj.parent.name === 'mainMenu_button_playback') {\r\n                    // 剧情回放\r\n                    this.sceneProxy.onMainMenuPlaybackBtnClicked();\r\n                }\r\n                else if (obj.parent.name === 'mainMenu_button_autoplay') {\r\n                    // 自动播放\r\n                    this.sceneProxy.onMainMenuAutoplayBtnClicked();\r\n                }\r\n                else if (obj.parent.name === 'mainMenu_button_settings') {\r\n                    // 游戏设置\r\n                    this.sceneProxy.onMainMenuSettingsBtnClicked();\r\n                }\r\n                else if (obj.parent.name === 'mainMenu_button_back') {\r\n                    // 返回\r\n                    this.sceneProxy.onMainMenuBackBtnClicked();\r\n                }\r\n            };\r\n\r\n            const bk = this.viewComponent.game.add.image(0, 0, this.viewComponent.game.load.cache.checkImageKey(background.url) && background.url);\r\n            bk.width = this.viewComponent.game.world.width;\r\n            bk.height = this.viewComponent.game.world.height;\r\n            bk.inputEnabled = true;\r\n            this.sceneProxy.mainMenuLayer.add(bk);\r\n\r\n            // header\r\n            if (this.viewComponent.game.load.cache.checkImageKey(header.background.url)) {\r\n                const head = this.sceneProxy.mainMenuLayer.create(header.rect.x\r\n                    , header.rect.y\r\n                    , header.background.url);\r\n                head.width = header.rect.width;\r\n                head.height = header.rect.height;\r\n            }\r\n            if (!header.title.text.hidden) {\r\n                addTextContent(header.title.rect.x + header.rect.x\r\n                    , header.title.rect.y + header.rect.y\r\n                    , header.title.rect.width\r\n                    , header.title.rect.height\r\n                    , this.sceneProxy.stringMap.mainMenu\r\n                    , header.title.text\r\n                    , 'mainMenu_text_header');\r\n            }\r\n\r\n            // 按钮-保存进度\r\n            if (!save.hidden) {\r\n                addButton(save, 'mainMenu_button_save', this.sceneProxy.stringMap.save);\r\n            }\r\n\r\n            // 按钮-读取进度\r\n            if (!load.hidden) {\r\n                addButton(load, 'mainMenu_button_load', this.sceneProxy.stringMap.load);\r\n            }\r\n\r\n            // 按钮-剧情回放\r\n            if (!playback.hidden) {\r\n                addButton(playback, 'mainMenu_button_playback', this.sceneProxy.stringMap.playback);\r\n            }\r\n\r\n            // 按钮-自动播放\r\n            if (!autoplay.hidden) {\r\n                addButton(autoplay, 'mainMenu_button_autoplay', this.sceneProxy.stringMap.autoplay);\r\n            }\r\n\r\n            // 按钮-游戏设置\r\n            if (!settings.hidden) {\r\n                addButton(settings, 'mainMenu_button_settings', this.sceneProxy.stringMap.settings);\r\n            }\r\n\r\n            // 按钮-返回\r\n            if (!back.hidden) {\r\n                addButton(back, 'mainMenu_button_back', this.sceneProxy.stringMap.back);\r\n            }\r\n            this.sceneProxy.mainMenuLayer.visible = false;\r\n            if(save.hidden && load.hidden && playback.hidden && settings.hidden && back.hidden){\r\n                //系统菜单项隐藏 点击菜单无效\r\n                this.isAllHide = true;\r\n            }\r\n        },\r\n        /***\r\n         * 添加diy菜单\r\n         */\r\n        addDiyMainMenuenu:function () {\r\n            const {mainMenu: mainMenuView} = this.sceneProxy.json_data.default_settings;\r\n            let bk = this.viewComponent.game.add.graphics(0, 0, this.sceneProxy.mainMenuLayer);\r\n            bk.beginFill(0x0, 0);\r\n            bk.drawRect(0, 0, this.viewComponent.game.world.width, this.viewComponent.game.world.height);\r\n            bk.endFill();\r\n            bk.inputEnabled = true;\r\n            this.sceneMediator.registerViewKey(mainMenuView.ref, mainMenuView.events, this.sceneProxy.plotViewKeys);\r\n            let menuView = this.sceneMediator.addView(this.sceneProxy.mainMenuLayer, mainMenuView.ref, mainMenuView.instanceUuid\r\n                , mainMenuView.x, mainMenuView.y, mainMenuView.events,false,false,true);\r\n            menuView.isMenu = true;\r\n            // 找出菜单中添加的计时器\r\n            const getTimerInMenu = ()=> {\r\n                const visitInChild = view => {\r\n                    if (view.viewType === 'TIMER') {\r\n                        this.sceneProxy.menuTimer[this.sceneProxy.menuTimer.length] = view.name;\r\n                    }\r\n                    view.children.forEach(v => {visitInChild(v)});\r\n                };\r\n                menuView.children.forEach(v => {visitInChild(v)});\r\n            };\r\n            getTimerInMenu();\r\n            this.sceneMediator.uiOnLoadInvoker();\r\n        },\r\n\r\n        showMainMenuLayer: function (context) {\r\n            if (this.sceneProxy.mainMenuLayer.children.length > 0 && this.sceneProxy.json_data.default_settings.mainMenu){\r\n                //diy菜单\r\n                this.sceneProxy.mainMenuLayer.removeAll(true);\r\n            }\r\n            if (this.sceneProxy.mainMenuLayer.children.length === 0) {\r\n                if (this.sceneProxy.json_data.default_settings.mainMenu) {\r\n                    this.addDiyMainMenuenu();\r\n                } else {\r\n                    this.addMainMenu();\r\n                }\r\n            }\r\n            const autoButton = this.sceneProxy.mainMenuLayer.getByName('mainMenu_button_autoplay');\r\n            const autoText = autoButton ? autoButton.getByName(\"text\") : undefined;\r\n            if (context.auto) {\r\n                if (autoText) {\r\n                    if (FontUtils.fontFamily) {\r\n                        const txtImgOld = autoText.children[0];\r\n                        if (txtImgOld) {\r\n                            //autoText.children[0].fontImg.text = this.sceneProxy.stringMap.manualPlay;\r\n\r\n                            const {autoplay} = this.sceneProxy.json_data.template.json.mainMenu;\r\n                            const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(autoplay.normal.text.fontSize) : autoplay.normal.text.fontSize;\r\n                            const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(autoplay.normal.text.fontSize) : autoplay.normal.text.fontSize;\r\n                            const w = fw * this.sceneProxy.stringMap.manualPlay.length;\r\n                            const x = (autoplay.rect.width - w) / 2;\r\n                            const y = (autoplay.rect.height - fh) / 2;\r\n                            this.sceneProxy.addImageFontText([{data: this.sceneProxy.stringMap.manualPlay}], fw, fh, autoText, context);\r\n                            autoText.children[0].x = x;\r\n                            autoText.children[0].y = y;\r\n                            txtImgOld.children.forEach(item => item.fontImg.destroy());\r\n                            txtImgOld.destroy();\r\n                            autoText.text = ' ';\r\n                        }\r\n                    }\r\n                    else {\r\n                        autoText.text = this.sceneProxy.stringMap.manualPlay;\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                if (autoText) {\r\n                    if (FontUtils.fontFamily) {\r\n                        const txtImgOld = autoText.children[0];\r\n                        if (txtImgOld) {\r\n                            //autoText.children[0].fontImg.text = this.sceneProxy.stringMap.autoplay;\r\n\r\n                            const {autoplay} = this.sceneProxy.json_data.template.json.mainMenu;\r\n                            const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(autoplay.normal.text.fontSize) : autoplay.normal.text.fontSize;\r\n                            const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(autoplay.normal.text.fontSize) : autoplay.normal.text.fontSize;\r\n                            const w = fw * this.sceneProxy.stringMap.autoplay.length;\r\n                            const x = (autoplay.rect.width - w) / 2;\r\n                            const y = (autoplay.rect.height - fh) / 2;\r\n                            this.sceneProxy.addImageFontText([{data: this.sceneProxy.stringMap.autoplay}], fw, fh, autoText, context);\r\n                            autoText.children[0].x = x;\r\n                            autoText.children[0].y = y;\r\n                            txtImgOld.children.forEach(item => item.fontImg.destroy());\r\n                            txtImgOld.destroy();\r\n                            autoText.text = ' ';\r\n                        }\r\n                    }\r\n                    else {\r\n                        autoText.text = this.sceneProxy.stringMap.autoplay;\r\n                    }\r\n                }\r\n            }\r\n            this.viewComponent.game.world.bringToTop(this.sceneProxy.mainMenuLayer);\r\n            this.sceneProxy.mainMenuLayer.visible = true;\r\n            if(this.isAllHide !== false){\r\n                this.sceneProxy.onMainMenuBackBtnClicked();\r\n            }\r\n        }\r\n    },\r\n    {\r\n        /**\r\n         * @static\r\n         * @type {string}\r\n         */\r\n        NAME: 'MainMenuMediator'\r\n        ,isAllHide : false\r\n    }\r\n);","/**\r\n * Created by 4399-1126 on 2016/9/13.\r\n */\r\nimport puremvc from 'puremvc';\r\nimport RePhaser from '../../common/RePhaser.js';\r\nimport FontUtils from '../../common/FontUtils.js';\r\n\r\npuremvc.define\r\n(\r\n    {\r\n        name: 'diygamePlayer.view.mediator.PlaybackMediator',\r\n        parent: puremvc.Mediator\r\n    },\r\n    {\r\n        listNotificationInterests: function () {\r\n            return [\r\n                diygamePlayer.AppConstants.SCENE_GOTO_PLAYBACK,\r\n                diygamePlayer.AppConstants.ADD_PLAYBACK_CONTENT\r\n            ]\r\n        },\r\n\r\n        handleNotification: function (note) {\r\n            switch (note.getName()) {\r\n                case diygamePlayer.AppConstants.SCENE_GOTO_PLAYBACK:\r\n                    this.callbackInfo = note.getBody();\r\n                    this.showPlaybackLayer();\r\n                    break;\r\n                case diygamePlayer.AppConstants.ADD_PLAYBACK_CONTENT:\r\n                    const body = note.getBody();\r\n                    this.addPlaybackContent(body);\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        },\r\n\r\n        onRegister: function () {\r\n            this.sceneProxy = this.facade.retrieveProxy(diygamePlayer.model.proxy.SceneProxy.NAME);\r\n            const sceneMediator = this.facade.retrieveMediator(diygamePlayer.view.mediator.SceneMediator.NAME);\r\n            this.game = sceneMediator.viewComponent && sceneMediator.viewComponent.game;\r\n            this.viewComponent = sceneMediator.viewComponent;\r\n        },\r\n\r\n        addTextContent: function (x, y, width, height, content, objText) {\r\n            const fontStyle = {boundsAlignH: 'center', boundsAlignV: 'middle', wordWrap: true};\r\n            let ff = '';\r\n            ff += objText.fontWeight ? objText.fontWeight + ' ' : 'normal ';\r\n            ff += objText.fontSize ? parseInt(objText.fontSize) + 'px ' : '';\r\n            ff += objText.fontFamily ? objText.fontFamily : '黑体';\r\n\r\n            fontStyle.font = ff;\r\n            fontStyle.fill = objText.color;\r\n            fontStyle.wordWrapWidth = width;\r\n            if (this.sceneProxy.stringMap.back === content) {\r\n                fontStyle.boundsAlignH = 'center';\r\n                fontStyle.boundsAlignV = \"middle\";\r\n            } else {\r\n                fontStyle.boundsAlignH = 'left';\r\n                fontStyle.boundsAlignV = 'top';\r\n            }\r\n            const txt = this.game.add.text(0, 0, content, fontStyle, this.sceneProxy.playBackLayer);\r\n            txt.setTextBounds(x, y + (txt.height - parseInt(objText.fontSize || 12)) / 2, width, height);\r\n            return txt;\r\n        },\r\n\r\n        addPlayback: function () {\r\n            const {scrollBox, back, background} = this.sceneProxy.json_data.template.json.playback;\r\n\r\n            // 背景\r\n            const bk = this.sceneProxy.playBackLayer.create(0, 0, this.game.load.cache.checkImageKey(background.url) && background.url);\r\n            bk.width = this.game.world.width;\r\n            bk.height = this.game.world.height;\r\n            bk.inputEnabled = true;\r\n            // scrollBox\r\n            const boxX = scrollBox.rect.x;\r\n            const boxY = scrollBox.rect.y;\r\n            const boxWidth = scrollBox.rect.width;\r\n            const boxHeight = scrollBox.rect.height;\r\n            const backgroundRect = Object.assign({x: 0, y: 0, width: boxWidth, height: boxHeight}, scrollBox.background.rect);\r\n\r\n            const scrollBk = this.sceneProxy.playBackLayer.create(boxX + backgroundRect.x,\r\n                boxY + backgroundRect.y,\r\n                this.game.load.cache.checkImageKey(scrollBox.background.url) && scrollBox.background.url);\r\n            scrollBk.width = backgroundRect.width;\r\n            scrollBk.height = backgroundRect.height;\r\n\r\n            const scrollPane = this.game.add.sprite(0, 0);\r\n            const scrollX = boxX;\r\n            const scrollY = boxY;\r\n            scrollPane.x = scrollX;\r\n            scrollPane.y = scrollY;\r\n            scrollPane.name = 'scrollPane';\r\n            this.sceneProxy.playBackLayer.add(scrollPane);\r\n\r\n            // item\r\n            const itemWidth = scrollBox.item.rect.width;\r\n            const itemHeight = scrollBox.item.rect.height;\r\n            const hSpace = Math.max(itemHeight - scrollBox.item.content.rect.height, 0);\r\n            let dragStartPointX = 0;\r\n            let dragStartY = null;\r\n            let wheelEvent = false;\r\n            const onMove = (pointer, x, y) => {\r\n                const point = getPoint(pointer);\r\n                const mousewheelevt = (/Firefox/i.test(navigator.userAgent)) ? \"DOMMouseScroll\" : \"mousewheel\";\r\n                if (!point) {\r\n                    if (wheelEvent) {\r\n                        document.removeEventListener(mousewheelevt, onMouseWheel);\r\n                        wheelEvent = false;\r\n                    }\r\n                }\r\n                else {\r\n                    if (!wheelEvent) {\r\n                        document.addEventListener(mousewheelevt, onMouseWheel);\r\n                        wheelEvent = true;\r\n                    }\r\n                }\r\n            };\r\n            const onScroll = (x, y) => {\r\n                const height = scrollPane.children.length * itemHeight - hSpace;\r\n                if (height < boxHeight) {\r\n                    scrollPane.y = boxY;\r\n                    return;\r\n                }\r\n                if (x !== boxX) {\r\n                    scrollPane.x = boxX;\r\n                }\r\n                if (y > boxY) {\r\n                    scrollPane.y = boxY;\r\n                }\r\n                else if (y + height < boxY + boxHeight) {\r\n                    scrollPane.y = boxY + boxHeight - height;\r\n                }\r\n                else {\r\n                    scrollPane.y = y;\r\n                }\r\n            };\r\n            const onDragUpdate = (sprite, pointer, x, y, pt, bFromStart) => {\r\n                let px = x;\r\n                let py = y;\r\n                bFromStart && (dragStartPointX = x);\r\n                dragStartY = scrollPane.y;\r\n                if (document.body.clientWidth < document.body.clientHeight && dragStartY !== null) {\r\n                    py = dragStartY - x + dragStartPointX;\r\n                }\r\n                onScroll(px, py);\r\n            };\r\n            const getPoint = (pointer) => {\r\n                let x, y;\r\n                let w = (window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth);\r\n                let h = (window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight);\r\n                if (w > h) {\r\n                    if(flashvars.vertical){\r\n                        x = pointer.worldY;\r\n                        y = -pointer.worldX;\r\n                    }else{\r\n                        x = pointer.worldX;\r\n                        y = pointer.worldY;\r\n                    }\r\n                }\r\n                else {\r\n                    if(flashvars.vertical){\r\n                        x = pointer.worldX;\r\n                        y = pointer.worldY;\r\n                    }else{\r\n                        x = pointer.worldY;\r\n                        y = -pointer.worldX;\r\n                    }\r\n                }\r\n                if (y < scrollY || y > /*boxY*/scrollY + boxHeight ||\r\n                    x < scrollX || x > /*boxX*/scrollX + boxWidth) {\r\n                    return null;\r\n                }\r\n                return {x, y}\r\n            };\r\n            const onInputDown = (sprite, pointer, x, y) => {\r\n                if (!getPoint(pointer)) {\r\n                    return sprite.input.disableDrag();\r\n                }\r\n                return sprite.input.enableDrag();\r\n            };\r\n            const onMouseWheel = e => {\r\n                const delta = e.wheelDelta ? e.wheelDelta / 120 : -e.detail / 3;\r\n                onScroll(0, scrollPane.y + delta * 100)\r\n            };\r\n\r\n            scrollPane.inputEnabled = true;\r\n            scrollPane.input.enableDrag();\r\n            scrollPane.input.allowHorizontalDrag = false;\r\n            scrollPane.events.onDragUpdate.add(onDragUpdate, this);\r\n            scrollPane.events.onInputDown.add(onInputDown, this);\r\n            this.game.input.addMoveCallback(onMove, this);\r\n            // mask\r\n            const mask = this.game.add.graphics(0, 0);\r\n            mask.beginFill(0xffffff);\r\n            mask.drawRect(boxX, boxY, boxWidth, boxHeight);\r\n            this.sceneProxy.playBackLayer.add(mask);\r\n            scrollPane.mask = mask;\r\n            // 返回按钮\r\n            const onBtnClicked = (obj, pointer) => {\r\n                if (pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n                    return;\r\n                }\r\n                this.sceneProxy.onPlaybackBackBtnClicked();\r\n                if (this.callbackInfo) {\r\n                    this.callbackInfo.callbackFun(this.callbackInfo.callbackArgs);\r\n                    this.callbackInfo = null;\r\n                }\r\n            };\r\n            if (!back.hidden) {\r\n                const t = {};\r\n                t.normal = back.normal.text;\r\n                t.active = back.active.text;\r\n                t.text = this.sceneProxy.stringMap.back;\r\n                let btn_sound = null;\r\n                if(this.sceneProxy.json_data.template.json.sound){\r\n                    const {sound} = this.sceneProxy.json_data.template.json;\r\n                    if(this.sceneProxy.viewComponent.game.load.cache.checkSoundKey(sound.url)){\r\n                        btn_sound = this.sceneProxy.viewComponent.game.add.sound(sound.url, sound.volume)\r\n                    }\r\n                }\r\n                const btnGroup = this.viewComponent.addButton(back.rect.x,\r\n                    back.rect.y,\r\n                    back.rect.width,\r\n                    back.rect.height,\r\n                    back.normal.background.url,\r\n                    back.active.background.url,\r\n                    onBtnClicked,\r\n                    t,\r\n                    btn_sound,\r\n                    \"playBack_button_back\",\r\n                    this.sceneProxy.playBackLayer\r\n                );\r\n                btnGroup.button.onInputUp.add(() => btn_sound && btn_sound.stop())\r\n            }\r\n            this.sceneProxy.playBackLayer.visible = false;\r\n        },\r\n\r\n        addPlaybackContent: function (data) {\r\n            this.sceneProxy.playbackData.push(data);\r\n            if (this.sceneProxy.playbackData.length > 100) {\r\n                this.sceneProxy.playbackData.splice(0, 1);\r\n            }\r\n        },\r\n\r\n        addPlaybackItem: function (data) {\r\n            const scrollPane = this.sceneProxy.playBackLayer.getByName('scrollPane');\r\n            const {scrollBox} = this.sceneProxy.json_data.template.json.playback;\r\n\r\n            const keyItemBk = this.game.load.cache.checkImageKey(scrollBox.item.background.url) ? scrollBox.item.background.url : null;\r\n            const keySubItemBk = this.game.load.cache.checkImageKey(scrollBox.item.content.background.url) ? scrollBox.item.content.background.url : null;\r\n            const contentX = scrollBox.item.rect.x + scrollBox.item.content.rect.x;\r\n            const contentY = scrollBox.item.rect.y + scrollBox.item.content.rect.y;\r\n\r\n            const itemGroup = this.game.add.group();\r\n            itemGroup.x = scrollBox.item.rect.x;\r\n            itemGroup.y = scrollBox.item.rect.y + scrollBox.item.rect.height * scrollPane.children.length;\r\n\r\n            const itemBackground = this.game.add.sprite(0, 0, keyItemBk);\r\n            itemBackground.width = scrollBox.item.rect.width;\r\n            itemBackground.height = scrollBox.item.rect.height;\r\n            const itemContent = this.game.add.sprite(contentX, contentY, keySubItemBk);\r\n            itemContent.width = scrollBox.item.content.rect.width;\r\n            itemContent.height = scrollBox.item.content.rect.height;\r\n\r\n            const itemText = this.addTextContent(contentX + 10,\r\n                contentY,\r\n                scrollBox.item.content.rect.width - 10,\r\n                scrollBox.item.content.rect.height,\r\n                \"\",\r\n                scrollBox.item.content.text);\r\n            itemText.useAdvancedWrap = true;\r\n            itemText.updateText = RePhaser.updateText;\r\n            itemText.advancedWordWrap = RePhaser.advancedWordWrap;\r\n            itemText.lineSpacing = -parseInt(scrollBox.item.content.text.fontSize || 12) / 5;\r\n            itemText.text = data;\r\n            itemText.name = 'text';\r\n\r\n            const mask = this.game.add.graphics(0, 0);\r\n            mask.beginFill(0xffffff);\r\n            mask.drawRect(contentX, contentY, itemContent.width, itemContent.height);\r\n            itemText.mask = mask;\r\n            itemGroup.addChild(mask);\r\n\r\n            itemGroup.add(itemBackground);\r\n            itemGroup.add(itemContent);\r\n            itemGroup.add(itemText);\r\n            scrollPane.addChild(itemGroup);\r\n            /*if (scrollPane.children.length > 100) {\r\n                scrollPane.removeChildAt(0);\r\n                scrollPane.children.forEach(c => c.y -= scrollBox.item.rect.height)\r\n            }*/\r\n        },\r\n\r\n        showPlaybackLayer: function () {\r\n            /*if (this.sceneProxy.playBackLayer.children.length === 0) {\r\n                this.addPlayback();\r\n            }*/\r\n            this.sceneProxy.playBackLayer.removeAll(true);\r\n            this.addPlayback();\r\n            this.sceneProxy.playbackData.forEach(d => {this.addPlaybackItem(d)});\r\n            this.game.world.bringToTop(this.sceneProxy.playBackLayer);\r\n            this.sceneProxy.playBackLayer.visible = true;\r\n            // 滚动位置\r\n            const {rect, item} = this.sceneProxy.json_data.template.json.playback.scrollBox;\r\n            const scrollPane = this.sceneProxy.playBackLayer.getByName('scrollPane');\r\n            const hSpace = Math.max(item.rect.height - item.content.rect.height, 0);\r\n            const height = scrollPane.children.length * item.rect.height - hSpace;\r\n            const y = rect.y + item.rect.y;\r\n            if (height < rect.height) {\r\n                scrollPane.y = y;\r\n            } else {\r\n                scrollPane.y = y - height + rect.height;\r\n            }\r\n        }\r\n    },\r\n    {\r\n        /**\r\n         * @static\r\n         * @type {string}\r\n         */\r\n        NAME: 'PlaybackMediator'\r\n    }\r\n);","/**\r\n * Created by 4399-1126 on 2016/9/13.\r\n */\r\nimport puremvc from 'puremvc';\r\nimport MD5 from 'spark-md5';\r\nimport Dialog from './../../common/Dialog.js';\r\nimport Utils from './../../common/Utils.js';\r\nimport FontUtils from '../../common/FontUtils.js';\r\n\r\npuremvc.define\r\n(\r\n    {\r\n        name: 'diygamePlayer.view.mediator.RecordMediator',\r\n        parent: puremvc.Mediator\r\n    },\r\n    {\r\n        listNotificationInterests: function () {\r\n            return [\r\n                diygamePlayer.AppConstants.SCENE_GOTO_RECORD\r\n            ]\r\n        },\r\n\r\n        handleNotification: function (note) {\r\n            const body = note.getBody();\r\n            this.callbackInfo = !!body ? body : (this.sceneProxy.recordLayer ? this.callbackInfo : null);\r\n            switch (note.getName()) {\r\n                case diygamePlayer.AppConstants.SCENE_GOTO_RECORD:\r\n                    this.showRecordLayer();\r\n                    break;\r\n                default:\r\n                    break\r\n            }\r\n        },\r\n\r\n        onRegister: function () {\r\n            this.sceneProxy = this.facade.retrieveProxy(diygamePlayer.model.proxy.SceneProxy.NAME);\r\n            const sceneMediator = this.facade.retrieveMediator(diygamePlayer.view.mediator.SceneMediator.NAME);\r\n            this.game = sceneMediator.viewComponent && sceneMediator.viewComponent.game;\r\n            this.viewComponent = sceneMediator.viewComponent;\r\n            this.localMode = true;\r\n            this.isChangeClick = false;\r\n            this.clicktime = 0;\r\n            this.clickchangetime = 0;\r\n        },\r\n\r\n        onLocalBtnClicked: function() {\r\n            if(this.clickInterval(800) !== true) return;\r\n            if (!this.localMode) {\r\n                this.localMode = true;\r\n                this.isChangeClick = true;\r\n                const btnLocal = this.sceneProxy.recordLayer.getByName('local_btn');\r\n                const btnCloud = this.sceneProxy.recordLayer.getByName('cloud_btn');\r\n                btnLocal && btnLocal.changeBackground('local_hover');\r\n                btnCloud && btnCloud.changeBackground('cloud');\r\n                this.sceneProxy.onRecordLocalBtnClicked();\r\n            }\r\n        },\r\n\r\n        onCloudBtnClicked: function() {\r\n            if(this.clickInterval(800) !== true) return;\r\n            if (this.localMode) {\r\n                this.sceneProxy.isSignedIn().then(() => {\r\n                    this.localMode = false;\r\n                    this.isChangeClick = true;\r\n                    const btnLocal = this.sceneProxy.recordLayer.getByName('local_btn');\r\n                    const btnCloud = this.sceneProxy.recordLayer.getByName('cloud_btn');\r\n                    btnLocal && btnLocal.changeBackground('local');\r\n                    btnCloud && btnCloud.changeBackground('cloud_hover');\r\n                    this.sceneProxy.onRecordCloudBtnClicked();\r\n                }, rj => {\r\n                    let n = rj.indexOf('- status:-1');\r\n                    n = n >= 0 ? n : rj.indexOf('- status:2');\r\n                    if (n >= 0) {\r\n                        this.sceneProxy.context.fullScreen && this.sceneProxy.onSettingsWindowModeBtnClicked();\r\n                        //频繁操作，强行切换到本地存档   先切换 再弹窗;\r\n                        if(rj.indexOf('- status:-110') > 0){\r\n                            const btnLocal = this.sceneProxy.recordLayer.getByName('local_btn');\r\n                            const btnCloud = this.sceneProxy.recordLayer.getByName('cloud_btn');\r\n                            btnLocal && btnLocal.changeBackground(\"local_hover\",\"local_btn\");\r\n                            btnCloud && btnCloud.changeBackground(\"cloud\",\"cloud_btn\");\r\n                            this.sceneProxy.onRecordLocalBtnClicked();\r\n                            this.localMode = true;\r\n                            Dialog.error(rj.substr(0, n)).then(()=>{},()=>{});\r\n                            return;\r\n                        }\r\n                        if (flashvars.app_version >= '1.2.0') {\r\n                            window.location.href = 'lzj3000://logout';\r\n                        }\r\n                        if(flashvars.client === 'wap'){\r\n                            window.parent && window.parent.playLogin();\r\n                        }else{\r\n                            Dialog.error(rj.substr(0, n)).then(()=>{\r\n                                window.location.href = 'lzj3000://login';\r\n                            })\r\n                        }\r\n                    } else if (0 <= rj.indexOf('error')) {\r\n                        this.sceneProxy.context.fullScreen && this.sceneProxy.onSettingsWindowModeBtnClicked();\r\n                        Dialog.error('网络异常，请检查您的网络！');\r\n                    }\r\n                });\r\n            }\r\n        },\r\n\r\n        addRecord: function () {\r\n            const {background, scrollBox, back} = this.sceneProxy.json_data.template.json.record;\r\n            let {rect: boxRect, item: boxItem, itemsOffsetX, itemsOffsetY, itemSpaceX: hSpace, itemSpaceY: vSpace} = scrollBox;\r\n            const {rect: itemRect, hint, content} = boxItem;\r\n            const {rect: hintRect, text: hintText} = hint;\r\n            const {rect: contentRect} = content;\r\n            const {x: boxX, y: boxY, width: boxWidth, height: boxHeight} = boxRect;\r\n            const {x: itemX, y: itemY, width: itemWidth, height: itemHeight} = itemRect;\r\n            const {x: hintX, y: hintY, width: hintWidth, height: hintHeight} = hintRect;\r\n            const {x: contentX, y: contentY, width: contentWidth, height: contentHeight} = contentRect;\r\n            hSpace = hSpace === undefined ? 20 : hSpace;\r\n            vSpace = vSpace === undefined ? 12 : vSpace;\r\n            itemsOffsetX = itemsOffsetX === undefined ? 0 : itemsOffsetX;\r\n            itemsOffsetY = itemsOffsetY === undefined ? 0 : itemsOffsetY;\r\n\r\n            const fontStyle = {boundsAlignH: 'center', boundsAlignV: 'middle'};\r\n            const addTextContent = (x, y, width, height, content, objText) => {\r\n                let txt;\r\n                let ff = '';\r\n                ff += objText.fontWeight ? objText.fontWeight + ' ' : 'normal ';\r\n                ff += objText.fontSize ? parseInt(objText.fontSize) + 'px ' : '';\r\n                ff += this.sceneProxy.json_data.font ? this.sceneProxy.json_data.font.fontFamily : objText.fontFamily ? objText.fontFamily : '';\r\n\r\n                fontStyle.font = ff;\r\n                fontStyle.fill = objText.color;\r\n                txt = this.game.add.text(0, 0, content, fontStyle, this.sceneProxy.recordLayer);\r\n\r\n                if (FontUtils.fontFamily) {\r\n                    const color = (objText.color ? objText.color : this.json_data.default_settings.color).replace('#', '0x');\r\n                    if (color.indexOf('rgb') !== -1) {\r\n                        const rgb = color.replace('rgb(', '').replace(')', '').split(',');\r\n                        txt.addColor('#' + ('00000' + (parseInt(rgb[0]) << 16 | parseInt(rgb[1]) << 8 | parseInt(rgb[2])).toString(16)).substr(-6), 0);\r\n                    }\r\n                    else {\r\n                        txt.addColor(color, 0);\r\n                    }\r\n\r\n                    const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(txt.fontSize) : txt.fontSize;\r\n                    txt.x = x + (width - 14 * 14 * fw / 25 - 21 - 22 * fw / 25) / 2;\r\n                    txt.y = y + (txt.height - parseInt(txt.fontSize)) / 2;\r\n                    txt.wordWrapWidth = 20 * 13 * fw / 25;\r\n                }\r\n                else {\r\n                    txt.setTextBounds(x, y + (txt.height - parseInt(objText.fontSize)) / 2, width, height);\r\n                }\r\n\r\n                return txt;\r\n            };\r\n\r\n            // 背景\r\n            const bk = this.sceneProxy.recordLayer.create(0, 0, this.game.load.cache.checkImageKey(background.url) && background.url);\r\n            bk.width = this.game.world.width;\r\n            bk.height = this.game.world.height;\r\n            bk.inputEnabled = true;\r\n\r\n            // scrollBox\r\n            const scrollPane = this.game.add.sprite(0,0);\r\n\r\n            const backgroundRect = Object.assign({x: 0, y: 0, width: boxWidth, height: boxHeight}, background.rect);\r\n            const scrollBk = this.sceneProxy.recordLayer.create(boxX + backgroundRect.x,\r\n                boxY + backgroundRect.y,\r\n                this.game.load.cache.checkImageKey(scrollBox.background.url) && scrollBox.background.url);\r\n            scrollBk.width = backgroundRect.width;\r\n            scrollBk.height = backgroundRect.height;\r\n\r\n            const scrollX = boxX + itemsOffsetX;\r\n            const scrollY = boxY + itemsOffsetY;\r\n            scrollPane.x = scrollX;\r\n            scrollPane.y = scrollY;\r\n            scrollPane.name = 'scrollPane';\r\n            this.sceneProxy.recordLayer.add(scrollPane);\r\n            // item  横屏 4列3行  竖屏  1列 12行\r\n            let nRow = flashvars.vertical ? 12 : 3;//Math.ceil(boxHeight / itemHeight);\r\n            let nCol = flashvars.vertical ? 1 : 4;//Math.floor(boxWidth / itemWidth);\r\n            if(!flashvars.vertical){\r\n                nCol = Math.min(nCol,Math.floor(boxWidth / itemWidth))\r\n                if(nCol === 3){\r\n                    nRow = 4;\r\n                }else if(nCol === 2){\r\n                    nRow = 6;\r\n                }else if(nCol === 1){\r\n                    nRow = 12;\r\n                }\r\n            }\r\n            let nLeft = 0;\r\n            let nTop = 0;\r\n            let keyItemBk;\r\n            let ptDown = {x: 0, y: 0};\r\n            const dragBk = this.game.add.sprite(0, 0);\r\n            dragBk.width = (itemWidth + hSpace) * nCol;\r\n            dragBk.height = (itemHeight + vSpace) * nRow;\r\n            scrollPane.addChild(dragBk);\r\n\r\n            let dragStartPointX = 0;\r\n            let dragStartY = null;\r\n            let isSaveOrGet = true;// 是否读档存档\r\n            const onScroll = (x, y) => {\r\n                if((Math.abs(scrollPane.y - dragStartY) > 2 || Math.abs(scrollPane.x - dragStartPointX) > 2) && (dragStartY)){\r\n                    isSaveOrGet = false;\r\n                }\r\n                const scrollHeight = itemHeight * nRow + vSpace * (nRow - 1);\r\n                if (y > scrollY || scrollHeight <= boxHeight) {\r\n                    scrollPane.y = scrollY;\r\n                }\r\n                else if (y + scrollHeight < boxY + boxHeight) {\r\n                    scrollPane.y = boxY + boxHeight - (itemHeight * nRow + vSpace * (nRow - 1));\r\n                }\r\n                else {\r\n                    scrollPane.y = y;\r\n                }\r\n            };\r\n\r\n            const onDragUpdate = (sprite, pointer, x, y, pt, bFromStart) => {\r\n                let px = x;\r\n                let py = y;\r\n                let w = (window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth);\r\n                let h = (window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight);\r\n                if (w < h && dragStartY !== null && !flashvars.vertical) {\r\n                    py = dragStartY - x + dragStartPointX;\r\n                }\r\n                onScroll(px, py);\r\n            };\r\n\r\n            const onDragStart = (sprite, pointer, x, y, pt, bFromStart) => {\r\n                dragStartPointX = x;\r\n                dragStartY = scrollPane.y;\r\n            };\r\n\r\n            const onDragStop = (sprite, pointer, x, y, pt, bFromStart) => {\r\n                dragStartY = scrollPane.y;\r\n            };\r\n\r\n            const getPoint = (pointer) => {\r\n                let x, y;\r\n                let w = (window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth);\r\n                let h = (window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight);\r\n                if (w > h) {\r\n                    if(flashvars.vertical){\r\n                        x = pointer.worldY;\r\n                        y = -pointer.worldX;\r\n                    }else{\r\n                        x = pointer.worldX;\r\n                        y = pointer.worldY;\r\n                    }\r\n                }\r\n                else {\r\n                    if(flashvars.vertical){\r\n                        x = pointer.worldX;\r\n                        y = pointer.worldY;\r\n                    }else{\r\n                        x = pointer.worldY;\r\n                        y = -pointer.worldX;\r\n                    }\r\n                }\r\n                if (y < scrollY || y > /*boxY*/scrollY + boxHeight ||\r\n                    x < scrollX || x > /*boxX*/scrollX + boxWidth) {\r\n                    return null;\r\n                }\r\n                return {x, y}\r\n            };\r\n\r\n            const onInputDown = (sprite, pointer, x, y) => {\r\n                isSaveOrGet = true;\r\n                if (!getPoint(pointer)) {\r\n                    return sprite.input.disableDrag();\r\n                }\r\n                return sprite.input.enableDrag();\r\n            };\r\n\r\n            const onItemUp = (m, pt) => {\r\n                if(isSaveOrGet !== true) return;\r\n                const point = getPoint(pt);\r\n                if (!point || pt.pointerMode === Phaser.PointerMode.CURSOR && pt.button !== 0) {\r\n                    return;\r\n                }\r\n                //防止快速点击，做0.8秒时间间隔\r\n                if(this.clicktime === 0){\r\n                    this.clicktime = this.game.time.now\r\n                }else{\r\n                    if((this.game.time.now - this.clicktime) >= 800){\r\n                        this.clicktime = 0;\r\n                    }else{\r\n                        return\r\n                    }\r\n                }\r\n\r\n                ptDown.x = 0;\r\n                ptDown.y = 0;\r\n                const x = point.x - scrollPane.x;\r\n                const y = point.y - scrollPane.y;\r\n                const w = itemWidth + hSpace;\r\n                const h = itemHeight + vSpace;\r\n                if (x % w < itemWidth && y % h < itemHeight) {\r\n                    const iCol = Math.floor(x / w);\r\n                    const iRow = Math.floor(y / h);\r\n                    flashvars.vertical ? this.sceneProxy.onRecordItemClicked(iRow,iCol,nCol) : this.sceneProxy.onRecordItemClicked(iCol,iRow,nCol);\r\n                    if (!this.sceneProxy.bToSaveFile) {\r\n                        this.callbackInfo = null;\r\n                    }\r\n                }\r\n            };\r\n\r\n            const onMouseWheel = e => {\r\n                const delta = e.wheelDelta ? e.wheelDelta / 120 : -e.detail / 3;\r\n                onScroll(0, scrollPane.y + delta * 100)\r\n            };\r\n\r\n            let wheelEvent = false;\r\n            const onMove = (pointer, x, y) => {\r\n                const point = getPoint(pointer);\r\n                const mousewheelevt = (/Firefox/i.test(navigator.userAgent)) ? \"DOMMouseScroll\" : \"mousewheel\";\r\n                if (!point) {\r\n                    if (wheelEvent) {\r\n                        document.removeEventListener(mousewheelevt, onMouseWheel);\r\n                        wheelEvent = false;\r\n                    }\r\n                }\r\n                else {\r\n                    if (!wheelEvent) {\r\n                        document.addEventListener(mousewheelevt, onMouseWheel);\r\n                        wheelEvent = true;\r\n                    }\r\n                }\r\n            };\r\n\r\n            keyItemBk = this.game.load.cache.checkImageKey(boxItem.background.url) ? boxItem.background.url : null;\r\n\r\n            for (let r = 0; r < nRow; r++) {\r\n                for (let c = 0; c < nCol; c++) {\r\n                    const itemGroup = this.game.add.group();\r\n                    itemGroup.x = c * (itemWidth + hSpace) + itemX;\r\n                    itemGroup.y = r * (itemHeight + vSpace) + itemY;\r\n                    itemGroup.name = `recordItem_${r * nCol + c}`;\r\n                    const item_bk = this.game.add.sprite(nLeft, nTop, keyItemBk);\r\n                    item_bk.width = itemWidth;\r\n                    item_bk.height = itemHeight;\r\n\r\n                    const subItem = this.sceneProxy.recordLayer.create(contentX, contentY, this.game.load.cache.checkImageKey(content.background.url) && content.background.url);\t\t// content\r\n                    subItem.name = 'content';\r\n                    subItem.width = contentWidth;\r\n                    subItem.height = contentHeight;\r\n\r\n                    const txtTime = addTextContent(hintX\r\n                        , hintY\r\n                        , hintWidth\r\n                        , hintHeight\r\n                        , ''\r\n                        , hintText);\r\n                    txtTime.name = 'textTime';\r\n                    const itemMask = this.game.add.graphics(0, 0);\r\n                    itemMask.beginFill();\r\n                    itemMask.drawRect(0, 0, itemWidth, itemHeight);\r\n                    itemMask.endFill();\r\n                    itemGroup.addChild(itemMask);\r\n                    itemGroup.mask = itemMask;\r\n                    itemGroup.add(item_bk);\r\n                    itemGroup.add(subItem);\r\n                    itemGroup.add(txtTime);\r\n\r\n                    if (this.sceneProxy.json_data.default_settings.autoSaveOrLoad && r === 0 && c === 0) {\r\n                        const autoRecord_Bk = this.game.add.bitmapData(itemWidth, itemHeight);\r\n                        autoRecord_Bk.fill(0, 0, 0, 0.4);\r\n                        const autoRecord = this.game.add.sprite(0, 0, autoRecord_Bk);\r\n                        autoRecord.width = itemWidth;\r\n                        autoRecord.height = itemHeight;\r\n                        const fontStyle = {\r\n                            font: '16px Microsoft YaHei',\r\n                            fill: 'white',\r\n                            boundsAlignH: 'center',\r\n                            boundsAlignV: 'middle'\r\n                        };\r\n                        const autoRecord_txt = this.game.add.text(0, 0, '自动存档', fontStyle, this.sceneProxy.coverLayer);\r\n                        autoRecord_txt.setTextBounds(0, (autoRecord_txt.height - 16) / 2, itemWidth, itemHeight);\r\n                        itemGroup.add(autoRecord);\r\n                        itemGroup.add(autoRecord_txt);\r\n                    }\r\n\r\n                    scrollPane.addChild(itemGroup);\r\n                }\r\n            }\r\n            scrollPane.inputEnabled = true;\r\n            scrollPane.input.enableDrag();\r\n            scrollPane.input.allowHorizontalDrag = false;\r\n            scrollPane.events.onDragUpdate.add(onDragUpdate, this);\r\n            scrollPane.events.onDragStart.add(onDragStart, this);\r\n            scrollPane.events.onDragStop.add(onDragStop, this);\r\n            scrollPane.events.onInputUp.add(onItemUp, this);\r\n            scrollPane.events.onInputDown.add(onInputDown, this);\r\n            this.game.input.addMoveCallback(onMove, this);\r\n\r\n            // mask\r\n            const mask = this.game.add.graphics(0, 0);\r\n            mask.beginFill();\r\n            mask.drawRect(scrollPane.x, scrollPane.y, boxWidth - itemsOffsetX, boxHeight - itemsOffsetY);\r\n            mask.endFill();\r\n            this.sceneProxy.recordLayer.add(mask);\r\n            scrollPane.mask = mask;\r\n\r\n            // 返回按钮\r\n            const t = {};\r\n            t.normal = back.normal.text;\r\n            t.active = back.active.text;\r\n            t.text = this.sceneProxy.stringMap.back;\r\n\r\n            const onBtnClicked = (obj, pointer) => {\r\n                if (pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n                    return;\r\n                }\r\n                if ('record_button_back' === obj.parent.name) {\r\n                    this.sceneProxy.onRecordBackBtnClicked();\r\n                    if (this.callbackInfo) {\r\n                        this.callbackInfo.callbackFun(this.callbackInfo.callbackArgs);\r\n                        this.callbackInfo = null;\r\n                    }\r\n                }\r\n                else if ('local_btn' === obj.parent.name) {\r\n                    this.onLocalBtnClicked();\r\n                }\r\n                else if ('cloud_btn' === obj.parent.name) {\r\n                    this.onCloudBtnClicked();\r\n                }\r\n            };\r\n\r\n            if (!back.hidden) {\r\n                const btnGroup = this.viewComponent.addButton(back.rect.x,\r\n                    back.rect.y,\r\n                    back.rect.width,\r\n                    back.rect.height,\r\n                    back.normal.background.url,\r\n                    back.active.background.url,\r\n                    onBtnClicked,\r\n                    t,\r\n                    this.sceneProxy.btn_sound,\r\n                    \"record_button_back\",\r\n                    this.sceneProxy.recordLayer\r\n                );\r\n                btnGroup.button.onInputUp.add(() => this.sceneProxy.btn_sound && this.sceneProxy.btn_sound.stop())\r\n            }\r\n            // 本地--云 按钮\r\n            t.text = '';\r\n            if(this.sceneProxy.isShowLocalBtn()){\r\n                let localx = this.sceneProxy.viewComponent.game.world.width - 74;\r\n                let localy = 25;\r\n                this.viewComponent.addButton(localx, localy, 68, 68\r\n                    , 'local_hover', null\r\n                    , onBtnClicked\r\n                    , t, null, 'local_btn'\r\n                    , this.sceneProxy.recordLayer\r\n                    , true);\r\n            }\r\n\r\n            if(this.sceneProxy.isShowCloudBtn()){ //不存在来源wap或wap=3000 、非推广  没有云存档按钮\r\n                let cloundx = this.sceneProxy.viewComponent.game.world.width - 74;\r\n                let cloundy = 107;\r\n                this.viewComponent.addButton(cloundx, cloundy, 68, 68\r\n                    , 'cloud', null\r\n                    , onBtnClicked\r\n                    , t, null, 'cloud_btn'\r\n                    , this.sceneProxy.recordLayer\r\n                    , true);\r\n            }\r\n            this.sceneProxy.recordLayer.visible = false;\r\n        },\r\n\r\n        updateItems: function () {\r\n            this.sceneProxy.savedPlotsData.forEach((data, i) => {\r\n                const setPreviewImage = key => {\r\n                    const bKey = this.game.load.cache.checkImageKey(key) ? key : null;\r\n                    const itemContent = item.getByName('content');\r\n                    const {width, height} = itemContent;\r\n                    itemContent.loadTexture(bKey);\r\n                    itemContent.width = width;\r\n                    itemContent.height = height;\r\n                };\r\n                const {timestamp, plotSnap} = data ? data : {};\r\n                const item = this.sceneProxy.recordLayer.getByName('scrollPane').children.find(c => c.name === `recordItem_${i}`);\r\n                if (!item) {\r\n                    return;\r\n                }\r\n                if (!timestamp) {\r\n                    setPreviewImage(this.sceneProxy.json_data.template.json.record.scrollBox.item.content.background.url);\r\n                    item.getByName('textTime').text = '';\r\n                    return;\r\n                }\r\n                const itemTime = item.getByName('textTime');\r\n                const snapMd5 = MD5.hash(plotSnap);\r\n\r\n                if (!this.game.load.cache.checkImageKey(snapMd5)) {\r\n                    const data = new Image();\r\n                    data.src = plotSnap;\r\n                    data.onload = e => {\r\n                        if (!this.game.load.cache.checkImageKey(snapMd5)) {\r\n                            this.game.cache.addImage(snapMd5, plotSnap, e.target);\r\n                        }\r\n                        setPreviewImage(snapMd5);\r\n                    };\r\n                } else {\r\n                    setPreviewImage(snapMd5);\r\n                }\r\n                const strText = Utils.getCurrentDateTime(timestamp);\r\n                if (FontUtils.fontFamily) {\r\n                    const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(itemTime.fontSize) : itemTime.fontSize;\r\n                    const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(itemTime.fontSize) : itemTime.fontSize;\r\n                    this.sceneProxy.addImageFontText([{data:strText}], fw, fh, itemTime, this.sceneProxy.context);\r\n                    itemTime.text = ' ';\r\n                }\r\n                else {\r\n                    itemTime.text = strText;\r\n                }\r\n            });\r\n        },\r\n\r\n        showRecordLayer: function () {\r\n            //定位到云存档，如果登入状态，直接显示云存档，没登入显示云存档提示\r\n            this.clicktime = 0;\r\n            if (this.sceneProxy.recordLayer.children.length === 0) {\r\n                this.addRecord();\r\n            }\r\n            //本地和云存档按钮存在，同时云和本地存档按钮未点击\r\n            if(this.sceneProxy.isShowCloudBtn() && this.sceneProxy.isShowLocalBtn() && this.isChangeClick !== true\r\n                || this.isChangeClick !== true && this.sceneProxy.isWapOther()/*第三方来源，定位到云存档*/){\r\n                this.sceneProxy.isSignedIn().then(() => {\r\n                    //登入\r\n                    this.localMode = false;\r\n                    this.isChangeClick = true;\r\n                    const btnLocal = this.sceneProxy.recordLayer.getByName('local_btn');\r\n                    const btnCloud = this.sceneProxy.recordLayer.getByName('cloud_btn');\r\n                    btnLocal && btnLocal.changeBackground('local');\r\n                    btnCloud && btnCloud.changeBackground('cloud_hover');\r\n                    this.sceneProxy.onRecordCloudBtnClicked();\r\n                    return;\r\n                },(rj) =>{\r\n                    //未登入\r\n                    this.updateItems();\r\n                    this.game.world.bringToTop(this.sceneProxy.recordLayer);\r\n                    this.showGuide();\r\n                    this.sceneProxy.recordLayer.visible = true;\r\n                    return;\r\n                })\r\n            }else{\r\n                this.updateItems();\r\n                this.game.world.bringToTop(this.sceneProxy.recordLayer);\r\n                this.showGuide();\r\n                this.sceneProxy.recordLayer.visible = true;\r\n            }\r\n        },\r\n        //显示存档提示\r\n        showGuide:function () {\r\n            if(this.sceneProxy.isShowGuide === true\r\n                && this.sceneProxy.recordLayer.visible !== true\r\n                && !this.sceneProxy.isExtend()\r\n                && !Boolean(flashvars.wap && flashvars.wap === \"zxwwap\")\r\n                && !this.sceneProxy.isWapOther()){\r\n                this.sceneProxy.showGuideTip(1);\r\n            }\r\n        },\r\n        //点击间隔\r\n        clickInterval:function (times) {\r\n            if(this.clickchangetime === 0){\r\n                this.clickchangetime = this.game.time.now;\r\n                return true;\r\n            }else{\r\n                if((this.game.time.now - this.clickchangetime) >= times){\r\n                    this.clickchangetime = 0;\r\n                    return true;\r\n                }else{\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    {\r\n        /**\r\n         * @static\r\n         * @type {string}\r\n         */\r\n        NAME: 'RecordMediator'\r\n        , localMode: true\r\n        , isChangeClick:false //是否已点击切换\r\n        , clicktime:0  //存档点击的间隔时间\r\n        , clickchangetime:0 //存档切换时间间隔\r\n    }\r\n);","/**\r\n * @class demo.view.TextComponentMediator\r\n * @extends puremvc.Mediator\r\n */\r\nimport './CoverMediator.js';\r\nimport './MainMenuMediator.js';\r\nimport './SettingsMediator.js';\r\nimport './PlaybackMediator.js';\r\nimport './RecordMediator.js';\r\nimport './EndMediator.js';\r\nimport  * as TextBox from './HtmlTextBox.js';\r\nimport Dialog from './../../common/Dialog.js';\r\nimport RePhaser from '../../common/RePhaser.js';\r\nimport Utils, {ResourcesManager} from '../../common/Utils.js';\r\nimport PhoneUtils from '../../common/PhoneUtils.js';\r\nimport FontUtils from '../../common/FontUtils.js';\r\nimport OtherWap,{H54399Api} from '../../common/OtherWap.js';\r\nimport Copy from 'copy-to-clipboard';\r\n\r\nimport puremvc from 'puremvc';\r\n\r\npuremvc.define\r\n(\r\n\t// CLASS INFO\r\n\t{\r\n\t\tname: 'diygamePlayer.view.mediator.SceneMediator',\r\n\t\tparent: puremvc.Mediator\r\n\t},\r\n\r\n\t// INSTANCE MEMBERS\r\n\t{\r\n\t\t/** @override */\r\n\t\tlistNotificationInterests: function ()\r\n\t\t{\r\n\t\t\treturn [\r\n\t\t\t\tdiygamePlayer.AppConstants.SCENE_SHOW_AD,\r\n\t\t\t\tdiygamePlayer.AppConstants.SCENE_PRELOADING_BEGIN,\r\n\t\t\t\tdiygamePlayer.AppConstants.SCENE_PRELOADING_PROGRESS,\r\n\t\t\t\tdiygamePlayer.AppConstants.SCENE_PRELOADING_COMPLETE,\r\n\t\t\t\tdiygamePlayer.AppConstants.SCENE_LOADING_BEGIN,\r\n\t\t\t\tdiygamePlayer.AppConstants.SCENE_LOADING_PROGRESS,\r\n\t\t\t\tdiygamePlayer.AppConstants.SCENE_LOADING_COMPLETE,\r\n\t\t\t\tdiygamePlayer.AppConstants.SCENE_SHOW_LOGO,\r\n                diygamePlayer.AppConstants.SCENE_PLOT_LOAD_ASSETS_READY,\r\n                diygamePlayer.AppConstants.SCENE_PLOT_LOAD_ASSETS_LOADED,\r\n\t\t\t\tdiygamePlayer.AppConstants.SCENE_DESTROY_VIEW,\r\n                diygamePlayer.AppConstants.SCENE_SHOW_GUIDE,\r\n\t\t\t\tdiygamePlayer.AppConstants.SCENE_SHOW_INPUT_VIEW\r\n\t\t\t\t\t]\r\n\t\t},\r\n\r\n\t\t/** @override */\r\n\t\thandleNotification: function (note)\r\n\t\t{\r\n\t\t\tconst body = note.getBody();\r\n\t\t\tswitch ( note.getName() )\r\n\t\t\t{\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_SHOW_AD:\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_PRELOADING_BEGIN:\r\n\t\t\t\t\tthis.sceneProxy.viewComponent = this.viewComponent;\r\n                    // 创建各个层\r\n                    this.generateLayers();\r\n\r\n\t\t\t\t\tthis.sceneProxy.space_key = this.viewComponent.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);\r\n\t\t\t\t\tthis.addKeyBoardZ();\r\n\r\n\t\t\t\t\tthis.viewComponent.game.input.onHold.add(() => {\r\n\t\t\t\t\t\tthis.screenCaptured();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.viewComponent.game.input.onUp.add(() => {\r\n\t\t\t\t\t\tthis.screenReleased();\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// 设置允许跨域\r\n\t\t\t\t\tthis.viewComponent.game.load.crossOrigin = 'anonymous';\r\n\t\t\t\t\t// 加载json\r\n\t\t\t\t\tthis.viewComponent.preLoad()\r\n\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\tUtils.getSensitiveWords();\r\n                            this.addToastLayer();\r\n                            this.addLoadingToastLayer();\r\n                            return this.viewComponent.getGameJson(this.sceneProxy.isWapOther())\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.then(game => {\r\n\t\t\t\t\t\t\tif (Object.keys(game).length === 0) {\r\n\t\t\t\t\t\t\t\treturn Promise.reject(\"链接已过期\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis.viewComponent.addLog('解析用户配置...');\r\n\t\t\t\t\t\t\tif(flashvars.single && flashvars.offline === '1'){\r\n\t\t\t\t\t\t\t    this.viewComponent.showOfflineBg();\r\n                            }else{\r\n                                this.viewComponent.showLoading();\r\n                            }\r\n\t\t\t\t\t\t\treturn this.sceneProxy.parseJsonFile(game).then(() => {\r\n\t\t\t\t\t\t\t\tthis.viewComponent.addLog('解析用户配置..【成功】', true);\r\n\t\t\t\t\t\t\t\treturn new Promise((resolve,reject) =>{\r\n                                    if(flashvars.single && flashvars.offline === '1'){ //独立 离线    点击继续\r\n                                        const onContinue = (obj, pointer)=>{\r\n                                            if (pointer && pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n                                                return;\r\n                                            }\r\n                                            //点击继续\r\n                                            this.viewComponent.game.input.onDown.dispose();\r\n                                            const imgContinue = this.viewComponent.game.world.getByName('Continue');\r\n                                            imgContinue && imgContinue.destroy();\r\n                                            return resolve();\r\n                                        }\r\n                                        if(this.viewComponent.game.cache.checkImageKey('Continue')){ //添加据需点击按钮\r\n                                            const cimg = this.viewComponent.game.add.image(0, 0, 'Continue');\r\n                                            cimg.name = 'Continue';\r\n                                            cimg.x = (this.viewComponent.game.world.width - cimg.width) / 2;\r\n                                            cimg.y = flashvars.vertical ? ((this.viewComponent.game.world.height - cimg.height) / 2) : (this.viewComponent.game.world.height - 30)\r\n                                            this.viewComponent.game.input.onDown.addOnce(onContinue)\r\n                                        }else{\r\n                                            return resolve();\r\n                                        }\r\n                                    }else{\r\n                                        return resolve();\r\n                                    }\r\n                                })\r\n\r\n\t\t\t\t\t\t\t}, e => {\r\n\t\t\t\t\t\t\t\tthis.viewComponent.addLog('用户配置解析错误:' + e);\r\n\t\t\t\t\t\t\t\treturn Promise.reject(e || \"解析Json错误\")\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t})\r\n                        .then(() => {\r\n\t\t\t\t\t\t\t\tthis.sceneProxy.updateAccInfo(false, true);\r\n                                Utils.sendStatistics();\r\n                                //Utils.uploadLocalStorage().then(r => Utils.downloadLocalStorage());\r\n                            }, e => {\r\n\t\t\t\t\t\t\t\treturn Promise.reject(e)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t.then(() => null, e => {\r\n\t\t\t\t\t\t\tif (flashvars.client && flashvars.client !== '') {\r\n\t\t\t\t\t\t\t\tDialog.warn(e + '关闭播放器吗？').then(() =>{window.location.href = 'lzj3000://quit'}, () => null)\r\n\t\t\t\t\t\t\t} else {\r\n                                Dialog.warn(e + \"，返回闪艺首页吗？\").then(() => window.location.href = \"http:\\\\\\\\www.3000.com\", () => null)\r\n                            }\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_PRELOADING_PROGRESS:\r\n\t\t\t\t\t// 启动资源加载\r\n\t\t\t\t\tthis.assetsLoaderStart(diygamePlayer.AppConstants.SCENE_PRELOADING_COMPLETE);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_PRELOADING_COMPLETE:\r\n\t\t\t\t\tthis.viewComponent.destroyLogo();\r\n\t\t\t\t\tconst game = this.sceneProxy.json_data;\r\n\t\t\t\t\tthis.sceneProxy.initContext();\r\n\t\t\t\t\tconst {sound} = this.sceneProxy.json_data.template.json;\r\n\t\t\t\t\tif (this.viewComponent.game.load.cache.checkSoundKey(sound.url)) {\r\n\t\t\t\t\t\tthis.sceneProxy.btn_sound = this.viewComponent.game.add.sound(sound.url, sound.volume);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//显示引导层\r\n                    this.showGuideTip(0).then(() =>{\r\n                        if (game.logo && !game.logo.background.hidden) {\r\n                            this.sceneProxy.showLogo();// 创建Logo\r\n                        }\r\n                        else if (!game.cover.hidden) {\r\n                            this.sceneProxy.showCover();// 创建封面\r\n                        }\r\n                        else {\r\n                            let chapter = this.sceneProxy.findFirstChapter();\r\n                            const chapterUuid = chapter.downloadUuid ? chapter.downloadUuid : chapter.uuid;\r\n                            if (chapter.md5 && chapter.plots.length === 0) {\r\n                                //第三方\r\n                                if(this.sceneProxy.isWapOther()){\r\n                                    const otherback = (plots)=>{\r\n                                        if(plots === null){\r\n                                            Dialog.error('获取付费章节信息失败');\r\n                                        }else if(plots === \"fail\"){\r\n                                            //查询失败\r\n                                            Dialog.custom(\"Error\",\"仍未查询到您的支付信息哦，请确认已经支付~ 如有疑问请添加闪艺客服QQ：819786897 ~\",\"提示\",\"复制QQ\",\"取消\",false).then(()=>{\r\n                                                Copy(\"819786897\",{\r\n                                                    debug: false,\r\n                                                    message: '复制成功',\r\n                                                })\r\n                                            },()=>{\r\n                                            })\r\n                                        }else{\r\n                                            chapter.plots = plots ? plots : [];\r\n                                            this.sceneProxy.preloadChapterAssets(this.sceneProxy.context, chapter);\r\n                                        }\r\n                                    }\r\n                                    this.sceneProxy.unlockChapterByWapOther(chapterUuid,chapter.charge,chapter.md5,otherback);\r\n                                    return;\r\n                                }\r\n                                if (chapter.charge && ('android' === flashvars.client || 'ios' === flashvars.client || flashvars.client === 'wap')) {\r\n                                    const unlockFinish = (bSuccess) => {\r\n                                        if (bSuccess) {\r\n                                            this.sceneProxy.checkIfChapterFree(chapterUuid, chapter.md5).then((plots)=>{\r\n                                                this.sceneProxy.unlockChapterCallBack = null;\r\n                                                chapter.plots.push(...plots);\r\n                                                this.sceneProxy.preloadChapterAssets(this.sceneProxy.context, chapter);\r\n                                            }, () => {\r\n                                                if(flashvars.client === 'wap'){\r\n                                                    window.parent && window.parent.playLogin();\r\n                                                }else{\r\n                                                    Dialog.error('获取付费章节信息失败');\r\n                                                }\r\n                                            })\r\n                                        } else {\r\n                                            Dialog.error('章节解锁失败');\r\n                                        }\r\n                                    };\r\n\r\n                                    this.sceneProxy.unlockChapter(chapterUuid, chapter.charge, chapter.md5, unlockFinish);\r\n                                } else {\r\n                                    this.sceneProxy.checkIfChapterFree(chapterUuid, chapter.md5).then((plots)=>{\r\n                                        chapter.plots.push(...plots);\r\n                                        this.sceneProxy.preloadChapterAssets(this.sceneProxy.context, chapter);\r\n                                    }, (msg)=>{\r\n                                        if (-1 === msg.indexOf('code=87')) {\r\n                                            Dialog.error(msg);\r\n                                        } else { // 未购买此章节\r\n                                            if(flashvars.wap === 'zxwwap'){\r\n                                                Dialog.info('当前为收费章节，是否前往闪艺抢先体验？').then(()=>{\r\n                                                    window.location.href = 'https://wap.3000.com/?m=detail&op=index&ac=index&id='+ flashvars.gid;\r\n                                                })\r\n                                            }else{\r\n                                                Dialog.info('当前为收费章节，请前往闪艺app或电脑端进行购买');\r\n                                            }\r\n                                        }\r\n                                    })\r\n                                }\r\n                            }\r\n                            else {// 播放剧情\r\n                                this.sceneProxy.preloadChapterAssets(this.sceneProxy.context, chapter);\r\n                            }\r\n                        }\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_LOADING_BEGIN:\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_LOADING_PROGRESS:\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_LOADING_COMPLETE:\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_SHOW_LOGO:\r\n\t\t\t\t\tthis.showLogo();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_PLOT_LOAD_ASSETS_READY:\r\n\t\t\t\t\tthis.assetsLoaderStart(diygamePlayer.AppConstants.SCENE_PLOT_LOAD_ASSETS_LOADED, body);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_PLOT_LOAD_ASSETS_LOADED:\r\n\t\t\t\t\tthis.showPlot(body.context, this.sceneProxy.curChapter, this.sceneProxy.curPlotIndex, this.sceneProxy.cmdPlotSnap, body.loadData);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_DESTROY_VIEW:\r\n\t\t\t\t\tthis.destroyView(body.name, body.isMainMenu);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_SHOW_GUIDE:\r\n\t\t\t\t\tthis.showGuideTip(body.id);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase diygamePlayer.AppConstants.SCENE_SHOW_INPUT_VIEW:\r\n\t\t\t\t\tthis.showInputView(this.sceneProxy.plotViewsLayer, !!body);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t},\r\n        /**\r\n         * 添加按键Z\r\n         */\r\n        addKeyBoardZ:function () {\r\n            if(this.sceneProxy.z_key !== null) return;\r\n            this.sceneProxy.z_key = this.viewComponent.game.input.keyboard.addKey(Phaser.Keyboard.Z);\r\n            this.sceneProxy.z_key.onDown.add(() => {\r\n                this.sceneProxy.quickPlay = true\r\n            });\r\n            this.sceneProxy.z_key.onUp.add(() => {\r\n                this.sceneProxy.quickPlay = false\r\n            });\r\n        },\r\n        /**\r\n         * 移除按键Z\r\n         */\r\n        removeKeyBoardZ:function () {\r\n            this.viewComponent.game.input.keyboard.removeKey(Phaser.Keyboard.Z);\r\n            this.sceneProxy.z_key = null;\r\n        },\r\n\t\tgenerateLayers: function () {\r\n            this.sceneProxy.coverLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.coverLayer.name = 'coverLayer';\r\n            this.sceneProxy.progressLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.progressLayer.name = 'progressLayer';\r\n            this.sceneProxy.dialogLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.dialogLayer.name = 'dialogLayer';\r\n            this.sceneProxy.dialogLayer.animateTweens = [];\r\n            this.sceneProxy.menuLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.menuLayer.name = 'menuLayer';\r\n            this.sceneProxy.mainMenuLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.mainMenuLayer.name = 'mainMenuLayer';\r\n            this.sceneProxy.mainMenuLayer.visible = false;\r\n            this.sceneProxy.settingsLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.settingsLayer.name = 'settingsLayer';\r\n            this.sceneProxy.settingsLayer.visible = false;\r\n            this.sceneProxy.recordLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.recordLayer.name = 'recordLayer';\r\n            this.sceneProxy.recordLayer.visible = false;\r\n            this.sceneProxy.playBackLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.playBackLayer.name = 'playBackLayer';\r\n            this.sceneProxy.playBackLayer.visible = false;\r\n            this.sceneProxy.weatherLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.weatherLayer.name = 'weatherLayer';\r\n            this.sceneProxy.plotViewsLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.plotViewsLayer.name = 'plotViewsLayer';\r\n            this.sceneProxy.endLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.endLayer.name = 'endLayer';\r\n            this.sceneProxy.toastLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.toastLayer.name = 'toastLayer';\r\n            this.sceneProxy.loadingToastLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.loadingToastLayer.name = 'loadToastLayer';\r\n            this.sceneProxy.quickPlayLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.quickPlayLayer.name = 'quickPlayLayer';\r\n            this.sceneProxy.guideLayer = this.viewComponent.game.add.group();\r\n            this.sceneProxy.guideLayer.name = 'guideLayer';\r\n            this.sceneProxy.bubbleLayer = this.viewComponent.game.add.group(); //气泡层\r\n            this.sceneProxy.bubbleLayer.name = 'bubbleLayer';\r\n            this.sceneProxy.bubbleLayer.animateTweens = [];\r\n        },\r\n\r\n\t\tscreenCaptured: function () {\r\n\t\t\tif (!this.sceneProxy.isGameStarted || this.sceneProxy.playPause === true) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n            if(this.sceneProxy.isQuickPlay !== true){\r\n\t\t\t    return;\r\n            }\r\n            if (this.sceneProxy.quickPlayLayer.children.length === 0) {\r\n                const bk = this.sceneProxy.quickPlayLayer.create(0, 0, 'app_button_speed');\r\n                const icon = this.sceneProxy.quickPlayLayer.create(0, 0, 'app_icon_speed');\r\n                const f1 = {font: '25px PingFang-SC-Regular', fill: '#333333'};\r\n                const t1 = this.viewComponent.game.add.text(0, 0, '快进中...', f1, this.sceneProxy.quickPlayLayer);\r\n                const f2 = {font: '20px PingFang-SC-Regular', fill: '#aaadb3'};\r\n                const t2 = this.viewComponent.game.add.text(0, 0, '松开手指恢复播放', f2, this.sceneProxy.quickPlayLayer);\r\n\r\n                bk.x = (this.viewComponent.game.world.width - bk.width) / 2;\r\n                bk.y = (this.viewComponent.game.world.height - bk.height) / 2;\r\n                icon.x = bk.x + 90;\r\n                icon.y = bk.y + 25;\r\n                t1.x = icon.x - 10;\r\n                t1.y = icon.y + icon.height + 14;\r\n                t2.x = bk.x + 39;\r\n                t2.y = t1.y + 33;\r\n            }\r\n\r\n            this.sceneProxy.isScreenHold = true;\r\n\t\t\tthis.sceneProxy.quickPlay = true;\r\n\t\t\tthis.sceneProxy.removePlotTweens();\r\n\r\n            const quickPlayHandler = () => {\r\n                const sceneProxy = this.sceneProxy;\r\n                const game = this.viewComponent.game;\r\n                return function () {\r\n                    const hasView = sceneProxy.plotViewsLayer.children.length > 0;\r\n                    if (!hasView && sceneProxy.playPause !== true) { //没有高级界面,同时不处于暂停状态\r\n                        let pointer = new Phaser.Pointer(game, 1, Phaser.PointerMode.CURSOR);\r\n                        pointer.button = 0;\r\n                        sceneProxy.curPlotLayer.onChildInputDown.dispatch('quickPlayHandler', pointer);\r\n                    }\r\n\r\n                    if (sceneProxy.isScreenHold) {\r\n                        setTimeout(quickPlayHandler(), 500);\r\n                    }\r\n                }\r\n            };\r\n            setTimeout(quickPlayHandler(), 20);\r\n\r\n            this.sceneProxy.quickPlayLayer.alpha = 1;\r\n\t\t\tthis.viewComponent.game.world.bringToTop(this.sceneProxy.quickPlayLayer);\r\n        },\r\n\t\tscreenReleased: function () {\r\n\t\t\tif (this.sceneProxy.isScreenHold) {\r\n\t\t\t\tthis.sceneProxy.isScreenHold = false;\r\n\t\t\t\tthis.sceneProxy.quickPlay = false;\r\n\r\n                this.sceneProxy.quickPlayLayer.alpha = 0;\r\n                //this.viewComponent.game.add.tween(this.sceneProxy.quickPlayLayer).from({alpha: 1}, 800, null, true).name = 'toast';\r\n\t\t\t}\r\n        },\r\n\r\n        cmdPlotLoadResources: function(context, chapter, nPlot, cmdInfo, index) {\r\n            const load = this.viewComponent.game.load;\r\n            const cache = load.cache;\r\n            const cmd = cmdInfo.commands[index];\r\n            const resources = ResourcesManager.getCommandResources(cmd);\r\n            const usePhoneUtils = 'ios' === flashvars.client && flashvars.app_version >= '1.5.0';\r\n            let needLoadNum = 0;\r\n            let loadingAssets = [];\r\n\r\n            resources.forEach(({ type, url }) => {\r\n                if (!url) {\r\n                    return;\r\n                }\r\n                if (type === 'audio' && usePhoneUtils) {\r\n                    !PhoneUtils.isAudioInCache(url) && (needLoadNum++);\r\n                    return;\r\n                }\r\n                let exist = type === 'img' ? cache.checkImageKey(url) : cache.checkSoundKey(url);\r\n                if (!exist) {\r\n                    needLoadNum++;\r\n                    exist = load.getAsset('img' === type ? 'image' : 'audio', url)\r\n                    if (exist) {\r\n                        loadingAssets.push({ type, key:url });\r\n                    }\r\n                }\r\n            });\r\n\r\n            let countCmd = 0;\r\n            const newResources = [];\r\n            const getInCommands = commands => {\r\n                for (let i = 0; i < commands.length && countCmd < 5; i++) {\r\n                    const cmd = commands[i];\r\n                    const res = ResourcesManager.getCommandResources(cmd);\r\n                    if (res.length) {\r\n                        newResources.push(...res);\r\n                        countCmd++;\r\n                    }\r\n\r\n                    if ((cmd.type === 'options' || cmd.type === 'conditionOptions')) {\r\n                        for (let j = 0; j < cmd.args.length && countCmd < 5; j++) {\r\n                            getInCommands(cmd.args[j].commands);\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n            ResourcesManager.clearPreCmdResources(cmdInfo.commands, index);\r\n            if (needLoadNum !== loadingAssets.length) {\r\n                return this.sceneProxy.preloadCommandsAssets(context, chapter, nPlot, cmdInfo, index).then(needLoadList => this.assetsLoader(needLoadList, true, true));\r\n            } else if (needLoadNum) {\r\n                getInCommands(cmdInfo.commands.slice(index));         \r\n                loadingAssets = newResources.filter(({ type, url }) => load.getAsset('img' === type ? 'image' : 'audio', url)).map(a => Object.assign(a, { key: a.url }));\r\n                return this.assetsLoader(loadingAssets, true);\r\n            }\r\n            return Promise.resolve();\r\n        },\r\n\r\n        //引导层\r\n        showGuideTip:function (showtype) {\r\n\t\t    if(flashvars.single && flashvars.offline === '1'){ //离线独立播放器  无需引导\r\n\t\t        return Promise.resolve();\r\n            }\r\n\t\t\treturn new Promise((resolve,reject) =>{\r\n                if('android' !== flashvars.client && 'ios' !== flashvars.client){\r\n                    //非移动端 无需引导图\r\n                    this.sceneProxy.isShowGuide = false;\r\n                    this.sceneProxy.guideLayer.visible = false;\r\n                    return resolve();\r\n                };\r\n                const show=(type) =>{\r\n                    if(this.sceneProxy.isShowGuide === true){\r\n                        let OperationImg = this.sceneProxy.guideLayer.getByName(\"Operation_tip\");\r\n                        let CloudImg = this.sceneProxy.guideLayer.getByName(\"Cloud_record_tip\");\r\n                        if(this.sceneProxy.guideLayer.children.length <= 0){\r\n                            this.sceneProxy.guideLayer.inputEnableChildren = true;\r\n                            this.sceneProxy.guideLayer.inputEnabled = true;\r\n                            if((!this.viewComponent.game.load.cache.checkImageKey(\"Operation_tip\") && type === 0)\r\n                                || (!this.viewComponent.game.load.cache.checkImageKey(\"Cloud_record_tip\") && type === 1)){\r\n                                //图片不存在时  不显示引导\r\n                                return resolve();\r\n                            }\r\n                            OperationImg = this.sceneProxy.guideLayer.create(this.viewComponent.game.world.width / 2, this.viewComponent.game.world.height / 2,\"Operation_tip\");\r\n                            OperationImg.name = 'Operation_tip';\r\n                            OperationImg.anchor.setTo(0.5, 0.5);\r\n                            OperationImg.visible = false;\r\n\r\n                            CloudImg = this.sceneProxy.guideLayer.create(this.viewComponent.game.world.width / 2, this.viewComponent.game.world.height / 2,\"Cloud_record_tip\");\r\n                            CloudImg.name = 'Cloud_record_tip';\r\n                            CloudImg.anchor.setTo(0.5, 0.5);\r\n                            CloudImg.visible =false;\r\n                        }\r\n\r\n                        this.sceneProxy.guideLayer.alpha = 1;\r\n                        this.sceneProxy.guideLayer.visible = true;\r\n                        OperationImg.visible = type === 0 ? true : false;\r\n                        CloudImg.visible = type === 0 ? false : true;\r\n                        this.viewComponent.game.world.bringToTop(this.sceneProxy.guideLayer);\r\n                        const onClick = (obj, pointer) => {\r\n                            if (pointer && pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n                                return;\r\n                            }\r\n                            this.sceneProxy.guideLayer.onChildInputDown.remove(onClick)\r\n                            this.tweenToPromise(\r\n                                this.sceneProxy.guideLayer,\r\n                                {alpha:0},\r\n                                1000, null, true, 0, 0, false)\r\n                                .then(() =>{\r\n                                    this.sceneProxy.guideLayer.visible = false;\r\n                                    this.sceneProxy.guideLayer.alpha = 0;\r\n                                    if(type !==0) this.sceneProxy.isShowGuide = false;\r\n                                    Utils.localStorageSetItem(uuid,JSON.stringify({count:this.sceneProxy.recordTipCount}));\r\n                                    return resolve();\r\n                                })\r\n                        };\r\n                        this.sceneProxy.guideLayer.onChildInputDown.add(onClick);\r\n                    };\r\n                };\r\n\r\n\t\t\t\tconst uuid = \"shanyi3000guide\";//\"guide\" + flashvars.uuid;\r\n\t\t\t\tlet localtype = -1;//存档的类型\r\n\t\t\t\tconst guidedata = JSON.parse(Utils.localStorageGetItem(uuid));\r\n\t\t\t\tif(guidedata !== null && guidedata !== undefined ){\r\n\t\t\t\t\t//存档有值\r\n\t\t\t\t\tthis.sceneProxy.recordTipCount = guidedata.count;\r\n                    if(showtype === 1){\r\n                            //超过10次 无须引导\r\n\t\t\t\t\t\tif(this.sceneProxy.recordTipCount >=10){\r\n\t\t\t\t\t\t\tthis.sceneProxy.isShowGuide = false;\r\n                            this.sceneProxy.guideLayer.visible = false;\r\n\t\t\t\t\t\t\treturn resolve();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.sceneProxy.recordTipCount ++;\r\n\t\t\t\t\t\tconsole.log(\"引导层次数：\" + this.sceneProxy.recordTipCount);\r\n                        show(showtype);\r\n\t\t\t\t\t}else if(showtype === 0){\r\n                    \tthis.sceneProxy.guideLayer.visible = false;\r\n                        return resolve();\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\t//没有存档值，显示0引导图\r\n                    this.sceneProxy.isShowGuide = true;\r\n                    show(showtype);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n        },\r\n\r\n\t\taddLoadingToastLayer: function () {\r\n\t\t\tif (this.sceneProxy.loadingToastLayer.children.length === 0) {\r\n                let g = this.viewComponent.game.add.group();\r\n                this.sceneProxy.loadingToastLayer.add(g);\r\n\r\n                let bk = this.viewComponent.game.add.graphics(/*350*/0, /*252*/0, g);\r\n                bk.beginFill(0x3dc4cc);\r\n                bk.drawRect(0, 0, 135, 36);\r\n                bk.endFill();\r\n\r\n                const tl = g.create(8, 9, 'toast_loading');\r\n                this.viewComponent.addGifAnimation(tl, 'toast_loading');\r\n\r\n                const fontStyle = {font: '16px 微软雅黑', fill: '#ffffff'};\r\n                let toastText = this.viewComponent.game.add.text(/*380*/33, /*260*/8, '保存档案中~', fontStyle, g);\r\n                toastText.name = 'toastText';\r\n                g.x = (this.viewComponent.game.world.width - toastText.width) / 2;\r\n                g.y = flashvars.vertical ? 100 : 252;\r\n                g.alpha = 0.8;\r\n                this.sceneProxy.loadingToastLayer.visible = false;\r\n            }\r\n        },\r\n\r\n\t\taddToastLayer: function () {\r\n\t\t\tif (this.sceneProxy.toastLayer.children.length === 0) {\r\n\t\t\t\tlet typeSuccess = this.viewComponent.game.add.group();\r\n\t\t\t\tlet typeError = this.viewComponent.game.add.group();\r\n\t\t\t\ttypeSuccess.name = 'typeSuccess';\r\n\t\t\t\ttypeError.name = 'typeError';\r\n\t\t\t\tthis.sceneProxy.toastLayer.add(typeSuccess);\r\n\t\t\t\tthis.sceneProxy.toastLayer.add(typeError);\r\n\r\n\t\t\t\tlet bk1 = this.viewComponent.game.add.graphics(/*320*/0, /*252*/0, typeSuccess);\r\n                let bk2 = this.viewComponent.game.add.graphics(/*350*/0, /*252*/0, typeError);\r\n                bk1.beginFill(0x3dc4cc);\r\n                bk1.drawRect(0, 0, 320, 36);\r\n                bk1.endFill();\r\n                bk2.beginFill(0x3dc4cc);\r\n                bk2.drawRect(0, 0, 260, 36);\r\n                bk2.endFill();\r\n\r\n\t\t\t\ttypeSuccess.create(/*330*/10, /*262*/10, 'icon_success');\r\n\t\t\t\ttypeError.create(/*360*/10, /*262*/10, 'icon_error');\r\n\r\n                const fontStyle = {font: '16px 微软雅黑', fill: '#ffffff'};\r\n                let toastText = this.viewComponent.game.add.text(/*350*/30, /*260*/8, '存档成功，下次可以从这里读档继续哦~', fontStyle, typeSuccess);\r\n                toastText.name = 'toastText';\r\n\r\n                toastText = this.viewComponent.game.add.text(/*380*/30, /*260*/8, '存档失败，请检查您的网络哦~', fontStyle, typeError);\r\n                toastText.name = 'toastText';\r\n\r\n                typeSuccess.visible = false;\r\n                typeError.visible = false;\r\n                this.sceneProxy.toastLayer.alpha = 0;\r\n            }\r\n        },\r\n\r\n\t\tassetsLoaderStart: function (nextNotifier, body) {\r\n\t\t\tconst { needLoadList=[] } = body || {};\r\n\t\t\tif(!body){\r\n\t\t\t   //开头加载\r\n               this.viewComponent.preLoadWeatherAssets();//加入天气素材\r\n            }\r\n\t\t\treturn this.assetsLoader(needLoadList, !!body).then(() => this.sceneProxy.sendNotification(nextNotifier, body));\r\n\t\t},\r\n\r\n\t\tassetsLoader: function (assets = [], isChapter=true, show=true) {\r\n\t\t\tconst context = Object.create(null);\r\n\t\t\tconst decodingAudios = [];\r\n\t\t\tconst { game } = this.viewComponent;\r\n            let loadedFileCount = 0;\r\n            const { load, sound, cache } = game;\r\n            const canUsePhoneAudioLoad = 'ios' === flashvars.client && '1.5.0' <= flashvars.app_version;\r\n            assets = assets.filter(({type, key}) => {\r\n                if ('img' === type) {\r\n                    return !cache.checkImageKey(key) && load.getAsset('image', key);\r\n                } else if ('audio' === type) {\r\n                    return canUsePhoneAudioLoad\r\n                        ? !PhoneUtils.isAudioInCache(key) && PhoneUtils.isLoadingAudio(key)\r\n                        : !cache.checkSoundKey(key) && load.getAsset('audio', key);\r\n                }\r\n            });\r\n            let covermusickey = '';\r\n            if(!isChapter && this.sceneProxy.json_data.cover.music && this.sceneProxy.json_data.cover.music.url && canUsePhoneAudioLoad && flashvars.offline === ''){\r\n                covermusickey = this.sceneProxy.json_data.cover.music.url;\r\n                if(!PhoneUtils.isAudioInCache(covermusickey) && !PhoneUtils.isAudioError(covermusickey)){ //没在缓存中 也没有加载出错\r\n                    load._totalFileCount +=1;\r\n                }else{\r\n                    covermusickey = '';\r\n                }\r\n            }\r\n            let totalFileCount = isChapter ? assets.length : load._totalFileCount;\r\n\t\t\tlet isLoadComplete = false;\r\n            if (!totalFileCount) {\r\n                return Promise.resolve();\r\n            }\r\n            \r\n\t\t\treturn new Promise((resolve, reject) => {\r\n                let covermusiccomplete = covermusickey === '';\r\n                const updateLoadedCount = (key) => {\r\n                    if (assets.length) {\r\n                        assets.forEach(asset =>{//遍历数组中相同key  loaded = true\r\n                            if(asset.key === key){\r\n                                if (asset && !asset.loaded) {\r\n                                    asset.loaded = true;\r\n                                    loadedFileCount++;\r\n                                }\r\n                            }\r\n                        })\r\n                        /*const asset = assets.find(a => a.key === key);\r\n                        if (asset && !asset.loaded) {\r\n                            asset.loaded = true;\r\n                            loadedFileCount++;\r\n                        }*/\r\n                    } else {\r\n                        loadedFileCount++;\r\n                    }\r\n                };\r\n\t\t\t\tconst checkFinished = () => {\r\n\t\t\t\t\tconst hasAudioLoadFinish = canUsePhoneAudioLoad \r\n\t\t\t\t\t\t? ((covermusickey !== ''&& !isChapter) ? covermusiccomplete : assets.every(a => a.loaded))/*? assets.every(a => a.loaded)*/\r\n\t\t\t\t\t\t: decodingAudios.every(sound => sound.decoded);\r\n                    if (isLoadComplete && hasAudioLoadFinish) {\r\n                    \tPhoneUtils.audioCountLoadByPhone.total = 0;\r\n                    \tPhoneUtils.audioCountLoadByPhone.loaded = 0;\r\n                    \tsound.onSoundDecode.removeAll(context);\r\n                    \tsound.onSoundDecodeError.removeAll(context);\r\n                        load.onSoundExtendLoad.removeAll(context);\r\n                        load.onSoundExtendLoadError.removeAll(context);\r\n                    \tthis.sceneProxy.progressLayer.visible = false;\r\n                    \tresolve();\r\n                    }\r\n                    load.onFileComplete.removeAll(context);\r\n\t\t\t\t};\r\n                const handleSoundExtendLoad = (key) => {\r\n                    if(covermusickey !== '' && !isChapter){\r\n                        if(key === covermusickey){\r\n                            covermusiccomplete = true\r\n                        }else{\r\n                            return;\r\n                        }\r\n                    }\r\n                    if (assets.every(a => a.loaded) && isLoadComplete === true && covermusickey === '') {\r\n                        return;\r\n                    }\r\n                    updateLoadedCount(key);\r\n                    const progress = parseInt(100 * loadedFileCount / totalFileCount);\r\n                    show && this.showProgress(progress, loadedFileCount, totalFileCount, isChapter);\r\n                    assets.every(a => a.loaded) && (isLoadComplete = true) && checkFinished();\r\n                };\r\n\t\t\t\tconst handleSoundDecodeError = (key) => {\r\n\t\t\t\t\tlet index = -1;\r\n\t\t\t\t\tconst sound = cache.getSound(key);\r\n\t\t\t\t\tif ((index = decodingAudios.findIndex(s => s === sound)) !== -1) {\r\n\t\t\t\t\t\tdecodingAudios.splice(index, 1);\r\n\t\t\t\t\t\tcache.removeSound(key);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcheckFinished();\r\n\t\t\t\t};\r\n\t\t\t\tsound.onSoundDecode.add(() => checkFinished(), context);\r\n\t\t\t\tsound.onSoundDecodeError.add(handleSoundDecodeError, context);\r\n                load.onSoundExtendLoad.add(handleSoundExtendLoad, context);\r\n                load.onSoundExtendLoadError.add(handleSoundExtendLoad, context);\r\n\r\n\t\t\t\tload.onFileComplete.add((progress, cacheKey, success, totalLoaded, totalFiles) => {\r\n\t\t\t\t\tupdateLoadedCount(cacheKey);\r\n\r\n\t\t\t\t\tprogress = parseInt(100 * loadedFileCount / totalFileCount);\r\n\t\t\t\t\tshow && this.showProgress(progress, loadedFileCount, totalFileCount, isChapter);\r\n\r\n\t\t\t\t\tif(cache.checkKey(Phaser.Cache.SOUND, cacheKey)){\r\n\t\t\t\t\t\tconst sound = cache.getSound(cacheKey);\r\n\t\t\t\t\t\tif (sound && sound.autoDecode && sound.isDecoding  && !sound.decoded) {\r\n\t\t\t\t\t\t\tdecodingAudios.push(sound);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (assets.length && assets.every(a => a.loaded)) {\r\n\t\t\t\t\t\tisLoadComplete = true;\r\n\t\t\t\t\t\tcheckFinished();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, context, 0);\r\n\t\t\t\tload.onLoadComplete.addOnce(function() {\r\n\t\t\t\t\tif(!isLoadComplete){\r\n\t\t\t\t\t\tisLoadComplete = true;\r\n\t\t\t\t\t\tcheckFinished();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, context, 0);\r\n                \r\n                totalFileCount && this.showProgress(0, 0, 0, isChapter);\r\n\t\t\t\tload.start();\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tshowLogo: function () {\r\n\t\t\tconst {json_data, context} = this.sceneProxy;\r\n\t\t\tconst {logo, chapters, cover} = json_data;\r\n\t\t\tif (!logo || !logo.background || logo.background.hidden || !this.viewComponent.game.load.cache.checkImageKey(logo.background.url)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst {flex, opacity} = logo.background;\r\n            this.sceneProxy.prePlotBkKey = this.sceneProxy.lstPlotBkKey;\r\n            this.sceneProxy.lstPlotBkKey = logo.background.url;\r\n            this.sceneProxy.lstPlotBkOpacity = logo.background.opacity;\r\n            this.sceneProxy.lstPlotBkFlex = flex;\r\n\t\t\tconst game_logo = this.viewComponent.game.add.image(0, 0, logo.background.url);\r\n\t\t\tthis.backgroundFlex(game_logo, flex);\r\n\t\t\tgame_logo.bringToTop();\r\n\t\t\tgame_logo.alpha = 0;\r\n\t\t\tthis.tweenToPromise(game_logo, {alpha: opacity}, 1000, null, true, 0)\r\n\t\t\t\t.then(() => Utils.timeout(1000))\r\n\t\t\t\t.then(() => this.tweenToPromise(game_logo, {alpha: 0}, 1000, null, true, 0).then(() => {\r\n\t\t\t\t\t\tif (!cover.hidden) {\r\n\t\t\t\t\t\t\tthis.sceneProxy.showCover();// 创建封面\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tlet chapter = this.sceneProxy.findFirstChapter();\r\n\t\t\t\t\t\t\tconst chapterUuid = chapter.downloadUuid ? chapter.downloadUuid : chapter.uuid;\r\n                            if (chapter.md5 && chapter.plots.length === 0) {\r\n                                //第三方\r\n                                if(this.sceneProxy.isWapOther()){\r\n                                    const otherback = (plots)=>{\r\n                                        if(plots === null){\r\n                                            Dialog.error('获取付费章节信息失败');\r\n                                        }else if(plots === \"fail\"){\r\n                                            //查询失败\r\n                                            Dialog.custom(\"Error\",\"仍未查询到您的支付信息哦，请确认已经支付~ 如有疑问请添加闪艺客服QQ：819786897 ~\",\"提示\",\"复制QQ\",\"取消\",false).then(()=>{\r\n                                                Copy(\"819786897\",{\r\n                                                    debug: false,\r\n                                                    message: '复制成功',\r\n                                                })\r\n                                            },()=>{\r\n                                            })\r\n                                        }else{\r\n                                            chapter.plots = plots ? plots : [];\r\n                                            this.sceneProxy.preloadChapterAssets(this.sceneProxy.context, chapter);\r\n                                        }\r\n                                    }\r\n                                    this.sceneProxy.unlockChapterByWapOther(chapterUuid,chapter.charge,chapter.md5,otherback);\r\n                                    return;\r\n                                }\r\n                                if (chapter.charge && ('android' === flashvars.client || 'ios' === flashvars.client || flashvars.client === 'wap')) {\r\n                                    const unlockFinish = (bSuccess) => {\r\n                                        if (bSuccess) {\r\n                                            this.sceneProxy.checkIfChapterFree(chapterUuid, chapter.md5).then((plots)=>{\r\n                                                this.sceneProxy.unlockChapterCallBack = null;\r\n                                                chapter.plots.push(...plots);\r\n                                                this.sceneProxy.preloadChapterAssets(context, chapter);\r\n                                            }, () => {\r\n                                                if(flashvars.client === 'wap'){\r\n                                                    window.parent && window.parent.playLogin();\r\n                                                }else{\r\n                                                    Dialog.error('获取付费章节信息失败')\r\n                                                }\r\n                                            })\r\n                                        } else {\r\n                                            Dialog.error('章节解锁失败');\r\n                                        }\r\n                                    };\r\n\r\n                                    this.sceneProxy.unlockChapter(chapterUuid, chapter.charge, chapter.md5, unlockFinish);\r\n\t\t\t\t\t\t\t\t} else {\r\n                                    this.sceneProxy.checkIfChapterFree(chapterUuid, chapter.md5).then((plots)=>{\r\n                                        chapter.plots.push(...plots);\r\n                                        this.sceneProxy.preloadChapterAssets(context, chapter);\r\n                                    }, (msg)=>{\r\n                                        if (-1 === msg.indexOf('code=87')) {\r\n                                            Dialog.error(msg);\r\n                                        } else { // 未购买此章节\r\n                                            if(flashvars.wap === 'zxwwap'){\r\n                                                Dialog.info('当前为收费章节，是否前往闪艺抢先体验？').then(()=>{\r\n                                                    window.location.href = 'https://wap.3000.com/?m=detail&op=index&ac=index&id='+ flashvars.gid;\r\n                                                })\r\n                                            }else{\r\n                                                Dialog.info('当前为收费章节，请前往闪艺app或电脑端进行购买');\r\n                                            }\r\n                                        }\r\n                                    })\r\n\t\t\t\t\t\t\t\t}\r\n                            }\r\n                            else {// 播放剧情\r\n                            \tthis.sceneProxy.preloadChapterAssets(context, chapter);\r\n                            }\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t},\r\n\r\n\t\tshowProgress: function (progress, totalLoaded, totalFiles, isChapter) {\r\n\t\t\tlet background = this.sceneProxy.progressLayer.getByName(\"background\");\r\n\t\t\tlet type0 = this.sceneProxy.progressLayer.getByName(\"type0\");\r\n\t\t\tlet type1 = this.sceneProxy.progressLayer.getByName(\"type1\");\r\n\t\t\tconst width = this.viewComponent.game.world.width;\r\n\t\t\tconst height = this.viewComponent.game.world.height;\r\n\r\n\t\t\tif (!background) {\r\n\t\t\t\tbackground = this.viewComponent.game.add.graphics(0, 0, this.sceneProxy.progressLayer);\r\n\t\t\t\tbackground.beginFill(0x0);\r\n\t\t\t\tbackground.drawRect(0, 0, width, height);\r\n\t\t\t\tbackground.endFill();\r\n\t\t\t\tbackground.name = 'background';\r\n\t\t\t\tbackground.inputEnabled = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (isChapter) {\r\n\r\n\t\t\t\t//章节素材加载\r\n\t\t\t\tbackground.alpha = 0.5;\r\n\t\t\t\tif (!type1) {\r\n\t\t\t\t\ttype1 = this.viewComponent.game.add.group();\r\n\t\t\t\t\ttype1.name = 'type1';\r\n\t\t\t\t\tthis.sceneProxy.progressLayer.add(type1);\r\n\t\t\t\t}\r\n\r\n                let progressText = type1.getByName('progressText');\r\n                if (!progressText) {\r\n                    const fontSytle = { font: '24px 微软雅黑', fill: '#ffffff', boundsAlignH: \"center\", boundsAlignV: \"middle\" };\r\n                    progressText = this.viewComponent.game.add.text(0, 0, '', fontSytle, type1);\r\n                    progressText.name = 'progressText';\r\n                    progressText.setTextBounds(width / 2 - 90, height / 2 - 20, 180, 30);\r\n                }\r\n                progressText.text = \"加载中...\" + progress + '%';\r\n\r\n\t\t\t\ttype0 && (type0.visible = false);\r\n\t\t\t\ttype1 && (type1.visible = true);\r\n\t\t\t\tthis.sceneProxy.progressLayer.bringToTop(type1);\r\n\t\t\t} else {\r\n\t\t\t\t//开头加载\r\n\t\t\t\tbackground.alpha = 0;\r\n\t\t\t\tif (!type0) {\r\n\t\t\t\t\ttype0 = this.viewComponent.game.add.group();\r\n\t\t\t\t\ttype0.name = 'type0';\r\n\t\t\t\t\tthis.sceneProxy.progressLayer.add(type0);\r\n\t\t\t\t}\r\n\t\t\t\tlet progressText = type0.getByName('progressText');\r\n\t\t\t\tlet tipText = type0.getByName('tipText');\r\n\t\t\t\tlet progressBar = type0.getByName(\"progressBar\");\r\n\t\t\t\tlet tipLight = type0.getByName('tipLight');\r\n\r\n\t\t\t\tif (!progressText) {\r\n\t\t\t\t\t//const fontSytle = {font: flashvars.vertical ? \"16px 微软雅黑\" : '18px 微软雅黑', fill: '#ffffff', boundsAlignH: \"center\", boundsAlignV: \"middle\" };\r\n\t\t\t\t\tconst fontSytle = {font:'18px 微软雅黑', fill: '#ffffff', boundsAlignH: \"center\", boundsAlignV: \"middle\",align:\"center\",wordWrap:true};\r\n\t\t\t\t\tprogressText = this.viewComponent.game.add.text(0, 0, \"\", fontSytle, type0);\r\n\t\t\t\t\tprogressText.name = 'progressText';\r\n                    //progressText.setTextBounds(28, 390, width-25, 18);\r\n                    progressText.setTextBounds(28, flashvars.vertical ? (height / 2 + 50) : 390, width-25, 18);\r\n\t\t\t\t}\r\n\t\t\t\tlet tipcontent = \"小贴士：\" +  this.sceneProxy.progressTips[Math.floor(Math.random()*this.sceneProxy.progressTips.length)];\r\n\t\t\t\tif(flashvars.vertical){//竖屏时，自动换行（phaser text自动换行无效，判断长度超过22 插入换行）\r\n                    if(tipcontent.length > 22){\r\n                        const tipary = tipcontent.split(\"\");\r\n                        tipary.splice(20,0,\"\\n\");\r\n                        tipcontent = tipary.join(\"\").toString();\r\n                    }\r\n                }\r\n                if(flashvars.single && flashvars.offline === '1'){progressText.visible = false}\r\n                progressText.text == '' && (progressText.text =tipcontent);\r\n                //progressText.text === '' && (progressText.text = (\"小贴士: \" +  this.sceneProxy.progressTips[Math.floor(Math.random()*this.sceneProxy.progressTips.length)]));\r\n\r\n\t\t\t\tif (!tipLight) {\r\n\t\t\t\t\t//tipLight = this.viewComponent.game.add.image((width - progressText.width - 28) / 2,385 , 'light', 0, type0);\r\n\t\t\t\t\ttipLight = this.viewComponent.game.add.image((width - progressText.width - 28) / 2,flashvars.vertical ? (tipcontent.length > 22 ? (height / 2 + 33) : (height / 2 + 46)) : 385 , 'light', 0, type0);\r\n\t\t\t\t\ttipLight.name = 'tipLight';\r\n\t\t\t\t}\r\n                if(flashvars.single && flashvars.offline === '1'){tipLight.visible = false}\r\n\t\t\t\tif (!tipText) {\r\n\t\t\t\t\ttipText = this.viewComponent.game.add.text(0, 0, '', {font: '28px 微软雅黑', fill: '#ffffff', boundsAlignH: \"center\", boundsAlignV: \"middle\"}, type0);\r\n                    tipText.anchor.set(0.3,0.5)\r\n\t\t\t\t\ttipText.name = 'tipText';\r\n\t\t\t\t}\r\n\t\t\t\ttipText.visible = progress > 0 ? true : false;\r\n\t\t\t\t//tipText.setTextBounds(width / 2,350,40,22);\r\n\t\t\t\ttipText.setTextBounds(width / 2,flashvars.vertical ? (height / 2 + 20) : 350,40,22);\r\n\t\t\t\ttipText.text = progress + '%';\r\n\t\t\t\ttype0 && (type0.visible = true);\r\n\t\t\t\ttype1 && (type1.visible = false);\r\n\t\t\t\tthis.sceneProxy.progressLayer.bringToTop(type0);\r\n\t\t\t}\r\n\t\t\tthis.sceneProxy.progressLayer.visible = true;\r\n\t\t\tthis.viewComponent.game.world.bringToTop(this.sceneProxy.progressLayer);\r\n            this.sceneProxy.quickPlayLayer.alpha && this.viewComponent.game.world.bringToTop(this.sceneProxy.quickPlayLayer);\r\n\t\t},\r\n\r\n\t\taddDialogLayer: function () {\r\n\t\t\tconst {background, rect, avatarContainer, titleContainer, content} = this.sceneProxy.json_data.template.json.dialog;\r\n\r\n\t\t\tif (this.sceneProxy.dialogLayer.children.length === 0) {\r\n\t\t\t\t//this.sceneProxy.dialogLayer.inputEnableChildren = true;\r\n\r\n\t\t\t\tlet x, y, texture;\r\n\r\n\t\t\t\t// 对话框背景\r\n\t\t\t\tif (this.viewComponent.game.load.cache.checkImageKey(background.url)) {\r\n\t\t\t\t\tconst dialog_bk = this.sceneProxy.dialogLayer.create(0, 0, background.url);\r\n\t\t\t\t\tdialog_bk.width = rect.width;\r\n\t\t\t\t\tdialog_bk.height = rect.height;\r\n\t\t\t\t\tdialog_bk.name = 'dialog_bk';\r\n\t\t\t\t}\r\n\t\t\t\t// 标题背景\r\n\t\t\t\tx = titleContainer.rect.x;\r\n\t\t\t\ty = titleContainer.rect.y;\r\n\t\t\t\tif (this.viewComponent.game.load.cache.checkImageKey(titleContainer.background.url)) {\r\n\t\t\t\t\tconst dialog_bk_title = this.sceneProxy.dialogLayer.create(x, y, titleContainer.background.url);\r\n\t\t\t\t\tdialog_bk_title.width = titleContainer.rect.width;\r\n\t\t\t\t\tdialog_bk_title.height = titleContainer.rect.height;\r\n\t\t\t\t\tdialog_bk_title.name = 'dialog_bk_title';\r\n\t\t\t\t}\r\n\t\t\t\t// 标题文本\r\n\t\t\t\tlet txt;\r\n\t\t\t\tx = titleContainer.rect.x + titleContainer.title.rect.x;\r\n\t\t\t\ty = titleContainer.rect.y + titleContainer.title.rect.y;\r\n                txt = this.viewComponent.game.add.text(0, 0, '', {fill:'#fff'}, this.sceneProxy.dialogLayer);\r\n                txt.name = 'dialog_text_title';\r\n                txt.setTextBounds(x + (titleContainer.title.rect.width - titleContainer.rect.width) / 2, y, titleContainer.rect.width, titleContainer.rect.height);\r\n\t\t\t\t// 头像背景\r\n\t\t\t\tif (this.viewComponent.game.load.cache.checkImageKey(avatarContainer.background.url)) {\r\n\t\t\t\t\tx = avatarContainer.rect.x;\r\n\t\t\t\t\ty = avatarContainer.rect.y;\r\n\t\t\t\t\ttexture = this.sceneProxy.dialogLayer.create(x, y, avatarContainer.background.url);\r\n\t\t\t\t\ttexture.width = avatarContainer.rect.width;\r\n\t\t\t\t\ttexture.height = avatarContainer.rect.height;\r\n\t\t\t\t\ttexture.name = 'dialog_bk_avatar';\r\n\t\t\t\t}\r\n\t\t\t\t// 头像\r\n\t\t\t\tx = avatarContainer.rect.x + avatarContainer.avatar.x;\r\n\t\t\t\ty = avatarContainer.rect.y + avatarContainer.avatar.y;\r\n\t\t\t\tconst avatar = this.sceneProxy.dialogLayer.create(x, y);\r\n\t\t\t\tavatar.name = 'dialog_avatar';\r\n\t\t\t\tavatar.width = avatarContainer.avatar.width;\r\n\t\t\t\tavatar.height = avatarContainer.avatar.height;\r\n\t\t\t\t// 对话文本\r\n\t\t\t\ttxt = this.viewComponent.game.add.text(content.rect.x\r\n\t\t\t\t\t, content.rect.y\r\n\t\t\t\t\t, ''\r\n\t\t\t\t\t, {fill:'#fff', boundsAlignH: \"left\", boundsAlignV: \"top\", wordWrap: true, wordWrapWidth: content.rect.width}\r\n\t\t\t\t\t, this.sceneProxy.dialogLayer);\r\n\t\t\t\ttxt.name = 'dialog_text_content';\r\n\t\t\t\ttxt.useAdvancedWrap = true;\r\n\t\t\t\ttxt.updateText = RePhaser.updateText;\r\n\t\t\t\ttxt.advancedWordWrap = RePhaser.advancedWordWrap;\r\n\t\t\t}\r\n\r\n\t\t\tthis.sceneProxy.dialogLayer.x = rect.x;\r\n\t\t\tthis.sceneProxy.dialogLayer.y = rect.y;\r\n\t\t\tthis.sceneProxy.dialogLayer.alpha = 1;\r\n\t\t\tthis.sceneProxy.dialogLayer.visible = true;\r\n\t\t\tthis.viewComponent.game.world.bringToTop(this.sceneProxy.dialogLayer);\r\n\t\t\tthis.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n            this.sceneProxy.quickPlayLayer.alpha && this.viewComponent.game.world.bringToTop(this.sceneProxy.quickPlayLayer);\r\n\t\t},\r\n\r\n\t\taddMenuLayer: function (bSetFixed) {\r\n\t\t\tif (this.sceneProxy.menuLayer.children.length === 0) {\r\n                const {rect, normal, active} = this.sceneProxy.json_data.template.json.menu;\r\n                const menuBtnClick = (obj, pointer) => {\r\n\t\t\t\t\tif (pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (obj.parent.name === 'menu_button') {\r\n                        this.sceneProxy.onMenuBtnClicked();\r\n\t\t\t\t\t} else if (obj.parent.name === 'shanyi_menu_button'){\r\n\t\t\t\t\t\tthis.sceneProxy.onSyMenuBtnClicked();\r\n\t\t\t\t\t} else if(obj.parent.name === 'menu_button_more'){\r\n                        this.sceneProxy.onMenuBtnMoreClicked();\r\n                    }\r\n\t\t\t\t};\r\n\r\n\t\t\t\tconst t = {};\r\n\t\t\t\tt.normal = normal.text;\r\n\t\t\t\tt.active = active.text;\r\n\t\t\t\tt.text = '菜单';\r\n\t\t\t\tconst menubtn = this.viewComponent.addButton(bSetFixed ? rect.x : 0, bSetFixed ? rect.y : 0, rect.width, rect.height, normal.background.url, active.background.url\r\n\t\t\t\t\t, menuBtnClick, t, this.sceneProxy.btn_sound, \"menu_button\", this.sceneProxy.menuLayer);\r\n\t\t\t\tif(flashvars.single && flashvars.offline === '1'){\r\n                    menubtn.x = flashvars.vertical ? 442 : 866;\r\n                    menubtn.y = 26;\r\n                    if(flashvars.client === 'android'){\r\n                        this.viewComponent.addButton(flashvars.vertical ? 450 : 874, 100, 56, 56, 'menuMore', 'menuMoreHover'\r\n                            , menuBtnClick, t, this.sceneProxy.btn_sound, \"menu_button_more\", this.sceneProxy.menuLayer);\r\n                    }\r\n                }else{\r\n                    if (this.sceneProxy.json_data.template.json.shanyiMenu) {\r\n                        const {rect:rectSy, normal:normalSy, active:activeSy} = this.sceneProxy.json_data.template.json.shanyiMenu;\r\n                        t.normal = normalSy.text;\r\n                        t.active = activeSy.text;\r\n                        t.text = '闪艺';\r\n                        this.viewComponent.addButton(rectSy.x, rectSy.y, rectSy.width, rectSy.height, flashvars.client ==='wap' ? 'wapback' : normalSy.background.url, flashvars.client ==='wap' ? 'wapback' : activeSy.background.url\r\n                            , menuBtnClick, flashvars.client === 'wap' ? '' : t, this.sceneProxy.btn_sound, \"shanyi_menu_button\", this.sceneProxy.menuLayer);\r\n                    }else{\r\n                        if(flashvars.client === 'wap'){\r\n                            this.viewComponent.addButton(flashvars.vertical ? 442 : 886, flashvars.client ? 30 : 26, 68, 68, 'wapback', 'wapback'\r\n                                , menuBtnClick, '', this.sceneProxy.btn_sound, \"shanyi_menu_button\", this.sceneProxy.menuLayer);\r\n                        }\r\n                    }\r\n                }\r\n\t\t\t}\r\n\t\t\tthis.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n\t\t\tthis.sceneProxy.menuLayer.visible = true;\r\n\t\t},\r\n\r\n        doEffectsAnimation: function (group) {\r\n            const doAnimation = (index) => {\r\n                Utils.timeout(40).then(() => {\r\n                \tif (group.children.length === 0) {\r\n                \t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!group.visible) {\r\n                \t\tdoAnimation(index);\r\n                \t\treturn;\r\n\t\t\t\t\t}\r\n                    if (0 === index) {\r\n                        group.children[group.children.length-1].visible = false;\r\n                    }\r\n                    else {\r\n                        group.children[index-1].visible = false;\r\n                    }\r\n                    group.children[index].visible = true;\r\n                    doAnimation(++index % group.children.length);\r\n                });\r\n            };\r\n\r\n            doAnimation(0);\r\n        },\r\n\r\n\t\taddRainEffect: function () {\r\n\t\t\tlet rain = this.sceneProxy.weatherLayer.getByName('rain');\r\n\t\t\tif (!rain) {\r\n\t\t\t\train = this.viewComponent.game.add.group();\r\n\t\t\t\train.name = 'rain';\r\n\t\t\t\tthis.sceneProxy.weatherLayer.add(rain);\r\n\t\t\t\tconst rain1 = [];\r\n\t\t\t\tfor (let i=0; i<50; i++) {\r\n\t\t\t\t\train1[i] = this.viewComponent.game.add.sprite(0, 0, `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"rain\")}/xiayu_${Utils.formatNum(i)}.png`);\r\n                    rain.add(rain1[i]);\r\n                    rain1[i].visible = false;\r\n                }\r\n                this.doEffectsAnimation(rain);\r\n\t\t\t}\r\n\t\t\tthis.sceneProxy.weatherLayer.visible = true;\r\n\t\t\train.visible = true;\r\n\t\t\tthis.sceneProxy.weatherLayer.bringToTop(rain);\r\n\t\t},\r\n\r\n\t\taddSnowEffect: function () {\r\n\t\t\tlet snow = this.sceneProxy.weatherLayer.getByName('snow');\r\n\t\t\tif (!snow) {\r\n\t\t\t\tsnow = this.viewComponent.game.add.group();\r\n\t\t\t\tsnow.name = 'snow';\r\n\t\t\t\tthis.sceneProxy.weatherLayer.add(snow);\r\n\t\t\t\tconst snow1 = [];\r\n\t\t\t\tfor (let i=0; i<120; i++) {\r\n\t\t\t\t\tsnow1[i] = this.viewComponent.game.add.sprite(0, 0, `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"snow\")}/xuehua_${ Utils.formatNum(i)}.png`);\r\n\t\t\t\t\tsnow.add(snow1[i]);\r\n\t\t\t\t\tsnow1[i].visible = false;\r\n\t\t\t\t}\r\n\t\t\t\tthis.doEffectsAnimation(snow);\r\n\t\t\t}\r\n\t\t\tthis.sceneProxy.weatherLayer.visible = true;\r\n\t\t\tsnow.visible = true;\r\n\t\t\tthis.sceneProxy.weatherLayer.bringToTop(snow);\r\n\t\t},\r\n\r\n\t\taddWindEffect: function () {\r\n\t\t\tlet wind = this.sceneProxy.weatherLayer.getByName('wind');\r\n\t\t\tif (!wind) {\r\n\t\t\t\twind = this.viewComponent.game.add.group();\r\n\t\t\t\twind.name = 'wind';\r\n\t\t\t\tthis.sceneProxy.weatherLayer.add(wind);\r\n\t\t\t\tif(flashvars.vertical){\r\n                    const wind1 = [];\r\n                    for (let i=0; i<20; i++) {\r\n                        wind1[i] = this.viewComponent.game.add.sprite(0, 0, `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"wind\")}/feng_${Utils.formatNum(i)}.png`);\r\n                        wind.add(wind1[i]);\r\n                        wind1[i].visible = false;\r\n                    }\r\n                    this.doEffectsAnimation(wind)\r\n                }else{\r\n                    this.viewComponent.game.add.tileSprite(0, 0, 960, 540, 'wind', 1, wind).autoScroll(-360, 0);\r\n                }\r\n\t\t\t}\r\n\t\t\tthis.sceneProxy.weatherLayer.visible = true;\r\n\t\t\twind.visible = true;\r\n\t\t\tthis.sceneProxy.weatherLayer.bringToTop(wind);\r\n\t\t},\r\n\r\n        addFallingLeavesEffect: function () {\r\n            let fLeaves = this.sceneProxy.weatherLayer.getByName('fallingLeaves');\r\n            if (!fLeaves) {\r\n                fLeaves = this.viewComponent.game.add.group();\r\n                fLeaves.name = 'fallingLeaves';\r\n                this.sceneProxy.weatherLayer.add(fLeaves);\r\n                const fLeaves1 = [];\r\n                for (let i=0; i<90; i++) {\r\n                    fLeaves1[i] = this.viewComponent.game.add.sprite(0, 0, `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"mapleLeaves\")}/fengye_${Utils.formatNum(i)}.png`);\r\n                    fLeaves.add(fLeaves1[i]);\r\n                    fLeaves1[i].visible = false;\r\n                }\r\n                this.doEffectsAnimation(fLeaves);\r\n            }\r\n            this.sceneProxy.weatherLayer.visible = true;\r\n            fLeaves.visible = true;\r\n            this.sceneProxy.weatherLayer.bringToTop(fLeaves);\r\n        },\r\n\r\n        addBeachBlossomEffect: function () {\r\n            let beachBlossom = this.sceneProxy.weatherLayer.getByName('beachBlossom');\r\n            if (!beachBlossom) {\r\n                beachBlossom = this.viewComponent.game.add.group();\r\n                beachBlossom.name = 'beachBlossom';\r\n                this.sceneProxy.weatherLayer.add(beachBlossom);\r\n                const beachBlossom1 = [];\r\n                for (let i=0; i<90; i++) {\r\n                    beachBlossom1[i] = this.viewComponent.game.add.sprite(0, 0, `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"beachBlossom\")}/taohua_${Utils.formatNum(i)}.png`);\r\n                    beachBlossom.add(beachBlossom1[i]);\r\n                    beachBlossom1[i].visible = false;\r\n\t\t\t\t}\r\n                this.doEffectsAnimation(beachBlossom);\r\n            }\r\n            this.sceneProxy.weatherLayer.visible = true;\r\n            beachBlossom.visible = true;\r\n            this.sceneProxy.weatherLayer.bringToTop(beachBlossom);\r\n        },\r\n\r\n        addBlossomEffect: function () {\r\n            let blossom = this.sceneProxy.weatherLayer.getByName('blossom');\r\n            if (!blossom) {\r\n                blossom = this.viewComponent.game.add.group();\r\n                blossom.name = 'blossom';\r\n                this.sceneProxy.weatherLayer.add(blossom);\r\n                const blossom1 = [];\r\n                for (let i=0; i<90; i++) {\r\n                    blossom1[i] = this.viewComponent.game.add.sprite(0, 0, `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"blossom\")}/yinghua_${Utils.formatNum(i)}.png`);\r\n                    blossom.add(blossom1[i]);\r\n                    blossom1[i].visible = false;\r\n\t\t\t\t}\r\n\t\t\t\tthis.doEffectsAnimation(blossom);\r\n            }\r\n            this.sceneProxy.weatherLayer.visible = true;\r\n            blossom.visible = true;\r\n            this.sceneProxy.weatherLayer.bringToTop(blossom);\r\n        },\r\n\r\n        addLightningEffect: function () {\r\n            let lightning = this.sceneProxy.weatherLayer.getByName('lightning');\r\n            if (!lightning) {\r\n                lightning = this.viewComponent.game.add.group();\r\n                lightning.name = 'lightning';\r\n                this.sceneProxy.weatherLayer.add(lightning);\r\n                const lightning1 = [];\r\n                for (let i=0; i<50; i++) {\r\n                    lightning1[i] = this.viewComponent.game.add.sprite(0, 0, `/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"lightning\")}/shandian_${Utils.formatNum(i)}.png`);\r\n                    lightning.add(lightning1[i]);\r\n                    lightning1[i].visible = false;\r\n\t\t\t\t}\r\n\t\t\t\tthis.doEffectsAnimation(lightning);\r\n            }\r\n            this.sceneProxy.weatherLayer.visible = true;\r\n            lightning.visible = true;\r\n            this.sceneProxy.weatherLayer.bringToTop(lightning);\r\n        },\r\n\r\n\t\tregisterViewKey: function (refUuid, parentEvents, arrKeys) {\r\n\t\t\tconst {viewMap} = this.sceneProxy.json_data;\r\n\t\t\tconst reg = events => {\r\n                for (let e in events) {\r\n                    if (events[e].type === 'onKeyUp') {\r\n                        this.viewComponent.game.input.keyboard.removeKey(events[e].keyCode);\r\n                        arrKeys[events[e].keyCode] = this.viewComponent.game.input.keyboard.addKey(events[e].keyCode);\r\n                    }\r\n                }\r\n\t\t\t};\r\n\t\t\tconst doReg = (uuid) => {\r\n\t\t\t\treg(viewMap[uuid].events);\r\n\r\n                for (let i in viewMap[uuid].children) {\r\n                    doReg(viewMap[uuid].children[i].ref);\r\n                    reg(viewMap[uuid].children[i].events);\r\n                }\r\n            };\r\n\r\n\t\t\tdoReg(refUuid);\r\n\t\t\treg(parentEvents);\r\n\t\t},\r\n\r\n\t\tremoveViewKey: function (arrKeys) {\r\n\t\t\tfor (let k in arrKeys) {\r\n\t\t\t\tthis.viewComponent.game.input.keyboard.removeKey(k);\r\n\t\t\t\tarrKeys.splice(k, 1);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tremoveViewKeyByInstance: function (view, arrKeys) {\r\n            const {viewMap} = this.sceneProxy.json_data;\r\n            const unReg = events => {\r\n                for (let e in events) {\r\n                    if (events[e].type === 'onKeyUp') {\r\n                        this.viewComponent.game.input.keyboard.removeKey(events[e].keyCode);\r\n                        arrKeys.splice(events[e].keyCode,1);\r\n                    }\r\n                }\r\n            };\r\n            const doUnReg = (v) => {\r\n                v.name && viewMap[v.name] && unReg(viewMap[v.name].events);\r\n\r\n                for (let i in v.children) {\r\n                    doUnReg(v.children[i]);\r\n                }\r\n            };\r\n\r\n            doUnReg(view);\r\n        },\r\n\r\n\t\taddGlobalView: function (refUuidToHide) {\r\n\t\t\tif (!this.sceneProxy.globalViews) {\r\n\t\t\t\tthis.sceneProxy.globalViews = [];\r\n\t\t\t\tthis.sceneProxy.globalViewKeys = [];\r\n\t\t\t\tconst views = this.sceneProxy.json_data.views;\r\n\t\t\t\tfor (let p in views) {\r\n\t\t\t\t\tthis.registerViewKey(views[p].ref, views[p].events, this.sceneProxy.globalViewKeys);\r\n\t\t\t\t\tthis.sceneProxy.globalViews[p] = this.addView(null, views[p].ref, views[p].instanceUuid, views[p].x, views[p].y, views[p].events);\r\n                    this.sceneProxy.globalViews[p].isGlobal = true;\r\n\t\t\t\t\tif (views[p].scale) {\r\n\t\t\t\t\t\tthis.sceneProxy.globalViews[p].scale.set(views[p].scale, views[p].scale);\r\n\t\t\t\t\t\tthis.sceneProxy.globalViews[p].x += views[p].x.value * (1 - views[p].scale);\r\n\t\t\t\t\t\tthis.sceneProxy.globalViews[p].y += views[p].y.value * (1 - views[p].scale);\r\n\t\t\t\t\t\tthis.scaleInputView(this.sceneProxy.globalViews[p], views[p].scale);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n                this.uiOnLoadInvoker();\r\n\t\t\t}\r\n\t\t\tfor (let p in this.sceneProxy.globalViews) {\r\n\t\t\t\tif (refUuidToHide[this.sceneProxy.globalViews[p].name]) {\r\n\t\t\t\t\tthis.sceneProxy.globalViews[p].visible = false;\r\n                    this.showInputView(this.sceneProxy.globalViews[p], false);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.sceneProxy.globalViews[p].visible = true;\r\n                    this.showInputView(this.sceneProxy.globalViews[p], true);\r\n\t\t\t\t\tthis.viewComponent.game.world.bringToTop(this.sceneProxy.globalViews[p]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n            this.closePlayAdButton();\r\n\t\t},\r\n\r\n\t\taddView: function (parentLayer, refUuid, instanceUuid, xInfo, yInfo, eventsInfo, isRefresh = false,isload=false,diymenu=false) {\r\n\t\t\tif (!refUuid) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n            let result = true;\r\n            const viewInfo = this.sceneProxy.json_data.viewMap[refUuid];\r\n            if (!viewInfo) {\r\n                return null;\r\n            }\r\n            const containerLayer = this.viewComponent.game.add.group();\r\n            containerLayer.name = refUuid;\r\n            containerLayer.instanceUuid = instanceUuid;\r\n            containerLayer.xInfo = xInfo;\r\n            containerLayer.yInfo = yInfo;\r\n            containerLayer.eventsInfo = eventsInfo;\r\n            containerLayer.inputEnableChildren = true;\r\n            containerLayer.viewInfoName = viewInfo.name\r\n            parentLayer && parentLayer.add(containerLayer);\r\n\r\n            const {Expression, curChapter, uiOnLoadQueue} = this.sceneProxy;\r\n            let {context} = this.sceneProxy;\r\n            const pointX = Expression.safeEval(xInfo, context);\r\n            const pointY = Expression.safeEval(yInfo, context);\r\n            const clearDiyMenu = ()=>{\r\n                if (diymenu){\r\n                    //diy菜单\r\n                    if(this.sceneProxy.mainMenuLayer.children.length > 0 && this.sceneProxy.json_data.default_settings.mainMenu){\r\n                        this.sceneProxy.mainMenuLayer.removeAll(true);\r\n                    }\r\n                    this.sceneProxy.onResume();\r\n                }\r\n            }\r\n\r\n            const eventHandler = (obj, events, type, nextAction,ispay=false,isstep = false) => {\r\n                let i = 0;\r\n                const handler = (event)=>{\r\n                    return new Promise((resolve,reject) =>{\r\n                        if (event.type === 'jump') {\r\n                            if (!this.sceneProxy.isGettingNext) { // 正在获取下一剧情信息时不响应该事件，以免修改context无法正常下一剧情\r\n                                this.sceneProxy.uiOnLoadQueue = [];\r\n                                this.sceneProxy.mainMenuLayer.visible && this.sceneProxy.onMainMenuBackBtnClicked();\t// 主菜单可见 说明是自制菜单的jump事件\r\n                                this.sceneProxy.context = JSON.parse(JSON.stringify(context));\r\n                                this.showNextPlot(this.sceneProxy.context, this.sceneProxy.curChapter, this.sceneProxy.curPlotIndex, event.type, event.handle.uuid);\r\n                            }\r\n                            return resolve(false); //后续无需再执行\r\n                        }\r\n                        else if (event.type === 'playMusic') {\r\n                            if (this.viewComponent.game.load.cache.checkSoundKey(event.handle.music.url)\r\n                                || ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version)) {\r\n                                this.sceneProxy.stopMusic(event.handle.music.url, true);\r\n                                this.sceneProxy.playMusic(event.handle.music.url, event.handle.music.volume, true, true);\r\n                            }\r\n                            return resolve(true);\r\n                        }\r\n                        else if (event.type === 'stopMusic') {\r\n                            this.sceneProxy.stopMusic(null, true);\r\n                            return resolve(true);\r\n                        }\r\n                        else if (event.type === 'playSound') {\r\n                            for (let s=0; s<event.handle.sounds.length; s++) {\r\n                                if(event.handle.sounds[s]) {\r\n                                    let url = event.handle.sounds[s] ? event.handle.sounds[s].url : '';\r\n                                    if (url === 'inherit') {\r\n                                        continue;\r\n                                    }\r\n                                    else if (this.viewComponent.game.load.cache.checkSoundKey(url)) {\r\n                                        let volume = event.handle.sounds[s].volume === 'inherit' ? this.sceneProxy.plotSounds[s].volume : event.handle.sounds[s].volume;\r\n                                        this.sceneProxy.stopSound(s, url, true);\r\n                                        this.sceneProxy.playSound(s, url, volume, !event.handle.sounds[s].time, true);\r\n                                    }\r\n                                    else if ('ios' === flashvars.client && flashvars.app_version >= '1.5.0') {\r\n                                        let volume = event.handle.sounds[s].volume === 'inherit' ? PhoneUtils.soundsInfo[s].volume : event.handle.sounds[s].volume;\r\n                                        this.sceneProxy.stopSound(s, url, true);\r\n                                        this.sceneProxy.playSound(s, url, volume, !event.handle.sounds[s].time, true);\r\n                                    }\r\n                                    else {\r\n                                        this.sceneProxy.stopSound(s);\r\n                                    }\r\n                                }\r\n                            }\r\n                            return resolve(true);\r\n                        }\r\n                        else if (event.type === 'stopSound') {\r\n                            this.sceneProxy.stopSound(-1,null,true)\r\n                            return resolve(true);\r\n                        }\r\n                        else if (event.type === 'callUI') {\r\n                            if (event.handle.id === 'save-record' && event.handle.type === 'system') {\r\n                                const disableSaveOrLoad = this.sceneProxy.context.disableSaveOrLoad;\r\n                                if (disableSaveOrLoad && disableSaveOrLoad.save) {\r\n                                    this.sceneProxy.showToast(1, '抱歉，作者在此设置了禁用存档');\r\n                                    return resolve(false);\r\n                                }\r\n                                !this.sceneProxy.mainMenuLayer.visible && this.sceneProxy.getSnap();\r\n                                this.sceneProxy.showSave();\r\n                                return resolve(false);\r\n                            }\r\n                            else if (event.handle.id === 'load-record' && event.handle.type === 'system') {\r\n                                const disableSaveOrLoad = this.sceneProxy.context.disableSaveOrLoad;\r\n                                if (disableSaveOrLoad && disableSaveOrLoad.load) {\r\n                                    this.sceneProxy.showToast(1, '抱歉，作者在此设置了禁用读档');\r\n                                    return resolve(false);\r\n                                }\r\n                                this.sceneProxy.showLoad();\r\n                                return resolve(false);\r\n                            }\r\n                            else if (event.handle.id === 'playback' && event.handle.type === 'system') {\r\n                                this.sceneProxy.showPlayback();\r\n                                return resolve(false);\r\n                            }\r\n                            else if (event.handle.id === 'settings' && event.handle.type === 'system') {\r\n                                this.sceneProxy.showSettings(this.sceneProxy.context);\r\n                                return resolve(false);\r\n                            }\r\n                            else if (event.handle.uuid){\r\n                                const xInfo = Object.assign({}, event.handle.position.x);\r\n                                const yInfo = Object.assign({}, event.handle.position.y);\r\n                                const nCount = event.handle.count ? Expression.safeEval(event.handle.count, this.sceneProxy.context) : 1;\r\n                                for (let n=0; n<nCount; n++) {\r\n                                    this.registerViewKey(event.handle.uuid, [], this.sceneProxy.plotViewKeys);\r\n                                    const view = this.addView(parentLayer, event.handle.uuid, '', xInfo, yInfo,{},false,false,diymenu);\r\n                                    if (!view) {\r\n                                        continue;\r\n                                    }\r\n                                    if (!parentLayer) {\r\n                                        view.isGlobal = true;\r\n                                        this.sceneProxy.globalViews.push(view);\r\n                                    }\r\n                                    else if (parentLayer.name === 'plotViewsLayer') {\r\n                                        this.sceneProxy.plotViews.push(view);\r\n                                    }\r\n                                    else if (parentLayer.xInfo && parentLayer.yInfo) {\r\n                                        view.x += Expression.safeEval(parentLayer.xInfo, this.sceneProxy.context);\r\n                                        view.y += Expression.safeEval(parentLayer.yInfo, this.sceneProxy.context);\r\n                                    }\r\n\r\n                                    if ((!parentLayer || !parentLayer.parent || parentLayer.parent.name !== 'mainMenuLayer') && !this.sceneProxy.mainMenuLayer.visible) {\r\n                                        this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n                                    }\r\n\r\n                                    // 非onLoad事件触发的 则执行onLoad\r\n                                    if('onLoad' !== type)this.uiOnLoadInvoker();\r\n                                }\r\n                                this.closePlayAdButton();\r\n                                return resolve(true)\r\n                            }\r\n                        }\r\n                        else if (event.type === 'refreshUI') {\r\n                            let refreshViews = this.refreshView(event.handle.uuid);\r\n                            return resolve(true)\r\n                        }\r\n                        else if (event.type === 'reload') {\r\n                            let refreshViews = this.refreshView(event.handle.uuid, true);\r\n                            if (event.handle.uuid === parentLayer.name) {\r\n                                for (let n=0; n<refreshViews.length; n++) {\r\n                                    if (refreshViews[n].name === parentLayer.name) {\r\n                                        parentLayer = refreshViews[n];\r\n                                        break;\r\n                                    }\r\n                                }\r\n                            }\r\n                            // 重载组件需要重新调用onLoad事件\r\n                            this.uiOnLoadInvoker().then(()=>{\r\n                                return resolve(true)\r\n                            });\r\n                        }\r\n                        else if (event.type === 'closeUI') {\r\n                            let uuidToClose = event.handle.uuid;\r\n                            let objParent = obj;\r\n                            let bCloseMainMenu = false;\r\n                            const getCloseUuid = (bSingleToClose) => {\r\n                                objParent = objParent && objParent.parent;\r\n                                while (1) {\r\n                                    if (!objParent) {\r\n                                        break;\r\n                                    } else if (objParent.viewType) {\r\n                                        if (bSingleToClose) {\r\n                                            objParent.name += '_1';\r\n                                        }\r\n                                        return objParent.name;\r\n                                    }\r\n                                    objParent = objParent.parent;\r\n                                }\r\n                            };\r\n                            if (event.handle.type === 'system' && event.handle.id === 'diyMainMenu') {\r\n                                if(this.sceneProxy.json_data.default_settings.mainMenu){\r\n                                    let diyMainMenu = this.sceneProxy.mainMenuLayer.children[1];\r\n                                    if (diyMainMenu) {\r\n                                        uuidToClose = diyMainMenu.name;\r\n                                        bCloseMainMenu = true;\r\n                                    }\r\n                                    else {\r\n                                        uuidToClose = null;\r\n                                        this.sceneProxy.onMainMenuBackBtnClicked();\r\n                                        this.sceneProxy.mainMenuLayer.removeAll(true, false, true);\r\n                                    }\r\n                                }/*else{\r\n                                        //没有diy菜单\r\n                                        return\r\n                                    }*/\r\n                            } else {\r\n                                if (!uuidToClose) {\r\n                                    if (obj.viewType) {\r\n                                        uuidToClose = obj.name;\r\n                                    } else {\r\n                                        uuidToClose = getCloseUuid(objParent, true);\r\n                                        event.isParent && (uuidToClose = getCloseUuid(objParent, true));\r\n                                    }\r\n                                }\r\n                            }\r\n                            if (uuidToClose) {\r\n                                // 关闭组件后 对应的onLoad事件不再执行\r\n                                const closeSelf = uuidToClose.indexOf('_1') > -1\r\n                                let realUuid = uuidToClose.substring(0, 36);\r\n                                if(!closeSelf){\r\n                                    for (let n=0; n<uiOnLoadQueue.length; n++) {\r\n                                        if (uiOnLoadQueue[n].name === realUuid || uiOnLoadQueue[n].instanceUuid === realUuid) {\r\n                                            uiOnLoadQueue.splice(n--, 1);\r\n                                        }\r\n                                    }\r\n                                }\r\n                                // closeUI\r\n                                this.destroyView(uuidToClose, bCloseMainMenu);\r\n                            }\r\n                            return resolve(true)\r\n                        }\r\n                        else if (event.type === 'back') {\t// 返回封面\r\n                            clearDiyMenu();\r\n                            this.sceneProxy.uiOnLoadQueue = [];\r\n                            this.sceneProxy.mainMenuLayer.visible && this.sceneProxy.onResume();\r\n                            this.sceneProxy.context = JSON.parse(JSON.stringify(context));\r\n                            this.showNextPlot(this.sceneProxy.context, curChapter, this.sceneProxy.curPlotIndex, event.type);\r\n                            return resolve(false);\r\n                        }\r\n                        else if (event.type === 'nextPlot') { // 下个剧情\r\n                            clearDiyMenu();\r\n                            this.sceneProxy.uiOnLoadQueue = [];\r\n                            if (curChapter.plots[this.sceneProxy.curPlotIndex].commands) {\r\n                                this.sceneProxy.optionLayer.destroy();\r\n                                this.sceneProxy.cmdPlotNextPromise && this.sceneProxy.cmdPlotNextPromise({type: ''});\r\n                                return resolve(false);\r\n                            }\r\n                            this.sceneProxy.context = JSON.parse(JSON.stringify(context));\r\n                            if (curChapter.plots[this.sceneProxy.curPlotIndex].condition_options.length > 0) {\r\n                                this.showNextPlot(this.sceneProxy.context, curChapter, this.sceneProxy.curPlotIndex);\r\n                                return resolve(false);;\r\n                            }\r\n                            this.showNextPlot(this.sceneProxy.context, curChapter, this.sceneProxy.curPlotIndex, event.type);\r\n                            return resolve(false);\r\n                        }\r\n                        else if (event.type === 'jumpOption') { // 跳出分支\r\n                            clearDiyMenu();\r\n                            this.sceneProxy.uiOnLoadQueue = [];\r\n                            const n = Expression.safeEval(event.handle.value, context);\r\n                            if (curChapter.plots[this.sceneProxy.curPlotIndex].commands) {\r\n                                const {info, index} = this.sceneProxy.getNextCommand(context, this.sceneProxy.curCmdInfo, -1, {eArg: n, type: 'jumpOption'});\r\n                                if (index !== -1) {\r\n                                    this.sceneProxy.cmdPlayHandlerFun(info, index);\r\n                                }\r\n                                return resolve(false);;\r\n                            }\r\n\r\n                            this.showNextPlot(this.sceneProxy.context, curChapter, this.sceneProxy.curPlotIndex, event.type, n);\r\n                            return resolve(false);\r\n                        }\r\n                        else if (event.type === 'backOption') {\r\n                            clearDiyMenu();\r\n                            this.sceneProxy.uiOnLoadQueue = [];\r\n                            const n = Expression.safeEval(event.handle.value, context);\r\n                            if (curChapter.plots[this.sceneProxy.curPlotIndex].commands) {\r\n                                const {info, index} = this.sceneProxy.getNextCommand(context, this.sceneProxy.curCmdInfo, -1, {eArg: n, type: 'backOption'});\r\n                                if (index !== -1) {\r\n                                    this.sceneProxy.cmdPlayHandlerFun(info, index);\r\n                                }\r\n                                return resolve(false);\r\n                            }\r\n\r\n                            this.showNextPlot(this.sceneProxy.context, curChapter, this.sceneProxy.curPlotIndex, event.type, n);\r\n                            return resolve(false);\r\n                        }\r\n                        else if (event.type === 'insertPlot') { // 插播剧情\r\n                            clearDiyMenu();\r\n                            this.sceneProxy.uiOnLoadQueue = [];\r\n                            // 先结束当前剧情\r\n                            let pointer = new Phaser.Pointer(this.viewComponent.game, 1, Phaser.PointerMode.CURSOR);\r\n                            pointer.button = 0;\r\n                            this.sceneProxy.curPlotLayer.onChildInputDown.dispatch('insertPlot', pointer);\r\n                            this.sceneProxy.removeViewTimer(this.sceneProxy.plotViewsLayer);\r\n                            this.sceneProxy.removeInputView(this.sceneProxy.plotViewsLayer);\r\n                            this.sceneProxy.plotViewsLayer.removeAll(true);\r\n                            this.sceneProxy.plotViews.splice(0, this.sceneProxy.plotViews.length);\r\n                            this.removeViewKey(this.sceneProxy.plotViewKeys);\r\n                            // 插播\r\n                            this.showNextPlot(this.sceneProxy.context, this.sceneProxy.curChapter, this.sceneProxy.curPlotIndex, event.type, event.handle.uuid,true);\r\n                            return resolve(false);\r\n                        }\r\n                        else if (event.type === 'setValue') { // 数值设置\r\n                            nextAction && (nextAction.paused = true);//暂停后续\r\n                            this.sceneProxy.updatePayValue(context,event.handle.values,isstep,this.sceneProxy.setValueAfterPay).then((rs)=>{\r\n                                if(rs === true){\r\n                                    //同步成功，执行value操作\r\n                                    this.sceneProxy.valueOperation(context, event.handle.values,false,(c)=>{\r\n                                        return resolve(true)\r\n                                    },this.sceneProxy.setValueAfterPay);\r\n                                }else{\r\n                                    //同步不成功，不执行value操作\r\n                                    return resolve(true)\r\n                                }\r\n                            })\r\n\r\n                        }\r\n                        else if (event.type === 'pay') {\t// 扣费事件\r\n                            if(this.sceneProxy.isPaying !== false){return resolve(false)}; //正在购买中，无需后面操作\r\n                            this.sceneProxy.isPaying = true; //点击后 处于购买状态\r\n                            if(flashvars.single && flashvars.offline === '1'){\r\n                                //离线 独立播放器  直接购买\r\n                                const price = Expression.safeEval(events[i].handle.price, context);\r\n                                if(context.systemValues[0].value >= price){\r\n                                    //支付\r\n                                    this.sceneProxy.playAdPayStatus = 1;\r\n                                    context.systemValues[0].value = context.systemValues[0].value - price;\r\n                                    this.sceneProxy.saveAccountInfo();\r\n                                    this.sceneProxy.isPaying = false;\r\n                                    return resolve(true);\r\n                                }else{\r\n                                    this.sceneProxy.context.fullScreen && this.sceneProxy.onSettingsWindowModeBtnClicked();\r\n                                    const showTip = (show)=>{\r\n                                        return new Promise((resolve,reject) =>{\r\n                                            const adback = (backtype)=>{\r\n                                                this.sceneProxy.playAdPayStatus = -1;\r\n                                                this.sceneProxy.playAdCallBack = null;\r\n                                                if(backtype === '1' || backtype === 1){context.systemValues[0].value +=1};//成功 金币+1\r\n                                                this.sceneProxy.saveAccountInfo();\r\n                                                if(flashvars.wap === '4399'){\r\n                                                    this.closePlayAdButton();\r\n                                                }\r\n                                                this.sceneProxy.isPaying = false;\r\n                                                return resolve(false);\r\n                                            };\r\n                                            if(show === true){\r\n                                                Utils.timeout(200).then(()=>{\r\n                                                    Dialog.custom(\"Info\",\"当前闪币余额不足，观看广告可获得更多闪币哟！\",\"提示\",\"立即获得\",\"取消\",false).then(()=>{\r\n                                                        //播放广告\r\n                                                        if(window.app && window.app.playAdVideo && flashvars.client === 'android'){ //android apk\r\n                                                            this.sceneProxy.playAdCallBack = adback;\r\n                                                            nextAction && (nextAction.paused = true);//暂停后续\r\n                                                            window.app.playAdVideo();//android apk 播放广告\r\n                                                        }\r\n                                                    },()=>{\r\n                                                        this.sceneProxy.isPaying = false;\r\n                                                        return resolve(false);\r\n                                                    });\r\n                                                })\r\n                                            }else{\r\n                                                if(flashvars.wap === '4399'){\r\n                                                    H54399Api.playAd().then((rs)=>{\r\n                                                        //{success:false,msg:obj.message}\r\n                                                        if(rs.success === true){\r\n                                                            adback(1)\r\n                                                        }else{\r\n                                                            Dialog.info('广告次数已用完，请明日再来！');\r\n                                                            adback(0);\r\n                                                        }\r\n                                                    })\r\n                                                }\r\n                                            }\r\n                                        })\r\n                                    }\r\n                                    if(flashvars.wap === '4399'){\r\n                                        H54399Api.canPlayAd().then(rs =>{\r\n                                            if(rs.canplay === true){\r\n                                                Dialog.custom(\"Info\",\"当前闪币余额不足，观看广告可获得闪币哦！\",\"提示\",\"看广告\",\"取消\",false).then(\r\n                                                    ()=>{ showTip(false).then(rs =>{\r\n                                                        return resolve(rs)\r\n                                                    })},\r\n                                                    ()=>{this.sceneProxy.isPaying = false; return resolve(false);})\r\n                                            }else{\r\n                                                Dialog.custom(\"Info\",\"当前闪币余额不足！\",\"提示\",\"知道了\",\"取消\",false,0,0,false).then(\r\n                                                    ()=>{this.sceneProxy.isPaying = false; return resolve(false);},\r\n                                                    ()=>{this.sceneProxy.isPaying = false; return resolve(false);})\r\n                                            }\r\n                                        })\r\n                                    }else{\r\n                                        showTip(true).then(rs =>{\r\n                                            return resolve(rs)\r\n                                        });\r\n                                    }\r\n                                }\r\n                            }else{\r\n                                if(flashvars.wap === 'zxwwap'){ //4399在线玩  暂无商城付费功能\r\n                                    Dialog.info('商城功能尚未开启，是否前往闪艺抢先体验？').then(()=>{\r\n                                        window.location.href = 'https://wap.3000.com/?m=detail&op=index&ac=index&id='+ flashvars.gid;\r\n                                    })\r\n                                    this.sceneProxy.isPaying = false;\r\n                                    return resolve(false);\r\n                                }\r\n                                //开始同步最新的消费数值\r\n                                this.sceneProxy.getPayInfo(true).then((rs)=>{\r\n                                    if (Object.prototype.toString.apply(rs) !== '[object String]' && flashvars.uid !== ''){\r\n                                        //同步成功\r\n                                        this.sceneProxy.isLineUpdatePaySuccess = true;\r\n                                        context.payValues = JSON.parse(JSON.stringify(this.sceneProxy.context.payValues));\r\n                                    }else{\r\n                                        //同步失败，无需再操作\r\n                                        if((rs.indexOf('您还没有登录') !== -1  && flashvars.uid === '' ) || rs.indexOf('获取用户信息失败') !== -1){\r\n                                            //没有登入\r\n                                            if(flashvars.client === 'wap'){\r\n                                                window.parent && window.parent.playLogin();\r\n                                            }else{\r\n                                                let n0 = rs.indexOf('\\(') !== -1 ? rs.indexOf('\\(') + 1 : 0;\r\n                                                let n1 = rs.indexOf('\\:') !== -1 ? rs.indexOf('\\:') : rs.length;\r\n                                                Dialog.error(rs.substr(n0,Math.floor(n1 - n0))).then(()=>{\r\n                                                    if(rs.indexOf('您还没有登录') !== -1){window.location.href = 'lzj3000://login'};\r\n                                                })\r\n                                            }\r\n                                        }else{\r\n                                            Dialog.info('当前网络信号差，商城、成就等账号功能无法正常使用，请检查网络设置后，重新打开作品')\r\n                                        }\r\n                                        this.sceneProxy.isLineUpdatePaySuccess = false;\r\n                                        this.sceneProxy.isPaying = false;\r\n                                        return resolve(false);\r\n                                    }\r\n                                    //付费相关操作\r\n                                    const price = Expression.safeEval(event.handle.price, context);\r\n                                    const id = events[i].handle.uuid;\r\n                                    let count = events[i].handle.count || -1;\r\n                                    const generateuuid = Utils.generateUUID();\r\n                                    const indentId = flashvars.client + generateuuid;\r\n                                    let disCounts = -1; // 优惠价格\r\n                                    const ispay = (goodsid)=>{  //计算商品的购买次数， 是否可以购买\r\n                                        if(flashvars.client !== \"ios\" && flashvars.client !== \"android\" && flashvars.client !== 'wap'){\r\n                                            //pc端时 无需请求商品购买次数\r\n                                            return Promise.resolve();\r\n                                        }\r\n                                        return this.sceneProxy.getPayGoodsInfo(goodsid).then((rs)=>{\r\n                                            if(rs && rs.status){\r\n                                                if(rs.status === \"success\"){\r\n                                                    if(count === -1 || (count === 1 && rs.count < 1)){ //购买次数为无限购买  和  购买次数只能购买一次，服务器返回次数小于1\r\n                                                        return Promise.resolve()\r\n                                                    }\r\n                                                    return Promise.reject()\r\n                                                }else{\r\n                                                    Dialog.error('网络不稳定，请重试~');\r\n                                                    return Promise.resolve(\"retry\")\r\n                                                }\r\n                                            }\r\n\r\n                                        },(rj)=>{\r\n                                            //服务器返回错误信息\r\n                                            return Promise.resolve(\"error\");\r\n                                        })\r\n                                    };\r\n                                    ispay(id).then((rs)=>{\r\n                                        if(rs === \"retry\" || rs ===\"error\"){\r\n                                            this.sceneProxy.isPaying = false;//重试中\r\n                                            return resolve(false);\r\n                                        }\r\n                                        let paycontext = JSON.parse(JSON.stringify(context))\r\n                                        //可以购买\r\n                                        const preOperation = () => {\r\n                                            //计算预消费数值\r\n                                            let k = parseInt(i)+1;\r\n                                            const getprevalues = (ev)=>{\r\n                                                return new Promise((resolve,reject)=>{\r\n                                                    if(ev.type === 'setValue'){\r\n                                                        this.sceneProxy.valueOperation(paycontext, ev.handle.values, true,(c)=>{\r\n                                                            paycontext = JSON.parse(JSON.stringify(c));\r\n                                                            return resolve();\r\n                                                        });\r\n                                                    }else{\r\n                                                        return resolve();\r\n                                                    }\r\n                                                })\r\n\r\n                                            }\r\n                                            const handlegetvalue = ()=>{\r\n                                                if(k >= events.length){\r\n                                                    //无事件\r\n                                                    return Promise.resolve();\r\n                                                }\r\n                                                return getprevalues(events[k]).then(()=>{\r\n                                                    k++;\r\n                                                    return handlegetvalue();\r\n                                                })\r\n                                            };\r\n                                            return handlegetvalue();\r\n                                        };\r\n                                        //购买后 的数值恢复\r\n                                        const afterOperation = () => {\r\n                                            return Promise.resolve();//afterOperation complete\r\n                                        };\r\n                                        //继续事件\r\n                                        const goNextEvents = (type) => {\r\n                                            const charge = disCounts === -1 ? price : disCounts;\r\n                                            if (2 === type || type === '2') {    // 星星支付\r\n                                                this.sceneProxy.context.systemValues[1].value -= charge * 100;\r\n                                            } else {\r\n                                                this.sceneProxy.context.systemValues[0].value -= charge;\r\n                                            }\r\n                                            this.sceneProxy.getAccountInfo(); // 同步闪币余额\r\n                                            this.sceneProxy.isPaying = false;\r\n                                            return resolve(true)\r\n                                        };\r\n                                        //购买后回调\r\n                                        const operationCallback = (result) => {\r\n                                            this.sceneProxy.mallPayCallback = null;\r\n                                            this.sceneProxy.isPaying = false;//购买完成\r\n                                            afterOperation().then(()=>{\r\n                                                this.sceneProxy.checkIfMallPaySuccess(indentId);\r\n                                                if (result !== 0 && result !== '0') {   // resule:0 失败  1:闪币支付  2:星星支付\r\n                                                    this.sceneProxy.setValueAfterPay = true;\r\n                                                    this.sceneProxy.isPaySuccess = true;\r\n                                                    goNextEvents(result);\r\n                                                } else {\r\n                                                    //失败，同步消费数值  直到成功\r\n                                                    this.sceneProxy.isPaySuccess = false;\r\n                                                    const loadPayValues = (time) => {\r\n                                                        return Utils.timeout(time).then(() => {\r\n                                                            return this.sceneProxy.getPayInfo().then(rs => {\r\n                                                                if (Object.prototype.toString.call(rs) !== \"[object String]\") {\r\n                                                                    return Promise.resolve();\r\n                                                                }else{\r\n                                                                    return loadPayValues(1000);\r\n                                                                }//同步成功\r\n                                                            });\r\n                                                        });\r\n                                                    };\r\n                                                    loadPayValues(100).then(()=>{\r\n                                                        return resolve(false)\r\n                                                    });\r\n                                                }\r\n                                            });\r\n\r\n                                        };\r\n                                        if(this.sceneProxy.isWapOther()){\r\n                                            //第三方支付时，直接跳到支付平台\r\n                                            Utils.timeout(100).then(()=>{\r\n                                                Dialog.custom(\"Info\",\"支付过程将导致作品重启。请确保您已存档。选择已存档将继续支付，未存档将前往存档界面\",\"作品存档提示\",\"已存档\",\"未存档\",true).then((msg)=>{\r\n                                                    preOperation().then(()=>{\r\n                                                        OtherWap.pay(price,id,generateuuid,this.sceneProxy.curChapter.uuid,paycontext,1,()=>{\r\n                                                            operationCallback()\r\n                                                        });\r\n                                                    });\r\n                                                },(msg1)=>{\r\n                                                    if(msg1 === \"cancel\"){this.sceneProxy.showSave();}\r\n                                                    return resolve(false);\r\n                                                })\r\n                                            })\r\n                                        }else{\r\n                                            preOperation().then(()=>{\r\n                                                this.sceneProxy.payOperation(price, id, indentId, operationCallback,paycontext).then(dc => disCounts = dc);\r\n                                            });\r\n                                        }\r\n                                    },(rj)=>{\r\n                                        Dialog.info(\"该商品只可购买一次！\")\r\n                                        this.sceneProxy.isPaying = false;\r\n                                        return resolve(false);\r\n                                    })\r\n                                })\r\n                            }\r\n                        }\r\n                        else if(event.type === 'playad'){\r\n                            if(flashvars.single && flashvars.offline === '1'){\r\n                                //播放广告\r\n                                const adback = (backtype)=>{\r\n                                    this.sceneProxy.playAdCallBack = null;\r\n                                    if(backtype === '1' || backtype === 1){context.systemValues[0].value +=1};//成功 金币+1\r\n                                    this.sceneProxy.saveAccountInfo();\r\n                                    if(flashvars.wap === '4399'){\r\n                                        this.closePlayAdButton();\r\n                                    }\r\n                                    return resolve(true);\r\n                                };\r\n                                if(window.app && window.app.playAdVideo && flashvars.client === 'android'){ //android apk\r\n                                    this.sceneProxy.playAdCallBack = adback;\r\n                                    nextAction && (nextAction.paused = true);//暂停后续\r\n                                    window.app.playAdVideo();//android apk 播放广告\r\n                                }else if(flashvars.wap === '4399'){\r\n                                    H54399Api.playAd().then((rs)=>{\r\n                                        //{success:false,msg:obj.message}\r\n                                        if(rs.success === true){\r\n                                            adback(1)\r\n                                        }else{\r\n                                            Dialog.info('广告播放失败！' + rs.msg);\r\n                                            adback(0);\r\n                                        }\r\n                                    })\r\n                                }\r\n                            }else{\r\n                                return resolve(true)\r\n                            }\r\n                        }\r\n                    })\r\n                }\r\n                const gohandler = ()=>{\r\n                    if(i >= events.length){\r\n                        return Promise.resolve(true)\r\n                    }else{\r\n                        return handler(events[i]).then((rs) =>{\r\n                            if(rs === true){\r\n                                //继续执行\r\n                                i++;\r\n                                return gohandler();\r\n                            }else{\r\n                                return Promise.resolve(false)\r\n                            }\r\n                        })\r\n                    }\r\n                }\r\n                return gohandler().then((rs)=>{return Promise.resolve(rs)})\r\n            };\r\n            const keyUpCallback = (obj, event) => {\r\n                if (Expression.safeEval(event.expression, context)) {\r\n                    eventHandler(obj, event.events, 'onKeyUp');\r\n                }\r\n            };\r\n            const eventCallback = (obj, type,callfun) => {\r\n                this.sceneProxy.setValueAfterPay = false;\r\n                if(obj.parent && obj.parent.isGlobal){\r\n                    //全局\r\n                    context = this.sceneProxy.context;\r\n                }\r\n                let invokeEventInfo = [];\r\n                let events;\r\n                events = viewInfo.events;\r\n                //添加播放 广告事件  （g6Hsa9WoK8）\r\n                if(obj.viewInfoName && obj.viewInfoName === 'g6Hsa9WoK8'){\r\n                    //播放广告\r\n                    if((events.length > 0 && events[0].name !== 'g6Hsa9WoK8') || events.length === 0){\r\n                        events.unshift({events:[{type: \"playad\", handle: {uuid: \"g6Hsa9WoK8\"}}],expression:{type:'playad',value:'ad'},name:'g6Hsa9WoK8',type:'onClick'});\r\n                    }\r\n                }\r\n                if (eventsInfo) {\r\n                    const parentEvents = Object.assign([], eventsInfo);\r\n                    parentEvents.forEach(es => es.events.forEach(e => e.isParent = true));\r\n                    events = parentEvents.concat(events);\r\n                }\r\n                for (let i in events) {\r\n                    if (events[i].type === type && events[i].type != 'onKeyUp') {\r\n                        invokeEventInfo[invokeEventInfo.length] = events[i];\r\n                    }\r\n                    else if (events[i].type === type && events[i].type === 'onKeyUp') {\r\n                        let code = events[i].keyCode;\r\n                        let key = this.sceneProxy.plotViewKeys && this.sceneProxy.plotViewKeys[code] ? this.sceneProxy.plotViewKeys[code]\r\n                            : this.sceneProxy.globalViewKeys && this.sceneProxy.globalViewKeys[code] ? this.sceneProxy.globalViewKeys[code] : undefined;\r\n                        if (key) {\r\n                            key.onUp.add(() => keyUpCallback(obj, events[i]));\r\n                        }\r\n                    }\r\n                }\r\n\r\n                let result = true;\r\n                const invokeHandler = events => {\r\n                    let v = 0;\r\n                    const handler = ()=>{\r\n                        this.sceneProxy.playAdPayStatus = 0;\r\n                        if(v >= events.length) return Promise.resolve(false);//无需再执行\r\n                        if (events[v].expression.type === 'playad' || (events[v].expression.type !== 'playad'&& Expression.safeEval(events[v].expression, context))) { //满足条件\r\n                            return eventHandler(obj, events[v].events, type, null,false,type === 'onStep').then((rs) =>{\r\n                                if(rs === true){\r\n                                    v ++;\r\n                                    return handler();\r\n                                }else{\r\n                                    if(this.sceneProxy.playAdPayStatus === -1 && flashvars.single === true && flashvars.offline === '1' && events.length > 1){\r\n                                        this.sceneProxy.playAdPayStatus = 0;\r\n                                        eventHandler(obj,events[events.length -1].events,type, null,false,false)\r\n                                    }\r\n                                    result = false;\r\n                                    return Promise.resolve(false);\r\n                                }\r\n                            })\r\n                        }else{\r\n                            v ++;\r\n                            return handler();\r\n                        }\r\n                    }\r\n                    return handler()\r\n                };\r\n                return invokeHandler(invokeEventInfo).then(()=>{\r\n                    callfun && callfun();\r\n                    return Promise.resolve();\r\n                    //return result;\r\n                })\r\n            };\r\n            const onViewClicked = (obj, pointer) => {\r\n                if (obj.isHanding || this.sceneProxy.isPaying) {\r\n                    return;\r\n                }\r\n                if (pointer && pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n                    return;\r\n                }\r\n                this.sceneProxy.isInputFocus = false;\r\n                if(obj.name === 'input') {\r\n                    this.sceneProxy.isInputFocus = true;\r\n                    this.removeKeyBoardZ();\r\n                }\r\n                //自动播放时  按钮点击无效\r\n                const hasView = this.sceneProxy.plotViewsLayer.children.length > 0;\r\n                const hasOption = this.sceneProxy.optionLayer.children.length > 0;\r\n                if(((obj.viewInfoName && (obj.viewInfoName === 'getD30A87' || obj.viewInfoName === 'g3Hsa5WoK7'))\r\n                    || (obj.parent && (obj.parent.viewInfoName === 'getD30A87' || obj.parent.viewInfoName === 'g3Hsa5WoK7')))\r\n                    &&(this.sceneProxy.quickPlay || context.auto) && !hasView && !hasOption && !this.sceneProxy.playPause){ // 获取闪币  商城  更多\r\n                    this.sceneProxy.showToast(0, '请先设置关闭自动播放，再使用此功能哦！')\r\n                    return;\r\n                }\r\n                obj.isHanding = true;\r\n                Utils.timeout(200).then(()=>{\r\n                    eventCallback(obj, 'onClick',()=>{obj.isHanding = false;});//eventcallback增加回调函数\r\n                })\r\n\r\n            };\r\n            const addItemClickedCallback = (obj) => {\r\n                obj.events.onInputDown.add(onViewClicked, this, 0, obj);\r\n            };\r\n            const onLoadCallback = (obj) => {\r\n                if (!isRefresh) {\r\n                    return eventCallback(obj, 'onLoad');\r\n                }\r\n                return Promise.resolve();\r\n            };\r\n            const onKeyUpCallback = (obj) => {\r\n                eventCallback(obj, 'onKeyUp');\r\n            };\r\n\r\n            if ('button' === viewInfo.type) {\r\n                let sound = null;\r\n                if (viewInfo.content.sound && viewInfo.content.sound.url) {\r\n                    sound = this.viewComponent.game.add.sound(viewInfo.content.sound.url, viewInfo.content.sound.volume, false);\r\n                }\r\n                const btn = this.viewComponent.addButton(pointX,\r\n                    pointY,\r\n                    viewInfo.width,\r\n                    viewInfo.height,\r\n                    viewInfo.content.background.normal.url,\r\n                    viewInfo.content.background.active.url,\r\n                    (btn, pointer) => onViewClicked(btn.parent, pointer),\r\n                    null,\r\n                    sound,\r\n                    null,\r\n                    containerLayer\r\n                );\r\n                onKeyUpCallback(btn.parent);\r\n                containerLayer.viewType = 'BUTTON';\r\n                //result = onLoadCallback(btn.parent);\r\n                containerLayer.onLoadBack = {name: refUuid, instanceUuid: instanceUuid, object: btn.parent, callBack: onLoadCallback};//记录载入事件\r\n                !isload && this.sceneProxy.uiOnLoadQueue.push({name: refUuid, instanceUuid: instanceUuid, object: btn.parent, callBack: onLoadCallback});\r\n            }\r\n            else if ('image' === viewInfo.type) {\r\n                let img = this.viewComponent.game.add.image(pointX, pointY, viewInfo.content.background.url);\r\n                img.width = viewInfo.width;\r\n                img.height = viewInfo.height;\r\n                containerLayer.add(img);\r\n                addItemClickedCallback(img);\r\n                onKeyUpCallback(img);\r\n                this.viewComponent.addGifAnimation(img, viewInfo.content.background.url);\r\n                containerLayer.viewType = 'IMAGE';\r\n                img.viewInfoName = viewInfo.name;\r\n                //result = onLoadCallback(img);\r\n                containerLayer.onLoadBack = {name: refUuid, instanceUuid: instanceUuid, object: img, callBack: onLoadCallback};//记录载入事件\r\n                !isload && this.sceneProxy.uiOnLoadQueue.push({name: refUuid, instanceUuid: instanceUuid, object: img, callBack: onLoadCallback});\r\n            }\r\n            else if ('text' === viewInfo.type) {\r\n                let ff;\r\n                let fontStyle = {boundsAlignH: \"left\", boundsAlignV: \"bottom\", wordWrap: true};\r\n                ff = viewInfo.content.font_size + '';\r\n                if (ff.indexOf('px') < 0) {\r\n                    ff = ff + 'px';\r\n                }\r\n                if (viewInfo.content.bold === true) {\r\n                    ff = 'bold ' + ff + ' ' + viewInfo.content.fontFamily;\r\n                }\r\n                else {\r\n                    if (viewInfo.content.fontFamily) {\r\n                        ff = ff + ' ' + viewInfo.content.fontFamily;\r\n                    }\r\n                    else if (this.sceneProxy.json_data.font) {\r\n                        ff = ff + ' ' + this.sceneProxy.json_data.font.fontFamily;\r\n                    }\r\n                }\r\n\r\n                fontStyle.font = ff;\r\n                fontStyle.fill = viewInfo.content.color;\r\n                fontStyle.wordWrapWidth = !this.viewComponent.game.device.desktop ? viewInfo.width + 2 : viewInfo.width;\r\n\r\n                let txt = this.viewComponent.game.add.text(pointX, pointY, '', fontStyle, containerLayer);\r\n                let str = '';\r\n                if (Expression.isArray(viewInfo.content.value)) {\r\n                    viewInfo.content.value.forEach(v => str += Expression.parseValue(v.data, context));\r\n                    this.sceneProxy.addImageFontTextColors(viewInfo.content.value, txt, context);\r\n                    if (FontUtils.fontFamily) {\r\n                        const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(viewInfo.content.font_size) : viewInfo.content.font_size;\r\n                        const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(viewInfo.content.font_size) : viewInfo.content.font_size;\r\n                        this.sceneProxy.addImageFontText(viewInfo.content.value, fw, fh, txt, context);\r\n                    }\r\n                }\r\n                else {\r\n                    str = Expression.parseValue(viewInfo.content.value, context);\r\n                }\r\n                txt.inputEnabled = true;\r\n                txt.input.useHandCursor = true;\r\n                txt.useAdvancedWrap = true;\r\n                txt.lineSpacing = this.sceneProxy.txtLineSpace(viewInfo.content.font_size);\r\n                txt.updateText = RePhaser.updateText;\r\n                txt.advancedWordWrap = RePhaser.advancedWordWrap;\r\n                if (FontUtils.fontFamily) {\r\n                    txt.children.forEach(v => {v.visible = true});\r\n                    txt.text = ' ';\r\n                }\r\n                else {\r\n                    txt.text = str;\r\n                }\r\n                addItemClickedCallback(txt);\r\n                onKeyUpCallback(txt);\r\n                containerLayer.viewType = 'TEXT';\r\n                //result = onLoadCallback(txt);\r\n                containerLayer.onLoadBack = {name: refUuid, instanceUuid: instanceUuid, object: txt, callBack: onLoadCallback};//记录载入事件\r\n                !isload && this.sceneProxy.uiOnLoadQueue.push({name: refUuid, instanceUuid: instanceUuid, object: txt, callBack: onLoadCallback});\r\n                const eventsInfoCopy = eventsInfo ? eventsInfo : [];\r\n                const clickEvent = [...viewInfo.events, ...eventsInfoCopy].filter(a => a.type === 'onClick');\r\n                !clickEvent.length && (txt.inputEnabled = false);\r\n            }\r\n            else if ('bar' === viewInfo.type) {\r\n                let bkImg = this.viewComponent.game.add.sprite(pointX, pointY, viewInfo.content.background.normal.url);\r\n                bkImg.width = viewInfo.width;\r\n                bkImg.height = viewInfo.height;\r\n                containerLayer.add(bkImg);\r\n                addItemClickedCallback(bkImg);\r\n                this.viewComponent.addGifAnimation(bkImg, viewInfo.content.background.normal.url);\r\n\r\n                let bkPrgs = this.viewComponent.game.add.sprite(pointX// + viewInfo.content.basePoint.x\r\n                    , pointY// + viewInfo.content.basePoint.y\r\n                    , viewInfo.content.background.progress.url);\r\n                bkPrgs.width = viewInfo.width;\r\n                bkPrgs.height = viewInfo.height;\r\n                containerLayer.add(bkPrgs);\r\n                addItemClickedCallback(bkPrgs);\r\n                this.viewComponent.addGifAnimation(bkPrgs, viewInfo.content.background.progress.url);\r\n\r\n                let mask = this.viewComponent.game.add.graphics(pointX, pointY);\r\n                mask.beginFill(0xffffff);\r\n                mask.drawRect(0, 0, viewInfo.width, viewInfo.height);\r\n                mask.endFill();\r\n                containerLayer.add(mask);\r\n                bkPrgs.mask = mask;\r\n                addItemClickedCallback(mask);\r\n                onKeyUpCallback(mask);\r\n\r\n                let hType = '';\r\n                let vType = '';\r\n\r\n                if (viewInfo.content.basePoint.x === 0) {hType = 'left';}\r\n                else if (viewInfo.content.basePoint.x === viewInfo.width) {hType = 'right';}\r\n                else {hType = 'middle';}\r\n\r\n                if (viewInfo.content.basePoint.y === 0) {vType = 'top';}\r\n                else if (viewInfo.content.basePoint.y === viewInfo.height) {vType = 'bottom';}\r\n                else {vType = 'center';}\r\n\r\n                const {prgsViews} = this.sceneProxy;\r\n                let index = 0;\r\n                for (; index<prgsViews.length; index++) {\r\n                    if (prgsViews[index].uuid === viewInfo.uuid && prgsViews[index].layer.children.length === 0) {\r\n                        break;\r\n                    }\r\n                }\r\n                prgsViews[index] = {uuid: viewInfo.uuid\r\n                    , layer: containerLayer\r\n                    , type: hType + '-' + vType\r\n                    , content: viewInfo.content};\r\n\r\n                this.updateProgressView();\r\n                containerLayer.viewType = 'BAR';\r\n                //result = onLoadCallback(mask);\r\n                containerLayer.onLoadBack = {name: refUuid, instanceUuid: instanceUuid, object: mask, callBack: onLoadCallback};//记录载入事件\r\n                !isload && this.sceneProxy.uiOnLoadQueue.push({name: refUuid, instanceUuid: instanceUuid, object: mask, callBack: onLoadCallback});\r\n            }\r\n            else if ('input' === viewInfo.type) {\r\n                const initValue = Expression.safeEval(viewInfo.content.value, context);\r\n                let textBoxElement = new TextBox.HtmlTextBox(this.viewComponent.game\r\n                    , pointX, pointY\r\n                    , viewInfo.width, viewInfo.height\r\n                    , initValue\r\n                    , viewInfo.content.color\r\n                    , viewInfo.content.font_size\r\n                    , viewInfo.content.fontFamily ? viewInfo.content.fontFamily : this.sceneProxy.json_data.font ? this.sceneProxy.json_data.font.fontFamily : ''\r\n                    , viewInfo.content.bold ? viewInfo.content.bold : null);\r\n\r\n                if ('[未知数值]' === initValue) {\r\n                    textBoxElement.setEnable(false);\r\n                }\r\n\r\n                const inputCallback = (text)=>{\r\n                    const v = text;\r\n                    const uuid = viewInfo.content.value.arg1;\r\n                    const updateValue = (index, v, type) => {\r\n                        let realV = '';\r\n                        for (let i=0; i<v.length; i++) {\r\n                            if (v[i]>='0' && v[i]<='9' || v[i] === '.' && i !== 0) {\r\n                                realV += v[i];\r\n                            }\r\n                        }\r\n                        let vv = parseFloat(realV);\r\n                        vv = vv ? vv : 0;\r\n                        if (vv < -99999999999999) {\r\n                            vv = -99999999999999;\r\n                        }\r\n                        else if (vv > 99999999999999) {\r\n                            vv = 99999999999999;\r\n                        }\r\n                        if (type === 'value') {\r\n                            this.sceneProxy.context.values[index].value = vv;\r\n                        } else if (type === 'savedValue') {\r\n                            this.sceneProxy.context.savedValues[index].value = vv;\r\n                        }\r\n                        textBoxElement.isValue = true;\r\n                        if (parseFloat(realV) !== vv && 0 !== vv) {\r\n                            textBoxElement.text = vv + '';\r\n                        }\r\n                        else if (realV !== v) {\r\n                            textBoxElement.text = realV;\r\n                        }\r\n                    };\r\n                    let index;\r\n                    if ((index = context.values.findIndex(v => v.uuid === uuid)) !== -1) {\r\n                        updateValue(index, v, 'value');\r\n                    }\r\n                    else if ((index = context.savedValues.findIndex(v => v.uuid === uuid)) !== -1) {\r\n                        updateValue(index, v, 'savedValue');\r\n                    }\r\n                    else if ((index = context.stringValues.findIndex(v => v.uuid === uuid)) !== -1) {\r\n                        context.stringValues[index].value = v;\r\n                    }\r\n                    else if ((index = context.indexValues.findIndex(v => v.uuid === uuid)) !== -1) {\r\n                        const ri = (context.indexValues[index].value === undefined ? Expression.safeInitValue(context.indexValues[index], context) : context.indexValues[index].value) - 1;\r\n                        if (context.indexValues[index].init.type === 'value') {\r\n                            updateValue(ri, v, 'value');\r\n                        }\r\n                        else if (context.indexValues[index].init.type === 'savedValue') {\r\n                            updateValue(ri, v, 'savedValue');\r\n                        }\r\n                        else if (context.indexValues[index].init.type === 'stringValue') {\r\n                            context.stringValues[ri].value = v;\r\n                        }\r\n                    }\r\n                };\r\n\r\n                textBoxElement.setInputCallback(inputCallback);\r\n                textBoxElement.setClickCallback(onViewClicked);\r\n                textBoxElement.mgrParent = containerLayer;\r\n                containerLayer.inputElement = textBoxElement;\r\n                onKeyUpCallback(textBoxElement);\r\n                containerLayer.viewType = 'INPUT';\r\n                //result = onLoadCallback(textBoxElement);\r\n                containerLayer.onLoadBack = {name: refUuid, instanceUuid: instanceUuid, object: textBoxElement, callBack: onLoadCallback};//记录载入事件\r\n                !isload && this.sceneProxy.uiOnLoadQueue.push({name: refUuid, instanceUuid: instanceUuid, object: textBoxElement, callBack: onLoadCallback});\r\n            }\r\n            else if ('timer' === viewInfo.type) {\r\n                const sceneProxy = this.sceneProxy;\r\n                let img = this.viewComponent.game.add.image(0, 0, null);\r\n                containerLayer.add(img);\r\n                containerLayer.currentCount = 0;\r\n\r\n                const isStepCanSkip = () => {\r\n                    if (sceneProxy.playPause) {\r\n                        // 菜单可见 则不可跳过菜单中的计时器\r\n                        for (let i=0; i<sceneProxy.menuTimer.length; i++) {\r\n                            if (sceneProxy.menuTimer[i] === containerLayer.name) {\r\n                                return false;\r\n                            }\r\n                        }\r\n                        return true;\r\n                    }\r\n                    else {\r\n                        // 菜单不可见  则可跳过菜单中的计时器\r\n                        for (let i=0; i<sceneProxy.menuTimer.length; i++) {\r\n                            if (sceneProxy.menuTimer[i] === containerLayer.name) {\r\n                                return true;\r\n                            }\r\n                        }\r\n                        return false;\r\n                    }\r\n                };\r\n                const onStepTimeOut = () => {\r\n                    return function () {\r\n                        if (isStepCanSkip()) {\r\n                            containerLayer.timerHandler = setTimeout(onStepTimeOut(), viewInfo.content.step.value);\r\n                            return;\r\n                        }\r\n                        if (containerLayer.currentCount++ < viewInfo.content.count.value) {\r\n                            eventCallback(img, 'onStep');\r\n                            containerLayer.timerHandler = setTimeout(onStepTimeOut(), viewInfo.content.step.value);\r\n                        }\r\n                    }\r\n                };\r\n\r\n                const onStepInterval = () => {\r\n                    return function () {\r\n                        if (isStepCanSkip()) {\r\n                            return;\r\n                        }\r\n                        eventCallback(img, 'onStep');\r\n                    }\r\n                };\r\n\r\n                if (viewInfo.content.count.value === 0) {\r\n                    containerLayer.timerHandler = setInterval(onStepInterval(), viewInfo.content.step.value);\r\n                    containerLayer.timerType = 'timeInterval';\r\n                } else {\r\n                    containerLayer.timerHandler = setTimeout(onStepTimeOut(), viewInfo.content.step.value);\r\n                    containerLayer.timerType = 'timeOut';\r\n                }\r\n\r\n                // 读档还原计时器已计时次数\r\n                for (let i=0; i<this.sceneProxy.timerCounts.length; i++) {\r\n                    const item = this.sceneProxy.timerCounts[i];\r\n                    if (containerLayer.name === item.name && parentLayer && item.parent === parentLayer.name) {\r\n                        containerLayer.currentCount = item.currentCount;\r\n                        this.sceneProxy.timerCounts.splice(i,1);\r\n                        break;\r\n                    }\r\n                }\r\n                // 主菜单可见 判断为计时器是主菜单子控件\r\n                this.sceneProxy.mainMenuLayer.visible && (this.sceneProxy.menuTimer[this.sceneProxy.menuTimer.length] = refUuid)\r\n                containerLayer.viewType = 'TIMER';\r\n                containerLayer.onLoadBack = {name: refUuid, instanceUuid: instanceUuid, object: img, callBack: onLoadCallback};//记录载入事件\r\n                !isload && this.sceneProxy.uiOnLoadQueue.push({name: refUuid, instanceUuid: instanceUuid, object: img, callBack: onLoadCallback});\r\n            }\r\n            else if ('container' === viewInfo.type) {\r\n                let bk = null;\r\n                if (viewInfo.content.background.url) {\r\n                    bk = this.viewComponent.game.add.image(pointX, pointY, viewInfo.content.background.url);\r\n                    bk.width = viewInfo.width;\r\n                    bk.height = viewInfo.height;\r\n                } else {\r\n                    bk = this.viewComponent.game.add.graphics(0, 0);\r\n                    bk.beginFill(0x0, 1);\r\n                    bk.drawRect(pointX, pointY, viewInfo.width, viewInfo.height);\r\n                    bk.endFill();\r\n                    bk.alpha = 0;\r\n                }\r\n\r\n                containerLayer.add(bk);\r\n                addItemClickedCallback(bk);\r\n                onKeyUpCallback(bk);\r\n                containerLayer.viewType = 'CONTAINER';\r\n                containerLayer.onLoadBack = {name: refUuid, instanceUuid: instanceUuid, object: bk, callBack: onLoadCallback};//记录载入事件\r\n                !isload && this.sceneProxy.uiOnLoadQueue.push({name: refUuid, instanceUuid: instanceUuid, object: bk, callBack: onLoadCallback});\r\n                for (let i in viewInfo.children) {\r\n                    const child = this.addView(containerLayer, viewInfo.children[i].ref, viewInfo.children[i].instanceUuid, viewInfo.children[i].x, viewInfo.children[i].y, viewInfo.children[i].events, isRefresh,isload,diymenu);\r\n                    const scalechild = ()=>{\r\n                        child.x += pointX;\r\n                        child.y += pointY;\r\n                        if (viewInfo.children[i].scale) {\r\n                            child.scale.set(viewInfo.children[i].scale, viewInfo.children[i].scale);\r\n                            child.x += Expression.safeEval(viewInfo.children[i].x, context) * (1 - viewInfo.children[i].scale);\r\n                            child.y += Expression.safeEval(viewInfo.children[i].y, context) * (1 - viewInfo.children[i].scale);\r\n                        }\r\n\r\n                        if (child.inputElement) {\r\n                            //输入框  节点  相对应整个canvas\r\n                            const inputX = (containerLayer.parent && containerLayer.parent.xInfo) ? Expression.safeEval(containerLayer.parent.xInfo,this.sceneProxy.context) + pointX : pointX;\r\n                            const inputY = (containerLayer.parent && containerLayer.parent.yInfo) ? Expression.safeEval(containerLayer.parent.yInfo,this.sceneProxy.context) + pointY : pointY;\r\n                            child.inputElement.x += inputX;\r\n                            child.inputElement.y += inputY;\r\n\r\n                            if (viewInfo.children[i].scale) {\r\n                                child.inputElement.fontSize *= viewInfo.children[i].scale;\r\n                                child.inputElement.width *= viewInfo.children[i].scale;\r\n                                child.inputElement.height = child.inputElement.fontSize;\r\n                            }\r\n                            else {\r\n                                child.inputElement.update();\r\n                            }\r\n                        }\r\n                    }\r\n                    if (!child) {\r\n                        return false;\r\n                    };\r\n                    scalechild();\r\n                }\r\n\r\n                //result = onLoadCallback(bk);\r\n            }\r\n\r\n            return result ? containerLayer : result;\r\n\t\t},\r\n\r\n        /**\r\n         * 关闭播放广告按钮\r\n         */\r\n        closePlayAdButton:function(){\r\n            if(flashvars.single && flashvars.offline === '1' && flashvars.wap === '4399'){\r\n                const destroyInChild = (child) => {\r\n                    let uuid = ''\r\n                    if(child.viewInfoName === 'getD30A87'){\r\n                        uuid = child.name;\r\n                    }\r\n                    if ((child.name && child.name === uuid || child.instanceUuid && child.instanceUuid === uuid) && uuid !== '') {\r\n                        this.removeViewKeyByInstance(child, this.sceneProxy.plotViewKeys); // 组件销毁前，移除其按键事件\r\n                        this.sceneProxy.removeInputView(child);\r\n                        this.sceneProxy.removeViewTimer(child);\r\n                        child.destroy();\r\n                        return true;\r\n                    }\r\n                    else if (child.children && child.children.length > 0) {\r\n                        for (let i=0; i<child.children.length; i++) {\r\n                            destroyInChild(child.children[i]) && i--;\r\n                        }\r\n                    }\r\n                    return false;\r\n\r\n                };\r\n                H54399Api.canPlayAd().then(rs =>{\r\n                    if(rs.canplay !== true && rs.remain <= 0){\r\n                        destroyInChild(this.viewComponent.game.world);\r\n                    }\r\n                })\r\n            }\r\n        },\r\n\r\n\t\tuiOnLoadInvoker: function () {\r\n            const handle = ()=>{\r\n                if(this.sceneProxy.uiOnLoadQueue.length > 0){\r\n                    let item = this.sceneProxy.uiOnLoadQueue[0];\r\n                    this.sceneProxy.uiOnLoadQueue.splice(0, 1);\r\n                    return item.callBack(item.object).then(()=>{\r\n                        return handle();\r\n                    });\r\n                }else{\r\n                    //全部结束\r\n                    return Promise.resolve();\r\n                }\r\n            }\r\n\r\n            return handle().then(()=>{this.closePlayAdButton();return Promise.resolve()});\r\n\r\n        },\r\n\r\n\t\tupdateProgressView: function () {\r\n\t\t\tfor (let i = 0; i < this.sceneProxy.prgsViews.length; i++) {\r\n\t\t\t\tconst prgs = this.sceneProxy.prgsViews[i];\r\n\t\t\t\tif (!prgs.layer.children.length) { continue; }\r\n\r\n\t\t\t\tconst bkImg = prgs.layer.children[0];\r\n\t\t\t\tconst bkPrgs = prgs.layer.children[1];\r\n\t\t\t\tconst mask = prgs.layer.children[2];\r\n\t\t\t\tconst nWidth = this.sceneProxy.Expression.safeEval(prgs.content.value.normal.width, this.sceneProxy.context);\r\n\t\t\t\tconst nHeight = this.sceneProxy.Expression.safeEval(prgs.content.value.normal.height, this.sceneProxy.context);\r\n\t\t\t\tconst pWidth = this.sceneProxy.Expression.safeEval(prgs.content.value.progress.width, this.sceneProxy.context);\r\n\t\t\t\tconst pHeight = this.sceneProxy.Expression.safeEval(prgs.content.value.progress.height, this.sceneProxy.context);\r\n\t\t\t\tconst update = (obj, x, y, width, height) => {\r\n\t\t\t\t\tif (obj.isMask) {\r\n\t\t\t\t\t\tobj.destroy();\r\n\t\t\t\t\t\tobj = this.viewComponent.game.add.graphics(x, y);\r\n\t\t\t\t\t\tobj.beginFill(0xffffff);\r\n\t\t\t\t\t\tobj.drawRect(0, 0, width, height);\r\n\t\t\t\t\t\tobj.endFill();\r\n\t\t\t\t\t\tobj.inputEnabled = false;\r\n\t\t\t\t\t\tprgs.layer.add(obj);\r\n\t\t\t\t\t\tbkPrgs.mask = obj;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tobj.x = x;\r\n\t\t\t\t\t\tobj.y = y;\r\n\t\t\t\t\t\tobj.width = width;\r\n\t\t\t\t\t\tobj.height = height;\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\tlet mover = prgs.content.style === 'clip' ? mask : bkPrgs;\r\n\t\t\t\tconst w = Math.min(pWidth * bkImg.width / nWidth, bkImg.width);\r\n\t\t\t\tconst h = Math.min(pHeight * bkImg.height / nHeight, bkImg.height);\r\n\r\n\t\t\t\tswitch (prgs.type) {\r\n\t\t\t\t\tcase 'left-top':\r\n\t\t\t\t\t\tupdate(mover, bkImg.x, bkImg.y, w, h);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'middle-top':\r\n\t\t\t\t\t\tupdate(mover, bkImg.x+(bkImg.width-w)/2, bkImg.y, w, h);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'right-top':\r\n\t\t\t\t\t\tupdate(mover, bkImg.x+bkImg.width-w, bkImg.y, w, h);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'left-center':\r\n\t\t\t\t\t\tupdate(mover, bkImg.x, bkImg.y+(bkImg.height-h)/2, w, h);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'middle-center':\r\n\t\t\t\t\t\tupdate(mover, bkImg.x+(bkImg.width-w)/2, bkImg.y+(bkImg.height-h)/2, w, h);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'right-center':\r\n\t\t\t\t\t\tupdate(mover, bkImg.x+bkImg.width-w, bkImg.y+(bkImg.height-h)/2, w, h);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'left-bottom':\r\n\t\t\t\t\t\tupdate(mover, bkImg.x, bkImg.y+bkImg.height-h, w, h);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'middle-bottom':\r\n\t\t\t\t\t\tupdate(mover, bkImg.x+(bkImg.width-w)/2, bkImg.y+bkImg.height-h, w, h);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'right-bottom':\r\n\t\t\t\t\t\tupdate(mover, bkImg.x+bkImg.width-w,  bkImg.y+bkImg.height-h, w, h);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tdestroyView: function (viewLayerName, bCloseMainMenu) {\r\n\t\t\tconst destroyInChild = (child, name) => {\r\n\t\t\t\tif (child.name && child.name === name || child.instanceUuid && child.instanceUuid === name) {\r\n                    this.removeViewKeyByInstance(child, this.sceneProxy.plotViewKeys); // 组件销毁前，移除其按键事件\r\n                    this.sceneProxy.removeInputView(child);\r\n                    this.sceneProxy.removeViewTimer(child);\r\n                    child.destroy();\r\n\t\t\t\t\tif (child.isMenu && bCloseMainMenu) {\r\n\t\t\t\t\t\tthis.sceneProxy.onMainMenuBackBtnClicked();\r\n\t\t\t\t\t\tthis.sceneProxy.mainMenuLayer.removeAll(true, false, true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\telse if (child.children && child.children.length > 0) {\r\n\t\t\t\t\tfor (let i=0; i<child.children.length; i++) {\r\n\t\t\t\t\t\tdestroyInChild(child.children[i], name) && i--;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\t\t\tdestroyInChild(this.viewComponent.game.world, viewLayerName);\r\n\t\t},\r\n\r\n        hasInputView:function (layer) {\r\n            if(layer.inputElement){\r\n                return layer.inputElement\r\n            }else if(layer.children && layer.children.length){\r\n                for (let i=0; i<layer.children.length; i++) {\r\n                    let rs  = this.hasInputView(layer.children[i]);\r\n                    if(rs !== null && rs !== undefined){return rs}\r\n                }\r\n            }else {\r\n                return null;\r\n            }\r\n        },\r\n        showInputView: function (layer, bShow) {\r\n            if (layer.inputElement) {\r\n                layer.inputElement.show(bShow);\r\n            }\r\n            else if (layer.children && layer.children.length) {\r\n                for (let i=0; i<layer.children.length; i++) {\r\n                    this.showInputView(layer.children[i], bShow);\r\n                }\r\n            }\r\n        },\r\n\r\n\t\tscaleInputView: function (layer, scale) {\r\n\t\t\tif (layer.inputElement) {\r\n                layer.inputElement.fontSize *= scale;\r\n                layer.inputElement.width *= scale;\r\n\t\t\t\tlayer.inputElement.height = layer.inputElement.fontSize + 6;\r\n\t\t\t\t// 无需移动位置\r\n\t\t\t\t//layer.inputElement.x = layer.inputElement._x + this.sceneProxy.Expression.safeEval(layer.xInfo, this.sceneProxy.context) * (scale - 1);\r\n\t\t\t\t//layer.inputElement.y = layer.inputElement._y + this.sceneProxy.Expression.safeEval(layer.yInfo, this.sceneProxy.context) * (scale - 1);\r\n\t\t\t\tlayer.inputElement.update();\r\n\t\t\t}\r\n\t\t\telse if (layer.children && layer.children.length) {\r\n\t\t\t\tfor (let i=0; i<layer.children.length; i++) {\r\n\t\t\t\t\tthis.scaleInputView(layer.children[i], scale);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n        /**组件刷新*/\r\n\t\trefreshView: function (refUuid, bReload) {\r\n\r\n\t\t\tconst getRefreshViews = (view, refUuid) => {\r\n\t\t\t\tlet views = [];\r\n\t\t\t\tif (view.name && view.name === refUuid) {\r\n\t\t\t\t\tviews.push(view);\r\n\t\t\t\t} else {\r\n                    views = view.children.reduce((r, c) => r.concat(getRefreshViews(c, refUuid)), []);\r\n\t\t\t\t}\r\n\t\t\t\treturn views;\r\n\t\t\t};\r\n\t\t\tlet newViews = [];\r\n\t\t\tconst refreshViews = getRefreshViews(this.viewComponent.game.world, refUuid);\r\n            if(bReload){\r\n                //载入\r\n                if (refreshViews.length > 0) {\r\n                    const {viewMap} = this.sceneProxy.json_data;\r\n                    const events = viewMap[refUuid].events;\r\n                    for (let e in events) {\r\n                        if (events[e].type === 'onKeyUp') {\r\n                            this.sceneProxy.plotViewKeys[events[e].keyCode].onUp.removeAll();\r\n                        }\r\n                    }\r\n                }\r\n                refreshViews.forEach(oldView => {\r\n                    const {xInfo, yInfo, scale, isGlobal, children, instanceUuid} = oldView;\r\n\r\n                    for (let e in oldView.eventsInfo) {\r\n                        if (oldView.eventsInfo[e].type === 'onKeyUp') {\r\n                            this.sceneProxy.plotViewKeys[oldView.eventsInfo[e].keyCode].onUp.removeAll();\r\n                        }\r\n                    }\r\n\r\n                    const newView = this.addView(oldView.parent, refUuid, instanceUuid, xInfo, yInfo, oldView.eventsInfo, !bReload);\r\n                    if (!newView) {\r\n                        return;\r\n                    }\r\n\r\n                    this.viewComponent.game.world.add(newView);\r\n\r\n                    for (let n=0; n<children.length; n++) {\r\n                        let bExist = false;\r\n                        for (let c in newView.children) {\r\n                            if (newView.children[c].name === children[n].name) {\r\n                                bExist = true;\r\n                                break;\r\n                            }\r\n                        }\r\n\r\n                        if (!bExist && !bReload) {\r\n                            //this.addView(newView, children[n].name, children[n].instanceUuid, children[n].xInfo, children[n].yInfo, null, !bReload);\r\n                            newView.addChild(children[n]);\r\n                            n -= 1;\r\n                        }\r\n                    }\r\n\r\n                    if (oldView.parent.viewType === 'CONTAINER') {\r\n                        newView.x += this.sceneProxy.Expression.safeEval(oldView.parent.xInfo, this.sceneProxy.context);\r\n                        newView.y += this.sceneProxy.Expression.safeEval(oldView.parent.yInfo, this.sceneProxy.context);\r\n                    }\r\n\r\n                    if (scale) {\r\n                        newView.scale.set(scale.x, scale.y);\r\n                        newView.x += this.sceneProxy.Expression.safeEval(xInfo, this.sceneProxy.context) * (1 - scale.x);\r\n                        newView.y += this.sceneProxy.Expression.safeEval(yInfo, this.sceneProxy.context) * (1 - scale.y);\r\n                        this.scaleInputView(newView, scale.x);\r\n                    }\r\n\r\n                    if (isGlobal) {\r\n                        newView.isGlobal = true;\r\n                        const index = this.sceneProxy.globalViews.findIndex(v => v.name === refUuid);\r\n                        this.sceneProxy.globalViews.splice(index, 1, newView);\r\n                    }\r\n\r\n                    if (oldView.isMenu) {\r\n                        newView.isMenu = true;\r\n                    }\r\n\r\n                    if (oldView.parent && oldView.parent.name === 'plotViewsLayer') {\r\n                        const oldIndex = this.sceneProxy.plotViews.indexOf(oldView);\r\n                        this.sceneProxy.plotViews.splice(oldIndex, 1, newView);\r\n                    }\r\n                    this.sceneProxy.removeViewTimer(oldView);\r\n                    oldView.parent.replace(oldView, newView).destroy();\r\n                    newViews.push(newView);\r\n                });\r\n            }else{\r\n                refreshViews.forEach(view =>{\r\n                    let views = {sx:0,sy:0};\r\n                    const refresh =(v,refxy)=>{\r\n                        newViews.push(v);//刷新的组件\r\n                        let cws = {sx:0,sy:0};\r\n                        const getScaleValue = (vv)=>{\r\n                            let point = {sx:0,sy:0};\r\n                            if(vv.scale && vv.xInfo && vv.yInfo){\r\n                                point.sx = this.sceneProxy.Expression.safeEval(vv.xInfo, this.sceneProxy.context) * (1 - vv.scale.x);\r\n                                point.sy = this.sceneProxy.Expression.safeEval(vv.yInfo, this.sceneProxy.context) * (1 - vv.scale.y);\r\n                            }\r\n                            return point;\r\n                        }\r\n                        if(refxy){\r\n                            views = getScaleValue(v);\r\n                        }\r\n                        const viewInfo = this.sceneProxy.json_data.viewMap[v.parent.name];\r\n                        if(v.parent){\r\n                            let vx = 0;\r\n                            let vy = 0;\r\n                            if(v.parent.xInfo && v.parent.yInfo){\r\n                                vx = this.sceneProxy.Expression.safeEval(v.parent.xInfo, this.sceneProxy.context);\r\n                                vy = this.sceneProxy.Expression.safeEval(v.parent.yInfo, this.sceneProxy.context);\r\n                                if((v.parent.viewType === 'CONTAINER' && !refxy) || v.scale && (v.scale.x !== 1 || v.scale.y !== 1)){\r\n                                    cws = getScaleValue(v);\r\n                                    vx += (cws.sx);\r\n                                    vy += (cws.sy);\r\n                                }\r\n                                v.x = vx;\r\n                                v.y = vy;\r\n                            }else{\r\n                                if(refxy){\r\n                                    v.x = views.sx;\r\n                                    v.y = views.sy;\r\n                                }\r\n\r\n                            }\r\n                            if(v.parent.viewType === 'BAR'){\r\n                                let hType = '';\r\n                                let vType = '';\r\n                                if (viewInfo.content.basePoint.x === 0) {hType = 'left';}\r\n                                else if (viewInfo.content.basePoint.x === viewInfo.width) {hType = 'right';}\r\n                                else {hType = 'middle';}\r\n                                if (viewInfo.content.basePoint.y === 0) {vType = 'top';}\r\n                                else if (viewInfo.content.basePoint.y === viewInfo.height) {vType = 'bottom';}\r\n                                else {vType = 'center';}\r\n                                const type = hType + '-' + vType;\r\n                                const bkImg = v.parent.children[0];\r\n                                const bkPrgs = v.parent.children[1];\r\n                                const mask = v.parent.children[2];\r\n                                const layer = v.parent;\r\n                                const nWidth = this.sceneProxy.Expression.safeEval(viewInfo.content.value.normal.width, this.sceneProxy.context);\r\n                                const nHeight = this.sceneProxy.Expression.safeEval(viewInfo.content.value.normal.height, this.sceneProxy.context);\r\n                                const pWidth = this.sceneProxy.Expression.safeEval(viewInfo.content.value.progress.width, this.sceneProxy.context);\r\n                                const pHeight = this.sceneProxy.Expression.safeEval(viewInfo.content.value.progress.height, this.sceneProxy.context);\r\n                                const update = (obj, x, y, width, height) => {\r\n                                    if (obj.isMask) {\r\n                                        obj.destroy();\r\n                                        obj = this.viewComponent.game.add.graphics(x, y);\r\n                                        obj.beginFill(0xffffff);\r\n                                        obj.drawRect(0, 0, width, height);\r\n                                        obj.endFill();\r\n                                        obj.inputEnabled = false;\r\n                                        layer.add(obj);\r\n                                        bkPrgs.mask = obj;\r\n                                    } else {\r\n                                        obj.x = x;\r\n                                        obj.y = y;\r\n                                        obj.width = width;\r\n                                        obj.height = height;\r\n                                    }\r\n                                };\r\n\r\n                                let mover = viewInfo.content.style === 'clip' ? mask : bkPrgs;\r\n                                if(!mover) return;\r\n                                const w = Math.min(pWidth * bkImg.width / nWidth, bkImg.width);\r\n                                const h = Math.min(pHeight * bkImg.height / nHeight, bkImg.height);\r\n                                switch (type) {\r\n                                    case 'left-top':\r\n                                        update(mover, bkImg.x, bkImg.y, w, h);\r\n                                        break;\r\n                                    case 'middle-top':\r\n                                        update(mover, bkImg.x+(bkImg.width-w)/2, bkImg.y, w, h);\r\n                                        break;\r\n                                    case 'right-top':\r\n                                        update(mover, bkImg.x+bkImg.width-w, bkImg.y, w, h);\r\n                                        break;\r\n                                    case 'left-center':\r\n                                        update(mover, bkImg.x, bkImg.y+(bkImg.height-h)/2, w, h);\r\n                                        break;\r\n                                    case 'middle-center':\r\n                                        update(mover, bkImg.x+(bkImg.width-w)/2, bkImg.y+(bkImg.height-h)/2, w, h);\r\n                                        break;\r\n                                    case 'right-center':\r\n                                        update(mover, bkImg.x+bkImg.width-w, bkImg.y+(bkImg.height-h)/2, w, h);\r\n                                        break;\r\n                                    case 'left-bottom':\r\n                                        update(mover, bkImg.x, bkImg.y+bkImg.height-h, w, h);\r\n                                        break;\r\n                                    case 'middle-bottom':\r\n                                        update(mover, bkImg.x+(bkImg.width-w)/2, bkImg.y+bkImg.height-h, w, h);\r\n                                        break;\r\n                                    case 'right-bottom':\r\n                                        update(mover, bkImg.x+bkImg.width-w,  bkImg.y+bkImg.height-h, w, h);\r\n                                        break;\r\n                                }\r\n                            }\r\n                            else if(v.parent.viewType === 'INPUT' ){\r\n                                const initValue = this.sceneProxy.Expression.safeEval(viewInfo.content.value, this.sceneProxy.context);\r\n                                v.parent.inputElement.text = initValue;\r\n                            }\r\n                            else if(v.parent.viewType === 'TEXT'){\r\n                                const txt = v.parent.children[0];\r\n                                let str = '';\r\n                                if (this.sceneProxy.Expression.isArray(viewInfo.content.value)) {\r\n                                    viewInfo.content.value.forEach(v => str += this.sceneProxy.Expression.parseValue(v.data, this.sceneProxy.context));\r\n                                    this.sceneProxy.addImageFontTextColors(viewInfo.content.value, txt, this.sceneProxy.context);\r\n                                    if (FontUtils.fontFamily) {\r\n                                        const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(viewInfo.content.font_size) : viewInfo.content.font_size;\r\n                                        const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(viewInfo.content.font_size) : viewInfo.content.font_size;\r\n                                        this.sceneProxy.addImageFontText(viewInfo.content.value, fw, fh, txt, this.sceneProxy.context);\r\n                                    }\r\n                                }else {\r\n                                    str = this.sceneProxy.Expression.parseValue(viewInfo.content.value, this.sceneProxy.context);\r\n                                }\r\n                                if (FontUtils.fontFamily) {\r\n                                    txt.children.forEach(v => {v.visible = true});\r\n                                    txt.text = ' ';\r\n                                }\r\n                                else {\r\n                                    txt.text = str;\r\n                                }\r\n                            }\r\n                        }\r\n                        if(v.children && v.children.length > 0){\r\n                            for(let i =0;i<v.children.length;i++){\r\n                                refresh(v.children[i],false)\r\n                            }\r\n                        }\r\n                    }\r\n                    refresh(view,true)\r\n                })\r\n            }\r\n            return newViews;\r\n\t\t},\r\n\r\n\t\tbackgroundFlex: function (bkSprite, flex) {\r\n\t\t\tif (flex === 3) {// 填充\r\n\t\t\t\tlet rate = bkSprite.width / bkSprite.height < this.viewComponent.game.world.width / this.viewComponent.game.world.height ? this.viewComponent.game.world.width / bkSprite.width : this.viewComponent.game.world.height / bkSprite.height;\r\n\t\t\t\tbkSprite.width *= rate;\r\n\t\t\t\tbkSprite.height *= rate;\r\n\t\t\t\tbkSprite.x = -(bkSprite.width - this.viewComponent.game.world.width) / 2;\r\n\t\t\t\tbkSprite.y = -(bkSprite.height - this.viewComponent.game.world.height) / 2;\r\n\t\t\t}\r\n\t\t\telse if (flex === 5) {// 适应\r\n\t\t\t\tlet rate = 0;\r\n\t\t\t\tif (bkSprite.width / bkSprite.height > this.viewComponent.game.world.width / this.viewComponent.game.world.height) {\r\n\t\t\t\t\trate = this.viewComponent.game.world.width / bkSprite.width;\r\n\t\t\t\t\tbkSprite.width *= rate;\r\n\t\t\t\t\tbkSprite.height *= rate;\r\n\t\t\t\t\tbkSprite.y = (this.viewComponent.game.world.height - bkSprite.height) / 2;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\trate = this.viewComponent.game.world.height / bkSprite.height;\r\n\t\t\t\t\tbkSprite.width *= rate;\r\n\t\t\t\t\tbkSprite.height *= rate;\r\n\t\t\t\t\tbkSprite.x = (this.viewComponent.game.world.width - bkSprite.width) / 2;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tbkSprite.width = this.viewComponent.game.world.width;\r\n\t\t\t\tbkSprite.height = this.viewComponent.game.world.height;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\ttweenToPromise: function (obj, properties, duration, ease, autoStart, delay, repeat, yoyo) {\r\n\t\t\tduration = Math.max(duration, 1);\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tconst tween = this.viewComponent.game.add.tween(obj).to(properties\r\n\t\t\t\t\t, duration\r\n\t\t\t\t\t, ease, autoStart\r\n\t\t\t\t\t, delay, repeat, yoyo);\r\n\t\t\t\ttween.onComplete.add(() => resolve());\r\n\t\t\t\tthis.sceneProxy.lstPlotTweens.push(tween);\r\n                !obj.animateTweens && (obj.animateTweens = []);\r\n\t\t\t\t/*obj && 'dialogLayer' === obj.name && */obj.animateTweens.push(tween);\r\n                if(obj.parent && obj.parent.parent && obj.parent.parent.parent &&obj.parent.parent.parent.name === 'bubbleLayer'){\r\n                    obj.parent.parent.parent.animateTweens.push(tween);\r\n                }\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\ttweenFromPromise: function (obj, properties, duration, ease, autoStart, delay, repeat, yoyo) {\r\n            duration = Math.max(duration, 1);\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tconst tween = this.viewComponent.game.add.tween(obj).from(properties\r\n\t\t\t\t\t, duration\r\n\t\t\t\t\t, ease, autoStart\r\n\t\t\t\t\t, delay, repeat, yoyo);\r\n\t\t\t\ttween.onComplete.add(() => resolve());\r\n                this.sceneProxy.lstPlotTweens.push(tween);\r\n                !obj.animateTweens && (obj.animateTweens = []);\r\n                /*obj && 'dialogLayer' === obj.name && */obj.animateTweens.push(tween);\r\n                if(obj.parent && obj.parent.parent && obj.parent.parent.parent && obj.parent.parent.parent.name === 'bubbleLayer'){\r\n                    obj.parent.parent.parent.animateTweens.push(tween);\r\n                }\r\n\t\t\t})\r\n\t\t},\r\n\r\n        /**\r\n         * 显示气泡， 添加气泡显示区域边框\r\n         * @param layer\r\n         */\r\n        addBubbleBorder:function (layer,commands) {\r\n            if(!commands) return null;\r\n            const bdata = commands.args[0];\r\n            const border = this.viewComponent.game.add.group();\r\n            border.uuid = bdata.uuid;\r\n            border.remove = bdata.remove;\r\n            border.remark = bdata.remark;\r\n            border.index = bdata.index;\r\n            border.width = bdata.rect.width;\r\n            border.height = bdata.rect.height;\r\n            border.origialH = bdata.rect.height;\r\n            border.itemlength = 0; //开始的长度为0\r\n            border.bubbley = 0;//开始坐标\r\n            border.savebubble = [];//记录保留的气泡内容\r\n            border.curbubble = [];//当前显示的气泡内容\r\n            border.ishide = false;//是否隐藏\r\n            border.iscurrent = true; //是否是当前气泡\r\n            border.commands = commands;//存入指令\r\n            border.isdown = false;\r\n            border.x = bdata.rect.x;\r\n            border.y = bdata.rect.y;\r\n            layer && layer.addChild(border);\r\n            //气泡背景\r\n            let bg = null;\r\n            if(bdata.url !== '' && this.viewComponent.game.load.cache.checkImageKey(bdata.url)){\r\n                this.viewComponent.addFitImageSprint(0,0,\r\n                    bdata.rect.width,\r\n                    bdata.rect.height,\r\n                    bdata.url,\r\n                    border,\r\n                    bdata.index)\r\n            }else{\r\n                bg = this.viewComponent.game.add.graphics(0,0);\r\n                bg.beginFill(0xffffff,0);//透明背景\r\n                bg.drawRect(0,0,bdata.rect.width,bdata.rect.height);\r\n                bg.endFill();\r\n                border.addChild(bg);\r\n            }\r\n            const scrollPane = this.viewComponent.game.add.sprite(0,0); //用于拖动和存放发射气泡\r\n            scrollPane.name = 'borderScrollPane';\r\n            border.addChild(scrollPane);\r\n\r\n            //用于点击滚动的透明图\r\n            const scrollgraphics = this.viewComponent.game.add.graphics();\r\n            scrollgraphics.name = 'scrollgraphics';\r\n            scrollgraphics.beginFill(0xfff000,0);//透明背景\r\n            scrollgraphics.drawRect(0,0,0,0);\r\n            scrollgraphics.endFill();\r\n            scrollPane.addChild(scrollgraphics);\r\n\r\n            let dragStartPointX = 0,dragStartY = null;\r\n            let wheelEvent = false;\r\n            let startx=0,starty=0,updatex=0,updatey=0;\r\n            const getPoint = (pointer)=>{\r\n                    let x, y;\r\n                    let w = (window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth);\r\n                    let h = (window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight);\r\n                    if (w > h) {\r\n                        if(flashvars.vertical){\r\n                            x = pointer.worldY;\r\n                            y = -pointer.worldX;\r\n                        }else{\r\n                            x = pointer.worldX;\r\n                            y = pointer.worldY;\r\n                        }\r\n                    }\r\n                    else {\r\n                        if(flashvars.vertical){\r\n                            x = pointer.worldX;\r\n                            y = pointer.worldY;\r\n                        }else{\r\n                            x = pointer.worldY;\r\n                            y = -pointer.worldX;\r\n                        }\r\n                    }\r\n                    return {x,y};\r\n                }\r\n            const onScroll = (x,y) =>{\r\n                if(border.itemlength < bdata.rect.height){\r\n                    try{\r\n                        scrollPane.input.disableDrag();\r\n                    }catch (e){ }\r\n                    return;\r\n                }\r\n                if(y > 0){\r\n                    scrollPane.y = 0;\r\n                }else if(y < -(border.itemlength - bdata.rect.height)){\r\n                    scrollPane.y = -(border.itemlength - bdata.rect.height);\r\n                }else{\r\n                    scrollPane.y = y;\r\n                }\r\n            }\r\n            const onMove = (pointer, x, y) => {\r\n                const point = getPoint(pointer);\r\n                const mousewheelevt = (/Firefox/i.test(navigator.userAgent)) ? \"DOMMouseScroll\" : \"mousewheel\";\r\n                if (!point) {\r\n                    if (wheelEvent) {\r\n                        document.removeEventListener(mousewheelevt, onMouseWheel);\r\n                        wheelEvent = false;\r\n                    }\r\n                }\r\n                else {\r\n                    if (!wheelEvent) {\r\n                        document.addEventListener(mousewheelevt, onMouseWheel);\r\n                        wheelEvent = true;\r\n                    }\r\n                }\r\n            };\r\n            const onMouseWheel = e => {\r\n                const delta = e.wheelDelta ? e.wheelDelta / 120 : -e.detail / 3;\r\n                onScroll(0, scrollPane.y + delta * 100)\r\n            };\r\n            const onDragUpdate = (sprite, pointer, x, y, pt, bFromStart)=>{\r\n                    let w = (window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth);\r\n                    let h = (window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight);\r\n                    let px = x;\r\n                    let py = y;\r\n                    bFromStart && (dragStartPointX = x);\r\n                    dragStartY = scrollPane.y;\r\n                    if (w < h && dragStartY !== null) {\r\n                        py = dragStartY - x + dragStartPointX;\r\n                    }\r\n                    onScroll(px, py);\r\n                }\r\n            const onDragStart = (sprite, pointer, x, y, pt, bFromStart)=>{\r\n                dragStartPointX = x;\r\n                dragStartY = scrollPane.y;\r\n            };\r\n            const onDragStop = (sprite, pointer, x, y, pt, bFromStart)=>{\r\n                dragStartY = scrollPane.y;\r\n            }\r\n            const onItemUp = (m, pt) => {\r\n                updatex = this.viewComponent.game.input.x;\r\n                updatey = this.viewComponent.game.input.y;\r\n                if((Math.abs(startx-updatex) <=1 || Math.abs(starty - updatey) <=1) && border.isdown){\r\n                    border.isdown = false;\r\n                    if(this.sceneProxy.dialogNext !== null){\r\n                        this.sceneProxy.dialogNext();\r\n                    }\r\n                    border.gonext && border.gonext(border);\r\n                }\r\n                startx=0,starty=0,updatex=0,updatey=0;\r\n                border.isdown = false;\r\n            };\r\n            const onInputDown = (sprite,pointer)=>{\r\n                border.isdown = true;\r\n                startx = this.viewComponent.game.input.x;\r\n                starty = this.viewComponent.game.input.y;\r\n                if(!getPoint(pointer)){\r\n                    return sprite.input.disableDrag();\r\n                }\r\n                return sprite.input.enableDrag();\r\n            }\r\n            scrollPane.inputEnabled = true;\r\n            scrollPane.input.enableDrag();\r\n            scrollPane.input.allowHorizontalDrag = false;\r\n            scrollPane.events.onDragUpdate.add(onDragUpdate, this);\r\n            scrollPane.events.onDragStart.add(onDragStart, this);\r\n            scrollPane.events.onDragStop.add(onDragStop, this);\r\n            scrollPane.events.onInputDown.add(onInputDown, this);\r\n            scrollPane.events.onInputUp.add(onItemUp, this);\r\n            this.viewComponent.game.input.addMoveCallback(onMove, this);\r\n            //添加遮罩\r\n            let mask = this.viewComponent.game.add.graphics();\r\n            mask.beginFill(0,0);\r\n            mask.drawRect(0,0,bdata.rect.width,bdata.rect.height);\r\n            mask.endFill();\r\n            border.addChild(mask);\r\n            border.mask = mask;\r\n            border.scorllfun = onScroll;\r\n            layer && this.viewComponent.game.world.bringToTop(layer);\r\n            !this.sceneProxy.dialogLayer.isbottom && this.viewComponent.game.world.bringToTop(this.sceneProxy.dialogLayer)\r\n            this.viewComponent.game.world.bringToTop(this.sceneProxy.plotViewsLayer);\r\n            if(this.sceneProxy.menuLayer.children.length > 0)this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n            this.sceneProxy.quickPlayLayer.alpha && this.viewComponent.game.world.bringToTop(this.sceneProxy.quickPlayLayer);\r\n            return border;\r\n        },\r\n\r\n        /**\r\n         * 生成气泡\r\n         * @param bdata\r\n         * @param border  边框\r\n         */\r\n        createBubble:function (cmds,border) {\r\n            return new Promise((resolve,reject) =>{\r\n                const group = this.viewComponent.game.add.group();\r\n                group.commands = cmds;\r\n                const bdata = cmds.args[0];\r\n                const {type,content,avatar,role,position} = bdata;\r\n                const bubbleborder = border.getByName('borderScrollPane');\r\n                const scrollgraphics = bubbleborder && bubbleborder.getChildAt(0);\r\n                let onlycontent = false;\r\n                let cbgcolor = 0xffffff;\r\n                //位置\r\n                let x = 0,y=0;\r\n                switch (position){\r\n                    case 'left':\r\n                        x = 0;y = border.itemlength;\r\n                        cbgcolor = 0xffffff;\r\n                        break;\r\n                    case 'center':\r\n                        onlycontent = true;\r\n                        x = border.width / 2;y = border.itemlength;\r\n                        cbgcolor = 0xdadada;\r\n                        break;\r\n                    case 'right':\r\n                        x = border.width;y = border.itemlength;\r\n                        cbgcolor = 0x98e165;\r\n                        break;\r\n                }\r\n                group.x = x;\r\n                group.y = y;\r\n                //头像\r\n                if(this.viewComponent.game.load.cache.checkImageKey(avatar.url) && position !== 'center'){\r\n                    const bubbleavatar = group.create(avatar.rect.x,avatar.rect.y,avatar.url);\r\n                    const scale = Math.min(avatar.rect.width/bubbleavatar.width,avatar.rect.height/bubbleavatar.height)\r\n                    bubbleavatar.width *= scale;\r\n                    bubbleavatar.height *= scale;\r\n                    bubbleavatar.x = (avatar.rect.width - bubbleavatar.width) / 2 + avatar.rect.x;\r\n                    bubbleavatar.y = (avatar.rect.height - bubbleavatar.height) / 2 + avatar.rect.y;\r\n                }\r\n                //用户名\r\n                if(position !== 'center'){\r\n                    const rolestyle = {\r\n                        fill:role.color\r\n                        ,font:role.font_size + 'px ' +role.fontFamily\r\n                    }\r\n                    const roledata = this.sceneProxy.Expression.parseValue(role.data, this.sceneProxy.context);\r\n                    const roletxt = this.viewComponent.game.add.text(0,0,roledata,rolestyle,group);\r\n                    roletxt.setTextBounds(role.rect.x,role.rect.y,role.rect.width,role.rect.height);\r\n                }\r\n\r\n                //气泡内容\r\n                if(type === 'image'){\r\n                    //图片内容\r\n                    if(this.viewComponent.game.load.cache.checkImageKey(content.url)){\r\n                        const contentimg = group.create(content.rect.x,onlycontent ? 0 : content.rect.y,content.url);\r\n                        contentimg.width = content.rect.width;\r\n                        contentimg.height = content.rect.height;\r\n                    }\r\n\r\n                }else if(type === 'text'){\r\n                    //文本内容\r\n                    const contenttextstyle = {\r\n                        fill:content.color\r\n                        ,font:content.font_size + 'px ' + content.fontFamily\r\n                        , boundsAlignH: \"center\"\r\n                        , boundsAlignV: \"middle\"\r\n                        , wordWrap: true\r\n                        , wordWrapWidth: content.rect.width}\r\n\r\n                    const contentext = this.viewComponent.game.add.text(content.rect.x + 4,onlycontent ? 2 : content.rect.y + 2,'',contenttextstyle,group);\r\n                    contentext.useAdvancedWrap = true;\r\n                    contentext.updateText = RePhaser.updateText;\r\n                    contentext.lineSpacing = this.sceneProxy.txtLineSpace(content.font_size)\r\n                    let contextdata = '';\r\n                    if (this.sceneProxy.Expression.isArray(content.data)) {\r\n                        for (let i=0; i<content.data.length; i++) {\r\n                            contextdata += this.sceneProxy.Expression.parseValue(content.data[i].data, this.sceneProxy.context);\r\n                            // 设置颜色\r\n                            this.sceneProxy.addImageFontTextColors(content.data, contentext, this.sceneProxy.context);\r\n                            //content.data[i].color && (contentext.style.fill = content.data[i].color);\r\n                        }\r\n                    }\r\n                    else {\r\n                        contextdata = this.sceneProxy.Expression.parseValue(content.data, this.sceneProxy.context);\r\n                        content.data.color && (contentext.style.fill = content.data.color);\r\n                    }\r\n                    while (contextdata.length && contextdata[contextdata.length-1] === '\\n') {\r\n                        //最后换行结尾 空字符\r\n                        contextdata = contextdata.substring(0, contextdata.length-1);\r\n                    }\r\n                    contentext.text = contextdata;\r\n                    if(contextdata !== ''){\r\n                        //有内容\r\n                        //对话框内容底图\r\n                        const contentbg = this.viewComponent.game.add.graphics();\r\n                        const ch = contentext.height > content.rect.height ? contentext.height : content.rect.height;\r\n                        contentbg.beginFill(cbgcolor)\r\n                        contentbg.drawRoundedRect(content.rect.x,onlycontent ? 0 : content.rect.y,content.rect.width,ch,6,6);\r\n                        contentbg.endFill();\r\n                        group.addChildAt(contentbg,0);\r\n                        //小三角\r\n                        if(position !== 'center'){\r\n                            let offsetx = 0,offsety = 0;\r\n                            let trianglex = content.rect.x,triangley = content.rect.y +5;\r\n                            if(position === 'left'){\r\n                                offsetx = -10;\r\n                                offsety = 10;\r\n                                trianglex += 2;\r\n                            }else if(position === 'right'){\r\n                                offsetx = 10;\r\n                                offsety = 10;\r\n                                trianglex += (content.rect.width - 2);\r\n                            }\r\n                            const triangle = this.viewComponent.game.add.graphics();\r\n                            triangle.beginFill(cbgcolor);\r\n                            triangle.moveTo(trianglex,triangley);\r\n                            triangle.lineTo(trianglex + offsetx ,triangley + offsety);\r\n                            triangle.lineTo(trianglex,triangley + 25);\r\n                            triangle.endFill();\r\n                            group.addChildAt(triangle,0);\r\n                        }\r\n                    }\r\n\r\n                }else{\r\n                    //未知置内容类型\r\n                }\r\n                border.itemlength += group.height + 20; //长度\r\n                if(scrollgraphics){\r\n                    scrollgraphics.clear();\r\n                    scrollgraphics.beginFill(0x000000,0);//透明背景\r\n                    scrollgraphics.drawRect(0,0,border.width,border.itemlength);\r\n                    scrollgraphics.endFill();\r\n                }\r\n                bubbleborder.addChild(group);\r\n                if(border.itemlength > border.origialH){\r\n                    bubbleborder.y = -(border.itemlength - border.origialH);\r\n                }\r\n                return resolve(group);\r\n            })\r\n        },\r\n\r\n\r\n        showPlot: function (context, chapter, nPlot, cmdPlotSnap, loadData) {\r\n\t\t\tconst {Expression} = this.sceneProxy;\r\n\t\t\tconst plot = chapter.plots[nPlot];\r\n            let bkSprite = null;\t// 背景\r\n\t\t\tlet titleTxt = null;\t// 文本标题\r\n\t\t\tlet contentTxt = null;\t// 文本\r\n\t\t\tlet isShowAll = false;\r\n            this.addKeyBoardZ();\r\n\t\t\tif( this.sceneProxy.isQuickPlay !== true){\r\n                appCanBack(flashvars.client,flashvars.app_version,false,flashvars.offline === '1'); //允许滑动\r\n            }\r\n            this.sceneProxy.isQuickPlay = true;\r\n\r\n\t\t\tif (!this.sceneProxy.isGameStarted && chapter.isFirst && nPlot===0) {\r\n\t\t\t\t// 告知游戏开始\r\n\t\t\t\tthis.sceneProxy.notifyGameStarted();\r\n\t\t\t}\r\n\r\n\t\t\t// 振动效果\r\n\t\t\tconst sceneShake = (offSet/*=18*/, duration/*=600*/, delay) => {\r\n\t\t\t\tconst curOffSet = offSet;\r\n\t\t\t\tconst sceneProxy = this.sceneProxy;\r\n\t\t\t\tconst properties = {\r\n\t\t\t\t\tx: sceneProxy.dialogLayer.x - curOffSet,\r\n\t\t\t\t\ty: sceneProxy.dialogLayer.y - curOffSet\r\n\t\t\t\t};\r\n\t\t\t\tlet promises = [];\r\n                sceneProxy.curPlotLayer.isShaking = true;\r\n                if (plot.speaking && plot.speaking.coverage === 'bottom') {\r\n                    sceneProxy.dialogLayer.snakename = 'shake';\r\n                    promises.push(this.tweenToPromise(sceneProxy.dialogLayer, properties, 40, null, true, delay, 0, true));\r\n                }\r\n                if (sceneProxy.charsAndPropsLayer && sceneProxy.charsAndPropsLayer.visible) {\r\n                    const cnpx = sceneProxy.charsAndPropsLayer.x;\r\n                    const cnpy = sceneProxy.charsAndPropsLayer.y;\r\n                    sceneProxy.charsAndPropsLayer.snakename = 'shake';\r\n                    promises.push(this.tweenToPromise(sceneProxy.charsAndPropsLayer,\r\n                        {x: sceneProxy.charsAndPropsLayer.x - curOffSet, y: sceneProxy.charsAndPropsLayer.y - curOffSet},\r\n                        40, null, true, delay, 0, true).then(()=>{\r\n                        sceneProxy.charsAndPropsLayer.x = cnpx;\r\n                        sceneProxy.charsAndPropsLayer.y = cnpy;\r\n                    }));\r\n                }\r\n                sceneProxy.curPlotLayer.snakename = 'shake';\r\n                promises.push(this.tweenToPromise(sceneProxy.curPlotLayer, {\r\n                    x: -curOffSet,\r\n                    y: -curOffSet\r\n                }, 40, null, true, delay, 0, true)\r\n                    .then(() => {\r\n                        sceneProxy.curPlotLayer.x = 0;\r\n                        sceneProxy.curPlotLayer.y = 0;\r\n                        if(this.sceneProxy.shakeLoopObj.duration === 0){\r\n                            sceneProxy.curPlotLayer.isShaking = false;\r\n                            return Promise.resolve();\r\n                        }\r\n                        if (0 < duration && !sceneProxy.quickPlay && chapter === sceneProxy.curChapter && nPlot === sceneProxy.curPlotIndex) {\r\n                            return sceneShake(curOffSet, duration-100, 0);\r\n                        }\r\n                        else {\r\n                            sceneProxy.curPlotLayer.isShaking = false;\r\n                            return Promise.resolve();\r\n                        }\r\n                    }));\r\n\t\t\t\treturn Promise.all(promises)\r\n\t\t\t};\r\n\t\t\t/**暂停 清除振动*/\r\n\t\t\tconst clearShake = ()=>{\r\n                this.sceneProxy.curPlotLayer && (this.sceneProxy.curPlotLayer.isShaking = false)\r\n                this.sceneProxy.shakeLoopObj.loop = false;\r\n                this.sceneProxy.shakeLoopObj.duration = 0;\r\n                for(let i = 0; i<this.sceneProxy.lstPlotTweens.length;i++ ){\r\n                    let tween = this.sceneProxy.lstPlotTweens[i];\r\n                    if(tween.target && tween.target.snakename === 'shake'){\r\n                        tween.pause();\r\n                        tween.stop(true);\r\n                    }\r\n                }\r\n            }\r\n\r\n\t\t\t// 闪烁效果\r\n\t\t\tconst sceneTwinkle = (duration, delay, color) => {\r\n\t\t\t\tthis.sceneProxy.twinkleTimer = Utils.timeout(delay || 0);\r\n                return this.sceneProxy.twinkleTimer.then(() => {\r\n                    const twinkle = this.viewComponent.game.add.graphics(0, 0);\r\n                    twinkle.beginFill(Utils.fixColorValue(color).replace('#', '0x'));\r\n                    twinkle.moveTo(0, 0);\r\n                    twinkle.lineTo(this.viewComponent.game.world.width, 0);\r\n                    twinkle.lineTo(this.viewComponent.game.world.width, this.viewComponent.game.world.height);\r\n                    twinkle.lineTo(0, this.viewComponent.game.world.height);\r\n                    twinkle.lineTo(0, 0);\r\n                    twinkle.endFill();\r\n                    twinkle.name = 'twinkle';\r\n                    this.sceneProxy.twinkleTimer = null;\r\n                    return this.tweenToPromise(twinkle, {alpha: 0}, duration, null, true, 0).then(() => twinkle.destroy());\r\n\t\t\t\t})\r\n\t\t\t};\r\n\r\n\t\t\t// 淡入效果\r\n\t\t\tconst fadeIn = (duration, delay) => {\r\n\t\t\t\tif (bkSprite) {\r\n\t\t\t\t\treturn this.tweenFromPromise(bkSprite, {alpha: 0}, duration, null, true, delay);\r\n\t\t\t\t}\r\n\t\t\t\treturn Promise.resolve();\r\n\t\t\t};\r\n\r\n            //帷幕\r\n\t\t\tconst curtain = (duration, delay) =>{\r\n\t\t\t    let screen1 = this.viewComponent.game.world.getByName('curtainscreen1')\r\n                let screen2 = this.viewComponent.game.world.getByName('curtainscreen2')\r\n                if(!screen1){\r\n                    screen1 = this.viewComponent.game.add.graphics(0,0);\r\n                    screen1.beginFill(0x000000);\r\n                    screen1.drawRect(0,0,this.viewComponent.game.width / 2,this.viewComponent.game.height);\r\n                    screen1.endFill();\r\n                    screen1.name = 'curtainscreen1';\r\n                }\r\n                if(!screen2){\r\n                    screen2 = this.viewComponent.game.add.graphics(0,0);\r\n                    screen2.beginFill(0x000000);\r\n                    screen2.drawRect(0,0,this.viewComponent.game.width / 2,this.viewComponent.game.height);\r\n                    screen2.endFill();\r\n                    screen2.name = 'curtainscreen2';\r\n                }\r\n                screen1.x = 0;\r\n                screen2.x = this.viewComponent.game.width / 2;\r\n                this.viewComponent.game.world.bringToTop(screen1);\r\n                this.viewComponent.game.world.bringToTop(screen2);\r\n                this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n                const promises = [];\r\n                promises.push(this.tweenToPromise(screen1,{x: - (this.viewComponent.game.width / 2)},duration,null,true,delay));\r\n                promises.push(this.tweenToPromise(screen2,{x: this.viewComponent.game.width},duration,null,true,delay));\r\n                return Promise.all(promises)\r\n            }\r\n\r\n            //交错\r\n            const interlacing = (duration, delay) =>{\r\n\t\t\t    let screen1 = this.viewComponent.game.world.getByName('interlacingscreen1');\r\n\t\t\t    let screen2 = this.viewComponent.game.world.getByName('interlacingscreen2');\r\n\t\t\t    const createScreen = (type)=>{\r\n                    let screen = this.viewComponent.game.add.graphics(0,0);\r\n                    screen.beginFill(0x000000,0);\r\n                    screen.drawRect(0,0,this.viewComponent.game.width,this.viewComponent.game.height);\r\n                    screen.endFill();\r\n                    const spase = (this.viewComponent.game.height / 6);\r\n                    const createmask = (__x,__y)=>{\r\n                        let mask = this.viewComponent.game.add.graphics(0,0);\r\n                        mask.beginFill(0x000000);\r\n                        mask.drawRect(0,0,this.viewComponent.game.width,spase);\r\n                        mask.endFill();\r\n                        mask.x = __x;\r\n                        mask.y = __y;\r\n                        return mask;\r\n                    }\r\n                    screen.addChild(createmask(0,spase * (type === 1 ? 0 : 1)))\r\n                    screen.addChild(createmask(0,spase * (type === 1 ? 2 : 3)))\r\n                    screen.addChild(createmask(0,spase * (type === 1 ? 4 : 5)))\r\n                    screen.name = 'interlacingscreen'+type;\r\n                    return screen;\r\n                }\r\n                if(!screen1){\r\n                    screen1 = createScreen(1);\r\n                }\r\n                if(!screen2){\r\n                    screen2 = createScreen(2);\r\n                }\r\n                screen1.x = 0;\r\n                screen2.x = 0;\r\n                this.viewComponent.game.world.bringToTop(screen1);\r\n                this.viewComponent.game.world.bringToTop(screen2);\r\n                this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n                const promises = [];\r\n                promises.push(this.tweenToPromise(screen1,{x: - (this.viewComponent.game.width)},duration,null,true,delay));\r\n                promises.push(this.tweenToPromise(screen2,{x: this.viewComponent.game.width},duration,null,true,delay));\r\n                return Promise.all(promises)\r\n            }\r\n\r\n            //遮黑\r\n            const coverblack =(duration, delay) =>{\r\n                let screen = this.viewComponent.game.world.getByName('coverblackscreen');\r\n                if(!screen){\r\n                    screen = this.viewComponent.game.add.graphics(0,0);\r\n                    screen.beginFill(0x000000);\r\n                    screen.drawRect(0,0,this.viewComponent.game.width,this.viewComponent.game.height);\r\n                    screen.endFill();\r\n                    screen.name = 'coverblackscreen';\r\n                }\r\n                screen.x = - this.viewComponent.game.width;\r\n                let bk_x = 0;\r\n                let bk_y = 0;\r\n                if(bkSprite){\r\n                    bk_x = bkSprite.x;\r\n                    bk_y = bkSprite.y;\r\n                }\r\n                if (this.sceneProxy.prePlotBkKey && this.viewComponent.game.load.cache.checkImageKey(this.sceneProxy.prePlotBkKey)) {\r\n                    if(bkSprite){\r\n                        //当前的背景图片存在，先替换上个剧情背景图片\r\n                        bkSprite = this.sceneProxy.curPlotLayer.create(bkSprite.x, bkSprite.y, this.sceneProxy.prePlotBkKey);\r\n                        bkSprite.alpha = this.sceneProxy.lstPlotBkOpacity === undefined ? 1 : this.sceneProxy.lstPlotBkOpacity;\r\n                        this.backgroundFlex(bkSprite, this.sceneProxy.lstPlotBkFlex);\r\n                        this.viewComponent.addGifAnimation(bkSprite, this.sceneProxy.lstPlotBkKey);\r\n                    }\r\n                }\r\n                this.viewComponent.game.world.bringToTop(screen);\r\n                this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n                const promises = [];\r\n                promises.push(this.tweenToPromise(screen,{x: 0},duration / 2,null,true,delay).then(() =>{\r\n                    bkSprite = this.sceneProxy.curPlotLayer.create(bk_x, bk_y, this.sceneProxy.lstPlotBkKey);//背景图片替换回去\r\n                    bkSprite.alpha = this.sceneProxy.lstPlotBkOpacity === undefined ? 1 : this.sceneProxy.lstPlotBkOpacity;\r\n                    this.backgroundFlex(bkSprite, this.sceneProxy.lstPlotBkFlex);\r\n                    this.viewComponent.addGifAnimation(bkSprite, this.sceneProxy.lstPlotBkKey);\r\n                    this.tweenToPromise(screen,{x: this.viewComponent.game.width},duration / 2,null,true,delay)\r\n                }))\r\n                return Promise.all(promises)\r\n            }\r\n\r\n            //展开\r\n            const spread =(duration, delay)=>{\r\n                const sceneProxy = this.sceneProxy;\r\n                let promises = [];\r\n                let visibleweather = false;\r\n                //记录原先的index\r\n                let plotindex = this.viewComponent.game.world.getChildIndex(sceneProxy.curPlotLayer);\r\n                let cnpindex = this.viewComponent.game.world.getChildIndex(sceneProxy.charsAndPropsLayer);\r\n                let dialogindex = this.viewComponent.game.world.getChildIndex(sceneProxy.dialogLayer);\r\n                if(this.sceneProxy.weatherLayer.visible){ this.sceneProxy.weatherLayer.visible = false;visibleweather = true;} //天气先关闭\r\n\r\n                const spreadgroup = this.viewComponent.game.add.group();\r\n                sceneProxy.curPlotLayer.snakename = 'spread';\r\n                spreadgroup.add(sceneProxy.curPlotLayer);\r\n                if (sceneProxy.charsAndPropsLayer && sceneProxy.charsAndPropsLayer.visible) {\r\n                    sceneProxy.charsAndPropsLayer.visible = true;\r\n                    spreadgroup.add(sceneProxy.charsAndPropsLayer);\r\n                }else{\r\n                    cnpindex = -1;\r\n                }\r\n                spreadgroup.add(sceneProxy.dialogLayer);\r\n                /*if (sceneProxy.dialogLayer.visible) {\r\n                    spreadgroup.add(sceneProxy.dialogLayer);\r\n                }else{\r\n                    dialogindex = -1;\r\n                }*/\r\n                this.sceneProxy.curPlotLayer.isSpreading = true;\r\n                let spreadmask = this.viewComponent.game.add.graphics(0,0);\r\n                spreadmask.beginFill(0);\r\n                spreadmask.drawRect(0,0,this.viewComponent.game.world.width,this.viewComponent.game.world.height);\r\n                spreadmask.endFill();\r\n                spreadgroup.add(spreadmask)\r\n                spreadgroup.mask = spreadmask;\r\n\r\n                const plotx = spreadgroup.x;\r\n                const ploty = spreadgroup.y;\r\n                const plotw = spreadgroup.width;\r\n                const ploth = spreadgroup.height;\r\n                spreadgroup.x = this.viewComponent.game.world.centerX;\r\n                spreadgroup.y = this.viewComponent.game.world.centerY;\r\n                spreadgroup.width = 0;\r\n                spreadgroup.height = 0;\r\n                this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n                promises.push(this.tweenToPromise(spreadgroup, {x:plotx,y:ploty,width:plotw,height:ploth}, duration, null, true, delay, 0, false).then(()=>{\r\n                    spreadgroup.x = plotx\r\n                    spreadgroup.y = ploty\r\n                    spreadmask && spreadmask.destroy();\r\n                    if(plotindex !== -1){this.viewComponent.game.world.addChildAt(sceneProxy.curPlotLayer,plotindex)}\r\n                    if(cnpindex !== -1){this.viewComponent.game.world.addChildAt(sceneProxy.charsAndPropsLayer,cnpindex)}\r\n                    if(dialogindex !== -1){this.viewComponent.game.world.addChildAt(sceneProxy.dialogLayer,dialogindex)}\r\n                    if(visibleweather){\r\n                        this.sceneProxy.weatherLayer.visible = true;\r\n                    }\r\n                    spreadgroup.destroy();\r\n                    this.sceneProxy.curPlotLayer.isSpreading = false;\r\n                }));\r\n                return Promise.all(promises)\r\n            }\r\n\r\n\t\t\t// 展示特效\r\n\t\t\tconst playEffect = animations => {\r\n\t\t\t\tconst promises = [];\r\n\t\t\t\tanimations.forEach(animation => {\r\n\t\t\t\t\tconst delay = this.sceneProxy.quickPlay ? 0 : animation.delay;\r\n\t\t\t\t\tconst duration = animation.duration  > 0 ? (this.sceneProxy.quickPlay ? 100 : animation.duration) : 0;\r\n\t\t\t\t\tif (animation.type === 'twinkle') {\r\n\t\t\t\t\t\tpromises.push(sceneTwinkle(duration, delay, animation.color));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (animation.type === 'shake') {\r\n\t\t\t\t\t    if(duration && duration > 0){\r\n                            promises.push(sceneShake(animation.level ? animation.level * 5 : 18, duration, delay));\r\n                        }\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (animation.type === 'fadein') {\r\n\t\t\t\t\t\tpromises.push(fadeIn(duration, delay).then(() => this.sceneProxy.doInCT(context, () => {\r\n\t\t\t\t\t\t\tthis.sceneProxy.lstPlotLayer && this.sceneProxy.lstPlotLayer.destroy();\r\n\t\t\t\t\t\t\tthis.sceneProxy.lstPlotLayer = null;\r\n\t\t\t\t\t\t\tthis.sceneProxy.lstPlotLayer = this.sceneProxy.curPlotLayer;\r\n\t\t\t\t\t\t})));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(animation.type === 'curtain'){\r\n                        //帷幕\r\n                        promises.push(curtain(duration, delay))\r\n                    }\r\n                    if(animation.type === 'interlacing'){\r\n                        //交错\r\n                        promises.push(interlacing(duration, delay))\r\n                    }\r\n                    if(animation.type === 'coverblack'){\r\n                        //遮黑\r\n                        promises.push(coverblack(duration, delay))\r\n                    }\r\n                    if(animation.type === 'spread'){\r\n                        //展开\r\n                        promises.push(spread(duration, delay))\r\n                    }\r\n\t\t\t\t});\r\n\t\t\t\treturn Promise.all(promises)\r\n\t\t\t};\r\n\r\n\t\t\t// 添加对话框\r\n\t\t\tconst addDialogLayer = (dialogInfo) => {\r\n\t\t\t\tconst {dialogLayer} = this.sceneProxy;\r\n\t\t\t\t// 对话框\r\n\t\t\t\tthis.addDialogLayer();\r\n\t\t\t\tconst {avatarContainer, titleContainer, content} = this.sceneProxy.json_data.template.json.dialog;\r\n\t\t\t\tconst dialog_bk = dialogLayer.getByName('dialog_bk');\r\n\t\t\t\tconst dialog_bk_avatar = dialogLayer.getByName('dialog_bk_avatar');\r\n\t\t\t\tconst dialog_avatar = dialogLayer.getByName('dialog_avatar');\r\n\t\t\t\tconst dialog_bk_title = dialogLayer.getByName('dialog_bk_title');\r\n\t\t\t\ttitleTxt = dialogLayer.getByName('dialog_text_title');\r\n\t\t\t\tcontentTxt = dialogLayer.getByName('dialog_text_content');\r\n\r\n\t\t\t\tif (dialog_bk) {\r\n\t\t\t\t\tdialog_bk.visible = !dialogInfo.speaking.hidden;\r\n\t\t\t\t}\r\n\t\t\t\tif (dialog_bk_avatar) {\r\n\t\t\t\t\tdialog_bk_avatar.visible = !dialogInfo.avatar.hidden;\r\n\t\t\t\t}\r\n\t\t\t\tif (dialog_bk_title) {\r\n\t\t\t\t\tdialog_bk_title.visible = !dialogInfo.dialogtitle.hidden;\r\n\t\t\t\t}\r\n\t\t\t\tdialog_avatar.visible = !dialogInfo.avatar.hidden;\r\n\t\t\t\ttitleTxt.visible = !dialogInfo.dialogtitle.hidden;\r\n\r\n\t\t\t\tthis.sceneProxy.dialogLayer.x = dialogInfo.speaking.x;\r\n\t\t\t\tthis.sceneProxy.dialogLayer.y = dialogInfo.speaking.y;\r\n\t\t\t\tthis.sceneProxy.dialogLayer.alpha = undefined === dialogInfo.speaking.opacity ? 1 : dialogInfo.speaking.opacity;\r\n\r\n\t\t\t\tif (this.viewComponent.game.load.cache.checkImageKey(dialogInfo.avatar.url)) {\r\n\t\t\t\t\tlet {x, y, width, height, clip} = avatarContainer.avatar;\r\n\t\t\t\t\tx = x + avatarContainer.rect.x;\r\n\t\t\t\t\ty = y + avatarContainer.rect.y;\r\n\r\n\t\t\t\t\tdialog_avatar.loadTexture(dialogInfo.avatar.url);\r\n\t\t\t\t\t//dialog_avatar.width = width;\r\n\t\t\t\t\t//dialog_avatar.height = height;\r\n\r\n                    const scale = Math.min(width * dialog_avatar.scale.x / dialog_avatar.width, height * dialog_avatar.scale.y / dialog_avatar.height);\r\n                    width = dialog_avatar.width / dialog_avatar.scale.x * scale;\r\n                    height = dialog_avatar.height / dialog_avatar.scale.y * scale;\r\n                    x = avatarContainer.avatar.x + avatarContainer.rect.x + (avatarContainer.avatar.width - width) / 2;\r\n                    y = avatarContainer.avatar.y + avatarContainer.rect.y + (avatarContainer.avatar.height - height) / 2;\r\n                    dialog_avatar.x = x;\r\n                    dialog_avatar.y = y;\r\n                    dialog_avatar.width = width;\r\n                    dialog_avatar.height = height;\r\n\r\n\t\t\t\t\tdialog_avatar.mask && dialog_avatar.mask.destroy();\r\n\t\t\t\t\tconst mask = this.viewComponent.game.add.graphics(0, 0);\r\n\t\t\t\t\tmask.beginFill();\r\n\t\t\t\t\tswitch (clip) {\r\n\t\t\t\t\t\tcase 'square':\r\n\t\t\t\t\t\t\tmask.drawRect(x, y, width, height);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'hexagon':\r\n\t\t\t\t\t\t\tconst poly = new Phaser.Polygon();\r\n\t\t\t\t\t\t\tpoly.setTo([new Phaser.Point(width / 2 + x, y),\r\n\t\t\t\t\t\t\t\tnew Phaser.Point(width / 2 + height / 4 * Math.pow(3, 1 / 2) + x, height / 4 + y),\r\n\t\t\t\t\t\t\t\tnew Phaser.Point(width / 2 + height / 4 * Math.pow(3, 1 / 2) + x, height / 4 * 3 + y),\r\n\t\t\t\t\t\t\t\tnew Phaser.Point(width / 2 + x, height + y),\r\n\t\t\t\t\t\t\t\tnew Phaser.Point(width / 2 - height / 4 * Math.pow(3, 1 / 2) + x, height / 4 * 3 + y),\r\n\t\t\t\t\t\t\t\tnew Phaser.Point(width / 2 - height / 4 * Math.pow(3, 1 / 2) + x, height / 4 + y)]);\r\n\t\t\t\t\t\t\tmask.drawPolygon(poly.points);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'heart':\r\n\t\t\t\t\t\t\tmask.moveTo(width / 2 + x, width / 4 + y);\r\n\t\t\t\t\t\t\tmask.bezierCurveTo(width * 3 / 4 + x, -width / 4 + y, width * 3 / 2 + x, width / 4 + y, width / 2 + x, width + y);\r\n\t\t\t\t\t\t\tmask.bezierCurveTo(-width / 2 + x, width / 4 + y, width / 4 + x, -width / 4 + y, width / 2 + x, width / 4 + y);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'round':\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tmask.drawCircle(x + width / 2, y + height / 2, width);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tmask.endFill();\r\n\t\t\t\t\tthis.sceneProxy.dialogLayer.add(mask);\r\n\t\t\t\t\tdialog_avatar.mask = mask;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst {font_size, color, bold, fontFamily, hidden} = dialogInfo.dialogtitle;\r\n\t\t\t\tconst titleStyle = titleContainer.title.text;\r\n\t\t\t\tfont_size && (titleStyle.fontSize = font_size);\r\n\t\t\t\tcolor && (titleStyle.color = color);\r\n\t\t\t\tbold !== undefined && (titleStyle.fontWeight = bold ? 'bold' : 'normal');\r\n                fontFamily ? titleStyle.fontFamily = fontFamily : this.sceneProxy.json_data.font ? titleStyle.fontFamily = this.sceneProxy.json_data.font.fontFamily : '';\r\n\t\t\t\thidden !== undefined && (titleStyle.hidden = hidden);\r\n\r\n\t\t\t\tlet ff = '';\r\n\t\t\t\tif (FontUtils.fontFamily) {\r\n\t\t\t\t    let txtImg = titleTxt.children[0];\r\n\t\t\t\t    let strText = Expression.parseValue(dialogInfo.dialogtitle.data, context);\r\n                    (color === '#ffffff' || color === '#fff') && (titleStyle.color = '#fefefe');\r\n                    if (txtImg) {\r\n                        txtImg.fontImg.destroy();\r\n                        txtImg.destroy();\r\n                    }\r\n                    txtImg = this.sceneProxy.addRetroText();\r\n                    titleTxt.addChild(txtImg);\r\n                    txtImg.fontImg.setText(strText ? strText : ' ', true, 0, 0, 'left', true);\r\n                    txtImg.tint = parseInt(titleStyle.color.replace('#', '0x'));\r\n                    const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(titleStyle.fontSize) : titleStyle.fontSize;\r\n                    const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(titleStyle.fontSize) : titleStyle.fontSize;\r\n\t\t\t\t    txtImg.width = fw * txtImg.fontImg.text.length;\r\n\t\t\t\t    txtImg.height = fh;\r\n\r\n                    const titleX = titleContainer.rect.x + titleContainer.title.rect.x + (titleContainer.title.rect.width - txtImg.width) / 2;\r\n                    const titleY = titleContainer.rect.y + titleContainer.title.rect.y;\r\n                    titleTxt.setTextBounds(titleX, titleY, titleContainer.title.rect.width, titleContainer.title.rect.height);\r\n                    titleTxt.text = ' ';\r\n                }\r\n                else {\r\n                    ff += titleStyle.fontWeight ? titleStyle.fontWeight + ' ' : 'normal ';\r\n                    ff += titleStyle.fontSize ? parseInt(titleStyle.fontSize) + 'px ' : '';\r\n                    ff += titleStyle.fontFamily ? titleStyle.fontFamily : '';\r\n\r\n                    titleTxt.setStyle({\r\n                        font: ff,\r\n                        fill: titleStyle.color,\r\n                        boundsAlignH: \"center\",\r\n                        boundsAlignV: \"middle\"\r\n                    });\r\n                    titleTxt.text = Expression.parseValue(dialogInfo.dialogtitle.data, context);\r\n\r\n                    const titleX = titleContainer.rect.x + titleContainer.title.rect.x;\r\n                    const titleY = titleContainer.rect.y + titleContainer.title.rect.y;\r\n                    titleTxt.setTextBounds(titleX\r\n                        , titleY + (titleTxt.height - parseInt(titleStyle.fontSize || 12)) / 2\r\n                        , titleContainer.title.rect.width\r\n                        , titleContainer.title.rect.height);\r\n\t\t\t\t}\r\n\r\n                ff = dialogInfo.speaking.font_size + '';\r\n\t\t\t\tif (ff.indexOf('px') < 0) {\r\n\t\t\t\t\tff = ff + 'px';\r\n\t\t\t\t}\r\n                if (dialogInfo.speaking.bold === true) {\r\n                    ff = 'bold ' + ff;\r\n                }\r\n\t\t\t\tff = ff + ' ' + (this.sceneProxy.json_data.font ? this.sceneProxy.json_data.font.fontFamily : dialogInfo.speaking.fontFamily ? dialogInfo.speaking.fontFamily : '');\r\n\t\t\t\tcontentTxt.style.font = ff;\r\n\t\t\t\tcontentTxt.style.fill = dialogInfo.speaking.color;\r\n\t\t\t\tcontentTxt.text = '';\r\n\t\t\t\tcontentTxt.top = content.rect.y;\r\n\t\t\t\tcontentTxt.lineSpacing = this.sceneProxy.txtLineSpace(dialogInfo.speaking.font_size);//- parseInt(plot.speaking.font_size) / 5;\r\n\r\n\t\t\t\tcontentTxt.mask && contentTxt.mask.destroy();\r\n\t\t\t\tconst mask = this.viewComponent.game.add.graphics(0, 0);\r\n\t\t\t\tmask.beginFill();\r\n\t\t\t\tmask.drawRect(content.rect.x,\r\n\t\t\t\t\tcontent.rect.y,\r\n\t\t\t\t\tcontent.rect.width,\r\n                    dialogInfo.speaking.hidden ? this.viewComponent.game.world.height : content.rect.height);\r\n\t\t\t\tmask.endFill();\r\n\t\t\t\tthis.sceneProxy.dialogLayer.add(mask);\r\n\t\t\t\tcontentTxt.mask = mask;\r\n                if(dialogInfo && dialogInfo.speaking && dialogInfo.speaking.animations && dialogInfo.speaking.animations.length > 0){ //对话框有动画时，先隐藏\r\n                    this.sceneProxy.dialogLayer.visible = false;\r\n                }\r\n\t\t\t\treturn Promise.resolve();\r\n\t\t\t};\r\n\r\n\t\t\t// 剧情音效\r\n\t\t\tconst playPlotSound = () => {\r\n\t\t\t\tlet sounds = plot.plot_sound;\r\n\t\t\t\tif (loadData) {\r\n                    sounds = loadData.sounds;\r\n\t\t\t\t}\r\n\t\t\t\tif (Object.prototype.toString.call(sounds) === '[object Array]') {\r\n\t\t\t\t\tfor (let item in sounds) {\r\n\t\t\t\t\t\tif (sounds[item]) {\r\n\t\t\t\t\t\t\tif (sounds[item].url === 'inherit') {\r\n\t\t\t\t\t\t\t\tthis.sceneProxy.playInheritSound(item, sounds[item].volume);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (this.viewComponent.game.load.cache.checkSoundKey(sounds[item].url)\r\n                                    || 'ios' === flashvars.client && flashvars.app_version >= '1.5.0') {\r\n\t\t\t\t\t\t\t\tthis.sceneProxy.stopSound(item, sounds[item].url,true);\r\n\t\t\t\t\t\t\t\tthis.sceneProxy.playSound(item, sounds[item].url, sounds[item].volume, sounds[item].time === 0);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tthis.sceneProxy.stopSound(item);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse if (this.viewComponent.game.load.cache.checkSoundKey(plot.plot_sound.url)\r\n                        || 'ios' === flashvars.client && flashvars.app_version >= '1.5.0') {\r\n\t\t\t\t\tthis.sceneProxy.playSound(0, plot.plot_sound.url, plot.plot_sound.volume, false);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// music\r\n\t\t\tconst playMusic = (music) => {\r\n\t\t\t\tif (!music.url || music.url === '') {\r\n\t\t\t\t\tthis.sceneProxy.stopMusic();\r\n\t\t\t\t}\r\n\t\t\t\telse if (music.url === 'inherit') {\r\n\t\t\t\t\tthis.sceneProxy.playInheritMusic(music.volume);\r\n\t\t\t\t}\r\n\t\t\t\telse if (this.viewComponent.game.load.cache.checkSoundKey(music.url)\r\n                        || 'ios' === flashvars.client && flashvars.app_version >= '1.5.0') {\r\n\t\t\t\t    let volume = music.volume;\r\n\t\t\t\t    if(music.inheritvolume !== undefined && music.inheritvolume !== -1){ volume = music.inheritvolume};\r\n\t\t\t\t\tthis.sceneProxy.stopMusic(music.url,true);\r\n\t\t\t\t\tthis.sceneProxy.playMusic(music.url, volume, music.time !== 1,false);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// 背景\r\n\t\t\tconst addBackground = (plotLayer) => {\r\n\t\t\t\t// 填充黑色背景\r\n\t\t\t\tbkSprite = this.viewComponent.game.add.graphics(0, 0, plotLayer);\r\n\t\t\t\tbkSprite.beginFill(0x0, 1);\r\n\t\t\t\tbkSprite.drawRect(0, 0, this.viewComponent.game.world.width, this.viewComponent.game.world.height);\r\n\t\t\t\tbkSprite.endFill();\r\n\r\n                if (plot.commands) {return;}\r\n\r\n                if (this.sceneProxy.lstGameBk && this.sceneProxy.lstGameBk.visible) {\r\n                    !plot.animations.filter(a => a.type === 'fadein').length && (this.sceneProxy.lstGameBk.visible = false);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst isInherit = plot.background.url === 'inherit';\r\n\t\t\t\tlet bk_alpha = isInherit ? this.sceneProxy.lstPlotBkOpacity : plot.background.opacity;\r\n                let bk_flex = isInherit ? this.sceneProxy.lstPlotBkFlex : plot.background.flex;\r\n\t\t\t\tlet bk_key = isInherit ? this.sceneProxy.lstPlotBkKey : plot.background.url;\r\n\t\t\t\t!isInherit && ResourcesManager.updateUsingKey({ type: 'background', key: bk_key });\r\n                if (!!bk_key) {\r\n                    this.sceneProxy.prePlotBkKey = this.sceneProxy.lstPlotBkKey;\r\n                    this.sceneProxy.lstPlotBkKey = bk_key;\r\n                    this.sceneProxy.lstPlotBkOpacity = bk_alpha;\r\n                    this.sceneProxy.lstPlotBkFlex = bk_flex;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.viewComponent.game.load.cache.checkImageKey(bk_key)) {\r\n                \tbkSprite.alpha = 0;\r\n                    bkSprite = plotLayer.create(plot.background.x, plot.background.y, bk_key);\r\n\t\t\t\t\tbkSprite.alpha = bk_alpha === undefined ? 1 : bk_alpha;\r\n\t\t\t\t\tthis.backgroundFlex(bkSprite, bk_flex);\r\n                    this.viewComponent.addGifAnimation(bkSprite, bk_key);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// 角色 & 道具\r\n\t\t\tconst addCharsProps = (characters, props, cmdUuid) => {\r\n\t\t\t\t/*if (!this.sceneProxy.charsAndPropsLayer || !this.sceneProxy.charsAndPropsLayer.exists) {\r\n                    this.sceneProxy.charsAndPropsLayer = this.viewComponent.game.add.group();\r\n                    this.sceneProxy.charsAndPropsLayer.name = \"charactersAndProps\";\r\n                }*/\r\n\t\t\t\tfor (let item of [...characters, ...props]) {\r\n\t\t\t\t\tconst ch = this.viewComponent.addFitImageSprint(item.x, item.y, item.width, item.height, item.url, this.sceneProxy.charsAndPropsLayer, item.index);\r\n\t\t\t\t\tch.alpha = item.opacity === undefined ? 1 : item.opacity;\r\n\t\t\t\t\tch.angle = parseInt(item.rotate) === 180 ? 179.9 : item.rotate || 0;\r\n\t\t\t\t\tch.data.animations = item.animations;\r\n\t\t\t\t\tch.cmdUuid = cmdUuid;\r\n\t\t\t\t\tthis.viewComponent.addGifAnimation(ch, item.url);\r\n\r\n\t\t\t\t\tif (item.mirrorH) {\r\n\t\t\t\t\t\tch.angle = -ch.angle;\r\n\t\t\t\t\t\tch.scale.x = -ch.scale.x;\r\n\t\t\t\t\t\tch.mirrorH = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (item.mirrorV) {\r\n\t\t\t\t\t\tch.angle = -ch.angle;\r\n\t\t\t\t\t\tch.scale.y = -ch.scale.y;\r\n\t\t\t\t\t\tch.mirrorV = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.viewComponent.game.world.bringToTop(this.sceneProxy.charsAndPropsLayer);\r\n\t\t\t\tif(this.sceneProxy.dialogLayer.visible && !this.sceneProxy.dialogLayer.isbottom){\r\n                    this.viewComponent.game.world.bringToTop(this.sceneProxy.dialogLayer);\r\n                }\r\n\t\t\t\t//如果天气存在，天气置顶\r\n                if(this.sceneProxy.weatherLayer.visible){this.viewComponent.game.world.bringToTop(this.sceneProxy.weatherLayer)};\r\n                if(this.sceneProxy.menuLayer.visible !== false){  this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);} //菜单置顶\r\n\t\t\t};\r\n\r\n\t\t\tconst cApAnimationIn = () => {\r\n\t\t\t\tconst promises = [];\r\n\t\t\t\tfor (let item of this.sceneProxy.charsAndPropsLayer.children) {\r\n\t\t\t\t\tfor (let a of item.data.animations) {\r\n\t\t\t\t\t\tif ((a.trigger === 'in' || a.trigger === 'animateIn') && !this.sceneProxy.quickPlay) {\r\n\t\t\t\t\t\t\tif (a.type === 'fadein') {\r\n\t\t\t\t\t\t\t\tpromises.push(this.tweenFromPromise(item, {alpha: 0}\r\n\t\t\t\t\t\t\t\t\t, a.duration\r\n\t\t\t\t\t\t\t\t\t, null, true\r\n\t\t\t\t\t\t\t\t\t, a.delay, 0, false))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (a.type === 'moveFrom') {\r\n\t\t\t\t\t\t\t\tlet x = item.mirrorH ? a.x - item.width/2 : a.x + item.width/2;\r\n\t\t\t\t\t\t\t\tlet y = item.mirrorV ? a.y - item.height/2 : a.y + item.height/2;\r\n\t\t\t\t\t\t\t\tpromises.push(this.tweenFromPromise(item, {x: x, y: y}\r\n\t\t\t\t\t\t\t\t\t, a.duration\r\n\t\t\t\t\t\t\t\t\t, null, true\r\n\t\t\t\t\t\t\t\t\t, a.delay, 0, false))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn Promise.all(promises);\r\n\t\t\t};\r\n\r\n\t\t\t// 选项\r\n\t\t\tconst addOptions = (txtOptions, condition_options) => {\r\n\t\t\t\tlet hasOption = false;\r\n\r\n                return new Promise((resolve, reject) => {\r\n\t\t\t\t\tif (plot.jump || plot.back || plot.insert) {\r\n\t\t\t\t\t\treturn resolve({type: 0})\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst condOptIndex = (condition_options || []).findIndex(option => Expression.safeEval(option.expression, context));\r\n\t\t\t\t\tconst condOpt = condOptIndex < 0 ? null : condition_options[condOptIndex];\r\n\t\t\t\t\tif (condOpt) {\r\n\t\t\t\t\t\treturn resolve({type: 2, index:condOptIndex});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet timerHandles = [];\r\n\t\t\t\t\tconst countDownPromises = [];\r\n\t\t\t\t\tfor (let i = 0; i < txtOptions.length; i++) {\r\n\t\t\t\t\t\tconst {rect, normal, active} = this.sceneProxy.json_data.template.json.option;\r\n\t\t\t\t\t\tlet {x, y, width, height} = rect;\r\n\t\t\t\t\t\tlet normal_bk_key = normal.background.url;\r\n\t\t\t\t\t\tlet active_bk_key = active.background.url;\r\n\t\t\t\t\t\tlet disable_bk_key = null;\r\n\t\t\t\t\t\tconst {font, timer, disable} = txtOptions[i];\r\n\r\n\t\t\t\t\t\tif (txtOptions[i].x !== undefined) {\r\n\t\t\t\t\t\t\tx = txtOptions[i].x;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (txtOptions[i].y !== undefined) {\r\n\t\t\t\t\t\t\ty = txtOptions[i].y;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (txtOptions[i].width !== undefined && txtOptions[i].hasOwnProperty(\"background\")) {\r\n\t\t\t\t\t\t\twidth = txtOptions[i].width;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (txtOptions[i].height !== undefined && txtOptions[i].hasOwnProperty(\"background\")) {\r\n\t\t\t\t\t\t\theight = txtOptions[i].height;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (txtOptions[i].background\r\n\t\t\t\t\t\t\t&& this.viewComponent.game.load.cache.checkImageKey(txtOptions[i].background.normal.url)) {\r\n\t\t\t\t\t\t\tnormal_bk_key = txtOptions[i].background.normal.url;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (txtOptions[i].background\r\n\t\t\t\t\t\t\t&& this.viewComponent.game.load.cache.checkImageKey(txtOptions[i].background.active.url)) {\r\n\t\t\t\t\t\t\tactive_bk_key = txtOptions[i].background.active.url;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (txtOptions[i].background && txtOptions[i].background.disable\r\n\t\t\t\t\t\t\t&& this.viewComponent.game.load.cache.checkImageKey(txtOptions[i].background.disable.url)) {\r\n\t\t\t\t\t\t\tdisable_bk_key = txtOptions[i].background.disable.url;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst onBtnClicked = (obj, pointer) => {\r\n\t\t\t\t\t\t\tfor (let t of timerHandles) {\r\n\t\t\t\t\t\t\t\tt.close();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (obj.chapter.plots.length > 0) {\r\n\t\t\t\t\t\t\t\tresolve({type: 1, index: i});\r\n                                this.sceneProxy.optionLayer.destroy();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tresolve({type: 3});\r\n                                this.sceneProxy.optionLayer.destroy();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tUtils.selOptions.push(txtOptions[i].uuid);\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tconst textInfo = {\r\n\t\t\t\t\t\t\tfontFamily: font.normal.fontFamily ? font.normal.fontFamily : this.sceneProxy.json_data.font ? this.sceneProxy.json_data.font.fontFamily : ''\r\n\t\t\t\t\t\t\t, fontSize: font.normal.font_size\r\n\t\t\t\t\t\t\t, fontWeight: font.normal.bold ? 'bold' : 'normal'\r\n\t\t\t\t\t\t\t, color: font.normal.color\r\n\t\t\t\t\t\t\t, hidden: font.normal.hidden\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tconst disabledTextInfo = {\r\n\t\t\t\t\t\t\tfontFamily: font.disable.fontFamily ? font.disable.fontFamily : this.sceneProxy.json_data.font ? this.sceneProxy.json_data.font.fontFamily : ''\r\n\t\t\t\t\t\t\t, fontSize: font.disable.font_size\r\n\t\t\t\t\t\t\t, fontWeight: font.disable.bold ? 'bold' : 'normal'\r\n\t\t\t\t\t\t\t, color: font.disable.color\r\n\t\t\t\t\t\t\t, hidden: font.disable.hidden\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tconst t = {};\r\n\t\t\t\t\t\tt.normal = textInfo;\r\n\t\t\t\t\t\tt.active = textInfo;\r\n\t\t\t\t\t\tt.text = txtOptions[i].name;\r\n\t\t\t\t\t\tlet op_sound;\r\n\t\t\t\t\t\tif (txtOptions[i].sound && this.viewComponent.game.load.cache.checkSoundKey(txtOptions[i].sound.url)) {\r\n\t\t\t\t\t\t\top_sound = this.viewComponent.game.add.sound(txtOptions[i].sound.url, txtOptions[i].sound.volume, false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst btng = this.viewComponent.addButton(x,\r\n\t\t\t\t\t\t\ty,\r\n\t\t\t\t\t\t\twidth,\r\n\t\t\t\t\t\t\theight,\r\n\t\t\t\t\t\t\tnormal_bk_key,\r\n\t\t\t\t\t\t\tactive_bk_key,\r\n\t\t\t\t\t\t\tonBtnClicked,\r\n\t\t\t\t\t\t\tt,\r\n\t\t\t\t\t\t\top_sound,\r\n\t\t\t\t\t\t\t'option',\r\n                            this.sceneProxy.optionLayer\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tconst btn = btng.getByName('button');\r\n\t\t\t\t\t\tconst txtObj = btng.getByName('text');\r\n\t\t\t\t\t\tbtn.chapter = {plots: txtOptions[i].plots ? txtOptions[i].plots : txtOptions[i].commands, parent: {pChapter: chapter, pnPlot: nPlot}};\r\n\r\n\t\t\t\t\t\tif (disable) {\r\n\t\t\t\t\t\t\tbtn.inputEnabled = false;\r\n\t\t\t\t\t\t\tbtng.changeBackground(disable_bk_key || normal_bk_key, disabledTextInfo);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (timer) {\r\n\t\t\t\t\t\t    this.sceneProxy.hasCountDown = true;\r\n\t\t\t\t\t\t\tconst countDown = () => {\r\n\t\t\t\t\t\t\t\treturn new Promise((resolve, reject) => {\r\n                                    let time = Expression.getGameValueByTimer(timer, context);\r\n\t\t\t\t\t\t\t\t\tif (!txtOptions[i].hideTimer) {\r\n                                        txtObj.text = txtOptions[i].name + `(${time})`;\r\n                                        if (FontUtils.fontFamily) {\r\n                                            const txtImgOld = txtObj.children[0];\r\n                                            if (txtImgOld) {\r\n                                                const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(textInfo.fontSize) : textInfo.fontSize;\r\n                                                const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(textInfo.fontSize) : textInfo.fontSize;\r\n                                                const w = fw * txtObj.text.length;\r\n                                                const x = (width - w) / 2;\r\n                                                const y = (height - fh) / 2;\r\n                                                this.sceneProxy.addImageFontText([{data: txtObj.text}], fw, fh, txtObj, context);\r\n                                                txtObj.children[0].x = x;\r\n                                                txtObj.children[0].y = y;\r\n                                                txtImgOld.children.forEach(item => item.fontImg.destroy());\r\n                                                txtImgOld.destroy();\r\n                                                txtObj.text = ' ';\r\n                                            }\r\n                                        }\r\n                                        else {\r\n                                        }\r\n\t\t\t\t\t\t\t\t\t}\r\n                                    const timerHandle = this.viewComponent.game.time.events.loop(Phaser.Timer.SECOND, () => {\r\n                                        time--;\r\n                                        if (!txtOptions[i].hideTimer) {\r\n                                            txtObj.text = txtOptions[i].name + `(${time})`;\r\n                                            if (FontUtils.fontFamily) {\r\n                                                const txtImgOld = txtObj.children[0];\r\n                                                if (txtImgOld) {\r\n                                                    const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(textInfo.fontSize) : textInfo.fontSize;\r\n                                                    const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(textInfo.fontSize) : textInfo.fontSize;\r\n                                                    const w = fw * txtObj.text.length;\r\n                                                    const x = (width - w) / 2;\r\n                                                    const y = (height - fh) / 2;\r\n                                                    this.sceneProxy.addImageFontText([{data: txtObj.text}], fw, fh, txtObj, context);\r\n                                                    txtObj.children[0].x = x;\r\n                                                    txtObj.children[0].y = y;\r\n                                                    txtImgOld.children.forEach(item => item.fontImg.destroy());\r\n                                                    txtImgOld.destroy();\r\n                                                    txtObj.text = ' ';\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                        if (time <= 0) {\r\n                                            txtObj.text = txtOptions[i].name;\r\n                                            if (FontUtils.fontFamily) {\r\n                                                const txtImgOld = txtObj.children[0];\r\n                                                if (txtImgOld) {\r\n                                                    const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(textInfo.fontSize) : textInfo.fontSize;\r\n                                                    const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(textInfo.fontSize) : textInfo.fontSize;\r\n                                                    const w = fw * txtObj.text.length;\r\n                                                    const x = (width - w) / 2;\r\n                                                    const y = (height - fh) / 2;\r\n                                                    this.sceneProxy.addImageFontText([{data: txtObj.text}], fw, fh, txtObj, context);\r\n                                                    txtObj.children[0].x = x;\r\n                                                    txtObj.children[0].y = y;\r\n                                                    txtImgOld.children.forEach(item => item.fontImg.destroy());\r\n                                                    txtImgOld.destroy();\r\n                                                    txtObj.text = ' ';\r\n                                                }\r\n                                            }\r\n                                            this.viewComponent.game.time.events.remove(timerHandle);\r\n                                            if ('disable' === timer.type) {\r\n                                                if (btn.alive) {\r\n                                                    btn.inputEnabled = false;\r\n                                                    btng.changeBackground(disable_bk_key || normal_bk_key, disabledTextInfo);\r\n                                                }\r\n                                                resolve(false);\r\n                                            } else {\r\n                                                if (btn.alive) {\r\n                                                    btn.inputEnabled = true;\r\n                                                    btn.input.useHandCursor = true;\r\n                                                    btng.changeBackground(normal_bk_key, textInfo);\r\n                                                }\r\n                                                resolve(true);\r\n                                            }\r\n                                        }\r\n                                    });\r\n\t\t\t\t\t\t\t\t\tconst close = () => {\r\n                                        this.viewComponent.game.time.events.remove(timerHandle);\r\n\t\t\t\t\t\t\t\t\t\tresolve(true);\r\n                                    };\r\n                                    timerHandles.push({close});\r\n                                    this.viewComponent.game.time.events.start();\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t};\r\n                            countDownPromises.push(countDown())\r\n\t\t\t\t\t\t} else {\r\n                            countDownPromises.push(Promise.resolve(!disable))\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\thasOption = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!hasOption) {\r\n\t\t\t\t\t\tresolve({type: 0});\r\n                        this.sceneProxy.optionLayer.destroy();\r\n\t\t\t\t\t}\r\n                    Promise.all(countDownPromises).then(results => {\r\n                        this.sceneProxy.hasCountDown = false;\r\n                        if (!results.some(r => !!r)) {\r\n                        \tresolve({type: 3})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\t// 天气\r\n\t\t\tconst addWeather = (type) => {\r\n\t\t\t\tthis.sceneProxy.weatherLayer.visible = false;\r\n\r\n\t\t\t\tfor (let n=0; n<this.sceneProxy.weatherLayer.children.length; n++) {\r\n\t\t\t\t\tconst {visible, name} = this.sceneProxy.weatherLayer.children[n];\r\n\t\t\t\t\tif (visible && name !== type) {\r\n                        this.sceneProxy.weatherLayer.children[n].destroy();\r\n                        n--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n                        this.sceneProxy.weatherLayer.children[n].visible = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (type === 'windy') {\r\n\t\t\t\t    if(flashvars.vertical){\r\n                        this.viewComponent.game.load.cache.checkImageKey(`/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"wind\")}/feng_00019.png`) && this.addWindEffect();\r\n                    }else{\r\n                        this.addWindEffect();\r\n                    }\r\n\t\t\t\t}\r\n\t\t\t\telse if (type === 'snowy') {\r\n                    this.viewComponent.game.load.cache.checkImageKey(`/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"snow\")}/xuehua_00119.png`) && this.addSnowEffect();\r\n\t\t\t\t}\r\n\t\t\t\telse if (type === 'rainy') {\r\n                    this.viewComponent.game.load.cache.checkImageKey(`/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"rain\")}/xiayu_00049.png`) && this.addRainEffect();\r\n\t\t\t\t}\r\n                else if (type === 'defoliation') {\r\n                    this.viewComponent.game.load.cache.checkImageKey(`/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"mapleLeaves\")}/fengye_00089.png`) && this.addFallingLeavesEffect();\r\n                }\r\n                else if (type === 'fallingPeach') {\r\n                    this.viewComponent.game.load.cache.checkImageKey(`/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"beachBlossom\")}/taohua_00089.png`) && this.addBeachBlossomEffect();\r\n                }\r\n                else if (type === 'fallingFlower') {\r\n                    this.viewComponent.game.load.cache.checkImageKey(`/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"blossom\")}/yinghua_00089.png`) && this.addBlossomEffect();\r\n                }\r\n                else if (type === 'lightning') {\r\n                    this.viewComponent.game.load.cache.checkImageKey(`/${Utils.getWeatherOfflinePathName()}/${Utils.getWeatherFilePathName(\"lightning\")}/shandian_00049.png`) && this.addLightningEffect();\r\n\t\t\t\t}\r\n\t\t\t\tthis.viewComponent.game.world.bringToTop(this.sceneProxy.weatherLayer);\r\n\t\t\t};\r\n\r\n\t\t\t// 剧情高级UI\r\n\t\t\tconst addPlotViews = (views, loadData, cmdUuid) => {\r\n                if (loadData) {\r\n                \t// 先过滤掉已不在剧情中的UI\r\n                    let ary = [];\r\n\t\t\t\t\tfor (let i=0; i<this.sceneProxy.plotViews.length; i++) {\r\n\t\t\t\t\t\tif (this.sceneProxy.plotViews[i].generateType === 'plotInfo') {\r\n\t\t\t\t\t\t    const found = (v)=>{\r\n\t\t\t\t\t\t        for (let i =0;i < views.length;i++){\r\n\t\t\t\t\t\t            if(v.name === views[i].ref){\r\n\t\t\t\t\t\t                return true;\r\n                                    }\r\n                                }\r\n                                return false;\r\n                            }\r\n                            if(!found(this.sceneProxy.plotViews[i])){ary.push(this.sceneProxy.plotViews[i])}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n                    for(let j=0;j <ary.length;j++ ){\r\n                        let index = this.sceneProxy.plotViews.indexOf(ary[j]);\r\n                        this.sceneProxy.plotViews.splice(index,1)\r\n                    }\r\n\r\n                    loadSubViews(this.sceneProxy.plotViews,true);\r\n                    this.sceneProxy.uiOnLoadQueue.splice(0);\r\n                    this.viewComponent.game.world.bringToTop(this.sceneProxy.plotViewsLayer);\r\n                    this.sceneProxy.plotViewsLayer.visible = false;\r\n                    return;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (let p in views) {\r\n\t\t\t\t\tthis.registerViewKey(views[p].ref, views[p].events, this.sceneProxy.plotViewKeys);\r\n\t\t\t\t\tlet sView = this.addView(this.sceneProxy.plotViewsLayer, views[p].ref, views[p].instanceUuid, views[p].x, views[p].y, views[p].events);\r\n\t\t\t\t\tif (!sView) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (views[p].scale) {\r\n\t\t\t\t\t\tsView.scale.set(views[p].scale, views[p].scale);\r\n\t\t\t\t\t\tsView.x += Expression.safeEval(views[p].x, context) * (1 - views[p].scale);\r\n\t\t\t\t\t\tsView.y += Expression.safeEval(views[p].y, context) * (1 - views[p].scale);\r\n\t\t\t\t\t\tthis.scaleInputView(sView, views[p].scale);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsView.generateType = cmdUuid ? cmdUuid : 'plotInfo';\t// 保存生成UI方式为剧情脚本\r\n                    this.sceneProxy.plotViews.push(sView);\r\n\t\t\t\t}\r\n\r\n                this.viewComponent.game.world.bringToTop(this.sceneProxy.plotViewsLayer);\r\n                this.uiOnLoadInvoker();\r\n\t\t\t\tthis.updateProgressView();\r\n                this.sceneProxy.plotViewsLayer.visible = false;\r\n            };\r\n\r\n\t\t\t// 全局高级UI\r\n\t\t\tconst showGlobalViews = (bLoadRec, hideGlobalViews) => {\r\n                let refUuidToHide = [];\r\n\t\t\t\tfor (let p in hideGlobalViews) {\r\n\t\t\t\t\tfor (let q in this.sceneProxy.json_data.views) {\r\n\t\t\t\t\t\tif (hideGlobalViews[p] === this.sceneProxy.json_data.views[q].instanceUuid) {\r\n\t\t\t\t\t\t\trefUuidToHide[this.sceneProxy.json_data.views[q].ref] = (this.sceneProxy.json_data.views[q].ref);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n                if (bLoadRec && this.sceneProxy.globalViews) {\r\n\t\t\t\t\tconst found =(id) =>{\r\n\t\t\t\t\t    for(let i =0;i <this.sceneProxy.json_data.views.length;i++){\r\n\t\t\t\t\t        if(id === this.sceneProxy.json_data.views[i].instanceUuid){\r\n\t\t\t\t\t            return true;\r\n                            }\r\n                        }\r\n\t\t\t\t\t    return false;\r\n                    }\r\n                    let ary = [];\r\n                    for(let i = 0;i < this.sceneProxy.globalViews.length;i++){\r\n\t\t\t\t\t    if(!found(this.sceneProxy.globalViews[i].instanceUuid)){\r\n                            ary.push(this.sceneProxy.globalViews[i]);//不存在\r\n                        }\r\n                    }\r\n                    for(let j=0;j <ary.length;j++ ){\r\n                        if(ary[j].isGlobal === true){\r\n                            let index = this.sceneProxy.globalViews.indexOf(ary[j]);\r\n                            this.sceneProxy.globalViews.splice(index,1)\r\n                        }\r\n                    }\r\n                    loadSubViews(this.sceneProxy.globalViews,true);\r\n\r\n                    for (let p in this.sceneProxy.globalViews) {\r\n                    \tthis.viewComponent.game.world.bringToTop(this.sceneProxy.globalViews[p]);\r\n                        if (refUuidToHide[this.sceneProxy.globalViews[p].name]) {\r\n                            this.sceneProxy.globalViews[p].visible = false;\r\n                            this.showInputView(this.sceneProxy.globalViews[p], false);\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    this.addGlobalView(refUuidToHide);\r\n                }\r\n                this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n\t\t\t};\r\n\r\n\t\t\t// 读档子UI\r\n\t\t\tconst loadSubViews = (savedSubView,isload = false) => {\r\n\t\t\t\tthis.sceneProxy.timerCounts = [];\t// 清空\r\n\t\t\t\tconst fixTimerCount = (items) => {\r\n\t\t\t\t\tfor (let i=0; i<items.length; i++) {\r\n\t\t\t\t\t\tconst item = items[i];\r\n\t\t\t\t\t\tif (item.currentCount) {\r\n\t\t\t\t\t\t\tthis.sceneProxy.timerCounts[this.sceneProxy.timerCounts.length] = {name: item.name, parent: item.parent, currentCount:item.currentCount};\r\n\t\t\t\t\t\t}\r\n                        fixTimerCount(item.children);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tconst fixViewEventsInfo = (items) => {\r\n\t\t\t\t\t// 还原外部事件\r\n\t\t\t\t\tfor (let i=0; i<items.length; i++) {\r\n\t\t\t\t\t\tif (items[i].eventsInfo) {\r\n\t\t\t\t\t\t\t// 若已有信息，说明是从h5中读取的存档，不需要再获取外部事件\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (let j=0; j<plot.views.length; j++) {\r\n\t\t\t\t\t\t\tif (plot.views[j].ref === items[i].name) {\r\n\t\t\t\t\t\t\t\titems[i].eventsInfo = plot.views[j].events.concat();\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tfixTimerCount(savedSubView);\r\n\t\t\t\t!plot.commands && fixViewEventsInfo(savedSubView);\r\n\t\t\t\tfor (let i=0; i<savedSubView.length; i++) {\r\n\t\t\t\t\tconst item = savedSubView[i];\r\n\t\t\t\t\tconst parent = item.parent === '__world' ? null : this.viewComponent.game.world.getByName(item.parent);\r\n                    const view = this.addView(parent, item.name, item.instanceUuid, item.xInfo, item.yInfo, item.eventsInfo,false,isload)\r\n                    //删除\r\n                    const deleteSubView = (itemInfo, parentView) =>{\r\n                        //在记录数据中是否存在\r\n                        const promises = [];\r\n                        const foundinItem = (v,item)=>{\r\n                            let ary = item.children ? item.children.concat() : [];\r\n                            for(let i = 0;i < ary.length;i++){\r\n                                if(ary[i] && (v.name === ary[i].name && v.instanceUuid === ary[i].instanceUuid)){\r\n                                    return true;//找到\r\n                                }\r\n                            }\r\n                            return false;\r\n                        }\r\n                        let tempRefer = parentView.children ? parentView.children.concat() : [];\r\n                        for(let j=0;j < tempRefer.length;j++){\r\n                            if(!foundinItem(tempRefer[j],itemInfo)){\r\n                                //没找到  删除\r\n                                promises.push(this.destroyView(tempRefer[j].name));\r\n                            }\r\n                        }\r\n                        return Promise.all(promises);\r\n                    }\r\n                    const createSubView = (itemInfo, parentView) => {\r\n                        deleteSubView(itemInfo, parentView).then(()=>{\r\n                            if(itemInfo && itemInfo.children.length <= 0){\r\n                                return; //记录数据中不存在children  无需增加\r\n                            }\r\n                            let tempRefer = parentView.children ? parentView.children.concat():[];\r\n                            const foundTemp = (v,ary)=>{ // 原始数据中查找\r\n                                for(let i = 0;i < ary.length;i++){\r\n                                    if((v.name && ary[i].name && v.name === ary[i].name) && (v.instanceUuid && ary[i].instanceUuid && v.instanceUuid === ary[i].instanceUuid)){\r\n                                        return ary[i];//找到\r\n                                    }\r\n                                }\r\n                                return false;\r\n                            }\r\n                            //add\r\n                            const addSubView = (sv)=>{\r\n                                let subView = this.addView(parentView, sv.name, sv.instanceUuid\r\n                                    , sv.xInfo, sv.yInfo, sv.eventsInfo,false,isload);\r\n                                if (parentView.xInfo && parentView.yInfo && subView) {\r\n                                    subView.x += this.sceneProxy.Expression.safeEval(parentView.xInfo, this.sceneProxy.context);\r\n                                    subView.y += this.sceneProxy.Expression.safeEval(parentView.yInfo, this.sceneProxy.context);\r\n                                }\r\n                                subView && createSubView(sv, subView);\r\n                            }\r\n                            //增加  记录的数据 在原始数据中不存在的时 增加\r\n                            for (let i=0; i<itemInfo.children.length; i++) {\r\n                                let iv = itemInfo.children[i];\r\n                                let result = foundTemp(itemInfo.children[i],tempRefer)\r\n                                if(result === false){\r\n                                    addSubView(iv);\r\n                                }else{\r\n                                    //找到相同，查看他的子对象是否有不相同\r\n                                    createSubView(iv, result);\r\n                                }\r\n                            }\r\n                        })\r\n                    };\r\n\r\n\t\t\t\t\tif (!view) {\r\n                        savedSubView.splice(i--, 1);\r\n                        continue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcreateSubView(item, view);\r\n                    view.scale.set(item.scale.x, item.scale.y);\r\n                    view.x = item.x;\r\n                    view.y = item.y;\r\n                    this.scaleInputView(view, item.scale.x);\r\n\r\n                    view.visible = item.visible;\r\n                    savedSubView[i] = view;\r\n\t\t\t\t\tif (parent) {\r\n\t\t\t\t\t\tparent.add(view);\r\n                    }\r\n                    else {\r\n\t\t\t\t\t\tview.isGlobal = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.closePlayAdButton();\r\n\t\t\t};\r\n\r\n\t\t\t// 音乐淡入\r\n\t\t\tconst musicIn = () => {\r\n\t\t\t\tif (plot.music.animation && (plot.music.animation.type === 'fadeinfadeout' || plot.music.animation.type === 'fadein'))\r\n\t\t\t\t{\r\n                    if (this.sceneProxy.bk_music) {\r\n                        if(this.sceneProxy.bk_music.prevolume === 0){\r\n                            this.sceneProxy.bk_music.prevolume = this.sceneProxy.bk_music.volume;\r\n                            this.sceneProxy.bk_music.inheritvolume = this.sceneProxy.bk_music.volume;\r\n                        }\r\n                        this.sceneProxy.bk_music.volume = this.sceneProxy.bk_music.prevolume * Utils.musicVolume\r\n                        return this.tweenFromPromise(this.sceneProxy.bk_music, {volume:0}, this.sceneProxy.quickPlay ? 10 : 1000, null, true, 0, 0, false)\r\n                    }\r\n                    else if ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n                    \treturn PhoneUtils.tweenFromMusic(0, this.sceneProxy.quickPlay ? 10 : 1000, 0);\r\n                    }\r\n                }\r\n\t\t\t\treturn Promise.resolve();\r\n\t\t\t};\r\n\r\n\t\t\t// 音乐淡出\r\n\t\t\tconst musicOut = (action) => {\r\n\t\t\t    if (plot.music.animation && (plot.music.animation.type === 'fadeinfadeout' || plot.music.animation.type === 'fadeout'))\r\n                {\r\n                    if (this.sceneProxy.bk_music) {\r\n                        return new Promise((resolve, reject) => {\r\n                            const tween = this.viewComponent.game.add.tween(this.sceneProxy.bk_music).to({volume:0}, this.sceneProxy.quickPlay ? 10 : 1000, null, true, 0, 0, false);\r\n                            tween.onComplete.add(() => {\r\n                                this.sceneProxy.bk_music.volume *= Utils.musicVolume;\r\n                                resolve(action)\r\n                            });\r\n                        })\r\n                    }\r\n                    else if ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n                        return PhoneUtils.tweenToMusic(0, this.sceneProxy.quickPlay ? 10 : 1000, 0);\r\n                    }\r\n                }\r\n\r\n\t\t\t\treturn Promise.resolve(action);\r\n\t\t\t};\r\n\r\n\t\t\tconst dialogIn = (animations) => {\r\n                this.sceneProxy.dialogLayer.visible = true;\r\n\t\t\t\tif (!animations.length) {\r\n\t\t\t\t\treturn Promise.resolve();\r\n\t\t\t\t}\r\n\t\t\t\tconst In = animations.filter(a => a.type === 'fadein');\r\n\t\t\t\tconst From = animations.filter(a => a.type === 'moveFrom');\r\n\r\n\t\t\t\tconst fadeIn = () => {\r\n\t\t\t\t\tif (In.length) {\r\n\t\t\t\t\t\treturn this.tweenFromPromise(this.sceneProxy.dialogLayer, {alpha:0}, In[0].duration, null, true, In[0].delay, 0, false);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tconst moveFrom = () => {\r\n\t\t\t\t\tif (From.length) {\r\n\t\t\t\t\t\treturn this.tweenFromPromise(this.sceneProxy.dialogLayer, {x:From[0].x, y:From[0].y}, From[0].duration, null, true, From[0].delay, 0, false);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\treturn Promise.all([fadeIn(), moveFrom()]);\r\n\t\t\t};\r\n\r\n\t\t\tconst dialogOut = (animations) => {\r\n\t\t\t\tif (!animations.length) {\r\n\t\t\t\t\treturn Promise.resolve();\r\n\t\t\t\t}\r\n\t\t\t\tconst Out = animations.filter(a => a.type === 'fadeout');\r\n\t\t\t\tconst To = animations.filter(a => a.type === 'moveTo');\r\n\r\n\t\t\t\tconst fadeOut = () => {\r\n\t\t\t\t\tif (Out.length) {\r\n\t\t\t\t\t\treturn this.tweenToPromise(this.sceneProxy.dialogLayer, {alpha:0}, Out[0].duration, null, true, Out[0].delay, 0, false);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tconst moveTo = () => {\r\n\t\t\t\t\tif (To.length) {\r\n\t\t\t\t\t\treturn this.tweenToPromise(this.sceneProxy.dialogLayer, {x:To[0].x, y:To[0].y}, To[0].duration, null, true, To[0].delay, 0, false);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\treturn Promise.all([fadeOut(), moveTo()]);\r\n\t\t\t};\r\n\r\n\t\t\tconst animateIn = () => {\r\n\t\t\t\treturn this.sceneProxy.doInCT(context, () => playEffect(plot.animations.filter(a => a.trigger === 'in')))\r\n\t\t\t\t\t.then(() => {\r\n                        this.sceneProxy.charsAndPropsLayer && (this.sceneProxy.charsAndPropsLayer.visible = true);\r\n                        this.sceneProxy.plotViewsLayer.visible = true;\r\n\t\t\t\t\t\treturn this.sceneProxy.doInCT(context, () => Promise.all([cApAnimationIn() ,playEffect(plot.animations.filter(a => a.trigger === 'animateIn')),dialogIn(plot.speaking.animations.filter(a => a.trigger === 'animateIn'))]))\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(() => this.sceneProxy.doInCT(context, () => playEffect(plot.animations.filter(a => a.trigger === 'animateInEnd'))))\r\n\t\t\t};\r\n\r\n\t\t\tconst animateOut = action => {\r\n\t\t\t\tconst promises = [];\r\n\t\t\t\tfor (let item of this.sceneProxy.charsAndPropsLayer.children) {\r\n\t\t\t\t\tfor (let a of item.data.animations) {\r\n\t\t\t\t\t\tif ((a.trigger === 'out' || a.trigger === 'animateOut') && !this.sceneProxy.quickPlay) {\r\n\t\t\t\t\t\t\tif (a.type === 'fadeout') {\r\n\t\t\t\t\t\t\t\tpromises.push(this.tweenToPromise(item, {alpha: 0}\r\n\t\t\t\t\t\t\t\t\t, a.duration\r\n\t\t\t\t\t\t\t\t\t, null, true\r\n\t\t\t\t\t\t\t\t\t, a.delay, 0, false))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (a.type === 'moveTo') {\r\n\t\t\t\t\t\t\t    let xStep = item.scale.x < 0 ? -item.width/2 : item.width/2;\r\n\t\t\t\t\t\t\t    let yStep = item.scale.y < 0 ? -item.height/2 : item.height/2;\r\n\t\t\t\t\t\t\t\tpromises.push(this.tweenToPromise(item, {x: a.x + xStep, y: a.y + yStep}\r\n\t\t\t\t\t\t\t\t\t, a.duration\r\n\t\t\t\t\t\t\t\t\t, null, true\r\n\t\t\t\t\t\t\t\t\t, a.delay, 0, false))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn this.sceneProxy.doInCT(context, () => Promise.all(promises))\r\n\t\t\t};\r\n\r\n\t\t\tconst pauseSpeaking = remain => {\r\n\t\t\t\tif (\"\\\\\" === remain[0]) {\r\n\t\t\t\t\tlet pause = /\\\\(\\d+)\\s([\\s\\S]*)/.exec(remain);\r\n\t\t\t\t\tif (pause) {\r\n\t\t\t\t\t\treturn Utils.timeout(this.sceneProxy.quickPlay ? 0 : pause[1])\r\n\t\t\t\t\t\t\t.then(() => pauseSpeaking(remain.slice(pause[1].length + 2)));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (this.sceneProxy.playPause) {\r\n\t\t\t\t\treturn Utils.timeout(1000)\r\n\t\t\t\t\t\t.then(() => pauseSpeaking(remain));\r\n\t\t\t\t}\r\n\t\t\t\treturn Promise.resolve(remain)\r\n\t\t\t};\r\n\r\n\t\t\tconst contextScrollToBottom = (bSpeakHidden, bottom) => {\r\n\t\t\t\tconst {content} = this.sceneProxy.json_data.template.json.dialog;\r\n\t\t\t\tconst maxHeight = bSpeakHidden ? this.viewComponent.game.world.height : content.rect.height;\r\n\t\t\t\tconst n = bottom - maxHeight;\r\n\t\t\t\tif (n > 0) {\r\n\t\t\t\t\tcontentTxt.top = -n + content.rect.y;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tconst animationSpeak = (current, remain, context, speed, bSpeakHidden) => {\r\n                if (FontUtils.fontFamily) {\r\n                    const textShow = current;\r\n                    let nLine = 0;      // 换行符数\r\n                    current.replace(/[\\n]/g, function(m, i) {nLine++;});\r\n                    if (textShow.length && textShow.length - nLine > 0) {\r\n                        const index = textShow.length - nLine - 1;\r\n                        const mask = contentTxt.children[1];\r\n                        const posInfo = contentTxt.posInfo;\r\n                        if (posInfo[index]) {\r\n                            mask.x = posInfo[index].x + posInfo[index].space;\r\n                            mask.y = posInfo[index].y;\r\n                            contextScrollToBottom(bSpeakHidden, posInfo[index].bottomInText);\r\n                            contentTxt.setText(' ', true);\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    const textShow = this.viewComponent.game.device.desktop ? current : current.replace(new RegExp(' ', 'gm'), '  ');\r\n                    contentTxt.setText(textShow, true);\r\n                    contextScrollToBottom(bSpeakHidden, contentTxt.height);\r\n                }\r\n\t\t\t\treturn pauseSpeaking(remain)\r\n\t\t\t\t\t.then((remain) => {\r\n\t\t\t\t\t\treturn this.sceneProxy.doInCT(context, () => Utils.timeout(speed).then(() => {\r\n\t\t\t\t\t\t\tif (isShowAll) {\r\n\t\t\t\t\t\t\t\treturn Promise.reject();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (!remain) {\r\n\t\t\t\t\t\t\t\treturn Promise.resolve();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn this.sceneProxy.doInCT(context, () => animationSpeak(current + (remain[0] ? remain[0] : ''), remain.slice(1), context, speed, bSpeakHidden))\r\n\t\t\t\t\t\t}))\r\n\t\t\t\t\t})\r\n\t\t\t};\r\n\r\n\t\t\tconst doSpeak = (speakInfo, showImmediate) => {\r\n                let data = '';\r\n                if (Expression.isArray(speakInfo.data)) {\r\n                    for (let i=0; i<speakInfo.data.length; i++) {\r\n                        data += Expression.parseValue(speakInfo.data[i].data, context);\r\n                    }\r\n                    // 设置颜色\r\n                    this.sceneProxy.addImageFontTextColors(speakInfo.data, contentTxt, context);\r\n                }\r\n                else {\r\n                    data = Expression.parseValue(speakInfo.data, context);\r\n                }\r\n                if (data.length && data[data.length-1] === '\\n') {\r\n                    data = data.substring(0, data.length-1);\r\n                }\r\n                if (FontUtils.fontFamily) {\r\n                    const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(speakInfo.font_size) : speakInfo.font_size;\r\n                    const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(speakInfo.font_size) : speakInfo.font_size;\r\n                    this.sceneProxy.addImageFontText(speakInfo.data, fw, fh, contentTxt, context, true, speakInfo.hidden);\r\n                }\r\n                if (showImmediate || speakInfo.immediate) {\r\n                    if (FontUtils.fontFamily) {\r\n                        contentTxt.children[1] && (contentTxt.children[1].y = contentTxt.imgFBottom);\r\n                        contentTxt.text = ' ';\r\n                        contextScrollToBottom(speakInfo.hidden, contentTxt.imgFBottom);\r\n                    }\r\n                    else {\r\n                        let txt = Expression.parseWaitTime(data);\r\n                        contentTxt.text = this.viewComponent.game.device.desktop ? txt : txt.replace(new RegExp(' ', 'gm'), '  ');\r\n                    }\r\n                    return Promise.resolve();\r\n                }\r\n\r\n                isShowAll = false;\r\n                const clickProxy = new Promise((resolve, reject) => {\r\n                    this.sceneProxy.curPlotLayer.onChildInputDown.add((params, pointer) => {\r\n                        if (params === 'auto' || pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n                            return;\r\n                        }\r\n                        resolve()\r\n                    });\r\n                });\r\n                const keyProxy = new Promise((resolve, reject) => {\r\n                    this.sceneProxy.space_key.onDown.add(() => {resolve()});\r\n                });\r\n                return this.sceneProxy.doInCT(context, () => Promise.race([animationSpeak(\"\", data, context, this.sceneProxy.quickPlay ? 0 : parseInt(speakInfo.speed), speakInfo.hidden), clickProxy, keyProxy]))\r\n                    .then(() => {\r\n                        isShowAll = true;\r\n                        this.sceneProxy.curPlotLayer.onChildInputDown.removeAll();\r\n                        this.sceneProxy.space_key.onDown.removeAll();\r\n                        if (FontUtils.fontFamily) {\r\n                            contentTxt.children[1] && (contentTxt.children[1].y = contentTxt.imgFBottom);\r\n                            contextScrollToBottom(speakInfo.hidden, contentTxt.imgFBottom);\r\n                            contentTxt.setText(' ', true);\r\n                        }\r\n                        else {\r\n                            let txt = Expression.parseWaitTime(data);\r\n                            contentTxt.text = this.viewComponent.game.device.desktop ? txt : txt.replace(new RegExp(' ', 'gm'), '  ');\r\n                            contextScrollToBottom(speakInfo.hidden, contentTxt.height);\r\n                        }\r\n                    })\r\n\t\t\t};\r\n\r\n            const playWait = (time, action) => {\r\n                const waitTime = this.sceneProxy.quickPlay ? 10 : (time < 10 ? 10 : time);\r\n                return Utils.timeout(waitTime).then(() => {\r\n                    if (this.sceneProxy.playPause) {\r\n                        return playWait(500, action);\r\n                    }\r\n                    return Promise.resolve(action)\r\n                });\r\n            };\r\n\r\n\t\t\tconst savePlayBackContent = (info) => {\r\n\t\t\t    let speakData = '';\r\n                if (Object.prototype.toString.call(info.speaking.data) === '[object Array]') {\r\n                    for (let i=0; i<info.speaking.data.length; i++) {\r\n                        speakData += info.speaking.data[i].data;\r\n                    }\r\n                }\r\n                else {\r\n                    speakData = info.speaking.data;\r\n                }\r\n\t\t\t\tspeakData = speakData.replace(/\\n/g,\"\");\r\n                let data = info.dialogtitle.hidden || info.dialogtitle.data === '' ? speakData : info.dialogtitle.data + ':' + speakData;\r\n                data && this.sceneProxy.addPlayBackContent(Expression.parseWaitTime(Expression.parseValue(data, context)));\r\n\t\t\t};\r\n\r\n\t\t\tconst play = () => {\r\n\t\t\t\tif (!plot) {\t// 该章节无剧情\r\n\t\t\t\t\treturn this.showNextPlot(context, chapter, nPlot);\r\n\t\t\t\t}\r\n\t\t\t\tconst playNormal = () => {\r\n                    this.sceneProxy.curCmdUuid = '';\r\n                    this.sceneProxy.context.disableSaveOrLoad = plot.disableSaveOrLoad ? plot.disableSaveOrLoad : {save: false, load: false};\r\n                    // 保存对话内容\r\n\t\t\t\t\tlet dialogInfo = {avatar: plot.avatar, dialogtitle: plot.dialogtitle, speaking: plot.speaking};\r\n                    if (plot.speaking.data && !loadData) {\r\n                    \tsavePlayBackContent(plot);\r\n                    }\r\n\r\n                    // 显示菜单\r\n                    if (!plot.menu.hidden) {\r\n                    \tif (this.sceneProxy.json_data.template.json.shanyiMenu) {\r\n                            this.addMenuLayer(true);\r\n                        } else {\r\n                    \t\tthis.addMenuLayer(false);\r\n                            this.sceneProxy.menuLayer.x = plot.menu.x;\r\n                            this.sceneProxy.menuLayer.y = plot.menu.y;\r\n\t\t\t\t\t\t}\r\n                    }\r\n                    if (!plot.animations.find(a => a.type === 'fadein')) {\r\n                        this.sceneProxy.lstPlotLayer && this.sceneProxy.lstPlotLayer.destroy();\r\n                        this.sceneProxy.lstPlotLayer = this.sceneProxy.curPlotLayer;\r\n                        ResourcesManager.updateUsingKey({ type: 'preBackground', key: this.sceneProxy.lstPlotBkKey });\r\n                    }\r\n                    playPlotSound();\r\n                    playMusic(loadData ? loadData.music : plot.music);\r\n                    addBackground(this.sceneProxy.curPlotLayer);\r\n                    const nromalnext = ()=>{\r\n                        if (plot.speaking.coverage === 'bottom') {\r\n                            addDialogLayer(dialogInfo);\r\n                            addCharsProps(plot.characters, plot.props);\r\n                            addWeather(plot.weather.value);\r\n                            this.sceneProxy.dialogLayer.isbottom = true;//底部属性\r\n                        } else {\r\n                            addCharsProps(plot.characters, plot.props);\r\n                            addWeather(plot.weather.value);\r\n                            addDialogLayer(dialogInfo);\r\n                            this.sceneProxy.dialogLayer.isbottom = false;//底部属性\r\n                        }\r\n                        // 选项置顶\r\n                        this.sceneProxy.optionLayer && this.viewComponent.game.world.bringToTop(this.sceneProxy.optionLayer);\r\n                        this.sceneProxy.charsAndPropsLayer && (this.sceneProxy.charsAndPropsLayer.visible = false);\r\n                        this.sceneProxy.isScreenHold && this.viewComponent.game.world.bringToTop(this.sceneProxy.quickPlayLayer);\r\n                        addPlotViews(plot.views, loadData);\r\n                        showGlobalViews(loadData !== null && loadData !== undefined, plot.hideGlobalViews);\r\n                        if (this.sceneProxy.json_data.default_settings && this.sceneProxy.json_data.default_settings.autoSaveOrLoad && plot.autoSaveOrLoad && plot.autoSaveOrLoad.type === 1 && !loadData) {\r\n                            if (this.sceneProxy.loadRecord(0)) {\r\n                                return;\r\n                            } else {\r\n                                return Dialog.warn(\"Sorry~读不到存档内容，即将返回封面\").then(() => {\r\n                                    return this.sceneProxy.reStart(this.sceneProxy.isExtend())\r\n                                }, () => {\r\n                                    return this.sceneProxy.reStart(this.sceneProxy.isExtend())\r\n                                })\r\n                            }\r\n                        }\r\n                        this.sceneProxy.shakeLoopObj.duration = -1;\r\n\r\n                        return Promise.all([animateIn(),musicIn()])\r\n                            .then(() => {\r\n                                this.sceneProxy.lstGameBk && (this.sceneProxy.lstGameBk.visible = false);\r\n                                return doSpeak(plot.speaking)\r\n                            })\r\n                            .then(() => {\r\n                                if (this.sceneProxy.json_data.default_settings && this.sceneProxy.json_data.default_settings.autoSaveOrLoad && plot.autoSaveOrLoad && plot.autoSaveOrLoad.type === 0) {\r\n                                    this.sceneProxy.getSnap();\r\n                                    this.sceneProxy.saveRecord(0, true);\r\n                                }\r\n                                return addOptions(plot.options, plot.condition_options)\r\n                            })\r\n                            .then(action => {\r\n                                const hasView = this.sceneProxy.plotViewsLayer.children.length > 0;\r\n                                return new Promise((resolve, reject) => {\r\n                                    if (action.type === 0 || action.type === 2) {\r\n                                        if ((plot.autotext || (!hasView && (this.sceneProxy.quickPlay || context.auto))) && !this.sceneProxy.playPause) { // 自动播放下一剧情\r\n                                            resolve(action);\r\n                                        } else {\r\n                                            const onClick = (o, e) => {\r\n                                                if (e && e.pointerMode === Phaser.PointerMode.CURSOR && e.button !== 0 || 'auto' === o && hasView) {\r\n                                                    return;\r\n                                                }\r\n                                                this.sceneProxy.curPlotLayer.onChildInputDown.remove(onClick);\r\n                                                if ('insertPlot' === o)  {\r\n                                                    reject();\r\n                                                } else {\r\n                                                    resolve(action)\r\n                                                }\r\n                                            };\r\n                                            this.sceneProxy.curPlotLayer.onChildInputDown.dispose();//移除上一个监听\r\n                                            this.sceneProxy.curPlotLayer.onChildInputDown.add(onClick);\r\n                                            !hasView && this.sceneProxy.space_key.onDown.addOnce(() => resolve(action));\r\n                                        }\r\n                                    } else {\r\n                                        resolve(action)\r\n                                    }\r\n                                })\r\n                            })\r\n                            .then(action => playWait(plot.wait.value, action))\r\n                            .then(action => {\r\n                                return Promise.all([animateOut(action), musicOut(action), dialogOut(plot.speaking.animations.filter(a => a.trigger === 'animateOut'))])\r\n                                    .then(() => this.sceneProxy.doInCT(context, () => {\r\n                                        return Promise.resolve(action)\r\n                                    }))\r\n                            })\r\n                            .then(action => {\r\n                                if (action.type === 1) {\r\n                                    this.showNextPlot(context, chapter, nPlot, \"option\", action.index)\r\n                                } else {\r\n                                    this.showNextPlot(context, chapter, nPlot)\r\n                                }\r\n                            }, e => {\r\n                                //失败\r\n                                Promise.reject(e);\r\n                            });\r\n                    }\r\n                    this.sceneProxy.updatePayValue(context,plot.values).then((rs)=>{\r\n                        if(rs === true){\r\n                            this.sceneProxy.valueOperation(context, plot.values,false,()=>{\r\n                                nromalnext();\r\n                            });\r\n                        }else{\r\n                            nromalnext();\r\n                        }\r\n                    })\r\n\r\n\t\t\t\t};\r\n\t\t\t\tconst playCommands = () => {\r\n\t\t\t\t    let isRecover = false;//是否为恢复存档\r\n\t\t\t\t\tlet hideGlobalViews = [];\r\n\t\t\t\t\tlet curborder = null;//当前气泡边框\r\n                    this.sceneProxy.isGoToCommand = true;\r\n\t\t\t\t\tconst recoverCmdSnap = (snapInfo, commands, index,animateScene = null) => {\r\n\t\t\t\t\t    return new Promise((resolve,reject) =>{\r\n                            if(animateScene && animateScene.shake){\r\n                                //恢复振动\r\n                                const screencommands = animateScene.shake;\r\n                                this.sceneProxy.shakeLoopObj.loop = screencommands.args[0].loop;\r\n                                this.sceneProxy.shakeLoopObj.level = screencommands.args[0].level;\r\n                                this.sceneProxy.shakeLoopObj.duration = screencommands.args[0].duration;\r\n                                this.sceneProxy.shakeLoopObj.delay = screencommands.args[0].delay;\r\n                                this.sceneProxy.shakeLoopObj.commands = screencommands;//记录当前的指令\r\n                                const doShake = ()=>{\r\n                                    this.sceneProxy.curPlotLayer.isShaking = true;\r\n                                    return sceneShake(screencommands.args[0].level ? screencommands.args[0].level * 5 : 18, screencommands.args[0].duration, screencommands.args[0].delay).then(()=>{\r\n                                        this.sceneProxy.curPlotLayer.isShaking = false;\r\n                                        if(screencommands.args[0].loop && screencommands.args[0].level > 0 && this.sceneProxy.shakeLoopObj.loop){\r\n                                            //喜欢振动 时间延迟设为0\r\n                                            screencommands.args[0].delay = 0;\r\n                                            return doShake();\r\n                                        }else{\r\n                                            return Promise.resolve();\r\n                                        }\r\n                                    });\r\n                                }\r\n                                doShake().then(()=>{\r\n                                    //\r\n                                    this.sceneProxy.curPlotLayer.isShaking = false;\r\n                                })\r\n                            }\r\n                            if (!snapInfo.music || ResourcesManager.usingKeyMap.music === '') { //声音中断\r\n                                this.sceneProxy.stopMusic();\r\n                            }\r\n                            if (snapInfo.music && (this.viewComponent.game.load.cache.checkSoundKey(snapInfo.music.url)\r\n                                    || 'ios' === flashvars.client && flashvars.app_version >= '1.5.0')) {\r\n                                let volume = snapInfo.music.volume;\r\n                                if(snapInfo.music.inheritvolume !== undefined && snapInfo.music.inheritvolume !== -1){volume = snapInfo.music.inheritvolume}\r\n                                this.sceneProxy.stopMusic(snapInfo.music.url);\r\n                                this.sceneProxy.playMusic(snapInfo.music.url, volume, true);\r\n                            }\r\n\r\n                            for (let item in snapInfo.sounds) {\r\n                                if (snapInfo.sounds[item] && ResourcesManager.usingKeyMap.sounds[item] !== '') { //音效没有被中断\r\n                                    if (this.viewComponent.game.load.cache.checkSoundKey(snapInfo.sounds[item].url)\r\n                                        || 'ios' === flashvars.client && flashvars.app_version >= '1.5.0') {\r\n                                        let volume = snapInfo.sounds[item].volume;\r\n                                        if(snapInfo.sounds[item].inheritvolume !== undefined && snapInfo.sounds[item].inheritvolume !== -1){volume = snapInfo.sounds[item].inheritvolume}\r\n                                        this.sceneProxy.stopSound(item, snapInfo.sounds[item].url,true);\r\n                                        this.sceneProxy.playSound(item, snapInfo.sounds[item].url, volume, snapInfo.sounds[item].time === 0);\r\n                                    }\r\n                                }\r\n                                else {\r\n                                    this.sceneProxy.stopSound(item);\r\n                                }\r\n                            }\r\n\r\n                            !snapInfo.bk && (snapInfo.bk = {opacity: 0});\r\n                            bkSprite = this.sceneProxy.curPlotLayer.create(0, 0, snapInfo.bk.url);\r\n                            bkSprite.alpha = snapInfo.bk.opacity;\r\n                            bkSprite.width = this.viewComponent.game.world.width;\r\n                            bkSprite.height = this.viewComponent.game.world.height;\r\n                            this.viewComponent.addGifAnimation(bkSprite, snapInfo.bk.url);\r\n                            if (!this.sceneProxy.charsAndPropsLayer || !this.sceneProxy.charsAndPropsLayer.exists) {\r\n                                this.sceneProxy.charsAndPropsLayer = this.viewComponent.game.add.group();\r\n                                this.sceneProxy.charsAndPropsLayer.name = \"charactersAndProps\";\r\n                            }\r\n                            for (let item of snapInfo.charsAndProps) {\r\n                        \tconst x = item.x;\r\n                        \tconst y = item.y;\r\n                            item.width = Math.abs(item.width)\r\n                            item.height = Math.abs(item.height)\r\n                            if (item.pivotX && item.pivotY) {\r\n                                item.x -= item.width / 2;\r\n                                item.y -= item.height / 2;\r\n                            }\r\n                            const ch = this.viewComponent.addFitImageSprint(item.x, item.y, Math.abs(item.width), item.height, item.url, this.sceneProxy.charsAndPropsLayer, item.index);\r\n                        \tch.alpha = item.opacity;\r\n                            ch.angle = item.rotate;\r\n                            if (item.pivotX) {\r\n                                ch.scale.x = item.scaleX;\r\n                                ch.scale.y = item.scaleY;\r\n                                ch.x = x;\r\n                                ch.y = y;\r\n                                if (item.mirrorH) ch.mirrorH = true;\r\n                                if (item.mirrorV) ch.mirrorV = true;\r\n                            }else {\r\n                                if (item.mirrorH) {\r\n                                    ch.angle = -ch.angle;\r\n                                    ch.scale.x = -ch.scale.x;\r\n                                    ch.mirrorH = true;\r\n                                }\r\n                                if (item.mirrorV) {\r\n                                    ch.angle = -ch.angle;\r\n                                    ch.scale.y = -ch.scale.y;\r\n                                    ch.mirrorV = true;\r\n                                }\r\n                            }\r\n                                //\r\n                                ch.cmdUuid = item.cmdUuid;\r\n                                if (item.parentScale) {\r\n                                    ch.parent.scale.setTo(item.parentScale, item.parentScale);\r\n                                }\r\n                                this.viewComponent.addGifAnimation(ch, item.url);\r\n                            }\r\n                            this.sceneProxy.weatherType !== '' && addWeather(snapInfo.weatherType);\r\n                            this.sceneProxy.bCmdAutoText = snapInfo.autoText;\r\n\r\n                            if (snapInfo.dialogInfo[0] && (index >= commands.length || index < commands.length && commands[index].type !== 'showDialog')) {\r\n                                addDialogLayer(snapInfo.dialogInfo[0]);\r\n                                doSpeak(snapInfo.dialogInfo[0].speaking, true);\r\n                                //let txt = Expression.parseWaitTime(Expression.parseValue(snapInfo.dialogInfo[0].speaking.data, context));\r\n                                //contentTxt.text = this.viewComponent.game.device.desktop ? txt : txt.replace(new RegExp(' ', 'gm'), '  ');\r\n                            } else {\r\n                                this.sceneProxy.dialogLayer.visible = false;\r\n                            }\r\n                            const recbubble = ()=>{\r\n                                isRecover = true;\r\n                                if (this.sceneProxy.bubbleLayer.children.length > 0) {\r\n                                    this.sceneProxy.bubbleLayer.removeAll(true);\r\n                                }\r\n                                return new Promise((resolve,reject)=> {\r\n                                    //恢复气泡\r\n                                    const addborder = (i)=>{\r\n                                        if(this.sceneProxy.saveBubbleVector[i]){\r\n                                            let bordercommands = this.sceneProxy.saveBubbleVector[i].commands;\r\n                                            let id = hasborder(bordercommands.args[0].index);\r\n                                            const border = this.addBubbleBorder(this.sceneProxy.bubbleLayer, bordercommands);\r\n                                            if(id !==-1){\r\n                                                const saveary = this.sceneProxy.saveBubbleVector[id].savebubble.concat();\r\n                                                const curary = this.sceneProxy.saveBubbleVector[id].curbubble.concat();\r\n                                                const hide = this.sceneProxy.saveBubbleVector[i].ishide;\r\n                                                const iscurrent = this.sceneProxy.saveBubbleVector[i].iscurrent;\r\n                                                this.sceneProxy.saveBubbleVector[id] = border;\r\n                                                border.savebubble = saveary.concat();\r\n                                                border.curbubble = curary.concat();\r\n                                                border.ishide = hide;\r\n                                                border.iscurrent = iscurrent;\r\n                                                border.itemlength = 0;\r\n                                                border.visible = (border.ishide === false);\r\n                                            }else{\r\n                                                this.sceneProxy.saveBubbleVector.push(border);\r\n                                                border.savebubble = [];\r\n                                                border.curbubble = [];\r\n                                                border.itemlength = 0;\r\n                                            }\r\n                                            border.iscurrent && (curborder = border);\r\n                                            return Promise.resolve(border)\r\n                                        }else{\r\n                                            return Promise.reject();\r\n                                        }\r\n                                    }\r\n\r\n                                    const addbubble = (j,border)=>{\r\n                                        if(border.savebubble[j]){\r\n                                            let bubblecommands = border.savebubble[j];\r\n                                            return this.createBubble(bubblecommands, border).then((b)=>{\r\n                                                j ++;\r\n                                                return addbubble(j,border);\r\n                                            })\r\n                                        }else{\r\n                                            return Promise.resolve();\r\n                                        }\r\n                                    }\r\n                                    let i = 0;\r\n                                    let j = 0;\r\n                                    const recover = (i)=>{\r\n                                        return addborder(i).then((b) =>{\r\n                                            j =0;\r\n                                            return addbubble(j,b).then(()=>{\r\n                                                i++;\r\n                                                return recover(i)\r\n                                            })\r\n                                        },()=>{\r\n                                            //全部加完\r\n                                            return resolve();\r\n                                        })\r\n                                    }\r\n                                    return recover(i);\r\n                                })\r\n                            }\r\n                            const recViews = ()=>{\r\n                                this.sceneProxy.removeViewTimer(this.sceneProxy.plotViewsLayer);\r\n                                this.sceneProxy.removeInputView(this.sceneProxy.plotViewsLayer);\r\n                                this.sceneProxy.plotViewsLayer.removeAll(true);\r\n                                this.sceneProxy.filterInexistentPlotViews(snapInfo.plotViews, plot);\r\n                                this.removeViewKey(this.sceneProxy.plotViewKeys);\r\n                                loadSubViews(snapInfo.plotViews);\r\n                                this.viewComponent.game.world.bringToTop(this.sceneProxy.plotViewsLayer);\r\n                                for (let i in this.sceneProxy.globalViews) {\r\n                                    if (!this.sceneProxy.globalViews[i].visible) {\r\n                                        for (let q in this.sceneProxy.json_data.views) {\r\n                                            if (this.sceneProxy.json_data.views[q].ref === this.sceneProxy.globalViews[i].name) {\r\n                                                hideGlobalViews[i] = (this.sceneProxy.json_data.views[q].instanceUuid);\r\n                                                break;\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                                showGlobalViews(true, hideGlobalViews);\r\n                            }\r\n                            const recMenu = ()=>{\r\n                                if (snapInfo.menuInfo[0]) {\r\n                                    this.addMenuLayer(false);\r\n                                    this.sceneProxy.menuLayer.x = snapInfo.menuInfo[0].x;\r\n                                    this.sceneProxy.menuLayer.y = snapInfo.menuInfo[0].y;\r\n                                }\r\n                            }\r\n                            return recbubble().then(()=>{\r\n                                recViews();\r\n                                recMenu();\r\n                                return resolve();\r\n                            })\r\n                        })\r\n\r\n                    };\r\n\t\t\t\t\t//查找已有气泡 是否存在\r\n                    const hasborder = (index)=>{\r\n                        if(this.sceneProxy.saveBubbleVector.length > 0){\r\n                            for(let i = 0;i <this.sceneProxy.saveBubbleVector.length;i++ ){\r\n                                if(parseInt(this.sceneProxy.saveBubbleVector[i].index) === parseInt(index) && this.sceneProxy.saveBubbleVector[i]){\r\n                                    return i;\r\n                                }\r\n                            }\r\n                        }\r\n                        return -1;\r\n                    };\r\n                    const resetBorder = () =>{\r\n                        this.sceneProxy.saveBubbleVector.forEach((b,index)=>{b.iscurrent = false});\r\n                    }\r\n\t\t\t\t\tconst handle = (cmdInfo, i) =>{\r\n                        let action = {type: ''};\r\n                        this.sceneProxy.curCmdInfo = cmdInfo;\r\n                        this.sceneProxy.curCmdIndex = i;\r\n\r\n\t\t\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\t\t    if ('systemUI' === cmdInfo.commands[i].type || 'jump' === cmdInfo.commands[i].type\r\n                                || 'back' === cmdInfo.commands[i].type || 'insert' === cmdInfo.commands[i].type) {\r\n\t\t\t\t\t\t\t    this.sceneProxy.cmdPlotNextPromise = null;\r\n                            }\r\n                            else if ('showDialog' === cmdInfo.commands[i].type) {\r\n\t\t\t\t\t\t        const nextCmdCallback = (a) => {\r\n                                    let pointer = new Phaser.Pointer(this.viewComponent.game, 1, Phaser.PointerMode.CURSOR);\r\n                                    pointer.button = 0;\r\n                                    this.sceneProxy.curPlotLayer.onChildInputDown.dispatch('nextCmd', pointer);\r\n                                    this.sceneProxy.curPlotLayer.onChildInputDown.dispatch('nextCmd', pointer);\r\n                                    resolve(a);\r\n                                };\r\n\t\t\t\t\t\t        this.sceneProxy.cmdPlotNextPromise = nextCmdCallback;\r\n                            }\r\n                            else {\r\n                                this.sceneProxy.cmdPlotNextPromise = resolve;\r\n                            }\r\n\r\n                            const commands = cmdInfo.commands;\r\n                            const args = commands[i].args;\r\n                            this.sceneProxy.curCmdUuid = commands[i].uuid;\r\n                            switch (commands[i].type) {\r\n                                case 'addView':\r\n                                    addPlotViews(args, null, commands[i].uuid);\r\n                                    this.sceneProxy.plotViewsLayer.visible = true;\r\n                                    this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n                                    if(this.sceneProxy.isScreenHold || this.sceneProxy.quickPlay){ //快进状态，暂停\r\n                                        this.sceneProxy.isScreenHold = false;\r\n                                        this.sceneProxy.quickPlay = false;\r\n                                        this.sceneProxy.quickPlayLayer.alpha = 0;\r\n                                        const onClick = (o, e) => {\r\n                                            if (e && e.pointerMode === Phaser.PointerMode.CURSOR && e.button !== 0 || 'auto' === o ) {\r\n                                                return;\r\n                                            }\r\n                                            this.sceneProxy.quickPlayLayer.alpha = 0;\r\n                                            this.sceneProxy.curPlotLayer.onChildInputDown.remove(onClick)\r\n                                            playHandler(this.sceneProxy.curCmdInfo,this.sceneProxy.curCmdIndex + 1);\r\n                                        };\r\n                                        this.sceneProxy.curPlotLayer.onChildInputDown.dispose();\r\n                                        this.sceneProxy.curPlotLayer.onChildInputDown.add(onClick);\r\n                                        this.sceneProxy.space_key.onDown.addOnce(() => { playHandler(this.sceneProxy.curCmdInfo,this.sceneProxy.curCmdIndex + 1)});\r\n                                        return reject();\r\n                                    }\r\n                                    break;\r\n                                case 'delView':\r\n                                    this.destroyView(args[0]);\r\n                                    break;\r\n\t\t\t\t\t\t\t\tcase 'systemUI':\r\n\t\t\t\t\t\t\t\t\tif (args[0] === 'save-record') {\r\n                                        const disableSaveOrLoad = this.sceneProxy.context.disableSaveOrLoad;\r\n                                        if (disableSaveOrLoad && disableSaveOrLoad.save) {\r\n                                            this.sceneProxy.showToast(1, '抱歉，作者在此设置了禁用存档');\r\n                                            return resolve(action);\r\n                                        }\r\n                                        !this.sceneProxy.mainMenuLayer.visible && this.sceneProxy.getSnap();\r\n                                        this.sceneProxy.showSave(false, {callbackFun:resolve, callbackArgs: action});\r\n                                        return;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse if (args[0] === 'load-record') {\r\n                                        const disableSaveOrLoad = this.sceneProxy.context.disableSaveOrLoad;\r\n                                        if (disableSaveOrLoad && disableSaveOrLoad.load) {\r\n                                            this.sceneProxy.showToast(1, '抱歉，作者在此设置了禁用读档');\r\n                                            return resolve(action);\r\n                                        }\r\n                                        this.sceneProxy.showLoad(false, {callbackFun:resolve, callbackArgs: action});\r\n                                        return;\r\n\t\t\t\t\t\t\t\t\t}\r\n                                    else if (args[0] === 'settings') {\r\n                                        this.sceneProxy.showSettings(context,{callbackFun:resolve, callbackArgs: action});\r\n                                        return;\r\n\t\t\t\t\t\t\t\t\t}\r\n                                    else if (args[0] === 'playback') {\r\n                                        this.sceneProxy.showPlayback({callbackFun:resolve, callbackArgs: action});\r\n                                        return;\r\n\t\t\t\t\t\t\t\t\t}\r\n                                case 'addImage':\r\n                                \tif (args[0].index === 1) {\r\n                                \t\tconst isInherit = args[0].url === 'inherit';\r\n                                        let bk_key = isInherit ? this.sceneProxy.lstPlotBkKey : args[0].url;\r\n                                        let bk_flex = isInherit ? this.sceneProxy.lstPlotBkFlex : args[0].flex;\r\n                                        let bk_alpha = isInherit ? this.sceneProxy.lstPlotBkOpacity : args[0].opacity;\r\n                                        if (this.viewComponent.game.load.cache.checkImageKey(bk_key)) {\r\n                                            let old = this.sceneProxy.curPlotLayer.children.splice(1, 1);\r\n                                            old.length && old[0].destroy();\r\n                                            bkSprite = this.sceneProxy.curPlotLayer.create(args[0].x, args[0].y, bk_key);\r\n                                            bkSprite.alpha = bk_alpha === undefined ? 1 : bk_alpha;\r\n                                            this.backgroundFlex(bkSprite, bk_flex);\r\n                                            if (this.sceneProxy.lstGameBk && this.sceneProxy.lstGameBk.visible) {this.sceneProxy.lstGameBk.visible = false;}\r\n                                            this.sceneProxy.prePlotBkKey = this.sceneProxy.lstPlotBkKey;\r\n                                            this.sceneProxy.lstPlotBkKey = bk_key;\r\n                                            this.sceneProxy.lstPlotBkOpacity = bk_alpha;\r\n                                            this.sceneProxy.lstPlotBkFlex = bk_flex;\r\n                                            this.viewComponent.addGifAnimation(bkSprite, args[0].url);\r\n                                        }\r\n\t\t\t\t\t\t\t\t\t}\r\n                                \telse {\r\n                                        addCharsProps(args, [], commands[i].uuid);\r\n\t\t\t\t\t\t\t\t\t}\r\n                                    this.viewComponent.game.world.bringToTop(this.sceneProxy.bubbleLayer);\r\n                                    this.viewComponent.game.world.bringToTop(this.sceneProxy.plotViewsLayer);\r\n                                    showGlobalViews(false, hideGlobalViews);\r\n                                    this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n                                    this.sceneProxy.isScreenHold && this.viewComponent.game.world.bringToTop(this.sceneProxy.quickPlayLayer);\r\n                                    break;\r\n                                case 'delImage':\r\n                                \tif (1 === args[0]) {\r\n                                        let old = this.sceneProxy.curPlotLayer.children.splice(1, 1);\r\n                                        old.length && old[0].destroy();\r\n\t\t\t\t\t\t\t\t\t} else {\r\n                                        for (let i=0; i<this.sceneProxy.charsAndPropsLayer.children.length; i++) {\r\n                                            let rs = this.sceneProxy.charsAndPropsLayer.getAt(i);\r\n                                            if (-1 === rs) break;\r\n                                            if (rs.zIndex === args[0]) {\r\n                                                this.sceneProxy.charsAndPropsLayer.removeChildAt(i);\r\n                                                rs.destroy();\r\n                                                break;\r\n                                            }\r\n                                        }\r\n\t\t\t\t\t\t\t\t\t}\r\n                                    break;\r\n                                case 'showMenu':\r\n                                    this.sceneProxy.menuInfo = args.concat();\r\n                                    this.addMenuLayer(false);\r\n                                    this.sceneProxy.menuLayer.x = args[0].x;\r\n                                    this.sceneProxy.menuLayer.y = args[0].y;\r\n                                    break;\r\n                                case 'hideMenu':\r\n                                    this.sceneProxy.menuInfo = [];\r\n                                    this.sceneProxy.menuLayer.visible = false;\r\n                                    break;\r\n                                case 'showGlobalView':\r\n                                    for (let i=0; i<hideGlobalViews.length; i++) {\r\n                                        if (hideGlobalViews[i] === args[0]) {\r\n                                            hideGlobalViews.splice(i, 1);\r\n                                            break;\r\n                                        }\r\n                                    }\r\n                                    showGlobalViews(false, hideGlobalViews);\r\n                                    break;\r\n                                case 'hideGlobalView':\t{\r\n                                    let i = 0;\r\n                                    for (; i<hideGlobalViews.length; i++) {\r\n                                        if (hideGlobalViews[i] === args[0]) break;\r\n                                    }\r\n                                    if (i >= hideGlobalViews.length) hideGlobalViews[i] = args[0];\r\n                                }\r\n                                    showGlobalViews(false, hideGlobalViews);\r\n                                    break;\r\n                                case 'showDialog':\r\n                                    this.sceneProxy.lstDialogInfo = args.concat();\r\n                                    this.sceneProxy.dialogLayer.animateTweens.forEach((t,i) => {t.stop()});\r\n                                    this.sceneProxy.dialogLayer.animateTweens.splice(0);\r\n                                    savePlayBackContent(args[0]);\r\n                                    return addDialogLayer(args[0])\r\n                                        .then(() => {\r\n                                            if (args[0].speaking.coverage && args[0].speaking.coverage === 'bottom') {\r\n                                                this.viewComponent.game.world.bringToTop(this.sceneProxy.charsAndPropsLayer);\r\n                                                this.viewComponent.game.world.bringToTop(this.sceneProxy.bubbleLayer);\r\n                                                this.viewComponent.game.world.bringToTop(this.sceneProxy.weatherLayer);\r\n                                                this.sceneProxy.dialogLayer.isbottom = true;//底部属性\r\n                                            }else{\r\n                                                this.viewComponent.game.world.bringToTop(this.sceneProxy.dialogLayer);\r\n                                                this.viewComponent.game.world.bringToTop(this.sceneProxy.weatherLayer);\r\n                                                this.sceneProxy.dialogLayer.isbottom = false;//底部属性\r\n                                            }\r\n                                            if(args[0].speaking.animations && args[0].speaking.animations.length > 0){ // 普通剧情转高级剧情时，对话框动画内容会嵌入数据，动画无效\r\n                                                this.sceneProxy.dialogLayer.visible = true;\r\n                                            }\r\n\r\n                                            this.viewComponent.game.world.bringToTop(this.sceneProxy.plotViewsLayer);\r\n                                            showGlobalViews(false, hideGlobalViews);\r\n                                            return doSpeak(args[0].speaking)\r\n                                        })\r\n                                        .then(() => {\r\n                                            const hasView = this.sceneProxy.plotViewsLayer.children.length > 0;\r\n                                            const hasBubble = this.sceneProxy.bubbleLayer.children.length > 0;\r\n                                            if ((this.sceneProxy.bCmdAutoText || (!hasView && (this.sceneProxy.quickPlay || this.sceneProxy.context.auto))) && !this.sceneProxy.playPause) { // 自动播放下一指令\r\n                                                Utils.timeout(100).then(()=>{return resolve(action)}); //自动播放时，点击出现对话乱闪bug，添加timeout 100\r\n                                            } else {\r\n                                                const onClick = (o, e) => {\r\n                                                    if (e && e.pointerMode === Phaser.PointerMode.CURSOR && e.button !== 0 || 'auto' === o && hasView ) {\r\n                                                        return;\r\n                                                    }\r\n                                                    this.sceneProxy.curPlotLayer.onChildInputDown.remove(onClick);\r\n                                                    if ('insertPlot' === o)  {\r\n                                                        return reject();\r\n                                                    } else {\r\n                                                        return resolve(action)\r\n                                                    }\r\n                                                };\r\n                                                this.sceneProxy.curPlotLayer.onChildInputDown.dispose();//移除上一个监听\r\n                                                this.sceneProxy.curPlotLayer.onChildInputDown.add(onClick);\r\n                                                if(hasBubble){\r\n                                                    this.sceneProxy.dialogNext = ()=>{\r\n                                                        this.sceneProxy.dialogNext = null;\r\n                                                        return resolve(action)\r\n                                                    }\r\n                                                }\r\n                                                //hasBubble && this.sceneProxy.dialogLayer.onChildInputDown.addOnce(onClick)\r\n                                                !hasView && this.sceneProxy.space_key.onDown.addOnce(() => {return resolve(action)});\r\n                                            }\r\n                                        });\r\n                                case 'hideDialog':\r\n                                    this.sceneProxy.lstDialogInfo = [];\r\n                                    this.sceneProxy.dialogLayer.visible = false;\r\n                                    break;\r\n                                case 'playMusic':\r\n                                    playMusic(args[0]);\r\n                                    break;\r\n                                case 'stopMusic':\r\n                                    this.sceneProxy.stopMusic();\r\n                                    break;\r\n                                case 'playSound':\r\n                                    if (args[0].url === 'inherit') {\r\n                                    \tif (this.sceneProxy.plotSounds[args[0].index]) {\r\n\t\t\t\t\t\t\t\t\t\t\tthis.sceneProxy.playInheritSound(args[0].index, args[0].volume);\r\n                                        }\r\n                                        break;\r\n                                    }\r\n                                    else if (this.viewComponent.game.load.cache.checkSoundKey(args[0].url)\r\n                                            || 'ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n                                        this.sceneProxy.stopSound(args[0].index, args[0].url);\r\n                                        this.sceneProxy.playSound(args[0].index, args[0].url, args[0].volume, args[0].time === 0);\r\n                                    }\r\n                                    break;\r\n                                case 'stopSound':\r\n                                    this.sceneProxy.stopSound(args[0]);\r\n                                    break;\r\n                                case 'animateImage':\r\n                                    if(this.sceneProxy.dialogLayer.visible !== false){//非底部对话框，层级低于素材层级时置顶\r\n                                        const index1= this.viewComponent.game.world.getChildIndex(this.sceneProxy.dialogLayer)\r\n                                        const index2= this.viewComponent.game.world.getChildIndex(this.sceneProxy.charsAndPropsLayer)\r\n                                        if(index1 < index2 && !this.sceneProxy.dialogLayer.isbottom){\r\n                                            this.viewComponent.game.world.bringToTop(this.sceneProxy.dialogLayer);\r\n                                        }\r\n                                    }\r\n                                    if(this.sceneProxy.menuLayer.visible !== false){\r\n                                        this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n                                    }\r\n                                    const delay = this.sceneProxy.quickPlay ? 0 : args[0].delay;\r\n                                    const duration = this.sceneProxy.quickPlay ? 0 : args[0].duration;\r\n                                    if (args[0].index > 1 && this.sceneProxy.charsAndPropsLayer.exists) {\r\n                                        for (let i=0; i<this.sceneProxy.charsAndPropsLayer.children.length; i++) {\r\n                                            let imgGroup = this.sceneProxy.charsAndPropsLayer.children[i];\r\n                                            if (imgGroup.zIndex === args[0].index) {\r\n                                            \tlet img = imgGroup.children[0];\r\n                                            \tconst doAnimation = () => {\r\n                                            \t\t// begin结束前一次缓动并赋予缓动最终状态\r\n                                                    if (imgGroup.animateTweens) {\r\n                                                    \timgGroup.animateTweens.forEach((t,i) => {t.stop(false)});\r\n                                                        imgGroup.animateTweens.splice(0);\r\n                                                    }\r\n                                                    if (img.animateTweens) {\r\n                                                    \timg.animateTweens.forEach((t,i) => {t.stop(false)});\r\n                                                        img.animateTweens.splice(0);\r\n                                                    }\r\n                                                    if (img.finalState) {\r\n                                                    \timg.alpha = img.finalState.alpha;\r\n                                                        img.angle = img.finalState.angle;\r\n                                                        img.x = img.finalState.x;\r\n                                                        img.y = img.finalState.y;\r\n                                                        imgGroup.x = 0;\r\n                                                        imgGroup.y = 0;\r\n                                                        imgGroup.scale.x = imgGroup.finalState.scale.x;\r\n                                                        imgGroup.scale.y = imgGroup.finalState.scale.y;\r\n                                                    }// -end\r\n\r\n                                                    let alpha = args[0].opacity;\r\n                                                    let angle = parseInt(args[0].rotate) === 180 ? 179.9 : args[0].rotate;\r\n                                                    let scaleX = args[0].scaleX === undefined ? 1 : args[0].scaleX;\r\n                                                    let scaleY = args[0].scaleY === undefined ? 1 : args[0].scaleY;\r\n                                                    let x = args[0].x / scaleX + img.width/2;\r\n                                                    let y = args[0].y / scaleY + img.height/2;\r\n\r\n\r\n                                                    img.mirrorH && (angle = -angle, x -= img.width);\r\n                                                    img.mirrorV && (angle = -angle, y -= img.height);\r\n\r\n                                                    if (!img.lstAlpha && img.alpha !== alpha || img.lstAlpha !== alpha) {\r\n                                                        img.lstAlpha = alpha;\r\n                                                        this.tweenToPromise(img, {alpha: alpha}, duration, null, true, delay);\r\n                                                    }\r\n                                                    if (!img.lstAngle && img.angle !== angle || img.lstAngle !== angle) {\r\n                                                        img.lstAngle = angle;\r\n                                                        this.tweenToPromise(img, {angle: angle}, duration, null, true, delay);\r\n                                                    }\r\n                                                    if (!img.lstX && img.x !== x || img.lstX !== x) {\r\n                                                        img.lstX = x;\r\n                                                        let xRaw = img.mirrorH ? (img.x + img.width/2)  * imgGroup.scale.x : (img.x - img.width/2)  * imgGroup.scale.x;\r\n                                                        let xMoveTo = args[0].x - xRaw * (scaleX / imgGroup.scale.x);\r\n                                                        this.tweenToPromise(imgGroup, {x:xMoveTo}, duration, null, true, delay).then(()=>{\r\n                                                            imgGroup.x = 0;\r\n                                                            img.x = img.lstX;\r\n                                                        });\r\n                                                        //this.tweenToPromise(img, {x: x}, args[0].duration, null, true, args[0].delay);\r\n                                                    }\r\n                                                    if (!img.lstY && img.y !== y || img.lstY !== y) {\r\n                                                        img.lstY = y;\r\n                                                        let yRaw = img.mirrorV ? (img.y + img.height/2) * imgGroup.scale.y : (img.y - img.height/2) * imgGroup.scale.y;\r\n                                                        let yMoveTo = args[0].y - yRaw * (scaleY / imgGroup.scale.y);\r\n                                                        this.tweenToPromise(imgGroup, {y:yMoveTo}, duration, null, true, delay).then(()=>{\r\n                                                            imgGroup.y = 0;\r\n                                                            img.y = img.lstY;\r\n                                                        });\r\n                                                        //this.tweenToPromise(img, {y: y}, args[0].duration, null, true, args[0].delay);\r\n                                                    }\r\n                                                    img.finalState = {alpha:alpha, angle:angle, x:x, y:y};\r\n\r\n                                                    if (!imgGroup.lstScaleX && imgGroup.scale.x !== scaleX || imgGroup.lstScaleX !== scaleX) {\r\n                                                        imgGroup.lstScaleX = scaleX;\r\n                                                        this.tweenToPromise(imgGroup.scale, {x:scaleX}, duration, null, true, delay);\r\n                                                    }\r\n                                                    if (!imgGroup.lstScaleY && imgGroup.scale.y !== scaleY || imgGroup.lstScaleY !== scaleY) {\r\n                                                        imgGroup.lstScaleY = scaleY;\r\n                                                        this.tweenToPromise(imgGroup.scale, {y:scaleY}, duration, null, true, delay);\r\n                                                    }\r\n                                                    imgGroup.finalState = {scale:{x:scaleX, y:scaleY}};\r\n\t\t\t\t\t\t\t\t\t\t\t\t};\r\n                                            \tdoAnimation();\r\n                                                break;\r\n                                            }\r\n                                        }\r\n                                    } else if (args[0].index === 1 && this.sceneProxy.curPlotLayer.children[1]) {\r\n                                    \tthis.tweenToPromise(this.sceneProxy.curPlotLayer.children[1], {alpha: args[0].opacity}, duration, null, true, delay);\r\n                                    \tthis.sceneProxy.curPlotLayer.children[1].finalState = {alpha: args[0].opacity};\r\n                                    \tthis.sceneProxy.lstPlotBkOpacity = args[0].opacity;\r\n\t\t\t\t\t\t\t\t\t}\r\n                                    break;\r\n                                case 'animateDialog':\r\n                                    if (this.sceneProxy.dialogLayer.visible) {\r\n                                    \tlet delay = this.sceneProxy.quickPlay ? 0 : args[0].delay;\r\n                                    \tlet duration = this.sceneProxy.quickPlay ? 0 : args[0].duration;\r\n                                        const normalPropsTo = () => {\r\n                                            let properties = {alpha:args[0].opacity, angle:args[0].rotate, x:parseFloat(args[0].x), y:parseFloat(args[0].y)};\r\n                                            if(this.sceneProxy.lstDialogInfo[0]){\r\n                                                this.sceneProxy.lstDialogInfo[0].opacity = args[0].opacity;\r\n                                                this.sceneProxy.lstDialogInfo[0].rotate = args[0].rotate;\r\n                                                this.sceneProxy.lstDialogInfo[0].x = args[0].x;\r\n                                                this.sceneProxy.lstDialogInfo[0].y = args[0].y;\r\n                                            }\r\n                                            return this.tweenToPromise(this.sceneProxy.dialogLayer, properties, duration, null, true, delay).then(()=>{\r\n                                                this.sceneProxy.dialogLayer.visible = true;\r\n                                                !this.sceneProxy.dialogLayer.isbottom && this.viewComponent.game.world.bringToTop(this.sceneProxy.dialogLayer)\r\n                                            });\r\n                                        };\r\n                                        const scalePropTo = () => {\r\n                                            return this.tweenToPromise(this.sceneProxy.dialogLayer.scale, {x:args[0].scaleX, y:args[0].scaleY}, duration, null, true, delay).then(()=>{\r\n                                                this.sceneProxy.dialogLayer.visible = true;\r\n                                                !this.sceneProxy.dialogLayer.isbottom && this.viewComponent.game.world.bringToTop(this.sceneProxy.dialogLayer)\r\n                                            });\r\n                                        };\r\n                                        normalPropsTo() && scalePropTo();\r\n                                    }\r\n                                    break;\r\n                                case 'animateScene':\r\n                                \tif (! this.sceneProxy.quickPlay) {\r\n                                        if (args[0].type === 'twinkle') {\r\n                                            sceneTwinkle(args[0].duration, args[0].delay, args[0].color);\r\n                                        }\r\n                                        if (args[0].type === 'shake') {\r\n                                            let loop = args[0].loop && args[0].loop || false;\r\n                                            if ((!loop || this.sceneProxy.shakeLoopObj.loop) && this.sceneProxy.curPlotLayer.isShaking === true ) {\r\n                                                clearShake();\r\n                                            }\r\n                                            this.sceneProxy.shakeLoopObj.loop = loop\r\n                                            this.sceneProxy.shakeLoopObj.level = args[0].level;\r\n                                            this.sceneProxy.shakeLoopObj.duration = args[0].duration;\r\n                                            this.sceneProxy.shakeLoopObj.delay = args[0].delay;\r\n                                            this.sceneProxy.shakeLoopObj.commands = commands[i];//记录当前的指令\r\n                                            if (!this.sceneProxy.curPlotLayer.isShaking && args[0].duration) {\r\n                                                const doShake = ()=>{\r\n                                                    const delay = this.sceneProxy.quickPlay ? 0 : args[0].delay;\r\n                                                    const duration = args[0].duration > 0 ? (this.sceneProxy.quickPlay ? 100 : args[0].duration) : 0;\r\n                                                    this.sceneProxy.curPlotLayer.isShaking = true;\r\n                                                    return sceneShake(args[0].level ? args[0].level * 5 : 18, duration, delay).then(()=>{\r\n                                                        this.sceneProxy.curPlotLayer.isShaking = false;\r\n                                                        if(this.sceneProxy.shakeLoopObj.loop && args[0].level > 0){\r\n                                                            if(args[0].level !== this.sceneProxy.shakeLoopObj.level) args[0].level = this.sceneProxy.shakeLoopObj.level; //振动级别变化\r\n                                                            if(args[0].duration !== this.sceneProxy.shakeLoopObj.duration) args[0].duration = this.sceneProxy.shakeLoopObj.duration; //振动持续时间变化\r\n                                                            //if(args[0].delay !== this.sceneProxy.shakeLoopObj.delay) args[0].level = this.sceneProxy.shakeLoopObj.delay; //振动延迟时间变化\r\n                                                            //继续喜欢振动  延迟设为0\r\n                                                            args[0].delay = 0;\r\n                                                            return doShake();\r\n                                                        }else{\r\n                                                            return Promise.resolve();\r\n                                                        }\r\n                                                    });\r\n                                                }\r\n                                                doShake().then(()=>{\r\n                                                    //\r\n                                                    this.sceneProxy.curPlotLayer.isShaking = false;\r\n                                                })\r\n                                            }\r\n                                        }\r\n                                        if(args[0].type === 'spread'){\r\n                                            //展开\r\n                                            !this.sceneProxy.curPlotLayer.isSpreading && spread(args[0].duration, args[0].delay)\r\n                                        }\r\n\t\t\t\t\t\t\t\t\t}else{\r\n                                \t    if(this.sceneProxy.shakeLoopObj.loop){\r\n                                \t        //快进下， 原先指令是循环振动时\r\n                                            let loop = args[0].loop && args[0].loop || false;\r\n                                            if(!loop) {this.sceneProxy.shakeLoopObj.loop = loop};\r\n                                        }\r\n                                    }\r\n                                    break;\r\n                                case 'animateMusic':\r\n                                    if(this.sceneProxy.bk_music){\r\n                                        this.sceneProxy.bk_music.prevolume = args[0].volume;\r\n                                        this.sceneProxy.bk_music.inheritvolume = args[0].volume;\r\n                                    }\r\n                                    if ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n                                        if(PhoneUtils.musicInfo){\r\n                                            PhoneUtils.musicInfo.inheritvolume = args[0].volume;\r\n                                            PhoneUtils.musicInfo.prevolume = args[0].volume;\r\n                                        }\r\n                                        args[0].volume *= Utils.musicVolume;\r\n                                        PhoneUtils.tweenToMusic(args[0].volume, args[0].duration, args[0].delay);\r\n                                    } else {\r\n                                        args[0].volume *= Utils.musicVolume;\r\n                                        if(this.sceneProxy.bk_music){\r\n                                            this.sceneProxy.bk_music.animateMusic = 'music';//声音动画\r\n                                            this.tweenToPromise(this.sceneProxy.bk_music, {volume: args[0].volume}, args[0].duration, null, true, args[0].delay).then(()=>{\r\n                                                //this.sceneProxy.bk_music.volume = (this.sceneProxy.bk_music.prevolume * Utils.musicVolume);\r\n                                            })\r\n                                        }\r\n                                    }\r\n                                    break;\r\n                                case 'animateSound':\r\n                                    if(this.sceneProxy.plotSounds[args[0].index]){\r\n                                        this.sceneProxy.plotSounds[args[0].index].prevolume = args[0].volume;\r\n                                        this.sceneProxy.plotSounds[args[0].index].inheritvolume = args[0].volume;\r\n                                    }\r\n                                    if ('ios' === flashvars.client && '1.5.0' <= flashvars.app_version) {\r\n                                        if(PhoneUtils.soundsInfo[args[0].index]){\r\n                                            PhoneUtils.soundsInfo[args[0].index].prevolume = args[0].volume;\r\n                                            PhoneUtils.soundsInfo[args[0].index].inheritvolume = args[0].volume;\r\n                                        }\r\n                                        args[0].volume *= Utils.soundVolume;\r\n                                        PhoneUtils.tweenToSound(args[0].index, args[0].volume, args[0].duration, args[0].delay);\r\n                                    } else {\r\n                                        args[0].volume *= Utils.soundVolume;\r\n                                        if(this.sceneProxy.plotSounds[args[0].index]){\r\n                                            this.sceneProxy.plotSounds[args[0].index].animateMusic = 'sound';//音效动画\r\n                                            this.tweenToPromise(this.sceneProxy.plotSounds[args[0].index], {volume: args[0].volume}, args[0].duration, null, true, args[0].delay).then(()=>{\r\n                                                this.sceneProxy.plotSounds[args[0].index].volume = this.sceneProxy.plotSounds[args[0].index].prevolume * Utils.soundVolume;\r\n                                            });\r\n                                        }                                        \r\n                                    }\r\n                                    break;\r\n                                case 'setValues':\r\n                                    this.sceneProxy.updatePayValue(context,args).then((rs) =>{\r\n                                        if(rs === true){\r\n                                            this.sceneProxy.valueOperation(context, args,false,()=>{\r\n                                                return resolve(action);\r\n                                            });\r\n                                        }else{\r\n                                            //没有同步成功，取消数值操作\r\n                                            return resolve(action);\r\n                                        }\r\n                                    })\r\n                                    break;\r\n                                case 'wait':\r\n                                \tif (this.sceneProxy.quickPlay && this.sceneProxy.preWaitCmdUuid !== commands[i].uuid) { // 上一等待指令与当前等待指令相同，说明作者设置了循环等待\r\n                                        this.sceneProxy.preWaitCmdUuid = commands[i].uuid;\r\n                                        return resolve(action);\r\n\t\t\t\t\t\t\t\t\t}\r\n                                    return playWait(args[0].value, { type: 0 }).then(() => {\r\n                                        if(this.sceneProxy.curCmdInfo !== cmdInfo) {\r\n                                            //高级剧情wait返回的指令集与当前正在播放的指令集不相同，无需执行指令 重置章节数据，剧情编号，指令集，指令编号\r\n                                            chapter = {};\r\n                                            Object.assign(chapter,this.sceneProxy.curChapter)\r\n                                            nPlot = this.sceneProxy.curPlotIndex;\r\n                                            cmdInfo = {};\r\n                                            Object.assign(cmdInfo,this.sceneProxy.curCmdInfo);\r\n                                            i  = this.sceneProxy.curCmdIndex;\r\n                                            return resolve(false);\r\n                                        }\r\n                                \t    return resolve(action)\r\n                                \t});\r\n                                case 'jump':\r\n                                    this.sceneProxy.context = JSON.parse(JSON.stringify(this.sceneProxy.context));\r\n                                    this.showNextPlot(this.sceneProxy.context, this.sceneProxy.curChapter, this.sceneProxy.curPlotIndex, 'jump', args[0]);\r\n                                    return resolve(false);\r\n                                case 'back':\r\n                                    this.sceneProxy.context = JSON.parse(JSON.stringify(this.sceneProxy.context));\r\n                                    this.showNextPlot(this.sceneProxy.context, this.sceneProxy.curChapter, this.sceneProxy.curPlotIndex, 'back');\r\n                                    return resolve(false);\r\n                                case 'insert':\r\n                                    this.showNextPlot(this.sceneProxy.context, this.sceneProxy.curChapter, this.sceneProxy.curPlotIndex, 'insertPlot', args[0]);\r\n                                    return resolve(false);\r\n                                case 'options':\r\n                                    isRecover = false;\r\n                                    if (!this.sceneProxy.optionLayer || !this.sceneProxy.optionLayer.exists) {\r\n                                        this.sceneProxy.optionLayer = this.viewComponent.game.add.group();\r\n                                    }\r\n                                    this.viewComponent.game.world.bringToTop(this.sceneProxy.optionLayer);\r\n                                    this.viewComponent.game.world.bringToTop(this.sceneProxy.plotViewsLayer);\r\n                                    showGlobalViews(false, hideGlobalViews);\r\n                                    this.sceneProxy.isScreenHold && this.viewComponent.game.world.bringToTop(this.sceneProxy.quickPlayLayer);\r\n                                    return Utils.timeout(200).then(()=>{\r\n                                        return addOptions(args, null).then(opt => {\r\n                                            action.type = 'options';\r\n                                            action.index = opt.index;\r\n                                            ResourcesManager.resetCmdPOptionPreload(commands, i, action.index);\r\n                                            return resolve(action);\r\n                                        });\r\n                                    })\r\n                                case 'conditionOptions':\r\n                                    isRecover = false;\r\n                                    if (!this.sceneProxy.optionLayer || !this.sceneProxy.optionLayer.exists) {\r\n                                        this.sceneProxy.optionLayer = this.viewComponent.game.add.group();\r\n                                    }\r\n                                    return addOptions([], args).then(opt => {\r\n                                        if (opt.type === 2) {\r\n                                        \taction.type = 'cdtOptions';\r\n\t\t\t\t\t\t\t\t\t\t}\r\n                                        ResourcesManager.resetCmdPOptionPreload(commands, i, opt.type === 2 ? opt.index : -1);\r\n                                        return resolve(action);\r\n                                    });\r\n                                case 'backOption':\r\n                                \taction.type = 'backOption';\r\n                                    action.eArg = this.sceneProxy.Expression.safeEval(cmdInfo.commands[i].args[0], context);\r\n                                    break;\r\n                                case 'jumpOption':\r\n                                \taction.type = 'jumpOption';\r\n                                    action.eArg = this.sceneProxy.Expression.safeEval(cmdInfo.commands[i].args[0], context);\r\n                                    break;\r\n                                case 'autoSaveOrLoad':\r\n                                    if (this.sceneProxy.json_data.default_settings && this.sceneProxy.json_data.default_settings.autoSaveOrLoad) {\r\n                                        if (args[0].type === 1) {\r\n                                            if (!this.sceneProxy.loadRecord(args[0].index)) {\r\n                                                return Dialog.warn(\"Sorry~读不到存档内容，即将返回封面\").then(() => {\r\n                                                    this.sceneProxy.reStart(this.sceneProxy.isExtend());\r\n                                                    return Promise.resolve(-1);\r\n                                                }, () => {\r\n                                                    this.sceneProxy.reStart(this.sceneProxy.isExtend());\r\n                                                    return Promise.resolve(-1);\r\n                                                })\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n                                            return Promise.resolve(-1);\r\n                                        }\r\n                                        else if (args[0].type === 0) {\r\n                                            this.sceneProxy.getSnap();\r\n                                            this.sceneProxy.saveRecord(args[0].index, true);\r\n                                        }\r\n                                    }\r\n                                    break;\r\n                                case 'autotext':\r\n                                    this.sceneProxy.bCmdAutoText = args[0];\r\n                                    break;\r\n                                case 'weather':\r\n                                    if ('none' === args[0]) {\r\n                                        this.sceneProxy.weatherLayer.visible = false;\r\n                                    }\r\n                                    else {\r\n                                        addWeather(args[0]);\r\n                                    }\r\n                                    break;\r\n\t\t\t\t\t\t\t\tcase 'disableSaveOrLoad':\r\n\t\t\t\t\t\t\t\t\tthis.sceneProxy.context.disableSaveOrLoad = args[0];\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n                                case 'showBubble':\r\n                                    //显示气泡模式\r\n                                    let bi = hasborder(args[0].index);\r\n                                    this.sceneProxy.clearBubbleData(bi);\r\n                                    bi = hasborder(args[0].index);\r\n                                    resetBorder();\r\n                                    if(bi !== -1){\r\n                                        //需要显示的气泡已存在\r\n                                        const saveary = this.sceneProxy.saveBubbleVector[bi].savebubble.concat();\r\n                                        this.sceneProxy.bubbleLayer.removeChild(this.sceneProxy.saveBubbleVector[bi]);\r\n                                        this.sceneProxy.saveBubbleVector[bi].destroy();\r\n                                        let border = this.addBubbleBorder(this.sceneProxy.bubbleLayer,commands[i]);\r\n                                        this.sceneProxy.saveBubbleVector.splice(bi,1); // 删除原先\r\n                                        this.sceneProxy.saveBubbleVector.push(border); // 放数组最后\r\n                                        border.savebubble = saveary.concat();\r\n                                        border.visible = true;\r\n                                        border.itemlength = 0;\r\n                                        border.iscurrent = true;\r\n                                        curborder = border;\r\n                                        const addbubble = (i = 0)=>{\r\n                                            if(i >= curborder.savebubble.length){\r\n                                                return Promise.resolve();\r\n                                            } else{\r\n                                                return this.createBubble(curborder.savebubble[i],curborder).then((b)=>{\r\n                                                    i ++;\r\n                                                    return addbubble(i)\r\n                                                })\r\n                                            }\r\n                                        }\r\n                                        return addbubble().then(()=>{ showGlobalViews(false, hideGlobalViews);return resolve(action)})\r\n                                    }else{\r\n                                        let border = this.addBubbleBorder(this.sceneProxy.bubbleLayer,commands[i]);\r\n                                        this.sceneProxy.saveBubbleVector.push(border);\r\n                                        border.iscurrent = true;\r\n                                        curborder = border;//当前气泡指向\r\n                                        showGlobalViews(false, hideGlobalViews);\r\n                                        return resolve(action);\r\n                                    }\r\n                                case 'emitBubble':\r\n                                    //发射气泡\r\n                                    if(curborder.ishide === true){\r\n                                        const getcur = ()=>{\r\n                                            for(let i = this.sceneProxy.saveBubbleVector.length -1;i >= 0;i--){\r\n                                                let getborder =  this.sceneProxy.saveBubbleVector[i];\r\n                                                if(getborder && getborder.ishide !== true){\r\n                                                    resetBorder();\r\n                                                    getborder.iscurrent = true;\r\n                                                    return getborder;\r\n                                                }\r\n                                            }\r\n                                            return null;\r\n                                        }\r\n                                        let gborder = getcur();\r\n                                        if(gborder){\r\n                                            curborder = gborder;\r\n                                        }\r\n                                    }\r\n                                    const hasView = this.sceneProxy.plotViewsLayer.children.length > 0;\r\n                                    const addClick = (ac)=>{\r\n                                        const onClick = (o, e) => {\r\n                                            if (e && e.pointerMode === Phaser.PointerMode.CURSOR && e.button !== 0 || 'auto' === o && hasView) {\r\n                                                return;\r\n                                            }\r\n                                            this.sceneProxy.curPlotLayer.onChildInputDown.remove(onClick);\r\n                                            if ('insertPlot' === o)  {\r\n                                                return reject();\r\n                                            } else {\r\n                                                return resolve(ac ? ac : action)\r\n                                            }\r\n                                        };\r\n                                        this.sceneProxy.curPlotLayer.onChildInputDown.add(onClick);\r\n                                        !hasView && this.sceneProxy.space_key.onDown.addOnce(() => {return resolve(action)});\r\n                                    };\r\n                                    if(loadData && isRecover){\r\n                                        //读档\r\n                                        addClick(action);\r\n                                        curborder.gonext = (b)=>{\r\n                                            if(b && b !== curborder){\r\n                                                curborder.gonext && curborder.gonext();\r\n                                            }else{\r\n                                                return resolve(action);\r\n                                            }\r\n                                        }\r\n                                        isRecover = false;\r\n                                        return\r\n                                    }\r\n                                    this.viewComponent.game.world.bringToTop(this.sceneProxy.bubbleLayer);\r\n                                    this.viewComponent.game.world.bringToTop(this.sceneProxy.plotViewsLayer);\r\n                                    showGlobalViews(false, hideGlobalViews);\r\n                                    this.viewComponent.game.world.bringToTop(this.sceneProxy.menuLayer);\r\n                                    this.sceneProxy.isScreenHold && this.viewComponent.game.world.bringToTop(this.sceneProxy.quickPlayLayer);\r\n                                    this.sceneProxy.bubbleLayer.animateTweens.forEach((t,i) => {t.stop(true)});\r\n                                    this.sceneProxy.bubbleLayer.animateTweens.splice(0);\r\n                                    return this.createBubble(commands[i],curborder).then((bubble)=>{\r\n                                        //记录需要保留的气泡之类\r\n                                        this.sceneProxy.bubbleArchivalCount.push(commands[i].uuid);\r\n                                        curborder.savebubble.push(commands[i])\r\n                                        curborder.curbubble.push(commands[i]);//记录当前显示\r\n                                        const doAnimation = ()=>{\r\n                                            return new Promise((resolve,reject) =>{\r\n                                                if(args[0].animation){\r\n                                                    if(args[0].animation.type === 'fadein'){\r\n                                                        return this.tweenFromPromise(bubble, {alpha: 0}, args[0].animation.duration, null, true, args[0].animation.delay).then(()=>{\r\n                                                            bubble.alpha = 1;\r\n                                                            return resolve();\r\n                                                        })\r\n                                                    }\r\n                                                }else{\r\n                                                    return resolve();\r\n                                                }\r\n                                            })\r\n                                        }\r\n                                        curborder.gonext = (b)=>{\r\n                                            if(b && b !== curborder){\r\n                                                curborder.gonext && curborder.gonext();\r\n                                            }else{\r\n                                                if (!((this.sceneProxy.bCmdAutoText || ((!hasView) && (this.sceneProxy.quickPlay || this.sceneProxy.context.auto))) && !this.sceneProxy.playPause)) { // 非自动播放下一指令\r\n                                                    return resolve(action);\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                        if (!((this.sceneProxy.bCmdAutoText || ((!hasView) && (this.sceneProxy.quickPlay || this.sceneProxy.context.auto))) && !this.sceneProxy.playPause)){\r\n                                            addClick();\r\n                                        }\r\n                                        return doAnimation().then(() =>{\r\n                                            if ((this.sceneProxy.bCmdAutoText || ((!hasView) && (this.sceneProxy.quickPlay || this.sceneProxy.context.auto))) && !this.sceneProxy.playPause) { // 自动播放下一指令\r\n                                                //自动播放下一集 延迟1秒执行\r\n                                                setTimeout(()=>{return resolve(action);},1000)\r\n                                            }else{\r\n                                                addClick(action);\r\n                                            }\r\n                                        })\r\n                                    });\r\n                                case 'hideBubble':\r\n                                    //隐藏气泡模式\r\n                                    const id = hasborder(args[0]);\r\n                                    if(id !== -1){\r\n                                        this.sceneProxy.saveBubbleVector[id].visible = false;\r\n                                        this.sceneProxy.saveBubbleVector[id].ishide = true;\r\n                                    }\r\n                                    break;\r\n                            }\r\n                            if(commands[i].type !== \"setValues\") return resolve(action);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tconst playHandler = (cmdInfo, index) => {\r\n\t\t\t\t\t\treturn this.cmdPlotLoadResources(context, chapter, nPlot, cmdInfo, index).then(() => handle(cmdInfo, index).then(r => {\r\n                            this.sceneProxy.cmdPlotNextPromise = null;\r\n\t\t\t\t\t\t\tif (r && context === this.sceneProxy.context && this.sceneProxy.isGoToCommand !== false) {\r\n                                const {info:info, index:i} = this.sceneProxy.getNextCommand(context, cmdInfo, index, r);\r\n                                info && info.commands[i] ? playHandler(info, i) : this.showNextPlot(context, chapter, nPlot);\r\n                            }\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t};\r\n\r\n                    this.sceneProxy.lstPlotLayer && this.sceneProxy.lstPlotLayer.destroy();\r\n                    this.sceneProxy.lstPlotLayer = this.sceneProxy.curPlotLayer;\r\n                    ResourcesManager.updateUsingKey({ type: 'preBackground', key: this.sceneProxy.lstPlotBkKey });\r\n\t\t\t\t\tthis.sceneProxy.bCmdAutoText = false;\r\n                    this.sceneProxy.lstDialogInfo = [];\r\n\t\t\t\t\tthis.sceneProxy.cmdPlayHandlerFun = playHandler;\r\n                    addBackground(this.sceneProxy.curPlotLayer);\r\n\r\n\t\t\t\t\tlet cmdInfo = {commands: plot.commands, parentInfo: null, parentCmdIndex: -1};\r\n\t\t\t\t\tlet cmdIndex = 0;\r\n                    const doCmdInfo = ()=>{\r\n                        this.addMenuLayer(!!this.sceneProxy.json_data.template.json.shanyiMenu);\r\n                        cmdInfo && cmdInfo.commands[cmdIndex] ? playHandler(cmdInfo, cmdIndex) : this.showNextPlot(context, chapter, nPlot);\r\n                    }\r\n\t\t\t\t\tif (cmdPlotSnap && cmdPlotSnap.cmdInfo) {\r\n                        this.sceneProxy.context.disableSaveOrLoad = plot.disableSaveOrLoad ? plot.disableSaveOrLoad : this.sceneProxy.context.disableSaveOrLoad;\r\n\t\t\t\t\t\tcmdInfo = cmdPlotSnap.cmdInfo;\r\n\t\t\t\t\t\tcmdIndex = cmdPlotSnap.cmdIndex;\r\n\t\t\t\t\t\tif (cmdInfo.commands[cmdIndex] && cmdInfo.commands[cmdIndex].type === 'systemUI') {\r\n\t\t\t\t\t\t\tcmdIndex++;\r\n\t\t\t\t\t\t}\r\n                        if (cmdInfo.commands[cmdIndex] && cmdInfo.commands[cmdIndex].type === 'autoSaveOrLoad') {\r\n                            cmdIndex++;\r\n                        }\r\n                        recoverCmdSnap(cmdPlotSnap.cmdScreenSnap, cmdInfo.commands, cmdIndex,cmdPlotSnap.animateScene ? cmdPlotSnap.animateScene : null).then(()=>{\r\n\t\t\t\t\t\t    isRecover = true;\r\n                            if (!cmdInfo.commands[cmdIndex]) {\r\n                                const {info, index} = this.sceneProxy.getNextCommand(context, cmdInfo, cmdIndex-1, {type:'insert'});\r\n                                cmdInfo = info;\r\n                                cmdIndex = index;\r\n                            }\r\n                            doCmdInfo();\r\n                        });\r\n\t\t\t\t\t}else{\r\n                        this.sceneProxy.context.disableSaveOrLoad = plot.disableSaveOrLoad ? plot.disableSaveOrLoad : {save: false, load: false};\r\n                        doCmdInfo();\r\n                    }\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthis.sceneProxy.isGettingNext = false;\r\n                this.sceneProxy.curPlotLayer = this.viewComponent.game.add.group();\r\n                this.sceneProxy.curPlotLayer.inputEnableChildren = true;\r\n                this.sceneProxy.curPlotLayer.isShaking = false;//振动效果默认不在执行中\r\n                this.sceneProxy.curPlotLayer.isSpreading = false;//展开效果默认不在执行中\r\n                this.sceneProxy.curPlotLayer.name = 'plotLayer';\r\n                this.sceneProxy.charsAndPropsLayer && this.sceneProxy.charsAndPropsLayer.destroy();\r\n                this.sceneProxy.charsAndPropsLayer = this.viewComponent.game.add.group();\r\n                this.sceneProxy.charsAndPropsLayer.name = \"charactersAndProps\";\r\n                this.sceneProxy.optionLayer && this.sceneProxy.optionLayer.destroy();\r\n                this.sceneProxy.optionLayer = this.viewComponent.game.add.group();\r\n\t\t\t\t// 置顶\r\n                this.viewComponent.game.world.bringToTop(this.sceneProxy.curPlotLayer);\r\n                this.viewComponent.game.world.bringToTop(this.sceneProxy.charsAndPropsLayer);\r\n                this.viewComponent.game.world.bringToTop(this.sceneProxy.dialogLayer);\r\n                //\r\n                clearShake();\r\n\r\n                // 清理上一剧情高级UI\r\n\t\t\t\tif (!loadData) {\r\n                    this.sceneProxy.removeViewTimer(this.sceneProxy.plotViewsLayer);\r\n                    this.sceneProxy.removeInputView(this.sceneProxy.plotViewsLayer);\r\n                    this.sceneProxy.plotViewsLayer.removeAll(true);\r\n                    this.sceneProxy.plotViews.splice(0, this.sceneProxy.plotViews.length);\r\n                    this.removeViewKey(this.sceneProxy.plotViewKeys);\r\n                }\r\n                if(loadData || (cmdPlotSnap && cmdPlotSnap.cmdInfo)){\r\n                    //存档数据 或插播返回  恢复\r\n                    if(this.sceneProxy.saveBubbleDataVector.length > 0){\r\n                        this.sceneProxy.saveBubbleVector = [];\r\n                        for(let j = 0;j < this.sceneProxy.saveBubbleDataVector.length;j++){\r\n                            const bcommands = this.sceneProxy.saveBubbleDataVector[j].bubbleMode;\r\n                            let border = this.addBubbleBorder( null, bcommands);\r\n                            border.savebubble = this.sceneProxy.saveBubbleDataVector[j].bubble.concat(); //记录的气泡数据\r\n                            border.curbubble = this.sceneProxy.saveBubbleDataVector[j].curbubble.concat();//记录的当前气泡数据\r\n                            border.ishide = this.sceneProxy.saveBubbleDataVector[j].ishide;\r\n                            border.iscurrent = this.sceneProxy.saveBubbleDataVector[j].iscurrent;\r\n                            this.sceneProxy.saveBubbleVector.push(border);\r\n                        }\r\n                        this.sceneProxy.saveBubbleDataVector = [];\r\n                    }\r\n                }\r\n\r\n                this.sceneProxy.curPlotInfo = plot;\t\t\t// 保存当前要播放的剧情信息\r\n                this.sceneProxy.curChapter = chapter;\t\t// 保存当前章节信息\r\n                this.sceneProxy.curPlotIndex = nPlot;\t\t// 保存当前剧情索引\r\n\t\t\t\tif (plot.commands){\r\n\t\t\t\t\tplayCommands();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tplayNormal();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tplay();\r\n            this.sceneProxy.isScreenHold && this.viewComponent.game.world.bringToTop(this.sceneProxy.quickPlayLayer);\r\n\t\t},\r\n\r\n\t\tendPlot: function (bhide) {\r\n            this.sceneProxy.saveBubbleVector.forEach((b,i) =>{\r\n                this.sceneProxy.clearBubbleData(i);\r\n                !bhide && (b.ishide = true);\r\n            });\r\n            if (this.sceneProxy.bubbleLayer.children.length > 0){\r\n                this.sceneProxy.bubbleLayer.removeAll(true);\r\n            }\r\n\t\t\tthis.sceneProxy.coverLayer.visible = false;\r\n\t\t\tthis.viewComponent.game.input.onDown.removeAll();\t// 移除鼠标点击事件\r\n\t\t\tthis.sceneProxy.dialogLayer.visible = false;\t\t// 隐藏对话框层\r\n\t\t\tthis.sceneProxy.menuLayer.visible = false;\t\t\t// 隐藏菜单层\r\n\t\t\tthis.sceneProxy.space_key.onDown.removeAll();\t\t// 移除空格键\r\n            this.sceneProxy.plotViews.splice(0, this.sceneProxy.plotViews.length);\r\n\t\t\tthis.sceneProxy.removePlotTweens();\r\n\t\t},\r\n\r\n\t\tshowNextPlot: function (context, chapter, nPlot, type, eArg,isview = false) {\r\n\t\t    this.sceneProxy.isGoToCommand = false;//显示下一个剧情。取消高级剧情接下去指令\r\n\r\n            const { stack } = context;\r\n\t\t\tlet {chapter: nChapter, nIndex, cmdPlotSnap, context: newContext, preStackFrame, preCmdStackFrame} = this.sceneProxy.getNextPlot(context, chapter, nPlot, type, eArg,isview);\r\n            const goNext = () => {\r\n                if(nIndex.length >= 36){\r\n                    //flash插播返回uuid\r\n                    let index = -2\r\n                    const getPlotIndex = (puuid) =>{\r\n                        nChapter.plots.find((plot,j) =>{\r\n                            if(plot.uuid === puuid){\r\n                                index = j;\r\n                            }\r\n                        })\r\n                        return index;//不存在\r\n                    }\r\n                    nIndex = getPlotIndex(nIndex);\r\n                }\r\n                if (!nChapter.plots[nIndex]) {\r\n                    if (nIndex === -2) {\r\n                        this.endPlot();\r\n                        return this.sceneProxy.reStart(this.sceneProxy.isExtend());\r\n                    }\r\n                    else if (nIndex < -2) {\r\n                        if (preStackFrame) {\r\n                            newContext.stack = [preStackFrame, ...newContext.stack];\r\n                            preCmdStackFrame && (newContext.cmdStack = [preCmdStackFrame, ...newContext.cmdStack]);\r\n                        }\r\n                        const {chapter: c, nIndex: n, cmdPlotSnap: cps, context: nc, preStackFrame:np, preCmdStackFrame:npc} = this.sceneProxy.getNextPlot(context, chapter, nPlot, type, eArg);\r\n                        nChapter = c, nIndex = n, cmdPlotSnap = cps, newContext = nc, preStackFrame = np, preCmdStackFrame = npc;\r\n                        this.endPlot(cmdPlotSnap && cmdPlotSnap.cmdInfo);\r\n                        if (nIndex < -2) {\r\n                            if (preStackFrame) {\r\n                                context.stack = [preStackFrame, ...newContext.stack];\r\n                                preCmdStackFrame && (newContext.cmdStack = [preCmdStackFrame, ...newContext.cmdStack]);\r\n                            }\r\n                            return this.showNextPlot(context, chapter, nPlot, type, eArg);\r\n                        }\r\n                    }\r\n                    else if (nIndex === 0) {\r\n                        this.endPlot(cmdPlotSnap && cmdPlotSnap.cmdInfo);\r\n                        this.showNextPlot(context, nChapter, nIndex);\r\n                        return;\r\n                    }\r\n                    else {\r\n                        this.sceneProxy.dialogLayer.visible = true;\t\t// 游戏结束不隐藏对话框层\r\n                        this.sceneProxy.menuLayer.visible = true;\t\t\t// 游戏结束不隐藏菜单层\r\n                        return this.gameOver();\r\n                    }\r\n                }\r\n                this.endPlot(cmdPlotSnap && cmdPlotSnap.cmdInfo)\r\n                let optionType = null;\r\n                let optionIndex = null;\r\n                let nextPlotType = null;\r\n                if (stack !== newContext.stack) {\r\n                    const frame = newContext.stack[0] || {};\r\n                    const { type, index } = frame;\r\n                    if (type === 'options' || type === 'condition_options') {\r\n                        optionType = type;\r\n                        optionIndex = index;\r\n                    } else if (type === 'insert') {\r\n                        nextPlotType = 'insert';\r\n                    } else if (!newContext.stack.length&&!nIndex) {\r\n                        nextPlotType = 'jump';\r\n                    }\r\n                }\r\n                ResourcesManager.resetPlotOptionPreload(chapter.plots[nPlot], optionType, optionIndex);\r\n                ResourcesManager.clearPrePlotResources(chapter.plots, nPlot);\r\n\r\n                if (nextPlotType === 'jump' || nextPlotType === 'insert') {\r\n                    nextPlotType === 'jump' ? ResourcesManager.resetJumpPreload(nChapter): ResourcesManager.resetInsertPreload(nChapter) ;\r\n                }\r\n\r\n                if (!this.sceneProxy.isPlotResourceExist(nChapter.plots[nIndex])) {\r\n                    this.sceneProxy.preloadChapterAssets(newContext, nChapter, nIndex, cmdPlotSnap);\r\n                } else {\r\n                    const loadingResourceList = this.sceneProxy.getLoadingPlotResource(nChapter.plots[nIndex]);\r\n                    loadingResourceList.length\r\n                        ? this.assetsLoader(loadingResourceList, true, true).then(() => this.showPlot(newContext, nChapter, nIndex, cmdPlotSnap))\r\n                        : this.showPlot(newContext, nChapter, nIndex, cmdPlotSnap);\r\n                }\r\n\t\t\t};\r\n            const stayCurrentPlot = () => {\r\n                this.endPlot();\r\n                if (nPlot === 0) {\r\n                    this.showPlot(context, chapter, 0);\r\n                } else {\r\n                \tif (preStackFrame) {\r\n                \t\tnewContext.stack = [preStackFrame, ...newContext.stack];\r\n                        preCmdStackFrame && (newContext.cmdStack = [preCmdStackFrame, ...newContext.cmdStack]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//付费返回停留在当前剧情，type类型不执行\r\n                    const {chapter: nChapter, nIndex, cmdPlotSnap, context: newContext} = this.sceneProxy.getNextPlot(context, chapter, nPlot-1, ''/*type*/, eArg);\r\n\t\t\t\t\tthis.sceneProxy.preloadChapterAssets(newContext, nChapter, nIndex, cmdPlotSnap);\r\n                }\r\n\t\t\t};\r\n\r\n            this.sceneProxy.isGettingNext = true;\r\n            this.sceneProxy.shakeLoopObj.loop = false;\r\n            //this.endPlot()\r\n\r\n            if (nChapter.md5 && nChapter.plots.length === 0) {\r\n                this.sceneProxy.isPreferentialFinished = false;//下一个章节 取消限免状态\r\n            \tconst chapterUuid = nChapter.downloadUuid ? nChapter.downloadUuid : nChapter.uuid;\r\n            \t//第三方\r\n            \tif(this.sceneProxy.isWapOther()){\r\n            \t    const otherback = (plots)=>{\r\n            \t        if(plots === null){\r\n                            Dialog.error('获取付费章节信息失败').then(()=>{stayCurrentPlot()},()=>{stayCurrentPlot()})\r\n                        }else if(plots === \"fail\"){\r\n                            //查询失败\r\n                            Dialog.custom(\"Error\",\"仍未查询到您的支付信息哦，请确认已经支付~ 如有疑问请添加闪艺客服QQ：819786897 ~\",\"提示\",\"复制QQ\",\"取消\",false).then(()=>{\r\n                                Copy(\"819786897\",{\r\n                                    debug: false,\r\n                                    message: '复制成功',\r\n                                })\r\n                                stayCurrentPlot();\r\n                            },()=>{\r\n                                stayCurrentPlot();\r\n                            })\r\n                        }else{\r\n                            nChapter.plots = plots ? plots : [];\r\n                            goNext();\r\n                        }\r\n                    }\r\n                    this.sceneProxy.unlockChapterByWapOther(chapterUuid,nChapter.charge,nChapter.md5,otherback);\r\n            \t    return;\r\n                }\r\n\r\n            \tif (nChapter.charge && ('android' === flashvars.client || 'ios' === flashvars.client || flashvars.client === 'wap')) {\r\n            \t    const unlock =()=>{\r\n                        const unlockFinish = (bSuccess, stayIfFail) => {\r\n                            if (bSuccess) {\r\n                                this.sceneProxy.checkIfChapterFree(chapterUuid, nChapter.md5).then((plots)=>{\r\n                                    this.sceneProxy.unlockChapterCallBack = null;\r\n                                    nChapter.plots.push(...plots);\r\n                                    goNext();\r\n                                }, () => {\r\n                                    if(flashvars.client === 'wap'){\r\n                                        window.parent && window.parent.playLogin();\r\n                                    }else{\r\n                                        Dialog.error('获取付费章节信息失败');\r\n                                    }\r\n                                    stayCurrentPlot();\r\n                                })\r\n                            } else if (stayIfFail) {\r\n                                stayCurrentPlot();\r\n                            } else {\r\n                                Dialog.error('章节解锁失败');\r\n                                goNext();\r\n                            }\r\n                        };\r\n                        this.sceneProxy.unlockChapter(chapterUuid, nChapter.charge, nChapter.md5, unlockFinish);\r\n                    }\r\n                    if(flashvars.uid !== '' && flashvars.client === 'wap'){\r\n                        //wap端 已登 解锁之前再请求一次接口数据\r\n                        this.sceneProxy.checkIfChapterFree(chapterUuid, nChapter.md5).then((plots)=>{\r\n                            this.sceneProxy.unlockChapterCallBack = null;\r\n                            nChapter.plots.push(...plots);\r\n                            goNext();\r\n                        }, () => {\r\n                            unlock();\r\n                        })\r\n                    }else{\r\n                        unlock();\r\n                    }\r\n\t\t\t\t} else {\r\n                    this.sceneProxy.checkIfChapterFree(chapterUuid, nChapter.md5).then((plots)=>{\r\n\t\t\t\t\t\tnChapter.plots.push(...plots);\r\n                        goNext();\r\n                    }, (msg)=>{\r\n                        if (-1 === msg.indexOf('code=87')) {\r\n                            Dialog.error(msg);\r\n                        } else { // 未购买此章节\r\n                            if(flashvars.wap === 'zxwwap'){\r\n                                Dialog.info('当前为收费章节，是否前往闪艺抢先体验？').then(()=>{\r\n                                    window.location.href = 'https://wap.3000.com/?m=detail&op=index&ac=index&id='+ flashvars.gid;\r\n                                },()=>{\r\n                                    stayCurrentPlot();\r\n                                })\r\n                            }else{\r\n                                Dialog.info('当前为收费章节，请前往闪艺app或电脑端进行购买').then(() => stayCurrentPlot(), () => goNext());\r\n                            }\r\n                        }\r\n                    })\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n                if(('android' === flashvars.client || 'ios' === flashvars.client) && nChapter.charge){\r\n                    const chapterUuid = nChapter.downloadUuid ? nChapter.downloadUuid : nChapter.uuid;\r\n                    const ispreferent = (duuid)=>{\r\n                        for(let i =0;i < this.sceneProxy.preferentialVector.length;i++){\r\n                            if(duuid === this.sceneProxy.preferentialVector[i]) return true;\r\n                        }\r\n                        return false;\r\n                    }\r\n                    if(this.sceneProxy.isPreferentialFinished !== false || ispreferent(chapterUuid)){\r\n                        const unlock = ()=>{\r\n                            const unlockPreferentialFinish = (bSuccess, stayIfFail) => {\r\n                                if (bSuccess) {\r\n                                    this.sceneProxy.checkIfChapterFree(chapterUuid, nChapter.md5).then((plots)=>{\r\n                                        this.sceneProxy.isPreferentialFinished = false;//限免解锁成功 取消限免状态\r\n                                        this.sceneProxy.dislodgePreferentVector(chapterUuid);\r\n                                        this.sceneProxy.unlockChapterCallBack = null;\r\n                                        nChapter.plots = plots;\r\n                                        goNext();\r\n                                    }, () => {\r\n                                        if(flashvars.client === 'wap'){\r\n                                            window.parent && window.parent.playLogin();\r\n                                        }else{\r\n                                            Dialog.error('获取付费章节信息失败');\r\n                                        }\r\n                                        stayCurrentPlot();\r\n                                    })\r\n                                } else if (stayIfFail) {\r\n                                    stayCurrentPlot();\r\n                                } else {\r\n                                    Dialog.error('章节解锁失败');\r\n                                    goNext();\r\n                                }\r\n                            };\r\n                            this.sceneProxy.unlockChapter(chapterUuid, nChapter.charge, nChapter.md5, unlockPreferentialFinish);\r\n                        }\r\n                        //已有通知限免结束\r\n                        this.sceneProxy.checkIfChapterFree(chapterUuid,nChapter.md5).then((plots)=>{\r\n                            //有数据，继续\r\n                            this.sceneProxy.dislodgePreferentVector(chapterUuid);\r\n                            goNext();\r\n                        },(msg)=>{\r\n                            //没有数据\r\n                            if(this.sceneProxy.isPreferentialFinished !== false){\r\n                                Dialog.custom(\"Info\",\"作品限免已结束，需要付费才能继续观看哦\",\"限免提示\",\"取消\",\"去支付\",true).then(()=>{\r\n                                    //点击了取消\r\n                                    stayCurrentPlot();\r\n                                },(msg1)=>{\r\n                                    if(msg1 === \"cancel\"){\r\n                                        //点击了去支付\r\n                                        unlock();\r\n                                    }else if(msg1 === \"close\"){\r\n                                        //点击了取消\r\n                                        stayCurrentPlot();\r\n                                    }\r\n                                });\r\n                            }else if(ispreferent(chapterUuid)){\r\n                                unlock();\r\n                            }\r\n\r\n                        });\r\n                        return;\r\n                    }\r\n                }\r\n\r\n            \tgoNext();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tgameOver: function () {\r\n\t\t\tthis.sceneProxy.showEnd();\r\n\t\t},\r\n\r\n\t\t/** @override */\r\n\t\tonRegister: function ()\r\n\t\t{\r\n\t\t\t// Initialize the TextComponentMediator's view component when its\r\n\t\t\t// registered with the Facade and listen to its TEXT_CHANGED events\r\n\t\t\tthis.setViewComponent( new diygamePlayer.view.component.Scene );\r\n\t\t\t/*this.facade.registerMediator(new diygamePlayer.view.mediator.CoverMediator);\r\n\t\t\tthis.facade.registerMediator(new diygamePlayer.view.mediator.SettingsMediator);\r\n\t\t\tthis.facade.registerMediator(new diygamePlayer.view.mediator.MainMenuMediator);\r\n\t\t\tthis.facade.registerMediator(new diygamePlayer.view.mediator.RecordMediator);\r\n\t\t\tthis.facade.registerMediator(new diygamePlayer.view.mediator.PlaybackMediator);\r\n\t\t\tthis.facade.registerMediator(new diygamePlayer.view.mediator.EndMediator);*/\r\n\r\n\t\t\tvar that = this;\r\n\t\t\tthis.viewComponent.onRendered =(function(){\r\n                that.viewComponent.sceneProxy = that.sceneProxy;\r\n                that.facade.registerMediator(new diygamePlayer.view.mediator.CoverMediator);\r\n                that.facade.registerMediator(new diygamePlayer.view.mediator.SettingsMediator);\r\n                that.facade.registerMediator(new diygamePlayer.view.mediator.MainMenuMediator);\r\n                that.facade.registerMediator(new diygamePlayer.view.mediator.RecordMediator);\r\n                that.facade.registerMediator(new diygamePlayer.view.mediator.PlaybackMediator);\r\n                that.facade.registerMediator(new diygamePlayer.view.mediator.EndMediator);\r\n\t\t\t\tthat.sceneProxy.preloadingBegin();\r\n\t\t\t});\r\n\r\n\t\t\t// add the TextComponentMediator as a listener for TEXT_CHANGED events\r\n\t\t\t// when the\r\n\t\t\t//this.viewComponent.addEventListener( diygamePlayer.view.component.Scene.TEXT_CHANGED, this );\r\n\t\t\tthis.sceneProxy = this.facade.retrieveProxy(diygamePlayer.model.proxy.SceneProxy.NAME);\r\n\t\t},\r\n\r\n\t\t/** @override */\r\n\t\tonRemove: function ()\r\n\t\t{\r\n\t\t\t// The TextComponentMediator has been removed from the Facade, and so is no longer\r\n\t\t\t// in use. Clean up by removing event listeners and dereferencing its viewComponent\r\n\t\t\t//this.viewComponent.removeEventListener( diygamePlayer.view.component.Scene.TEXT_CHANGED, this );\r\n\t\t\tthis.setViewComponent(null);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Handle the W3CTextComponent.TEXT_CHANGED event\r\n\t\t * @param {Event} textChangedEvent\r\n\t\t * @return {void}\r\n\t\t */\r\n\t//handleEvent: function (textChangedEvent)\r\n\t//\t{\r\n\t//\t\tthis.sendNotification( diygamePlayer.AppConstants.PROCESS_TEXT, textChangedEvent.text );\r\n\t//\t}\r\n\r\n\t\t, curChapter: null\r\n\t},\r\n\r\n\t// STATIC MEMBERS\r\n\t{\r\n\t\t/**\r\n\t\t * @static\r\n\t\t * @type {string}\r\n\t\t */\r\n\t\tNAME: 'SceneMediator'\r\n\t}\r\n);","/**\r\n * Created by 4399-1126 on 2016/9/13.\r\n */\r\nimport puremvc from 'puremvc';\r\nimport FontUtils from '../../common/FontUtils.js';\r\nimport Utils from '../../common/Utils.js';\r\npuremvc.define\r\n(\r\n    {\r\n        name: 'diygamePlayer.view.mediator.SettingsMediator',\r\n        parent: puremvc.Mediator\r\n    },\r\n    {\r\n        listNotificationInterests: function () {\r\n            return [\r\n                diygamePlayer.AppConstants.SCENE_GOTO_SETTINGS\r\n            ]\r\n        },\r\n\r\n        handleNotification: function (note) {\r\n            const body = note.getBody();\r\n            switch (note.getName()) {\r\n                case diygamePlayer.AppConstants.SCENE_GOTO_SETTINGS:\r\n                    this.callbackInfo = body.callbackInfo;\r\n                    this.showSettingsLayer(body.context);\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        },\r\n\r\n        onRegister: function () {\r\n            this.sceneProxy = this.facade.retrieveProxy(diygamePlayer.model.proxy.SceneProxy.NAME);\r\n            const sceneMediator = this.facade.retrieveMediator(diygamePlayer.view.mediator.SceneMediator.NAME);\r\n            this.game = sceneMediator.viewComponent && sceneMediator.viewComponent.game;\r\n            this.viewComponent = sceneMediator.viewComponent;\r\n        },\r\n\r\n        fullMode: function () {\r\n            const {fullMode, windowMode} = this.sceneProxy.json_data.template.json.settings;\r\n            const full = this.sceneProxy.settingsLayer.getByName('settings_button_fullMode');\r\n            const window = this.sceneProxy.settingsLayer.getByName('settings_button_windowMode');\r\n            full && full.changeBackground(fullMode.checked.background.url, fullMode.checked.text);\r\n            window && window.changeBackground(windowMode.unchecked.background.url, windowMode.unchecked.text);\r\n        },\r\n\r\n        windowMode: function () {\r\n            const {fullMode, windowMode} = this.sceneProxy.json_data.template.json.settings;\r\n            const full = this.sceneProxy.settingsLayer.getByName('settings_button_fullMode');\r\n            const window = this.sceneProxy.settingsLayer.getByName('settings_button_windowMode');\r\n            full && full.changeBackground(fullMode.unchecked.background.url, fullMode.unchecked.text);\r\n            window && window.changeBackground(windowMode.checked.background.url, windowMode.checked.text);\r\n        },\r\n\r\n        autoOn: function () {\r\n            const {autoOn, autoOff} = this.sceneProxy.json_data.template.json.settings;\r\n            const on = this.sceneProxy.settingsLayer.getByName('settings_button_autoOn');\r\n            const off = this.sceneProxy.settingsLayer.getByName('settings_button_autoOff');\r\n            on && on.changeBackground(autoOn.checked.background.url, autoOn.checked.text);\r\n            off && off.changeBackground(autoOff.unchecked.background.url, autoOff.unchecked.text);\r\n        },\r\n\r\n        autoOff: function () {\r\n            const {autoOn, autoOff} = this.sceneProxy.json_data.template.json.settings;\r\n            const on = this.sceneProxy.settingsLayer.getByName('settings_button_autoOn');\r\n            const off = this.sceneProxy.settingsLayer.getByName('settings_button_autoOff');\r\n            on && on.changeBackground(autoOn.unchecked.background.url, autoOn.unchecked.text);\r\n            off && off.changeBackground(autoOff.checked.background.url, autoOff.checked.text);\r\n        },\r\n\r\n        updateVolumeProgress(type,value){\r\n            const progGroup = this.sceneProxy.settingsLayer.getByName(type + 'progGroup');\r\n            if(progGroup){\r\n                const pk = progGroup.getByName('pk');\r\n                const progbk = progGroup.getByName('progbk');\r\n                const totalwidth = progbk.width;\r\n                if(value <= 0){pk.width = 0.01;}else{ //遮罩宽度为0时 遮罩效果无效\r\n                    pk.width = value * totalwidth;\r\n                }\r\n            }\r\n\r\n        },\r\n\r\n        addSettings: function () {\r\n            const {background, header, displayHeader, textHeader, displayCaption, textCaption, fullMode, windowMode, autoOn, autoOff, back} = this.sceneProxy.json_data.template.json.settings;\r\n\r\n            //添加进度条\r\n            const addProgress = (type,norkey,progkey,rc,callback)=>{\r\n                const progGroup = this.game.add.group();\r\n                progGroup.x = rc.x;\r\n                progGroup.y = rc.y;\r\n                progGroup.name = type + 'progGroup';\r\n                this.sceneProxy.settingsLayer.add(progGroup);\r\n                const normalkey = this.game.load.cache.checkImageKey(norkey) ? norkey : '';\r\n                const progresskey = this.game.load.cache.checkImageKey(progkey) ? progkey : '';\r\n                let progbk = this.game.add.image(0,0,normalkey,null,progGroup);\r\n                progbk.width = rc.width;\r\n                progbk.height = rc.height;\r\n                progbk.name = 'progbk';\r\n                let progpk = this.game.add.image(0,0,progresskey,null,progGroup);\r\n                progpk.width = rc.width;\r\n                progpk.height = rc.height;\r\n                progpk.name = 'progpk';\r\n\r\n                const pk = this.game.add.graphics(0,0);\r\n                pk.beginFill(0xfff000,0.5);\r\n                pk.drawRect(0, 0, rc.width, rc.height);\r\n                pk.endFill();\r\n                pk.name = 'pk'\r\n                progGroup.add(pk);\r\n                progpk.mask = pk;\r\n\r\n                let isProgDown = false;\r\n                progbk.inputEnabled = true;\r\n                const totalwidth = progbk.width; //总长度\r\n                let progress = 0;\r\n                this.game.time.events.stop(false);\r\n                const update = (value)=>{\r\n                    if(value <= 0){pk.width = 0.01;}else{ //遮罩宽度为0时 遮罩效果无效\r\n                        pk.width = value * totalwidth;\r\n                    }\r\n                }\r\n                progbk.events.onInputDown.add((obj,point)=>{\r\n                    isProgDown = true;\r\n                    progress = ((point.x - rc.x) / totalwidth)\r\n                    update(progress)\r\n                    this.game.time.events.start();\r\n                },this);//按下\r\n                this.game.time.events.loop(10,()=>{\r\n                    if(isProgDown){\r\n                        progress = ((this.game.input.x - rc.x) / totalwidth)\r\n                        if(progress <=0) progress = 0;\r\n                        if(progress >=1) progress = 1;\r\n                        update(progress);\r\n                    }\r\n                },this);\r\n\r\n                this.game.input.onUp.add(()=>{\r\n                    if(isProgDown){\r\n                        if(callback)callback(progress);\r\n                        this.game.time.events.stop(false);\r\n                    }\r\n                    isProgDown = false;\r\n                },this)//弹起\r\n            }\r\n\r\n            const addTextBk = (bkKey, rc, name) => {\r\n                const key = this.game.load.cache.checkImageKey(bkKey) ? bkKey : '';\r\n                const bk = this.sceneProxy.settingsLayer.create(rc.x, rc.y, key);\r\n                bk.width = rc.width;\r\n                bk.height = rc.height;\r\n                bk.name = name;\r\n            };\r\n\r\n            const addTextContent = (x, y, width, height, content, objText, name) => {\r\n                const fontStyle = {};\r\n                let ff = '';\r\n                ff += objText.fontWeight ? objText.fontWeight + ' ' : 'normal ';\r\n                ff += objText.fontSize ? parseInt(objText.fontSize) + 'px ' : '';\r\n                ff += this.sceneProxy.json_data.font ? this.sceneProxy.json_data.font.fontFamily : objText.fontFamily ? objText.fontFamily : '';\r\n\r\n                fontStyle.font = ff;\r\n                fontStyle.fill = objText.color;\r\n                fontStyle.boundsAlignH = \"center\";\r\n                fontStyle.boundsAlignV = \"middle\";\r\n                fontStyle.stroke = objText.stroke;\r\n                fontStyle.strokeThickness = objText.stroke ? 2 : 0;\r\n\r\n                const txt = this.game.add.text(0, 0, content, fontStyle, this.sceneProxy.settingsLayer);\r\n                txt.name = name;\r\n                if (FontUtils.fontFamily) {\r\n                    const colorS = objText.color ? objText.color : '#fefefe';\r\n                    const fontSize = objText.fontSize ? parseInt(objText.fontSize) : 25;\r\n                    let color = '';\r\n                    if (colorS.indexOf('rgb') !== -1) {\r\n                        const rgb = colorS.replace('rgb(', '').replace(')', '').split(',');\r\n                        color = '0x' + parseInt(rgb[0], 16) + parseInt(rgb[1], 16) + parseInt(rgb[2], 16);\r\n                        color === '0xffffff' && (color = '0xfefefe');\r\n                    }\r\n                    else {\r\n                        color = (colorS === '#ffffff' ? '#fefefe' : colorS).replace('#', '0x');\r\n                    }\r\n                    const fh = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontHeight(fontSize) : fontSize;\r\n                    const fw = this.sceneProxy.json_data.font.size ? this.sceneProxy.toRealImageFontWidth(fontSize) : fontSize;\r\n                    txt.colors.splice(0, txt.colors.length);\r\n                    txt.text = ' ';\r\n                    txt.fill = color;\r\n                    txt.addColor(color, 0);\r\n                    txt.x = x + (width - fw * content.length) / 2;\r\n                    txt.y = y + (height - fh) / 2;\r\n                    txt.wordWrapWidth = fw * (content.length + 1);\r\n                    this.sceneProxy.addImageFontText([{data:content}], fw, fh, txt, this.sceneProxy.context);\r\n                }\r\n                else {\r\n                    txt.setTextBounds(x, y + (txt.height - parseInt(objText.fontSize)) / 2, width, height);\r\n                }\r\n                objText.hidden && (txt.visible = false);\r\n                return txt;\r\n            };\r\n\r\n            const addButton = (obj, name, text, isCheckBox) => {\r\n                const t = {};\r\n                t.normal = isCheckBox ? obj.unchecked.text : obj.normal.text;\r\n                t.active = isCheckBox ? null : obj.active.text;\r\n                t.text = text;\r\n                const btn = this.viewComponent.addButton(obj.rect.x,\r\n                    obj.rect.y,\r\n                    obj.rect.width,\r\n                    obj.rect.height,\r\n                    isCheckBox ? null : obj.normal.background.url,\r\n                    isCheckBox ? null : obj.active.background.url,\r\n                    modeBtnClicked,\r\n                    t,\r\n                    this.sceneProxy.btn_sound,\r\n                    name,\r\n                    this.sceneProxy.settingsLayer,\r\n                    isCheckBox\r\n                );\r\n                isCheckBox && btn.changeBackground(obj.unchecked.background.url, text);\r\n                return btn;\r\n            };\r\n\r\n            const modeBtnClicked = (argv, pointer) => {\r\n                if (pointer.pointerMode === Phaser.PointerMode.CURSOR && pointer.button !== 0) {\r\n                    return;\r\n                }\r\n                if (argv.parent.name === 'settings_button_fullMode') {\r\n                    this.fullMode();\r\n                    this.sceneProxy.onSettingsFullModeBtnClicked();\r\n                }\r\n                else if (argv.parent.name === 'settings_button_windowMode') {\r\n                    this.windowMode();\r\n                    this.sceneProxy.onSettingsWindowModeBtnClicked();\r\n                }\r\n                else if (argv.parent.name === 'settings_button_autoOn') {\r\n                    this.autoOn();\r\n                    this.sceneProxy.onSettingsAutoOnBtnClicked();\r\n                }\r\n                else if (argv.parent.name === 'settings_button_autoOff') {\r\n                    this.autoOff();\r\n                    this.sceneProxy.onSettingsAutoOffBtnClicked();\r\n                }\r\n                else if (argv.parent.name === 'settings_button_back') {\r\n                    this.sceneProxy.isQuickPlay = true;\r\n                    appCanBack(flashvars.client,flashvars.app_version,false,flashvars.offline === '1');\r\n                    this.sceneProxy.onSettingsBackBtnClicked();\r\n                    if (this.callbackInfo) {\r\n                        this.callbackInfo.callbackFun(this.callbackInfo.callbackArgs);\r\n                        this.callbackInfo = null;\r\n                    }\r\n                }\r\n            };\r\n\r\n            const bk = this.sceneProxy.settingsLayer.create(0, 0, this.game.load.cache.checkImageKey(background.url) && background.url);\r\n            bk.width = this.game.world.width;\r\n            bk.height = this.game.world.height;\r\n            bk.name = 'settings_bk_main';\r\n            bk.inputEnabled = true;\r\n\r\n            // header\r\n            addTextBk(header.background.url, header.rect);\r\n            if (header.title.text.hidden != true) {\r\n                addTextContent(header.title.rect.x\r\n                    , header.title.rect.y\r\n                    , header.title.rect.width\r\n                    , header.title.rect.height\r\n                    , this.sceneProxy.stringMap.settings\r\n                    , header.title.text\r\n                    , 'settings_text_header');\r\n            }\r\n\r\n            // displayHeader\r\n            if(!displayHeader.hidden){\r\n                addTextBk(displayHeader.background.url, displayHeader.rect);\r\n                if (!displayHeader.title.text.hidden) {\r\n                    addTextContent(displayHeader.title.rect.x + displayHeader.rect.x\r\n                        , displayHeader.title.rect.y + displayHeader.rect.y\r\n                        , displayHeader.title.rect.width\r\n                        , displayHeader.title.rect.height\r\n                        , this.sceneProxy.stringMap.displayHeader\r\n                        , displayHeader.title.text\r\n                        , 'settings_text_displayHeader');\r\n                }\r\n            }\r\n\r\n            // textHeader\r\n            if(!textHeader.hidden){\r\n                addTextBk(textHeader.background.url, textHeader.rect);\r\n                if (!textHeader.title.text.hidden) {\r\n                    addTextContent(textHeader.title.rect.x + textHeader.rect.x\r\n                        , textHeader.title.rect.y + textHeader.rect.y\r\n                        , textHeader.title.rect.width\r\n                        , textHeader.title.rect.height\r\n                        , this.sceneProxy.stringMap.textHeader\r\n                        , textHeader.title.text\r\n                        , 'settings_text_textHeader');\r\n                }\r\n            }\r\n\r\n\r\n            // displayCaption\r\n            addTextBk(displayCaption.background.url, displayCaption.rect);\r\n            if (!displayCaption.text.hidden) {\r\n                addTextContent(displayCaption.rect.x\r\n                    , displayCaption.rect.y\r\n                    , displayCaption.rect.width\r\n                    , displayCaption.rect.height\r\n                    , this.sceneProxy.stringMap.displayCaption\r\n                    , displayCaption.text\r\n                    , 'settings_text_displayCaption');\r\n            }\r\n\r\n            // textCaption\r\n            addTextBk(textCaption.background.url, textCaption.rect);\r\n            if (!textCaption.text.hidden) {\r\n                addTextContent(textCaption.rect.x\r\n                    , textCaption.rect.y\r\n                    , textCaption.rect.width\r\n                    , textCaption.rect.height\r\n                    , this.sceneProxy.stringMap.textCaption\r\n                    , textCaption.text\r\n                    , 'settings_text_textCaption');\r\n            }\r\n\r\n            // fullMode\r\n            if (!fullMode.hidden) {\r\n                addButton(fullMode, 'settings_button_fullMode', this.sceneProxy.stringMap.fullMode, true);\r\n            }\r\n\r\n            // window mode\r\n            if (!windowMode.hidden) {\r\n                addButton(windowMode, 'settings_button_windowMode', this.sceneProxy.stringMap.windowMode, true);\r\n            }\r\n\r\n            // autoOn\r\n            if (!autoOn.hidden) {\r\n                addButton(autoOn, 'settings_button_autoOn', this.sceneProxy.stringMap.autoOn, true);\r\n            }\r\n\r\n            // autoOff\r\n            if (!autoOff.hidden) {\r\n                addButton(autoOff, 'settings_button_autoOff', this.sceneProxy.stringMap.autoOff, true);\r\n            }\r\n\r\n            // back\r\n            if (!back.hidden) {\r\n                const btnGroup = addButton(back, 'settings_button_back', this.sceneProxy.stringMap.back);\r\n                btnGroup.button.onInputUp.add(() => this.sceneProxy.btn_sound && this.sceneProxy.btn_sound.stop())\r\n            }\r\n\r\n            //musicCaption\r\n            if(this.sceneProxy.json_data.template.json.settings.musicCaption){\r\n                const musicCaption = this.sceneProxy.json_data.template.json.settings.musicCaption;\r\n                addTextBk(musicCaption.background.url,musicCaption.rect);\r\n                if (!musicCaption.text.hidden) {\r\n                    addTextContent(musicCaption.rect.x\r\n                        , musicCaption.rect.y\r\n                        , musicCaption.rect.width\r\n                        , musicCaption.rect.height\r\n                        , this.sceneProxy.stringMap.musicCaption\r\n                        , musicCaption.text\r\n                        , 'settings_text_musicCaption');\r\n                }\r\n            }\r\n            //musicVolume\r\n            if(this.sceneProxy.json_data.template.json.settings.musicVolume){\r\n                const musicVolume = this.sceneProxy.json_data.template.json.settings.musicVolume;\r\n                addProgress('music',musicVolume.normal.background.url,musicVolume.progress.background.url,musicVolume.rect,(value)=>{\r\n                    this.sceneProxy.updateMusicVolume(value);\r\n                });\r\n            }\r\n            //soundCaption\r\n            if(this.sceneProxy.json_data.template.json.settings.soundCaption){\r\n                const soundCaption = this.sceneProxy.json_data.template.json.settings.soundCaption;\r\n                addTextBk(soundCaption.background.url,soundCaption.rect);\r\n                if (!soundCaption.text.hidden) {\r\n                    addTextContent(soundCaption.rect.x\r\n                        , soundCaption.rect.y\r\n                        , soundCaption.rect.width\r\n                        , soundCaption.rect.height\r\n                        , this.sceneProxy.stringMap.soundCaption\r\n                        , soundCaption.text\r\n                        , 'settings_text_soundCaption');\r\n                }\r\n            }\r\n            //soundVolume\r\n            if(this.sceneProxy.json_data.template.json.settings.soundVolume){\r\n                const soundVolume = this.sceneProxy.json_data.template.json.settings.soundVolume;\r\n                addProgress('sound',soundVolume.normal.background.url,soundVolume.progress.background.url,soundVolume.rect,(value)=>{\r\n                    this.sceneProxy.updateSoundVolume(value)\r\n                });\r\n            }\r\n            //volumeHeader\r\n            if(this.sceneProxy.json_data.template.json.settings.volumeHeader){\r\n                const volumeHeader = this.sceneProxy.json_data.template.json.settings.volumeHeader;\r\n                addTextBk(volumeHeader.background.url, volumeHeader.rect);\r\n                if (!volumeHeader.title.text.hidden) {\r\n                    addTextContent(displayHeader.title.rect.x + displayHeader.rect.x\r\n                        , displayHeader.title.rect.y + displayHeader.rect.y\r\n                        , displayHeader.title.rect.width\r\n                        , displayHeader.title.rect.height\r\n                        , this.sceneProxy.stringMap.volumeHeader\r\n                        , displayHeader.title.text\r\n                        , 'settings_text_displayHeader');\r\n                }\r\n            }\r\n\r\n            this.sceneProxy.settingsLayer.visible = false;\r\n        },\r\n\r\n        showSettingsLayer: function (context) {\r\n            if (this.sceneProxy.settingsLayer.children.length === 0) {\r\n                this.addSettings();\r\n            }\r\n            const rectScreenMode = () => {\r\n                if (this.game.scale.isFullScreen) {\r\n                    this.fullMode();\r\n                    context.fullScreen = true;\r\n                } else {\r\n                    this.windowMode();\r\n                    context.fullScreen = false;\r\n                }\r\n            };\r\n            const rectTextMode = () => {\r\n                if (context.auto) {\r\n                    this.autoOn();\r\n                } else {\r\n                    this.autoOff();\r\n                }\r\n            };\r\n            if (!this.fullScreenHandler) {\r\n                this.fullScreenHandler = this.game.scale.onFullScreenChange.add(e => rectScreenMode());\r\n            }\r\n            if(this.sceneProxy.json_data.template.json.settings.musicVolume || this.sceneProxy.json_data.template.json.settings.soundVolume){\r\n                this.sceneProxy.isQuickPlay = false;\r\n                appCanBack(flashvars.client,flashvars.app_version,true,flashvars.offline === '1');\r\n            }\r\n            rectScreenMode();\r\n            rectTextMode();\r\n            this.updateVolumeProgress('sound',Utils.soundVolume);\r\n            this.updateVolumeProgress('music',Utils.musicVolume);\r\n            this.sceneProxy.settingsLayer.visible = true;\r\n            this.game.world.bringToTop(this.sceneProxy.settingsLayer);\r\n        }\r\n    },\r\n    {\r\n        /**\r\n         * @static\r\n         * @type {string}\r\n         */\r\n        NAME: 'SettingsMediator'\r\n    }\r\n);"]}